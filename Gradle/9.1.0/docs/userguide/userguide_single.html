<!DOCTYPE html>
<html lang="">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="Single-page Gradle User Manual for Gradle 9.1.0">
<title>Gradle User Manual: Version 9.1.0</title>
<style>
/*
 * Copyright 2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* Custom Admonition Blocks */
body {
    --gradle-blue: #209BC4;
    --gradle-bg-dark: #010002;
    --gradle-bg-gray: #F8F8F8;
    --gradle-bg-white: #FFFFFF;
    --gradle-blue: #209BC4;
    --gradle-blue-lite: #4DC9C0;
    --gradle-blue-dark: #1b3262;
    --gradle-blue-darker: #19274f;
    --button-gradient-angle: 160deg;
	--caution-color: #e40046;
	--caution-on-color: #fff;
	--important-color: #802392;
	--important-on-color: #fff;
	--note-color: #2d7dd2;
	--note-on-color: #fff;
	--tip-color: #43b929;
	--tip-on-color: #fff;
	--warning-color: #f70;
	--warning-on-color: #fff;
	--admonition-background: #fafafa;
	--doc-icon-filter: invert(14.5%);
	--rem-base: 18;
	--black-color: #000;
	--white-color: #fff;
	--text-color: #02303A;
	--title-color: #02303A;
	--header-color: rgba(0, 0, 0, 0.85);
	--footer-color: #fff;
	--footer-other-text-color: #02303;
	--footer-form-color: #1BA8CB;
	--code-color: #f7f7f8;
	--code-text-color: rgba(0, 0, 0, 0.9);
	--code-link-color: #021274;
	--num-color: rgba(0, 0, 0, 0.8);
	--nav-color: #f8f8f7;
	--table-color: #f7f8f7;
	--box-shadow-color: rgba(0, 0, 0, .15);
	--top-header-color: #fff;
	--footer-white-color: #fff;
	--footer-text-color: #fff;
	--quoteblock-color: #7a2518;
	--menu-burger-color: #fff;
	--various-border-color: #e7e7e9;
}

body.dark-theme {
    --admonition-background: #2a2929;
    --black-color: #fff;
    --white-color: #121212;
    --text-color: #aaa;
    --title-color: #fff;
    --header-color: rgba(255, 255, 255, 0.85);
    --footer-color: #121212;
    --footer-other-text-color: #ddd;
    --code-color: #1f1f1f;
    --code-text-color: rgba(255, 255, 255, 0.9);
    --code-link-color: #1fafcc;
    --num-color: #fff;
    --nav-color: #121212;
    --table-color: #121212;
    --box-shadow-color: rgba(255, 255, 255, .15);
    --top-header-color: #242526;
    --footer-white-color: #242526;
    --footer-text-color: #aaa;
    --footer-form-color: #1BA8CB;
    --quoteblock-color: #1DA2BD;
    --menu-burger-color: #242526;
    --various-border-color: #242526;
}

@media (prefers-color-scheme: dark) {
  /* defaults to dark theme */
  body {
    --admonition-background: #2a2929;
    --black-color: #fff;
    --white-color: #121212;
    --text-color: #aaa;
    --title-color: #fff;
    --header-color: rgba(255, 255, 255, 0.85);
    --footer-color: #121212;
    --footer-other-text-color: #ddd;
    --code-color: #1f1f1f;
    --code-text-color: rgba(255, 255, 255, 0.9);
    --code-link-color: #1fafcc;
    --num-color: #fff;
    --nav-color: #121212;
    --table-color: #121212;
    --box-shadow-color: rgba(255, 255, 255, .15);
    --top-header-color: #242526;
    --footer-white-color: #242526;
    --footer-text-color: #aaa;
    --footer-form-color: #1BA8CB;
    --quoteblock-color: #1DA2BD;
    --menu-burger-color: #242526;
    --various-border-color: #242526;
  }
  body.light-theme {
    --gradle-blue: #209BC4;
    --gradle-bg-dark: #010002;
    --gradle-bg-gray: #F8F8F8;
    --gradle-bg-white: #FFFFFF;
    --gradle-blue: #209BC4;
    --gradle-blue-lite: #4DC9C0;
    --gradle-blue-dark: #1b3262;
    --gradle-blue-darker: #19274f;
    --button-gradient-angle: 160deg;
	--caution-color: #e40046;
	--caution-on-color: #fff;
	--important-color: #802392;
	--important-on-color: #fff;
	--note-color: #2d7dd2;
	--note-on-color: #fff;
	--tip-color: #43b929;
	--tip-on-color: #fff;
	--warning-color: #f70;
	--warning-on-color: #fff;
	--admonition-background: #fafafa;
	--doc-icon-filter: invert(14.5%);
	--rem-base: 18;
	--black-color: #000;
	--white-color: #fff;
	--text-color: #02303A;
	--title-color: #02303A;
	--header-color: rgba(0, 0, 0, 0.85);
	--footer-color: #fff;
    --footer-other-text-color: #02303;
	--code-color: #f7f7f8;
	--code-text-color: rgba(0, 0, 0, 0.9);
	--code-link-color: #021274;
	--num-color: rgba(0, 0, 0, 0.8);
	--nav-color: #f8f8f7;
	--table-color: #f7f8f7;
	--box-shadow-color: rgba(0, 0, 0, .15);
	--top-header-color: #fff;
	--footer-white-color: #fff;
	--footer-text-color: #fff;
	--footer-form-color: #1BA8CB;
	--quoteblock-color: #7a2518;
	--menu-burger-color: #fff;
	--various-border-color: #e7e7e9;
  }
}

.cls-1 {
    fill: #02303a;
}

body.dark-theme {
    .cls-1 {
      fill: #fff;
    }
}

@media (prefers-color-scheme: dark) {
    .cls-1 {
        fill: #fff;
    }
    body.light-theme {
        .cls-1 {
            fill: #02303a;
        }
    }
}

/* Lato (normal, regular) */
@font-face {
	font-family: Lato;
	font-weight: 400;
	font-style: normal;
	src: url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff2") format("woff2"),
		url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff") format("woff");
}

/* Lato (normal, italic) */
@font-face {
	font-display: swap;
	font-family: Lato;
	font-weight: 400;
	font-style: italic;
	src: url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff2") format("woff2"),
		url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff") format("woff");
}

/* Lato (bold, regular) */
@font-face {
	font-display: swap;
	font-family: Lato;
	font-weight: 500;
	font-style: normal;
	src: url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff2") format("woff2"),
		url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff") format("woff");
}

/* Lato (bold, regular) */
@font-face {
	font-display: swap;
	font-family: Lato;
	font-weight: 800;
	font-style: normal;
	src: url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff2") format("woff2"),
		url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff") format("woff");
}

/* BEGIN asciidoc.css */

/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
	display: block;
}

/** Correct `inline-block` display not defined in IE 8/9. */
audio,
canvas,
video {
	display: inline-block;
}

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) {
	display: none;
	height: 0;
}

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden],
template {
	display: none;
}

script {
	display: none !important;
}

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html {
	font-family: sans-serif;
	/* 1 */
	-ms-text-size-adjust: 100%;
	/* 2 */
	-webkit-text-size-adjust: 100%;
	/* 2 */
}

/** Remove default margin. */
body {
	margin: 0;
}

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a {
	background: transparent;
}

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus {
	outline: thin dotted;
}

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active,
a:hover {
	outline: 0;
}

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] {
	border-bottom: 1px dotted;
}

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b,
strong {
	font-weight: bold;
}

/** Address styling not present in Safari 5 and Chrome. */
dfn {
	font-style: italic;
}

/** Address differences between Firefox and other browsers. */
hr {
	-moz-box-sizing: content-box;
	box-sizing: content-box;
	height: 0;
}

/** Address styling not present in IE 8/9. */
mark {
	background: #ff0;
	color: var(--black-color);
}

/** Correct font family set oddly in Safari 5 and Chrome. */
code,
kbd,
pre,
samp {
	font-family: monospace, serif;
	font-size: 1em;
}

/** Improve readability of pre-formatted text in all browsers. */
pre {
	white-space: pre-wrap;
}

/** Set consistent quote types. */
q {
	quotes: "\201C""\201D""\2018""\2019";
}

/** Address inconsistent and variable font size in all browsers. */
small {
	font-size: 80%;
}

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub,
sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}

sup {
	top: -0.5em;
}

sub {
	bottom: -0.25em;
}

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img {
	border: 0;
}

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) {
	overflow: hidden;
}

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure {
	margin: 0;
}

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset {
	border: 1px solid #c0c0c0;
	margin: 0 2px;
	padding: 0.35em 0.625em 0.75em;
}

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend {
	border: 0;
	/* 1 */
	padding: 0;
	/* 2 */
}

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button,
input,
select,
textarea {
	font-family: inherit;
	/* 1 */
	font-size: 100%;
	/* 2 */
	margin: 0;
	/* 3 */
}

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button,
input {
	line-height: normal;
}

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button,
select {
	text-transform: none;
}

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
	-webkit-appearance: button;
	/* 2 */
	cursor: pointer;
	/* 3 */
}

/** Re-set default cursor for disabled elements. */
button[disabled],
html input[disabled] {
	cursor: default;
}

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"],
input[type="radio"] {
	box-sizing: border-box;
	/* 1 */
	padding: 0;
	/* 2 */
}

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] {
	-webkit-appearance: textfield;
	/* 1 */
	-moz-box-sizing: content-box;
	-webkit-box-sizing: content-box;
	/* 2 */
	box-sizing: content-box;
}

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
	-webkit-appearance: none;
}

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner,
input::-moz-focus-inner {
	border: 0;
	padding: 0;
}

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea {
	overflow: auto;
	/* 1 */
	vertical-align: top;
	/* 2 */
}

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table {
	border-collapse: collapse;
	border-spacing: 0;
}

meta.foundation-mq-small {
	font-family: "only screen and (min-width: 768px)";
	width: 768px;
}

meta.foundation-mq-medium {
	font-family: "only screen and (min-width:1280px)";
	width: 1280px;
}

meta.foundation-mq-large {
	font-family: "only screen and (min-width:1440px)";
	width: 1440px;
}

*,
*:before,
*:after {
	-moz-box-sizing: border-box;
	-webkit-box-sizing: border-box;
	box-sizing: border-box;
}

html,
body {
	font-size: 100%;
}

body {
	background: var(--white-color);
	color: var(--num-color);
	padding: 0;
	margin: 0;
	font-family: "Noto Serif", "DejaVu Serif", serif;
	font-weight: normal;
	font-style: normal;
	line-height: 1;
	position: relative;
	cursor: auto;
}

a:hover {
	cursor: pointer;
}

img,
object,
embed {
	max-width: 100%;
	height: auto;
}

object,
embed {
	height: 100%;
}

img {
	-ms-interpolation-mode: bicubic;
}

#map_canvas img,
#map_canvas embed,
#map_canvas object,
.map_canvas img,
.map_canvas embed,
.map_canvas object {
	max-width: none !important;
}

.left {
	float: left !important;
}

.right {
	float: right !important;
}

.text-left {
	text-align: left !important;
}

.text-right {
	text-align: right !important;
}

.text-center {
	text-align: center !important;
}

.text-justify {
	text-align: justify !important;
}

.hide {
	display: none;
}

.antialiased {
	-webkit-font-smoothing: antialiased;
}

img {
	display: inline-block;
	vertical-align: middle;
}

textarea {
	height: auto;
	min-height: 50px;
}

select {
	width: 100%;
}

object,
svg {
	display: inline-block;
	vertical-align: middle;
}

.center {
	margin-left: auto;
	margin-right: auto;
}

.spread {
	width: 100%;
}

p.lead,
.paragraph.lead>p,
#preamble>.sectionbody>.paragraph:first-of-type p {
	font-size: 1.21875em;
	line-height: 1.6;
}

.subheader,
.admonitionblock td.content>.title,
.audioblock>.title,
.exampleblock>.title,
.imageblock>.title,
.listingblock>.title,
.literalblock>.title,
.stemblock>.title,
.openblock>.title,
.paragraph>.title,
.quoteblock>.title,
table.tableblock>.title,
.verseblock>.title,
.videoblock>.title,
.dlist>.title,
.olist>.title,
.ulist>.title,
.qlist>.title,
.hdlist>.title {
	line-height: 1.45;
	color: #7a2518;
	font-weight: normal;
	margin-top: 0;
	margin-bottom: 0.25em;
}

/* Typography resets */
div,
dl,
dt,
dd,
ul,
ol,
li,
h1,
h2,
h3,
#toctitle,
.sidebarblock>.content>.title,
h4,
h5,
h6,
pre,
form,
p,
blockquote,
th,
td {
	margin: 0;
	padding: 0;
	direction: ltr;
}

/* Default Link Styles */
a {
	color: #2156a5;
	text-decoration: underline;
	line-height: inherit;
}

a:hover,
a:focus {
	color: #1d4b8f;
}

a img {
	border: none;
}

/* Default paragraph styles */
p {
	font-family: inherit;
	font-weight: normal;
	font-size: 1em;
	line-height: 1.6;
	margin-bottom: 1.25em;
	text-rendering: optimizeLegibility;
}

p aside {
	font-size: 0.875em;
	line-height: 1.35;
	font-style: italic;
}

/* Default header styles */
h1,
h2,
h3,
#toctitle,
.sidebarblock>.content>.title,
h4,
h5,
h6 {
	font-family: "Open Sans", "DejaVu Sans", sans-serif;
	font-weight: 300;
	font-style: normal;
	color: #ba3925;
	text-rendering: optimizeLegibility;
	margin-top: 1em;
	margin-bottom: 0.5em;
	line-height: 1.0125em;
}

h1 small,
h2 small,
h3 small,
#toctitle small,
.sidebarblock>.content>.title small,
h4 small,
h5 small,
h6 small {
	font-size: 60%;
	color: #e99b8f;
	line-height: 0;
}

h1 {
	font-size: 2.125em;
}

h2 {
	font-size: 1.6875em;
}

h3,
#toctitle,
.sidebarblock>.content>.title {
	font-size: 1.375em;
}

h4 {
	font-size: 1.125em;
}

h5 {
	font-size: 1.125em;
}

h6 {
	font-size: 1em;
}

hr {
	border: solid #ddddd8;
	border-width: 1px 0 0;
	clear: both;
	margin: 1.25em 0 1.1875em;
	height: 0;
}

/* Helpful Typography Defaults */
em,
i {
	font-style: italic;
	line-height: inherit;
}

strong,
b {
	font-weight: bold;
	line-height: inherit;
}

small {
	font-size: 60%;
	line-height: inherit;
}

code {
	font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
	font-weight: normal;
	color: var(--code-text-color);
}

a code {
	color: var(--code-link-color);
}

/* Lists */
ul,
ol,
dl {
	font-size: 1em;
	line-height: 1.6;
	margin-bottom: 1.25em;
	list-style-position: outside;
	font-family: inherit;
}

ul,
ol {
	margin-left: 1.5em;
}

ul.no-bullet,
ol.no-bullet {
	margin-left: 1.5em;
}

/* Unordered Lists */
ul li ul,
ul li ol {
	margin-left: 1.25em;
	margin-bottom: 0;
	font-size: 1em;
	/* Override nested font-size change */
}

ul.square li ul,
ul.circle li ul,
ul.disc li ul {
	list-style: inherit;
}

ul.square {
	list-style-type: square;
}

ul.circle {
	list-style-type: circle;
}

ul.disc {
	list-style-type: disc;
}

ul.no-bullet {
	list-style: none;
}

/* Ordered Lists */
ol li ul,
ol li ol {
	margin-left: 1.25em;
	margin-bottom: 0;
}

/* Definition Lists */
dl dt {
	margin-bottom: 0.3125em;
	font-weight: bold;
}

dl dd {
	margin-bottom: 1.25em;
}

/* Abbreviations */
abbr,
acronym {
	text-transform: uppercase;
	font-size: 90%;
	color: var(--num-color);
	border-bottom: 1px dotted #dddddd;
	cursor: help;
}

abbr {
	text-transform: none;
}

/* Blockquotes */
blockquote {
	margin: 0 0 1.25em;
	padding: 0.5625em 1.25em 0 1.1875em;
	border-left: 1px solid #dddddd;
}

blockquote cite {
	display: block;
	font-size: 0.9375em;
	color: rgba(0, 0, 0, 0.6);
}

blockquote cite:before {
	content: "\2014 \0020";
}

blockquote cite a,
blockquote cite a:visited {
	color: rgba(0, 0, 0, 0.6);
}

blockquote,
blockquote p {
	line-height: 1.6;
	color: var(--header-color);
}

/* Microformats */
.vcard {
	display: inline-block;
	margin: 0 0 1.25em 0;
	border: 1px solid #dddddd;
	padding: 0.625em 0.75em;
}

.vcard li {
	margin: 0;
	display: block;
}

.vcard .fn {
	font-weight: bold;
	font-size: 0.9375em;
}

.vevent .summary {
	font-weight: bold;
}

.vevent abbr {
	cursor: auto;
	text-decoration: none;
	font-weight: bold;
	border: none;
	padding: 0 0.0625em;
}

@media only screen and (min-width: 768px) {

	h1,
	h2,
	h3,
	#toctitle,
	.sidebarblock>.content>.title,
	h4,
	h5,
	h6 {
		line-height: 1.2;
	}

	h1 {
		font-size: 2.75em;
	}

	h2 {
		font-size: 2.3125em;
	}

	h3,
	#toctitle,
	.sidebarblock>.content>.title {
		font-size: 1.6875em;
	}

	h4 {
		font-size: 1.4375em;
	}
}

/* Tables */
table {
	background: var(--white-color);
	margin-bottom: 1.25em;
	border: solid 1px #dedede;
}

table thead,
table tfoot {
	background: var(--table-color);
	font-weight: bold;
}

table thead tr th,
table thead tr td,
table tfoot tr th,
table tfoot tr td {
	padding: 0.5em 0.625em 0.625em;
	font-size: inherit;
	color: var(--num-color);
	text-align: left;
}

table tr th,
table tr td {
	padding: 0.5625em 0.625em;
	font-size: inherit;
	color: var(--num-color);
}

table tr.even,
table tr.alt,
table tr:nth-of-type(even) {
	background: var(--nav-color);
}

table thead tr th,
table tfoot tr th,
table tbody tr td,
table tr td,
table tfoot tr td {
	display: table-cell;
	line-height: 1.6;
}

body {
	tab-size: 4;
}

h1,
h2,
h3,
#toctitle,
.sidebarblock>.content>.title,
h4,
h5,
h6 {
	line-height: 1.2;
	word-spacing: -0.05em;
}

h1 strong,
h2 strong,
h3 strong,
#toctitle strong,
.sidebarblock>.content>.title strong,
h4 strong,
h5 strong,
h6 strong {
	font-weight: 400;
}

.clearfix:before,
.clearfix:after,
.float-group:before,
.float-group:after {
	content: " ";
	display: table;
}

.clearfix:after,
.float-group:after {
	clear: both;
}

*:not(pre)>code {
	font-size: 0.9375em;
	font-style: normal !important;
	letter-spacing: 0;
	padding: 0.1em 0.5ex;
	word-spacing: -0.15em;
	background-color: var(--code-color);
	-webkit-border-radius: 4px;
	border-radius: 4px;
	line-height: 1.45;
	text-rendering: optimizeSpeed;
	word-wrap: break-word;
}

*:not(pre)>code.nobreak {
	word-wrap: normal;
}

*:not(pre)>code.nowrap {
	white-space: nowrap;
}

pre,
pre>code {
	line-height: 1.45;
	color: var(--code-text-color);
	font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
	font-weight: normal;
	text-rendering: optimizeSpeed;
}

em em {
	font-style: normal;
}

strong strong {
	font-weight: normal;
}

.keyseq {
	color: rgba(51, 51, 51, 0.8);
}

kbd {
	font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
	display: inline-block;
	color: var(--num-color);
	font-size: 0.65em;
	line-height: 1.45;
	background-color: #f7f7f7;
	border: 1px solid #ccc;
	-webkit-border-radius: 3px;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
	box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
	margin: 0 0.15em;
	padding: 0.2em 0.5em;
	vertical-align: middle;
	position: relative;
	top: -0.1em;
	white-space: nowrap;
}

.keyseq kbd:first-child {
	margin-left: 0;
}

.keyseq kbd:last-child {
	margin-right: 0;
}

.menuseq,
.menu {
	color: var(--num-color);
}

b.button:before,
b.button:after {
	position: relative;
	top: -1px;
	font-weight: normal;
}

b.button:before {
	content: "[";
	padding: 0 3px 0 2px;
}

b.button:after {
	content: "]";
	padding: 0 2px 0 3px;
}

p a>code:hover {
	color: var(--code-text-color);
}

#header,
#content,
#footnotes,
#footer {
	width: 100%;
	margin-left: auto;
	margin-right: auto;
	margin-top: 0;
	margin-bottom: 0;
	max-width: 62.5em;
	*zoom: 1;
	position: relative;
	padding-left: 0.9375em;
	padding-right: 0.9375em;
}

#header:before,
#header:after,
#content:before,
#content:after,
#footnotes:before,
#footnotes:after,
#footer:before,
#footer:after {
	content: " ";
	display: table;
}

#header:after,
#content:after,
#footnotes:after,
#footer:after {
	clear: both;
}

#content {
	margin-top: 1.25em;
}

#content:before {
	content: none;
}

#header>h1:first-child {
	color: var(--header-color);
	margin-top: 2.25rem;
	margin-bottom: 0;
}

#header>h1:first-child+#toc {
	margin-top: 8px;
	border-top: 1px solid #ddddd8;
}

#header>h1:only-child,
body.toc2 #header>h1:nth-last-child(2) {
	border-bottom: 1px solid #ddddd8;
	padding-bottom: 8px;
}

#header .details {
	border-bottom: 1px solid #ddddd8;
	line-height: 1.45;
	padding-top: 0.25em;
	padding-bottom: 0.25em;
	padding-left: 0.25em;
	color: rgba(0, 0, 0, 0.6);
	display: -ms-flexbox;
	display: -webkit-flex;
	display: flex;
	-ms-flex-flow: row wrap;
	-webkit-flex-flow: row wrap;
	flex-flow: row wrap;
}

#header .details span:first-child {
	margin-left: -0.125em;
}

#header .details span.email a {
	color: var(--header-color);
}

#header .details br {
	display: none;
}

#header .details br+span:before {
	content: "\00a0\2013\00a0";
}

#header .details br+span.author:before {
	content: "\00a0\22c5\00a0";
	color: var(--header-color);
}

#header .details br+span#revremark:before {
	content: "\00a0|\00a0";
}

#header #revnumber {
	text-transform: capitalize;
}

#header #revnumber:after {
	content: "\00a0";
}

#content>h1:first-child:not([class]) {
	color: var(--header-color);
	border-bottom: 1px solid #ddddd8;
	padding-bottom: 8px;
	margin-top: 0;
	padding-top: 1rem;
	margin-bottom: 1.25rem;
}

#toc {
	border-bottom: 1px solid #efefed;
	padding-bottom: 0.5em;
}

#toc>ul {
	margin-left: 0.125em;
}

#toc ul.sectlevel0>li>a {
	font-style: italic;
}

#toc ul.sectlevel0 ul.sectlevel1 {
	margin: 0.5em 0;
}

#toc ul {
	font-family: "Open Sans", "DejaVu Sans", sans-serif;
	list-style-type: none;
}

#toc li {
	line-height: 1.3334;
	margin-top: 0.3334em;
}

#toc a {
	text-decoration: none;
}

#toc a:active {
	text-decoration: underline;
}

#toctitle {
	color: #7a2518;
	font-size: 1.2em;
}

@media only screen and (min-width: 768px) {
	#toctitle {
		font-size: 1.375em;
	}

	body.toc2 {
		padding-left: 15em;
		padding-right: 0;
	}

	#toc.toc2 {
		margin-top: 0 !important;
		background-color: var(--nav-color);
		position: fixed;
		width: 15em;
		left: 0;
		top: 0;
		border-right: 1px solid #efefed;
		border-top-width: 0 !important;
		border-bottom-width: 0 !important;
		z-index: 1000;
		padding: 1.25em 1em;
		height: 100%;
		overflow: auto;
	}

	#toc.toc2 #toctitle {
		margin-top: 0;
		margin-bottom: 0.8rem;
		font-size: 1.2em;
	}

	#toc.toc2>ul {
		font-size: 0.9em;
		margin-bottom: 0;
	}

	#toc.toc2 ul ul {
		margin-left: 0;
		padding-left: 1em;
	}

	#toc.toc2 ul.sectlevel0 ul.sectlevel1 {
		padding-left: 0;
		margin-top: 0.5em;
		margin-bottom: 0.5em;
	}

	body.toc2.toc-right {
		padding-left: 0;
		padding-right: 15em;
	}

	body.toc2.toc-right #toc.toc2 {
		border-right-width: 0;
		border-left: 1px solid #efefed;
		left: auto;
		right: 0;
	}
}

@media only screen and (min-width: 1280px) {
	body.toc2 {
		padding-left: 20em;
		padding-right: 0;
	}

	#toc.toc2 {
		width: 20em;
	}

	#toc.toc2 #toctitle {
		font-size: 1.375em;
	}

	#toc.toc2>ul {
		font-size: 0.95em;
	}

	#toc.toc2 ul ul {
		padding-left: 1.25em;
	}

	body.toc2.toc-right {
		padding-left: 0;
		padding-right: 20em;
	}
}

#content #toc {
	border-style: solid;
	border-width: 1px;
	border-color: #e0e0dc;
	margin-bottom: 1.25em;
	padding: 1.25em;
	background: var(--nav-color);
	-webkit-border-radius: 4px;
	border-radius: 4px;
}

#content #toc> :first-child {
	margin-top: 0;
}

#content #toc> :last-child {
	margin-bottom: 0;
}

#footer {
	max-width: 100%;
	background-color: var(--num-color);
	padding: 1.25em;
}

#footer-text {
	color: rgba(255, 255, 255, 0.8);
	line-height: 1.44;
}

.sect1 {
	padding-bottom: 0.625em;
}

@media only screen and (min-width: 768px) {
	.sect1 {
		padding-bottom: 1.25em;
	}
}

.sect1+.sect1 {
	border-top: 1px solid #efefed;
}

#content h1>a.anchor,
h2>a.anchor,
h3>a.anchor,
#toctitle>a.anchor,
.sidebarblock>.content>.title>a.anchor,
h4>a.anchor,
h5>a.anchor,
h6>a.anchor {
	position: absolute;
	z-index: 1001;
	width: 1.5ex;
	margin-left: -1.5ex;
	display: block;
	text-decoration: none !important;
	visibility: hidden;
	text-align: center;
	font-weight: normal;
}

#content h1>a.anchor:before,
h2>a.anchor:before,
h3>a.anchor:before,
#toctitle>a.anchor:before,
.sidebarblock>.content>.title>a.anchor:before,
h4>a.anchor:before,
h5>a.anchor:before,
h6>a.anchor:before {
	content: "\00A7";
	font-size: 0.85em;
	display: block;
	padding-top: 0.1em;
}

#content h1:hover>a.anchor,
#content h1>a.anchor:hover,
h2:hover>a.anchor,
h2>a.anchor:hover,
h3:hover>a.anchor,
#toctitle:hover>a.anchor,
.sidebarblock>.content>.title:hover>a.anchor,
h3>a.anchor:hover,
#toctitle>a.anchor:hover,
.sidebarblock>.content>.title>a.anchor:hover,
h4:hover>a.anchor,
h4>a.anchor:hover,
h5:hover>a.anchor,
h5>a.anchor:hover,
h6:hover>a.anchor,
h6>a.anchor:hover {
	visibility: visible;
}

#content h1>a.link,
h2>a.link,
h3>a.link,
#toctitle>a.link,
.sidebarblock>.content>.title>a.link,
h4>a.link,
h5>a.link,
h6>a.link {
	color: #ba3925;
	text-decoration: none;
}

#content h1>a.link:hover,
h2>a.link:hover,
h3>a.link:hover,
#toctitle>a.link:hover,
.sidebarblock>.content>.title>a.link:hover,
h4>a.link:hover,
h5>a.link:hover,
h6>a.link:hover {
	color: #a53221;
}

.audioblock,
.imageblock,
.literalblock,
.listingblock,
.stemblock,
.videoblock {
	margin-bottom: 1.25em;
}

.admonitionblock td.content>.title,
.audioblock>.title,
.exampleblock>.title,
.imageblock>.title,
.listingblock>.title,
.literalblock>.title,
.stemblock>.title,
.openblock>.title,
.paragraph>.title,
.quoteblock>.title,
table.tableblock>.title,
.verseblock>.title,
.videoblock>.title,
.dlist>.title,
.olist>.title,
.ulist>.title,
.qlist>.title,
.hdlist>.title {
	text-rendering: optimizeLegibility;
	text-align: left;
	font-family: "Noto Serif", "DejaVu Serif", serif;
	font-size: 1rem;
	font-style: italic;
}

table.tableblock>caption.title {
	white-space: nowrap;
	overflow: visible;
	max-width: 0;
}

.paragraph.lead>p,
#preamble>.sectionbody>.paragraph:first-of-type p {
	color: var(--header-color);
}

table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p {
	font-size: inherit;
}

/* Custom SVG logos coloring */
path {
	fill: #02303A;
}

body.dark-theme {
    path {
        fill: white;
    }
}

@media (prefers-color-scheme: dark) {
    path {
        fill: white;
    }
    body.light-theme {
        path {
            fill: #02303A;
        }
    }
}

/* Custom scroll bar */
/* Works on Firefox */
.docs-navigation {
	scrollbar-width: auto;
	scrollbar-color: #686868 #e7e7e9;
}

/* Works on Chrome, Edge, and Safari */
.docs-navigation::-webkit-scrollbar {
	width: 12px;
}

.docs-navigation::-webkit-scrollbar-track {
	background: #e7e7e9;
}

.docs-navigation::-webkit-scrollbar-thumb {
	background-color: #686868;
	border-radius: 20px;
	border: 3px #686868;
}

body.dark-theme {
    /* Works on Firefox */
    * {
      scrollbar-width: auto;
      scrollbar-color: #686868 #242526;
    }

    /* Works on Chrome, Edge, and Safari */
    *::-webkit-scrollbar {
      width: auto;
    }

    *::-webkit-scrollbar-track {
      background: #242526;
    }

    *::-webkit-scrollbar-thumb {
      background-color: #686868;
      border-radius: 20px;
      border: 3px #686868;
    }
}

@media (prefers-color-scheme: dark) {
    /* Works on Firefox */
    * {
      scrollbar-width: auto;
      scrollbar-color: #686868 #242526;
    }

    /* Works on Chrome, Edge, and Safari */
    *::-webkit-scrollbar {
      width: auto;
    }

    *::-webkit-scrollbar-track {
      background: #242526;
    }

    *::-webkit-scrollbar-thumb {
      background-color: #686868;
      border-radius: 20px;
      border: 3px #686868;
    }

    body.light-theme {
        * {
          scrollbar-width: auto;
          scrollbar-color: #686868 #e7e7e9;
        }

        .docs-navigation {
            scrollbar-width: auto;
            scrollbar-color: #686868 #e7e7e9;
        }

        /* Works on Chrome, Edge, and Safari */
        .docs-navigation::-webkit-scrollbar {
            width: 12px;
        }

        .docs-navigation::-webkit-scrollbar-track {
            background: #e7e7e9;
        }

        .docs-navigation::-webkit-scrollbar-thumb {
            background-color: #686868;
            border-radius: 20px;
            border: 3px #686868;
        }
    }
}

/* Custom Admonition Blocks - Icons from https://github.com/primer/octicons */
.admonitionblock td div:last-of-type p {
	margin-bottom: 0em !important;
}

.admonitionblock {
	margin: 1.4rem 0 0
}

.admonitionblock i {
	font-family: inherit;
}

.admonitionblock i.fa {
	background: no-repeat 50%/1em 1em;
	display: inline-block;
	filter: var(--doc-icon-filter);
	font-style: normal;
	height: 1em;
	-webkit-hyphens: none;
	hyphens: none;
	vertical-align: -.125em;
	width: 1em
}

.admonitionblock p,
.admonitionblock td.content {
	font-size: 1rem;
}

.admonitionblock td.content>.title+*,
.admonitionblock td.content>:not(.title):first-child {
	margin-top: 0
}

.admonitionblock pre {
	font-size: calc(15/var(--rem-base)*1rem)
}

.admonitionblock>table {
	position: relative;
	table-layout: fixed;
	border: none;
	width: 100%
}

.admonitionblock td.content {
	word-wrap: anywhere;
	background: var(--admonition-background);
	padding: 1rem 1rem 1rem 1rem;
	width: 100%;
	border-radius: 4px;
}

.admonitionblock td.icon {
	background: linear-gradient(90deg, rgba(0, 0, 0, .2) 0, rgba(0, 0, 0, .2)) no-repeat 0 /2.075em 100%;
	border-radius: .5em;
	font-size: calc(15/var(--rem-base)*1rem);
	left: 0;
	line-height: 1;
	padding: .25em .075em;
	position: absolute;
	top: 0;
	transform: translate(-.5rem, -50%)
}

.admonitionblock td.icon i {
	align-items: center;
	background-position-x: .5em;
	display: inline-flex;
	filter: invert(100%);
	padding-left: 2em;
	vertical-align: initial;
	width: auto
}

.admonitionblock td.icon i::after {
	content: attr(title);
	filter: invert(100%);
	font-style: normal;
	font-weight: bold;
	margin: -.05em;
	padding: 0 .5em;
	text-transform: uppercase
}

.admonitionblock.caution td.icon {
	background-color: var(--caution-color);
	color: var(--caution-on-color)
}

.admonitionblock.caution td.icon i {
	background-image: url(./img/octicons-16.svg#view-flame)
}

.admonitionblock.important td.icon {
	background-color: var(--important-color);
	color: var(--important-on-color)
}

.admonitionblock.important td.icon i {
	background-image: url(./img/octicons-16.svg#view-stop)
}

.admonitionblock.note td.icon {
	background-color: var(--note-color);
	color: var(--note-on-color)
}

.admonitionblock.note td.icon i {
	background-image: url(./img/octicons-16.svg#view-info)
}

.admonitionblock.tip td.icon {
	background-color: var(--tip-color);
	color: var(--tip-on-color)
}

.admonitionblock.tip td.icon i {
	background-image: url(./img/octicons-16.svg#view-light-bulb)
}

.admonitionblock.warning td.icon {
	background-color: var(--warning-color);
	color: var(--warning-on-color)
}

.admonitionblock.warning td.icon i {
	background-image: url(./img/octicons-16.svg#view-alert)
}

/* Custom collapsible block */
details summary {
	width: 100%;
	padding: 1rem 0;
	border-top: 1px solid gray;
	position: relative;
	cursor: pointer;
	list-style: none;
}

details summary:after {
	content: "+";
	color: var(--black-color);
	position: absolute;
	font-size: 1.75rem;
	line-height: 0;
	margin-top: 0.3rem;
	right: 0;
	font-weight: 400;
	transform-origin: center;
	transition: 200ms linear;
}

details[open] summary:after {
	transform: rotate(45deg);
	font-size: 2rem;
}

details summary {
	outline: 0;
}

details p {
	font-size: 0.95rem;
	margin: 0 0 1rem;
	padding-top: 1rem;
}

.exampleblock>.content {
	border-style: solid;
	border-width: 1px;
	border-color: #e6e6e6;
	margin-bottom: 1.25em;
	padding: 1.25em;
	background: var(--white-color);
	-webkit-border-radius: 4px;
	border-radius: 4px;
}

.exampleblock>.content> :first-child {
	margin-top: 0;
}

.exampleblock>.content> :last-child {
	margin-bottom: 0;
}

.sidebarblock {
	border-style: solid;
	border-width: 1px;
	border-color: #e0e0dc;
	margin-bottom: 1.25em;
	padding: 1.25em;
	background: var(--nav-color);
	-webkit-border-radius: 4px;
	border-radius: 4px;
}

.sidebarblock> :first-child {
	margin-top: 0;
}

.sidebarblock> :last-child {
	margin-bottom: 0;
}

.sidebarblock>.content>.title {
	color: #7a2518;
	margin-top: 0;
	text-align: center;
}

.exampleblock>.content> :last-child> :last-child,
.exampleblock>.content .olist>ol>li:last-child> :last-child,
.exampleblock>.content .ulist>ul>li:last-child> :last-child,
.exampleblock>.content .qlist>ol>li:last-child> :last-child,
.sidebarblock>.content> :last-child> :last-child,
.sidebarblock>.content .olist>ol>li:last-child> :last-child,
.sidebarblock>.content .ulist>ul>li:last-child> :last-child,
.sidebarblock>.content .qlist>ol>li:last-child> :last-child {
	margin-bottom: 0;
}

.literalblock pre,
.listingblock pre:not(.highlight),
.listingblock pre[class="highlight"],
.listingblock pre[class^="highlight "],
.listingblock pre.prettyprint {
	background: var(--code-color);
}

.sidebarblock .literalblock pre,
.sidebarblock .listingblock pre:not(.highlight),
.sidebarblock .listingblock pre[class="highlight"],
.sidebarblock .listingblock pre[class^="highlight "],
.sidebarblock .listingblock pre.prettyprint {
	background: #f2f1f1;
}

.literalblock pre,
.literalblock pre[class],
.listingblock pre,
.listingblock pre[class] {
	-webkit-border-radius: 4px;
	border-radius: 4px;
	word-wrap: break-word;
	padding: 1em;
	font-size: 0.8125em;
}

.literalblock pre.nowrap,
.literalblock pre[class].nowrap,
.listingblock pre.nowrap,
.listingblock pre[class].nowrap {
	overflow-x: auto;
	white-space: pre;
	word-wrap: normal;
}

@media only screen and (min-width: 768px) {

	.literalblock pre,
	.literalblock pre[class],
	.listingblock pre,
	.listingblock pre[class] {
		font-size: 0.90625em;
	}
}

@media only screen and (min-width: 1280px) {

	.literalblock pre,
	.literalblock pre[class],
	.listingblock pre,
	.listingblock pre[class] {
		font-size: 1em;
	}
}

.literalblock.output pre {
	color: var(--code-color);
	background-color: var(--code-text-color);
}

.listingblock pre.highlightjs {
	padding: 0;
}

.listingblock pre.highlightjs>code {
	padding: 1em;
	-webkit-border-radius: 4px;
	border-radius: 4px;
}

.listingblock pre.prettyprint {
	border-width: 0;
}

.listingblock>.content {
	position: relative;
}

.listingblock code[data-lang]:before {
	display: block;
	content: attr(data-lang) "  ";
	position: absolute;
	font-size: 0.75em;
	top: 0.425rem;
	right: 1.0rem;
	line-height: 1;
	text-transform: uppercase;
	color: #999;
}

.listingblock:hover code[data-lang]:before {
	display: block;
}

.listingblock.terminal pre .command:before {
	content: attr(data-prompt);
	padding-right: 0.5em;
	color: #999;
}

.listingblock.terminal pre .command:not([data-prompt]):before {
	content: "$";
}

table.pyhltable {
	border-collapse: separate;
	border: 0;
	margin-bottom: 0;
	background: none;
}

table.pyhltable td {
	vertical-align: top;
	padding-top: 0;
	padding-bottom: 0;
	line-height: 1.45;
}

table.pyhltable td.code {
	padding-left: .75em;
	padding-right: 0;
}

pre.pygments .lineno,
table.pyhltable td:not(.code) {
	color: #999;
	padding-left: 0;
	padding-right: .5em;
	border-right: 1px solid #ddddd8;
}

pre.pygments .lineno {
	display: inline-block;
	margin-right: .25em;
}

table.pyhltable .linenodiv {
	background: none !important;
	padding-right: 0 !important;
}

.quoteblock {
	margin: 0 1em 1.25em 1.5em;
	display: table;
}

.quoteblock>.title {
	margin-left: -1.5em;
	margin-bottom: 0.75em;
}

.quoteblock blockquote,
.quoteblock blockquote p {
	color: var(--header-color);
	font-size: 1.15rem;
	line-height: 1.75;
	word-spacing: 0.1em;
	letter-spacing: 0;
	font-style: italic;
	text-align: justify;
}

.quoteblock blockquote {
	margin: 0;
	padding: 0;
	border: 0;
}

.quoteblock blockquote:before {
	content: "\201c";
	float: left;
	font-size: 2.75em;
	font-weight: bold;
	line-height: 0.6em;
	margin-left: -0.6em;
	color: var(--quoteblock-color);
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.quoteblock blockquote>.paragraph:last-child p {
	margin-bottom: 0;
}

.quoteblock .attribution {
	margin-top: 0.5em;
	margin-right: 0.5ex;
	text-align: right;
}

.quoteblock .quoteblock {
	margin-left: 0;
	margin-right: 0;
	padding: 0.5em 0;
	border-left: 3px solid rgba(0, 0, 0, 0.6);
}

.quoteblock .quoteblock blockquote {
	padding: 0 0 0 0.75em;
}

.quoteblock .quoteblock blockquote:before {
	display: none;
}

.verseblock {
	margin: 0 1em 1.25em 1em;
}

.verseblock pre {
	font-family: "Open Sans", "DejaVu Sans", sans;
	font-size: 1.15rem;
	color: var(--header-color);
	font-weight: 300;
	text-rendering: optimizeLegibility;
}

.verseblock pre strong {
	font-weight: 400;
}

.verseblock .attribution {
	margin-top: 1.25rem;
	margin-left: 0.5ex;
}

.quoteblock .attribution,
.verseblock .attribution {
	font-size: 0.9375em;
	line-height: 1.45;
	font-style: italic;
}

.quoteblock .attribution br,
.verseblock .attribution br {
	display: none;
}

.quoteblock .attribution cite,
.verseblock .attribution cite {
	display: block;
	letter-spacing: -0.025em;
	color: rgba(0, 0, 0, 0.6);
}

.quoteblock.abstract {
	margin: 0 0 1.25em 0;
	display: block;
}

.quoteblock.abstract blockquote,
.quoteblock.abstract blockquote p {
	text-align: left;
	word-spacing: 0;
}

.quoteblock.abstract blockquote:before,
.quoteblock.abstract blockquote p:first-of-type:before {
	display: none;
}

table.stretch {
    width: 100%;
}

table.tableblock {
	max-width: 100%;
	border-collapse: separate;
}

table.tableblock td>.paragraph:last-child p>p:last-child,
table.tableblock th>p:last-child,
table.tableblock td>p:last-child {
	margin-bottom: 0;
}

table.tableblock,
th.tableblock,
td.tableblock {
	border: 0 solid #dedede;
}

table.grid-all th.tableblock,
table.grid-all td.tableblock {
	border-width: 0 1px 1px 0;
}

table.grid-all tfoot>tr>th.tableblock,
table.grid-all tfoot>tr>td.tableblock {
	border-width: 1px 1px 0 0;
}

table.grid-cols th.tableblock,
table.grid-cols td.tableblock {
	border-width: 0 1px 0 0;
}

table.grid-all *>tr>.tableblock:last-child,
table.grid-cols *>tr>.tableblock:last-child {
	border-right-width: 0;
}

table.grid-rows th.tableblock,
table.grid-rows td.tableblock {
	border-width: 0 0 1px 0;
}

table.grid-all tbody>tr:last-child>th.tableblock,
table.grid-all tbody>tr:last-child>td.tableblock,
table.grid-all thead:last-child>tr>th.tableblock,
table.grid-rows tbody>tr:last-child>th.tableblock,
table.grid-rows tbody>tr:last-child>td.tableblock,
table.grid-rows thead:last-child>tr>th.tableblock {
	border-bottom-width: 0;
}

table.grid-rows tfoot>tr>th.tableblock,
table.grid-rows tfoot>tr>td.tableblock {
	border-width: 1px 0 0 0;
}

table.frame-all {
	border-width: 1px;
}

table.frame-sides {
	border-width: 0 1px;
}

table.frame-topbot {
	border-width: 1px 0;
}

th.halign-left,
td.halign-left {
	text-align: left;
}

th.halign-right,
td.halign-right {
	text-align: right;
}

th.halign-center,
td.halign-center {
	text-align: center;
}

th.valign-top,
td.valign-top {
	vertical-align: top;
}

th.valign-bottom,
td.valign-bottom {
	vertical-align: bottom;
}

th.valign-middle,
td.valign-middle {
	vertical-align: middle;
}

table thead th,
table tfoot th {
	font-weight: bold;
}

tbody tr th {
	display: table-cell;
	line-height: 1.6;
	background: var(--table-color);
}

tbody tr th,
tbody tr th p,
tfoot tr th,
tfoot tr th p {
	color: var(--num-color);
	font-weight: bold;
}

p.tableblock>code:only-child {
	background: none;
	padding: 0;
}

p.tableblock {
	font-size: 1em;
}

td>div.verse {
	white-space: pre;
}

ol {
	margin-left: 1.75em;
}

ul li ol {
	margin-left: 1.5em;
}

dl dd {
	margin-left: 1.125em;
}

dl dd:last-child,
dl dd:last-child> :last-child {
	margin-bottom: 0;
}

ol>li p,
ul>li p,
ul dd,
ol dd,
.olist .olist,
.ulist .ulist,
.ulist .olist,
.olist .ulist {
	margin-bottom: 0.625em;
}

ul.unstyled,
ol.unnumbered,
ul.checklist,
ul.none {
	list-style-type: none;
}

ul.unstyled,
ol.unnumbered,
ul.checklist {
	margin-left: 0.625em;
}

ul.checklist li>p:first-child>.fa-square-o:first-child,
ul.checklist li>p:first-child>.fa-check-square-o:first-child {
	width: 1em;
	font-size: 0.85em;
}

ul.checklist li>p:first-child>input[type="checkbox"]:first-child {
	width: 1em;
	position: relative;
	top: 1px;
}

ul.inline {
	margin: 0 auto 0.625em auto;
	margin-left: -1.375em;
	margin-right: 0;
	padding: 0;
	list-style: none;
	overflow: hidden;
}

ul.inline>li {
	list-style: none;
	float: left;
	margin-left: 1.375em;
	display: block;
}

ul.inline>li>* {
	display: block;
}

.unstyled dl dt {
	font-weight: normal;
	font-style: normal;
}

ol.arabic {
	list-style-type: decimal;
}

ol.decimal {
	list-style-type: decimal-leading-zero;
}

ol.loweralpha {
	list-style-type: lower-alpha;
}

ol.upperalpha {
	list-style-type: upper-alpha;
}

ol.lowerroman {
	list-style-type: lower-roman;
}

ol.upperroman {
	list-style-type: upper-roman;
}

ol.lowergreek {
	list-style-type: lower-greek;
}

.hdlist>table,
.colist>table {
	border: 0;
	background: none;
}

.hdlist>table>tbody>tr,
.colist>table>tbody>tr {
	background: none;
}

td.hdlist1,
td.hdlist2 {
	vertical-align: top;
	padding: 0 0.625em;
}

td.hdlist1 {
	font-weight: bold;
	padding-bottom: 1.25em;
}

.literalblock+.colist {
	margin-top: -0.5em;
}

.colist>table tr>td:first-of-type {
	padding: 0 0.75em;
	line-height: 1;
}

.colist>table tr>td:first-of-type img {
	max-width: initial;
}

.colist>table tr>td:last-of-type {
	padding: 0.25em 0;
}

.thumb,
.th {
	line-height: 0;
	display: inline-block;
	border: solid 4px var(--white-color);
	-webkit-box-shadow: 0 0 0 1px #dddddd;
	box-shadow: 0 0 0 1px #dddddd;
}

.imageblock.left,
.imageblock[style*="float: left"] {
	margin: 0.25em 0.625em 1.25em 0;
}

.imageblock.right,
.imageblock[style*="float: right"] {
	margin: 0.25em 0 1.25em 0.625em;
}

.imageblock>.title {
	margin-bottom: 0;
}

.imageblock.thumb,
.imageblock.th {
	border-width: 6px;
}

.imageblock.thumb>.title,
.imageblock.th>.title {
	padding: 0 0.125em;
}

.image.left,
.image.right {
	margin-top: 0.25em;
	margin-bottom: 0.25em;
	display: inline-block;
	line-height: 0;
}

.image.left {
	margin-right: 0.625em;
}

.image.right {
	margin-left: 0.625em;
}

a.image {
	text-decoration: none;
	display: inline-block;
}

a.image object {
	pointer-events: none;
}

sup.footnote,
sup.footnoteref {
	font-size: 0.875em;
	position: static;
	vertical-align: super;
}

sup.footnote a,
sup.footnoteref a {
	text-decoration: none;
}

sup.footnote a:active,
sup.footnoteref a:active {
	text-decoration: underline;
}

#footnotes {
	padding-top: 0.75em;
	padding-bottom: 0.75em;
	margin-bottom: 0.625em;
}

#footnotes hr {
	width: 20%;
	min-width: 6.25em;
	margin: -0.25em 0 0.75em 0;
	border-width: 1px 0 0 0;
}

#footnotes .footnote {
	padding: 0 0.375em 0 0.225em;
	line-height: 1.3334;
	font-size: 0.875em;
	margin-left: 1.2em;
	text-indent: -1.05em;
	margin-bottom: 0.2em;
}

#footnotes .footnote a:first-of-type {
	font-weight: bold;
	text-decoration: none;
}

#footnotes .footnote:last-of-type {
	margin-bottom: 0;
}

#content #footnotes {
	margin-top: -0.625em;
	margin-bottom: 0;
	padding: 0.75em 0;
}

.gist .file-data>table {
	border: 0;
	background: var(--white-color);
	width: 100%;
	margin-bottom: 0;
}

.gist .file-data>table td.line-data {
	width: 99%;
}

div.unbreakable {
	page-break-inside: avoid;
}

.big {
	font-size: larger;
}

.small {
	font-size: smaller;
}

.underline {
	text-decoration: underline;
}

.overline {
	text-decoration: overline;
}

.line-through {
	text-decoration: line-through;
}

.green {
    color: #006000;
}

.red {
    color: #bf0000;
}

.yellow {
    color: #bfbf00;
}

span.icon>.fa {
	cursor: default;
}

.conum[data-value] {
	display: inline-block;
	color: var(--white-color) !important;
	background-color: var(--num-color);
	-webkit-border-radius: 100px;
	border-radius: 100px;
	text-align: center;
	font-size: 0.75em;
	width: 1.67em;
	height: 1.67em;
	line-height: 1.67em;
	font-family: "Open Sans", "DejaVu Sans", sans-serif;
	font-style: normal;
	font-weight: bold;
}

.conum[data-value] * {
	color: var(--white-color) !important;
}

.conum[data-value]+b {
	display: none;
}

.conum[data-value]:after {
	content: attr(data-value);
}

pre .conum[data-value] {
	position: relative;
	top: -0.125em;
}

b.conum * {
	color: inherit !important;
}

.conum:not([data-value]):empty {
	display: none;
}

dt,
th.tableblock,
td.content,
div.footnote {
	text-rendering: optimizeLegibility;
}

h1,
h2,
p,
td.content,
span.alt {
	letter-spacing: -0.01em;
}

p strong,
td.content strong,
div.footnote strong {
	letter-spacing: -0.005em;
}

p,
blockquote,
dt,
td.content,
span.alt {
	font-size: 1.0625rem;
}

p {
	margin-bottom: 1.25rem;
}

.sidebarblock p,
.sidebarblock dt,
.sidebarblock td.content,
p.tableblock {
	font-size: 1em;
}

.exampleblock>.content {
	background-color: #fffef7;
	border-color: #e0e0dc;
	-webkit-box-shadow: 0 1px 4px #e0e0dc;
	box-shadow: 0 1px 4px #e0e0dc;
}

.print-only {
	display: none !important;
}

@media print {
	@page {
		margin: 1.25cm 0.75cm;
	}

	* {
		-webkit-box-shadow: none !important;
		box-shadow: none !important;
		text-shadow: none !important;
	}

	a {
		color: inherit !important;
		text-decoration: underline !important;
	}

	a.bare,
	a[href^="#"],
	a[href^="mailto:"] {
		text-decoration: none !important;
	}

	a[href^="http:"]:not(.bare):after,
	a[href^="https:"]:not(.bare):after {
		content: "(" attr(href) ")";
		display: inline-block;
		font-size: 0.875em;
		padding-left: 0.25em;
	}

	abbr[title]:after {
		content: " (" attr(title) ")";
	}

	pre,
	blockquote,
	tr,
	img,
	object,
	svg {
		page-break-inside: avoid;
	}

	thead {
		display: table-header-group;
	}

	svg {
		max-width: 100%;
	}

	p,
	blockquote,
	dt,
	td.content {
		font-size: 1em;
		orphans: 3;
		widows: 3;
	}

	h2,
	h3,
	#toctitle,
	.sidebarblock>.content>.title,
	#toctitle,
	.sidebarblock>.content>.title {
		page-break-after: avoid;
	}

	#toc,
	.sidebarblock,
	.exampleblock>.content {
		background: none !important;
	}

	#toc {
		border-bottom: 1px solid #ddddd8 !important;
		padding-bottom: 0 !important;
	}

	.sect1 {
		padding-bottom: 0 !important;
	}

	.sect1+.sect1 {
		border: 0 !important;
	}

	#header>h1:first-child {
		margin-top: 1.25rem;
	}

	body.book #header {
		text-align: center;
	}

	body.book #header>h1:first-child {
		border: 0 !important;
		margin: 2.5em 0 1em 0;
	}

	body.book #header .details {
		border: 0 !important;
		display: block;
		padding: 0 !important;
	}

	body.book #header .details span:first-child {
		margin-left: 0 !important;
	}

	body.book #header .details br {
		display: block;
	}

	body.book #header .details br+span:before {
		content: none !important;
	}

	body.book #toc {
		border: 0 !important;
		text-align: left !important;
		padding: 0 !important;
		margin: 0 !important;
	}

	body.book #toc,
	body.book #preamble,
	body.book h1.sect0,
	body.book .sect1>h2 {
		page-break-before: always;
	}

	.listingblock code[data-lang]:before {
		display: block;
	}

	#footer {
		background: none !important;
		padding: 0 0.9375em;
	}

	#footer-text {
		color: rgba(0, 0, 0, 0.6) !important;
		font-size: 0.9em;
	}

	.hide-on-print {
		display: none !important;
	}

	.print-only {
		display: block !important;
	}

	.hide-for-print {
		display: none !important;
	}

	.show-for-print {
		display: inherit !important;
	}
}

/* END asciidoc.css */

html,
body {
	margin: 0;
	padding: 0;
}

html {
	font-size: 16px;
	font-weight: 400;
	line-height: 1.5;
}

body {
	color: var(--text-color);
	background-color: var(--white-color);
	font-family: "Lato", "Helvetica Neue", Arial, sans-serif;
	line-height: 1.5;
	-webkit-text-size-adjust: 100%;
	-ms-text-size-adjust: 100%;
}

/* Links */
a {
	color: #1DA2BD;
	text-decoration: none;
}

a:hover,
a:focus {
	text-decoration: underline;
}

#content a[href^='../dsl/'],
#content a[href^='../kotlin-dsl/'],
#content a[href^='../javadoc/'] {
	font-family: 'Inconsolata', monospace;
	font-style: normal;
	border-bottom: 1px dotted rgba(29, 162, 189, 0.5);
	padding: 0 1px;
}

#content a[href^='../dsl/']:hover,
#content a[href^='../dsl/']:focus,
#content a[href^='../kotlin-dsl/']:hover,
#content a[href^='../kotlin-dsl/']:focus,
#content a[href^='../javadoc/']:hover,
#content a[href^='../javadoc/']:focus {
	text-decoration: none;
}

/* Copy */

p {
	font-size: 1rem;
}

pre,
pre>code,
code {
	font-family: 'Inconsolata', monospace;
}

h1,
h2,
h3,
h4,
h5,
h6,
#toctitle,
.sidebarblock>.content>.title {
	font-family: inherit;
	font-weight: 500;
	color: inherit;
}

h1 {
	font-size: 2rem;
}

h2 {
	font-size: 1.5rem;
}

h3 {
	font-size: 1.125rem;
}

h4 {
	font-size: 1.0625rem;
}

h5,
h6 {
	font-size: 1rem;
}

b,
strong {
	font-weight: 500;
}

dl {
	margin: 0 0 1.25rem 1.5rem;
}

.dlist dt code {
	color: var(--text-color);
	font-size: 1em;
	font-weight: bold;
}

.dlist p {
	margin-bottom: 0.625rem;
}

.sr-only {
	border: 0;
	clip: rect(0, 0, 0, 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}

/* Layout */
.main-content>.appendix,
.main-content>.book,
.main-content>.chapter,
.main-content>.footer {
	background-color: var(--white-color);
	border-radius: 5px;
	max-width: 45rem;
	padding: 1.5rem;
}

@media screen and (max-width: 45em) {
	.footer {
		max-width: 100%;
	}

	.main-content>.appendix,
	.main-content>.book,
	.main-content>.chapter {
		margin-top: 0;
		margin-bottom: 0;
	}
}

/* Override asciidoc styles */
#header {
	position: static;
}

#header,
#content {
	padding: 0;
}

#header .details {
	/* TODO: Pretty sure there's a way to avoid Asciidoc generating details */
	display: none;
}

p {
	color: var(--text-color);
}

h1,
h2,
p,
p strong,
td.content,
td.content strong,
div.footnote strong,
span.alt {
	letter-spacing: normal;
}

.subheader,
.admonitionblock td.content>.title,
.audioblock>.title,
.exampleblock>.title,
.imageblock>.title,
.listingblock>.title,
.literalblock>.title,
.stemblock>.title,
.openblock>.title,
.paragraph>.title,
.quoteblock>.title,
table.tableblock>.title,
.verseblock>.title,
.videoblock>.title,
.dlist>.title,
.olist>.title,
.ulist>.title,
.qlist>.title,
.hdlist>.title {
	color: inherit;
	font-family: inherit;
}

.listingblock .title,
.listingblock .title code {
	font-style: normal;
	font-weight: bold;
}

.imageblock,
.videoblock {
	padding: 0.25em;
}

p.lead,
.paragraph.lead>p,
#preamble>.sectionbody>.paragraph:first-of-type p {
	font-size: 1.0625rem;
}

.paragraph.lead>p,
#preamble>.sectionbody>.paragraph:first-of-type p {
	color: inherit;
}

.sect1 {
	padding-bottom: 0;
}

.sect1+.sect1 {
	border: 0 none;
}

.verseblock pre {
	font-family: "Lato", Arial, sans-serif;
}

td.hdlist1 {
	padding-bottom: 0.625rem;
}

td.hdlist2 p {
	margin-bottom: 0.625rem;
}

body.book #header>h1 {
	border: 0;
}

#header>h1:first-child {
	margin-top: 0;
}

#content a.link {
	color: var(--title-color);
}

.highlight .com {
	color: #777;
}

.listingblock pre.highlightjs>code {
	overflow-x: auto;
}

.listingblock pre.highlight {
	overflow-x: auto;
}

.listingblock pre.highlight>code {
	white-space: pre;
}

.conum[data-value] {
	font-family: "Lato", Arial, sans-serif;
}

.colist>table tr>td:first-of-type {
	padding-top: 0.25em;
	padding-bottom: 0.25em;
	line-height: 1.4;
	vertical-align: baseline;
}

/*
 * Samples
 */
.exampleblock>.content {
	background-color: inherit;
	border: 0 none;
	box-shadow: none;
	padding: 0;
	padding-bottom: 0.7rem;
	margin-bottom: 0;
}

.exampleblock>.content .title {
	background-color: var(--code-color);
	border-top: 1px solid #ccc;
	font-family: 'Inconsolata', monospace;
	margin: 0;
	padding: 1em 1em 0;
}

.exampleblock>.title>a {
	text-decoration: none;
	color: var(--num-color);
}

.exampleblock .listingblock {
	margin: 0;
}

/*
 * Ensure that blocks of code do not wrap by applying the behavior of `[listing%nowrap]` by default.
 *
 * These styles are copied from a CSS ruleset in asciidoctor.css that has the same group of
 * selectors except that they end with `.nowrap`.
 */
.openblock .content {
	background: var(--admonition-background);
	margin-bottom: 1.25em;
	padding: 1em 1em 0em 1em;
	border-radius: 4px;
	overflow: auto !important;
}

.literalblock pre,
.literalblock pre[class],
.listingblock pre,
.listingblock pre[class] {
	overflow-x: auto;
	white-space: pre;
	word-wrap: normal;
}

/*
 * This CSS ruleset solves: https://github.com/gradle/guides/issues/113#issuecomment-314826749.
 */
.literalblock pre::after,
.literalblock pre[class]::after,
.listingblock pre::after,
.listingblock pre[class]::after {
	content: "";
}

.quoteblock blockquote,
.quoteblock blockquote p {
	text-align: left;
	text-align: start;
}

div.screenshot {
	box-shadow: 0 0 20px 1px rgba(0, 0, 0, 0.2);
	margin-left: auto;
	margin-right: auto;
	width: 90%;
}

.inset {
	box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.1);
	padding: 1em;
}

.image.inline-icon img {
	vertical-align: sub;
}

/* TOC */
#header>h1:first-child+#toc {
	background: none;
	border: 0 none;
	margin-top: 0;
}

#toc,
#content #toc {
	border: 0 none;
}

#toc>ul {
	margin-left: 0;
	font-family: inherit;
}

#toc>ul>li {
	line-height: 1.25;
	margin-top: 0;
	padding-bottom: 0.5rem;
}

#toc>ul>li:last-of-type {
	padding-bottom: 0;
}

#toc a {
	font-style: normal;
}

#toc a:hover,
#toc a:focus,
#toc a:hover code,
#toc a:focus code {
	color: #1DA2BD;
}

#toc a:active {
	text-decoration: none;
}

/* Site header specific styles */
.hamburger {
	background-color: transparent;
	background-image: none;
	border: none;
	border-radius: 4px;
	cursor: pointer;
	margin-left: auto;
	padding: 11px 10px;
}

.hamburger:focus {
	outline: 0;
}

.hamburger__bar {
	display: block;
	width: 22px;
	height: 2px;
	background-color: var(--black-color);
	border-radius: 1px;
}

.hamburger__bar+.hamburger__bar {
	margin-top: 4px;
}

.site-header {
	background-color: var(--top-header-color);
}

/* Override javadoc styles */
.site-header div {
	font-family: 'Lato', Arial, sans-serif;
}

.site-header__navigation-header a {
	align-self: center;
	border-bottom: 0 none;
	height: 36px;
}

.site-header .site-header-version {
	align-self: center;
	color: #1da2bd;
	font-size: 20px;
	padding-left: 1px;
	margin-top: 22px;
}

.site-header__navigation {
    z-index: 2;
	display: flex;
	flex-direction: column;
}

.site-header__navigation-header {
	display: flex;
	flex: 0 0 auto;
	margin-left: 12px;
}

.site-header__navigation-collapsible {
	flex: 1 1 auto;
	height: 210px;
	overflow: visible;
	transition: height 0.3s ease;
}

.site-header__navigation-items {
	display: flex;
	flex-direction: column;
	flex-wrap: wrap;
	align-items: flex-start;
	max-height: 210px;
	/* This matches the collapsible height above */
	margin: 0 20px;
	padding-top: 12px;
	padding-left: 0;
	list-style-type: none;
}

.site-header__navigation-item {
	flex: 0 1 auto;
	font-size: 16px;
	width: 250px;
}

.site-header__navigation-item .site-header__navigation-link {
	position: relative;
	display: inline-block;
	cursor: pointer;
	width: 100%;
	padding: 5px;
	line-height: 20px;
	border: 0 none;
	color: var(--text-color);
	text-decoration: none;
	transition: none;
	-o-transition: none;
	-moz-transition: none;
	-webkit-transition: none;
}

.site-header__navigation-item .site-header__navigation-link:hover {
	color: #1DA2BD;
}

.site-header__navigation-item .site-header__navigation-link.active {
	font-weight: 500;
}

/* Navigation submenu styles */
.site-header__navigation-submenu-section {
	position: relative;
}

.site-header__navigation-submenu-section .site-header__down-arrow {
	width: 8px;
	height: 8px;
	margin-left: 2px;
	margin-top: 0;
}

.site-header__navigation-submenu-section .site-header__navigation-link:hover path {
	fill: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link:hover {
	color: #1DA2BD;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu {
	display: none;
	width: 170px;
	background-color: var(--menu-burger-color);
	top: 40px;
	left: 7px;
	/* NOTE: This must match the padding of .site-header__navigation-link */
	padding: 3px 10px 6px 10px;
	z-index: 100;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link {
	width: 100%;
	color: var(--text-color);
	white-space: nowrap;
	display: inline-block;
	padding-top: 3px;
	border: 0 none;
	transition: none;
	-o-transition: none;
	-moz-transition: none;
	-webkit-transition: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
	display: inline-block;
	font-size: 16px;
}

.site-header__navigation-submenu-section.open .site-header__navigation-submenu {
	display: block;
}

/* Top navigation mobile styles */
@media (max-width: 1023px) {
	.site-header__navigation-collapsible--collapse {
		height: 0;
		overflow-y: hidden;
	}

	.site-header__navigation-submenu-section .site-header__navigation-submenu {
		padding: 0 1rem 0.5rem 1.5rem;
		display: block;
		top: 30px !important;
		left: 0 !important;
	}

	.site-header__navigation-item,
	.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
		font-size: 18px;
	}

	.site-header {
		padding: 5px 12px;
	}

	.site-header-version {
		display: none;
	}

	.site-footer__navigation {
		flex-direction: column;
	}

	.site-footer__links {
		flex-wrap: wrap;
	}

	.site-footer__link-group {
		margin-bottom: 1rem;
	}
}

/* Top navigation desktop styles */
@media (min-width: 1024px) {
	.site-header {
		-webkit-box-shadow: 0 2px 4px 0 var(--box-shadow-color);
		-moz-box-shadow: 0 2px 4px 0 var(--box-shadow-color);
		box-shadow: 0 2px 4px 0 var(--box-shadow-color);
		z-index: 2;
	}

	body.dark-theme {
		.site-header {
			-webkit-box-shadow: none;
			-moz-box-shadow: none;
			box-shadow: none;
			z-index: 2;
		}
	}

    @media (prefers-color-scheme: dark) {
        .site-header {
            -webkit-box-shadow: none;
            -moz-box-shadow: none;
            box-shadow: none;
            z-index: 2;
        }
        body.light-theme {
        	.site-header {
        		-webkit-box-shadow: 0 2px 4px 0 var(--box-shadow-color);
        		-moz-box-shadow: 0 2px 4px 0 var(--box-shadow-color);
        		box-shadow: 0 2px 4px 0 var(--box-shadow-color);
        		z-index: 2;
        	}
        }
    }

	/*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors.
     */
	#content h2[id],
	#content h3[id],
	#content h4[id],
	#content h5[id] {
		padding-top: 60px;
	}

	#content h2[id] {
		/* Little extra room above h2s */
		margin-top: -1em;
	}

	#content h3[id],
	#content h4[id],
	#content h5[id] {
		margin-top: -60px;
	}

	.site-header__navigation {
		flex-direction: row;
	}

	.site-header__navigation-button {
		display: none;
	}

	.site-header__navigation-items {
		flex-direction: row;
		align-items: center;
		float: right;
		width: auto;
		padding-top: 0;
	}

	.site-header__navigation-item {
		width: auto;
	}

	.site-header__navigation-item .site-header__navigation-link {
		padding: 15px 18px;
	}

	.site-header__navigation-item:last-of-type .site-header__navigation-link {
		padding-right: 0;
	}

	.site-header__navigation-link--button {
		padding: 6px 12px;
	}

	.site-header__navigation-collapsible {
		height: auto;
	}

	.site-header__navigation-submenu-section .site-header__navigation-submenu {
		position: absolute;
		border: 1px solid #9a9a9a;
		border-radius: 3px;
	}

	.site-header__navigation-submenu-section:hover .site-header__navigation-submenu {
		display: block;
	}

	/*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors. It doesn't work if you try
      to apply the padding and margin to the `h` elements directly.
     */
	.chapter a[name],
	.chapter .anchor {
		padding-top: 60px;
		margin-top: -60px;
		text-decoration: none;
		border: none;
		display: inline-block;
	}
}

/* Side Navigation styles */
/* Docs Navigation */
.docs-navigation {
	border-right: 1px solid var(--various-border-color);
}

.docs-navigation .search-container {
	display: none;
	margin-bottom: 1rem;
}

.docs-navigation a {
	color: var(--text-color);
	display: block;
	font-size: .95rem;
	position: relative;
}

.docs-navigation a:focus {
	outline: none;
}

.docs-navigation a:hover {
	color: #35c1e4;
	text-decoration: none;
}

.docs-navigation a code {
	color: var(--text-color);
	overflow-wrap: break-word;
	padding: 0;
	word-break: break-all;
}

.docs-navigation a.active {
	color: #06A0CE;
	outline: 0;
	border: none;
	-moz-outline-style: none;
}

.docs-navigation a.active:hover {
	color: #35c1e4;
	text-decoration: underline;
}

.docs-navigation ul {
	list-style-type: none;
	margin: 0;
	padding: 0;
}

.docs-navigation li>ul>li a {
	font-size: 14px;
	color: #7d7d7d;
}

.docs-navigation ul:last-of-type {
	margin-bottom: 0;
}

.docs-navigation li {
	margin-top: 0.3334em;
	line-height: 1.3334;
}

.docs-navigation li:last-of-type {
	margin-bottom: 0;
}

.docs-navigation .nav-dropdown:before {
	content: '\2023';
	font-size: 28px;
	position: absolute;
	margin-left: -14px;
	margin-top: -8px;
}

.docs-navigation .nav-dropdown.expanded:before {
	transform: rotate(90deg);
}

.docs-navigation>ul ul,
.docs-navigation>ul ul ul {
	display: none;
	height: 0;
	margin-left: 1rem;
}

.docs-navigation>ul ul:target,
.docs-navigation>ul ul:target ul,
.docs-navigation>ul .nav-dropdown.expanded~ul {
	display: block;
	height: auto;
}

.docs-navigation h3 {
	font-size: .95rem;
	font-weight: 600;
	line-height: 1.5;
	margin: 1.5em 0 0;
}

.docs-navigation .docs-home-link {
	position: relative;
}

@media screen and (min-width: 45rem) {
	.main-content {
		display: flex;
	}
}

/* User guide navigation appears for desktops */
@media screen and (min-width: 64rem) {
	.docs-navigation {
		flex: 0 0 auto;
		width: 13.75rem;
	}

	.main-content>.appendix,
	.main-content>.book,
	.main-content>.chapter {
		flex: 0 0 auto;
		margin: 0 auto;
	}
}

/**
 * For mobile devices, we show navigation at bottom of page.
 *
 * This is the simplest solution to this issue.
 */
@media not screen and (min-width: 64rem) {
	/* Repeat the class twice to prioritize our mobile classes! */

	.content.content {
		/* Make the height equal to
           the real height of content */
		overflow: visible;
	}

	.main-content {
		/* Main content show first */
		flex-direction: column-reverse;
	}

	.docs-navigation.docs-navigation {
		/* Fill the main container */
		width: 100%;

		/* Don't clip the navigation container */
		overflow: visible;
	}
}

/* Userguide Meta */
.chapter-meta {
	float: right;
	text-align: right;
}

.chapter-meta .edit-link {
	color: #999;
	font-size: 0.9em;
	padding-right: 3px;
}

.chapter-meta .edit-link svg {
	margin-right: 1px;
}

/* Clever use of RTL to fill in all stars to left of hover position */
.rating {
	direction: rtl;
}

.rating>.star {
	cursor: pointer;
	display: table-cell;
	padding: 3px;
}

.rating>.star:hover>svg>g,
.rating>.star:hover~.star>svg>g,
.rating>.star.selected>svg>g,
.rating>.star.selected~.star>svg>g {
	fill: #999;
}

/* Footer styles */
.site-footer {}

.site-footer__navigation {
	display: flex;
	padding: 30px 12px;
	max-width: 62.5rem;
	margin: 0 auto;
	padding-left: 5rem;
}

@media not screen and (min-width: 64rem) {
	.site-footer__navigation {
		/* same to nav.docs-navigation for mobiles */
		padding: 20px 20px 20px 26px;
	}
}

.site-footer__links {
	display: flex;
	flex: 1 1 auto;
}

.site-footer__links .site-footer__links-list {
	list-style-type: none;
	margin: 0;
}

.site-footer__links .site-footer__links-list a {
	color: var(--footer-other-text-color);
}

.site-footer__link-group {
	flex: 1 1 auto;
	flex-basis: 175px;
}

.site-footer__link-group header {
	color: var(--text-color);
}

.site-footer__subscribe-newsletter .newsletter-form__header h5 {
	color: var(--text-color);
	margin-top: 0;
}

.site-footer__subscribe-newsletter p {
	font-size: 0.875rem;
	margin: 2px 0 0 2px;
	opacity: 0.7;
}

.site-footer__subscribe-newsletter .disclaimer {
	color: var(--footer-other-text-color);
	font-size: 0.75rem;
	opacity: 0.55;
}

.site-footer__subscribe-newsletter .newsletter-form {
	padding-top: 6px;
	display: flex;
	justify-content: flex-start;
}

.site-footer__subscribe-newsletter .email,
.site-footer__subscribe-newsletter .submit {
	height: 40px;
}

.site-footer__subscribe-newsletter .email {
	line-height: 40px;
	width: 250px;
	color: #1DA2BD;
	font-size: 16px;
	padding-left: 20px;
	border-top-left-radius: 4px;
	border-bottom-left-radius: 4px;
	border: 1px solid var(--footer-form-color);
}

.site-footer__subscribe-newsletter .submit {
	font-family: inherit;
	font-size: inherit;
	line-height: inherit;
	width: 100px;
	background-color: #1BA8CB;
	color: #fff;
	font-weight: 500;
	border-top-right-radius: 4px;
	border-bottom-right-radius: 4px;
	border-style: none;
	cursor: pointer;
	transition: all .3s ease;
}

/* Secondary footer (below) */
.site-footer-secondary {
	background-color: var(--footer-white-color);
	border-top: 1px solid var(--various-border-color);
	width: 100%;
	z-index: 1;
}

body.dark-theme {
	.site-footer-secondary {
		background-color: var(--footer-white-color);
		border-top: none;
		width: 100%;
		z-index: 1;
	}
}

@media (prefers-color-scheme: dark) {
	.site-footer-secondary {
		background-color: var(--footer-white-color);
		border-top: none;
		width: 100%;
		z-index: 1;
	}
	body.light-theme {
        .site-footer-secondary {
            background-color: var(--footer-white-color);
            border-top: 1px solid var(--various-border-color);
            width: 100%;
            z-index: 1;
        }
    }
}

.site-footer-secondary__contents {
	display: flex;
	align-items: center;
	justify-content: space-between;
	max-width: 75rem;
	margin-left: auto;
	margin-right: auto;
	font-size: 0.875rem;
	padding: 0.5rem 0.75rem;
}

/*
 * 1. Value is the largest computed width among 'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy,
.site-footer__secondary-links {
	flex-grow: 0;
	/* 1. */
}

/*
 * 1. 'flex-shrink: 1' is applied to the element with the smallest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy {
	flex-shrink: 1;
	/* 1. */
}

.site-footer__logo {
	flex: 0 0 auto;
	margin-right: 10px;
	margin-left: 10px;
}

.site-footer__logo svg {
	width: 35px;
	height: 35px;
}

/*
 * 1. 'flex-shrink: 0' is applied to the element with the largest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__secondary-links {
	flex-shrink: 0;
	/* 1 */
	text-align: right;
	white-space: nowrap;
}

.site-footer-secondary a {
	color: #999;
}

.site-footer-secondary__links a:not(:last-child) {
	padding-right: 10px;
}

.site-footer-secondary__links a:not(:first-child) {
	padding-left: 10px;
}

@media all and (max-width: 29.99rem) {

	.site-footer__rights,
	.site-footer-secondary__links {
		display: none;
	}

	.site-footer__logo {
		order: 1;
		text-align: left;
	}

	.site-footer__copy {
		order: 2;
		text-align: right;
	}
}

/* Avoid the footer taking up much of the screen on short displays */
@media all and (max-height: 56.25rem) {
	.site-footer__navigation {
		margin: 1.5rem auto 0 auto;
		padding-top: 0;
		padding-bottom: 0;
	}
}

@media screen and (min-width: 84.375rem) {
	.ui-logos .ui-logo {
		box-shadow: 0 6px 15px 1px rgba(0, 0, 0, 0.56);
	}
}

/* User Manual Home */
.technology-logos,
.ui-logos {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	justify-content: space-around;
}

.technology-logo,
.ui-logo {
	flex: 0 1 auto;
}

.ui-logo {
	width: 224px;
	height: 135px;
	margin: 12px;
}

/* Samples download button */
.download {
	display: flex;
}

.download a {
	border-style: solid;
	border-width: 1px;
	text-decoration: none;
	padding: 5px;
	display: block;
	width: 10em;
	margin: 5px;
}

.download ul {
	list-style: none;
	list-style-type: none;
}

.download li {
	float: right;
}

.docs-navigation {
	width: 18rem;
	padding: 20px 20px 20px 26px;
	background: var(--nav-color);
	overflow-y: scroll;
	overflow-x: auto;
}

.layout {
	display: flex;
	flex-direction: column;
	overflow: hidden;
	height: 100vh;
}

.main-content {
	overflow-y: auto;
	overflow-x: auto;
	display: flex;
}

.content {
	flex: 1 1 auto;
	overflow: auto;
	padding-left: 0;
	padding-right: 0;
}

.content .chapter {
	padding: 2rem 2.4rem;
}

#toc a:active {
	font-weight: 500;
}

.site-header {
	margin-bottom: 1rem;
}

.site-header__navigation-submenu-item {
	padding: 2px 0;
}

.site-footer {
	background-color: var(--footer-color);
	padding: 20px 0 40px 0;
	border-top: 1px solid var(--various-border-color);
}

#header {
	margin-left: 0;
}

#header>h1:first-child {
	margin-bottom: 40px;
}

@media screen and (min-width: 64rem) {
	#header {
		margin-bottom: 20px;
	}

	.site-header {
		margin-bottom: 0;
		z-index: 2;
	}

	.site-header__navigation-header {
		margin-top: -7px;
	}

	.site-header__navigation-submenu-section:after {
		content: '\2023';
		font-size: 28px;
		position: absolute;
		transform: rotate(90deg);
		margin-right: 10px;
		top: 5px;
		right: -7px;
	}

	.site-footer__navigation {
		flex-wrap: wrap;
	}

	.site-footer__link-group {
		flex: 1 1 auto;
	}

	.site-footer__links {
		margin-bottom: 1rem;

	}
}

@media screen and (min-width: 75rem) {
	.content .chapter {
		box-sizing: content-box;
	}

	#content {
		padding-right: 260px;
		margin: 0;
	}

    #header {
    	padding-right: 260px;
    }

	/* #toc here must be referenced as #header #toc
            since we don't want to change single page #toc */
	#header #toc {
		position: fixed;
		margin: 0 auto;
		padding-bottom: 0;
		right: 0;
		top: 65px;
		width: 260px;
		z-index: 1;
		overflow: auto;
		border-radius: 0 0 5px 0;
		max-height: calc(100% - 118px);
		margin-right: 15px;
	}

	#header #toctitle {
		margin-top: 1.3em;
	}

	#header #toc>ul {
		/* margin-left have to increase if you change border thickness of active toc item */
		margin-left: 1px;
		border-left: 1px solid #666;
		margin-bottom: 0;
		padding-right: 10px;
		padding-bottom: 0.5rem;
		background-color: var(--white-color);
	}

	#header #toc>ul>li,
	#toc>ul>li:last-of-type {
		padding: 0.5rem 0;
		margin: 0;
	}

	#header #toc a {
		padding-left: 10px;
		font-weight: 400;
		color: var(--text-color);
		font-size: .95rem;
		display: inline-block;
	}

	#header #toc a.active {
		font-weight: 500;
		border-left: 3px solid #01303a;
		margin-left: -2px;
		padding-left: 9px;
	}

	.site-footer__navigation {
		flex-wrap: wrap;
		margin-left: auto;
		padding-left: 3rem;
	}

	.site-footer__link-group {
		flex: 0.15 1 auto;
	}

	.site-footer__subscribe-newsletter {
		/* A fix so subscribe disclaimer does not go under long ToC */
		max-width: calc(100% - 17rem);
	}
}

@media screen and (min-width: 80rem) {
	.site-footer__subscribe-newsletter {
		max-height: none;
	}
}

@media screen and (min-width: 100rem) {
	.content .chapter {
		max-width: 60.5rem;
	}

	#header {
		margin: 0 auto;
		padding-right: 0;
	}

	#content {
		padding-right: 0;
		margin: 0 auto;
	}

	#header #toc {
		right: initial;
		margin-left: 62.5rem;
	}

	.site-footer__navigation {
		padding-left: 0;
	}

	.site-footer__link-group {
		flex: 0.2 1 auto;
	}
}

@media screen and (min-width: 112rem) {
	.content .chapter {
		max-width: 62.5rem;
		margin: 0 auto;
		padding-right: 3.5rem;
		position: relative;
		left: -130px;
	}

	#header #toc {
		right: initial;
		margin-left: 64.5rem;
	}

	.site-footer__link-group {
		flex: 0.2 1 auto;
	}
}


@supports (-moz-appearance:meterbar) and (background-blend-mode:difference, normal) {

	/* Firefox only */
	.site-header__navigation-submenu-section:after {
		top: 2px;
		right: -4px;
	}
}

/* Added dark mode and other items for outdated Prettify.css */
code[data-lang="text"] .pln,
code[data-lang="text"] .str,
code[data-lang="text"] .kwd,
code[data-lang="text"] .com,
code[data-lang="text"] .typ,
code[data-lang="text"] .lit,
code[data-lang="text"] .pun,
code[data-lang="text"] .opn,
code[data-lang="text"] .clo,
code[data-lang="text"] .tag,
code[data-lang="text"] .atn,
code[data-lang="text"] .atv,
code[data-lang="text"] .dec,
code[data-lang="text"] .var,
code[data-lang="text"] .fun {
	color: #000;
}

body.dark-theme {
	code[data-lang="text"] .pln,
	code[data-lang="text"] .str,
	code[data-lang="text"] .kwd,
	code[data-lang="text"] .com,
	code[data-lang="text"] .typ,
	code[data-lang="text"] .lit,
	code[data-lang="text"] .pun,
	code[data-lang="text"] .opn,
	code[data-lang="text"] .clo,
	code[data-lang="text"] .tag,
	code[data-lang="text"] .atn,
	code[data-lang="text"] .atv,
	code[data-lang="text"] .dec,
	code[data-lang="text"] .var,
	code[data-lang="text"] .fun {
		color: #fff !important;
	}

    .com       { color: #909090 !important; }
    .str, .tag { color: #90a959 !important; }
    .kwd, .atv { color: #d28445 !important; }
    .typ       { color: #f4bf75 !important; }
    .lit, .atn { color: #6a9fb5 !important; }
    .pun, .pln,
    .opn, .clo { color: #d0d0d0 !important; }
    .dec, .var { color: #aa759f !important; }

	li.L1,
	li.L3,
	li.L5,
	li.L7,
	li.L9 {
		background: #111 !important;
	}
}

@media (prefers-color-scheme: dark) {
	code[data-lang="text"] .pln,
	code[data-lang="text"] .str,
	code[data-lang="text"] .kwd,
	code[data-lang="text"] .com,
	code[data-lang="text"] .typ,
	code[data-lang="text"] .lit,
	code[data-lang="text"] .pun,
	code[data-lang="text"] .opn,
	code[data-lang="text"] .clo,
	code[data-lang="text"] .tag,
	code[data-lang="text"] .atn,
	code[data-lang="text"] .atv,
	code[data-lang="text"] .dec,
	code[data-lang="text"] .var,
	code[data-lang="text"] .fun {
		color: #fff !important;
	}

    .com       { color: #909090 !important; }
    .str, .tag { color: #90a959 !important; }
    .kwd, .atv { color: #d28445 !important; }
    .typ       { color: #f4bf75 !important; }
    .lit, .atn { color: #6a9fb5 !important; }
    .pun, .pln,
    .opn, .clo { color: #d0d0d0 !important; }
    .dec, .var { color: #aa759f !important; }

	li.L1,
	li.L3,
	li.L5,
	li.L7,
	li.L9 {
		background: #111 !important;
	}

	body.light-theme {
        code[data-lang="text"] .pln,
        code[data-lang="text"] .str,
        code[data-lang="text"] .kwd,
        code[data-lang="text"] .com,
        code[data-lang="text"] .typ,
        code[data-lang="text"] .lit,
        code[data-lang="text"] .pun,
        code[data-lang="text"] .opn,
        code[data-lang="text"] .clo,
        code[data-lang="text"] .tag,
        code[data-lang="text"] .atn,
        code[data-lang="text"] .atv,
        code[data-lang="text"] .dec,
        code[data-lang="text"] .var,
        code[data-lang="text"] .fun {
            color: #000;
        }

        .pln       { color: #000 !important;; }
        .com       { color: #800 !important;; }
        .str, .tag { color: #080 !important;; }
        .kwd, .atv { color: #008 !important;; }
        .typ       { color: #606 !important;; }
        .lit, .atn { color: #066 !important;; }
        .pun,
        .opn, .clo { color: #660 !important;; }
        .dec, .var { color: #606 !important;; }

        li.L1,
        li.L3,
        li.L5,
        li.L7,
        li.L9 {
            background: #eee;
        }
	}
}

/* DPE University button*/
/* CSS */
.badge-wrapper {
    padding-top: 0px;
    padding-bottom: 20px;
    a {
        text-decoration: none;
    }
    a:link {
        text-decoration: none;
    }
    a:visited {
        text-decoration: none;
    }
    a:hover {
        text-decoration: none;
    }
    a:active {
        text-decoration: none;
    }
}

.badge {
    background-color: var(--black-color);
    height: 24px;
    border-radius: 12px;
    border-color: var(--black-color);
    border-style: solid;
    border-width: 1px;
    padding: 5px;
    a {
        color: var(--gradle-blue);
    }
}

.badge-type {
    border-radius: 8px;
    margin-right: 10px;
    padding-left: 10px;
    padding-right: 10px;
}

.badge-text {
    color: var(--white-color);
}

.button--blue {
  color: white;
  border-color: transparent;
  &:hover {
    color: white;
  }
}

.button--blue {
  background: var(--gradle-blue);
  background: linear-gradient(var(--button-gradient-angle), var(--gradle-blue) 0%, var(--gradle-blue-lite) 100%);
  &:hover {
    background: var(--gradle-blue-lite);
  }
}

/* Custom Download button*/
/* CSS */
.button-9 {
	appearance: button;
	backface-visibility: hidden;
	background-color: #209BC4;
	border-radius: 6px;
	border-width: 0;
	box-shadow: rgba(50, 50, 93, .1) 0 0 0 1px inset, rgba(50, 50, 93, .1) 0 2px 5px 0, rgba(0, 0, 0, .07) 0 1px 1px 0;
	box-sizing: border-box;
	color: #fff;
	cursor: pointer;
	font-family: -apple-system, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Ubuntu, sans-serif;
	font-size: 100%;
	height: 44px;
	line-height: 1.15;
	margin: 12px 12px 12px 0px;
	outline: none;
	overflow: hidden;
	padding: 0 25px;
	position: relative;
	text-align: center;
	text-transform: none;
	transform: translateZ(0);
	transition: all .2s, box-shadow .08s ease-in;
	user-select: none;
	-webkit-user-select: none;
	touch-action: manipulation;
	width: 25%;
}

.button-9:disabled {
	cursor: default;
}

.button-9:focus {
	box-shadow: rgba(50, 50, 93, .1) 0 0 0 1px inset, rgba(50, 50, 93, .2) 0 6px 15px 0, rgba(0, 0, 0, .1) 0 2px 2px 0, rgba(50, 151, 211, .3) 0 0 0 4px;
}

.button-9-sect {
	padding-bottom: 1.25em;
}

/* Theme toggle switch button */
/* Switch */
.switch {
	position: relative;
	display: inline-block;
	width: 60px;
	height: 34px;
	align-self: center;
}

.switch input {
	opacity: 0;
	width: 0;
	height: 0;
}

.slider {
	position: absolute;
	cursor: pointer;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: #ccc;
	-webkit-transition: 0.4s;
	transition: 0.4s;
}

.slider:before {
	position: absolute;
	content: "";
	height: 26px;
	width: 26px;
	left: 4px;
	bottom: 4px;
	background-color: white;
	-webkit-transition: 0.4s;
	transition: 0.4s;
}

input:checked+.slider {
	background-color: #2196f3;
}

input:checked+.slider:before {
	-webkit-transform: translateX(26px);
	-ms-transform: translateX(26px);
	transform: translateX(26px);
}

/* Rounded sliders */
.slider {
	border-radius: 30px;
}

.slider:before {
	border-radius: 50%;
}

/* Feature Status Labels */

.incubating-label,
.since-gradle-label {
    display: inline-block;

    /* better center vertically on the line */
    position: relative;
    top: -1px;

    padding: 0 6px;
    margin-left: 4px;
    border-radius: 4px;
    white-space: nowrap;
    color: var(--code-text-color);
    font-weight: normal;
    font-size: 80%;
    font-style: italic;
}

.since-gradle-label {
    background-color: var(--code-color);
}

.incubating-label {
    /* use the warning color with 20% opacity */
    background-color: rgb(from var(--warning-color) r g b / 0.2);
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
<meta name="adoc-src-path" content="userguide_single.adoc">
<link crossorigin href="//assets.gradle.com" rel="preconnect">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet"/>
<link id="light-theme-style" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/stackoverflow-light.min.css">
<link id="dark-theme-style" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/stackoverflow-dark.min.css" disabled>

<meta name="twitter:site" content="@gradle">
<meta name="twitter:creator" content="@gradle">
<meta name="twitter:image" content="https://gradle.org/images/gradle-256x256.png">
<meta name="twitter:url" content="https://docs.gradle.org/9.1.0/userguide/userguide_single.html">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta name="twitter:description" content="Single-page Gradle User Manual for Gradle 9.1.0">
<meta name="twitter:title" content="Gradle User Manual: Version 9.1.0">

<style type="text/css">.multi-language-selector .language-option[data-lang='groovy'],
.exampleblock[data-lang=groovy] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2Zw0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgd2lkdGg9IjYxNC4wNjA4NSINCiAgIGhlaWdodD0iMzAzLjU5ODYiDQogICB2ZXJzaW9uPSIxLjEiPg0KICA8Zw0KICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzUuMzk2NTk5LC0zMC41NTgxOTYpIj4NCiAgICA8cGF0aA0KICAgICAgIGQ9Im0gMTU0Ljk3Njg3LDMzMi42OTE2MiBjIDAsLTAuODA1ODcgMTAuODMxMjMsLTE4LjYyMTcyIDI0LjA2OTQsLTM5LjU5MDc2IDEzLjIzODE5LC0yMC45NjkwNSAyMi42NjA1NywtMzguNjIwNjYgMjAuOTM4NjcsLTM5LjIyNTc3IC0xLjcyMTkxLC0wLjYwNTEgLTcuNjc5OTIsMC40ODU2NyAtMTMuMjQwMDIsMi40MjM5MyAtMTYuNzQ1MjQsNS44Mzc0MyAtMjAuMTg2MDUsNC4yOTAxNiAtMzIuNjkzMDgsLTE0LjcwMTU1IC0xMy41MzI2NSwtMjAuNTQ5MDYgLTE0LjAxNzI0LC0yMi42Njk4MyAtNi45NjE1OCwtMzAuNDY2MjQgNC42MDg3NiwtNS4wOTI1NiA0LjMzMTU5LC02LjI3OTY3IC0zLjIzMTksLTEzLjg0MzE2IC00LjU1MDA5LC00LjU1MDEgLTguMjcyODksLTkuNjQzMDkgLTguMjcyODksLTExLjMxNzc2IDAsLTIuODE2NzkgLTMwLjk5MTQ1LC0xNS41ODkzMyAtNzkuOTg5NDk2LC0zMi45NjYxNSAtMTEuMTA5NjYsLTMuOTM5OTcgLTIwLjE5OTM3NSwtNy44MjkyOCAtMjAuMTk5Mzc1LC04LjY0MjkxIDAsLTAuODEzNjYgMjMuNDcwNzM4LC0xLjAwNDc2IDUyLjE1NzE5MSwtMC40MjQ2OSBsIDUyLjE1NzIxLDEuMDU0NjYgNS4wOTEyNywtOC4wMzAwMSBjIDIxLjUxNjQ0LC0zMy45MzU5MiA1NC4wMDk1MiwtNjQuNTg4MjEyIDY4LjQ2NzA1LC02NC41ODgyMTIgMy4wMTA2LDAgOS4xMjE0MSwyLjg2OTE4IDEzLjU3OTUzLDYuMzc1OTQ1IDcuMjU5NDYsNS43MTAyODMgOC4yNTY1LDkuMjQ4NjMyIDkuNTQ5OTQsMzMuODkxOTY3IDAuNzk0MywxNS4xMzM4MiAyLjQyNDIyLDI4LjQ5NjAxIDMuNjIxOTgsMjkuNjkzNzkgMS4xOTc3NSwxLjE5Nzc2IDQuOTk3NjksLTAuMzc0MjUgOC40NDQzMSwtMy40OTMzOSA0LjQwMTQsLTMuOTgzMjMgOS4wMzQ4NCwtNS4wNjMxMyAxNS41Njc2MSwtMy42MjgzIDYuNzY3NTYsMS40ODY0MSAxMC42MjcxLDAuNDY4OTUgMTQuMTY5MzgsLTMuNzM1NDMgNS4zMTM2LC02LjMwNjY2IDMxLjkwNTk2LC00OC45MzcyMDEgMzEuOTA1OTYsLTUxLjE0ODc0NCAwLC0wLjc1MTU4OCA1LjI2NTA5LC05Ljc1NzMwNiAxMS43MDAyMywtMjAuMDEyNzAzIDYuNDM1MDksLTEwLjI1NTM5NyAxMy44NDY2NCwtMjIuMDgwNjMxIDE2LjQ3MDA3LC0yNi4yNzgyODMgNC42NjU1OCwtNy40NjUyMDEgNS4zOTY2LC02LjU4MTczNSAzMy40MjY5Miw0MC4zOTg3MzYgMjguOTQxMjEsNDguNTA3MTY0IDQ0LjUxNzY3LDY2LjQwNjU1NCA1Mi4zMTU3LDYwLjExNzYzNCA1LjQ0MiwtNC4zODg4OSAzNC4wMDA1NSwtNC42Mzc5NCA0MS45ODI0NiwtMC4zNjYxNCA0LjUzNjY1LDIuNDI3OTMgNy40MTkxNiwyLjM5NjEgOS45MjQ4NCwtMC4xMDk2MiA1LjIwMDA3LC01LjIwMDA2IDE3LjY0OTgyLC00LjI5NDM3IDIwLjkwNDEyLDEuNTIwNzggMi41NjM5Myw0LjU4MTQ2IDMuMjE3ODQsNC41ODE0NiA3LjAyMDE0LDAgMi4zMDYwNiwtMi43Nzg2NyA5LjEzNjE5LC01LjA1MjA4IDE1LjE3ODAzLC01LjA1MjA4IDguNTM4ODQsMCAxMS43OTMzNiwxLjc3MzY3IDE0LjYxNDAzLDcuOTY0MzcgbCAzLjYyODgxLDcuOTY0MzYgNTYuMDkyMDMsLTEuOTg1OCBjIDMwLjg1MDYyLC0xLjA5MjIyIDU2LjA5MjA0LC0xLjI4Njg4IDU2LjA5MjA0LC0wLjQzMjU1IDAsMC44NTQyNyAtMjIuOTA2MDgsMTAuMDcxOTUgLTUwLjkwMjQxLDIwLjQ4MzcxIC0yNy45OTYzMiwxMC40MTE3MiAtNTEuMzY3LDE5LjI0MzA1IC01MS45MzQ4NCwxOS42MjUxMiAtMC41Njc4NSwwLjM4MjA3IDAuNjk4NDcsOS40OTI3MyAyLjgxNDA1LDIwLjI0NTg4IDUuNTA0NTcsMjcuOTc5MTcgMS45MTQ1OCw0Ni42MjU4OSAtMTEuOTI2MjksNjEuOTQ2MDQgLTYuMjA5LDYuODcyNjMgLTE2LjI4MzM4LDE0LjE0Mzk1IC0yMi4zODc1MywxNi4xNTg0OSAtNi4xMDQxNSwyLjAxNDU0IC0xMS4wOTg0NCw0LjM4NjE0IC0xMS4wOTg0NCw1LjI3MDE5IDAsMC44ODQwNiA2LjUxNTI1LDExLjY3ODkzIDE0LjQ3ODM1LDIzLjk4ODU5IDcuOTYzMDksMTIuMzA5NjkgMTMuMjgyOCwyMi4zODEyNSAxMS44MjE1MiwyMi4zODEyNSAtMi4zODUwNCwwIC02MC40Njk4NywtMjIuNDQyMzggLTE1MC43ODg5OCwtNTguMjYwNyAtMTcuODA5LC03LjA2MjU4IC0zNC4wMjY4MywtMTIuODQxMDkgLTM2LjAzOTYxLC0xMi44NDEwOSAtMy43NTM2MywwIC0zNi4xNjY5LDEyLjI4NjYyIC0xMzEuMjI0MjMsNDkuNzQyMDYgLTU1LjEyNTI1LDIxLjcyMTAzIC01Ny4yOTIxNywyMi40NzM0OCAtNTcuMjkyMTcsMTkuODk0NTEgeiBtIDExMy4xMTY0OCwtNTEuMjUyNjUgYyAyOS4zMjk0OSwtMTEuMzk1MDYgNTguNDE2NTcsLTIyLjUzMDggNjQuNjM3OTgsLTI0Ljc0NjA3IDEwLjcwMDY4LC0zLjgxMDE5IDE0LjI3OTE4LC0yLjg1NDkzIDY2LjI1Mzk0LDE3LjY4NjM0IDMwLjIxODI1LDExLjk0Mjc0IDYwLjAzMjUyLDIzLjU3NTg3IDY2LjI1MzkyLDI1Ljg1MTM0IDYuMjIxNDEsMi4yNzU1MiAxOS4wNDMxNyw3LjIyMDU5IDI4LjQ5Mjc1LDEwLjk4OTA4IDEwLjc3NTAzLDQuMjk3MDQgMTYuMjgyNTEsNS4zMzE2NiAxNC43NzEwOCwyLjc3NDg0IC0xNi44ODM3LC0yOC41NjExMyAtMTcuMzk5OCwtMjkuMDM3MTYgLTI5LjEwMDgzLC0yNi44NDIwNSAtMTQuMTEzNjEsMi42NDc3MiAtMjIuODc4OTcsLTAuMDY4NSAtMjcuMzgzNjksLTguNDg1NTQgLTIuOTIxMTIsLTUuNDU4MTYgLTIuMDI5NDQsLTguMTI3NTkgNS4yNTQ0MiwtMTUuNzMwMzEgMTAuODQ4ODcsLTExLjMyMzc3IDkuMTQ0NTcsLTIxLjc0MTQ0IC00Ljg0NDI5LC0yOS42MTA5OSAtNS4zNjc2NCwtMy4wMTk1OSAtMTIuMTQwNTksLTEwLjQ4MzcyIC0xNS4wNTEwMiwtMTYuNTg2OTcgbCAtNS4yOTE2OSwtMTEuMDk2ODIgLTExLjM0NTUxLDcuNjk5MjggYyAtMTMuOTQ0NTgsOS40NjMwNCAtMzAuOTUwNjIsOS45NTA2MyAtNDUuMTQ3NjQsMS4yOTQ0OCBsIC0xMC40NjQ4OCwtNi4zODA2NSAtMTIuMTU4NDEsOC4yNjI4NCBjIC0xMi4xNzQ2Miw4LjI3Mzg2IC0yNi4xOTEwOCw5LjM0MjggLTQwLjQzNzUyLDMuMDgzOTIgLTMuOTI0OTgsLTEuNzI0MzkgLTUuNjU1ODMsLTEuMDU0MTUgLTUuNjU1ODMsMi4xOTAwOCAwLDIuNTcxMTggLTMuNzA0MjksNi4zNjI2NSAtOC4yMzE4MSw4LjQyNTUzIC0xMy41NzQyLDYuMTg0NzkgLTI2LjgyMTA3LDQuNTQyNDcgLTM1LjgwMjI5LC00LjQzODc1IGwgLTguMTg5NDQsLTguMTg5NDQgLTYuNjA5ODIsOC40MDMwMyBjIC0zLjYzNTM5LDQuNjIxNjYgLTEyLjA0OTUyLDExLjgzNjk4IC0xOC42OTgwNSwxNi4wMzM5OCAtOC4yMjk2NSw1LjE5NTE4IC0xOC40MTc0MSwxNy44NzE4MiAtMzEuOTE2NCwzOS43MTM2MSAtMTAuOTA1NDksMTcuNjQ1NDYgLTE5LjgyODE2LDMyLjk4MDQyIC0xOS44MjgxNiwzNC4wNzc3NiAwLDEuMDk3MyA4LjM2MjU1LC0xLjUyNzM2IDE4LjU4MzQyLC01LjgzMjU5IDEwLjIyMDg5LC00LjMwNTIxIDQyLjU4MDI4LC0xNy4xNTA4NyA3MS45MDk3NywtMjguNTQ1OTMgeiBtIDI0OC43NjcyOSwtMTIuMjU4NDYgYyAyMi4yNTU1NywtMTIuNTA4MzMgMjcuNDE0MjQsLTM1LjY0ODA4IDE3LjU3Njg1LC03OC44NDMxOCAtOC4yMjE0LC0zNi4wOTk2MSAtMTIuMzI1NSwtNDcuOTEzMjcgLTE3LjE5NDk0LC00OS40OTU5NyAtMy4zNjkwMiwtMS4wOTUwMyAtMy44ODY3NCwwLjEwNjk5IC0xLjk4ODU4LDQuNjE2MzUgMTIuMzE1MTYsMjkuMjU3NzEgMTIuOTk5NjMsNDMuOTQ2NjIgMi4yNDAyMiw0OC4wNzU0MSAtNy4zOTE1MSwyLjgzNjQyIC0xNS4yMzIzOSwtNy43OTA3NSAtMjEuMzk5MDIsLTI5LjAwMzI2IC00Ljc3NTEyLC0xNi40MjU4NyAtOS43Njg2MSwtMjMuODI4MzcgLTEzLjUzMzg3LC0yMC4wNjMxMSAtMC45MDE1NywwLjkwMTYgMC42Nzg0OCw2LjEyMTE3IDMuNTExMjQsMTEuNTk5MTMgMi44MzI3Myw1LjQ3NzkgNi43MTcyMSwyMS45NzQ1NSA4LjYzMjE3LDM2LjY1OTIgMS45MTQ5NywxNC42ODQ2MiA1LjYxMzg1LDMwLjA2MDczIDguMjE5NzMsMzQuMTY5MTIgNi43NzE5OCwxMC42NzY2MSAxNy41NTEyOCw4LjEwMzYgMjQuNTIzODIsLTUuODUzODQgNi44OTM3MywtMTMuNzk5NzUgNy42NzI4NCwtNC42MDc4MSAwLjk2OTMsMTEuNDM2MDIgLTYuOTYwNzQsMTYuNjU5MzcgLTI3LjYzNDQyLDIxLjY1NDgxIC01MS41ODQxOCwxMi40NjQ0MiAtMy44MzMzLC0xLjQ3MDk2IC01LjEzMDM5LDAuMDUxNSAtNS4xMzAzOSw2LjAyMDk3IDAsNC4zOTQzMSAtMi45MzYxOCwxMS43MjI0NSAtNi41MjQ4OCwxNi4yODQ3IGwgLTYuNTI0ODgsOC4yOTUwNiA4Ljk0ODgxLDEuNTExMjMgYyAxNS40NDk0NSwyLjYwOTA5IDM2LjYzMzI4LC0wLjc3NjQyIDQ5LjI1ODYsLTcuODcyMjUgeiBtIC0zMjAuMzY2NSwtMjcuNTM3MzMgYyA0Ni40NTk2NSwtMTMuMzU0NSA1NC43NjE4OCwtMjguOTMwOTMgMzkuMzI4ODUsLTczLjc4NzgyIC0zLjU4MTg1LC0xMC40MTA3OSAtNi41MTI0MywtMjEuNjA5NzEgLTYuNTEyNDMsLTI0Ljg4NjU0IDAsLTExLjE1NzEyIC01LjYxMTUyLC02LjAwMTYxIC05LjgxNzEzLDkuMDE5NDMgLTUuNTYyMDMsMTkuODY1NjEgLTIyLjI5MTE1LDM2Ljc1MDUzIC0zNi4zNDUxNiwzNi42ODM2NCAtMTIuMjA1NDcsLTAuMDU4MiAtMTYuMTgyNTEsLTIuMjgwMDggLTIxLjIyMzc4LC0xMS44NTc2OCAtOS4wNDc0OCwtMTcuMTg4ODIgMC44MTQ2OSwtNDMuNTY3OTcgMjUuOTY5NTQsLTY5LjQ2MjcyIDE4LjQyNDMxLC0xOC45NjYzMDQgMjguNDg4OTMsLTIwLjY4Mzk2NSAyOC40ODg5MywtNC44NjIwNSAwLDI0LjY3MzIgLTE3LjAxMTM0LDYwLjk5NDcgLTI1Ljk3MzA5LDU1LjQ1NjA0IC00LjM4MjA1LC0yLjcwODI2IC0zLjY3MTM4LC0xNC42Njc1MiAxLjQxNzIyLC0yMy44NTAwOSA0LjMyNzM1LC03LjgwODgyIDMuNDQ4MTQsLTE5LjcwNzcxIC0xLjQ1NjIsLTE5LjcwNzcxIC01LjY4Njg5LDAgLTE2Ljk0NTQ3LDIwLjcxMTk2IC0xOC40MzMxOCwzMy45MTA3NCAtMS4zMTUxNSwxMS42NjgyNiAtMC40OTI4NiwxNC41MDU0NSA1LjA2NjUyLDE3LjQ4MDcyIDE5LjQ4MjQ0LDEwLjQyNjcgNDUuMDA1MzEsLTIxLjM5NTQ1IDQ2LjI5MDgzLC01Ny43MTU4NCAwLjY3NTA0LC0xOS4wNzMxODEgLTMuMDE2NzYsLTI0LjQ0MTEwNSAtMTQuNzc5MDYsLTIxLjQ4ODk1MSAtMTcuMTE4NzksNC4yOTY1NDMgLTYzLjIzNDgzLDYzLjc4NjY0MSAtNjMuMjM0ODMsODEuNTczNDYxIDAsMTMuOTEyOCA2Ljk4NzM3LDIzLjY5NzI4IDE5LjI4ODI3LDI3LjAwOTYgMjAuOTE0MTksNS42MzE2MiA0MS4xMzUzOSwtNC4zNzM4OSA1NS40NjMzLC0yNy40NDMzOCBsIDYuMDIxNzUsLTkuNjk1NzEgMC4wMTMyLDEzLjE3MjIzIGMgMC4wMTYyLDE5LjA3MzggLTEyLjQyNjE5LDI5LjEyNzQgLTUxLjY5ODE3LDQxLjc2NzkzIC05Ljc3NjQ5LDMuMTQ2OCAtMTguMTgzMzIsNi4wNTQ0MSAtMTguNjgxOCw2LjQ2MTM3IC0xLjgyMDU2LDEuNDg2MzIgMTYuNjg3MzksMjcuNDc1NzEgMTkuNTY2NDQsMjcuNDc1NzEgMS42MzI2MiwwIDExLjE5MTE1LC0yLjM2MzU5IDIxLjI0MTIzLC01LjI1MjM4IHogTSA0NzYuNDExLDIxNy45NjMwMSBjIDQuNjYzNDcsLTUuMTUzMSA1LjQ4NTUxLC0xMC43NTEwMyA0LjQ4NTc5LC0zMC41NDgyMyAtMS4wODczOSwtMjEuNTMzMzEgLTIuMjc3NDYsLTI1LjMzODUxIC0xMC42NjE0MywtMzQuMDg5NDkgLTE1LjE0ODgyLC0xNS44MTE5NCAtMzMuODYxMjMsLTExLjc3ODI4IC0yMi45MDgxOSw0LjkzODE0IDUuODIyNTYsOC44ODYzNyAxMi45MjU0LDcuMzY4NjQgMTAuNDE2NDEsLTIuMjI1ODEgLTEuOTk4NjQsLTcuNjQyNzYgMS43Mjk5OCwtNy44NDM1OCA4LjIyODM5LC0wLjQ0MzIyIDEyLjE5MzAxLDEzLjg4NTM3IDkuMTE1MzQsMzMuMTI2OTggLTUuMjk4NiwzMy4xMjY5OCAtOS44NjcxNiwwIC0xMi45NDE5NSwtNC4yMzE3NiAtMTkuMzczNTMsLTI2LjY2MzE4IC0yLjkzMDU5LC0xMC4yMjA4NyAtNi40OTk2NCwtMTguNTgzNDMgLTcuOTMxMjcsLTE4LjU4MzQzIC00Ljc2ODk5LDAgLTYuODkyODcsNC4yMDg3OCAtMy45MjcyMSw3Ljc4MjQgMS42MTA4OCwxLjk0MTEgNi4wNzIxOCwxNS44OTEyNyA5LjkxNDA0LDMxLjAwMDQxIDkuNjY5MDMsMzguMDI1OTYgMjMuMTc2NjYsNTEuMDQxNDUgMzcuMDU1NiwzNS43MDU0MyB6IG0gLTE4My43NzEyNSwwLjYwMzk1IGMgMS45ODk3OCwtMS4zMzUgMi44OTk3NSwtNy42NDg5MyAyLjA3ODY1LC0xNC40MjMgLTEuMzI0NDksLTEwLjkyNzAyIC0yLjA2NjYyLC0xMS43MjQxIC03Ljk3MjcsLTguNTYzMjcgLTguNDg3MzMsNC41NDIyNyAtMTcuNjA4MzksLTQuMDYzNTEgLTIwLjcwMjIyLC0xOS41MzI2IC0yLjM0NzA3LC0xMS43MzUzOCAtMy4wNjUyNiwtMTEuNTA0ODkgMTQuMDI1NzYsLTQuNTAxNDkgMi4xNDI4OCwwLjg3ODA4IDcuNTk2NzEsLTIuMTA0MDIgMTIuMTE5NjMsLTYuNjI2OTQgOC4yNzQwOCwtOC4yNzQwOCAxMC45OTgwMiwtMTguMjEyOTkgNC45OTE1NiwtMTguMjEyOTkgLTEuNzc3NTQsMCAtMy4yMzE5LDEuNDU0MzYgLTMuMjMxOSwzLjIzMTkgMCw0LjY0OTIzIC04Ljg0MjMxLDMuOTg5ODIgLTEwLjgzNDY1LC0wLjgwNzk3IC0xLjE2MjI0LC0yLjc5ODc5IC0zLjYzODA3LC0xLjgwNTkxIC04LjA1OTE1LDMuMjMxOSAtMy41MDk4NSwzLjk5OTQ4IC03Ljc5NjczLDcuMjcxNzggLTkuNTI2NDEsNy4yNzE3OCAtMS43Mjk2OSwwIC00LjA2NTYsLTMuMjcyMyAtNS4xOTA4OCwtNy4yNzE3OCAtMS45NzE5NSwtNy4wMDg1NiAtMi4yMTM2NiwtNy4wNTI3NyAtNi42NzczNywtMS4yMjE2OSAtMy45MTA2LDUuMTA4NTQgLTMuOTQ1NTcsNi43MzU4MyAtMC4yMjQ2MSwxMC40NTY2MSAzLjk0MDYyLDMuOTQwNjQgMTEuNDI2MTUsMzAuODcxMDIgMTEuNDI2MTUsNDEuMTA3NDQgMCwxMi43Mjg2NyAxNy41MjkzMywyMi43MzgzMiAyNy43NzgzLDE1Ljg2MjEgeiBtIDU4Ljk0MzA5LC0xNi44NzUzMSBjIDEyLjE0NTY3LC0xMi4xNDU2NyAxNS43NDQ1MiwtMzAuMzUxNDMgOS4xMjk0MywtNDYuMTgzNTcgLTUuMTcwMTYsLTEyLjM3Mzk3IC0xNC4xNDQ2NiwtMTcuMDA1MTYgLTI2Ljc5ODc4LC0xMy44MjkxOCAtOS40MDI2MywyLjM1OTkxIC0yMy43MjMxMSwyOS43NzY1OSAtMjMuNzczODcsNDUuNTE1MzYgLTAuMDc5MiwyNC41MjkwMiAyMy4yNTA1MywzMi42OTAwNSA0MS40NDMyMiwxNC40OTczOSB6IG0gLTIyLjA4MzQxLC0xOS40MzQwNyBjIC0zLjU1NTEsLTMuNTU1MSAtNi40MTc1NSwtMTAuNDYzMjggLTYuMzYxMDIsLTE1LjM1MTUzIDAuMDkzNCwtOC4wNzk2NSAwLjQ5MzE1LC04LjM3MzUgNC4zOTYxOSwtMy4yMzE5IDQuODI0NjQsNi4zNTU2OSAxMy4zOTc5Nyw3LjQ1NjY2IDE2LjY4MjQxLDIuMTQyMzIgMS4xOTQzMiwtMS45MzI0MSAwLjU1Mjk1LC01LjEzMjAyIC0xLjQyNTIsLTcuMTEwMTcgLTUuMDgxMzIsLTUuMDgxMzIgLTQuNDY1NjEsLTExLjk5OTYzIDEuMDY3OTIsLTExLjk5OTYzIDYuMTUxMzcsMCAxNC43MjY3OSwxMi41MTQ3NyAxNC43MjY3OSwyMS40OTE5MSAwLDYuNjA2NzQgLTEzLjQ0NDQsMjAuNTIyOCAtMTkuODI3MjQsMjAuNTIyOCAtMS41Mzc4NSwwIC01LjcwNDc2LC0yLjkwODcyIC05LjI1OTg1LC02LjQ2MzggeiBtIDg2LjM0ODk3LDE4LjU4MzQxIGMgMTMuNDEwNzQsLTE0LjYwMjYzIDEyLjEwMzc2LC0zNy4wOTggLTMuMDk4MjUsLTUzLjMyNjM0IC03Ljg1MDU3LC04LjM4MDYgLTI1LjI5Mjk4LC05LjgyNTUyIC0zMi40MzE4NSwtMi42ODY2NCAtNi41ODc2MSw2LjU4NzYxIC0xMy4xNjQ2NSwzMi40OTMwMyAtMTAuNzIxMjIsNDIuMjI4NDEgNS4yMTEyMiwyMC43NjMxOCAzMi40MDA0MSwyOC44NjY1MiA0Ni4yNTEzMiwxMy43ODQ1NyB6IG0gLTI3LjQ1NTY1LC0yMy42MTQ1MiBjIC01LjMwNjIzLC0zLjcxNjY0IC03LjEyOTQxLC04LjE0OTc0IC02Ljk3ODA2LC0xNi45Njc0NyAwLjE2OTM1LC05Ljg2MDMzIDAuNjg0MywtMTAuNzQ5ODEgMi45NjE0NSwtNS4xMTQxNSAzLjM0NTczLDguMjgwMzIgMTAuMzYyOTIsMTEuNDA3MzQgMTYuNTE4MTQsNy4zNjA5IDMuODE3NTMsLTIuNTA5NjMgMy42MzkyOSwtMy42OTU5NyAtMS4xMDEwNCwtNy4zMjkwNyAtNi4zMjE4OSwtNC44NDUyMyAtNy41NTUwOCwtMTEuNzAxOTEgLTIuMTA0NjUsLTExLjcwMTkxIDQuODczNjQsMCAyMi4zMDQwMiwxOS4wNjY2NiAyMi4zMDQwMiwyNC4zOTc3OCAwLDUuMjAzMTYgLTEyLjM3NzM5LDE0LjM4NTAzIC0xOS4zOTEzOSwxNC4zODUwMyAtMi43NjQwNSwwIC04LjI1NzksLTIuMjY0MDIgLTEyLjIwODQ3LC01LjAzMTExIHogbSAxODkuOTYyOTIsLTE0LjI4ODg3IDMzLjkzNDk1LC0xMi43MzY4MiAtMzYuMzU4ODgsLTAuMTMxMjUgYyAtMzIuNTM5MiwtMC4xMTczNiAtMzYuMzU0MjQsMC40NjMwNyAtMzYuMzE0NzUsNS41MjQ3NSAwLjA0MDEsNS4xMjc1NyAzLjMzMDczLDIwLjI4Mzk1IDQuMzcyNywyMC4xMzk2NyAwLjIzNzIyLC0wLjAzMjkgMTUuNzAxNzcsLTUuNzkxMjQgMzQuMzY1OTgsLTEyLjc5NjQ4IHogbSAtNDQzLjQ5MzQzLC0yLjI3OTMgMy40NjgyNSwtMTAuMjg3NjEgLTMwLjQ2Njg2LC0xLjAyNDA0IGMgLTE2Ljc1Njc0NCwtMC41NjMyMiAtMzAuNDYzNTg0LC0wLjEzMjEzIC0zMC40NTk1OCwwLjk1ODA0IDAuMDA1OCwxLjU5NTEzIDUyLjUwNjU3LDIyLjEwNzA3IDUzLjY2MTc0LDIwLjk2NTUyIDAuMTgwMzUsLTAuMTc4NCAxLjg4ODkyLC00Ljk1MzcyIDMuNzk2NDUsLTEwLjYxMTkxIHogbSAyMDguOTA5MiwtMzEuODg2OTUgYyA3LjE2NjY3LDEuMTQ2IDE1LjI0OTgxLDQuMDc5MjQgMTcuOTYyNTYsNi41MTgzNSA0LjIxMjc5LDMuNzg3ODMgNi4wNDUyOCwzLjUyOTY2IDEyLjU2MjA3LC0xLjc2OTg1IDQuMTk2NDMsLTMuNDEyNSA5LjY1MDI2LC02LjIwNDU3IDEyLjExOTYzLC02LjIwNDU3IDIuNDY5MzksMCA0LjQ4OTgyLC0wLjcxMzA4IDQuNDg5ODIsLTEuNTg0NjcgMCwtMy4wMDkxOCAtNDYuNTM5NTQsLTc5LjIxMjUyIC00OC4zMTQ0NywtNzkuMTA5NjEgLTIuMDg1LDAuMTIwODcyIC00OS43ODYwMyw4MC4wODc5OCAtNTEuMjU0NjQsODUuOTI0MzcgLTAuNjE2MzQsMi40NDk1MiAxLjMxODA0LDMuMzUzNzEgNS4wNzM2NCwyLjM3MTYgMy4zMzgzNiwtMC44NzMgNy45NTQxNiwwLjY4MzI2IDEwLjI1NzI3LDMuNDU4MzYgMy43MzU0LDQuNTAwODcgNS4yNjEwOCw0LjE0MjI5IDE0LjEzMDY4LC0zLjMyMDk3IDguNDI2NDcsLTcuMDkwNDEgMTEuOTMwOCwtOC4wNDg4IDIyLjk3MzQ0LC02LjI4MzAxIHoiDQogICAgICAgc3R5bGU9ImZpbGw6IzMzMzMzMztmaWxsLW9wYWNpdHk6MSIgLz4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiM2Mzk4YWE7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmUiDQogICAgICAgZD0ibSAzMDkuNTQ1NzksMTQwLjg3OTIyIGMgLTAuNTAwNzUsLTAuMjMzMTEgLTEuMTE4MDQsLTAuNzY3OTkgLTIuNTI3OCwtMi4xOTAzNSAtMS45MTE4OCwtMS45Mjg5NyAtMi42NzE4OCwtMi40OTAxMyAtNC4yNjEwOCwtMy4xNDYyOCAtMi4wODc5MSwtMC44NjIwNCAtNC4zNTQ5LC0xLjA5NDIzIC02LjQ4MjMxLC0wLjY2MzkxIC0xLjg5ODA4LDAuMzgzOTMgLTIuNDI0MzUsMC40MjUyNyAtMy4yODI0MiwwLjI1NzggLTEuNDMyMjQsLTAuMjc5NTMgLTEuOTQxNTcsLTEuMTQ5MjkgLTEuNTM1ODMsLTIuNjIyNzIgMC41MDU3MywtMS44MzY1NyA0LjMzNjkzLC04Ljk0MjU1IDEyLjAwODk5LC0yMi4yNzM4NyAxNS41ODM3LC0yNy4wNzg5ODggMzYuNTM2MjQsLTYxLjIyMDk2OCAzOC44NTA1NiwtNjMuMzA2NjYyIDAuMjU2MzEsLTAuMjMwOTk0IDAuMjY1LC0wLjIzMDk5NCAwLjUyMjQ4LDAgMS4zNzc2OCwxLjIzNTk3NiA5LjQ3NjIsMTMuNzI1ODg5IDIwLjU0MDM2LDMxLjY3ODI5OCAxNC45NjY5NiwyNC4yODUwMDQgMjcuNDExMDIsNDUuNjQzNzE0IDI3LjQxMTAyLDQ3LjA0NzcwNCAwLDAuODU3MjkgLTEuMzE2MDgsMS4zNzIxNSAtNC4wODU5MSwxLjU5ODQ1IC0zLjQ0MjI2LDAuMjgxMjQgLTcuNDI0NzgsMi4zMDE4OCAtMTIuODY4ODcsNi41MjkzNiAtMi41ODcxMiwyLjAwODk4IC0zLjY5MTI2LDIuNzU5MzMgLTQuOTUwNjIsMy4zNjQzOCAtMS4wNDkyOCwwLjUwNDExIC0xLjEzNjkyLDAuNTI0MzcgLTIuMjY4NTQsMC41MjQzNyAtMS4xMTM2OCwwIC0xLjIyNjYxLC0wLjAyNDkgLTIuMDk2MjMsLTAuNDYxMjggLTAuNTEyMTMsLTAuMjU3MDIgLTEuNTA0NjksLTAuOTQ5MyAtMi4yNDE1NSwtMS41NjM0MiAtMi4xNzg0OCwtMS44MTU2MSAtNC43OTkxOCwtMy4xMzYxNCAtOS4wNzE5NywtNC41NzEyNCAtNS40Mjk5NywtMS44MjM3NiAtMTEuMjQ0NTQsLTIuOTE4NCAtMTYuMTk1NTEsLTMuMDQ4OTYgLTMuOTA5MzQsLTAuMTAzMDggLTUuNzEyMDEsMC4yNDc5OCAtOC42NzYwMiwxLjY4OTYzIC0yLjQxOTg4LDEuMTc2OTggLTMuNTg2MjEsMi4wMTMxMSAtOS4xMjQ3NSw2LjU0MTQ1IC01LjYzMzc2LDQuNjA2MTcgLTcuNjM0NDIsNS41NjIwNSAtOS42NjQsNC42MTcyNSB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDEyOC42Mzc4NiwxNzAuNzM5IGMgLTEwLjE1OSwtMi45NjA3IC00NS41MDMxNzEsLTE2LjkxOTYyIC01MC40NTA5MjQsLTE5LjkyNTIzIC0wLjY4MjkxNiwtMC40MTQ4NCAtMC43MzgwOTgsLTAuNDc3ODcgLTAuNTQzMjA3LC0wLjYyMDM4IDEuMTMxNTYzLC0wLjgyNzQxIDEyLjMzNzk4MywtMS4yMzkwMSAyNS4wMDQwMzEsLTAuOTE4MzYgNS4wNTEzMSwwLjEyNzg4IDM1LjUwMTMyLDEuMTMzMjMgMzUuNTUwOSwxLjE3Mzc3IDAuMDk5NywwLjA4MTUgLTYuNTIxNjQsMTkuMjg4OCAtNy4wMzA1MSwyMC4zOTQzMyAtMC4yMTI1MSwwLjQ2MTcgLTAuNjUwNjMsMC40NDM2NyAtMi41MzAyOSwtMC4xMDQxMyB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDU0My42OTQxMywxNzUuMzEwNTUgYyAtMS4zODYyLC0yLjcxMjg3IC0zLjg4NzY5LC0xNC45NzA2NyAtMy45NjA3OCwtMTkuNDA4NTggLTAuMDI4NCwtMS43MjQyNCAwLjE4NjY3LC0yLjQyNzQxIDAuOTYwNiwtMy4xNDA4IDEuNzczNzgsLTEuNjM1MDEgNS4zNzkzOCwtMi4yMjMyIDE1LjI5MDE3LC0yLjQ5NDM0IDUuMDAzNDcsLTAuMTM2ODkgMjguMTAxOSwtMC4xNTc5NiA0NC40MTEyNywtMC4wNDA1IGwgMTEuNDI4NTksMC4wODIzIC0yNy41MTc3LDEwLjMxNDI3IGMgLTI1LjA5MjkyLDkuNDA1NCAtMzkuNjg0NzMsMTQuODQxMjYgLTQwLjIyNDkxLDE0Ljk4NDkgLTAuMTM1MTcsMC4wMzYgLTAuMjY5ODEsLTAuMDY3NCAtMC4zODcyNCwtMC4yOTcyMyBsIDAsMCB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDE3OC4wODgzNSwzMTUuNTE0MzMgYyAwLC0wLjc3MDc4IDMuMjY4OSwtNi41MzMxIDExLjU1Mzk1LC0yMC4zNjY5OCAxOS44NTExOCwtMzMuMTQ2MzEgMjguOTI3MTUsLTQ1LjE2MDEyIDQwLjA3MjkyLC01My4wNDQyOSA5Ljk3MTI3LC03LjA1MzM3IDE1LjMwMjc5LC0xMS45Mjk0IDIxLjI0NTM5LC0xOS40MzAzMyBsIDMuNjY0MDksLTQuNjI0OTIgNC45Mzk5LDQuODU2NTIgYyA4LjY0Nzg0LDguNTAxODkgMTMuODYxMywxMC45NjY2OCAyMy4yOTcxNywxMS4wMTQzMiAxMS41NDA1OCwwLjA1ODMgMjQuMTc4NDksLTYuMzg4MSAyNC4xNzg0OSwtMTIuMzMyOTkgMCwtMS4zMzk4IDAuOTU0MDQsLTIuNzIyMzYgMS44Nzg1NywtMi43MjIzNiAwLjM5MTMyLDAgMi42MTY4NiwwLjY4MzY1IDQuOTQ1NjUsMS41MTkyMyA2LjA2OTkyLDIuMTc3OSA5LjYzMDI4LDIuOTY1NDggMTQuNjA5MTIsMy4yMzE2NSA0LjkzOTk4LDAuMjY0MDkgOC41NDg0OCwtMC4xNzA0IDEzLjM1ODE3LC0xLjYwODQxIDQuNzI1NjEsLTEuNDEyODggNy40NDcwOSwtMi44NTkwNSAxNS41OTgzMywtOC4yODg4MiA0LjEwNzYsLTIuNzM2MTggNy41OTk1NCwtNC45NzQ4NyA3Ljc1OTg4LC00Ljk3NDg3IDAuMTYwMzMsMCAzLjEyNTM0LDEuNzE4OTYgNi41ODg5LDMuODE5OTEgMy40NjM1NiwyLjEwMDk1IDcuNjI1NDIsNC4zODEzMyA5LjI0ODU5LDUuMDY3NTEgMTEuMDY4NjIsNC42NzkxOCAyMy4wMjQ0NSw0LjM3MzkgMzMuOTcxMjYsLTAuODY3NDEgMS45NTc5NSwtMC45Mzc0NyA2LjU2NzkzLC0zLjczMDc0IDEwLjI0NDQsLTYuMjA3MjcgMy42NzY0OCwtMi40NzY1MyA2LjczNjEzLC00LjQ0NTc2IDYuNzk5MjMsLTQuMzc2MDYgMC4wNjMxLDAuMDY5NyAxLjQ1NjA1LDIuOTIwOCAzLjA5NTQ0LDYuMzM1NzggMS42Mzk0LDMuNDE0OTggMy42OTg5NSw3LjI2NjcgNC41NzY3OSw4LjU1OTM3IDMuODAwMDEsNS41OTU3OCA4LjE3NTg4LDkuNzUxNDEgMTQuMDgzNDMsMTMuMzc0NjQgNi4wODEyMiwzLjcyOTc1IDkuODMyMDYsOC42ODY4IDEwLjIxODgyLDEzLjUwNTA3IDAuMzgzNjcsNC43Nzk2OCAtMS43MDMyOSw5LjAxOTM5IC03LjcyMTg5LDE1LjY4NzIxIC00LjY5NzQ3LDUuMjA0MTkgLTUuODczMyw3LjIzNTQgLTUuODYxMTMsMTAuMTI0OTEgMC4wMTIyLDIuODkyNjIgMS43MDEwMyw2LjIyODU0IDQuNjY5NjQsOS4yMjM3OSA0LjgwNTMzLDQuODQ4NDQgMTIuMzQ2MDUsNi4yODc3NyAyMy40MzUzNCw0LjQ3MzE5IDIuNDc0MDgsLTAuNDA0ODQgNS41OTQ3OSwtMC43Mzc1NyA2LjkzNDkxLC0wLjczOTM4IDQuMjg1NTEsLTAuMDA2IDYuOTAzMTksMi4wOTU5NSAxMS44OTI1MSw5LjU0ODU5IDMuNDQzNTEsNS4xNDM2NSAxMC45NzM5NiwxNy43NTUwOCAxMC45NzM5NiwxOC4zNzgzNiAwLDAuMzI0MDcgLTAuMzUxNDUsMC41NTIwOCAtMC44NTA5NywwLjU1MjA4IC0xLjA1MTA5LDAgLTUuNjIzMTQsLTEuMjQzOCAtOC45MzIxNCwtMi40Mjk5NCAtNC4zNDg1LC0xLjU1ODc1IC01Ny4yNzIzOCwtMjIuMDA1MjYgLTc0Ljc0Nzg2LC0yOC44Nzc5NSAtNDYuNjYzNSwtMTguMzUxNjIgLTYyLjAyODA1LC0yNC4yMTI0NiAtNjkuNTM2NTcsLTI2LjUyNDg5IC04LjExNDE3LC0yLjQ5ODk1IC0xMy42NDAyOSwtMy4wODUyMiAtMTguMTI2NjEsLTEuOTIzMDYgLTUuNTc5OTYsMS40NDU0NiAtODEuNzIwNjcsMzAuODY4ODggLTEyNi4xMzI0NSw0OC43NDE5NSAtMjEuOTMxMTksOC44MjYgLTI0LjY3NzQ5LDkuODc1NzcgLTI4Ljc4MTE2LDExLjAwMTU5IC0zLjI2MzAzLDAuODk1MjEgLTMuMTQ0MDcsMC44ODI5NCAtMy4xNDQwNywwLjMyNDI2IHoiIC8+DQogIDwvZz4NCjwvc3ZnPg==');
    background-position: 16px 80%;
    background-repeat: no-repeat;
    background-size: 20px 12px;
    padding-left: 2.5em;
}

.multi-language-selector .language-option[data-lang='kotlin'],
.exampleblock[data-lang=kotlin] > .content .title {
    background-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 8 8' xmlns='http://www.w3.org/2000/svg'><linearGradient id='g' gradientUnits='userSpaceOnUse' x1='8' y1='0' x2='0' y2='8'><stop offset='0' stop-color='%23e44857'/><stop offset='.4689' stop-color='%23c711e1'/><stop offset='1' stop-color='%237f52ff'/></linearGradient><polygon fill='url(%23g)' points='8 8 0 8 0 0 8 0 4 4'/></svg>");
    background-position: 17px 80%;
    background-repeat: no-repeat;
    background-size: 11px 11px;
    padding-left: 2.3em;
}

.multi-language-selector {
    display: block;
}

.multi-language-selector .language-option[data-lang='groovy'] {
    background-position: 20px center;
    padding-left: 32px;
}

.multi-language-selector .language-option[data-lang='kotlin'] {
    background-position: 30px center;
    padding-left: 27px;
}

.multi-language-selector .language-option {
    background-color: white;
    border: 1px solid #f7f7f8;
    border-radius: 4px 4px 0 0;
    cursor: pointer;
    display: inline-block;
    font-weight: normal;
    font-family: 'Lato', Arial, sans-serif;
    margin: 0;
    padding: 4px 20px;
    min-width: 130px;
    max-width: 320px;
    text-align: center;
    filter: grayscale(1);
    -webkit-filter: grayscale(1);
    opacity: 0.3;
}

.multi-language-selector .language-option.selected {
    background-color: #f7f7f8;
    color: #02303a;
    filter: none;
    -webkit-filter: none;
    opacity: 1;
}

.multi-language-text.hidden,
.multi-language-selector ~ .multi-language-sample.hidden {
    display: none;
}

.multi-language-sample {
    border-radius: 0 0 4px 4px;
}

body.dark-theme {
    .multi-language-selector .language-option {
        background-color: #1f1f1f;
        border: 1px solid #1e1e22;
    }
    .multi-language-selector .language-option.selected {
        background-color: #2c2c2c;
        color: white;
    }
}

@media (prefers-color-scheme: dark) {
    .multi-language-selector .language-option {
        background-color: #1f1f1f;
        border: 1px solid #1e1e22;
    }
    .multi-language-selector .language-option.selected {
        background-color: #2c2c2c;
        color: white;
    }
    body.light-theme {
        .multi-language-selector .language-option {
            background-color: #fff;
            border: 1px solid #f7f7f8;
        }
        .multi-language-selector .language-option.selected {
            background-color: #f7f7f8;
            color: #02303a;
        }
    }
}
</style><script type="text/javascript">function postProcessCodeBlocks() {
  // Assumptions:
  //  1) All siblings that are marked with class="multi-language-sample" should be grouped
  //  2) Only one language can be selected per domain (to allow selection to persist across all docs pages)
  //  3) There is exactly 1 small set of languages to choose from. This does not allow for multiple language preferences. For example, users cannot prefer both Kotlin and ZSH.
  //  4) Only 1 sample of each language can exist in the same collection.

  var GRADLE_DSLs = ["kotlin", "groovy"];
  var preferredBuildScriptLanguage = initPreferredBuildScriptLanguage();

  // Ensure preferred DSL is valid, defaulting to Kotlin DSL
  function initPreferredBuildScriptLanguage() {
    var lang = window.localStorage.getItem("preferred-gradle-dsl");
    if (GRADLE_DSLs.indexOf(lang) === -1) {
      window.localStorage.setItem("preferred-gradle-dsl", "kotlin");
      lang = "kotlin";
    }
    return lang;
  }

  function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

  function processSampleEl(sampleEl, prefLangId) {
    var codeEl = sampleEl.querySelector("code[data-lang]");
    if (codeEl != null) {
      sampleEl.setAttribute("data-lang", codeEl.getAttribute("data-lang"));
      if (codeEl.getAttribute("data-lang") !== prefLangId) {
        sampleEl.classList.add("hidden");
      } else {
        sampleEl.classList.remove("hidden");
      }
    }
  }

  function switchSampleLanguage(languageId) {
    var multiLanguageSampleElements = [].slice.call(
      document.querySelectorAll(".multi-language-sample")
    );

    // Array of Arrays, each top-level array representing a single collection of samples
    var multiLanguageSets = [];
    for (var i = 0; i < multiLanguageSampleElements.length; i++) {
      var currentCollection = [multiLanguageSampleElements[i]];
      var currentSampleElement = multiLanguageSampleElements[i];
      processSampleEl(currentSampleElement, languageId);
      while (
        currentSampleElement.nextElementSibling != null &&
        currentSampleElement.nextElementSibling.classList.contains(
          "multi-language-sample"
        )
      ) {
        currentCollection.push(currentSampleElement.nextElementSibling);
        currentSampleElement = currentSampleElement.nextElementSibling;
        processSampleEl(currentSampleElement, languageId);
        i++;
      }

      multiLanguageSets.push(currentCollection);
    }

    multiLanguageSets.forEach(function (sampleCollection) {
      // Create selector element if not existing
      if (
        sampleCollection.length > 1 &&
        (sampleCollection[0].previousElementSibling == null ||
          !sampleCollection[0].previousElementSibling.classList.contains(
            "multi-language-selector"
          ))
      ) {
        var languageSelectorFragment = document.createDocumentFragment();
        var multiLanguageSelectorElement = document.createElement("div");
        multiLanguageSelectorElement.classList.add("multi-language-selector");
        languageSelectorFragment.appendChild(multiLanguageSelectorElement);

        sampleCollection.forEach(function (sampleEl) {
          var optionEl = document.createElement("code");
          var sampleLanguage = sampleEl.getAttribute("data-lang");
          optionEl.setAttribute("data-lang", sampleLanguage);
          optionEl.setAttribute("role", "button");
          optionEl.classList.add("language-option");

          optionEl.innerText = capitalizeFirstLetter(sampleLanguage);

          optionEl.addEventListener(
            "click",
            function updatePreferredLanguage(evt) {
              var preferredLanguageId = optionEl.getAttribute("data-lang");
              window.localStorage.setItem(
                "preferred-gradle-dsl",
                preferredLanguageId
              );

              // Record how far down the page the clicked element is before switching all samples
              var beforeOffset = evt.target.offsetTop;

              switchSampleLanguage(preferredLanguageId);

              // Scroll the window to account for content height differences between different sample languages
              window.scrollBy(0, evt.target.offsetTop - beforeOffset);
            }
          );
          multiLanguageSelectorElement.appendChild(optionEl);
        });
        sampleCollection[0].parentNode.insertBefore(
          languageSelectorFragment,
          sampleCollection[0]
        );
      }
    });

    [].slice
      .call(
        document.querySelectorAll(".multi-language-selector .language-option")
      )
      .forEach(function (optionEl) {
        if (optionEl.getAttribute("data-lang") === languageId) {
          optionEl.classList.add("selected");
        } else {
          optionEl.classList.remove("selected");
        }
      });

    [].slice
      .call(document.querySelectorAll(".multi-language-text"))
      .forEach(function (el) {
        if (!el.classList.contains("lang-" + languageId)) {
          el.classList.add("hidden");
        } else {
          el.classList.remove("hidden");
        }
      });

    // Update all download links for selected language
    document.querySelectorAll("a.download-project-link").forEach(link => {
      const basePath = link.getAttribute("data-base-path");
      if (basePath && languageId) {
        const normalizedBase = basePath.endsWith("/") ? basePath : basePath + "/";
        const fullUrl = "https://download-directory.github.io/?url=" + encodeURIComponent(normalizedBase + languageId);
        link.setAttribute("href", fullUrl);
      }
    });
  }

  switchSampleLanguage(preferredBuildScriptLanguage);
}

document.addEventListener("DOMContentLoaded", function () {
  postProcessCodeBlocks();
});
</script>
<style>/* Custom CSS on top of external clipboard.js */
.listingblock:hover .clipboard {
    display: block;
}

.clipboard {
    display: block;
    content: "  ";
    position: absolute;
    top: 0.3rem;
    right: 0.5em;
    height: 1em;
    width: 1em;
    color: inherit;
    border: none;
    opacity: 0.5;
    cursor: pointer;
    filter: invert(50.2%);
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cpath fill-rule='evenodd' d='M5.75 1a.75.75 0 00-.75.75v3c0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75v-3a.75.75 0 00-.75-.75h-4.5zm.75 3V2.5h3V4h-3zm-2.874-.467a.75.75 0 00-.752-1.298A1.75 1.75 0 002 3.75v9.5c0 .966.784 1.75 1.75 1.75h8.5A1.75 1.75 0 0014 13.25v-9.5a1.75 1.75 0 00-.874-1.515.75.75 0 10-.752 1.298.25.25 0 01.126.217v9.5a.25.25 0 01-.25.25h-8.5a.25.25 0 01-.25-.25v-9.5a.25.25 0 01.126-.217z'%3E%3C/path%3E%3C/svg%3E") no-repeat;
}

@keyframes clibpard_rotation_frame {
    50% { transform: rotateY(180deg); }
}

.clipboard_success {
    filter: invert(100%);
    animation: clibpard_rotation_frame 1s;
}
</style></head>
<body class="book">
<!--
  ~ Copyright 2025 the original author or authors.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="layout">
    <header class="site-layout__header site-header" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
        <nav class="site-header__navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement">
            <div class="site-header__navigation-header">
                <a target="_top" class="logo" href="https://docs.gradle.org" title="Gradle Docs">
                    <svg width="139px" height="43px" viewBox="0 0 278 86" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <title>Gradle</title>
                        <path class="cls-1" d="M155,56.32V70.27a18.32,18.32,0,0,1-5.59,2.83,21.82,21.82,0,0,1-6.36.89,21.08,21.08,0,0,1-7.64-1.31A17.12,17.12,0,0,1,129.59,69a16.14,16.14,0,0,1-3.73-5.58,18.78,18.78,0,0,1-1.31-7.08,19.58,19.58,0,0,1,1.26-7.14A15.68,15.68,0,0,1,135,40a20.39,20.39,0,0,1,7.45-1.29,22,22,0,0,1,3.92.33,20.43,20.43,0,0,1,3.39.92,15.16,15.16,0,0,1,2.85,1.42A17.3,17.3,0,0,1,155,43.25l-1.84,2.91a1.72,1.72,0,0,1-1.12.84,2,2,0,0,1-1.5-.34L149,45.75a10.49,10.49,0,0,0-1.75-.79,14.33,14.33,0,0,0-2.17-.54,15.29,15.29,0,0,0-2.78-.22,11.91,11.91,0,0,0-4.61.86,9.66,9.66,0,0,0-3.52,2.46,10.9,10.9,0,0,0-2.24,3.84,14.88,14.88,0,0,0-.79,5,15.23,15.23,0,0,0,.85,5.28,11.06,11.06,0,0,0,2.38,3.94A10.15,10.15,0,0,0,138.05,68a14.28,14.28,0,0,0,8.25.44,17.1,17.1,0,0,0,2.94-1.09V61.14h-4.35a1.3,1.3,0,0,1-1-.35,1.15,1.15,0,0,1-.35-.85V56.32Zm10.47-2.93a10.53,10.53,0,0,1,2.72-3.45,5.77,5.77,0,0,1,3.72-1.25,4.5,4.5,0,0,1,2.72.74l-.38,4.41a1.18,1.18,0,0,1-.34.61,1,1,0,0,1-.61.18,6.76,6.76,0,0,1-1.06-.12,8.22,8.22,0,0,0-1.38-.12,5,5,0,0,0-1.74.28,4.37,4.37,0,0,0-1.37.83,5.55,5.55,0,0,0-1.07,1.3,12.26,12.26,0,0,0-.87,1.74V73.61H160V49.14h3.45a1.94,1.94,0,0,1,1.27.32,1.9,1.9,0,0,1,.48,1.16Zm11.36-.84A14.49,14.49,0,0,1,187,48.69a9.92,9.92,0,0,1,3.84.7,8.06,8.06,0,0,1,2.86,2,8.38,8.38,0,0,1,1.78,3,11.64,11.64,0,0,1,.61,3.82V73.61h-2.68a2.64,2.64,0,0,1-1.28-.25,1.72,1.72,0,0,1-.72-1l-.52-1.77a20.25,20.25,0,0,1-1.82,1.47,10.86,10.86,0,0,1-1.83,1.06,10.36,10.36,0,0,1-2,.66,12,12,0,0,1-2.4.22,9.64,9.64,0,0,1-2.86-.41,6.28,6.28,0,0,1-2.27-1.26,5.6,5.6,0,0,1-1.48-2.07,7.38,7.38,0,0,1-.52-2.89,5.7,5.7,0,0,1,.31-1.85,5.3,5.3,0,0,1,1-1.75,8.25,8.25,0,0,1,1.83-1.57,11.17,11.17,0,0,1,2.75-1.29,23.28,23.28,0,0,1,3.81-.9,36.77,36.77,0,0,1,5-.41V58.16a5.35,5.35,0,0,0-1.05-3.64,3.83,3.83,0,0,0-3-1.18,7.3,7.3,0,0,0-2.38.33,9.39,9.39,0,0,0-1.65.75l-1.3.75a2.52,2.52,0,0,1-1.3.34,1.7,1.7,0,0,1-1.05-.32,2.61,2.61,0,0,1-.69-.76Zm13.5,10.61a31.66,31.66,0,0,0-4.3.45,11,11,0,0,0-2.79.82,3.57,3.57,0,0,0-1.5,1.17,2.89,2.89,0,0,0,.47,3.67,3.93,3.93,0,0,0,2.39.67,7,7,0,0,0,3.14-.66,9.52,9.52,0,0,0,2.59-2Zm32.53-25V73.61h-3.6a1.39,1.39,0,0,1-1.48-1.07l-.5-2.36a12.4,12.4,0,0,1-3.4,2.74,9.17,9.17,0,0,1-4.47,1,7.95,7.95,0,0,1-6.55-3.26A11.61,11.61,0,0,1,201,66.79a19.71,19.71,0,0,1-.66-5.34,16.77,16.77,0,0,1,.74-5.06,12.21,12.21,0,0,1,2.13-4,9.88,9.88,0,0,1,3.31-2.69,9.64,9.64,0,0,1,4.34-1,8.63,8.63,0,0,1,3.51.64,9,9,0,0,1,2.6,1.74V38.17ZM217,55.39a5.94,5.94,0,0,0-2.18-1.72,6.54,6.54,0,0,0-2.54-.5,5.68,5.68,0,0,0-2.41.5A4.87,4.87,0,0,0,208,55.19a7.19,7.19,0,0,0-1.17,2.57,14.83,14.83,0,0,0-.4,3.69,16.34,16.34,0,0,0,.34,3.63,7.14,7.14,0,0,0,1,2.44,3.79,3.79,0,0,0,1.58,1.36,5,5,0,0,0,2.07.41,6,6,0,0,0,3.13-.76A9.19,9.19,0,0,0,217,66.36Zm17.67-17.22V73.61h-5.89V38.17ZM245.1,62.11a11.37,11.37,0,0,0,.67,3.26,6.54,6.54,0,0,0,1.38,2.27,5.39,5.39,0,0,0,2,1.33,7.26,7.26,0,0,0,2.61.44,8.21,8.21,0,0,0,2.47-.33,11.51,11.51,0,0,0,1.81-.74c.52-.27,1-.52,1.36-.74a2.31,2.31,0,0,1,1.13-.33,1.21,1.21,0,0,1,1.1.55L261.36,70a9.45,9.45,0,0,1-2.19,1.92,12.18,12.18,0,0,1-2.54,1.24,14,14,0,0,1-2.7.66,18.78,18.78,0,0,1-2.65.19,12.93,12.93,0,0,1-4.75-.85,10.65,10.65,0,0,1-3.82-2.5,11.8,11.8,0,0,1-2.55-4.1,15.9,15.9,0,0,1-.93-5.67,13.55,13.55,0,0,1,.81-4.71,11.34,11.34,0,0,1,2.33-3.84,11,11,0,0,1,3.69-2.59,12.31,12.31,0,0,1,4.93-1,11.86,11.86,0,0,1,4.27.74,9.25,9.25,0,0,1,3.36,2.16,9.84,9.84,0,0,1,2.21,3.48,13,13,0,0,1,.8,4.71,3.82,3.82,0,0,1-.29,1.8,1.19,1.19,0,0,1-1.1.46Zm11.23-3.55A7.28,7.28,0,0,0,256,56.4a5.16,5.16,0,0,0-1-1.77,4.44,4.44,0,0,0-1.63-1.21,5.68,5.68,0,0,0-2.3-.44,5.46,5.46,0,0,0-4,1.45,7.13,7.13,0,0,0-1.87,4.13ZM112.26,14a13.72,13.72,0,0,0-19.08-.32,1.27,1.27,0,0,0-.41.93,1.31,1.31,0,0,0,.38.95l1.73,1.73a1.31,1.31,0,0,0,1.71.12,7.78,7.78,0,0,1,4.71-1.57,7.87,7.87,0,0,1,5.57,13.43C96,40.2,81.41,9.66,48.4,25.37a4.48,4.48,0,0,0-2,6.29l5.66,9.79a4.49,4.49,0,0,0,6.07,1.67l.14-.08-.11.08,2.51-1.41a57.72,57.72,0,0,0,7.91-5.89,1.37,1.37,0,0,1,1.8-.06h0a1.29,1.29,0,0,1,0,2A59.79,59.79,0,0,1,62.11,44l-.09.05-2.51,1.4a7,7,0,0,1-3.47.91,7.19,7.19,0,0,1-6.23-3.57l-5.36-9.24C34.17,40.81,27.93,54.8,31.28,72.5a1.31,1.31,0,0,0,1.29,1.06h6.09A1.3,1.3,0,0,0,40,72.42a8.94,8.94,0,0,1,17.73,0A1.3,1.3,0,0,0,59,73.56h5.94a1.31,1.31,0,0,0,1.3-1.14,8.93,8.93,0,0,1,17.72,0,1.3,1.3,0,0,0,1.29,1.14h5.87a1.3,1.3,0,0,0,1.3-1.28c.14-8.28,2.37-17.79,8.74-22.55C123.15,33.25,117.36,19.12,112.26,14ZM89.79,38.92l-4.2-2.11h0a2.64,2.64,0,1,1,4.2,2.12Z"/>
                    </svg>
                </a>
                <div class="site-header__doc-type sr-only">User Manual</div>
                <div class="site-header-version"></div>
                <button type="button" aria-label="Navigation Menu" class="site-header__navigation-button hamburger">
                    <span class="hamburger__bar"></span>
                    <span class="hamburger__bar"></span>
                    <span class="hamburger__bar"></span>
                </button>
            </div>
            <div class="site-header__navigation-collapsible site-header__navigation-collapsible--collapse">
                <ul class="site-header__navigation-items">
                    <li id="theme-toggle" class="site-header__navigation-item">
                        <a class="site-header__navigation-link theme-toggle" title="Theme">
                            <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <title>Theme</title>
                                <path d="m12 22c5.5228475 0 10-4.4771525 10-10s-4.4771525-10-10-10-10 4.4771525-10 10 4.4771525 10 10 10zm0-1.5v-17c4.6944204 0 8.5 3.80557963 8.5 8.5 0 4.6944204-3.8055796 8.5-8.5 8.5z"/>
                            </svg>
                        </a>
                        <script type="text/javascript">
                            const lightThemeStyle = document.getElementById("light-theme-style");
                            const darkThemeStyle = document.getElementById("dark-theme-style");
                            const btn = document.querySelector(".theme-toggle");
                            const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");

                            function enableLightTheme() {
                              lightThemeStyle.disabled = false;
                              darkThemeStyle.disabled = true;
                              document.body.classList.remove("dark-theme");
                              document.body.classList.add("light-theme");
                              localStorage.setItem("theme", "light");
                            }

                            function enableDarkTheme() {
                              lightThemeStyle.disabled = true;
                              darkThemeStyle.disabled = false;
                              document.body.classList.remove("light-theme");
                              document.body.classList.add("dark-theme");
                              localStorage.setItem("theme", "dark");
                            }

                            // Check for stored theme preference on page load
                            const currentTheme = localStorage.getItem("theme");
                            if (currentTheme === "dark") {
                              enableDarkTheme();
                            } else if (currentTheme === "light") {
                              enableLightTheme();
                            } else if (prefersDarkScheme.matches) {
                              // If no stored theme, check system preference
                              enableDarkTheme();
                            } else {
                              enableLightTheme();
                            }

                            // Add click event listener to the toggle button
                            btn.addEventListener("click", () => {
                              if (darkThemeStyle.disabled) {
                                enableDarkTheme();
                              } else {
                                enableLightTheme();
                              }
                            });
                        </script>
                    </li>
                    <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                        <span class="site-header__navigation-link">
                            Community
                        </span>
                        <div class="site-header__navigation-submenu">
                            <div class="site-header__navigation-submenu-item" itemprop="name">
                                <a target="_top" class="site-header__navigation-submenu-item-link" href="https://gradle.org/" itemprop="url">
                                    <span class="site-header__navigation-submenu-item-link-text">Community Home</span>
                                </a>
                            </div>
                            <div class="site-header__navigation-submenu-item" itemprop="name">
                                <a target="_top" class="site-header__navigation-submenu-item-link" href="https://discuss.gradle.org/" itemprop="url">
                                    <span class="site-header__navigation-submenu-item-link-text">Community Forums</span>
                                </a>
                            </div>
                            <div class="site-header__navigation-submenu-item" itemprop="name">
                                <a target="_top" class="site-header__navigation-submenu-item-link" href="https://plugins.gradle.org" itemprop="url">
                                    <span class="site-header__navigation-submenu-item-link-text">Community Plugins</span>
                                </a>
                            </div>
                        </div>
                    </li>
                    <li class="site-header__navigation-item" itemprop="name">
                        <a target="_top" class="site-header__navigation-link" href="https://dpeuniversity.gradle.com/" itemprop="url">DPE University</a>
                    </li>
                    <li class="site-header__navigation-item" itemprop="name">
                        <a target="_top" class="site-header__navigation-link" href="https://gradle.org/training/" itemprop="url">Events</a>
                    </li>
                    <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                        <span class="site-header__navigation-link">
                            News
                        </span>
                        <div class="site-header__navigation-submenu">
                            <div class="site-header__navigation-submenu-item" itemprop="name">
                                <a class="site-header__navigation-submenu-item-link" href="https://newsletter.gradle.org" itemprop="url">
                                    <span class="site-header__navigation-submenu-item-link-text">Newsletter</span>
                                </a>
                            </div>
                            <div class="site-header__navigation-submenu-item" itemprop="name">
                                <a class="site-header__navigation-submenu-item-link" href="https://blog.gradle.org" itemprop="url">
                                    <span class="site-header__navigation-submenu-item-link-text">Blog</span>
                                </a>
                            </div>
                            <div class="site-header__navigation-submenu-item">
                                <a class="site-header__navigation-submenu-item-link" href="https://twitter.com/gradle">
                                    <span class="site-header__navigation-submenu-item-link-text">Twitter</span>
                                </a>
                            </div>
                        </div>
                    </li>
                    <li class="site-header__navigation-item" itemprop="name">
                        <a target="_top" class="site-header__navigation-link" href="https://gradle.com/develocity" itemprop="url">Develocity</a>
                    </li>
                    <li class="site-header__navigation-item">
                        <a class="site-header__navigation-link" title="Gradle on GitHub" href="https://github.com/gradle/gradle">
                            <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <title>Github</title>
                                <path d="M10 0C4.477 0 0 4.477 0 10c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.268 2.75 1.026A9.578 9.578 0 0 1 10 4.836c.85.004 1.705.114 2.504.337 1.909-1.294 2.747-1.026 2.747-1.026.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.579.688.481C17.137 18.163 20 14.418 20 10c0-5.523-4.478-10-10-10" fill-rule="evenodd";/>
                            </svg>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <!-- Primary Navigation -->
        <nav class="docs-navigation">
            <div class="search-container"></div>
            <h3 id="overview"><a href="../userguide/userguide.html">Gradle User Manual</a></h3>

            <h3 id="what-is-new">Releases</h3>
            <ul>
                <li><a href="https://gradle.org/releases/">All Releases</a></li>
                <li><a href="../release-notes.html">Release Notes</a></li>
                <li><a href="../userguide/installation.html">Installing Gradle</a></li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#upgrading-gradle" aria-expanded="false" aria-controls="upgrading-gradle">Upgrading Gradle</a>
                    <ul id="upgrading-gradle">
                        <li><a href="../userguide/upgrading_version_9.html">Within versions 9.x.y</a></li>
                        <li><a href="../userguide/upgrading_major_version_9.html">To version 9.0.0</a></li>
                        <li><a href="../userguide/upgrading_version_8.html">Within versions 8.x</a></li>
                        <li><a href="../userguide/upgrading_version_7.html">From version 7.x to 8.0</a></li>
                        <li><a href="../userguide/upgrading_version_6.html">From version 6.x to 7.0</a></li>
                        <li><a href="../userguide/upgrading_version_5.html">From version 5.x to 6.0</a></li>
                        <li><a href="../userguide/upgrading_version_4.html">From version 4.x to 5.0</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#migrating-to-gradle" aria-expanded="false" aria-controls="migrating-to-gradle">Migrating to Gradle</a>
                    <ul id="migrating-to-gradle">
                        <li><a href="../userguide/migrating_from_maven.html">from Maven</a></li>
                        <li><a href="../userguide/migrating_from_ant.html">from Ant</a></li>
                    </ul>
                </li>
                <li><a href="../userguide/compatibility.html">Compatibility Notes</a></li>
                <li><a href="../userguide/feature_lifecycle.html">Gradle's Feature Lifecycle</a></li>
            </ul>

            <h3 id="running-gradle-builds">Gradle Tutorials</h3>
            <ul>
                <li><a href="../userguide/getting_started.html">Getting Started</a></li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#running-introduction" aria-expanded="false" aria-controls="introduction">Running Gradle Builds</a>
                    <ul id="running-introduction">
                        <li><a href="../userguide/gradle_basics.html">1. Core Concepts</a></li>
                        <li><a href="../userguide/gradle_wrapper_basics.html">2. Wrapper Basics</a></li>
                        <li><a href="../userguide/command_line_interface_basics.html">3. CLI Basics</a></li>
                        <li><a href="../userguide/settings_file_basics.html">4. Settings File Basics</a></li>
                        <li><a href="../userguide/build_file_basics.html">5. Build File Basics</a></li>
                        <li><a href="../userguide/dependency_management_basics.html">6. Dependencies Basics</a></li>
                        <li><a href="../userguide/task_basics.html">7. Tasks Basics</a></li>
                        <li><a href="../userguide/gradle_optimizations.html">8. Caching Basics</a></li>
                        <li><a href="../userguide/plugin_basics.html">9. Plugins Basics</a></li>
                        <li><a href="../userguide/build_scans.html">10. Build Scan Basics</a></li>

                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" aria-expanded="false">Beginner Tutorial</a>
                    <ul id="running-tutorial">
                        <li><a href="../userguide/part1_gradle_init.html">1. Initializing the Project</a></li>
                        <li><a href="../userguide/part2_gradle_tasks.html">2. Running Tasks</a></li>
                        <li><a href="../userguide/part3_gradle_dep_man.html">3. Understanding Dependencies</a></li>
                        <li><a href="../userguide/part4_gradle_plugins.html">4. Applying Plugins</a></li>
                        <li><a href="../userguide/part5_gradle_inc_builds.html">5. Exploring Incremental Builds</a></li>
                        <li><a href="../userguide/part6_gradle_caching.html">6. Enabling the Build Cache</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#beyond-the-basics" aria-expanded="false" aria-controls="beyond-the-basics">Authoring Gradle Builds</a>
                    <ul id="authoring-introduction">
                        <li><a href="../userguide/gradle_directories_intermediate.html">1. Anatomy of a Gradle Build</a></li>
                        <li><a href="../userguide/multi_project_builds_intermediate.html">2. Structuring Multi-Project Builds</a></li>
                        <li><a href="../userguide/build_lifecycle_intermediate.html">3. Gradle Build Lifecycle</a></li>
                        <li><a href="../userguide/writing_build_scripts_intermediate.html">4. Writing Build Scripts</a></li>
                        <li><a href="../userguide/gradle_managed_types_intermediate.html">5. Gradle Managed Types</a></li>
                        <li><a href="../userguide/dependencies_intermediate.html">6. Declaring Dependencies</a></li>
                        <li><a href="../userguide/writing_tasks_intermediate.html">7. Creating and Registering Tasks</a></li>
                        <li><a href="../userguide/plugins_intermediate.html">8. Working with Plugins</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" aria-expanded="false">Intermediate Tutorial</a>
                    <ul id="authoring-tutorial">
                        <li><a href="../userguide/part1_gradle_init_project.html">1. Initializing the Project</a></li>
                        <li><a href="../userguide/part2_build_lifecycle.html">2. Understanding the Build Lifecycle</a></li>
                        <li><a href="../userguide/part3_multi_project_builds.html">3. Multi-Project Builds</a></li>
                        <li><a href="../userguide/part4_settings_file.html">4. Writing the Settings File</a></li>
                        <li><a href="../userguide/part5_build_scripts.html">5. Writing a Build Script</a></li>
                        <li><a href="../userguide/part6_writing_tasks.html">6. Writing Tasks</a></li>
                        <li><a href="../userguide/part7_writing_plugins.html">7. Writing Plugins</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#deep-dive" aria-expanded="false" aria-controls="deep-dive">Developing Gradle Plugins</a>
                    <ul id="developing-introduction">
                        <li><a href="../userguide/plugin_introduction_advanced.html">1. Plugin Introduction</a></li>
                        <li><a href="../userguide/pre_compiled_script_plugin_advanced.html">2. Pre-Compiled Script Plugins</a></li>
                        <li><a href="../userguide/binary_plugin_advanced.html">3. Binary Plugins</a></li>
                        <li><a href="../userguide/developing_binary_plugin_advanced.html">4. Developing Binary Plugins</a></li>
                        <li><a href="../userguide/testing_binary_plugin_advanced.html">5. Testing Binary Plugins</a></li>
                        <li><a href="../userguide/publishing_binary_plugin_advanced.html">6. Publishing Binary Plugins</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" aria-expanded="false">Advanced Tutorial</a>
                    <ul id="developing-tutorial">
                        <li><a href="../userguide/part1_gradle_init_plugin.html">1. Initializing the Project</a></li>
                        <li><a href="../userguide/part2_add_extension.html">2. Adding an Extension</a></li>
                        <li><a href="../userguide/part3_create_custom_task.html">3. Creating a Custom Task</a></li>
                        <li><a href="../userguide/part4_unit_test.html">4. Writing a Unit Test</a></li>
                        <li><a href="../userguide/part5_add_dataflow_Action.html">5. Adding a DataFlow Action</a></li>
                        <li><a href="../userguide/part6_functional_test.html">6. Writing a Functional Test</a></li>
                        <li><a href="../userguide/part7_use_consumer_project.html">7. Using a Consumer Project</a></li>
                        <li><a href="../userguide/part8_publish_locally.html">8. Publish the Plugin</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="gradle-reference">Gradle Reference</h3>
            <ul>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#gradle-core" aria-expanded="false" aria-controls="gradle-core">Runtime and Configuration</a>
                    <ul id="core-topics">
                        <li><a href="../userguide/command_line_interface.html">Command-Line Interface</a></li>
                        <li><a href="../userguide/logging.html">Logging and Output</a></li>
                        <li><a href="../userguide/gradle_wrapper.html">Gradle Wrapper</a></li>
                        <li><a href="../userguide/gradle_daemon.html">Gradle Daemon</a></li>
                        <li><a href="../userguide/directory_layout.html">Gradle Directories</a></li>
                        <li><a href="../userguide/build_environment.html">Build Configuration</a></li>
                        <li><a href="../userguide/build_lifecycle.html">Build Lifecycle</a></li>
                        <li><a href="../userguide/inspect.html">Build Scan</a></li>
                        <li><a href="../userguide/continuous_builds.html">Continuous Builds</a></li>
                        <li><a href="../userguide/file_system_watching.html">File System Watching</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#dsl-and-apis" aria-expanded="false" aria-controls="dsl-and-apis">DSLs and APIs</a>
                    <ul id="dsl-topics">
                        <li><a href="../javadoc/index.html?overview-summary.html">Java API</a></li>
                        <li><a href="../userguide/groovy_build_script_primer.html">Groovy DSL Primer</a></li>
                        <li><a href="../dsl/index.html">Groovy DSL</a></li>
                        <li><a href="../userguide/kotlin_dsl.html">Kotlin DSL Primer</a></li>
                        <li><a href="../kotlin-dsl/index.html" target="_blank">Kotlin DSL</a></li>
                        <li><a href="../userguide/public_apis.html">Public APIs</a></li>
                        <li><a href="../userguide/default_script_imports.html">Default Script Imports</a></li>
                        <li><a href="../userguide/migrating_from_groovy_to_kotlin_dsl.html">Groovy to Kotlin DSL Migration</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#best-practices" aria-expanded="false" aria-controls="best-practices">Best Practices</a>
                    <ul id="best-practices-topics">
                        <li><a href="../userguide/best_practices.html">Introduction</a></li>
                        <li><a href="../userguide/best_practices_index.html">Index</a></li>
                        <li><a href="../userguide/best_practices_general.html">General Best Practices</a></li>
                        <li><a href="../userguide/best_practices_structuring_builds.html">Best Practices for Structuring Builds</a></li>
                        <li><a href="../userguide/best_practices_dependencies.html">Best Practices for Dependencies</a></li>
                        <li><a href="../userguide/best_practices_tasks.html">Best Practices for Tasks</a></li>
                        <li><a href="../userguide/best_practices_performance.html">Best Practices for Performance</a></li>
                        <li><a href="../userguide/best_practices_security.html">Best Practices for Security</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#core-plugins" aria-expanded="false" aria-controls="core-plugins">Core Plugins</a>
                    <ul id="core-plugins-topics">
                        <li><a href="../userguide/plugin_reference.html">List of Core Plugins</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#types-and-objects" aria-expanded="false" aria-controls="types-and-objects">Gradle Types</a>
                    <ul id="types-and-objects-topics">
                        <li><a href="../userguide/lazy_eager_evaluation.html">Lazy vs Eager Evaluation</a></li>
                        <li><a href="../userguide/properties_providers.html">Properties and Providers</a></li>
                        <li><a href="../userguide/collections.html">Collections</a></li>
                        <li><a href="../userguide/service_injection.html">Services and Service Injection</a></li>
                        <li><a href="../userguide/working_with_files.html">Working with Files</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#build-structure" aria-expanded="false" aria-controls="build-structure">Structuring Builds</a>
                    <ul id="build-structure-topics">
                        <li><a href="../userguide/organizing_gradle_projects.html">Structuring and Organizing Projects</a></li>
                        <li><a href="../userguide/multi_project_builds.html">Multi-Project Builds</a></li>
                        <li><a href="../userguide/sharing_build_logic_between_subprojects.html">Sharing Build Logic using buildSrc</a></li>
                        <li><a href="../userguide/composite_builds.html">Composite Builds</a></li>
                        <li><a href="../userguide/configuration_on_demand.html">Configuration on Demand</a></li>
                        <li><a href="../userguide/isolated_projects.html">Isolated Projects</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#task-development" aria-expanded="false" aria-controls="task-development">Task Development</a>
                    <ul id="task-development-topics">
                        <li><a href="../userguide/more_about_tasks.html">Understanding Tasks</a></li>
                        <li><a href="../userguide/controlling_task_execution.html">Controlling Task Execution</a></li>
                        <li><a href="../userguide/organizing_tasks.html">Organizing Tasks</a></li>
                        <li><a href="../userguide/implementing_custom_tasks.html">Implementing Custom Tasks</a></li>
                        <li><a href="../userguide/lazy_configuration.html">Lazy Configuration</a></li>
                        <li><a href="../userguide/worker_api.html">Parallel Task Execution</a></li>
                        <li><a href="../userguide/custom_tasks.html">Advanced Task Development</a></li>
                        <li><a href="../userguide/build_services.html">Shared Build Services</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#plugin-development" aria-expanded="false" aria-controls="plugin-development">Plugin Development</a>
                    <ul id="plugin-development-topics">
                        <li><a href="../userguide/plugins.html">Introduction to Plugins</a></li>
                        <li><a href="../userguide/implementing_gradle_plugins.html">Plugin Implementation Options</a></li>
                        <li><a href="../userguide/implementing_gradle_plugins_precompiled.html">Precompiled Script Plugins</a></li>
                        <li><a href="../userguide/implementing_gradle_plugins_binary.html">Binary Plugins</a></li>
                        <li><a href="../userguide/testing_gradle_plugins.html">Testing Plugins</a></li>
                        <li><a href="../userguide/publishing_gradle_plugins.html">Publishing Plugins</a></li>
                        <li><a href="../userguide/reporting_problems.html">Reporting Plugin Problems</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#advanced-topics" aria-expanded="false" aria-controls="advanced-topics">Other Topics</a>
                    <ul id="advanced-topics-topics">
                        <li><a href="../userguide/init_scripts.html">Initialization Scripts</a></li>
                        <li><a href="../userguide/dataflow_actions.html">Dataflow Actions</a></li>
                        <li><a href="../userguide/test_kit.html">Testing with TestKit</a></li>
                        <li><a href="../userguide/ant.html">Using Ant from Gradle</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="optimizing-build-performance">Optimizing Gradle Builds</h3>
            <ul>
                <li><a href="../userguide/performance.html">Improving Performance</a></li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#build-cache" aria-expanded="false" aria-controls="build-cache">Build Cache</a>
                    <ul id="build-cache">
                        <li><a href="../userguide/build_cache.html">Enabling and Configuring</a></li>
                        <li><a href="../userguide/build_cache_use_cases.html">Why use the Build Cache?</a></li>
                        <li><a href="../userguide/build_cache_performance.html">Understanding the Impact</a></li>
                        <li><a href="../userguide/build_cache_concepts.html">Learning Basic Concepts</a></li>
                        <li><a href="../userguide/caching_java_projects.html">Caching Java Project</a></li>
                        <li><a href="../userguide/caching_android_projects.html">Caching Android Project</a></li>
                        <li><a href="../userguide/build_cache_debugging.html">Debugging Caching Issues</a></li>
                        <li><a href="../userguide/common_caching_problems.html">Troubleshooting</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#configuration-cache" aria-expanded="false" aria-controls="configuration-cache">Configuration Cache</a>
                    <ul id="configuration-cache">
                        <li><a href="../userguide/configuration_cache.html">How it Works</a></li>
                        <li><a href="../userguide/configuration_cache_enabling.html">Enabling and Configuring</a></li>
                        <li><a href="../userguide/configuration_cache_requirements.html">Requirements for your Build Logic</a></li>
                        <li><a href="../userguide/configuration_cache_debugging.html">Debugging and Troubleshooting</a></li>
                        <li><a href="../userguide/configuration_cache_status.html">Status</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="managing-dependencies">Dependency Management</h3>
            <ul>
                <li><a href="../userguide/getting_started_dep_man.html">Getting Started</a></li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#learning-the-basics-dependency-management" aria-expanded="false" aria-controls="learning-the-basics-dependency-management">Learning the Basics</a>
                    <ul id="learning-the-basics-dependency-management">
                        <li><a href="../userguide/declaring_dependencies.html">1. Declaring Dependencies</a></li>
                        <li><a href="../userguide/dependency_configurations.html">2. Dependency Configurations</a></li>
                        <li><a href="../userguide/declaring_repositories.html">3. Declaring Repositories</a></li>
                        <li><a href="../userguide/centralizing_dependencies.html">4. Centralizing Dependencies</a></li>
                        <li><a href="../userguide/dependency_constraints_conflicts.html">5. Dependency Constraints and Conflict Resolution</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#understanding_dep_res" aria-expanded="false" aria-controls="understanding_dep_res">Advanced Concepts</a>
                    <ul id="understanding_dep_res">
                        <li><a href="../userguide/dependency_resolution.html">1. Dependency Resolution</a></li>
                        <li><a href="../userguide/graph_resolution.html">2. Graph Resolution</a></li>
                        <li><a href="../userguide/variant_aware_resolution.html">3. Variant Selection</a></li>
                        <li><a href="../userguide/artifact_resolution.html">4. Artifact Resolution</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#declaring-dependencies" aria-expanded="false" aria-controls="declaring-dependencies">Declaring Dependencies</a>
                    <ul id="declaring-dependencies">
                        <li><a href="../userguide/declaring_dependencies_basics.html">Declaring Dependencies</a></li>
                        <li><a href="../userguide/viewing_debugging_dependencies.html">Viewing Dependencies</a></li>
                        <li><a href="../userguide/dependency_versions.html">Declaring Versions and Ranges</a></li>
                        <li><a href="../userguide/dependency_constraints.html">Declaring Dependency Constraints</a></li>
                        <li><a href="../userguide/declaring_configurations.html">Creating Dependency Configurations</a></li>
                        <li><a href="../userguide/gradle_dependencies.html">Gradle Distribution-Specific Dependencies</a></li>
                        <li><a href="../userguide/dependency_verification.html">Verifying Dependencies</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#declaring-repositories" aria-expanded="false" aria-controls="declaring-repositories">Declaring Repositories</a>
                    <ul id="declaring-repositories">
                        <li><a href="../userguide/declaring_repositories_basics.html">Declaring Repositories</a></li>
                        <li><a href="../userguide/centralizing_repositories.html">Centralizing Repository Declarations</a></li>
                        <li><a href="../userguide/supported_repository_types.html">Repository Types</a></li>
                        <li><a href="../userguide/supported_metadata_formats.html">Metadata Formats</a></li>
                        <li><a href="../userguide/supported_repository_protocols.html">Supported Protocols</a></li>
                        <li><a href="../userguide/filtering_repository_content.html">Filtering Repository Content</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#centralizing-dependencies" aria-expanded="false" aria-controls="centralizing-dependencies">Centralizing Dependencies</a>
                    <ul id="centralizing-dependencies">
                        <li><a href="../userguide/platforms.html">Creating Platforms</a></li>
                        <li><a href="../userguide/version_catalogs.html">Creating Version Catalogs</a></li>
                        <li><a href="../userguide/centralizing_catalog_platform.html">Using Catalogs with Platforms</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#dependency-management" aria-expanded="false" aria-controls="dependency-management">Managing Dependencies</a>
                    <ul id="dependency-management">
                        <li><a href="../userguide/dependency_locking.html">Locking Versions</a></li>
                        <li><a href="../userguide/resolution_rules.html">Using Resolution Rules</a></li>
                        <li><a href="../userguide/component_metadata_rules.html">Modifying Dependency Metadata</a></li>
                        <li><a href="../userguide/dependency_caching.html">Caching Dependencies</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#dependency-resolution" aria-expanded="false" aria-controls="dependency-resolution">Controlling Dependency Resolution</a>
                    <ul id="dependency-resolution">
                        <li><a href="../userguide/dependency_resolution_consistency.html">Consistent Dependency Resolution</a></li>
                        <li><a href="../userguide/resolving_specific_artifacts.html">Resolving Specific Artifacts</a></li>
                        <li><a href="../userguide/component_capabilities.html">Capabilities</a></li>
                        <li><a href="../userguide/variant_attributes.html">Variants and Attributes</a></li>
                        <li><a href="../userguide/artifact_views.html">Artifact Views</a></li>
                        <li><a href="../userguide/artifact_transforms.html">Artifact Transforms</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#publishing" aria-expanded="false" aria-controls="publishing">Publishing Libraries</a>
                    <ul id="publishing">
                        <li><a href="../userguide/publishing_setup.html">Setting up Publishing</a></li>
                        <li><a href="../userguide/publishing_gradle_module_metadata.html">Understanding Gradle Module Metadata</a></li>
                        <li><a href="../userguide/publishing_signing.html">Signing Artifacts</a></li>
                        <li><a href="../userguide/publishing_customization.html">Customizing Publishing</a></li>
                        <li><a href="../userguide/publishing_maven.html">Maven Publish Plugin</a></li>
                        <li><a href="../userguide/publishing_ivy.html">Ivy Publish Plugin</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="platforms">Platforms</h3>
            <ul>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#jvm" aria-expanded="false" aria-controls="jvm">JVM Builds</a>
                    <ul id="jvm">
                        <li><a href="../userguide/building_java_projects.html">Building Java &amp; JVM projects</a></li>
                        <li><a href="../userguide/java_testing.html">Testing Java &amp; JVM projects</a></li>
                        <li><a class="nav-dropdown" data-toggle="collapse" href="#java-toolchains" aria-expanded="false" aria-controls="java-toolchains">Java Toolchains</a>
                            <ul id="java-toolchains">
                                <li><a href="../userguide/toolchains.html">Toolchains for JVM projects</a></li>
                                <li><a href="../userguide/toolchain_plugins.html">Toolchain Resolver Plugins</a></li>
                            </ul>
                        </li>
                        <li><a href="../userguide/dependency_management_for_java_projects.html">Managing Dependencies</a></li>
                        <li><a class="nav-dropdown" data-toggle="collapse" href="#jvm-plugins" aria-expanded="false" aria-controls="jvm-plugins">JVM Plugins</a>
                            <ul id="jvm-plugins">
                                <li><a href="../userguide/java_library_plugin.html">Java Library Plugin</a></li>
                                <li><a href="../userguide/application_plugin.html">Java Application Plugin</a></li>
                                <li><a href="../userguide/java_platform_plugin.html">Java Platform Plugin</a></li>
                                <li><a href="../userguide/groovy_plugin.html">Groovy Plugin</a></li>
                                <li><a href="../userguide/scala_plugin.html">Scala Plugin</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#cpp" aria-expanded="false" aria-controls="cpp">C++ Builds</a>
                    <ul id="cpp">
                        <li><a href="../userguide/building_cpp_projects.html">Building C++ projects</a></li>
                        <li><a href="../userguide/cpp_testing.html">Testing C++ projects</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#swift" aria-expanded="false" aria-controls="swift">Swift Builds</a>
                    <ul id="swift">
                        <li><a href="../userguide/building_swift_projects.html">Building Swift projects</a></li>
                        <li><a href="../userguide/swift_testing.html">Testing Swift projects</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="third-party-integration">Integration</h3>
            <ul>
                <li><a href="../userguide/third_party_integration.html">Third-party Tools</a></li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#third-party-api" aria-expanded="false" aria-controls="third-party-api">APIs</a>
                    <ul id="third-party-api">
                        <li><a href="../userguide/tooling_api.html">Tooling API</a></li>
                        <li><a href="../userguide/test_reporting_api.html">Test Reporting API</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="how-to-guides">How-To-Guides</h3>
            <ul>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#how-to-guides" aria-expanded="false" aria-controls="how-to-guides">Structuring Builds</a>
                    <ul id="how-to-guides-structuring">
                        <li><a href="../userguide/how_to_convert_single_build_to_multi_build.html">Convert a Single-Project Build to Multi-Project</a></li>
                    </ul>
                </li>
                <li><a class="nav-dropdown" data-toggle="collapse" href="#how-to" aria-expanded="false" aria-controls="how-to">Dependency Management</a>
                    <ul id="how-to-guides-dep-man">
                        <li><a href="../userguide/how_to_downgrade_transitive_dependencies.html">How to Downgrade Transitive Dependencies</a></li>
                        <li><a href="../userguide/how_to_upgrade_transitive_dependencies.html">How to Upgrade Transitive Dependencies</a></li>
                        <li><a href="../userguide/how_to_exclude_transitive_dependencies.html">How to Exclude Transitive Dependencies</a></li>
                        <li><a href="../userguide/how_to_prevent_accidental_dependency_upgrades.html">How to Prevent Accidental or Eager Dependency Upgrades</a></li>
                        <li><a href="../userguide/how_to_align_dependency_versions.html">How to Align Dependency Versions</a></li>
                        <li><a href="../userguide/how_to_share_outputs_between_projects.html">How to Share Outputs Between Projects</a></li>
                        <li><a href="../userguide/how_to_resolve_specific_artifacts.html">How to Resolve Specific Artifacts from a Module Dependency</a></li>
                        <li><a href="../userguide/how_to_use_local_forks.html">How to Use a Local Fork of a Module Dependency</a></li>
                        <li><a href="../userguide/how_to_fix_version_catalog_problems.html">How to Fix Version Catalog Problems</a></li>
                        <li><a href="../userguide/how_to_create_feature_variants_of_a_library.html">How to Create Feature Variants of a Library</a></li>
                    </ul>
                </li>
            </ul>

            <h3 id="reference">Additional</h3>
            <ul>
                <li><a href="../samples/index.html">Samples</a></li>
                <li><a href="../userguide/glossary.html">Glossary</a></li>
                <li><a href="https://community.gradle.org/cookbook/">Cookbook</a></li>
                <li><a href="../userguide/userguide_single.html">Single Page Version</a></li>
            </ul>
        </nav>
        <!-- End Primary Navigation -->

        <div class="content">
            <div class="chapter">
<div id="header">
<h1>Gradle User Manual: Version 9.1.0</h1>
<div class="details">
<span id="revnumber">version 9.1.0</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#part:releases">RELEASES</a>
<ul class="sectlevel2">
<li><a href="#installation">Installing Gradle</a></li>
<li><a href="#compatibility">Compatibility Matrix</a></li>
<li><a href="#feature_lifecycle">The Feature Lifecycle</a></li>
</ul>
</li>
<li><a href="#part:reference">RUNTIME AND CONFIGURATION</a>
<ul class="sectlevel2">
<li><a href="#command_line_interface">Command-Line Interface</a></li>
<li><a href="#logging">Logging and Output</a></li>
<li><a href="#gradle_wrapper">Gradle Wrapper</a></li>
<li><a href="#gradle_daemon">Gradle Daemon</a></li>
<li><a href="#directory_layout">Gradle-managed Directories</a></li>
<li><a href="#build_environment">Build Environment Configuration</a></li>
<li><a href="#build_lifecycle">Build Lifecycle</a></li>
<li><a href="#inspecting_build_scans">Build Scan</a></li>
<li><a href="#continuous_builds">Continuous Builds</a></li>
<li><a href="#sec:daemon_watch_fs">File System Watching</a></li>
</ul>
</li>
<li><a href="#dsl_and_apis">DSL AND APIS</a>
<ul class="sectlevel2">
<li><a href="#groovy_build_script_primer">A Groovy Build Script Primer</a></li>
<li><a href="#kotdsl:kotlin_dsl">Gradle Kotlin DSL Primer</a></li>
<li><a href="#script-default-imports">Default Imports</a></li>
</ul>
</li>
<li><a href="#best_practices">BEST PRACTICES</a>
<ul class="sectlevel2">
<li><a href="#best_practices">Best Practices for Authoring Gradle Builds</a></li>
<li><a href="#best_practices_index">Best Practices Index</a></li>
<li><a href="#best_practices_general">General Gradle Best Practices</a></li>
<li><a href="#best_practices_structuring_builds">Best Practices for Structuring Builds</a></li>
<li><a href="#best_practices_for_dependencies">Best Practices for Dependencies</a></li>
<li><a href="#best_practices_for_tasks">Best Practices for Tasks</a></li>
<li><a href="#best_practices_for_performance">Best Practices for Performance</a></li>
<li><a href="#best_practices_for_security">Best Practices for Security</a></li>
</ul>
</li>
<li><a href="#core_plugins">CORE PLUGINS</a>
<ul class="sectlevel2">
<li><a href="#plugin_reference">Gradle Plugin Reference</a></li>
</ul>
</li>
<li><a href="#gradle_types">GRADLE TYPES</a>
<ul class="sectlevel2">
<li><a href="#lazy_evaluation">Lazy vs Eager Evaluation</a></li>
<li><a href="#properties_and_providers">Properties and Providers</a></li>
<li><a href="#collection_types">Collections</a></li>
<li><a href="#service_injection">Services and Service Injection</a></li>
<li><a href="#working_with_files">Working With Files</a></li>
</ul>
</li>
<li><a href="#structuring_builds">STRUCTURING BUILDS</a>
<ul class="sectlevel2">
<li><a href="#organizing_gradle_projects">Structuring and Organizing Gradle Projects</a></li>
<li><a href="#multi_project_builds">Multi-Project Builds</a></li>
<li><a href="#sharing_build_logic_between_subprojects">Sharing Build Logic using <code>buildSrc</code></a></li>
<li><a href="#composite_builds">Composite Builds</a></li>
<li><a href="#configuration_and_execution">Configuration On Demand</a></li>
<li><a href="#isolated_projects">Isolated Projects</a></li>
</ul>
</li>
<li><a href="#developing_tasks">DEVELOPING TASKS</a>
<ul class="sectlevel2">
<li><a href="#more_about_tasks">Understanding Tasks</a></li>
<li><a href="#controlling_task_execution">Controlling Task Execution</a></li>
<li><a href="#organizing_tasks">Organizing Tasks</a></li>
<li><a href="#lazy_configuration">Configuring Tasks Lazily</a></li>
<li><a href="#tasks_parallel_worker">Developing Parallel Tasks</a></li>
<li><a href="#custom_tasks">Advanced Tasks</a></li>
<li><a href="#build_services">Using Shared Build Services</a></li>
</ul>
</li>
<li><a href="#developing_plugins">DEVELOPING PLUGINS</a>
<ul class="sectlevel2">
<li><a href="#custom_plugins">Understanding Plugins</a></li>
<li><a href="#implemention_plugins">Implementation Options for Plugins</a></li>
<li><a href="#implemention_precompiled_plugins">Implementing Pre-compiled Script Plugins</a></li>
<li><a href="#implemention_binary_plugins">Implementing Binary Plugins</a></li>
<li><a href="#testing_gradle_plugins">Testing Gradle plugins</a></li>
<li><a href="#publishing_portal">Publishing Plugins to the Gradle Plugin Portal</a></li>
<li><a href="#sec:reporting_problems">Reporting problems</a></li>
</ul>
</li>
<li><a href="#other_topics">OTHER TOPICS</a>
<ul class="sectlevel2">
<li><a href="#init_scripts">Initialization Scripts</a></li>
<li><a href="#dataflow_action">Dataflow Actions</a></li>
<li><a href="#test_kit">Testing Build Logic with TestKit</a></li>
<li><a href="#ant">Using Ant from Gradle</a></li>
</ul>
</li>
<li><a href="#part:optimizing_build_times">OPTIMIZING BUILD PERFORMANCE</a>
<ul class="sectlevel2">
<li><a href="#performance_gradle">Improve the Performance of Gradle Builds</a></li>
</ul>
</li>
<li><a href="#build_cache">BUILD CACHE</a>
<ul class="sectlevel2">
<li><a href="#build_cache">Build Cache</a></li>
<li><a href="#use_cases_cache">Use cases for the build cache</a></li>
<li><a href="#build_cache_performance">Build cache performance</a></li>
<li><a href="#important_concepts">Important concepts</a></li>
<li><a href="#caching_java_projects">Caching Java projects</a></li>
<li><a href="#caching_android_projects">Caching Android projects</a></li>
<li><a href="#debugging_and_diagnosing_build_cache_misses">Debugging and diagnosing Build Cache misses</a></li>
<li><a href="#common-problems">Solving common problems</a></li>
</ul>
</li>
<li><a href="#configuration_cache">CONFIGURATION CACHE</a>
<ul class="sectlevel2">
<li><a href="#config_cache">Configuration Cache</a></li>
<li><a href="#config_cache:usage">Enabling and Configuring the Configuration Cache</a></li>
<li><a href="#config_cache_requirements">Configuration Cache Requirements for your Build Logic</a></li>
<li><a href="#config_cache_debugging">Debugging and Troubleshooting the Configuration Cache</a></li>
<li><a href="#config_cache_status">Configuration Cache Status</a></li>
</ul>
</li>
<li><a href="#part:dependency_management">DECLARING DEPENDENCIES</a>
<ul class="sectlevel2">
<li><a href="#declaring-dependencies-basics">Declaring Dependencies Basics</a></li>
<li><a href="#viewing-debugging-dependencies">Viewing Dependencies</a></li>
<li><a href="#declaring-versions-ranges">Declaring Versions and Ranges</a></li>
<li><a href="#dependency-constraints">Declaring Dependency Constraints</a></li>
<li><a href="#declaring-dependency-configurations">Declaring Dependency Configurations</a></li>
<li><a href="#sub:gradle_distribution_dependencies">Gradle distribution-specific dependencies</a></li>
<li><a href="#verifying-dependencies">Verifying dependencies</a></li>
</ul>
</li>
<li><a href="#declaring_repositories">DECLARING REPOSITORIES</a>
<ul class="sectlevel2">
<li><a href="#declaring-repositories-basics">Declaring Repositories Basics</a></li>
<li><a href="#centralized-repository-declaration">Centralizing Repository Declarations</a></li>
<li><a href="#repository-types">Repository Types</a></li>
<li><a href="#metadata-formats">Metadata Formats</a></li>
<li><a href="#supported-transport-protocols">Supported Protocols</a></li>
<li><a href="#repository-content-filtering">Filtering Repository Content</a></li>
</ul>
</li>
<li><a href="#centralizing_dependencies">CENTRALIZING DEPENDENCIES</a>
<ul class="sectlevel2">
<li><a href="#platforms">Platforms</a></li>
<li><a href="#version-catalog">Version Catalogs</a></li>
<li><a href="#platforms-vs-catalog">Using Catalogs with Platforms</a></li>
</ul>
</li>
<li><a href="#managing_dependencies">MANAGING DEPENDENCIES</a>
<ul class="sectlevel2">
<li><a href="#locking-versions">Locking Versions</a></li>
<li><a href="#using-resolution-rules">Using Resolution Rules</a></li>
<li><a href="#component-metadata-rules">Modifying Dependency Metadata</a></li>
<li><a href="#dependency-caching">Dependency Caching</a></li>
</ul>
</li>
<li><a href="#controlling_dependency_resolution">CONTROLLING DEPENDENCY RESOLUTION</a>
<ul class="sectlevel2">
<li><a href="#resolution_consistency">Dependency Resolution Consistency</a></li>
<li><a href="#resolving-specific-artifacts">Resolving Specific Artifacts</a></li>
<li><a href="#capabilities">Capabilities</a></li>
<li><a href="#variant-attributes">Variants and Attributes</a></li>
<li><a href="#artifact-views">Artifact Views</a></li>
<li><a href="#artifact-transforms">Artifact Transforms</a></li>
</ul>
</li>
<li><a href="#publishing_libraries">PUBLISHING LIBRARIES</a>
<ul class="sectlevel2">
<li><a href="#publishing_components">Publishing a project as module</a></li>
<li><a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a></li>
<li><a href="#publishing_maven:signing">Signing artifacts</a></li>
<li><a href="#customizing_publishing">Customizing publishing</a></li>
<li><a href="#publishing_maven">The Maven Publish Plugin</a></li>
<li><a href="#publishing_ivy">The Ivy Publish Plugin</a></li>
</ul>
</li>
<li><a href="#part:jvm_projects">JVM BUILDS</a>
<ul class="sectlevel2">
<li><a href="#building_java_projects">Building Java &amp; JVM projects</a></li>
<li><a href="#java_testing">Testing in Java &amp; JVM projects</a></li>
<li><a href="#dependency_management_for_java_projects">Managing Dependencies of JVM Projects</a></li>
</ul>
</li>
<li><a href="#java_toolchains">JAVA TOOLCHAINS</a>
<ul class="sectlevel2">
<li><a href="#toolchains">Toolchains for JVM projects</a></li>
<li><a href="#toolchain_plugins">Toolchain Resolver Plugins</a></li>
</ul>
</li>
<li><a href="#jvm_plugins">JVM PLUGINS</a>
<ul class="sectlevel2">
<li><a href="#java_library_plugin">The Java Library Plugin</a></li>
<li><a href="#application_plugin">The Application Plugin</a></li>
<li><a href="#java_platform_plugin">The Java Platform Plugin</a></li>
<li><a href="#groovy_plugin">The Groovy Plugin</a></li>
<li><a href="#scala_plugin">The Scala Plugin</a></li>
</ul>
</li>
<li><a href="#part:integration">INTEGRATION</a>
<ul class="sectlevel2">
<li><a href="#third_party_integration">Gradle &amp; Third-party Tools</a></li>
<li><a href="#tooling_api">Tooling API</a></li>
<li><a href="#test_reporting_api">Test Event Reporting API</a></li>
</ul>
</li>
<li><a href="#license_information">LICENSE INFORMATION</a>
<ul class="sectlevel2">
<li><a href="#license">License Information</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:releases"><a class="anchor" href="#part:releases"></a><a class="link" href="#part:releases">RELEASES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installation"><a class="anchor" href="#installation"></a><a class="link" href="#installation">Installing Gradle</a></h3>
<div class="paragraph">
<p>If all you want to do is run an existing Gradle project, then you don&#8217;t need to install Gradle if the build uses the <a href="#gradle_wrapper">Gradle Wrapper</a>.</p>
</div>
<div class="sect3">
<h4 id="gs:installation"><a class="anchor" href="#gs:installation"></a><a class="link" href="#gs:installation">Gradle Installation</a></h4>
<div class="paragraph">
<p>The Gradle Wrapper is identifiable by the presence of the <code>gradlew</code> or <code>gradlew.bat</code> files in the root of the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.   // <b class="conum">(1)</b>
 gradle
    wrapper // <b class="conum">(2)</b>
 gradlew         // <b class="conum">(3)</b>
 gradlew.bat     // <b class="conum">(3)</b>
 </pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Project root directory.</p>
</li>
<li>
<p><a href="#gradle_wrapper">Gradle Wrapper</a>.</p>
</li>
<li>
<p>Scripts for executing Gradle builds.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the <code>gradlew</code> or <code>gradlew.bat</code> files are already present in your project, <strong>you do not need to install Gradle</strong>.
But you need to make sure your system <a href="#sec:prerequisites">satisfies Gradle&#8217;s prerequisites</a>.</p>
</div>
<div class="paragraph">
<p>You can follow the steps in the <a href="upgrading_version_9.html#upgrading_version_9">Upgrading Gradle section</a> if you want to update the Gradle version for your project.
Please use the <a href="#sec:upgrading_wrapper">Gradle Wrapper</a> to upgrade Gradle.</p>
</div>
<div class="paragraph">
<p>Android Studio comes with a working installation of Gradle, so you <strong>don&#8217;t need to install Gradle separately when only working within that IDE</strong>.</p>
</div>
<div class="paragraph">
<p>If you do not meet the criteria above and decide to install Gradle on your machine, first check if Gradle is already installed by running <code>gradle -v</code> in your terminal.
If the command does not return anything, then Gradle is not installed, and you can follow the instructions below.</p>
</div>
<div class="paragraph">
<p>You can install Gradle Build Tool on Linux, macOS, or Windows.
The installation can be done manually or using a package manager like <a href="https://sdkman.io/">SDKMAN!</a> or <a href="https://brew.sh/">Homebrew</a>.</p>
</div>
<div class="paragraph">
<p>You can find all Gradle releases and their checksums on the <a href="https://gradle.org/releases">releases page</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:prerequisites"><a class="anchor" href="#sec:prerequisites"></a><a class="link" href="#sec:prerequisites">Prerequisites</a></h4>
<div class="paragraph">
<p>Gradle runs on all major operating systems. It requires <a href="https://jdk.java.net/">Java Development Kit</a> (JDK) version 17 or higher to run. You can check the <a href="#compatibility">compatibility matrix</a> for more information.</p>
</div>
<div class="paragraph">
<p>To check, run <code>java -version</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> java -version
openjdk version "17.0.6" 2023-01-17
OpenJDK Runtime Environment Temurin-17.0.6+10 (build 17.0.6+10)
OpenJDK 64-Bit Server VM Temurin-17.0.6+10 (build 17.0.6+10, mixed mode)</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle uses the JDK it finds in your path, the JDK used by your IDE, or the <a href="#sec:configuring_daemon_jvm">JDK specified in your project</a>.</p>
</div>
<div class="paragraph">
<p>In this example, the $PATH points to JDK17:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> echo $PATH
/opt/homebrew/opt/openjdk@17/bin</pre>
</div>
</div>
<div class="paragraph">
<p>You can also set the <code>JAVA_HOME</code> environment variable to point to a specific JDK installation directory.
This is especially useful when multiple JDKs are installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> echo %JAVA_HOME%
C:\Program Files\Java\jdk17.0_6</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre> echo $JAVA_HOME
/Library/Java/JavaVirtualMachines/jdk-17.jdk/Contents/Home</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle supports <a href="https://kotlinlang.org/">Kotlin</a> and <a href="https://groovy-lang.org/">Groovy</a> as the main build languages.
Gradle ships with its own Kotlin and Groovy libraries, therefore they do not need to be installed.
Existing installations are ignored by Gradle.</p>
</div>
<div class="paragraph">
<p><a href="#compatibility">See the full compatibility notes for Java, Groovy, Kotlin, and Android.</a></p>
</div>
</div>
<div class="sect3">
<h4 id="linux_installation"><a class="anchor" href="#linux_installation"></a><a class="link" href="#linux_installation">Linux installation</a></h4>
<details id="ex-installing-with-a-package-manager">
<summary class="title"><a href="#ex-installing-with-a-package-manager">Installing with a package manager</a></summary>
<div class="content">
<div class="paragraph">
<p><a href="http://sdkman.io">SDKMAN!</a> is a tool for managing parallel versions of multiple Software Development Kits on most Unix-like systems (macOS, Linux, Cygwin, Solaris and FreeBSD).
Gradle is deployed and maintained by SDKMAN!:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> sdk install gradle</pre>
</div>
</div>
<div class="paragraph">
<p>Other package managers are available, but the version of Gradle distributed by them is not controlled by Gradle, Inc.
Linux package managers may distribute a modified version of Gradle that is incompatible or incomplete when compared to the official version.</p>
</div>
</div>
</details>
<details id="ex-installing-manually">
<summary class="title"><a href="#ex-installing-manually">Installing manually</a></summary>
<div class="content">
<div class="paragraph">
<p><strong>Step 1 - <a href="https://gradle.org/releases">Download</a> the latest Gradle distribution</strong></p>
</div>
<div class="paragraph">
<p>The distribution ZIP file comes in two flavors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Binary-only (bin)</p>
</li>
<li>
<p>Complete (all) with docs and sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend downloading the bin file; it is a smaller file that is quick to download (and the latest documentation is available online).</p>
</div>
<div class="paragraph">
<p><strong>Step 2 - Unpack the distribution</strong></p>
</div>
<div class="paragraph">
<p>Unzip the distribution zip file in the directory of your choosing, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> mkdir /opt/gradle
 unzip -d /opt/gradle gradle-9.1.0-bin.zip
 ls /opt/gradle/gradle-9.1.0
LICENSE  NOTICE  bin  README  init.d  lib  media</pre>
</div>
</div>
<div id="sec:linux_macos_users_2" class="paragraph">
<p><strong>Step 3 - Configure your system environment</strong></p>
</div>
<div class="paragraph">
<p>To install Gradle, the path to the unpacked files needs to be in your Path.
Configure your <code>PATH</code> environment variable to include the <code>bin</code> directory of the unzipped distribution, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> export PATH=$PATH:/opt/gradle/gradle-9.1.0/bin</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you could also add the environment variable <code>GRADLE_HOME</code> and point this to the unzipped distribution.
Instead of adding a specific version of Gradle to your <code>PATH</code>, you can add <code>$GRADLE_HOME/bin</code> to your <code>PATH</code>.
When upgrading to a different version of Gradle, simply change the <code>GRADLE_HOME</code> environment variable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>export GRADLE_HOME=/opt/gradle/gradle-9.1.0
export PATH=${GRADLE_HOME}/bin:${PATH}</pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="macos_installation"><a class="anchor" href="#macos_installation"></a><a class="link" href="#macos_installation">macOS installation</a></h4>
<details id="ex-installing-with-a-package-manager">
<summary class="title"><a href="#ex-installing-with-a-package-manager">Installing with a package manager</a></summary>
<div class="content">
<div class="paragraph">
<p><a href="http://sdkman.io">SDKMAN!</a> is a tool for managing parallel versions of multiple Software Development Kits on most Unix-like systems (macOS, Linux, Cygwin, Solaris and FreeBSD).
Gradle is deployed and maintained by SDKMAN!:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> sdk install gradle</pre>
</div>
</div>
<div class="paragraph">
<p>Using <a href="http://brew.sh">Homebrew</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> brew install gradle</pre>
</div>
</div>
<div class="paragraph">
<p>Using <a href="https://www.macports.org">MacPorts</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> sudo port install gradle</pre>
</div>
</div>
<div class="paragraph">
<p>Other package managers are available, but the version of Gradle distributed by them is not controlled by Gradle, Inc.</p>
</div>
</div>
</details>
<details id="ex-installing-manually">
<summary class="title"><a href="#ex-installing-manually">Installing manually</a></summary>
<div class="content">
<div class="paragraph">
<p><strong>Step 1 - <a href="https://gradle.org/releases">Download</a> the latest Gradle distribution</strong></p>
</div>
<div class="paragraph">
<p>The distribution ZIP file comes in two flavors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Binary-only (bin)</p>
</li>
<li>
<p>Complete (all) with docs and sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend downloading the bin file; it is a smaller file that is quick to download (and the latest documentation is available online).</p>
</div>
<div class="paragraph">
<p><strong>Step 2 - Unpack the distribution</strong></p>
</div>
<div class="paragraph">
<p>Unzip the distribution zip file in the directory of your choosing, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> mkdir /usr/local/gradle
 unzip gradle-9.1.0-bin.zip -d /usr/local/gradle
 ls /usr/local/gradle/gradle-9.1.0
LICENSE	NOTICE	README	bin	init.d	lib</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3 - Configure your system environment</strong></p>
</div>
<div class="paragraph">
<p>To install Gradle, the path to the unpacked files needs to be in your Path.
Configure your <code>PATH</code> environment variable to include the <code>bin</code> directory of the unzipped distribution, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> export PATH=$PATH:/usr/local/gradle/gradle-9.1.0/bin</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you could also add the environment variable <code>GRADLE_HOME</code> and point this to the unzipped distribution.
Instead of adding a specific version of Gradle to your <code>PATH</code>, you can add <code>$GRADLE_HOME/bin</code> to your <code>PATH</code>.
When upgrading to a different version of Gradle, simply change the <code>GRADLE_HOME</code> environment variable.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good idea to edit <code>.bash_profile</code> in your home directory to add <code>GRADLE_HOME</code> variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>export GRADLE_HOME=/usr/local/gradle/gradle-9.1.0
export PATH=$GRADLE_HOME/bin:$PATH</pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="windows_installation"><a class="anchor" href="#windows_installation"></a><a class="link" href="#windows_installation">Windows installation</a></h4>
<details id="ex-installing-manually">
<summary class="title"><a href="#ex-installing-manually">Installing manually</a></summary>
<div class="content">
<div class="paragraph">
<p><strong>Step 1 - <a href="https://gradle.org/releases">Download</a> the latest Gradle distribution</strong></p>
</div>
<div class="paragraph">
<p>The distribution ZIP file comes in two flavors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Binary-only (bin)</p>
</li>
<li>
<p>Complete (all) with docs and sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend downloading the bin file.</p>
</div>
<div class="paragraph">
<p><strong>Step 2 - Unpack the distribution</strong></p>
</div>
<div class="paragraph">
<p>Create a new directory <code>C:\Gradle</code> with <strong>File Explorer</strong>.</p>
</div>
<div class="paragraph">
<p>Open a second <strong>File Explorer</strong> window and go to the directory where the Gradle distribution was downloaded. Double-click the ZIP archive to expose the content.
Drag the content folder <code>gradle-9.1.0</code> to your newly created <code>C:\Gradle</code> folder.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can unpack the Gradle distribution ZIP into <code>C:\Gradle</code> using the archiver tool of your choice.</p>
</div>
<div class="paragraph">
<p><strong>Step 3 - Configure your system environment</strong></p>
</div>
<div class="paragraph">
<p>To install Gradle, the path to the unpacked files needs to be in your Path.</p>
</div>
<div class="paragraph">
<p>In <strong>File Explorer</strong> right-click on the <code>This PC</code> (or <code>Computer</code>) icon, then click <code>Properties</code> &#8594; <code>Advanced System Settings</code> &#8594; <code>Environmental Variables</code>.</p>
</div>
<div class="paragraph">
<p>Under <code>System Variables</code> select <code>Path</code>, then click <code>Edit</code>.
Add an entry for <code>C:\Gradle\gradle-9.1.0\bin</code>.
Click <code>OK</code> to save.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can add the environment variable <code>GRADLE_HOME</code> and point this to the unzipped distribution.
Instead of adding a specific version of Gradle to your <code>Path</code>, you can add <code><em>%GRADLE_HOME%</em>\bin</code> to your <code>Path</code>.
When upgrading to a different version of Gradle, just change the <code>GRADLE_HOME</code> environment variable.</p>
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="sec:running_and_testing_your_installation"><a class="anchor" href="#sec:running_and_testing_your_installation"></a><a class="link" href="#sec:running_and_testing_your_installation">Verify the installation</a></h4>
<div class="paragraph">
<p>Open a console (or a Windows command prompt) and run <code>gradle -v</code> to run gradle and display the version, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle -v

------------------------------------------------------------
Gradle 9.0.0
------------------------------------------------------------

Build time:    2025-07-17 12:48:00 UTC
Revision:      2db9560bb68c367a265b10516c856c840f9bed8d

Kotlin:        2.2.0
Groovy:        4.0.28
Ant:           Apache Ant(TM) version 1.10.15 compiled on August 25 2024
Launcher JVM:  17.0.11 (Amazon.com Inc. 17.0.11+9-LTS)
Daemon JVM:    Compatible with Java 17, any vendor, nativeImageCapable=false (from gradle/gradle-daemon-jvm.properties)
OS:            Mac OS X 14.7.4 aarch64</pre>
</div>
</div>
<div class="paragraph">
<p>You can verify the integrity of the Gradle distribution by downloading the SHA-256 file (available from the <a href="https://gradle.org/releases">releases page</a>) and following these <a href="#sec:verification">verification instructions</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="compatibility"><a class="anchor" href="#compatibility"></a><a class="link" href="#compatibility">Compatibility Matrix</a></h3>
<div class="paragraph">
<p>The sections below describe Gradle&#8217;s compatibility with several integrations.
Versions not listed here may or may not work.</p>
</div>
<div class="sect3">
<h4 id="java_runtime"><a class="anchor" href="#java_runtime"></a><a class="link" href="#java_runtime">Java Runtime</a></h4>
<div class="paragraph">
<p>Gradle runs on the Java Virtual Machine (JVM), which is often provided by either a JDK or JRE.
A JVM version between 17 and 25 is required to execute Gradle.
JVM 26 and later versions are not yet supported.</p>
</div>
<div class="paragraph">
<p>The Gradle wrapper, Gradle client, Tooling API client, and TestKit client are compatible with JVM 8.</p>
</div>
<div class="paragraph">
<p>JDK 6 and above can be used for <a href="#sec:java_cross_compilation">compilation</a>.
JVM 8 and above can be used for executing tests.</p>
</div>
<div class="paragraph">
<p>Any fully supported version of Java can be used for compilation or testing.
However, the latest Java version may only be supported for compilation or testing, not for running Gradle.
Support is achieved using <a href="#toolchains">toolchains</a> and applies to all tasks supporting toolchains.</p>
</div>
<div class="paragraph">
<p>See the table below for the Java version supported by a specific Gradle release:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Java Compatibility</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Java version</th>
<th class="tableblock halign-left valign-top">Support for toolchains</th>
<th class="tableblock halign-left valign-top">Support for running Gradle</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.3 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.7 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.0 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.3 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.7 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.0 to 8.14.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.6 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.3 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.5 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.8 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.10 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0 and after</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">26</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We only list versions in the table above once we have tested that they work without any warnings.
However, thanks to the toolchain support, Gradle will often work with the latest Java version before then.
We encourage users to try it out and let us know.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="kotlin"><a class="anchor" href="#kotlin"></a><a class="link" href="#kotlin">Kotlin</a></h4>
<div class="paragraph">
<p>Gradle is tested with Kotlin 2.0.0 through 2.2.20-Beta2.
Beta and RC versions may or may not work.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Embedded Kotlin version</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Embedded Kotlin version</th>
<th class="tableblock halign-left valign-top">Minimum Gradle version</th>
<th class="tableblock halign-left valign-top">Kotlin Language version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.41</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.70</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5.31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9.24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="groovy"><a class="anchor" href="#groovy"></a><a class="link" href="#groovy">Groovy</a></h4>
<div class="paragraph">
<p>Gradle is tested with Groovy 1.5.8 through 4.0.28.</p>
</div>
<div class="paragraph">
<p>Gradle plugins written in Groovy must use Groovy 4.x for compatibility with Gradle and Groovy DSL build scripts.</p>
</div>
</div>
<div class="sect3">
<h4 id="android"><a class="anchor" href="#android"></a><a class="link" href="#android">Android</a></h4>
<div class="paragraph">
<p>Gradle is tested with Android Gradle Plugin 8.4 through 8.12.
Alpha and beta versions may or may not work.</p>
</div>
</div>
<div class="sect3">
<h4 id="target_platforms"><a class="anchor" href="#target_platforms"></a><a class="link" href="#target_platforms">Target Platforms</a></h4>
<div class="paragraph">
<p>Gradle supports a defined set of platform targets, which are combinations of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operating system and version</p>
</li>
<li>
<p>Architecture</p>
</li>
<li>
<p>File system watching compatibility</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table lists the officially supported platforms for Gradle:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Supported Platforms</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">OS</th>
<th class="tableblock halign-left valign-top">Architecture</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ubuntu 22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">macOS 12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aarch64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ubuntu 16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aarch64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alpine 3.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CentOS 9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amd64</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Currently, all Gradle tests run with the default file-systems of the platform, i.e. <code>ext4</code> for Ubuntu, Amazon Linux and CentOS, <code>NTFS</code> for Windows, and <code>APFS</code> for macOS.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Platforms not listed above may work with Gradle but are not actively tested.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="feature_lifecycle"><a class="anchor" href="#feature_lifecycle"></a><a class="link" href="#feature_lifecycle">The Feature Lifecycle</a></h3>
<div class="paragraph">
<p>Gradle is under constant development. New versions are delivered on a regular and frequent basis (approximately every six weeks) as described in <a href="#eol_support">the section on end-of-life support</a>.</p>
</div>
<div class="paragraph">
<p>Continuous improvement combined with frequent delivery allows new features to be available to users early.
Early users provide invaluable feedback, which is incorporated into the development process.</p>
</div>
<div class="paragraph">
<p>Getting new functionality into the hands of users regularly is a core value of the Gradle platform.</p>
</div>
<div class="paragraph">
<p>At the same time, API and feature stability are taken very seriously and considered a core value of the Gradle platform.
Design choices and automated testing are engineered into the development process and formalized by <a href="#backwards_compatibility">the section on backward compatibility</a>.</p>
</div>
<div class="paragraph">
<p>The Gradle <em>feature lifecycle</em> has been designed to meet these goals. It also communicates to users of Gradle what the state of a feature is.
The term <em>feature</em> typically means an API or DSL method or property in this context, but it is not restricted to this definition.
Command line arguments and modes of execution (e.g. the Build Daemon) are two examples of other features.</p>
</div>
<div class="sect3">
<h4 id="sec:states"><a class="anchor" href="#sec:states"></a><a class="link" href="#sec:states">Feature States</a></h4>
<div class="paragraph">
<p>Features can be in one of four states:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#sec:internal">Internal</a></p>
</li>
<li>
<p><a href="#sec:incubating_state">Incubating</a></p>
</li>
<li>
<p><a href="#sec:public">Public</a></p>
</li>
<li>
<p><a href="#sec:deprecated">Deprecated</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:internal"><a class="anchor" href="#sec:internal"></a><a class="link" href="#sec:internal">1. Internal</a></h4>
<div class="paragraph">
<p><em>Internal</em> features are not designed for public use and are only intended to be used by Gradle itself. They can change in any way at any point in time without any notice.
Therefore, we recommend avoiding the use of such features.
<em>Internal</em> features are not documented.
If it appears in this User Manual, the DSL Reference, or the API Reference, then the feature is not <em>internal</em>.</p>
</div>
<div class="paragraph">
<p><em>Internal</em> features may evolve into public features.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:incubating_state"><a class="anchor" href="#sec:incubating_state"></a><a class="link" href="#sec:incubating_state">2. Incubating</a></h4>
<div class="paragraph">
<p>Features are introduced in the <em>incubating</em> state to allow real-world feedback to be incorporated into the feature before making it public.
It also gives users willing to test potential future changes early access.</p>
</div>
<div class="paragraph">
<p>A feature in an <em>incubating</em> state may change in future Gradle versions until it is no longer <em>incubating</em>.
Changes to <em>incubating</em> features for a Gradle release will be highlighted in the release notes for that release.
The <em>incubation</em> period for new features varies depending on the feature&#8217;s scope, complexity, and nature.</p>
</div>
<div class="paragraph">
<p>Features in <em>incubation</em> are indicated.
In the source code, all methods/properties/classes that are <em>incubating</em> are annotated with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Incubating.html">incubating</a>.
This results in a special mark for them in the DSL and API references.</p>
</div>
<div class="paragraph">
<p>If an <em>incubating</em> feature is discussed in this User Manual, it will be explicitly said to be in the <em>incubating</em> state.</p>
</div>
<div class="sect4">
<h5 id="feature_preview"><a class="anchor" href="#feature_preview"></a><a class="link" href="#feature_preview">Feature Preview API</a></h5>
<div class="paragraph">
<p>The feature preview API allows certain <em>incubating</em> features to be activated by adding <code>enableFeaturePreview('FEATURE')</code> in your <em>settings</em> file.
Individual preview features will be announced in release notes.</p>
</div>
<div class="paragraph">
<p>When <em>incubating</em> features are either promoted to <em>public</em> or removed, the feature preview flags for them become obsolete, have no effect, and should be removed from the settings file.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:public"><a class="anchor" href="#sec:public"></a><a class="link" href="#sec:public">3. Public</a></h4>
<div class="paragraph">
<p>The default state for a non-internal feature is <em>public</em>. Anything documented in the User Manual, DSL Reference, or API reference that is not explicitly said to be <em>incubating</em> or <em>deprecated</em> is considered <em>public</em>.
Features are said to be <strong>promoted</strong> from an <em>incubating</em> state to <em>public</em>.
The release notes for each release indicate which previously <em>incubating</em> features are being promoted by the release.</p>
</div>
<div class="paragraph">
<p>A <em>public</em> feature will <strong>never</strong> be removed or intentionally changed without undergoing <em>deprecation</em>.
All public features are subject to the backward compatibility policy.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:deprecated"><a class="anchor" href="#sec:deprecated"></a><a class="link" href="#sec:deprecated">4. Deprecated</a></h4>
<div class="paragraph">
<p>Some features may be replaced or become irrelevant due to the natural evolution of Gradle.
Such features will eventually be removed from Gradle after being <em>deprecated</em>.
A <em>deprecated</em> feature may become stale until it is finally removed according to the backward compatibility policy.</p>
</div>
<div class="paragraph">
<p><em>Deprecated</em> features are indicated to be so.
In the source code, all methods/properties/classes that are <em>deprecated</em> are annotated with &#8220;@java.lang.Deprecated&#8221; which is reflected in the DSL and API References.
In most cases, there is a replacement for the deprecated element, which will be described in the documentation.
Using a <em>deprecated</em> feature will result in a runtime warning in Gradle&#8217;s output.</p>
</div>
<div class="paragraph">
<p>The use of <em>deprecated</em> features should be avoided.
The release notes for each release indicate any features being <em>deprecated</em> by the release.</p>
</div>
</div>
<div class="sect3">
<h4 id="backwards_compatibility"><a class="anchor" href="#backwards_compatibility"></a><a class="link" href="#backwards_compatibility">Backward compatibility Policy</a></h4>
<div class="paragraph">
<p>Gradle provides backward compatibility across major versions (e.g., <code>1.x</code>, <code>2.x</code>, etc.).
Once a public feature is introduced in a Gradle release, it will remain indefinitely unless deprecated.
Once deprecated, it may be removed in the next major release.
Deprecated features may be supported across major releases, but this is not guaranteed.</p>
</div>
</div>
<div class="sect3">
<h4 id="eol_support"><a class="anchor" href="#eol_support"></a><a class="link" href="#eol_support">Release end-of-life Policy</a></h4>
<div class="paragraph">
<p>Every day, a new nightly build of Gradle is created.</p>
</div>
<div class="paragraph">
<p>This contains all of the changes made through Gradle&#8217;s extensive continuous integration tests during that day.
Nightly builds may contain new changes that may or may not be stable.</p>
</div>
<div class="paragraph">
<p>The Gradle team creates a pre-release distribution called a release candidate (RC) for each minor or major release.
When no problems are found after a short time (usually a week), the release candidate is promoted to a general availability (GA) release.
If a regression is found in the release candidate, a new RC distribution is created, and the process repeats.
Release candidates are supported for as long as the release window is open, but they are not intended to be used for production.
Bug reports are greatly appreciated during the RC phase.</p>
</div>
<div class="paragraph">
<p>The Gradle team may create additional patch releases to replace the final release due to critical bug fixes or regressions.
For instance, Gradle 5.2.1 replaces the Gradle 5.2 release.</p>
</div>
<div class="paragraph">
<p>Once a release candidate has been made, all feature development moves on to the next release for the latest major version.
As such, each minor Gradle release causes the previous minor releases in the same major version to become end-of-life (EOL). EOL releases do not receive bug fixes or feature backports.</p>
</div>
<div class="paragraph">
<p>For major versions, Gradle will backport critical fixes and security fixes to the last minor in the previous major version.
For example, when Gradle 7 was the latest major version, several releases were made in the 6.x line, including Gradle 6.9 (and subsequent releases).</p>
</div>
<div class="paragraph">
<p>As such, each major Gradle release causes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The previous major version becomes maintenance only. It will only receive critical bug fixes and security fixes.</p>
</li>
<li>
<p>The major version before the previous one to become end-of-life (EOL), and that release line will not receive any new fixes.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:reference"><a class="anchor" href="#part:reference"></a><a class="link" href="#part:reference">RUNTIME AND CONFIGURATION</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="command_line_interface"><a class="anchor" href="#command_line_interface"></a><a class="link" href="#command_line_interface">Command-Line Interface</a></h3>
<div class="paragraph">
<p>The command-line interface is the <strong>primary method of interacting with Gradle</strong>.</p>
</div>
<div class="paragraph">
<p>The following is a reference for executing and customizing the Gradle command-line.
It also serves as a reference when writing scripts or configuring continuous integration.</p>
</div>
<div class="paragraph">
<p><strong>Use of the <a href="#gradle_wrapper">Gradle Wrapper</a> is highly encouraged</strong>.
Substitute <code>./gradlew</code> (in macOS / Linux) or <code>gradlew.bat</code> (in Windows) for <code>gradle</code> in the following examples.</p>
</div>
<div class="paragraph">
<p>Executing Gradle on the command-line conforms to the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle [taskName...] [--option-name...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Options are allowed <em>before</em> and <em>after</em> task names.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle [--option-name...] [taskName...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If multiple tasks are specified, you should separate them with a space.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle [taskName1 taskName2...] [--option-name...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Options that accept values can be specified with or without <code>=</code> between the option and argument. The use of <code>=</code> is recommended.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle [...] --console=plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Options that enable behavior have long-form options with inverses specified with <code>--no-</code>. The following are opposites.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle [...] --build-cache
gradle [...] --no-build-cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>Many long-form options have short-option equivalents. The following are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gradle --help
gradle -h</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Many command-line flags can be specified in <code>gradle.properties</code> to avoid needing to be typed.
See the <a href="#sec:gradle_configuration_properties">Configuring build environment guide</a> for details.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="command_line_usage"><a class="anchor" href="#command_line_usage"></a><a class="link" href="#command_line_usage">Command-line usage</a></h4>
<div class="paragraph">
<p>The following sections describe the use of the Gradle command-line interface.</p>
</div>
<div class="paragraph">
<p>Some plugins also add their own command line options.
For example, <code>--tests</code>, which is added by <a href="#test_filtering">Java test filtering</a>.
For more information on exposing command line options for your own tasks, see <a href="#sec:declaring_and_using_command_line_options">Declaring command-line options</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:command_line_executing_tasks"><a class="anchor" href="#sec:command_line_executing_tasks"></a><a class="link" href="#sec:command_line_executing_tasks">Executing tasks</a></h5>
<div class="paragraph">
<p>You can learn about what projects and tasks are available in the <a href="#sec:command_line_project_reporting">project reporting section</a>.</p>
</div>
<div class="paragraph">
<p>Most builds support a common set of tasks known as <a href="#sec:lifecycle_tasks"><em>lifecycle tasks</em></a>. These include the <code>build</code>, <code>assemble</code>, and <code>check</code> tasks.</p>
</div>
<div class="paragraph">
<p>To execute a task called <code>myTask</code> on the root project, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle :myTask</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will run the single <code>myTask</code> and all of its <a href="writing_tasks_intermediate.html#sec:task_dependencies">dependencies</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:disambiguate_task_options_from_built_in_options"><a class="anchor" href="#sec:disambiguate_task_options_from_built_in_options"></a><a class="link" href="#sec:disambiguate_task_options_from_built_in_options">Specify options for tasks</a></h5>
<div class="paragraph">
<p>To pass an option to a task, prefix the option name with <code>--</code> after the task name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle :exampleTask --exampleOption=exampleValue</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="disambiguate_task_options_from_built_in_options"><a class="anchor" href="#disambiguate_task_options_from_built_in_options"></a><a class="link" href="#disambiguate_task_options_from_built_in_options">Disambiguate task options from built-in options</a></h6>
<div class="paragraph">
<p>Gradle does not prevent tasks from registering options that conflict with Gradle&#8217;s built-in options, like <code>--profile</code> or <code>--help</code>.</p>
</div>
<div class="paragraph">
<p>You can fix conflicting task options from Gradle&#8217;s built-in options with a <code>--</code> delimiter before the task name in the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle [--built-in-option-name...] -- [taskName...] [--task-option-name...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider a task named <code>mytask</code> that accepts an option named <code>profile</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <code>gradle mytask --profile</code>, Gradle accepts <code>--profile</code> as the built-in Gradle option.</p>
</li>
<li>
<p>In <code>gradle -- mytask --profile=value</code>, Gradle passes <code>--profile</code> as a task option.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="executing_tasks_in_multi_project_builds"><a class="anchor" href="#executing_tasks_in_multi_project_builds"></a><a class="link" href="#executing_tasks_in_multi_project_builds">Executing tasks in multi-project builds</a></h5>
<div class="paragraph">
<p>In a <a href="multi_project_builds_intermediate.html#intro_multi_project_builds">multi-project build</a>, subproject tasks can be executed with <code>:</code> separating the subproject name and task name.
The following are equivalent when <em>run from the root project</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle :subproject:taskName</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradle subproject:taskName</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also run a task for <em>all</em> subprojects using a task <em>selector</em> that consists of only the task name.</p>
</div>
<div class="paragraph">
<p>The following command runs the <code>test</code> task for all subprojects when invoked from the <em>root project directory</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle test</code></pre>
</div>
</div>
<div class="paragraph">
<p>To recap:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">// Run a task in the root project only
$ gradle :exampleTask --exampleOption=exampleValue

// Run a task that may exist in the root or any subproject (ambiguous if defined in more than one)
$ gradle exampleTask --exampleOption=exampleValue

// Run a task in a specific subproject
$ gradle subproject:exampleTask --exampleOption=exampleValue
$ gradle :subproject:exampleTask --exampleOption=exampleValue</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some tasks selectors, like <code>help</code> or <code>dependencies</code>, will only run the task on the project they are invoked on and not on all the subprojects.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When invoking Gradle from within a subproject, the project name should be omitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd subproject</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle taskName</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When executing the Gradle Wrapper from a subproject directory, reference <code>gradlew</code> relatively. For example: <code>../gradlew taskName</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="executing_multiple_tasks"><a class="anchor" href="#executing_multiple_tasks"></a><a class="link" href="#executing_multiple_tasks">Executing multiple tasks</a></h5>
<div class="paragraph">
<p>You can also specify multiple tasks.
The tasks' dependencies determine the precise order of execution, and a task having no dependencies may execute earlier than it is listed on the command-line.</p>
</div>
<div class="paragraph">
<p>For example, the following will execute the <code>test</code> and <code>deploy</code> tasks in the order that they are listed on the command-line and will also execute the dependencies for each task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle test deploy</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="command_line_order_safety"><a class="anchor" href="#command_line_order_safety"></a><a class="link" href="#command_line_order_safety">Command line order safety</a></h5>
<div class="paragraph">
<p>Although Gradle will always attempt to execute the build quickly, command line ordering safety will also be honored.</p>
</div>
<div class="paragraph">
<p>For example, the following will
execute <code>clean</code> and <code>build</code> along with their dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle clean build</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the intention implied in the command line order is that <code>clean</code> should run first and then <code>build</code>. It would be incorrect to execute <code>clean</code> <em>after</em> <code>build</code>, even if doing so would cause the build to execute faster since <code>clean</code> would remove what <code>build</code> created.</p>
</div>
<div class="paragraph">
<p>Conversely, if the command line order was <code>build</code> followed by <code>clean</code>, it would not be correct to execute <code>clean</code> before <code>build</code>. Although Gradle will execute the build as quickly as possible, it will also respect the safety of the order of tasks specified on the command line and ensure that <code>clean</code> runs before <code>build</code> when specified in that order.</p>
</div>
<div class="paragraph">
<p>Note that <a href="incremental_build.html#incremental_build">command line order safety</a> relies on tasks properly declaring what they create, consume, or remove.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:excluding_tasks_from_the_command_line"><a class="anchor" href="#sec:excluding_tasks_from_the_command_line"></a><a class="link" href="#sec:excluding_tasks_from_the_command_line">Excluding tasks from execution</a></h5>
<div class="paragraph">
<p>You can exclude a task from being executed using the <code>-x</code> or <code>--exclude-task</code> command-line option and providing the name of the task to exclude:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle dist --exclude-task test</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :compile
compiling source

&gt; Task :dist
building the distribution

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/commandLineTutorialTasks.png" alt="commandLineTutorialTasks">
</div>
</div>
<div class="paragraph">
<p>You can see that the <code>test</code> task is not executed, even though the <code>dist</code> task depends on it.
The <code>test</code> tasks dependencies, such as <code>compileTest</code>, are not executed either.
The dependencies of <code>test</code> that other tasks depend on, such as <code>compile</code>, are still executed.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:rerun_tasks"><a class="anchor" href="#sec:rerun_tasks"></a><a class="link" href="#sec:rerun_tasks">Forcing tasks to execute</a></h5>
<div class="paragraph">
<p>You can force Gradle to execute all tasks ignoring <a href="incremental_build.html#incremental_build">up-to-date checks</a> using the <code>--rerun-tasks</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle test --rerun-tasks</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will force <code>test</code> and <em>all</em> task dependencies of <code>test</code> to execute. It is similar to running <code>gradle clean test</code>, but without the build&#8217;s generated output being deleted.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can tell Gradle to rerun a specific task using the <code>--rerun</code> built-in <a href="#sec:task_options">task option</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:continue_build_on_failure"><a class="anchor" href="#sec:continue_build_on_failure"></a><a class="link" href="#sec:continue_build_on_failure">Continue the build after a task failure</a></h5>
<div class="paragraph">
<p>By default, Gradle aborts execution and fails the build when any task fails.
This allows the build to complete sooner and prevents cascading failures from obfuscating the root cause of an error.</p>
</div>
<div class="paragraph">
<p>You can use the <code>--continue</code> option to force Gradle to execute every task when a failure occurs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle test --continue</code></pre>
</div>
</div>
<div class="paragraph">
<p>When executed with <code>--continue</code>, Gradle executes <em>every</em> task in the build if all the dependencies for that task are completed without failure.</p>
</div>
<div class="paragraph">
<p>For example, tests do not run if there is a compilation error in the code under test because the <code>test</code> task depends on the <code>compilation</code> task.
Gradle outputs each of the encountered failures at the end of the build.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If any tests fail, many test suites fail the entire <code>test</code> task.
Code coverage and reporting tools frequently run after the test task, so "fail fast" behavior may halt execution before those tools run.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:name_abbreviation"><a class="anchor" href="#sec:name_abbreviation"></a><a class="link" href="#sec:name_abbreviation">Name abbreviation</a></h5>
<div class="paragraph">
<p>When you specify tasks on the command-line, you don&#8217;t have to provide the full name of the task.
You can provide enough of the task name to identify the task uniquely.
For example, it is likely <code>gradle che</code> is enough for Gradle to identify the <code>check</code> task.</p>
</div>
<div class="paragraph">
<p>The same applies to project names. You can execute the <code>check</code> task in the <code>library</code> subproject with the <code>gradle lib:che</code> command.</p>
</div>
<div class="paragraph">
<p>You can use <a href="https://en.wikipedia.org/wiki/Camel_case">camel case</a> patterns for more complex abbreviations. These patterns are expanded to match camel case and <a href="https://en.wikipedia.org/wiki/Kebab_case">kebab case</a> names.
For example, the pattern <code>foBa</code> (or <code>fB</code>) matches <code>fooBar</code> and <code>foo-bar</code>.</p>
</div>
<div class="paragraph">
<p>More concretely, you can run the <code>compileTest</code> task in the <code>my-awesome-library</code> subproject with the command <code>gradle mAL:cT</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle mAL:cT</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :my-awesome-library:compileTest
compiling unit tests

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Abbreviations can also be used with the <code>-x</code> command-line option.</p>
</div>
</div>
<div class="sect4">
<h5 id="tracing_name_expansion"><a class="anchor" href="#tracing_name_expansion"></a><a class="link" href="#tracing_name_expansion">Tracing name expansion</a></h5>
<div class="paragraph">
<p>For complex projects, it might be ambiguous if the intended tasks were executed. When using abbreviated names, a single typo can lead to the execution of unexpected tasks.</p>
</div>
<div class="paragraph">
<p>When <code>INFO</code>, or more <a href="#logLevels">verbose logging</a> is enabled, the output will contain extra information about the project and task name expansion.</p>
</div>
<div class="paragraph">
<p>For example, when executing the <code>mAL:cT</code> command on the previous example, the following log messages will be visible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>No exact project with name ':mAL' has been found. Checking for abbreviated names.
Found exactly one project that matches the abbreviated name ':mAL': ':my-awesome-library'.
No exact task with name ':cT' has been found. Checking for abbreviated names.
Found exactly one task name, that matches the abbreviated name ':cT': ':compileTest'.</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="common_tasks"><a class="anchor" href="#common_tasks"></a><a class="link" href="#common_tasks">Common tasks</a></h4>
<div class="paragraph">
<p>The following are task conventions applied by built-in and most major Gradle plugins.</p>
</div>
<div class="sect4">
<h5 id="computing_all_outputs"><a class="anchor" href="#computing_all_outputs"></a><a class="link" href="#computing_all_outputs">Computing all outputs</a></h5>
<div class="paragraph">
<p>It is common in Gradle builds for the <code>build</code> task to designate assembling all outputs and running all checks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle build</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running_applications"><a class="anchor" href="#running_applications"></a><a class="link" href="#running_applications">Running applications</a></h5>
<div class="paragraph">
<p>It is common for applications to run with the <code>run</code> task, which assembles the application and executes some script or binary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle run</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running_all_checks"><a class="anchor" href="#running_all_checks"></a><a class="link" href="#running_all_checks">Running all checks</a></h5>
<div class="paragraph">
<p>It is common for <em>all</em> verification tasks, including tests and linting, to be executed using the <code>check</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle check</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="cleaning_outputs"><a class="anchor" href="#cleaning_outputs"></a><a class="link" href="#cleaning_outputs">Cleaning outputs</a></h5>
<div class="paragraph">
<p>You can delete the contents of the build directory using the <code>clean</code> task. Doing so will cause pre-computed outputs to be lost, causing significant additional build time for the subsequent task execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle clean</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_project_reporting"><a class="anchor" href="#sec:command_line_project_reporting"></a><a class="link" href="#sec:command_line_project_reporting">Project reporting</a></h4>
<div class="paragraph">
<p>Gradle provides several built-in tasks which show particular details of your build.
This can be useful for understanding your build&#8217;s structure and dependencies, as well as debugging problems.</p>
</div>
<div class="sect4">
<h5 id="listing_projects"><a class="anchor" href="#listing_projects"></a><a class="link" href="#listing_projects">Listing projects</a></h5>
<div class="paragraph">
<p>Running the <code>projects</code> task gives you a list of the subprojects of the selected project, displayed in a hierarchy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle projects</code></pre>
</div>
</div>
<div class="paragraph">
<p>You also get a project report with <a href="https://scans.gradle.com/">Build Scan</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_tasks"><a class="anchor" href="#sec:listing_tasks"></a><a class="link" href="#sec:listing_tasks">Listing tasks</a></h5>
<div class="paragraph">
<p>Running <code>gradle tasks</code> gives you a list of the main tasks of the selected project. This report shows the default tasks for the project, if any, and a description for each task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle tasks</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, this report shows only those tasks assigned to a task group.</p>
</div>
<div class="paragraph">
<p>Groups (such as verification, publishing, help, build&#8230;&#8203;) are available as the header of each section when listing tasks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">&gt; Task :tasks

Build tasks
-----------
assemble - Assembles the outputs of this project.

Build Setup tasks
-----------------
init - Initializes a new Gradle build.

Distribution tasks
------------------
assembleDist - Assembles the main distributions

Documentation tasks
-------------------
javadoc - Generates Javadoc API documentation for the main source code.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can obtain more information in the task listing using the <code>--all</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle tasks --all</code></pre>
</div>
</div>
<div class="paragraph">
<p>The option <code>--no-all</code> can limit the report to tasks assigned to a task group.</p>
</div>
<div class="paragraph">
<p>If you need to be more precise, you can display only the tasks from a specific group using the <code>--group</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle tasks --group="build setup"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:show_task_details"><a class="anchor" href="#sec:show_task_details"></a><a class="link" href="#sec:show_task_details">Show task usage details</a></h5>
<div class="paragraph">
<p>Running <code>gradle help --task someTask</code> gives you detailed information about a specific task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle -q help --task libs</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Detailed task information for libs

Paths
     :api:libs
     :webapp:libs

Type
     Task (org.gradle.api.Task)

Options
     --rerun     Causes the task to be re-run even if up-to-date.

Description
     Builds the JAR

Group
     build</pre>
</div>
</div>
<div class="paragraph">
<p>This information includes the full task path, the task type, possible <a href="#sec:task_options">task-specific command line options</a>, and the description of the given task.</p>
</div>
<div class="paragraph">
<p>You can get detailed information about the task class types using the <code>--types</code> option or using <code>--no-types</code> to hide this information.</p>
</div>
</div>
<div class="sect4">
<h5 id="reporting_dependencies"><a class="anchor" href="#reporting_dependencies"></a><a class="link" href="#reporting_dependencies">Reporting dependencies</a></h5>
<div class="paragraph">
<p><a href="https://scans.gradle.com/">Build Scan</a> gives a full, visual report of what dependencies exist on which configurations, transitive dependencies, and dependency version selection.
They can be invoked using the <code>--scan</code> options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle myTask --scan</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will give you a link to a web-based report, where you can find <a href="#sec:debugging-build-scans">dependency information</a> like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-dependencies.png" alt="Build Scan dependencies report">
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_project_dependencies"><a class="anchor" href="#sec:listing_project_dependencies"></a><a class="link" href="#sec:listing_project_dependencies">Listing project dependencies</a></h5>
<div class="paragraph">
<p>Running the <code>dependencies</code> task gives you a list of the dependencies of the selected project, broken down by configuration. For each configuration, the direct and transitive dependencies of that configuration are shown in a tree.</p>
</div>
<div class="paragraph">
<p>Below is an example of this report:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle dependencies</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">&gt; Task :app:dependencies

------------------------------------------------------------
Project ':app'
------------------------------------------------------------

compileClasspath - Compile classpath for source set 'main'.
+--- project :model
|    \--- org.json:json:20220924
+--- com.google.inject:guice:5.1.0
|    +--- javax.inject:javax.inject:1
|    +--- aopalliance:aopalliance:1.0
|    \--- com.google.guava:guava:30.1-jre -&gt; 28.2-jre
|         +--- com.google.guava:failureaccess:1.0.1
|         +--- com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava
|         +--- com.google.code.findbugs:jsr305:3.0.2
|         +--- org.checkerframework:checker-qual:2.10.0 -&gt; 3.28.0
|         +--- com.google.errorprone:error_prone_annotations:2.3.4
|         \--- com.google.j2objc:j2objc-annotations:1.3
+--- com.google.inject:guice:{strictly 5.1.0} -&gt; 5.1.0 (c)
+--- org.json:json:{strictly 20220924} -&gt; 20220924 (c)
+--- javax.inject:javax.inject:{strictly 1} -&gt; 1 (c)
+--- aopalliance:aopalliance:{strictly 1.0} -&gt; 1.0 (c)
+--- com.google.guava:guava:{strictly [28.0-jre, 28.5-jre]} -&gt; 28.2-jre (c)
+--- com.google.guava:guava:{strictly 28.2-jre} -&gt; 28.2-jre (c)
+--- com.google.guava:failureaccess:{strictly 1.0.1} -&gt; 1.0.1 (c)
+--- com.google.guava:listenablefuture:{strictly 9999.0-empty-to-avoid-conflict-with-guava} -&gt; 9999.0-empty-to-avoid-conflict-with-guava (c)
+--- com.google.code.findbugs:jsr305:{strictly 3.0.2} -&gt; 3.0.2 (c)
+--- org.checkerframework:checker-qual:{strictly 3.28.0} -&gt; 3.28.0 (c)
+--- com.google.errorprone:error_prone_annotations:{strictly 2.3.4} -&gt; 2.3.4 (c)
\--- com.google.j2objc:j2objc-annotations:{strictly 1.3} -&gt; 1.3 (c)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Concrete examples of build scripts and output available in <a href="#sec:debugging-build-scans">Viewing and debugging dependencies</a>.</p>
</div>
<div class="paragraph">
<p>Running the <code>buildEnvironment</code> task visualises the buildscript dependencies of the selected project, similarly to how <code>gradle dependencies</code> visualizes the dependencies of the software being built:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle buildEnvironment</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the <code>dependencyInsight</code> task gives you an insight into a particular dependency (or dependencies) that match specified input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle dependencyInsight --dependency [...] --configuration [...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--configuration</code> parameter restricts the report to a particular configuration such as <code>compileClasspath</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_properties"><a class="anchor" href="#sec:listing_properties"></a><a class="link" href="#sec:listing_properties">Listing project properties</a></h5>
<div class="paragraph">
<p>Running the <code>properties</code> task gives you a list of the properties of the selected project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle -q api:properties</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>------------------------------------------------------------
Project ':api'
------------------------------------------------------------

allprojects: [project ':api']
ant: org.gradle.api.internal.project.DefaultAntBuilder@12345
antBuilderFactory: org.gradle.api.internal.project.DefaultAntBuilderFactory@12345
artifacts: org.gradle.api.internal.artifacts.dsl.DefaultArtifactHandler_Decorated@12345
asDynamicObject: DynamicObject for project ':api'
baseClassLoaderScope: org.gradle.api.internal.initialization.DefaultClassLoaderScope@12345</pre>
</div>
</div>
<div class="paragraph">
<p>You can also query a single property with the optional <code>--property</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle -q api:properties --property allprojects</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>------------------------------------------------------------
Project ':api'
------------------------------------------------------------

allprojects: [project ':api']</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_completion"><a class="anchor" href="#sec:command_line_completion"></a><a class="link" href="#sec:command_line_completion">Command-line completion</a></h4>
<div class="paragraph">
<p>Gradle provides <code>bash</code> and <code>zsh</code> tab completion support for tasks, options, and Gradle properties through <a href="https://github.com/gradle/gradle-completion">gradle-completion</a> (installed separately):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-completion-4.0.gif" alt="gradle completion 4.0">
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_debugging"><a class="anchor" href="#sec:command_line_debugging"></a><a class="link" href="#sec:command_line_debugging">Debugging options</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-?</code>, <code>-h</code>, <code>--help</code></dt>
<dd>
<p>Shows a help message with the built-in CLI options.
To show project-contextual options, including help on a specific task, see the <code>help</code> task.</p>
</dd>
<dt class="hdlist1"><code>-v</code>, <code>--version</code></dt>
<dd>
<p>Prints Gradle, Groovy, Ant, Launcher &amp; Daemon JVM, and operating system version information and exit without executing any tasks.</p>
</dd>
<dt class="hdlist1"><code>-V</code>, <code>--show-version</code></dt>
<dd>
<p>Prints Gradle, Groovy, Ant, Launcher &amp; Daemon JVM, and operating system version information and continue execution of specified tasks.</p>
</dd>
<dt class="hdlist1"><code>-S</code>, <code>--full-stacktrace</code></dt>
<dd>
<p>Print out the full (very verbose) stacktrace for any exceptions. See also <a href="#sec:command_line_logging">logging options</a>.</p>
</dd>
<dt class="hdlist1"><code>-s</code>, <code>--stacktrace</code></dt>
<dd>
<p>Print out the stacktrace also for user exceptions (e.g. compile error). See also <a href="#sec:command_line_logging">logging options</a>.</p>
</dd>
<dt class="hdlist1"><code>--scan</code></dt>
<dd>
<p>Create a <a href="https://gradle.com/develocity/product/build-scan">Build Scan</a> with fine-grained information about all aspects of your Gradle build.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug=true</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that debugs the <a href="#gradle_daemon">Gradle Daemon</a> process. Gradle will wait for you to attach a debugger at <code>localhost:5005</code> by default.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug.host=(host address)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that specifies the host address to listen on or connect to when debug is enabled.
In the server mode on Java 9 and above, passing <code>*</code> for the host will make the server listen on all network interfaces.
By default, no host address is passed to JDWP, so on Java 9 and above, the loopback address is used, while earlier versions listen on all interfaces.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug.port=(port number)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that specifies the port number to listen on when debug is enabled. <em>Default is <code>5005</code>.</em></p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug.server=(true,false)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that if set to <code>true</code> and debugging is enabled, will cause Gradle to run the build with the socket-attach mode of the debugger. Otherwise, the socket-listen mode is used. <em>Default is <code>true</code>.</em></p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug.suspend=(true,false)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that if set to <code>true</code> and debugging is enabled, the JVM running Gradle will suspend until a debugger is attached. <em>Default is <code>true</code>.</em></p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_performance"><a class="anchor" href="#sec:command_line_performance"></a><a class="link" href="#sec:command_line_performance">Performance options</a></h4>
<div class="paragraph">
<p>Try these options when optimizing and <a href="#performance_gradle">improving</a> build performance.</p>
</div>
<div class="paragraph">
<p>Many of these options can be <a href="#sec:gradle_configuration_properties">specified</a> in the <code>gradle.properties</code> file, so command-line flags are unnecessary.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--build-cache</code>, <code>--no-build-cache</code></dt>
<dd>
<p>Toggles the <a href="#build_cache">Gradle Build Cache</a>. Gradle will try to reuse outputs from previous builds. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--configuration-cache</code>, <code>--no-configuration-cache</code></dt>
<dd>
<p>Toggles the <a href="#config_cache">Configuration Cache</a>. Gradle will try to reuse the build configuration from previous builds. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--configuration-cache-problems=(fail,warn)</code></dt>
<dd>
<p>Configures how the configuration cache handles problems. Default is <code>fail</code>.</p>
<div class="paragraph">
<p>Set to <code>warn</code> to report problems without failing the build.</p>
</div>
<div class="paragraph">
<p>Set to <code>fail</code> to report problems and fail the build if there are any problems.</p>
</div>
</dd>
<dt class="hdlist1"><code>--configure-on-demand</code>, <code>--no-configure-on-demand</code> <span class="incubating-label">Incubating</span></dt>
<dd>
<p>Toggles configure-on-demand. Only relevant projects are configured in this build run. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--max-workers</code></dt>
<dd>
<p>Sets the maximum number of workers that Gradle may use. <em>Default is number of processors</em>.</p>
</dd>
<dt class="hdlist1"><code>--parallel</code>, <code>--no-parallel</code></dt>
<dd>
<p>Build projects in parallel. For limitations of this option, see <a href="#sec:enable_parallel_execution">Parallel Project Execution</a>. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--priority</code></dt>
<dd>
<p>Specifies the scheduling priority for the Gradle daemon and all processes launched by it. Values are <code>normal</code> or <code>low</code>. <em>Default is normal</em>.</p>
</dd>
<dt class="hdlist1"><code>--profile</code></dt>
<dd>
<p>Generates a high-level performance report in the <code>layout.buildDirectory.dir("reports/profile")</code> directory. <code>--scan</code> is preferred.</p>
</dd>
<dt class="hdlist1"><code>--scan</code></dt>
<dd>
<p>Generate a Build Scan with detailed performance diagnostics.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-performance.png" alt="Build Scan performance report">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--watch-fs</code>, <code>--no-watch-fs</code></dt>
<dd>
<p>Toggles <a href="#sec:daemon_watch_fs">watching the file system</a>.
When enabled, Gradle reuses information it collects about the file system between builds.
<em>Enabled by default on operating systems where Gradle supports this feature.</em></p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="gradle_daemon_options"><a class="anchor" href="#gradle_daemon_options"></a><a class="link" href="#gradle_daemon_options">Gradle daemon options</a></h5>
<div class="paragraph">
<p>You can manage the <a href="#gradle_daemon">Gradle Daemon</a> through the following command line options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--daemon</code>, <code>--no-daemon</code></dt>
<dd>
<p>Use the <a href="#gradle_daemon">Gradle Daemon</a> to run the build. Starts the daemon if not running or the existing daemon is busy. <em>Default is on</em>.</p>
</dd>
<dt class="hdlist1"><code>--foreground</code></dt>
<dd>
<p>Starts the Gradle Daemon in a foreground process.</p>
</dd>
<dt class="hdlist1"><code>--status</code> (Standalone command)</dt>
<dd>
<p>Run <code>gradle --status</code> to list running and recently stopped Gradle daemons. It only displays daemons of the same Gradle version.</p>
</dd>
<dt class="hdlist1"><code>--stop</code> (Standalone command)</dt>
<dd>
<p>Run <code>gradle --stop</code> to stop all Gradle Daemons of the same version.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.daemon.idletimeout=(number of milliseconds)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> wherein the Gradle Daemon will stop itself after this number of milliseconds of idle time. <em>Default is 10800000</em> (3 hours).</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_logging"><a class="anchor" href="#sec:command_line_logging"></a><a class="link" href="#sec:command_line_logging">Logging options</a></h4>
<div class="sect4">
<h5 id="setting_log_level"><a class="anchor" href="#setting_log_level"></a><a class="link" href="#setting_log_level">Setting log level</a></h5>
<div class="paragraph">
<p>You can customize the <a href="#logging">verbosity</a> of Gradle logging with the following options, ordered from least verbose to most verbose.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that sets the logging level.</p>
</dd>
<dt class="hdlist1"><code>-q</code>, <code>--quiet</code></dt>
<dd>
<p>Log errors only.</p>
</dd>
<dt class="hdlist1"><code>-w</code>, <code>--warn</code></dt>
<dd>
<p>Set log level to warn.</p>
</dd>
<dt class="hdlist1"><code>-i</code>, <code>--info</code></dt>
<dd>
<p>Set log level to info.</p>
</dd>
<dt class="hdlist1"><code>-d</code>, <code>--debug</code></dt>
<dd>
<p>Log in debug mode (includes normal stacktrace).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Lifecycle</em> is the default log level.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:command_line_customizing_log_format"><a class="anchor" href="#sec:command_line_customizing_log_format"></a><a class="link" href="#sec:command_line_customizing_log_format">Customizing log format</a></h5>
<div class="paragraph">
<p>You can control the use of rich output (colors and font variants) by specifying the console mode in the following ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.console=(auto,plain,colored,rich,verbose)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that specifies the console mode. Different modes are described immediately below.</p>
</dd>
<dt class="hdlist1"><code>--console=(auto,plain,colored,rich,verbose)</code></dt>
<dd>
<p>Specifies which type of console output to generate.</p>
<div class="paragraph">
<p>Set to <code>plain</code> to generate plain text only. This option disables all color and other rich output in the console output. This is the default when Gradle is <em>not</em> attached to a terminal.</p>
</div>
<div class="paragraph">
<p>Set to <code>colored</code> to generate colored output without rich status information such as progress bars.</p>
</div>
<div class="paragraph">
<p>Set to <code>auto</code> (the default) to enable color and other rich output in the console output when the build process is attached to a console or to generate plain text only when not attached to a console. <em>This is the default when Gradle is attached to a terminal.</em></p>
</div>
<div class="paragraph">
<p>Set to <code>rich</code> to enable color and other rich output in the console output, regardless of whether the build process is not attached to a console. When not attached to a console, the build output will use ANSI control characters to generate the rich output.</p>
</div>
<div class="paragraph">
<p>Set to <code>verbose</code> to enable color and other rich output like <code>rich</code> with output task names and outcomes at the lifecycle log level, (as is done by default in Gradle 3.5 and earlier).</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:command_line_problems"><a class="anchor" href="#sec:command_line_problems"></a><a class="link" href="#sec:command_line_problems">Reporting problems</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--problems-report</code> (enabled by default) <span class="incubating-label">Incubating</span></dt>
<dd>
<p>Enable the generation of <code>build/reports/problems-report.html</code>.
This is the default behaviour.
The report is generated with problems provided to the <a href="#sec:reporting_problems">Problems API</a>.</p>
</dd>
<dt class="hdlist1"><code>--no-problems-report</code> <span class="incubating-label">Incubating</span></dt>
<dd>
<p>Disable the generation of <code>build/reports/problems-report.html</code>, by default this report is generated with problems provided to the <a href="#sec:reporting_problems">Problems API</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:command_line_warnings"><a class="anchor" href="#sec:command_line_warnings"></a><a class="link" href="#sec:command_line_warnings">Showing or hiding warnings</a></h5>
<div class="paragraph">
<p>By default, Gradle won&#8217;t display all warnings (e.g. deprecation warnings). Instead, Gradle will collect them and render a summary at the end of the build like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Deprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can control the verbosity of warnings on the console with the following options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.warning.mode=(all,fail,none,summary)</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that specifies the warning mode. Different modes are described immediately below.</p>
</dd>
<dt class="hdlist1"><code>--warning-mode=(all,fail,none,summary)</code></dt>
<dd>
<p>Specifies how to log warnings. Default is <code>summary</code>.</p>
<div class="paragraph">
<p>Set to <code>all</code> to log all warnings.</p>
</div>
<div class="paragraph">
<p>Set to <code>fail</code> to log all warnings and fail the build if there are any warnings.</p>
</div>
<div class="paragraph">
<p>Set to <code>summary</code> to suppress all warnings and log a summary at the end of the build.</p>
</div>
<div class="paragraph">
<p>Set to <code>none</code> to suppress all warnings, including the summary at the end of the build.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:rich_console"><a class="anchor" href="#sec:rich_console"></a><a class="link" href="#sec:rich_console">Rich console</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s rich console displays extra information while builds are running.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/rich-cli.png" alt="Gradle Rich Console">
</div>
</div>
<div class="paragraph">
<p>Features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Progress bar and timer visually describe the overall status</p>
</li>
<li>
<p>Parallel work-in-progress lines below describe what is happening now</p>
</li>
<li>
<p>Colors and fonts are used to highlight significant output and errors</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_execution_options"><a class="anchor" href="#sec:command_line_execution_options"></a><a class="link" href="#sec:command_line_execution_options">Execution options</a></h4>
<div class="paragraph">
<p>The following options affect how builds are executed by changing what is built or how dependencies are resolved.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--include-build</code></dt>
<dd>
<p>Run the build as a <a href="#composite_builds">composite</a>, including the specified build.</p>
</dd>
<dt class="hdlist1"><code>--offline</code></dt>
<dd>
<p>Specifies that the build should operate <a href="#sec:controlling-dependency-caching-command-line">without accessing network resources</a>.</p>
</dd>
<dt class="hdlist1"><code>-U</code>, <code>--refresh-dependencies</code></dt>
<dd>
<p>Refresh the <a href="#sec:controlling-dependency-caching-command-line">state of dependencies</a>.</p>
</dd>
<dt class="hdlist1"><code>--continue</code></dt>
<dd>
<p><a href="#sec:continue_build_on_failure">Continue task execution</a> after a task failure.</p>
</dd>
<dt class="hdlist1"><code>-m</code>, <code>--dry-run</code></dt>
<dd>
<p>Run Gradle with all task actions disabled. Use this to show which task would have executed.</p>
</dd>
<dt class="hdlist1"><code>--task-graph</code> <span class="since-gradle-label">Since 9.1.0</span> <span class="incubating-label">Incubating</span></dt>
<dd>
<p>Run Gradle with all task actions disabled and print the task dependency graph.</p>
</dd>
<dt class="hdlist1"><code>-t</code>, <code>--continuous</code></dt>
<dd>
<p>Enables <a href="#sec:continuous_build">continuous build</a>. Gradle does not exit and will re-execute tasks when task file inputs change.</p>
</dd>
<dt class="hdlist1"><code>--write-locks</code></dt>
<dd>
<p>Indicates that all resolved configurations that are <em>lockable</em> should have their <a href="#locking-versions">lock state</a> persisted.</p>
</dd>
<dt class="hdlist1"><code>--update-locks &lt;group:name&gt;[,&lt;group:name&gt;]*</code></dt>
<dd>
<p>Indicates that versions for the specified modules have to be updated in the <a href="#locking-versions">lock file</a>.</p>
<div class="paragraph">
<p>This flag also implies <code>--write-locks</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>-a</code>, <code>--no-rebuild</code></dt>
<dd>
<p>Do not rebuild project dependencies.
Useful for <a href="#sec:using_buildsrc">debugging and fine-tuning <code>buildSrc</code></a>, but can lead to wrong results. Use with caution!</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency_verification_options"><a class="anchor" href="#sec:dependency_verification_options"></a><a class="link" href="#sec:dependency_verification_options">Dependency verification options</a></h4>
<div class="paragraph">
<p>Learn more about this in <a href="#verifying-dependencies">dependency verification</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-F=(strict,lenient,off)</code>, <code>--dependency-verification=(strict,lenient,off)</code></dt>
<dd>
<p>Configures the <a href="#sec:disabling-verification">dependency verification mode</a>.</p>
<div class="paragraph">
<p>The default mode is <code>strict</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>-M</code>, <code>--write-verification-metadata</code></dt>
<dd>
<p>Generates checksums for dependencies used in the project (comma-separated list) for <a href="#sec:bootstrapping-verification">dependency verification</a>.</p>
</dd>
<dt class="hdlist1"><code>--refresh-keys</code></dt>
<dd>
<p>Refresh the public keys used for dependency verification.</p>
</dd>
<dt class="hdlist1"><code>--export-keys</code></dt>
<dd>
<p>Exports the public keys used for dependency verification.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:environment_options"><a class="anchor" href="#sec:environment_options"></a><a class="link" href="#sec:environment_options">Environment options</a></h4>
<div class="paragraph">
<p>You can <a href="#build_environment">customize</a> many aspects of build scripts, settings, caches, and so on through the options below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-g</code>, <code>--gradle-user-home</code></dt>
<dd>
<p>Specifies the Gradle User Home directory. The default is the <code>.gradle</code> directory in the user&#8217;s home directory.</p>
</dd>
<dt class="hdlist1"><code>-p</code>, <code>--project-dir</code></dt>
<dd>
<p>Specifies the start directory for Gradle. Defaults to current directory.</p>
</dd>
<dt class="hdlist1"><code>--project-cache-dir</code></dt>
<dd>
<p>Specifies the project-specific cache directory. Default value is <code>.gradle</code> in the root project directory.</p>
</dd>
<dt class="hdlist1"><code>-D</code>, <code>--system-prop</code></dt>
<dd>
<p>Sets a <a href="#sec:gradle_system_properties">system property</a> of the JVM, for example <code>-Dmyprop=myvalue</code>.</p>
</dd>
<dt class="hdlist1"><code>-I</code>, <code>--init-script</code></dt>
<dd>
<p>Specifies an <a href="#init_scripts">initialization script</a>.</p>
</dd>
<dt class="hdlist1"><code>-P</code>, <code>--project-prop</code></dt>
<dd>
<p>Sets a <a href="#sec:project_properties">project property</a> of the root project, for example <code>-Pmyprop=myvalue</code>.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.jvmargs</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that sets JVM arguments.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.java.home</code></dt>
<dd>
<p>A <a href="#sec:gradle_configuration_properties">Gradle property</a> that sets the JDK home dir.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_options"><a class="anchor" href="#sec:task_options"></a><a class="link" href="#sec:task_options">Task options</a></h4>
<div class="paragraph">
<p>Tasks may define task-specific options which are different from most of the global options described in the sections above (which are interpreted by Gradle itself, can appear anywhere in the command line, and can be listed using the <code>--help</code> option).</p>
</div>
<div class="paragraph">
<p>Task options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are consumed and interpreted by the tasks themselves;</p>
</li>
<li>
<p><strong>Must</strong> be specified immediately after the task in the command-line;</p>
</li>
<li>
<p>May be listed using <code>gradle help --task someTask</code> (see <a href="#sec:show_task_details">Show task usage details</a>).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To learn how to declare command-line options for your own tasks, see <a href="#sec:declaring_and_using_command_line_options">Declaring and Using Command Line Options</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:builtin_task_options"><a class="anchor" href="#sec:builtin_task_options"></a><a class="link" href="#sec:builtin_task_options">Built-in task options</a></h5>
<div class="paragraph">
<p>Built-in task options are options available as task options for all tasks. At this time, the following built-in task options exist:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--rerun</code></dt>
<dd>
<p>Causes the task to be rerun even if up-to-date. Similar to <code><a href="#sec:rerun_tasks">--rerun-tasks</a></code>, but for a specific task.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_bootstrapping_projects"><a class="anchor" href="#sec:command_line_bootstrapping_projects"></a><a class="link" href="#sec:command_line_bootstrapping_projects">Bootstrapping new projects</a></h4>
<div class="sect4">
<h5 id="creating_new_gradle_builds"><a class="anchor" href="#creating_new_gradle_builds"></a><a class="link" href="#creating_new_gradle_builds">Creating new Gradle builds</a></h5>
<div class="paragraph">
<p>Use the built-in <code>gradle init</code> task to create a new Gradle build, with new or existing projects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most of the time, a project type is specified.
Available types include <code>basic</code> (default), <code>java-library</code>, <code>java-application</code>, and more.
See <a href="build_init_plugin.html#build_init_plugin">init plugin documentation</a> for details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle init --type java-library</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="standardize_and_provision_gradle"><a class="anchor" href="#standardize_and_provision_gradle"></a><a class="link" href="#standardize_and_provision_gradle">Standardize and provision Gradle</a></h5>
<div class="paragraph">
<p>The built-in <code>gradle wrapper</code> task generates a script, <code>gradlew</code>, that invokes a declared version of Gradle, downloading it beforehand if necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle wrapper --gradle-version=8.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify <code>--distribution-type=(bin|all)</code>, <code>--gradle-distribution-url</code>, <code>--gradle-distribution-sha256-sum</code> in addition to <code>--gradle-version</code>.<br>
Full details on using these options are documented in the <a href="#gradle_wrapper">Gradle wrapper section</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:continuous_build"><a class="anchor" href="#sec:continuous_build"></a><a class="link" href="#sec:continuous_build">Continuous build</a></h4>
<div class="paragraph">
<p>Continuous Build allows you to automatically re-execute the requested tasks when file inputs change.
You can execute the build in this mode using the <code>-t</code> or <code>--continuous</code> command-line option.</p>
</div>
<div class="paragraph">
<p>Learn more in <a href="#continuous_builds">Continuous Builds</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="anchor" href="#logging"></a><a class="link" href="#logging">Logging and Output</a></h3>
<div class="paragraph">
<p>The build log is the primary way Gradle communicates what&#8217;s happening during a build.
Clear logging helps you quickly understand your build status, identify issues, and troubleshoot effectively.
Too much noise in the logs can obscure important warnings or errors.</p>
</div>
<div class="paragraph">
<p>Gradle provides flexible logging controls, enabling you to adjust verbosity and detail according to your needs.</p>
</div>
<div class="sect3">
<h4 id="logLevels"><a class="anchor" href="#logLevels"></a><a class="link" href="#logLevels">Gradle Log levels</a></h4>
<div class="paragraph">
<p>Gradle defines six primary log levels:</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Level</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ERROR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUIET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Important information messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WARNING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Progress information messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INFO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEBUG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Debug messages</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The default logging level is <code>LIFECYCLE</code>, providing progress updates without overwhelming detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:choosing_a_log_level"><a class="anchor" href="#sec:choosing_a_log_level"></a><a class="link" href="#sec:choosing_a_log_level">Choosing and setting a log level</a></h4>
<div class="paragraph">
<p>You can set the log level either through command-line options or by configuring the <code>gradle.properties</code> file.</p>
</div>
<table id="logLevelCommandLineOptions" class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">CLI Option</th>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Outputs Log Levels</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-q</code> or <code>--quiet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.level=quiet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QUIET and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-w</code> or <code>--warn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.level=warn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARN and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no logging options</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIFECYCLE and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-i</code> or <code>--info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.level=info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-d</code> or <code>--debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.level=debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG and higher (all log messages)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, to set a consistent log level in your project&#8217;s <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.logging.level=info</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew run --info</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can emit log messages directly from build scripts and tasks using Gradle&#8217;s built-in logger:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/tutorial/logging">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("logtask") {
    doLast {
        logger.lifecycle("Lifecycle: Build progress info.")
        logger.info("Info: Additional insights.")
        logger.debug("Debug: Detailed troubleshooting info.")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('logtask') {
    doLast {
        logger.lifecycle('Lifecycle: Build progress info.')
        logger.info('Info: Additional insights.')
        logger.debug('Debug: Detailed troubleshooting info.')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Use appropriate log levels (<code>lifecycle</code>, <code>info</code>, <code>debug</code>) to ensure your build output is clear and informative.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
The <code>DEBUG</code> log level can <a href="#sec:debug_security">expose sensitive security information to the console</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="stacktraces"><a class="anchor" href="#stacktraces"></a><a class="link" href="#stacktraces">Stacktrace options</a></h5>
<div class="paragraph">
<p>Stacktraces are useful for diagnosing issues during a build failure. You can control stacktrace output via command-line options or properties:</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">CLI Option</th>
<th class="tableblock halign-left valign-top">Gradle Property</th>
<th class="tableblock halign-left valign-top">Stacktrace Shown</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--stacktrace</code> or <code>-s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.stacktrace=all</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Truncated stacktraces are printed. We recommend this over full stacktraces. Groovy full stacktraces are extremely verbose due to the underlying dynamic invocation mechanisms. Yet they usually do not contain relevant information about what has gone wrong in <em>your</em> code. This option renders stacktraces for deprecation warnings.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--full-stacktrace</code> or <code>-S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.stacktrace=full</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full stacktraces are printed out. This option renders stacktraces for deprecation warnings.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No stacktraces are printed to the console in case of a build error (e.g., a compile error). Only in case of internal exceptions will stacktraces be printed. If the <code>DEBUG</code> log level is chosen, truncated stacktraces are always printed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, to always display a full stacktrace on build errors, set in <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.logging.stacktrace=full</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:debug_security"><a class="anchor" href="#sec:debug_security"></a><a class="link" href="#sec:debug_security">Logging Sensitive Information</a></h4>
<div class="paragraph">
<p>Running Gradle with the <code>DEBUG</code> log level can potentially expose sensitive information to the console and build log.</p>
</div>
<div class="paragraph">
<p>This information might include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Environment variables</p>
</li>
<li>
<p>Private repository credentials</p>
</li>
<li>
<p>Build cache and Develocity credentials</p>
</li>
<li>
<p>Plugin Portal publishing credentials</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s important to avoid using the <code>DEBUG</code> log level when running on public Continuous Integration (CI) services.
Build logs on these services are accessible to the public and can expose sensitive information.
Even on private CI services, logging sensitive credentials may pose a risk depending on your organization&#8217;s threat model.
It&#8217;s advisable to discuss this with your organization&#8217;s security team.</p>
</div>
<div class="paragraph">
<p>Some CI providers attempt to redact sensitive credentials from logs, but this process is not foolproof and typically only redacts exact matches of pre-configured secrets.</p>
</div>
<div class="paragraph">
<p>If you suspect that a Gradle Plugin may inadvertently expose sensitive information, please contact <a href="mailto:security@gradle.com">our security team</a> for assistance with disclosure.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:sending_your_own_log_messages"><a class="anchor" href="#sec:sending_your_own_log_messages"></a><a class="link" href="#sec:sending_your_own_log_messages">Custom log messages</a></h4>
<div class="paragraph">
<p>A simple option for logging in your build file is to write messages to standard output.
Gradle redirects anything written to standard output to its logging system at the <code>QUIET</code> log level:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/tutorial/logging">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">println("A message which is logged at QUIET level")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">println 'A message which is logged at QUIET level'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle also provides a <code>logger</code> property to a build script, which is an instance of <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/logging/Logger.html">Logger</a>.
This interface extends the SLF4J <code>Logger</code> interface and adds a few Gradle-specific methods.
Below is an example of how this is used in the build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">logger.quiet("An info log message which is always logged.")
logger.error("An error log message.")
logger.warn("A warning log message.")
logger.lifecycle("A lifecycle info log message.")
logger.info("An info log message.")
logger.debug("A debug log message.")
logger.trace("A trace log message.") // Gradle never logs TRACE level logs</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">logger.quiet('An info log message which is always logged.')
logger.error('An error log message.')
logger.warn('A warning log message.')
logger.lifecycle('A lifecycle info log message.')
logger.info('An info log message.')
logger.debug('A debug log message.')
logger.trace('A trace log message.') // Gradle never logs TRACE level logs</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Use the link <a href="https://www.slf4j.org/manual.html#typical_usage">typical SLF4J pattern</a> to replace a placeholder with an actual value in the log message.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">logger.info("A {} log message", "info")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">logger.info('A {} log message', 'info')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also hook into Gradle&#8217;s logging system from within other classes used in the build (classes from the <code>buildSrc</code> directory, for example) with an SLF4J logger.
You can use this logger the same way as you use the provided logger in the build script.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.slf4j.LoggerFactory

val slf4jLogger = LoggerFactory.getLogger("some-logger")
slf4jLogger.info("An info log message logged using SLF4j")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.slf4j.LoggerFactory

def slf4jLogger = LoggerFactory.getLogger('some-logger')
slf4jLogger.info('An info log message logged using SLF4j')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:external_tools"><a class="anchor" href="#sec:external_tools"></a><a class="link" href="#sec:external_tools">Logging from external tools and libraries</a></h4>
<div class="paragraph">
<p>Internally, Gradle uses Ant and Ivy.
Both have their own logging system.
Gradle redirects their logging output into the Gradle logging system.</p>
</div>
<div class="paragraph">
<p>There is a 1:1 mapping from the Ant/Ivy log levels to the Gradle log levels, except the Ant/Ivy <code>TRACE</code> log level, which is mapped to the Gradle <code>DEBUG</code> log level.
This means the default Gradle log level will not show any Ant/Ivy output unless it is an error or a warning.</p>
</div>
<div class="paragraph">
<p>Many tools out there still use the standard output for logging.
By default, Gradle redirects standard output to the <code>QUIET</code> log level and standard error to the <code>ERROR</code> level.
This behavior is configurable.</p>
</div>
<div class="paragraph">
<p>The <code>project</code> object provides a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/logging/LoggingManager.html">LoggingManager</a>, which allows you to change the log levels that standard out or error are redirected to when your build script is evaluated.</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/tutorial/logging">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">logging.captureStandardOutput(LogLevel.INFO)
println("A message which is logged at INFO level")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">logging.captureStandardOutput LogLevel.INFO
println 'A message which is logged at INFO level'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To change the log level for standard out or error during task execution, use a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/logging/LoggingManager.html">LoggingManager</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("logInfo") {
    logging.captureStandardOutput(LogLevel.INFO)
    doFirst {
        println("A task message which is logged at INFO level")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('logInfo') {
    logging.captureStandardOutput LogLevel.INFO
    doFirst {
        println 'A task message which is logged at INFO level'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle also integrates with the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/package-summary.html">Java Util Logging</a>, Jakarta Commons Logging and <a href="https://logging.apache.org/log4j/2.x/">Log4j</a> logging toolkits.
Any log messages your build classes write using these logging toolkits will be redirected to Gradle&#8217;s logging system.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:changing_what_gradle_logs"><a class="anchor" href="#sec:changing_what_gradle_logs"></a><a class="link" href="#sec:changing_what_gradle_logs">Changing what Gradle logs</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is deprecated and will be removed in the next major version without a replacement.</p>
</div>
<div class="paragraph">
<p>The <a href="#config_cache">configuration cache</a> limits the ability to customize Gradle&#8217;s logging UI.
The custom logger can only implement <a href="#config_cache:requirements:build_listeners">supported listener interfaces</a>.
These interfaces do not receive events when the configuration cache entry is reused because the configuration phase is skipped.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can replace much of Gradle&#8217;s logging UI with your own.
You could do this if you want to customize the UI somehow - to log more or less information or to change the formatting.
Simply replace the logging using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:useLogger(java.lang.Object)">Gradle.useLogger(java.lang.Object)</a> method.
This is accessible from a build script, an init script, or via the embedding API.
Note that this completely disables Gradle&#8217;s default output.
Below is an example init script that changes how task execution and build completion are logged:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/initScripts/customLogger">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">customLogger.init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">useLogger(CustomEventLogger())

@Suppress("deprecation")
class CustomEventLogger() : BuildAdapter(), TaskExecutionListener {

    override fun beforeExecute(task: Task) {
        println("[${task.name}]")
    }

    override fun afterExecute(task: Task, state: TaskState) {
        println()
    }

    override fun buildFinished(result: BuildResult) {
        println("build completed")
        if (result.failure != null) {
            (result.failure as Throwable).printStackTrace()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">customLogger.init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">useLogger(new CustomEventLogger())

@SuppressWarnings("deprecation")
class CustomEventLogger extends BuildAdapter implements TaskExecutionListener {

    void beforeExecute(Task task) {
        println "[$task.name]"
    }

    void afterExecute(Task task, TaskState state) {
        println()
    }
    
    void buildFinished(BuildResult result) {
        println 'build completed'
        if (result.failure != null) {
            result.failure.printStackTrace()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-text lang-kotlin">
<div class="content">
<pre>$ ./gradlew -I customLogger.init.gradle.kts build

&gt; Task :compile
[compile]
compiling source

&gt; Task :testCompile
[testCompile]
compiling test source

&gt; Task :test
[test]
running unit tests

&gt; Task :build
[build]

build completed
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="listingblock multi-language-text lang-groovy">
<div class="content">
<pre>$ ./gradlew -I customLogger.init.gradle build

&gt; Task :compile
[compile]
compiling source

&gt; Task :testCompile
[testCompile]
compiling test source

&gt; Task :test
[test]
running unit tests

&gt; Task :build
[build]

build completed
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Your logger can implement any of the listener interfaces listed below.
When you register a logger, only the logging for the interfaces it implements is replaced.
Logging for the other interfaces is left untouched.
You can find out more about the listener interfaces in <a href="#build_phases">Build lifecycle events</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/BuildListener.html">BuildListener</a><sup class="footnote" id="_footnote_config_cache_incompat">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/ProjectEvaluationListener.html">ProjectEvaluationListener</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/execution/TaskExecutionGraphListener.html">TaskExecutionGraphListener</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/execution/TaskExecutionListener.html">TaskExecutionListener</a><sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/execution/TaskActionListener.html">TaskActionListener</a><sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle_wrapper"><a class="anchor" href="#gradle_wrapper"></a><a class="link" href="#gradle_wrapper">Gradle Wrapper</a></h3>
<div class="paragraph">
<p>The <strong>recommended way to execute any Gradle build</strong> is with the help of the Gradle Wrapper (referred to as "Wrapper").</p>
</div>
<div class="paragraph">
<p><strong>The Wrapper is a script</strong> (called <code>gradlew</code> or <code>gradlew.bat</code>) that invokes a declared version of Gradle, downloading it beforehand if necessary.
Instead of running <code>gradle build</code> using the installed Gradle, you use the Gradle Wrapper by calling <code>./gradlew build</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/wrapper-workflow.png" alt="wrapper workflow">
</div>
</div>
<div class="paragraph">
<p>The Gradle Wrapper isnt distributed as a standalone downloadits created using the <code>gradle wrapper</code> task.</p>
</div>
<div class="paragraph">
<p>There are three ways to use the Wrapper:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Adding the Wrapper</strong> - You set up a new Gradle project and <a href="#sec:adding_wrapper">add the Wrapper</a> to it.</p>
</li>
<li>
<p><strong>Using the Wrapper</strong> - You <a href="#sec:using_wrapper">run a project with the Wrapper</a> that already provides it.</p>
</li>
<li>
<p><strong>Upgrading the Wrapper</strong> - You <a href="#sec:upgrading_wrapper">upgrade the Wrapper</a> to a new version of Gradle.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When using the Wrapper instead of the installed Gradle, you gain the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standardizes a project on a given Gradle version for more reliable and robust builds.</p>
</li>
<li>
<p>Provisioning the Gradle version for different users is done with a simple Wrapper definition change.</p>
</li>
<li>
<p>Provisioning the Gradle version for different execution environments (e.g., IDEs or Continuous Integration servers) is done with a simple Wrapper definition change.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections explain each of these use cases in more detail.</p>
</div>
<div class="sect3">
<h4 id="sec:adding_wrapper"><a class="anchor" href="#sec:adding_wrapper"></a><a class="link" href="#sec:adding_wrapper">1. Adding the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>The Gradle Wrapper is <strong>not</strong> something you download.</p>
</div>
<div class="paragraph">
<p>Generating the Wrapper files requires an installed version of the Gradle runtime on your machine as described in <a href="#installation">Installation</a>.
Thankfully, generating the initial Wrapper files is a one-time process.</p>
</div>
<div class="paragraph">
<p>Every vanilla Gradle build comes with a built-in task called <code>wrapper</code>.
The task is listed under the group "Build Setup tasks" when <a href="#sec:listing_tasks">listing the tasks</a>.</p>
</div>
<div class="paragraph">
<p>Executing the <code>wrapper</code> task generates the necessary Wrapper files in the project directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle wrapper</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :wrapper

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>To make the Wrapper files available to other developers and execution environments, you need to check them into version control.
Wrapper files, including the JAR file, are small.
Adding the JAR file to version control is expected.
Some organizations do not allow projects to submit binary files to version control, and there is no workaround available.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The generated Wrapper properties file, <code>gradle/wrapper/gradle-wrapper.properties</code>, stores the information about the Gradle distribution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>server hosting</strong> the Gradle distribution.</p>
</li>
<li>
<p>The <strong>type of Gradle distribution</strong>. By default, the <code>-bin</code> distribution contains only the runtime but no sample code and documentation.</p>
</li>
<li>
<p>The <strong>Gradle version</strong> used for executing the build. By default, the <code>wrapper</code> task picks the same Gradle version used to generate the Wrapper files.</p>
</li>
<li>
<p>Optionally, a <strong>timeout</strong> in ms used when downloading the Gradle distribution.</p>
</li>
<li>
<p>Optionally, a <strong>boolean</strong> to set the <strong>validation of the distribution</strong> URL.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example of the generated distribution URL in <code>gradle/wrapper/gradle-wrapper.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">distributionUrl=https\://services.gradle.org/distributions/gradle-{gradleVersion}-bin.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>All of those aspects are configurable at the time of generating the Wrapper files with the help of the following command line options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--gradle-version</code></dt>
<dd>
<p>The Gradle version used for downloading and executing the Wrapper.
The resulting distribution URL is validated before it is written to the properties file.</p>
<div class="paragraph">
<p>For Gradle versions starting with major version 9, the version can be specified using only the major or minor version number.
In such cases, the latest normal release matching that major or minor version will be used.
For example, <code>9</code> resolves to the latest <code>9.x.y</code> release, and <code>9.1</code> resolves to the latest <code>9.1.x</code> release.</p>
</div>
<div class="paragraph">
<p>The following labels are allowed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://gradle.org/releases">latest</a></code></p>
</li>
<li>
<p><code><a href="https://gradle.org/release-candidate">release-candidate</a></code></p>
</li>
<li>
<p><code><a href="https://services.gradle.org/versions/milestone">release-milestone</a></code></p>
</li>
<li>
<p><code><a href="https://gradle.org/release-nightly">release-nightly</a></code></p>
</li>
<li>
<p><code><a href="https://gradle.org/nightly">nightly</a></code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>--distribution-type</code></dt>
<dd>
<p>The Gradle distribution type used for the Wrapper.
Available options are <code>bin</code> and <code>all</code>.
The default value is <code>bin</code>.</p>
</dd>
<dt class="hdlist1"><code>--gradle-distribution-url</code></dt>
<dd>
<p>The full URL pointing to the Gradle distribution ZIP file.
This option makes <code>--gradle-version</code> and <code>--distribution-type</code> obsolete, as the URL already contains this information.
This option is valuable if you want to host the Gradle distribution inside your company&#8217;s network.
The URL is validated before it is written to the properties file.</p>
</dd>
<dt class="hdlist1"><code>--gradle-distribution-sha256-sum</code></dt>
<dd>
<p>The SHA256 hash sum used for <a href="#sec:verification">verifying the downloaded Gradle distribution</a>.</p>
</dd>
<dt class="hdlist1"><code>--network-timeout</code></dt>
<dd>
<p>The network timeout to use when downloading the Gradle distribution, in ms. The default value is <code>10000</code>.</p>
</dd>
<dt class="hdlist1"><code>--no-validate-url</code></dt>
<dd>
<p>Disables the validation of the configured distribution URL.</p>
</dd>
<dt class="hdlist1"><code>--validate-url</code></dt>
<dd>
<p>Enables the validation of the configured distribution URL. Enabled by default.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If the distribution URL is configured with <code>--gradle-version</code> or <code>--gradle-distribution-url</code>, the URL is validated by sending a HEAD request in the case of the <code>https</code> scheme or by checking the existence of the file in the case of the <code>file</code> scheme.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume the following use-case to illustrate the use of the command line options.
You would like to generate the Wrapper with version 9.1.0 and use the <code>-all</code> distribution to enable your IDE to enable code-completion and being able to navigate to the Gradle source code.</p>
</div>
<div class="paragraph">
<p>The following command-line execution captures those requirements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle wrapper --gradle-version {gradleVersion} --distribution-type all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :wrapper

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>As a result, you can find the desired information (the generated distribution URL) in the Wrapper properties file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">distributionUrl=https\://services.gradle.org/distributions/gradle-{gradleVersion}-all.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at the following project layout to illustrate the expected Wrapper files:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 a-subproject
    build.gradle.kts
 settings.gradle.kts
 gradle
    wrapper
        gradle-wrapper.jar
        gradle-wrapper.properties
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 a-subproject
    build.gradle
 settings.gradle
 gradle
    wrapper
        gradle-wrapper.jar
        gradle-wrapper.properties
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A Gradle project typically provides a <code>settings.gradle(.kts)</code> file and one <code>build.gradle(.kts)</code> file for each subproject.
The Wrapper files live alongside in the <code>gradle</code> directory and the root directory of the project.</p>
</div>
<div class="paragraph">
<p>The following list explains their purpose:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gradle-wrapper.jar</code></dt>
<dd>
<p>The Wrapper JAR file containing code for downloading the Gradle distribution.</p>
</dd>
<dt class="hdlist1"><code>gradle-wrapper.properties</code></dt>
<dd>
<p>A properties file responsible for configuring the Wrapper runtime behavior e.g. the Gradle version compatible with this version. Note that more generic settings, like <a href="networking.html#sec:accessing_the_web_via_a_proxy">configuring the Wrapper to use a proxy</a>, need to go into a <a href="#sec:gradle_configuration_properties">different file</a>.</p>
</dd>
<dt class="hdlist1"><code>gradlew</code>, <code>gradlew.bat</code></dt>
<dd>
<p>A shell script and a Windows batch script for executing the build with the Wrapper.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can go ahead and <a href="#sec:using_wrapper">execute the build with the Wrapper</a> without installing the Gradle runtime.
If the project you are working on does not contain those Wrapper files, you will need to <a href="#sec:adding_wrapper">generate them</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_wrapper"><a class="anchor" href="#sec:using_wrapper"></a><a class="link" href="#sec:using_wrapper">2. Using the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>It is always recommended to execute a build with the Wrapper to ensure a reliable, controlled, and standardized execution of the build.
Using the Wrapper looks like running the build with a Gradle installation.
Depending on the operating system you either run <code>gradlew</code> or <code>gradlew.bat</code> instead of the <code>gradle</code> command.</p>
</div>
<div class="paragraph">
<p>The following console output demonstrates the use of the Wrapper on a Windows machine for a Java-based project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradlew.bat build</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Downloading https://services.gradle.org/distributions/gradle-5.0-all.zip
.....................................................................................
Unzipping C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-5.0-all\ac27o8rbd0ic8ih41or9l32mv\gradle-5.0-all.zip to C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-5.0-al\ac27o8rbd0ic8ih41or9l32mv
Set executable permissions for: C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-5.0-all\ac27o8rbd0ic8ih41or9l32mv\gradle-5.0\bin\gradle

BUILD SUCCESSFUL in 12s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>If the Gradle distribution was not provisioned to <code>GRADLE_USER_HOME</code> before, the Wrapper will download it and store it in <code>GRADLE_USER_HOME</code>.
Any subsequent build invocation will reuse the existing local distribution as long as the distribution URL in the Gradle properties doesn&#8217;t change.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Wrapper shell script and batch file reside in the root directory of a single or multi-project Gradle build. You will need to reference the correct path to those files in case you want to execute the build from a subproject directory e.g. <code>../../gradlew tasks</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:upgrading_wrapper"><a class="anchor" href="#sec:upgrading_wrapper"></a><a class="link" href="#sec:upgrading_wrapper">3. Upgrading the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>Projects typically want to keep up with the times and upgrade their Gradle version to benefit from new features and improvements.</p>
</div>
<div class="paragraph">
<p>The recommended option is to run the <code>wrapper</code> task and provide the target Gradle version as described in <a href="#sec:adding_wrapper">Adding the Gradle Wrapper</a>.
Using the <code>wrapper</code> task ensures that any optimizations made to the Wrapper shell script or batch file with that specific Gradle version are applied to the project.</p>
</div>
<div class="paragraph">
<p>As usual, you should commit the changes to the Wrapper files to version control.</p>
</div>
<div class="paragraph">
<p>Note that running the wrapper task once will update <code>gradle-wrapper.properties</code> only, but leave the wrapper itself in <code>gradle-wrapper.jar</code> untouched.
This is usually fine as new versions of Gradle can be run even with older wrapper files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want <strong>all</strong> the wrapper files to be completely up-to-date, you will need to run the <code>wrapper</code> task a second time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following command upgrades the Wrapper to the <code>latest</code> version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew wrapper --gradle-version latest   // MacOs, Linux</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradlew.bat wrapper --gradle-version latest // Windows</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>BUILD SUCCESSFUL in 4s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The following command upgrades the Wrapper to a specific version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew wrapper --gradle-version {gradleVersion} // MacOs, Linux</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradlew.bat wrapper --gradle-version {gradleVersion} // Windows</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>BUILD SUCCESSFUL in 4s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Once you have upgraded the wrapper, you can check that it&#8217;s the version you expected by executing <code>./gradlew --version</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Don&#8217;t forget to run the <code>wrapper</code> task again to download the Gradle distribution binaries (if needed) and update the <code>gradlew</code> and <code>gradlew.bat</code> files.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another way to upgrade the Gradle version is by manually changing the <code>distributionUrl</code> property in the Wrapper&#8217;s <code>gradle-wrapper.properties</code> file.
The tip above also applies in this case.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since Gradle 9.0.0, the version <em>always</em> uses the <code>X.Y.Z</code> format.
Using only the major or minor version is not supported in <code>gradle-wrapper.properties</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="customizing_wrapper"><a class="anchor" href="#customizing_wrapper"></a><a class="link" href="#customizing_wrapper">Customizing the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>Most users of Gradle are happy with the default runtime behavior of the Wrapper.
However, organizational policies, security constraints or personal preferences might require you to dive deeper into customizing the Wrapper.</p>
</div>
<div class="paragraph">
<p>Thankfully, the built-in <code>wrapper</code> task exposes numerous options to bend the runtime behavior to your needs.
Most configuration options are exposed by the underlying task type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.wrapper.Wrapper.html">Wrapper</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume you grew tired of defining the <code>-all</code> distribution type on the command line every time you upgrade the Wrapper.
You can save yourself some keyboard strokes by re-configuring the <code>wrapper</code> task.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.wrapper {
    distributionType = Wrapper.DistributionType.ALL
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('wrapper') {
    distributionType = Wrapper.DistributionType.ALL
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With the configuration in place, running <code>./gradlew wrapper --gradle-version 9.1.0</code> is enough to produce a <code>distributionUrl</code> value in the Wrapper properties file that will request the <code>-all</code> distribution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">distributionUrl=https\://services.gradle.org/distributions/gradle-{gradleVersion}-all.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check out the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/wrapper/Wrapper.html">API documentation</a> for a more detailed description of the available configuration options. You can also find various samples for configuring the Wrapper in the Gradle distribution.</p>
</div>
<div class="sect4">
<h5 id="sec:authenticated_download"><a class="anchor" href="#sec:authenticated_download"></a><a class="link" href="#sec:authenticated_download">Authenticated Gradle distribution download</a></h5>
<div class="paragraph">
<p>The Gradle <code>Wrapper</code> can download Gradle distributions from servers using HTTP Basic Authentication.
This enables you to host the Gradle distribution on a private protected server.</p>
</div>
<div class="paragraph">
<p>You can specify a username and password in two different ways depending on your use case: as system properties or directly embedded in the <code>distributionUrl</code>.
Credentials in system properties take precedence over the ones embedded in <code>distributionUrl</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>HTTP Basic Authentication should only be used with <code>HTTPS</code> URLs and not plain <code>HTTP</code> ones.
With Basic Authentication, the user credentials are sent in clear text.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>System properties can be specified in the <code>.gradle/gradle.properties</code> file in the user&#8217;s home directory or by other <a href="#sec:gradle_configuration_properties">means</a>.</p>
</div>
<div class="paragraph">
<p>To specify the HTTP Basic Authentication credentials, add the following lines to the system properties file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">systemProp.gradle.wrapperUser=username
systemProp.gradle.wrapperPassword=password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Embedding credentials in the <code>distributionUrl</code> in the <code>gradle/wrapper/gradle-wrapper.properties</code> file also works.
Please note that this file is to be committed into your source control system.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Shared credentials embedded in <code>distributionUrl</code> should only be used in a controlled environment.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To specify the HTTP Basic Authentication credentials in <code>distributionUrl</code>, add the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">distributionUrl=https://username:password@somehost/path/to/gradle-distribution.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can be used in conjunction with a proxy, authenticated or not.
See <a href="networking.html#sec:accessing_the_web_via_a_proxy">Accessing the web via a proxy</a> for more information on how to configure the <code>Wrapper</code> to use a proxy.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification"><a class="anchor" href="#sec:verification"></a><a class="link" href="#sec:verification">Verification of downloaded Gradle distributions</a></h5>
<div class="paragraph">
<p>The Gradle Wrapper allows for verification of the downloaded Gradle distribution via SHA-256 hash sum comparison.
This increases security against targeted attacks by preventing a man-in-the-middle attacker from tampering with the downloaded Gradle distribution.</p>
</div>
<div class="paragraph">
<p>To enable this feature, download the <code>.sha256</code> file associated with the Gradle distribution you want to verify.</p>
</div>
<div class="sect5">
<h6 id="downloading_the_sha_256_file"><a class="anchor" href="#downloading_the_sha_256_file"></a><a class="link" href="#downloading_the_sha_256_file">Downloading the SHA-256 file</a></h6>
<div class="paragraph">
<p>You can download the <code>.sha256</code> file from the <a href="https://services.gradle.org/distributions/">stable releases</a> or <a href="https://services.gradle.org/distributions-snapshots/">release candidate and nightly releases</a>.
The format of the file is a single line of text that is the SHA-256 hash of the corresponding zip file.</p>
</div>
<div class="paragraph">
<p>You can also reference the <a href="https://gradle.org/release-checksums/">list of Gradle distribution checksums</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="configuring_checksum_verification"><a class="anchor" href="#configuring_checksum_verification"></a><a class="link" href="#configuring_checksum_verification">Configuring checksum verification</a></h6>
<div class="paragraph">
<p>Add the downloaded (SHA-256 checksum) hash sum to <code>gradle-wrapper.properties</code> using the <code>distributionSha256Sum</code> property or use <code>--gradle-distribution-sha256-sum</code> on the command-line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">distributionSha256Sum=371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will report a build failure if the configured checksum does not match the checksum found on the server hosting the distribution.
Checksum verification is only performed if the configured Wrapper distribution hasn&#8217;t been downloaded yet.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>Wrapper</code> task fails if <code>gradle-wrapper.properties</code> contains <code>distributionSha256Sum</code>, but the task configuration does not define a sum.
Executing the <code>Wrapper</code> task preserves the <code>distributionSha256Sum</code> configuration when the Gradle version does not change.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="wrapper_checksum_verification"><a class="anchor" href="#wrapper_checksum_verification"></a><a class="link" href="#wrapper_checksum_verification">Verifying the integrity of the Gradle Wrapper JAR</a></h4>
<div class="paragraph">
<p>The Wrapper JAR is a binary file that will be executed on the computers of developers and build servers.
As with all such files, you should ensure it&#8217;s trustworthy before executing it.</p>
</div>
<div class="paragraph">
<p>Since the Wrapper JAR is usually checked into a project&#8217;s version control system, there is the potential for a malicious actor to replace the original JAR with a modified one by submitting a pull request that only upgrades the Gradle version.</p>
</div>
<div class="paragraph">
<p>To verify the integrity of the Wrapper JAR, Gradle has created a <a href="https://github.com/marketplace/actions/build-with-gradle#the-wrapper-validation-action">GitHub Action</a> that automatically checks Wrapper JARs in pull requests against a list of known good checksums.</p>
</div>
<div class="paragraph">
<p>Gradle also publishes the <a href="https://gradle.org/release-checksums/">checksums of all releases</a> (except for version 3.3 to 4.0.2, which did not generate reproducible JARs), so you can manually verify the integrity of the Wrapper JAR.</p>
</div>
<div class="sect4">
<h5 id="automatically_verifying_the_gradle_wrapper_jar_on_github"><a class="anchor" href="#automatically_verifying_the_gradle_wrapper_jar_on_github"></a><a class="link" href="#automatically_verifying_the_gradle_wrapper_jar_on_github">Automatically verifying the Gradle Wrapper JAR on GitHub</a></h5>
<div class="paragraph">
<p>The <a href="https://github.com/marketplace/actions/build-with-gradle#the-wrapper-validation-action">GitHub Action</a> is released separately from Gradle, so please check its documentation for how to apply it to your project.</p>
</div>
</div>
<div class="sect4">
<h5 id="manually_verifying_the_gradle_wrapper_jar"><a class="anchor" href="#manually_verifying_the_gradle_wrapper_jar"></a><a class="link" href="#manually_verifying_the_gradle_wrapper_jar">Manually verifying the Gradle Wrapper JAR</a></h5>
<div class="paragraph">
<p>You can manually verify the checksum of the Wrapper JAR to ensure that it has not been tampered with by running the following commands on one of the major operating systems.</p>
</div>
<div class="paragraph">
<p>Manually verifying the checksum of the Wrapper JAR on Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd gradle/wrapper</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl --location --output gradle-wrapper.jar.sha256 \
       https://services.gradle.org/distributions/gradle-{gradleVersion}-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ echo " gradle-wrapper.jar" &gt;&gt; gradle-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sha256sum --check gradle-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle-wrapper.jar: OK</pre>
</div>
</div>
<div class="paragraph">
<p>Manually verifying the checksum of the Wrapper JAR on macOS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd gradle/wrapper</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl --location --output gradle-wrapper.jar.sha256 \
       https://services.gradle.org/distributions/gradle-{gradleVersion}-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ echo " gradle-wrapper.jar" &gt;&gt; gradle-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ shasum --check gradle-wrapper.jar.sha256</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle-wrapper.jar: OK</pre>
</div>
</div>
<div class="paragraph">
<p>Manually verifying the checksum of the Wrapper JAR on Windows (using PowerShell):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell">&gt; $expected = Invoke-RestMethod -Uri https://services.gradle.org/distributions/gradle-{gradleVersion}-wrapper.jar.sha256</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; $actual = (Get-FileHash gradle\wrapper\gradle-wrapper.jar -Algorithm SHA256).Hash.ToLower()</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; @{$true = 'OK: Checksum match'; $false = "ERROR: Checksum mismatch!`nExpected: $expected`nActual:   $actual"}[$actual -eq $expected]</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>OK: Checksum match</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="troubleshooting_a_checksum_mismatch"><a class="anchor" href="#troubleshooting_a_checksum_mismatch"></a><a class="link" href="#troubleshooting_a_checksum_mismatch">Troubleshooting a checksum mismatch</a></h5>
<div class="paragraph">
<p>If the checksum does not match the one you expected, chances are the <code>wrapper</code> task wasn&#8217;t executed with the upgraded Gradle distribution.</p>
</div>
<div class="paragraph">
<p>You should first check whether the actual checksum matches a different Gradle version.</p>
</div>
<div class="paragraph">
<p>Here are the commands you can run on the major operating systems to generate the actual checksum of the Wrapper JAR.</p>
</div>
<div class="paragraph">
<p>Generating the checksum of the Wrapper JAR on Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ sha256sum gradle/wrapper/gradle-wrapper.jar
d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95 gradle/wrapper/gradle-wrapper.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Generating the actual checksum of the Wrapper JAR on macOS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ shasum --algorithm=256 gradle/wrapper/gradle-wrapper.jar
d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95 gradle/wrapper/gradle-wrapper.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Generating the actual checksum of the Wrapper JAR on Windows (using PowerShell):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell">&gt; (Get-FileHash gradle\wrapper\gradle-wrapper.jar -Algorithm SHA256).Hash.ToLower()
d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you know the actual checksum, check whether it&#8217;s listed on <a href="https://gradle.org/release-checksums/" class="bare">https://gradle.org/release-checksums/</a>.
If it is listed, you have verified the integrity of the Wrapper JAR.
If the version of Gradle that generated the Wrapper JAR doesn&#8217;t match the version in <code>gradle/wrapper/gradle-wrapper.properties</code>, it&#8217;s safe to run the <code>wrapper</code> task again to update the Wrapper JAR.</p>
</div>
<div class="paragraph">
<p>If the checksum is not listed on the page, the Wrapper JAR might be from a milestone, release candidate, or nightly build or may have been generated by Gradle 3.3 to 4.0.2.
Try to find out how it was generated but treat it as untrustworthy until proven otherwise.
If you think the Wrapper JAR was compromised, please let the Gradle team know by sending an email to <a href="mailto:security@gradle.com">security@gradle.com</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle_daemon"><a class="anchor" href="#gradle_daemon"></a><a class="link" href="#gradle_daemon">Gradle Daemon</a></h3>
<div class="paragraph">
<p>A daemon is a computer program that runs as a background process rather than being under the direct control of an interactive user.</p>
</div>
<div class="paragraph">
<p>Gradle runs on the Java Virtual Machine (JVM) and uses several supporting libraries with non-trivial initialization time.
Startups can be slow.
The <strong>Gradle Daemon</strong> solves this problem.</p>
</div>
<div class="paragraph">
<p>The Gradle Daemon is a long-lived background process that reduces the time it takes to run a build.</p>
</div>
<div class="paragraph">
<p>The Gradle Daemon reduces build times by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Caching project information across builds</p>
</li>
<li>
<p>Running in the background so every Gradle build doesn&#8217;t have to wait for JVM startup</p>
</li>
<li>
<p>Benefiting from continuous runtime optimization in the JVM</p>
</li>
<li>
<p><a href="#sec:daemon_watch_fs">Watching the file system</a> to calculate exactly what needs to be rebuilt before you run a build</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="understanding_daemon"><a class="anchor" href="#understanding_daemon"></a><a class="link" href="#understanding_daemon">Understanding the Daemon</a></h4>
<div class="paragraph">
<p>The Gradle JVM client sends the Daemon build information such as command line arguments, project directories, and environment variables so that it can run the build.
The Daemon is responsible for resolving dependencies, executing build scripts, creating and running tasks; when it is done, it sends the client the output.
Communication between the client and the Daemon happens via a local socket connection.</p>
</div>
<div class="paragraph">
<p>Daemons use the JVM&#8217;s default minimum heap size.</p>
</div>
<div class="paragraph">
<p>If the requested build environment does not specify a maximum heap size, the Daemon uses up to 512MB of heap.
512MB is adequate for most builds.
Larger builds with hundreds of subprojects, configuration, and source code may benefit from a larger heap size.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:status"><a class="anchor" href="#sec:status"></a><a class="link" href="#sec:status">Check Daemon status</a></h4>
<div class="paragraph">
<p>To get a list of running Daemons and their statuses, use the <code>--status</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle --status</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">   PID STATUS   INFO
 28486 IDLE     7.5
 34247 BUSY     7.5</code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently, a given Gradle version can only connect to Daemons of the same version.
This means the status output only shows Daemons spawned running the same version of Gradle as the current project.</p>
</div>
</div>
<div class="sect3">
<h4 id="find_all_daemons"><a class="anchor" href="#find_all_daemons"></a><a class="link" href="#find_all_daemons">Find Daemons</a></h4>
<div class="paragraph">
<p>If you have installed the Java Development Kit (JDK), you can view live daemons with the <code>jps</code> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ jps</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">33920 Jps
27171 GradleDaemon
22792</code></pre>
</div>
</div>
<div class="paragraph">
<p>Live Daemons appear under the name <code>GradleDaemon</code>.
Because this command uses the JDK, you can view Daemons running any version of Gradle.</p>
</div>
</div>
<div class="sect3">
<h4 id="enable_deamon"><a class="anchor" href="#enable_deamon"></a><a class="link" href="#enable_deamon">Enable Daemon</a></h4>
<div class="paragraph">
<p>Gradle enables the Daemon by default since Gradle 3.0.
If your project doesn&#8217;t use the Daemon, you can enable it for a single build with the <code>--daemon</code> flag when you run a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --daemon</code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag overrides any settings that disable the Daemon in your project or user <code>gradle.properties</code> files.</p>
</div>
<div class="paragraph">
<p>To enable the Daemon by default in older Gradle versions, add the following setting to the <code>gradle.properties</code> file in the <a href="#dir:project_root">project root</a> or your Gradle User Home (<a href="#dir:gradle_user_home"><code>GRADLE_USER_HOME</code></a>):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.daemon=true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling_the_daemon"><a class="anchor" href="#sec:disabling_the_daemon"></a><a class="link" href="#sec:disabling_the_daemon">Disable Daemon</a></h4>
<div class="paragraph">
<p>You can disable the Daemon in multiple ways but there are important considerations:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Single-use Daemon </dt>
<dd>
<p>If the JVM args of the client process don&#8217;t match what the build requires, a single-used Daemon (disposable JVM) is created.
This means the Daemon is required for the build, so it is created, used, and then stopped at the end of the build.</p>
</dd>
<dt class="hdlist1">No Daemon </dt>
<dd>
<p>If the <code>JAVA_OPTS</code> and <code>GRADLE_OPTS</code> match <code>org.gradle.jvmargs</code>, the Daemon will not be used at all since the build happens in the client JVM.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="disable_for_a_build"><a class="anchor" href="#disable_for_a_build"></a><a class="link" href="#disable_for_a_build">Disable for a build</a></h5>
<div class="paragraph">
<p>To disable the Daemon for a single build, pass the <code>--no-daemon</code> flag when you run a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --no-daemon</code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag overrides any settings that enable the Daemon in your project including the <code>gradle.properties</code> files.</p>
</div>
</div>
<div class="sect4">
<h5 id="disable_for_a_project"><a class="anchor" href="#disable_for_a_project"></a><a class="link" href="#disable_for_a_project">Disable for a project</a></h5>
<div class="paragraph">
<p>To disable the Daemon for all builds of a project, add <code>org.gradle.daemon=false</code> to the <code>gradle.properties</code> file in the <a href="#dir:project_root">project root</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="disable_for_a_user"><a class="anchor" href="#disable_for_a_user"></a><a class="link" href="#disable_for_a_user">Disable for a user</a></h5>
<div class="paragraph">
<p>On Windows, this command disables the Daemon for the current user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">(if not exist "%USERPROFILE%/.gradle" mkdir "%USERPROFILE%/.gradle") &amp;&amp; (echo. &gt;&gt; "%USERPROFILE%/.gradle/gradle.properties" &amp;&amp; echo org.gradle.daemon=false &gt;&gt; "%USERPROFILE%/.gradle/gradle.properties")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On UNIX-like operating systems, the following Bash shell command disables the Daemon for the current user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir -p ~/.gradle &amp;&amp; echo "org.gradle.daemon=false" &gt;&gt; ~/.gradle/gradle.properties</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="disable_globally"><a class="anchor" href="#disable_globally"></a><a class="link" href="#disable_globally">Disable globally</a></h5>
<div class="paragraph">
<p>There are two recommended ways to disable the Daemon globally across an environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>add <code>org.gradle.daemon=false</code> to the <code>$<a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code>/gradle.properties` file</p>
</li>
<li>
<p>add the flag <code>-Dorg.gradle.daemon=false</code> to the <code>GRADLE_OPTS</code> environment variable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to make sure your JVM arguments and <code>GRADLE_OPTS</code> / <code>JAVA_OPTS</code> match if you want to completely disable the Daemon and not simply invoke a single-use one.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:stopping_an_existing_daemon"><a class="anchor" href="#sec:stopping_an_existing_daemon"></a><a class="link" href="#sec:stopping_an_existing_daemon">Stop Daemon</a></h4>
<div class="paragraph">
<p>It can be helpful to stop the Daemon when troubleshooting or debugging a failure.</p>
</div>
<div class="paragraph">
<p>Daemons automatically stop given any of the following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Available system memory is low</p>
</li>
<li>
<p>Daemon has been idle for 3 hours</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To stop running Daemon processes, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle --stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>This terminates all Daemon processes started with the same version of Gradle used to execute the command.</p>
</div>
<div class="paragraph">
<p>You can also kill Daemons manually with your operating system.
To find the PIDs for all Daemons regardless of Gradle version, see <a href="#find_all_daemons">Find Daemons</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="troubleshooting_the_daemon"><a class="anchor" href="#troubleshooting_the_daemon"></a><a class="link" href="#troubleshooting_the_daemon">Troubleshooting the Daemon</a></h4>
<div class="paragraph">
<p>The Gradle Daemon is a long-lived background process, as such, it can sometimes encounter issues.</p>
</div>
<div class="paragraph">
<p>If builds start behaving unexpectedly, try stopping and restarting the Daemon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle --stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you see a warning like: <code>Multiple Gradle daemons might be spawned because the Gradle JDK and JAVA_HOME locations are different</code>.</p>
</div>
<div class="paragraph">
<p>Gradle is telling you that it&#8217;s using more than one Java version across your environment.
This can lead to multiple daemons being started, increasing memory usage unnecessarily.</p>
</div>
<div class="paragraph">
<p>To resolve this, make sure your Java versions match across:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Your environment (<code>JAVA_HOME</code>)</p>
</li>
<li>
<p>Your build script (if using toolchains)</p>
</li>
<li>
<p>Your IDE&#8217;s configured JDK</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To check <code>JAVA_HOME</code>, run this in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo $JAVA_HOME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your project may be using a specific toolchain in your <code>build.gradle(.kts)</code> file.
Check for similar code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your build uses a toolchain, ensure it matches the <code>JAVA_HOME</code> value, or at least know they differ intentionally.
You should also check your IDE settings to make sure they match as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_daemon_jvm"><a class="anchor" href="#sec:configuring_daemon_jvm"></a><a class="link" href="#sec:configuring_daemon_jvm">Configuring the Daemon JVM</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Daemon JVM discovery and criteria are <a href="#sec:incubating_state">incubating</a> features and are subject to change in a future release.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the Gradle Daemon runs with the same JVM installation that started the build.
Gradle defaults to the current shell path and <code>JAVA_HOME</code> environment variable to locate a usable JVM.</p>
</div>
<div class="paragraph">
<p>Alternatively, a different JVM installation can be specified for the build using the <a href="#sec:gradle_configuration_properties"><code>org.gradle.java.home</code> Gradle property</a> or programmatically through the Tooling API.</p>
</div>
<div class="paragraph">
<p>Building on the <a href="#toolchains">toolchain feature</a>, you can now use declarative criteria to specify the JVM requirements for the build.</p>
</div>
<div class="paragraph">
<p>If the Daemon JVM criteria configuration is provided, it takes precedence over <code>JAVA_HOME</code> and <code>org.gradle.java.home</code>.</p>
</div>
<div class="sect4">
<h5 id="sec:daemon_jvm_criteria"><a class="anchor" href="#sec:daemon_jvm_criteria"></a><a class="link" href="#sec:daemon_jvm_criteria">Daemon JVM criteria</a></h5>
<div class="paragraph">
<p>The <em>Daemon JVM criteria</em> is controlled by the <code>updateDaemonJvm</code> task, similar to how the <a href="#customizing_wrapper">wrapper task</a> updates the wrapper properties file.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This process requires <a href="#sub:download_repositories">toolchain download repositories</a> to be configured.
See <a href="#sec:configure_provision">below</a> for details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the task runs, it creates or updates the criteria in the <code>gradle/gradle-daemon-jvm.properties</code> file.</p>
</div>
<div class="paragraph">
<p>To configure the generation, you can use command line options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew updateDaemonJvm --jvm-version=17</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or configure the task in the build script of the root project:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/daemon-jvm/customized-task">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;UpdateDaemonJvm&gt;("updateDaemonJvm") {
    languageVersion = JavaLanguageVersion.of(17)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named("updateDaemonJvm") {
    languageVersion = JavaLanguageVersion.of(17)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And then run the task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew updateDaemonJvm</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both of these actions will produce a file like the following one:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">gradle/gradle-daemon-jvm.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">#This file is generated by updateDaemonJvm
toolchainUrl.FREE_BSD.AARCH64=https\://example.com/...
toolchainUrl.FREE_BSD.X86_64=https\://example.com/...
toolchainUrl.LINUX.AARCH64=https\://example.com/...
toolchainUrl.LINUX.X86_64=https\://example.com/...
toolchainUrl.MAC_OS.AARCH64=https\://example.com/...
toolchainUrl.MAC_OS.X86_64=https\://example.com/...
toolchainUrl.UNIX.AARCH64=https\://example.com/...
toolchainUrl.UNIX.X86_64=https\://example.com/...
toolchainUrl.WINDOWS.X86_64=https\://example.com/...
toolchainVersion=17</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you run the <code>updateDaemonJvm</code> task without any arguments, and the properties file does not exist, then the version of the current JVM used by the Daemon will be used.</p>
</div>
<div class="paragraph">
<p>On the next execution of the build, the Gradle client will use this file to locate a compatible JVM installation and start the Daemon with it.</p>
</div>
<div class="paragraph">
<p>Similar to the wrapper, the generated <code>gradle-daemon-jvm.properties</code> file should be checked into version control.
This ensures that any developer or CI server running the build will use the same JVM version.</p>
</div>
<div class="sect5">
<h6 id="sec:specifying_a_jvm_vendor"><a class="anchor" href="#sec:specifying_a_jvm_vendor"></a><a class="link" href="#sec:specifying_a_jvm_vendor">Specifying a JVM vendor</a></h6>
<div class="paragraph">
<p>The JVM vendor, like the JVM version, can be used as a criteria to select a compatible JVM installation for the build.
If no vendor is specified, Gradle considers all vendors compatible.</p>
</div>
<div class="paragraph">
<p>By default, running <code>updateDaemonJvm</code> to create the <code>gradle-daemon-jvm.properties</code> file will not generate a JVM vendor criteria.
To specify a vendor, either configure it in the build script, using <a href="#sec:vendors">the same syntax as the Java toolchain spec</a>, or pass it on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew updateDaemonJvm --jvm-version=17 --jvm-vendor=adoptium</code></pre>
</div>
</div>
<div class="paragraph">
<p>List of recognized vendors:</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Known Vendors</th>
<th class="tableblock halign-left valign-top">Acceptable Strings</th>
<th class="tableblock halign-left valign-top"><code>toolchainVendor</code> Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adoptium / Eclipse Temurin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adoptium</code>, <code>temurin</code>, <code>eclipse foundation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADOPTIUM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdoptOpenJDK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adoptopenjdk</code>, <code>aoj</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADOPTOPENJDK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon Corretto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>amazon</code>, <code>corretto</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMAZON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apple</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APPLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Azul Zulu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>azul</code>, <code>zulu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AZUL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BellSoft</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bellsoft</code>, <code>liberica</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BELLSOFT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GraalVM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>graalvm</code>, <code>graal vm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GRAAL_VM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hewlett Packard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hp</code>, <code>hewlett</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HEWLETT_PACKARD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ibm</code>, <code>semeru</code>, <code>international business machines corporation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IBM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JetBrains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jetbrains</code>, <code>jbr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JETBRAINS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>microsoft</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MICROSOFT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>oracle</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ORACLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tencent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tencent</code>, <code>kona</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TENCENT</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some vendors will be recognized from more than one set of characters.
All vendor strings are case-insensitive.
You can view the list of recognized vendors by running <code>./gradlew help --task updateDaemonJvm</code>.</p>
</div>
<div class="paragraph">
<p>If the specified vendor is not one of the recognized equivalents, Gradle will match it exactly.
For example, "MyCustomJVM" would require an exact match of the vendor name.</p>
</div>
</div>
<div class="sect5">
<h6 id="sec:native_image"><a class="anchor" href="#sec:native_image"></a><a class="link" href="#sec:native_image">Requesting a native-image capable JDK</a></h6>
<div class="paragraph">
<p>Both the CLI options and the task configuration allow to request a JDK that is <code>native-image</code> capable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew updateDaemonJvm --jvm-version=17 --native-image-capable</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#sec:native_graalvm_image">toolchain documentation section</a> for more information.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:detect_provision"><a class="anchor" href="#sec:detect_provision"></a><a class="link" href="#sec:detect_provision">Auto-detection and auto-provisioning</a></h5>
<div class="paragraph">
<p>The Daemon JVM is <em>auto-detected</em> using the same logic as <a href="#sec:auto_detection">project JVM toolchains</a>.</p>
</div>
<div class="paragraph">
<p>With <em>auto-provisioning</em>, the logic is simpler, as Gradle can only look up a download URL matching the platform inside the <code>gradle-daemon-jvm.properties</code> file.
The URL is then used to download a JDK if none can be found locally.</p>
</div>
<div class="paragraph">
<p>The properties used for disabling <em>auto-detection</em> and <em>auto-provisioning</em> affect the Daemon toolchain resolution logic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.java.installations.auto-detect=false
org.gradle.java.installations.auto-download=false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:configure_provision"><a class="anchor" href="#sec:configure_provision"></a><a class="link" href="#sec:configure_provision">Configuring provisioning URLs</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There are currently no CLI options for configuring this.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the <code>updateDaemonJvm</code> task attempts to generate download URLs for JDKs on various platforms (OS and architecture) that match the specified criteria.
Gradle needs to consider more than the current running platform as the build could be run on different platforms.</p>
</div>
<div class="paragraph">
<p>Gradle sets, by convention, build platforms based on architectures <code>X86_64</code> and <code>AARCH64</code> for the following operating systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.freebsd.org/">FreeBSD</a></p>
</li>
<li>
<p><a href="https://www.linux.org/pages/download/">Linux</a></p>
</li>
<li>
<p><a href="https://www.apple.com/macos">macOS</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/solaris">Solaris</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/List_of_Unix_systems">UNIX</a></p>
</li>
<li>
<p><a href="https://www.microsoft.com/en-us/windows">Windows</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These platforms can be configured through the <code>toolchainPlatforms</code> property of the <code>UpdateDaemonJvm</code> task.</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/daemon-jvm/customized-task">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;UpdateDaemonJvm&gt;("updateDaemonJvm") {
    val myPlatforms = mutableListOf(
        BuildPlatformFactory.of(
            org.gradle.platform.Architecture.AARCH64,
            org.gradle.platform.OperatingSystem.MAC_OS
        )
    )
    toolchainPlatforms.set(myPlatforms)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named("updateDaemonJvm") {
    def myPlatforms = [
        BuildPlatformFactory.of(
            org.gradle.platform.Architecture.AARCH64,
            org.gradle.platform.OperatingSystem.MAC_OS
        )
    ]
    toolchainPlatforms.set(myPlatforms)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle resolves JDK download URLs for these platforms by using the <a href="#sub:download_repositories">configured toolchain download repositories</a>.
If no such repositories are configured and the <code>toolchainPlatforms</code> property has at least one value, the <code>updateDaemonJvm</code> task will fail.</p>
</div>
<div class="paragraph">
<p>Alternatively, users can directly configure the JDK URLs for specific platforms using the <code>toolchainDownloadUrls</code> property.
This property is a <code>Map&lt;BuildPlatform, URI&gt;</code> and can be configured as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;UpdateDaemonJvm&gt;("updateDaemonJvm") {
    toolchainDownloadUrls = mapOf(
        BuildPlatformFactory.of(org.gradle.platform.Architecture.AARCH64, org.gradle.platform.OperatingSystem.MAC_OS) to uri("https://server?platform=MAC_OS.AARCH64"),
        BuildPlatformFactory.of(org.gradle.platform.Architecture.AARCH64, org.gradle.platform.OperatingSystem.WINDOWS) to uri("https://server?platform=WINDOWS.AARCH64")
    )
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named("updateDaemonJvm") {
    toolchainDownloadUrls = [(BuildPlatformFactory.of(org.gradle.platform.Architecture.AARCH64, org.gradle.platform.OperatingSystem.MAC_OS)) : uri("https://server?platform=MAC_OS.AARCH64"),
                             (BuildPlatformFactory.of(org.gradle.platform.Architecture.AARCH64, org.gradle.platform.OperatingSystem.WINDOWS)) : uri("https://server?platform=WINDOWS.AARCH64")]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A full package name is required for <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/platform/Architecture.html"><code>org.gradle.platform.Architecture</code></a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/platform/OperatingSystem.html"><code>org.gradle.platform.OperatingSystem</code></a> due to a naming conflict with other types in different packages, which are resolved first alphabetically.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Running <code>./gradlew updateDaemonJvm</code> produces the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">gradle/gradle-daemon-jvm.properties</div>
<div class="content">
<pre>#This file is generated by updateDaemonJvm
toolchainUrl.MAC_OS.AARCH64=https\://server?platform\=MAC_OS.AARCH64
toolchainUrl.WINDOWS.AARCH64=https\://server?platform\=WINDOWS.AARCH64
toolchainVersion=17</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you want to disable the generation of URLs by the <code>updateDaemonJvm</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;UpdateDaemonJvm&gt;("updateDaemonJvm") {
    toolchainDownloadUrls.empty()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named("updateDaemonJvm") {
    toolchainPlatforms = []
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Removing all platforms means that there is no longer a need for the <a href="#sub:download_repositories">toolchain download repositories</a> to be configured.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:tools_and_ides"><a class="anchor" href="#sec:tools_and_ides"></a><a class="link" href="#sec:tools_and_ides">Tools &amp; IDEs</a></h4>
<div class="paragraph">
<p>The <a href="#embedding">Gradle Tooling API</a> used by IDEs and other tools to integrate with Gradle <em>always</em> uses the Gradle Daemon to execute builds.
If you execute Gradle builds from within your IDE, you already use the Gradle Daemon.
There is no need to enable it for your environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="continuous_integration"><a class="anchor" href="#continuous_integration"></a><a class="link" href="#continuous_integration">Continuous Integration</a></h4>
<div class="paragraph">
<p>We recommend using the Daemon for developer machines and Continuous Integration (CI) servers.</p>
</div>
</div>
<div class="sect3">
<h4 id="deamon_compatibility"><a class="anchor" href="#deamon_compatibility"></a><a class="link" href="#deamon_compatibility">Compatibility</a></h4>
<div class="paragraph">
<p>Gradle starts a new Daemon if no idle or compatible Daemons exist.</p>
</div>
<div class="paragraph">
<p>The following values determine compatibility:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Requested build environment</strong>, including the following:</p>
<div class="ulist">
<ul>
<li>
<p>Java version</p>
</li>
<li>
<p>JVM attributes</p>
</li>
<li>
<p>JVM properties</p>
</li>
</ul>
</div>
</li>
<li>
<p>Gradle version</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Compatibility is based on exact matches of these values.
For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a Daemon is available with a Java 8 runtime, but the requested build environment calls for Java 10,
then the Daemon is not compatible.</p>
</li>
<li>
<p>If a Daemon is available running Gradle 7.0, but the current build uses Gradle 7.4, then the
Daemon is not compatible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain properties of a Java runtime are <em>immutable</em>: they cannot be changed once the JVM has started.
The following JVM system properties are immutable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>file.encoding</code></p>
</li>
<li>
<p><code>user.language</code></p>
</li>
<li>
<p><code>user.country</code></p>
</li>
<li>
<p><code>user.variant</code></p>
</li>
<li>
<p><code>java.io.tmpdir</code></p>
</li>
<li>
<p><code>javax.net.ssl.keyStore</code></p>
</li>
<li>
<p><code>javax.net.ssl.keyStorePassword</code></p>
</li>
<li>
<p><code>javax.net.ssl.keyStoreType</code></p>
</li>
<li>
<p><code>javax.net.ssl.trustStore</code></p>
</li>
<li>
<p><code>javax.net.ssl.trustStorePassword</code></p>
</li>
<li>
<p><code>javax.net.ssl.trustStoreType</code></p>
</li>
<li>
<p><code>com.sun.management.jmxremote</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following JVM attributes controlled by startup arguments are also immutable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The maximum heap size (the <code>-Xmx</code> JVM argument)</p>
</li>
<li>
<p>The minimum heap size (the <code>-Xms</code> JVM argument)</p>
</li>
<li>
<p>The boot classpath (the <code>-Xbootclasspath</code> argument)</p>
</li>
<li>
<p>The "assertion" status (the <code>-ea</code> argument)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the requested build environment requirements for any of these properties and attributes
differ from the Daemon&#8217;s JVM requirements, the Daemon is not compatible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For more information about build environments, see <a href="#build_environment">the build environment documentation</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:why_the_daemon"><a class="anchor" href="#sec:why_the_daemon"></a><a class="link" href="#sec:why_the_daemon">Performance Impact</a></h4>
<div class="paragraph">
<p>The Daemon can reduce build times by 15-75% when you build the same project repeatedly.</p>
</div>
<div class="paragraph">
<p>In between builds, the Daemon waits idly for the next build.
As a result, your machine only loads Gradle into memory once for multiple builds instead of once per build.
This is a significant performance optimization.</p>
</div>
<div class="sect4">
<h5 id="runtime_code_optimizations"><a class="anchor" href="#runtime_code_optimizations"></a><a class="link" href="#runtime_code_optimizations">Runtime Code Optimizations</a></h5>
<div class="paragraph">
<p>The JVM gains significant performance from <strong>runtime code optimization</strong>: optimizations applied to code while it runs.</p>
</div>
<div class="paragraph">
<p>JVM implementations like OpenJDK&#8217;s Hotspot progressively optimize code during execution.
Consequently, subsequent builds can be faster purely due to this optimization process.</p>
</div>
<div class="paragraph">
<p>With the Daemon, perceived build times can drop dramatically between a project&#8217;s 1<sup>st</sup> and 10<sup>th</sup> builds.</p>
</div>
</div>
<div class="sect4">
<h5 id="memory_caching"><a class="anchor" href="#memory_caching"></a><a class="link" href="#memory_caching">Memory Caching</a></h5>
<div class="paragraph">
<p>The Daemon enables in-memory caching across builds.
This includes classes for plugins and build scripts.</p>
</div>
<div class="paragraph">
<p>Similarly, the Daemon maintains in-memory caches of build data, such as the hashes of task inputs and outputs for incremental builds.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="performance_monitoring"><a class="anchor" href="#performance_monitoring"></a><a class="link" href="#performance_monitoring">Performance Monitoring</a></h4>
<div class="paragraph">
<p>Gradle actively monitors heap usage to detect memory leaks in the Daemon.</p>
</div>
<div class="paragraph">
<p>When a memory leak exhausts available heap space, the Daemon:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Finishes the currently running build.</p>
</li>
<li>
<p>Restarts before running the next build.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle enables this monitoring by default.</p>
</div>
<div class="paragraph">
<p>To disable this monitoring, set the <code>org.gradle.daemon.performance.enable-monitoring</code> Daemon option to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>You can do this on the command line with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; -Dorg.gradle.daemon.performance.enable-monitoring=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can configure the property in the <code>gradle.properties</code> file in the <a href="#dir:project_root">project root</a> or your <a href="#dir:gradle_user_home">GRADLE_USER_HOME</a> (Gradle User Home):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.daemon.performance.enable-monitoring=false</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="directory_layout"><a class="anchor" href="#directory_layout"></a><a class="link" href="#directory_layout">Gradle-managed Directories</a></h3>
<div class="paragraph">
<p>Gradle uses two main directories to perform and manage its work:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#dir:gradle_user_home">1. Gradle User Home directory</a></p>
</li>
<li>
<p><a href="#dir:project_root">2. Project Root directory</a></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="img/author-gradle-2.png" alt="author gradle 2">
</div>
</div>
<div class="sect3">
<h4 id="dir:gradle_user_home"><a class="anchor" href="#dir:gradle_user_home"></a><a class="link" href="#dir:gradle_user_home">1. Gradle User Home directory</a></h4>
<div class="paragraph">
<p>By default, the Gradle User Home (<code>~/.gradle</code> or <code>C:\Users\&lt;USERNAME&gt;\.gradle</code>) stores global configuration properties, initialization scripts, caches, and log files.</p>
</div>
<div class="paragraph">
<p>It can be set with the environment variable <code>GRADLE_USER_HOME</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Not to be confused with the <code>GRADLE_HOME</code>, the optional installation directory for Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is roughly structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> caches              // <b class="conum">(1)</b>
    4.8         // <b class="conum">(2)</b>
    4.9             // <b class="conum">(2)</b>
    
    jars-3      // <b class="conum">(3)</b>
    modules-2       // <b class="conum">(3)</b>
 daemon          // <b class="conum">(4)</b>
    
    4.8
    4.9
 init.d              // <b class="conum">(5)</b>
    my-setup.gradle
 jdks                // <b class="conum">(6)</b>
    
    jdk-14.0.2+12
 wrapper
    dists           // <b class="conum">(7)</b>
        
        gradle-4.8-bin
        gradle-4.9-all
        gradle-4.9-bin
 gradle.properties   // <b class="conum">(8)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Global cache directory (for everything that is not project-specific).</p>
</li>
<li>
<p>Version-specific caches (e.g., to support incremental builds).</p>
</li>
<li>
<p>Shared caches (e.g., for artifacts of dependencies).</p>
</li>
<li>
<p>Registry and logs of the <a href="#gradle_daemon">Gradle Daemon</a>.</p>
</li>
<li>
<p>Global <a href="#init_scripts">initialization scripts</a>.</p>
</li>
<li>
<p>JDKs downloaded by the <a href="#sec:provisioning">toolchain support</a>.</p>
</li>
<li>
<p>Distributions downloaded by the <a href="#gradle_wrapper">Gradle Wrapper</a>.</p>
</li>
<li>
<p>Global <a href="#sec:gradle_configuration_properties">Gradle configuration properties</a>.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="dir:gradle_user_home:cache_cleanup"><a class="anchor" href="#dir:gradle_user_home:cache_cleanup"></a><a class="link" href="#dir:gradle_user_home:cache_cleanup">Cleanup of caches and distributions</a></h5>
<div class="paragraph">
<p>Gradle automatically cleans its user home directory.</p>
</div>
<div class="paragraph">
<p>By default, the cleanup runs in the background when the Gradle daemon is stopped or shut down.</p>
</div>
<div class="paragraph">
<p>If using <code>--no-daemon</code>, it runs in the foreground after the build session.</p>
</div>
<div class="paragraph">
<p>The following cleanup strategies are applied periodically (by default, once every 24 hours):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version-specific caches in all <code>caches/&lt;GRADLE_VERSION&gt;/</code> directories are checked for whether they are still in use.</p>
<div class="paragraph">
<p>If not, directories for release versions are deleted after 30 days of inactivity, and snapshot versions after 7 days.</p>
</div>
</li>
<li>
<p>Shared caches in <code>caches/</code> (e.g., <code>jars-*</code>) are checked for whether they are still in use.</p>
<div class="paragraph">
<p>If no Gradle version still uses them, they are deleted.</p>
</div>
</li>
<li>
<p>Files in shared caches used by the current Gradle version in <code>caches/</code> (e.g., <code>jars-3</code> or <code>modules-2</code>) are checked for when they were last accessed.</p>
<div class="paragraph">
<p>Depending on whether the file can be recreated locally or downloaded from a remote repository, it will be deleted after 7 or 30 days, respectively.</p>
</div>
</li>
<li>
<p>Gradle distributions in <code>wrapper/dists/</code> are checked for whether they are still in use, i.e., whether there&#8217;s a corresponding version-specific cache directory.</p>
<div class="paragraph">
<p>Unused distributions are deleted.</p>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="dir:gradle_user_home:configure_cache_cleanup"><a class="anchor" href="#dir:gradle_user_home:configure_cache_cleanup"></a><a class="link" href="#dir:gradle_user_home:configure_cache_cleanup">Configuring cleanup of caches and distributions</a></h6>
<div class="paragraph">
<p>The retention periods of the various caches can be configured.</p>
</div>
<div class="paragraph">
<p>Caches are classified into five categories:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Released wrapper distributions:</strong> Distributions and related version-specific caches corresponding to released versions (e.g., <code>4.6.2</code> or <code>8.0</code>).</p>
<div class="paragraph">
<p>Default retention for unused versions is 30 days.</p>
</div>
</li>
<li>
<p><strong>Snapshot wrapper distributions:</strong> Distributions and related version-specific caches corresponding to snapshot versions (e.g. <code>7.6-20221130141522+0000</code>).</p>
<div class="paragraph">
<p>Default retention for unused versions is 7 days.</p>
</div>
</li>
<li>
<p><strong>Downloaded resources:</strong> Shared caches downloaded from a remote repository (e.g., cached dependencies).</p>
<div class="paragraph">
<p>Default retention for unused resources is 30 days.</p>
</div>
</li>
<li>
<p><strong>Created resources:</strong> Shared caches that Gradle creates during a build (e.g., artifact transforms).</p>
<div class="paragraph">
<p>Default retention for unused resources is 7 days.</p>
</div>
</li>
<li>
<p><strong>Build cache:</strong> The local build cache (e.g., build-cache-1).</p>
<div class="paragraph">
<p>Default retention for unused build cache entries is 7 days.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The retention period for each category can be configured independently via an <a href="#init_scripts">init script</a> in the Gradle User Home:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">beforeSettings {
    caches {
        releasedWrappers.setRemoveUnusedEntriesAfterDays(45)
        snapshotWrappers.setRemoveUnusedEntriesAfterDays(10)
        downloadedResources.setRemoveUnusedEntriesAfterDays(45)
        createdResources.setRemoveUnusedEntriesAfterDays(10)
        buildCache.setRemoveUnusedEntriesAfterDays(5)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">beforeSettings { settings -&gt;
    settings.caches {
        releasedWrappers.removeUnusedEntriesAfterDays = 45
        snapshotWrappers.removeUnusedEntriesAfterDays = 10
        downloadedResources.removeUnusedEntriesAfterDays = 45
        createdResources.removeUnusedEntriesAfterDays = 10
        buildCache.removeUnusedEntriesAfterDays = 5
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The frequency at which cache cleanup is invoked is also configurable.</p>
</div>
<div class="paragraph">
<p>There are three possible settings:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>DEFAULT:</strong> Cleanup is performed periodically in the background (currently once every 24 hours).</p>
</li>
<li>
<p><strong>DISABLED:</strong> Never cleanup Gradle User Home.</p>
<div class="paragraph">
<p>This is useful in cases where Gradle User Home is ephemeral or delaying cleanup is desirable until an explicit point.</p>
</div>
</li>
<li>
<p><strong>ALWAYS:</strong> Cleanup is performed at the end of each build session.</p>
<div class="paragraph">
<p>This is useful in cases where it&#8217;s desirable to ensure that cleanup has occurred before proceeding.</p>
</div>
<div class="paragraph">
<p>However, this performs cache cleanup during the build (rather than in the background), which can be expensive, so this option should only be used when necessary.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To disable cache cleanup:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">beforeSettings {
    caches {
        cleanup = Cleanup.DISABLED
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">beforeSettings { settings -&gt;
    settings.caches {
        cleanup = Cleanup.DISABLED
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Cache cleanup settings can only be configured via init scripts and should be placed under the <code>init.d</code> directory in Gradle User Home.
This effectively couples the configuration of cache cleanup to the Gradle User Home those settings apply to and limits the possibility of different conflicting settings from different projects being applied to the same directory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="dir:gradle_user_home:multi_version_cache_cleanup"><a class="anchor" href="#dir:gradle_user_home:multi_version_cache_cleanup"></a><a class="link" href="#dir:gradle_user_home:multi_version_cache_cleanup">Multiple versions of Gradle sharing a Gradle User Home</a></h6>
<div class="paragraph">
<p>It is common to share a single Gradle User Home between multiple versions of Gradle.</p>
</div>
<div class="paragraph">
<p>As stated above, caches in Gradle User Home are version-specific.
Different versions of Gradle will perform maintenance on only the version-specific caches associated with each version.</p>
</div>
<div class="paragraph">
<p>On the other hand, some caches are shared between versions (e.g., the dependency artifact cache or the artifact transform cache).</p>
</div>
<div class="paragraph">
<p>Beginning with Gradle version 8.0, the cache cleanup settings can be configured to custom retention periods.
However, older versions have fixed retention periods (7 or 30 days, depending on the cache).
These shared caches could be accessed by versions of Gradle with different settings to retain cache artifacts.</p>
</div>
<div class="paragraph">
<p>This means that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the retention period is <em>not</em> customized, all versions that perform cleanup will have the same retention periods. There will be no effect due to sharing a Gradle User Home with multiple versions.</p>
</li>
<li>
<p>If the retention period is customized for Gradle versions greater than or equal to version 8.0 to use retention periods <em>shorter</em> than the previously fixed periods, there will also be no effect.</p>
<div class="paragraph">
<p>The versions of Gradle aware of these settings will cleanup artifacts earlier than the previously fixed retention periods, and older versions will effectively not participate in the cleanup of shared caches.</p>
</div>
</li>
<li>
<p>If the retention period is customized for Gradle versions greater than or equal to version 8.0 to use retention periods <em>longer</em> than the previously fixed periods, the older versions of Gradle may clean the shared caches earlier than what is configured.</p>
<div class="paragraph">
<p>In this case, if it is desirable to maintain these shared cache entries for newer versions for longer retention periods, they will not be able to share a Gradle User Home with older versions. They will need to use a separate directory.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Another consideration when sharing the Gradle User Home with versions of Gradle before version 8.0 is that the DSL elements to configure the cache retention settings are unavailable in earlier versions, so this must be accounted for in any init script shared between versions.
This can easily be handled by conditionally applying a version-compliant script.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The version-compliant script should reside somewhere other than the <code>init.d</code> directory (such as a sub-directory), so it is not automatically applied.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure cache cleanup in a version-safe manner:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">if (GradleVersion.current() &gt;= GradleVersion.version("8.0")) {
    apply(from = "gradle8/cache-settings.gradle.kts")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">if (GradleVersion.current() &gt;= GradleVersion.version('8.0')) {
    apply from: "gradle8/cache-settings.gradle"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Version-compliant cache configuration script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/gradle8/cache-settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">beforeSettings {
    caches {
        releasedWrappers { setRemoveUnusedEntriesAfterDays(45) }
        snapshotWrappers { setRemoveUnusedEntriesAfterDays(10) }
        downloadedResources { setRemoveUnusedEntriesAfterDays(45) }
        createdResources { setRemoveUnusedEntriesAfterDays(10) }
        buildCache { setRemoveUnusedEntriesAfterDays(5) }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/gradle8/cache-settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">beforeSettings { settings -&gt;
    settings.caches {
        releasedWrappers.removeUnusedEntriesAfterDays = 45
        snapshotWrappers.removeUnusedEntriesAfterDays = 10
        downloadedResources.removeUnusedEntriesAfterDays = 45
        createdResources.removeUnusedEntriesAfterDays = 10
        buildCache.removeUnusedEntriesAfterDays = 5
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dir:gradle_user_home:cache_marking"><a class="anchor" href="#dir:gradle_user_home:cache_marking"></a><a class="link" href="#dir:gradle_user_home:cache_marking">Cache marking</a></h5>
<div class="paragraph">
<p>Beginning with Gradle version 8.1, Gradle supports marking caches with a <code>CACHEDIR.TAG</code> file.</p>
</div>
<div class="paragraph">
<p>It follows the format described in <a href="https://bford.info/cachedir/">the Cache Directory Tagging Specification</a>.
The purpose of this file is to allow tools to identify the directories that do not need to be searched or backed up.</p>
</div>
<div class="paragraph">
<p>By default, the directories <code>caches</code>, <code>wrapper/dists</code>, <code>daemon</code>, and <code>jdks</code> in the Gradle User Home are marked with this file.</p>
</div>
<div class="sect5">
<h6 id="dir:gradle_user_home:configure_cache_marking"><a class="anchor" href="#dir:gradle_user_home:configure_cache_marking"></a><a class="link" href="#dir:gradle_user_home:configure_cache_marking">Configuring cache marking</a></h6>
<div class="paragraph">
<p>The cache marking feature can be configured via an init script in the Gradle User Home:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">beforeSettings {
    caches {
        // Disable cache marking for all caches
        markingStrategy = MarkingStrategy.NONE
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradleUserHome/init.d/cache-settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">beforeSettings { settings -&gt;
    settings.caches {
        // Disable cache marking for all caches
        markingStrategy = MarkingStrategy.NONE
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Cache marking settings can only be configured via init scripts and should be placed under the <code>init.d</code> directory in Gradle User Home. This effectively couples the configuration of cache marking to the Gradle User Home to which those settings apply and limits the possibility of different conflicting settings from different projects being applied to the same directory.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dir:project_root"><a class="anchor" href="#dir:project_root"></a><a class="link" href="#dir:project_root">2. Project Root directory</a></h4>
<div class="paragraph">
<p>The project root directory contains all source files from your project.</p>
</div>
<div class="paragraph">
<p>It also contains files and directories Gradle generates, such as <code>.gradle</code> and <code>build</code>.</p>
</div>
<div class="paragraph">
<p>While the former are usually checked into source control, the latter are transient files Gradle uses to support features like incremental builds.</p>
</div>
<div class="paragraph">
<p>The anatomy of a typical project root directory looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> .gradle                 // <b class="conum">(1)</b>
    4.8             // <b class="conum">(2)</b>
    4.9                 // <b class="conum">(2)</b>
    
 build               // <b class="conum">(3)</b>
 gradle
    wrapper             // <b class="conum">(4)</b>
 gradle.properties   // <b class="conum">(5)</b>
 gradlew                 // <b class="conum">(6)</b>
 gradlew.bat         // <b class="conum">(6)</b>
 settings.gradle.kts     // <b class="conum">(7)</b>
 subproject-one      // <b class="conum">(8)</b>
|    build.gradle.kts    // <b class="conum">(9)</b>
 subproject-two      // <b class="conum">(8)</b>
|    build.gradle.kts    // <b class="conum">(9)</b>
 </pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Project-specific cache directory generated by Gradle.</p>
</li>
<li>
<p>Version-specific caches (e.g., to support incremental builds).</p>
</li>
<li>
<p>The build directory of this project into which Gradle generates all build artifacts.</p>
</li>
<li>
<p>Contains the JAR file and configuration of the <a href="#gradle_wrapper">Gradle Wrapper</a>.</p>
</li>
<li>
<p>Project-specific <a href="#sec:gradle_configuration_properties">Gradle configuration properties</a>.</p>
</li>
<li>
<p>Scripts for executing builds using the <a href="#gradle_wrapper">Gradle Wrapper</a>.</p>
</li>
<li>
<p>The project&#8217;s <a href="settings_file_basics.html#sec:settings_file_script">settings file</a> where the list of subprojects is defined.</p>
</li>
<li>
<p>Usually, a project is organized into one or multiple subprojects.</p>
</li>
<li>
<p>Each subproject has its own Gradle build script.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="dir:project_root:cache_cleanup"><a class="anchor" href="#dir:project_root:cache_cleanup"></a><a class="link" href="#dir:project_root:cache_cleanup">Project cache cleanup</a></h5>
<div class="paragraph">
<p>From version 4.10 onwards, Gradle automatically cleans the project-specific cache directory.</p>
</div>
<div class="paragraph">
<p>After building the project, version-specific cache directories in <code>.gradle/9.1.0/</code> are checked periodically (at most, every 24 hours) to determine whether they are still in use.
They are deleted if they haven&#8217;t been used for 7 days.</p>
</div>
<div class="paragraph text-right">
<p><strong>Next Step:</strong> <a href="build_lifecycle_intermediate.html#build_lifecycle">Learn about the Gradle Build Lifecycle</a> &gt;&gt;</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_environment"><a class="anchor" href="#build_environment"></a><a class="link" href="#build_environment">Build Environment Configuration</a></h3>
<div class="paragraph">
<p>Configuring the build environment is a powerful way to customize the build process.
There are many mechanisms available.
By leveraging these mechanisms, you can make your Gradle builds more flexible and adaptable to different environments and requirements.</p>
</div>
<div class="sect3">
<h4 id="available_mechanisms"><a class="anchor" href="#available_mechanisms"></a><a class="link" href="#available_mechanisms">Available mechanisms</a></h4>
<div class="paragraph">
<p>Gradle provides multiple mechanisms for configuring the behavior of Gradle itself and specific projects:</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mechanism</th>
<th class="tableblock halign-left valign-top">Information</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#command_line_interface">Command line interface</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flags that configure build behavior and Gradle features</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--rerun</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:project_properties">Project properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties specific to your Gradle project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TestFilter::isFailOnNoMatchingTests=false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_system_properties">System properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties that are passed to the Gradle runtime (JVM)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http.proxyHost=somehost.org</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_configuration_properties">Gradle properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties that configure Gradle settings and the Java process that executes your build</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.logging.level=quiet</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_environment_variables">Environment variables</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties that configure build behavior based on the environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JAVA_HOME</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="priority_for_configurations"><a class="anchor" href="#priority_for_configurations"></a><a class="link" href="#priority_for_configurations">Priority for configurations</a></h4>
<div class="paragraph">
<p>When configuring Gradle behavior, you can use these methods, but you must consider their priority.</p>
</div>
<div class="paragraph">
<p>Gradle reads <code>gradle.properties</code> configurations in the following order (highest precedence first):</p>
</div>
<table class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#command_line_interface">Command-line</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; Command line</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flags have precedence over properties and environment variables</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_system_properties">System properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; Project Root Dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in a <code>gradle.properties</code> file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_configuration_properties">Gradle properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; <code>GRADLE_USER_HOME</code><br>
&gt; Project Root Dir<br>
&gt; <code>GRADLE_HOME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in a <code>gradle.properties</code> file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gradle_environment_variables">Environment variables</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; Environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sourced by the environment that executes Gradle</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here are all possible configurations of specifying the JDK installation directory in order of priority:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Command Line</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew exampleTask -Dorg.gradle.java.home=/path/to/your/java/home --scan</code></pre>
</div>
</div>
</li>
<li>
<p>Gradle Properties File</p>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">org.gradle.java.home=/path/to/your/java/home</code></pre>
</div>
</div>
</li>
<li>
<p>Environment Variable</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ export JAVA_HOME=/path/to/your/java/home</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="the_gradle_properties_file"><a class="anchor" href="#the_gradle_properties_file"></a><a class="link" href="#the_gradle_properties_file">The <code>gradle.properties</code> file</a></h4>
<div class="paragraph">
<p>Gradle properties, system properties, and project properties can be found in the <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Gradle properties
org.gradle.parallel=true
org.gradle.caching=true
org.gradle.jvmargs=-Duser.language=en -Duser.country=US -Dfile.encoding=UTF-8

# System properties
systemProp.pts.enabled=true
systemProp.log4j2.disableJmx=true
systemProp.file.encoding = UTF-8

# Project properties
kotlin.code.style=official
android.nonTransitiveRClass=false
spring-boot.version = 2.2.1.RELEASE</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can place the <code>gradle.properties</code> file in the root directory of your project, the Gradle user home directory (<code>GRADLE_USER_HOME</code>), or the directory where Gradle is optionally installed (<code>GRADLE_HOME</code>).</p>
</div>
<div class="paragraph">
<p>When resolving properties, Gradle first looks in the user-level <code>gradle.properties</code> file located in <code>GRADLE_USER_HOME</code>, then in the project-level <code>gradle.properties</code> file, and finally in the <code>gradle.properties</code> file located in <code>GRADLE_HOME</code>, with user-level properties taking precedence over project-level and installation-level properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:project_properties"><a class="anchor" href="#sec:project_properties"></a><a class="link" href="#sec:project_properties">Project properties</a></h4>
<div class="paragraph">
<p>Project properties are specific to your Gradle project, they can be used to customize your build.
Project properties can be accessed in your build files and get passed in from an external source when your build is executed.
Project properties can be retrieved in build scripts <a href="glossary.html#sub:terminology_lazy">lazily</a> using <code>providers.gradleProperty()</code>.</p>
</div>
<div class="sect4">
<h5 id="setting_a_project_property"><a class="anchor" href="#setting_a_project_property"></a><a class="link" href="#setting_a_project_property">Setting a project property</a></h5>
<div class="paragraph">
<p>You have four options to add project properties, listed in order of priority:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Command Line:</strong> You can add project properties directly to your <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a> object via the <code>-P</code> command line option.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew build -PmyProperty='Hi, world'</code></pre>
</div>
</div>
</li>
<li>
<p><strong>System Property:</strong> Gradle creates specially-named system properties for project properties which you can set using the <code>-D</code> command line flag or <code>gradle.properties</code> file. For the project property <code>myProperty</code>, the system property created is called <code>org.gradle.project.<em>myProperty</em></code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew build -Dorg.gradle.project.myProperty='Hi, world'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.project.myProperty='Hi, world'</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Gradle Properties File:</strong> You can also set project properties in <code>gradle.properties</code> files.</p>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">myProperty='Hi, world'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>gradle.properties</code> file can be located in a number of places, including <code>&lt;GRADLE_USER_HOME&gt;/gradle.properties</code>, <code>./gradle.properties</code> (the project root) and <code>&lt;GRADLE_HOME&gt;/gradle.properties</code>.</p>
</div>
<div class="paragraph">
<p>If the same property is defined in multiple locations, the files location determines its <a href="#priority-table-gradle-properties">precedence</a>.</p>
</div>
</li>
<li>
<p><strong>Environment Variables:</strong> You can set project properties with environment variables. If the environment variable name looks like <code>ORG_GRADLE_PROJECT<em>_myProperty</em>='Hi, world'</code>, then Gradle will set a <code>myProperty</code> property on your project object, with the value of <code>Hi, world</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ export ORG_GRADLE_PROJECT_myProperty='Hi, world'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is typically the preferred method for supplying project properties, especially secrets, to unattended builds like those running on CI servers.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is possible to change the behavior of a task based on project properties specified at invocation time.
Suppose youd like to ensure release builds are only triggered by CI.
A simple way to handle this is through an <code>isCI</code> project property:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/tutorial/configureTaskUsingProjectProperty">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("performRelease") {
    val isCI = providers.gradleProperty("isCI")
    doLast {
        if (isCI.isPresent) {
            println("Performing release actions")
        } else {
            throw InvalidUserDataException("Cannot perform release outside of CI")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('performRelease') {
    def isCI = providers.gradleProperty("isCI")
    doLast {
        if (isCI.present) {
            println("Performing release actions")
        } else {
            throw new InvalidUserDataException("Cannot perform release outside of CI")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew performRelease -PisCI=true --quiet
Performing release actions</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that running <code>./gradlew performRelease</code> yields the same results as long as your <code>gradle.properties</code> file includes <code>isCI=true</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">isCI=true</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew performRelease --quiet
Performing release actions</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_command_line_flags"><a class="anchor" href="#sec:gradle_command_line_flags"></a><a class="link" href="#sec:gradle_command_line_flags">Command-line flags</a></h4>
<div class="paragraph">
<p>The command line interface and the available flags are described in <a href="#command_line_interface">its own section</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_system_properties"><a class="anchor" href="#sec:gradle_system_properties"></a><a class="link" href="#sec:gradle_system_properties">System properties</a></h4>
<div class="paragraph">
<p>System properties are variables set at the JVM level and accessible to the Gradle build process.
System properties can be retrieved in build scripts <a href="glossary.html#sub:terminology_lazy">lazily</a> using <code>providers.systemProperty()</code>.</p>
</div>
<div class="sect4">
<h5 id="setting_a_system_property"><a class="anchor" href="#setting_a_system_property"></a><a class="link" href="#setting_a_system_property">Setting a system property</a></h5>
<div class="paragraph">
<p>You have two options to add system properties listed in order of priority:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Command Line:</strong> Using the <code>-D</code> command-line option, you can pass a system property to the JVM, which runs Gradle.
The <code>-D</code> option of the <code>gradle</code> command has the same effect as the <code>-D</code> option of the <code>java</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew build -Dgradle.wrapperUser=myuser</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Gradle Properties File:</strong> You can also set system properties in <code>gradle.properties</code> files with the prefix <code>systemProp</code>.</p>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">systemProp.gradle.wrapperUser=myuser</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="system_properties_reference"><a class="anchor" href="#system_properties_reference"></a><a class="link" href="#system_properties_reference">System properties reference</a></h5>
<div class="paragraph">
<p>For a quick reference, the following are <em>common</em> system properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gradle.wrapperUser=(myuser)</code></dt>
<dd>
<p>Specify username to download Gradle distributions <a href="#sec:authenticated_download">from servers using HTTP Basic Authentication</a>.</p>
</dd>
<dt class="hdlist1"><code>gradle.wrapperPassword=(mypassword)</code></dt>
<dd>
<p>Specify password for downloading a Gradle distribution using the Gradle wrapper.</p>
</dd>
<dt class="hdlist1"><code>gradle.user.home=(path to directory)</code></dt>
<dd>
<p>Specify the <code>GRADLE_USER_HOME</code> directory.</p>
</dd>
<dt class="hdlist1"><code>https.protocols</code></dt>
<dd>
<p>Specify the supported TLS versions in a comma-separated format. e.g., <code>TLSv1.2,TLSv1.3</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Additional Java system properties are listed <a href="https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html">here</a>.</p>
</div>
<div class="paragraph">
<p>In a multi-project build, <code>systemProp</code> properties set in any project except the root will be <strong>ignored</strong>.
Only the root project&#8217;s <code>gradle.properties</code> file will be checked for properties that begin with <code>systemProp</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_configuration_properties"><a class="anchor" href="#sec:gradle_configuration_properties"></a><a class="link" href="#sec:gradle_configuration_properties">Gradle properties</a></h4>
<div class="paragraph">
<p>Gradle properties configure Gradle itself and usually have the name <code>org.gradle.*</code>.
Gradle properties should not be used in build logic, their values should not be read/retrieved in build scripts.</p>
</div>
<div class="sect4">
<h5 id="setting_a_gradle_property"><a class="anchor" href="#setting_a_gradle_property"></a><a class="link" href="#setting_a_gradle_property">Setting a Gradle property</a></h5>
<div class="paragraph">
<p>You have two options to add Gradle properties listed in order of priority:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Command Line:</strong> Using the <code>-D</code> command-line option, you can pass a Gradle property:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew build -Dorg.gradle.caching.debug=false</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Gradle Properties File:</strong> Place these settings into a <code>gradle.properties</code> file and commit it to your version control system.</p>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.caching.debug=false</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The final configuration considered by Gradle is a combination of all Gradle properties set on the command line and your <code>gradle.properties</code> files.
If an option is configured in multiple locations, the <em>first one</em> found in any of these locations wins:</p>
</div>
<table id="priority-table-gradle-properties" class="tableblock frame-all grid-all fit-content stretch">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command line interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In the command line using <code>-D</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradle.properties</code> file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GRADLE_USER_HOME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in a <code>gradle.properties</code> file in the <code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradle.properties</code> file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project Root Dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in a <code>gradle.properties</code> file in a project directory, then its parent projects directory up to the projects root directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradle.properties</code> file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GRADLE_HOME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in a <code>gradle.properties</code> file in the <code><a href="#sec:gradle_environment_variables">GRADLE_HOME</a></code>, the optional Gradle installation directory.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The location of the <code>GRADLE_USER_HOME</code> may have been changed beforehand via the <code>-Dgradle.user.home</code> system property passed on the command line.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="gradle_properties_reference"><a class="anchor" href="#gradle_properties_reference"></a><a class="link" href="#gradle_properties_reference">Gradle properties reference</a></h5>
<div class="paragraph">
<p>For reference, the following properties are common Gradle properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.caching=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code>, Gradle will reuse task outputs from any previous build when possible, <a href="#build_cache">resulting in much faster builds</a>.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>; the build cache is <strong>not</strong> enabled.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.caching.debug=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code>, individual input property hashes and the build cache key for each task are <a href="#sec:task_output_caching">logged on the console</a>.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.configuration-cache=(true,false)</code></dt>
<dd>
<p>Enables <a href="#config_cache:usage:enable">configuration caching</a>. Gradle will try to reuse the build configuration from previous builds.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.configureondemand=(true,false)</code></dt>
<dd>
<p>Enables incubating configuration-on-demand, where Gradle will attempt to configure only necessary projects.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.console=(auto,plain,colored,rich,verbose)</code></dt>
<dd>
<p>Customize <a href="#sec:command_line_logging">console output</a> coloring or verbosity.</p>
<div class="paragraph">
<p><em>Default depends on how Gradle is invoked.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.continue=(true,false)</code></dt>
<dd>
<p>If enabled, continue task execution after a task failure, else stop task execution after a task failure.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.daemon=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code> the <a href="#gradle_daemon">Gradle Daemon</a> is used to run the build.</p>
<div class="paragraph">
<p><em>Default is <code>true</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.daemon.idletimeout=(# of idle millis)</code></dt>
<dd>
<p>Gradle Daemon will terminate itself after a specified number of idle milliseconds.</p>
<div class="paragraph">
<p><em>Default is <code>10800000</code> (3 hours).</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.debug=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code>, Gradle will run the build with remote debugging enabled, listening on port 5005.
Note that this is equivalent to adding <code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005</code> to the JVM command line and will suspend the virtual machine until a debugger is attached.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.java.home=(path to JDK home)</code></dt>
<dd>
<p>Specifies the Java home for the Gradle build process.
The value can be set to either a <code>jdk</code> or <code>jre</code> location; however, using a JDK is safer depending on what your build does.
This does not affect the version of Java used to launch the <a href="#sec:gradle_environment_variables">Gradle client VM</a>.</p>
<div class="paragraph">
<p>You can also control the JVM used to run Gradle itself using the <a href="#sec:daemon_jvm_criteria">Daemon JVM criteria</a>.</p>
</div>
<div class="paragraph">
<p><em>Default is derived from your environment (<code>JAVA_HOME</code> or the path to <code>java</code>) if the setting is unspecified.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.jvmargs=(JVM arguments)</code></dt>
<dd>
<p>Specifies the JVM arguments used for the Gradle Daemon.
The setting is particularly useful for <a href="config_gradle.html#sec:configuring_jvm_memory">configuring JVM memory settings</a> for build performance.
This does not affect the JVM settings for the Gradle client VM.</p>
<div class="paragraph">
<p><em>Default is <code>-Xmx512m "-XX:MaxMetaspaceSize=384m"</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</code></dt>
<dd>
<p>When set to quiet, warn, info, or debug, Gradle will use this <a href="#sec:choosing_a_log_level">log level</a>.
The values are not case-sensitive.</p>
<div class="paragraph">
<p><em>Default is <code>lifecycle</code> level.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.parallel=(true,false)</code></dt>
<dd>
<p>When configured, Gradle will fork up to <code>org.gradle.workers.max</code> JVMs to execute <a href="#sec:enable_parallel_execution">projects in parallel</a>.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.priority=(low,normal)</code></dt>
<dd>
<p>Specifies the <a href="#sec:command_line_performance">scheduling priority</a> for the Gradle daemon and all processes launched by it.</p>
<div class="paragraph">
<p><em>Default is <code>normal</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.projectcachedir=(directory)</code></dt>
<dd>
<p>Specify the project-specific cache directory. Defaults to <code>.gradle</code> in the root project directory."</p>
<div class="paragraph">
<p><em>Default is <code>.gradle</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.problems.report=(true|false)</code></dt>
<dd>
<p>Enable (<code>true</code>) or disable (<code>false</code>) the generation of <code>build/reports/problems-report.html</code>. <code>true</code> is the default.
The report is generated with problems provided to the <a href="#sec:reporting_problems">Problems API</a>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.unsafe.isolated-projects=(true,false)</code></dt>
<dd>
<p>Enables project isolation, which enables configuration caching.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.vfs.verbose=(true,false)</code></dt>
<dd>
<p>Configures verbose logging when <a href="#sec:daemon_watch_fs">watching the file system</a>.</p>
<div class="paragraph">
<p><em>Default is <code>false</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.vfs.watch=(true,false)</code></dt>
<dd>
<p>Toggles <a href="#sec:daemon_watch_fs">watching the file system</a>.
When enabled, Gradle reuses information it collects about the file system between builds.</p>
<div class="paragraph">
<p><em>Default is <code>true</code> on operating systems where Gradle supports this feature.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.warning.mode=(all,fail,summary,none)</code></dt>
<dd>
<p>When set to <code>all</code>, <code>summary</code>, or <code>none</code>, Gradle will use <a href="#sec:command_line_logging">different warning type display</a>.</p>
<div class="paragraph">
<p><em>Default is <code>summary</code>.</em></p>
</div>
</dd>
<dt class="hdlist1"><code>org.gradle.workers.max=(max # of worker processes)</code></dt>
<dd>
<p>When configured, Gradle will use a maximum of the <a href="#sec:command_line_performance">given number of workers</a>.</p>
<div class="paragraph">
<p><em>Default is the number of CPU processors.</em></p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_environment_variables"><a class="anchor" href="#sec:gradle_environment_variables"></a><a class="link" href="#sec:gradle_environment_variables">Environment variables</a></h4>
<div class="paragraph">
<p>Gradle provides a number of environment variables, which are listed below.
Environment variables can be retrieved in build scripts <a href="glossary.html#sub:terminology_lazy">lazily</a> using <code>providers.environmentVariable()</code>.</p>
</div>
<div class="sect4">
<h5 id="setting_environment_variables"><a class="anchor" href="#setting_environment_variables"></a><a class="link" href="#setting_environment_variables">Setting environment variables</a></h5>
<div class="paragraph">
<p>Let&#8217;s take an example that sets the $JAVA_HOME environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ set JAVA_HOME=C:\Path\To\Your\Java\Home   // Windows
$ export JAVA_HOME=/path/to/your/java/home  // Mac/Linux</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can access environment variables as properties in the build script using the <code>System.getenv()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">task printEnvVariables {
    doLast {
        println "JAVA_HOME: ${System.getenv('JAVA_HOME')}"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="environment_variables_reference"><a class="anchor" href="#environment_variables_reference"></a><a class="link" href="#environment_variables_reference">Environment variables reference</a></h5>
<div class="paragraph">
<p>The following environment variables are available for the <code>gradle</code> command:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GRADLE_HOME</code></dt>
<dd>
<p>Installation directory for Gradle.</p>
<div class="paragraph">
<p>Can be used to specify a local Gradle version instead of using the wrapper.</p>
</div>
<div class="paragraph">
<p>You can add <code>GRADLE_HOME/bin</code> to your <code>PATH</code> for specific applications and use cases (such as testing an early release for Gradle).</p>
</div>
</dd>
<dt class="hdlist1"><code>JAVA_OPTS</code></dt>
<dd>
<p>Used to pass JVM options and custom settings to the JVM.</p>
<div class="paragraph">
<p><code>export JAVA_OPTS="-Xmx18928m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8 -Djava.awt.headless=true -Dkotlin.daemon.jvm.options=-Xmx6309m"</code></p>
</div>
</dd>
<dt class="hdlist1"><code>GRADLE_OPTS</code></dt>
<dd>
<p>Specifies JVM arguments to use when starting the Gradle client VM.</p>
<div class="paragraph">
<p>The client VM is lightweight and mainly handles command-line input and output, so it&#8217;s uncommon to change its VM options.</p>
</div>
<div class="paragraph">
<p>While <code>GRADLE_OPTS</code> typically doesn&#8217;t affect the <a href="#gradle_daemon">daemon</a>, you can use it to pass arguments to the daemon by setting the <code>org.gradle.jvmargs</code> system property.
This is the recommended way to configure the daemon&#8217;s JVM options, such as heap size or memory settings, via an environment variable.</p>
</div>
</dd>
<dt class="hdlist1"><code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code></dt>
<dd>
<p>Specifies the <code>GRADLE_USER_HOME</code> directory for Gradle to store its global configuration properties, initialization scripts, caches, log files and more.</p>
<div class="paragraph">
<p>Defaults to <code>USER_HOME/.gradle</code> if not set.</p>
</div>
</dd>
<dt class="hdlist1"><code>JAVA_HOME</code></dt>
<dd>
<p>Specifies the JDK installation directory to use for the client VM.</p>
<div class="paragraph">
<p>This VM is also used for the daemon unless a different one is specified in a Gradle properties file with <code>org.gradle.java.home</code> or using the <a href="#sec:daemon_jvm_criteria">Daemon JVM criteria</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>GRADLE_LIBS_REPO_OVERRIDE</code></dt>
<dd>
<p>Overrides for the default Gradle library repository.</p>
<div class="paragraph">
<p>Can be used to specify a default Gradle repository URL in <code>org.gradle.plugins.ide.internal.resolver</code>.</p>
</div>
<div class="paragraph">
<p>Useful override to specify an internally hosted repository if your company uses a firewall/proxy.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_lifecycle"><a class="anchor" href="#build_lifecycle"></a><a class="link" href="#build_lifecycle">Build Lifecycle</a></h3>
<div class="paragraph">
<p>The build lifecycle is the sequence of phases Gradle executes to turn your build scripts into completed work, from initializing the build environment to configuring projects and finally executing tasks.</p>
</div>
<div class="sect3">
<h4 id="build_phases"><a class="anchor" href="#build_phases"></a><a class="link" href="#build_phases">Build Phases</a></h4>
<div class="paragraph">
<p>A Gradle build has three distinct phases.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/author-gradle-1.png" alt="author gradle 1">
</div>
</div>
<div class="paragraph">
<p>Gradle runs these phases in order:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Phase 1. Initialization</th>
<th class="tableblock halign-left valign-top">Phase 2. Configuration</th>
<th class="tableblock halign-left valign-top">Phase 3. Execution</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">- Detects the <strong>settings file</strong><br>
- Creates a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html"><code><strong>Settings</strong></code></a> instance<br>
- Evaluates the <strong>settings file</strong> to determine which projects (and included builds) make up the build<br>
- Creates a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html"><code><strong>Project</strong></code></a> instance <strong>for every project</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- Evaluates the <strong>build files of every project</strong> participating in the build<br>
- Creates a <strong>task graph</strong> for requested tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">- Schedules and <strong>executes</strong> the selected <strong>tasks</strong></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="img/build-lifecycle-example.png" alt="build lifecycle example">
</div>
</div>
<div class="paragraph">
<p>The following example shows which parts of settings and build files correspond to various build phases:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "basic"
println("This is executed during the initialization phase.")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">println("This is executed during the configuration phase.")

tasks.register("configured") {
    println("This is also executed during the configuration phase, because :configured is used in the build.")
}

tasks.register("test") {
    doLast {
        println("This is executed during the execution phase.")
    }
}

tasks.register("testBoth") {
    doFirst {
        println("This is executed first during the execution phase.")
    }
    doLast {
        println("This is executed last during the execution phase.")
    }
    println("This is executed during the configuration phase as well, because :testBoth is used in the build.")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'basic'
println 'This is executed during the initialization phase.'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">println 'This is executed during the configuration phase.'

tasks.register('configured') {
    println 'This is also executed during the configuration phase, because :configured is used in the build.'
}

tasks.register('test') {
    doLast {
        println 'This is executed during the execution phase.'
    }
}

tasks.register('testBoth') {
	doFirst {
	  println 'This is executed first during the execution phase.'
	}
	doLast {
	  println 'This is executed last during the execution phase.'
	}
	println 'This is executed during the configuration phase as well, because :testBoth is used in the build.'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following command executes the <code>test</code> and <code>testBoth</code> tasks specified above.
Because Gradle only configures requested tasks and their dependencies, the <code>configured</code> task never configures:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">&gt; gradle test testBoth
This is executed during the initialization phase.

&gt; Configure project :
This is executed during the configuration phase.
This is executed during the configuration phase as well, because :testBoth is used in the build.

&gt; Task :test
This is executed during the execution phase.

&gt; Task :testBoth
This is executed first during the execution phase.
This is executed last during the execution phase.

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&gt; gradle test testBoth
This is executed during the initialization phase.

&gt; Configure project :
This is executed during the configuration phase.
This is executed during the configuration phase as well, because :testBoth is used in the build.

&gt; Task :test
This is executed during the execution phase.

&gt; Task :testBoth
This is executed first during the execution phase.
This is executed last during the execution phase.

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="initialization"><a class="anchor" href="#initialization"></a><a class="link" href="#initialization">Phase 1. Initialization</a></h5>
<div class="paragraph">
<p>In the <strong>initialization phase</strong>, Gradle detects the set of projects (root and subprojects) and included builds participating in the build.</p>
</div>
<div class="paragraph">
<p>Gradle first evaluates the settings file, <code>settings.gradle(.kts)</code>, and instantiates a <code>Settings</code> object.</p>
</div>
<div class="paragraph">
<p>Then, Gradle instantiates <code>Project</code> object instances for each project included in the build (using <code>includeBuild()</code> or <code>include()</code> in the settings file).</p>
</div>
</div>
<div class="sect4">
<h5 id="configuration"><a class="anchor" href="#configuration"></a><a class="link" href="#configuration">Phase 2. Configuration</a></h5>
<div class="paragraph">
<p>In the <strong>configuration phase</strong>, Gradle adds tasks and other properties to the projects found by the initialization phase.</p>
</div>
<div class="paragraph">
<p>Gradle constructs the <a href="#task_graph">task graph</a> by understanding the dependencies between tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="execution"><a class="anchor" href="#execution"></a><a class="link" href="#execution">Phase 3. Execution</a></h5>
<div class="paragraph">
<p>In the <strong>execution phase</strong>, Gradle runs tasks.</p>
</div>
<div class="paragraph">
<p>Gradle uses the <a href="#task_graph">task execution graphs</a> generated by the configuration phase to determine which tasks to execute.
Gradle can execute tasks in parallel.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="task_graph"><a class="anchor" href="#task_graph"></a><a class="link" href="#task_graph">Task Graphs</a></h4>
<div class="paragraph">
<p>As a build author, you write build logic by defining tasks and declaring how they depend on one another.
Gradle uses this information to construct a <strong>task graph</strong> during the <strong>configuration phase</strong> that models the relationships between these tasks.</p>
</div>
<div class="paragraph">
<p>For example, if your project includes tasks such as <code>build</code>, <code>assemble</code>, and <code>createDocs</code>, and you declare that <code>assemble</code> depends on <code>build</code>, and <code>createDocs</code> depends on <code>assemble</code>, Gradle constructs a graph with this order: <code>build</code>  <code>assemble</code>  <code>createDocs</code>.</p>
</div>
<div class="paragraph">
<p>Gradle builds the task graph <strong>before</strong> executing any task(s).</p>
</div>
<div class="paragraph">
<p>Across all projects in the build, tasks form a <a href="http://en.wikipedia.org/wiki/Directed_acyclic_graph" target="_blank" rel="noopener">Directed Acyclic Graph</a> (DAG).</p>
</div>
<div class="paragraph">
<p>This diagram shows two example task graphs, one abstract and the other concrete, with dependencies between tasks represented as arrows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/task-dag-examples.png" alt="task dag examples">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inspecting_build_scans"><a class="anchor" href="#inspecting_build_scans"></a><a class="link" href="#inspecting_build_scans">Build Scan</a></h3>
<div class="badge-wrapper">
    <a class="badge" href="https://dpeuniversity.gradle.com/app/learning_paths/f633b8eb-2979-449e-a434-b94787fe5f32" target="_blank">
        <span class="badge-type button--blue">LEARN</span>
        <span class="badge-text">How to Use a Build Scan&nbsp;&nbsp;&nbsp;&gt;</span>
    </a>
</div>
<div class="paragraph">
<p>Gradle provides multiple ways to inspect your build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Profile with a Build Scan</p>
</li>
<li>
<p>Local profile reports</p>
</li>
<li>
<p>Low level profiling</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="what_is_a_build_scan"><a class="anchor" href="#what_is_a_build_scan"></a><a class="link" href="#what_is_a_build_scan">What is a Build Scan?</a></h4>
<div class="paragraph">
<p>A <a href="https://scans.gradle.com/">Build Scan</a> is a persistent, shareable record of what happened when running a build.
They provide detailed insights you can use to diagnose performance issues, identify build failures, and share context with your team.</p>
</div>
<div class="paragraph">
<p>A Build Scan is created locally but published to a secure external server managed by Gradle.
They do not run code on your machine, and they never modify your build.
You can choose whether to publish a scan, and each scan is assigned a unique (private-by-default) URL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For information on what data is collected and how it&#8217;s handled, see the <a href="https://gradle.com/privacy">Gradle.com Privacy Policy</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In Gradle 4.3 and above, you can create a Build Scan using the <code>--scan</code> command line option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle build --scan</code></pre>
</div>
</div>
<div class="paragraph">
<p>For older Gradle versions, the
<a href="https://docs.gradle.com/develocity/gradle-plugin/current/#getting_set_up">Develocity Plugin User Manual</a> explains how to generate a Build Scan.</p>
</div>
<div class="paragraph">
<p>At the end of your build, Gradle displays a URL where you can find your Build Scan:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">BUILD SUCCESSFUL in 2s
4 actionable tasks: 4 executed

Publishing Build Scan...
https://gradle.com/s/e6ircx2wjbf7e</code></pre>
</div>
</div>
<div class="paragraph">
<p>This section explains how to profile your build with a Build Scan.</p>
</div>
</div>
<div class="sect3">
<h4 id="1_profile_with_a_build_scan"><a class="anchor" href="#1_profile_with_a_build_scan"></a><a class="link" href="#1_profile_with_a_build_scan">1. Profile with a Build Scan</a></h4>
<div class="paragraph">
<p>The performance page can help use a Build Scan to profile a build.
To get there, click <em>"Performance"</em> in the left hand navigation menu or follow the "Explore performance" link on the Build Scan home page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/build-scan-home.png" alt="build scan home">
</div>
<div class="title">Figure 1. Performance page link on Build Scan home page</div>
</div>
<div class="paragraph">
<p>The performance page shows how long it took to complete different stages of a build.
This page shows how long it took to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>start up</p>
</li>
<li>
<p>configure the build&#8217;s projects</p>
</li>
<li>
<p>resolve dependencies</p>
</li>
<li>
<p>execute tasks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You also get details about environmental properties, such as whether a daemon was used or not.</p>
</div>
<div id="build-scan-performance" class="imageblock">
<div class="content">
<img src="img/performance/build-scan-performance-page.png" alt="build scan performance page">
</div>
<div class="title">Figure 2. Build Scan performance page</div>
</div>
<div class="paragraph">
<p>In the above Build Scan, configuration takes over 13 seconds.
Click on the <em>"Configuration"</em> tab to break this stage into component parts, exposing the cause of the slowness.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/build-scan-configuration-breakdown.png" alt="build scan configuration breakdown">
</div>
<div class="title">Figure 3. Build Scan configuration breakdown</div>
</div>
<div class="paragraph">
<p>Here you can see the scripts and plugins applied to the project in descending order of how long they took to apply.
The slowest plugin and script applications are good candidates for optimization.
For example, the script <code>script-b.gradle</code> was applied once but took 3 seconds.
Expand that row to see where the build applied this script.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/script-b-application.png" alt="script b application">
</div>
<div class="title">Figure 4. Showing the application of script-b.gradle to the build</div>
</div>
<div class="paragraph">
<p>You can see that subproject <code>:app1</code> applied the script once, from inside of that subproject&#8217;s <code>build.gradle</code> file.</p>
</div>
</div>
<div class="sect3">
<h4 id="2_profile_report"><a class="anchor" href="#2_profile_report"></a><a class="link" href="#2_profile_report">2. Profile report</a></h4>
<div class="paragraph">
<p>If you prefer not to use a Build Scan, you can generate an HTML report in the
<code>build/reports/profile</code> directory of your root project. To generate this report,
use the <code>--profile</code> command-line option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle --profile &lt;tasks&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each profile report has a timestamp in its name to avoid overwriting existing ones.</p>
</div>
<div class="paragraph">
<p>The report displays a breakdown of the time taken to run the build.
However, this breakdown is not as detailed as a Build Scan.
The following profile report shows the different categories available:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/gradle-profile-report.png" alt="Sample Gradle profile report">
</div>
<div class="title">Figure 5. An example profile report</div>
</div>
</div>
<div class="sect3">
<h4 id="3_low_level_profiling"><a class="anchor" href="#3_low_level_profiling"></a><a class="link" href="#3_low_level_profiling">3. Low level profiling</a></h4>
<div class="paragraph">
<p>Sometimes your build can be slow even though your build scripts do everything right.
This often comes down to inefficiencies in plugins and custom tasks or constrained resources.
Use the <a href="https://github.com/gradle/gradle-profiler">Gradle Profiler</a> to find these kinds of bottlenecks.
With the Gradle Profiler, you can define scenarios like "Running 'assemble' after making an ABI-breaking change" and run your build several times to collect profiling data.
Use the Profiler to produce a Build Scan. Or combine it with method profilers like JProfiler and YourKit.
These profilers can help you find inefficient algorithms in custom plugins.
If you find that something in Gradle itself slows down your build, don&#8217;t hesitate to send a profiler snapshot to <a href="mailto:performance@gradle.com">performance@gradle.com</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="performance_categories"><a class="anchor" href="#performance_categories"></a><a class="link" href="#performance_categories">Performance categories</a></h4>
<div class="paragraph">
<p>Both a Build Scan and local profile reports break down build execution into the same categories.
The following sections explain those categories.</p>
</div>
<div class="sect4">
<h5 id="startup"><a class="anchor" href="#startup"></a><a class="link" href="#startup">Startup</a></h5>
<div class="paragraph">
<p>This reflects Gradles initialization time, which consists mostly of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JVM initialization and class loading</p>
</li>
<li>
<p>Downloading the Gradle distribution if youre using the wrapper</p>
</li>
<li>
<p>Starting the daemon if a suitable one isnt already running</p>
</li>
<li>
<p>Executing Gradle initialization scripts</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even when a build execution has a long startup time, subsequent runs usually see a dramatic drop off in startup time.
Persistently slow build startup times are usually the result of problems in your init scripts.
Double check that the work youre doing there is necessary and performant.</p>
</div>
</div>
<div class="sect4">
<h5 id="settings_and_buildsrc"><a class="anchor" href="#settings_and_buildsrc"></a><a class="link" href="#settings_and_buildsrc">Settings and <em>buildSrc</em></a></h5>
<div class="paragraph">
<p>After startup, Gradle initializes your project. Usually, Gradle only processes your settings file.
If you have custom build logic in a <code>buildSrc</code> directory, Gradle also processes that logic.
After building <code>buildSrc</code> once, Gradle considers it up to date. The up-to-date checks take significantly less time than logic processing.
If your <code>buildSrc</code> phase takes too much time, consider breaking it out into a separate project.
You can then add that project&#8217;s JAR artifact as a dependency.</p>
</div>
<div class="paragraph">
<p>The settings file rarely contains code with significant I/O or computation.
If you find that Gradle takes a long time to process it, use more traditional profiling methods, like the <a href="https://github.com/gradle/gradle-profiler">Gradle Profiler</a>, to determine the cause.</p>
</div>
</div>
<div class="sect4">
<h5 id="loading_projects"><a class="anchor" href="#loading_projects"></a><a class="link" href="#loading_projects">Loading projects</a></h5>
<div class="paragraph">
<p>It normally doesnt take a significant amount of time to load projects, nor do you have any control over it.
The time spent here is basically a function of the number of projects you have in your build.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="continuous_builds"><a class="anchor" href="#continuous_builds"></a><a class="link" href="#continuous_builds">Continuous Builds</a></h3>
<div class="paragraph">
<p>Continuous Build allows you to automatically re-execute the requested tasks when file inputs change.
You can execute the build in this mode using the <code>-t</code> or <code>--continuous</code> command-line option.</p>
</div>
<div class="paragraph">
<p>For example, you can continuously run the <code>test</code> task and all dependent tasks by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle test --continuous</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will behave as if you ran <code>gradle test</code> after a change to sources or tests that contribute to the requested tasks.
This means unrelated changes (such as changes to build scripts) will not trigger a rebuild.
To incorporate build logic changes, the continuous build must be restarted manually.</p>
</div>
<div class="paragraph">
<p>Continuous build uses <a href="#sec:daemon_watch_fs">file system watching</a> to detect changes to the inputs.
If file system watching does not work on your system, then continuous build won&#8217;t work either.
In particular, continuous build does not work when using <code>--no-daemon</code>.</p>
</div>
<div class="paragraph">
<p>When Gradle detects a change to the inputs, it will not trigger the build immediately.
Instead, it will wait until no additional changes are detected for a certain period of time - the quiet period.
You can configure the quiet period in milliseconds by the Gradle property <code><a href="#sec:gradle_configuration_properties">org.gradle.continuous.quietperiod</a></code>.</p>
</div>
<div class="sect3">
<h4 id="terminating_continuous_build"><a class="anchor" href="#terminating_continuous_build"></a><a class="link" href="#terminating_continuous_build">Terminating Continuous Build</a></h4>
<div class="paragraph">
<p>If Gradle is attached to an interactive input source, such as a terminal, the continuous build can be exited by pressing <code>CTRL-D</code> (On Microsoft Windows, it is required to also press <code>ENTER</code> or <code>RETURN</code> after <code>CTRL-D</code>).</p>
</div>
<div class="paragraph">
<p>If Gradle is not attached to an interactive input source (e.g. is running as part of a script), the build process must be terminated (e.g. using the <code>kill</code> command or similar).</p>
</div>
<div class="paragraph">
<p>If the build is being executed via the Tooling API, the build can be cancelled using the Tooling API&#8217;s cancellation mechanism.</p>
</div>
</div>
<div class="sect3">
<h4 id="continuous_build_limitations"><a class="anchor" href="#continuous_build_limitations"></a><a class="link" href="#continuous_build_limitations">Limitations</a></h4>
<div class="paragraph">
<p>Under some circumstances, continuous build may not detect changes to inputs.</p>
</div>
<div class="sect4">
<h5 id="sec:continuous_build_missing_files"><a class="anchor" href="#sec:continuous_build_missing_files"></a><a class="link" href="#sec:continuous_build_missing_files">Creating input directories</a></h5>
<div class="paragraph">
<p>Sometimes, creating an input directory that was previously missing does not trigger a build, due to the way file system watching works.
For example, creating the <code>src/main/java</code> directory may not trigger a build.
Similarly, if the input is a <a href="#filtering_files">filtered file tree</a> and no files are matching the filter, the creation of matching files may not trigger a build.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:continuous_build_untracked"><a class="anchor" href="#sec:continuous_build_untracked"></a><a class="link" href="#sec:continuous_build_untracked">Inputs of untracked tasks</a></h5>
<div class="paragraph">
<p>Changes to the inputs of <a href="incremental_build.html#sec:disable-state-tracking">untracked tasks</a> or tasks that have no outputs may not trigger a build.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:continuous_build_project_dir"><a class="anchor" href="#sec:continuous_build_project_dir"></a><a class="link" href="#sec:continuous_build_project_dir">Changes to files outside of project directories</a></h5>
<div class="paragraph">
<p>Gradle only watches for changes to files inside the project directory.
Changes to files outside the project directory will go undetected and not trigger a build.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cycles"><a class="anchor" href="#sec:build_cycles"></a><a class="link" href="#sec:build_cycles">Build cycles</a></h5>
<div class="paragraph">
<p>Gradle starts watching for changes just before a task executes.
If a task modifies its own inputs while executing, Gradle will detect the change and trigger a new build.
If every time the task executes, the inputs are modified again, the build will be triggered again.
This isn&#8217;t unique to continuous build.
A task that modifies its own inputs will never be considered up-to-date when run "normally" without continuous build.</p>
</div>
<div class="paragraph">
<p>If your build enters a build cycle like this, you can track down the task by looking at the list of files reported changed by Gradle.
After identifying the file(s) that are changed during each build, you should look for a task that has that file as an input.
In some cases, it may be obvious (e.g., a Java file is compiled with <code>compileJava</code>).
In other cases, you can use <code>--info</code> logging to find the task that is out-of-date due to the identified files.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:changes_to_symbolic_links"><a class="anchor" href="#sec:changes_to_symbolic_links"></a><a class="link" href="#sec:changes_to_symbolic_links">Changes to symbolic links</a></h5>
<div class="paragraph">
<p>In general, Gradle will not detect changes to symbolic links or to files referenced via symbolic links.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:changes_to_build_logic_are_not_considered"><a class="anchor" href="#sec:changes_to_build_logic_are_not_considered"></a><a class="link" href="#sec:changes_to_build_logic_are_not_considered">Changes to build logic are not considered</a></h5>
<div class="paragraph">
<p>The current implementation does not recalculate the build model on subsequent builds.
This means that changes to task configuration, or any other change to the build model, are effectively ignored.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="continuous_build_in_ides"><a class="anchor" href="#continuous_build_in_ides"></a><a class="link" href="#continuous_build_in_ides">Continuous Build in IDEs</a></h4>
<div class="paragraph">
<p>Most modern IDEs like <strong>IntelliJ IDEA</strong>, <strong>Android Studio</strong>, or <strong>Eclipse</strong> already offer their own form of continuous compilation and test execution.</p>
</div>
<div class="paragraph">
<p>For example, If youre only interested in triggering something on file changes (e.g., running tests or generating docs), you might consider using IntelliJs <strong>File Watchers</strong> feature as an alternative for specific tasks.</p>
</div>
<div class="paragraph">
<p>Gradles <code>--continuous</code> mode is designed for command-line use and is <strong>not typically integrated into IDE workflows</strong>.
To use continuous build in an IDE environment, run <code>./gradlew &lt;task&gt; --continuous</code> from a terminal window alongside the IDE.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:daemon_watch_fs"><a class="anchor" href="#sec:daemon_watch_fs"></a><a class="link" href="#sec:daemon_watch_fs">File System Watching</a></h3>
<div class="paragraph">
<p>Gradle maintains a Virtual File System (VFS) to calculate what needs to be rebuilt on repeat builds of a project.
By watching the file system, Gradle keeps the VFS current between builds.</p>
</div>
<div class="sect3">
<h4 id="enable"><a class="anchor" href="#enable"></a><a class="link" href="#enable">Enable</a></h4>
<div class="paragraph">
<p>Gradle enables file system watching by default for supported operating systems since Gradle 7.</p>
</div>
<div class="paragraph">
<p>Run the build with the '--watch-fs' flag to force file system watching for a build.</p>
</div>
<div class="paragraph">
<p>To force file system watching for all builds (unless disabled with <code>--no-watch-fs</code>), add the following value to <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.vfs.watch=true</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="disable"><a class="anchor" href="#disable"></a><a class="link" href="#disable">Disable</a></h4>
<div class="paragraph">
<p>To disable file system watching:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use the <code>--no-watch-fs</code> flag</p>
</li>
<li>
<p>set <code>org.gradle.vfs.watch=false</code> in <code>gradle.properties</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="excluding_files_and_directories"><a class="anchor" href="#excluding_files_and_directories"></a><a class="link" href="#excluding_files_and_directories">Excluding files and directories</a></h4>
<div class="paragraph">
<p>Gradle automatically excludes some common directories (like <code>.git</code>, <code>.gradle</code>, and <code>build/</code>) from file system watching.</p>
</div>
<div class="paragraph">
<p>There is no public mechanism to configure additional file system watch excludes.</p>
</div>
<div class="paragraph">
<p>To reduce unnecessary watching and re-execution, consider limiting the inputs of specific tasks using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/util/PatternFilterable.html#exclude(java.lang.String&#8230;&#8203;)"><code>fileTree.exclude()</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="supported_operating_systems"><a class="anchor" href="#supported_operating_systems"></a><a class="link" href="#supported_operating_systems">Supported Operating Systems</a></h4>
<div class="paragraph">
<p>Gradle uses native operating system features to watch the file system.
Gradle supports file system watching on the following operating systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows 10, version 1709 and later</p>
</li>
<li>
<p>Linux, tested on the following distributions:</p>
<div class="ulist">
<ul>
<li>
<p>Ubuntu 16.04</p>
</li>
<li>
<p>CentOS Stream 9</p>
</li>
<li>
<p>Red Hat Enterprise Linux (RHEL) 8</p>
</li>
<li>
<p>Amazon Linux 2</p>
</li>
<li>
<p>Alpine Linux 3.20</p>
</li>
</ul>
</div>
</li>
<li>
<p>macOS 12 (Monterey) or later on Intel and ARM architectures</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="supported_file_systems"><a class="anchor" href="#supported_file_systems"></a><a class="link" href="#supported_file_systems">Supported File Systems</a></h4>
<div class="paragraph">
<p>File system watching supports the following file system types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APFS</p>
</li>
<li>
<p>btrfs</p>
</li>
<li>
<p>ext3</p>
</li>
<li>
<p>ext4</p>
</li>
<li>
<p>XFS</p>
</li>
<li>
<p>HFS+</p>
</li>
<li>
<p>NTFS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle also supports VirtualBox&#8217;s shared folders.</p>
</div>
<div class="paragraph">
<p>Network file systems like Samba and NFS are not supported. Microsoft Dev Drives (ReFS) are also not supported.</p>
</div>
</div>
<div class="sect3">
<h4 id="unsupported_file_systems"><a class="anchor" href="#unsupported_file_systems"></a><a class="link" href="#unsupported_file_systems">Unsupported File Systems</a></h4>
<div class="paragraph">
<p>When enabled by default, file system watching acts conservatively when it encounters content on unsupported file systems.
This can happen if you mount a project directory or subdirectory from a network drive.
Gradle doesn&#8217;t retain information about unsupported file systems between builds when enabled by default.
If you explicitly enable file system watching, Gradle retains information about unsupported file systems between builds.</p>
</div>
<div class="sect4">
<h5 id="symlinks"><a class="anchor" href="#symlinks"></a><a class="link" href="#symlinks">Symlinks</a></h5>
<div class="paragraph">
<p>Files and directories in your project that are accessed via symlinks do not benefit from file system-watching optimizations.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="logging_2"><a class="anchor" href="#logging_2"></a><a class="link" href="#logging_2">Logging</a></h4>
<div class="paragraph">
<p>To view information about Virtual File System (VFS) changes at the beginning and end of a build, enable verbose VFS logging.</p>
</div>
<div class="paragraph">
<p>Set the <code>org.gradle.vfs.verbose</code> Daemon option to <code>true</code> to enable verbose logging.</p>
</div>
<div class="paragraph">
<p>You can do this on the command line with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; -Dorg.gradle.vfs.verbose=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or configure the property in the <code>gradle.properties</code> file in the project root or your Gradle User Home:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.vfs.verbose=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>This produces the following output at the start and end of the build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew assemble --watch-fs -Dorg.gradle.vfs.verbose=true</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Received 3 file system events since last build while watching 1 locations
Virtual file system retained information about 2 files, 2 directories and 0 missing files since last build
&gt; Task :compileJava NO-SOURCE
&gt; Task :processResources NO-SOURCE
&gt; Task :classes UP-TO-DATE
&gt; Task :jar UP-TO-DATE
&gt; Task :assemble UP-TO-DATE

BUILD SUCCESSFUL in 58ms
1 actionable task: 1 up-to-date
Received 5 file system events during the current build while watching 1 locations
Virtual file system retains information about 3 files, 2 directories and 2 missing files until next build</pre>
</div>
</div>
<div class="paragraph">
<p>On Windows and macOS, Gradle might report changes received since the last build, even if you haven&#8217;t changed anything.
These are harmless notifications about changes to Gradle&#8217;s caches and can be safely ignored.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:daemon_watch_fs_troubleshooting"><a class="anchor" href="#sec:daemon_watch_fs_troubleshooting"></a><a class="link" href="#sec:daemon_watch_fs_troubleshooting">Troubleshooting</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Gradle does not detect some changes</dt>
<dd>
<p><em>Please <a href="https://gradle-community.slack.com/app_redirect?channel=file-system-watching">let us know on the Gradle community Slack</a>.</em>
If a build declares its inputs and outputs correctly, this should not happen.
So it&#8217;s either a bug we must fix or your build lacks declaration for some inputs or outputs.</p>
</dd>
<dt class="hdlist1">VFS state dropped due to lost state</dt>
<dd>
<p>Did you receive a message that reads <code>Dropped VFS state due to lost state</code> during a build?
<em>Please <a href="https://gradle-community.slack.com/app_redirect?channel=file-system-watching">let us know on the Gradle community Slack</a>.</em>
This means that your build cannot benefit from file system watching for one of the following reasons:</p>
<div class="ulist">
<ul>
<li>
<p>the Daemon received an unknown file system event</p>
</li>
<li>
<p>too many changes happened, and the watching API couldn&#8217;t handle it</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Too many open files on macOS</dt>
<dd>
<p>If you receive the <code>java.io.IOException: Too many open files</code> error on macOS, raise your open files limit.
See <a href="https://superuser.com/a/443168/8117">this post</a> for more details.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:inotify_watches_limit"><a class="anchor" href="#sec:inotify_watches_limit"></a><a class="link" href="#sec:inotify_watches_limit">Adjust inotify watches limit on Linux</a></h5>
<div class="paragraph">
<p>File system watching uses <a href="http://en.wikipedia.org/wiki/Inotify">inotify</a> on Linux.
Depending on the size of your build, it may be necessary to increase inotify limits.
If you are using an IDE, then you probably already had to increase the limits in the past.</p>
</div>
<div class="paragraph">
<p>File system watching uses one inotify watch per watched directory.
You can see the current limit of inotify watches per user by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat /proc/sys/fs/inotify/max_user_watches</code></pre>
</div>
</div>
<div class="paragraph">
<p>To increase the limit to e.g. 512K watches run the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo sysctl -p --system</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each used inotify watch takes up to 1KB of memory.
Assuming inotify uses all the 512K watches then file system watching could use up to 500MB.
In a memory-constrained environment, you may want to disable file system watching.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:inotify_instances_limit"><a class="anchor" href="#sec:inotify_instances_limit"></a><a class="link" href="#sec:inotify_instances_limit">Inspect inotify instances limit on Linux</a></h5>
<div class="paragraph">
<p>File system watching initializes one inotify instance per daemon.
You can see the current limit of inotify instances per user by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat /proc/sys/fs/inotify/max_user_instances</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default per-user instances limit should be high enough, so we don&#8217;t recommend increasing that value manually.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dsl_and_apis"><a class="anchor" href="#dsl_and_apis"></a><a class="link" href="#dsl_and_apis">DSL AND APIS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="groovy_build_script_primer"><a class="anchor" href="#groovy_build_script_primer"></a><a class="link" href="#groovy_build_script_primer">A Groovy Build Script Primer</a></h3>
<div class="paragraph">
<p>Ideally, a Groovy build script looks mostly like configuration: setting some properties of the project, configuring dependencies, declaring tasks, and so on. That configuration is based on Groovy language constructs. This primer aims to explain what those constructs are and most importantly how they relate to Gradle&#8217;s API documentation.</p>
</div>
<div class="sect3">
<h4 id="groovy:project_object"><a class="anchor" href="#groovy:project_object"></a><a class="link" href="#groovy:project_object">The <code>Project</code> object</a></h4>
<div class="paragraph">
<p>As Groovy is an object-oriented language based on Java, its properties and methods apply to objects. In some cases, the object is implicit  particularly at the top level of a build script, i.e. not nested inside a <code>{}</code> block.</p>
</div>
<div class="paragraph">
<p>Consider this fragment of build script, which contains an unqualified property and block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">version = '1.0.0.GA'

configurations {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>version</code> and <code>configurations {}</code> are part of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">org.gradle.api.Project</a>.</p>
</div>
<div class="paragraph">
<p>This example reflects how every Groovy build script is backed by an implicit instance of <code>Project</code>. If you see an unqualified element and you don&#8217;t know where it&#8217;s defined, always check the <code>Project</code> API documentation to see if that&#8217;s where it&#8217;s coming from.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Avoid using <a href="https://groovy-lang.org/metaprogramming.html#_metaclasses">Groovy MetaClass</a> programming techniques in your build scripts. Gradle provides its own API for adding <a href="writing_build_scripts_intermediate.html#sec:extra_properties">dynamic runtime properties</a>.</p>
</div>
<div class="paragraph">
<p>Use of Groovy-specific metaprogramming can cause builds to retain large amounts of memory between builds that will eventually cause the Gradle daemon to run out-of-memory.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="groovy:properties"><a class="anchor" href="#groovy:properties"></a><a class="link" href="#groovy:properties">Properties</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&lt;obj&gt;.&lt;name&gt;                // Get a property value
&lt;obj&gt;.&lt;name&gt; = &lt;value&gt;      // Set a property to a new value
"$&lt;name&gt;"                   // Embed a property value in a string
"${&lt;obj&gt;.&lt;name&gt;}"           // Same as previous (embedded value)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">version = '1.0.1'
myCopyTask.description = 'Copies some files'

file("$projectDir/src")
println "Destination: ${myCopyTask.destinationDir}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>A property represents some state of an object. The presence of an <code>=</code> sign is a clear indicator that you&#8217;re looking at a property. Otherwise, a qualified name  it begins with <code>&lt;obj&gt;.</code> without any other decoration is also a property.</p>
</div>
<div class="paragraph">
<p>If the name is unqualified, then it may be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A task instance with that name.</p>
</li>
<li>
<p>A property on <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a>.</p>
</li>
<li>
<p>An <a href="writing_build_scripts_intermediate.html#sec:extra_properties">extra property</a> defined elsewhere in the project.</p>
</li>
<li>
<p>A property of an implicit object within a <a href="#groovy:blocks">block</a>.</p>
</li>
<li>
<p>A <a href="#groovy:local_variables">local variable</a> defined earlier in the build script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that plugins can add their own properties to the <code>Project</code> object. The <a href="https://docs.gradle.org/9.1.0/dsl/">API documentation</a> lists all the properties added by core plugins. If you&#8217;re struggling to find where a property comes from, check the documentation for the plugins that the build uses.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When referencing a project property in your build script that is added by a non-core plugin, consider prefixing it with <code>project.</code> it&#8217;s clear then that the property belongs to the project object.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="properties_in_the_api_documentation"><a class="anchor" href="#properties_in_the_api_documentation"></a><a class="link" href="#properties_in_the_api_documentation">Properties in the API documentation</a></h5>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/">Groovy DSL reference</a> shows properties as they are used in your build scripts, but the Javadocs only display methods. That&#8217;s because properties are implemented as methods behind the scenes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A property can be <em>read</em> if there is a method named <code>get&lt;PropertyName&gt;</code> with zero arguments that returns the same type as the property.</p>
</li>
<li>
<p>A property can be <em>modified</em> if there is a method named <code>set&lt;PropertyName&gt;</code> with one argument that has the same type as the property and a return type of <code>void</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that property names usually start with a lower-case letter, but that letter is upper case in the method names. So the getter method <code>getProjectVersion()</code> corresponds to the property <code>projectVersion</code>. This convention does not apply when the name begins with at least two upper-case letters, in which case there is not change in case. For example, <code>getRAM()</code> corresponds to the property <code>RAM</code>.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">project.getVersion()
project.version

project.setVersion('1.0.1')
project.version = '1.0.1'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groovy:methods"><a class="anchor" href="#groovy:methods"></a><a class="link" href="#groovy:methods">Methods</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&lt;obj&gt;.&lt;name&gt;()              // Method call with no arguments
&lt;obj&gt;.&lt;name&gt;(&lt;arg&gt;, &lt;arg&gt;)  // Method call with multiple arguments
&lt;obj&gt;.&lt;name&gt; &lt;arg&gt;, &lt;arg&gt;   // Method call with multiple args (no parentheses)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">myCopyTask.include '**/*.xml', '**/*.properties'

ext.resourceSpec = copySpec()   // `copySpec()` comes from `Project`

file('src/main/java')
println 'Hello, World!'</code></pre>
</div>
</div>
<div class="paragraph">
<p>A method represents some behavior of an object, although Gradle often uses methods to configure the state of objects as well. Methods are identifiable by their arguments or empty parentheses. Note that parentheses are sometimes required, such as when a method has zero arguments, so you may find it simplest to always use parentheses.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle has a convention whereby if a method has the same name as a collection-based property, then the method <em>appends</em> its values to that collection.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="groovy:blocks"><a class="anchor" href="#groovy:blocks"></a><a class="link" href="#groovy:blocks">Blocks</a></h4>
<div class="paragraph">
<p>Blocks are also <a href="#groovy:methods">methods</a>, just with specific types for the last argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&lt;obj&gt;.&lt;name&gt; {
     ...
}

&lt;obj&gt;.&lt;name&gt;(&lt;arg&gt;, &lt;arg&gt;) {
     ...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

configurations {
    assets
}

sourceSets {
    main {
        java {
            srcDirs = ['src']
        }
    }
}

dependencies {
    implementation project(':util')
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Blocks are a mechanism for configuring multiple aspects of a build element in one go. They also provide a way to nest configuration, leading to a form of structured data.</p>
</div>
<div class="paragraph">
<p>There are two important aspects of blocks that you should understand:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>They are implemented as methods with specific signatures.</p>
</li>
<li>
<p>They can change the target ("delegate") of unqualified methods and properties.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both are based on Groovy language features and we explain them in the following sections.</p>
</div>
<div class="sect4">
<h5 id="block_method_signatures"><a class="anchor" href="#block_method_signatures"></a><a class="link" href="#block_method_signatures">Block method signatures</a></h5>
<div class="paragraph">
<p>You can easily identify a method as the implementation behind a block by its signature, or more specifically, its argument types. If a method corresponds to a block:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It must have at least one argument.</p>
</li>
<li>
<p>The <em>last</em> argument must be of type <a href="https://docs.groovy-lang.org/latest/html/gapi/groovy/lang/Closure.html"><code>groovy.lang.Closure</code></a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Action.html">org.gradle.api.Action</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:copy(org.gradle.api.Action)">Project.copy(Action)</a> matches these requirements, so you can use the syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">copy {
    into layout.buildDirectory.dir("tmp")
    from 'custom-resources'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That leads to the question of how <code>into()</code> and <code>from()</code> work. They&#8217;re clearly methods, but where would you find them in the API documentation? The answer comes from understanding object <em>delegation</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="delegation"><a class="anchor" href="#delegation"></a><a class="link" href="#delegation">Delegation</a></h5>
<div class="paragraph">
<p>The <a href="#groovy:properties">section on properties</a> lists where unqualified properties might be found. One common place is on the <code>Project</code> object. But there is an alternative source for those unqualified properties and methods inside a block: the block&#8217;s <em>delegate object</em>.</p>
</div>
<div class="paragraph">
<p>To help explain this concept, consider the last example from the previous section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">copy {
    into layout.buildDirectory.dir("tmp")
    from 'custom-resources'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the methods and properties in this example are unqualified. You can easily find <code>copy()</code> and <code>layout</code> in the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html"><code>Project</code> API documentation</a>, but what about <code>into()</code> and <code>from()</code>? These are resolved against the delegate of the <code>copy {}</code> block. What is the type of that delegate? You&#8217;ll need to <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:copy(org.gradle.api.Action)">check the API documentation for that</a>.</p>
</div>
<div class="paragraph">
<p>There are two ways to determine the delegate type, depending on the signature of the block method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>Action</code> arguments, look at the type&#8217;s parameter.</p>
<div class="paragraph">
<p>In the example above, the method signature is <code>copy(Action&lt;? super CopySpec&gt;)</code> and it&#8217;s the bit inside the angle brackets that tells you the delegate type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html">CopySpec</a> in this case.</p>
</div>
</li>
<li>
<p>For <code>Closure</code> arguments, the documentation will explicitly say in the description what type is being configured or what type the delegate it (different terminology for the same thing).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hence you can find both <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#into-java.lang.Object-">into()</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#from-java.lang.Object...-">from()</a> on <code>CopySpec</code>. You might even notice that both of those methods have variants that take an <code>Action</code> as their last argument, which means you can use block syntax with them.</p>
</div>
<div class="paragraph">
<p>All new Gradle APIs declare an <code>Action</code> argument type rather than <code>Closure</code>, which makes it very easy to pick out the delegate type. Even older APIs have an <code>Action</code> variant in addition to the old <code>Closure</code> one.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groovy:local_variables"><a class="anchor" href="#groovy:local_variables"></a><a class="link" href="#groovy:local_variables">Local variables</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def &lt;name&gt; = &lt;value&gt;        // Untyped variable
&lt;type&gt; &lt;name&gt; = &lt;value&gt;     // Typed variable</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def i = 1
String errorMsg = 'Failed, because reasons'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Local variables are a Groovy construct  unlike <a href="writing_build_scripts_intermediate.html#sec:extra_properties">extra properties</a> that can be used to share values within a build script.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Avoid using local variables in the root of the project, i.e. as pseudo project properties. They cannot be read outside of the build script and Gradle has no knowledge of them.</p>
</div>
<div class="paragraph">
<p>Within a narrower context such as configuring a task  local variables can occasionally be helpful.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kotdsl:kotlin_dsl"><a class="anchor" href="#kotdsl:kotlin_dsl"></a><a class="link" href="#kotdsl:kotlin_dsl">Gradle Kotlin DSL Primer</a></h3>
<div class="paragraph">
<p>Gradle&#8217;s Kotlin DSL offers an alternative to the traditional Groovy DSL, delivering an enhanced editing experience in supported IDEs with features like better content assist, refactoring, and documentation.</p>
</div>
<div class="paragraph">
<p>This chapter explores the key Kotlin DSL constructs and demonstrates how to use them to interact with the Gradle API.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you are interested in migrating an existing Gradle build to the Kotlin DSL, please also check out the dedicated <a href="migrating_from_groovy_to_kotlin_dsl.html#migrating_groovy_kotlin">migration page</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="kotdsl:prerequisites"><a class="anchor" href="#kotdsl:prerequisites"></a><a class="link" href="#kotdsl:prerequisites">Prerequisites</a></h4>
<div class="ulist">
<ul>
<li>
<p>The embedded Kotlin compiler works on Linux, macOS, Windows, Cygwin, FreeBSD, and Solaris on x86-64 architectures.</p>
</li>
<li>
<p>Familiarity with Kotlin syntax and basic language features is recommended.
Refer to the <a href="https://kotlinlang.org/docs/reference/">Kotlin documentation</a> and <a href="https://kotlinlang.org/docs/tutorials/koans.html">Kotlin Koans</a> to learn the basics.</p>
</li>
<li>
<p>Using the <a href="plugins_intermediate.html#sec:plugins_block"><code>plugins {}</code></a> block to declare Gradle plugins is highly recommended as it significantly improves the editing experience.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:ide_support"><a class="anchor" href="#sec:ide_support"></a><a class="link" href="#sec:ide_support">IDE support</a></h4>
<div class="paragraph">
<p>The Kotlin DSL is fully supported by IntelliJ IDEA and Android Studio.
While other IDEs lack advanced tools for editing Kotlin DSL files, you can still import Kotlin-DSL-based builds and work with them as usual.</p>
</div>
<table class="tableblock frame-none grid-rows stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-middle"></th>
<th class="tableblock halign-center valign-middle">Build import</th>
<th class="tableblock halign-center valign-middle">Syntax highlighting <sup>1</sup></th>
<th class="tableblock halign-center valign-middle">Semantic editor <sup>2</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">IntelliJ IDEA</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">Android Studio</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">Eclipse IDE</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">CLion</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">Apache NetBeans</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">Visual Studio Code <sup>(LSP)</sup></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock">Visual Studio</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="green"><strong></strong></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="red"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><sup>1</sup> <sup>Kotlin</sup> <sup>syntax</sup> <sup>highlighting</sup> <sup>in</sup> <sup>Gradle</sup> <sup>Kotlin</sup> <sup>DSL</sup> <sup>scripts</sup><br>
<sup>2</sup> <sup>Code</sup> <sup>completion,</sup> <sup>navigation</sup> <sup>to</sup> <sup>sources,</sup> <sup>documentation,</sup> <sup>refactorings</sup> <sup>etc&#8230;&#8203;</sup> <sup>in</sup> <sup>Gradle</sup> <sup>Kotlin</sup> <sup>DSL</sup> <sup>scripts</sup></p>
</div>
<div class="paragraph">
<p>As noted in the limitations, you must <a href="https://www.jetbrains.com/help/idea/gradle.html#gradle_import">import your project using the Gradle model</a> to enable content assist and refactoring tools for Kotlin DSL scripts in IntelliJ IDEA.</p>
</div>
<div class="paragraph">
<p>Builds with slow configuration time might affect the IDE responsiveness, so please check out the <a href="#performance_gradle">performance section</a> to help resolve such issues.</p>
</div>
<div class="sect4">
<h5 id="automatic_build_import_vs_automatic_reloading_of_script_dependencies"><a class="anchor" href="#automatic_build_import_vs_automatic_reloading_of_script_dependencies"></a><a class="link" href="#automatic_build_import_vs_automatic_reloading_of_script_dependencies">Automatic build import vs. automatic reloading of script dependencies</a></h5>
<div class="paragraph">
<p>Both IntelliJ IDEA and Android Studio will detect when you make changes to your build logic and offer two suggestions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import the whole build again:</p>
<div class="imageblock">
<div class="content">
<img src="img/intellij-build-import-popup.png" alt="IntelliJ IDEA" width="300">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/android-studio-build-sync-popup.png" alt="IntelliJ IDEA">
</div>
</div>
</li>
<li>
<p>Reload script dependencies when editing a build script:</p>
<div class="imageblock">
<div class="content">
<img src="img/intellij-script-dependencies-reload.png" alt="Reload script dependencies">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>We recommend <em>disabling automatic build import</em> while <em>enabling automatic reloading of script dependencies</em>.
This approach provides early feedback when editing Gradle scripts while giving you control over when the entire build setup synchronizes with your IDE.</p>
</div>
<div class="paragraph">
<p>See the <a href="#sec:troubleshooting">Troubleshooting</a> section to learn more.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scripts"><a class="anchor" href="#sec:scripts"></a><a class="link" href="#sec:scripts">Kotlin DSL scripts</a></h4>
<div class="paragraph">
<p>Just like its Groovy-based counterpart, the Kotlin DSL is built on Gradle&#8217;s Java API.
Everything in a Kotlin DSL script is Kotlin code, compiled and executed by Gradle.
Many of the objects, functions, and properties in your build scripts come from the Gradle API and the APIs of applied plugins.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Use the <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/">Kotlin DSL reference</a> search to explore available members.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="script_file_names"><a class="anchor" href="#script_file_names"></a><a class="link" href="#script_file_names">Script file names</a></h5>
<div class="ulist">
<ul>
<li>
<p>Groovy DSL script files use the <code>.gradle</code> file name extension.</p>
</li>
<li>
<p>Kotlin DSL script files use the <code>.gradle.kts</code> file name extension.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To activate the Kotlin DSL, use the <code>.gradle.kts</code> extension for your build scripts instead of <code>.gradle</code>.
This also applies to the <a href="settings_file_basics.html#sec:settings_file_script">settings file</a> (e.g., <code>settings.gradle.kts</code>) and <a href="#init_scripts">initialization scripts</a>.</p>
</div>
<div class="paragraph">
<p>You can mix Groovy DSL and Kotlin DSL scripts within the same build.
For example, a Kotlin DSL build script can apply a Groovy DSL one, and different projects in a multi-project build can use either.</p>
</div>
<div class="paragraph">
<p>To improve IDE support, we recommend following these conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Name settings scripts (or any script backed by a Gradle <code>Settings</code> object) using the pattern <code>*.settings.gradle.kts</code>.
This includes script plugins applied from settings scripts.</p>
</li>
<li>
<p>Name <a href="#init_scripts">initialization scripts</a> using the pattern <code>*.init.gradle.kts</code> or simply <code>init.gradle.kts</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This helps the IDE identify the object "backing" the script, whether its <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html">Settings</a>, or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html">Gradle</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:implicit_imports"><a class="anchor" href="#sec:implicit_imports"></a><a class="link" href="#sec:implicit_imports">Implicit imports</a></h5>
<div class="paragraph">
<p>All Kotlin DSL build scripts come with implicit imports, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#script-default-imports">default Gradle API imports</a></p>
</li>
<li>
<p>The Kotlin DSL API, which includes types from the following packages:</p>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.kotlin.dsl</code></p>
</li>
<li>
<p><code>org.gradle.kotlin.dsl.plugins.dsl</code></p>
</li>
<li>
<p><code>org.gradle.kotlin.dsl.precompile</code></p>
</li>
<li>
<p><code>java.util.concurrent.Callable</code></p>
</li>
<li>
<p><code>java.util.concurrent.TimeUnit</code></p>
</li>
<li>
<p><code>java.math.BigDecimal</code></p>
</li>
<li>
<p><code>java.math.BigInteger</code></p>
</li>
<li>
<p><code>java.io.File</code></p>
</li>
<li>
<p><code>javax.inject.Inject</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="avoid_using_internal_kotlin_dsl_apis"><a class="anchor" href="#avoid_using_internal_kotlin_dsl_apis"></a><a class="link" href="#avoid_using_internal_kotlin_dsl_apis">Avoid Using Internal Kotlin DSL APIs</a></h5>
<div class="paragraph">
<p>Using internal Kotlin DSL APIs in plugins and build scripts can break builds when either Gradle or plugins are updated.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/">Kotlin DSL API</a> extends the public Gradle API with types listed in the <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/">corresponding API docs</a> found in the packages above (but not in their subpackages).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:compilation_warnings"><a class="anchor" href="#sec:compilation_warnings"></a><a class="link" href="#sec:compilation_warnings">Compilation warnings</a></h5>
<div class="paragraph">
<p>Gradle Kotlin DSL scripts are compiled by Gradle during the <a href="build_lifecycle_intermediate.html#build_lifecycle">configuration phase</a> of your build.</p>
</div>
<div class="paragraph">
<p>Deprecation warnings found by the Kotlin compiler are reported on the console when compiling the scripts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">&gt; Configure project :
w: build.gradle.kts:4:5: 'getter for uploadTaskName: String!' is deprecated. Deprecated in Java</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to configure your build to fail on any warning emitted during script compilation by <a href="#sec:gradle_configuration_properties">setting</a> the <code>org.gradle.kotlin.dsl.allWarningsAsErrors</code> Gradle property to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.kotlin.dsl.allWarningsAsErrors=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="type-safe-accessors"><a class="anchor" href="#type-safe-accessors"></a><a class="link" href="#type-safe-accessors">Type-safe model accessors</a></h4>
<div class="paragraph">
<p>The Groovy DSL allows you to reference many build model elements by name, even if they are defined at runtime, such as named configurations or source sets.</p>
</div>
<div class="paragraph">
<p>For example, when the <code>Java</code> plugin is applied, you can access the <code>implementation</code> configuration via <code>configurations.implementation</code>.</p>
</div>
<div class="paragraph">
<p>The Kotlin DSL replaces this dynamic resolution with type-safe model accessors, which work with model elements contributed by plugins.</p>
</div>
<div class="sect4">
<h5 id="kotdsl:accessor_applicability"><a class="anchor" href="#kotdsl:accessor_applicability"></a><a class="link" href="#kotdsl:accessor_applicability">Understanding when type-safe model accessors are available</a></h5>
<div class="paragraph">
<p>The Kotlin DSL currently provides various sets of type-safe model accessors, each tailored to different scopes.</p>
</div>
<div class="paragraph">
<p>For the main project build scripts and precompiled project script plugins:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type-safe model accessors</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency and artifact configurations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implementation</code> and <code>runtimeOnly</code> (contributed by the Java Plugin)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project extensions and conventions, and extensions on them</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sourceSets</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensions on the <code>dependencies</code> and <code>repositories</code> containers, and extensions on them</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testImplementation</code> (contributed by the Java Plugin), <code>mavenCentral</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elements in the <code>tasks</code> and <code>configurations</code> containers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileJava</code> (contributed by the Java Plugin), <code>test</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elements in <a href="#kotdsl:containers">project-extension containers</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source sets contributed by the Java Plugin that are added to the <code>sourceSets</code> container: <code>sourceSets.main.java { setSrcDirs(listOf("src/main/java")) }</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the main project settings script and precompiled settings script plugins:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type-safe model accessors</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project extensions and conventions, contributed by <code>Settings</code> plugins, and extensions on them</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pluginManagement</code>, <code>dependencyResolutionManagement</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Initialization scripts and script plugins do not have type-safe model accessors.
These limitations will be removed in a future Gradle release.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The set of type-safe model accessors available is determined right before evaluating the script body, immediately after the <code>plugins {}</code> block.
Model elements contributed after that point, such as configurations defined in your build script, <strong>will not work</strong> with type-safe model accessors:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Applies the Java plugin
plugins {
    id("java")
}

repositories {
    mavenCentral()
}

// Access to 'implementation' (contributed by the Java plugin) works here:
dependencies {
    implementation("org.apache.commons:commons-lang3:3.12.0")
    testImplementation("org.junit.jupiter:junit-jupiter:5.10.0")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher") // Add this if needed for runtime
}

// Add a custom configuration
configurations.create("customConfiguration")
// Type-safe accessors for 'customConfiguration' will NOT be available because it was created after the plugins block
dependencies {
    customConfiguration("com.google.guava:guava:32.1.2-jre") //  Error: No type-safe accessor for 'customConfiguration'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, this means you can use type-safe accessors for any model elements contributed by plugins that are <em>applied by parent projects</em>.</p>
</div>
<div class="paragraph">
<p>The following project build script demonstrates how you can access various configurations, extensions and other elements using type-safe accessors:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

dependencies {                              // <b class="conum">(1)</b>
    api("junit:junit:4.13")
    implementation("junit:junit:4.13")
    testImplementation("junit:junit:4.13")
}

configurations {                            // <b class="conum">(1)</b>
    implementation {
        resolutionStrategy.failOnVersionConflict()
    }
}

sourceSets {                                // <b class="conum">(2)</b>
    main {                                  // <b class="conum">(3)</b>
        java.srcDir("src/core/java")
    }
}

java {                                      // <b class="conum">(4)</b>
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

tasks {
    test {                                  // <b class="conum">(5)</b>
        testLogging.showExceptions = true
        useJUnit()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Uses type-safe accessors for the <code>api</code>, <code>implementation</code> and <code>testImplementation</code> dependency configurations contributed by the <a href="#java_library_plugin">Java Library Plugin</a></p>
</li>
<li>
<p>Uses an accessor to configure the <code>sourceSets</code> project extension</p>
</li>
<li>
<p>Uses an accessor to configure the <code>main</code> source set</p>
</li>
<li>
<p>Uses an accessor to configure the <code>java</code> source for the <code>main</code> source set</p>
</li>
<li>
<p>Uses an accessor to configure the <code>test</code> task</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Your IDE is aware of the type-safe accessors and will include them in its suggestions.</p>
</div>
<div class="paragraph">
<p>This applies both at the top level of your build scripts, where most plugin extensions are added to the <code>Project</code> object, and within the blocks that configure an extension.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that accessors for elements of containers such as <code>configurations</code>, <code>tasks</code>, and <code>sourceSets</code> leverage Gradle&#8217;s <a href="#lazy_configuration">configuration avoidance APIs</a>.
For example, on <code>tasks</code>, accessors are of type <code>TaskProvider&lt;T&gt;</code> and provide a lazy reference and lazy configuration of the underlying task.</p>
</div>
<div class="paragraph">
<p>Here are some examples illustrating when configuration avoidance applies:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    // lazy configuration
    useJUnitPlatform()
}

// Lazy reference
val testProvider: TaskProvider&lt;Test&gt; = tasks.test

testProvider {
    // lazy configuration
}

// Eagerly realized Test task, defeats configuration avoidance if done out of a lazy context
val test: Test = tasks.test.get()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For all other containers, accessors for elements are of type <code>NamedDomainObjectProvider&lt;T&gt;</code>, providing the same behavior:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val mainSourceSetProvider: NamedDomainObjectProvider&lt;SourceSet&gt; = sourceSets.named("main")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:kotlin_using_standard_api"><a class="anchor" href="#sec:kotlin_using_standard_api"></a><a class="link" href="#sec:kotlin_using_standard_api">Understanding what to do when type-safe model accessors are not available</a></h5>
<div class="paragraph">
<p>Consider the sample build script shown above, which demonstrates the use of type-safe accessors.
The following sample is identical, except it uses the <code>apply()</code> method to apply the plugin.</p>
</div>
<div class="paragraph">
<p>In this case, the build script cannot use type-safe accessors because the <code>apply()</code> call occurs in the body of the build script.
You must use another techniques instead, as demonstrated here:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(plugin = "java-library")

dependencies {
    "api"("junit:junit:4.13")
    "implementation"("junit:junit:4.13")
    "testImplementation"("junit:junit:4.13")
}

configurations {
    "implementation" {
        resolutionStrategy.failOnVersionConflict()
    }
}

configure&lt;SourceSetContainer&gt; {
    named("main") {
        java.srcDir("src/core/java")
    }
}

configure&lt;JavaPluginExtension&gt; {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

tasks {
    named&lt;Test&gt;("test") {
        testLogging.showExceptions = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Type-safe accessors are unavailable for model elements contributed by the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plugins applied via the <code>apply(plugin = "id")</code> method.</p>
</li>
<li>
<p>The project build script.</p>
</li>
<li>
<p>Script plugins, via <code>apply(from = "script-plugin.gradle.kts")</code>.</p>
</li>
<li>
<p>Plugins applied via <a href="#sec:kotlin_cross_project_configuration">cross-project configuration</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You cannot use type-safe accessors in <a href="#implemention_binary_plugins">binary Gradle plugins</a> implemented in Kotlin.</p>
</div>
<div class="paragraph">
<p>If you can&#8217;t find a type-safe accessor, <em>fall back to using the normal API</em> for the corresponding types.
To do so, you need to know the names and/or types of the configured model elements.
We will now show you how these can be discovered by examining the script in detail.</p>
</div>
<div class="sect5">
<h6 id="artifact_configurations"><a class="anchor" href="#artifact_configurations"></a><a class="link" href="#artifact_configurations">Artifact configurations</a></h6>
<div class="paragraph">
<p>The following sample demonstrates how to reference and configure artifact configurations without type-safe accessors:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(plugin = "java-library")

dependencies {
    "api"("junit:junit:4.13")
    "implementation"("junit:junit:4.13")
    "testImplementation"("junit:junit:4.13")
}

configurations {
    "implementation" {
        resolutionStrategy.failOnVersionConflict()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The code looks similar to that of the type-safe accessors, except that the configuration names are string literals.
You can use string literals for configuration names in dependency declarations and within the <code>configurations {}</code> block.</p>
</div>
<div class="paragraph">
<p>While the IDE won&#8217;t be able to help you discover the available configurations, you can look them up either in the corresponding plugin&#8217;s documentation or by running <code>./gradlew dependencies</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="project_extensions"><a class="anchor" href="#project_extensions"></a><a class="link" href="#project_extensions">Project extensions</a></h6>
<div class="paragraph">
<p>Project extensions have both a name and a unique type.
However, the Kotlin DSL only needs to know the type to configure them.</p>
</div>
<div class="paragraph">
<p>The following sample shows the <code>sourceSets {}</code> and <code>java {}</code> blocks from the original example build script.
The <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/configure.html"><code>configure&lt;T&gt;()</code></a> function is used with the corresponding type:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(plugin = "java-library")

configure&lt;SourceSetContainer&gt; {
    named("main") {
        java.srcDir("src/core/java")
    }
}

configure&lt;JavaPluginExtension&gt; {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that <code>sourceSets</code> is a Gradle extension on <code>Project</code> of type <code>SourceSetContainer</code> and <code>java</code> is an extension on <code>Project</code> of type <code>JavaPluginExtension</code>.</p>
</div>
<div class="paragraph">
<p>You can discover available extensions by either reviewing the documentation for the applied plugins or running <code>./gradlew kotlinDslAccessorsReport</code>.
The report generates the Kotlin code needed to access the model elements contributed by the applied plugins, providing both names and types.</p>
</div>
<div class="paragraph">
<p>As a last resort, you can check the plugin&#8217;s source code, though this should not be necessary in most cases.</p>
</div>
<div class="paragraph">
<p>You can also use the <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/the.html"><code>the&lt;T&gt;()</code></a> function if you only need a reference to the extension without configuring it, or if you want to perform a one-line configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">the&lt;SourceSetContainer&gt;()["main"].java.srcDir("src/main/java")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The snippet above also demonstrates one way to configure elements of a project extension that is a container.</p>
</div>
</div>
<div class="sect5">
<h6 id="elements_in_project_extension_containers"><a class="anchor" href="#elements_in_project_extension_containers"></a><a class="link" href="#elements_in_project_extension_containers">Elements in project-extension containers</a></h6>
<div class="paragraph">
<p>Container-based project extensions, such as <code>SourceSetContainer</code>, allow you to configure the elements they hold.</p>
</div>
<div class="paragraph">
<p>In our sample build script, we want to configure a source set named <code>main</code> within the source set container.
We can do this by using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectCollection.html#named-java.lang.String-">named()</a> method instead of an accessor:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(plugin = "java-library")

configure&lt;SourceSetContainer&gt; {
    named("main") {
        java.srcDir("src/core/java")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All elements within a container-based project extension have a name, so you can use this technique in all such cases.</p>
</div>
<div class="paragraph">
<p>For project extensions and conventions, you can discover what elements are present in any container by either checking the documentation for the applied plugins or by running <code>./gradlew kotlinDslAccessorsReport</code>.</p>
</div>
<div class="paragraph">
<p>As a last resort, you may also review the plugin&#8217;s source code to find out what it does.</p>
</div>
</div>
<div class="sect5">
<h6 id="tasks"><a class="anchor" href="#tasks"></a><a class="link" href="#tasks">Tasks</a></h6>
<div class="paragraph">
<p>Tasks are not managed through a container-based project extension, but they are part of a container that behaves in a similar way.</p>
</div>
<div class="paragraph">
<p>This means that you can configure tasks in the same way as you do for source sets.
The following example illustrates this approach:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(plugin = "java-library")

tasks {
    named&lt;Test&gt;("test") {
        testLogging.showExceptions = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We are using the Gradle API to refer to tasks by name and type, rather than using accessors.</p>
</div>
<div class="paragraph">
<p>Note that it is necessary to specify the type of the task explicitly.
If you don&#8217;t, the script won&#8217;t compile because the inferred type will be <code>Task</code>, not <code>Test</code>, and the <code>testLogging</code> property is specific to the <code>Test</code> task type.</p>
</div>
<div class="paragraph">
<p>However, you can omit the type if you only need to configure properties or call methods that are common to all tasks, i.e., those declared on the <code>Task</code> interface.</p>
</div>
<div class="paragraph">
<p>You can discover what tasks are available by running <code>./gradlew tasks</code>.</p>
</div>
<div class="paragraph">
<p>To find out the type of a given task, run <code>./gradlew help --task &lt;taskName&gt;</code>, as demonstrated here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew help --task test
...
Type
     Test (org.gradle.api.tasks.testing.Test)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The IDE can assist you with the required imports, so you only need the simple names of the types, without the package name part.
In this case, there&#8217;s no need to import the <code>Test</code> task type, as it is part of the Gradle API and is therefore <a href="#sec:implicit_imports">imported implicitly</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="kotdsl:containers"><a class="anchor" href="#kotdsl:containers"></a><a class="link" href="#kotdsl:containers">Working with container objects</a></h4>
<div class="paragraph">
<p>The Gradle build model makes extensive use of container objects (or simply "containers").</p>
</div>
<div class="paragraph">
<p>For example, <code>configurations</code> and <code>tasks</code> are containers that hold <code>Configuration</code> and <code>Task</code> objects, respectively.
Community plugins also contribute containers, such as the <code>android.buildTypes</code> container contributed by the Android Plugin.</p>
</div>
<div class="paragraph">
<p>The Kotlin DSL provides multiple ways for build authors to interact with containers.
We will explore each of these methods, using the <code>tasks</code> container as an example.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can leverage the type-safe accessors described in <a href="#kotdsl:accessor_applicability">another section</a> when configuring existing elements on supported containers. That section also explains which containers support type-safe accessors.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="using_the_container_api"><a class="anchor" href="#using_the_container_api"></a><a class="link" href="#using_the_container_api">Using the container API</a></h5>
<div class="paragraph">
<p>All containers in Gradle implement <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.NamedDomainObjectContainer.html#org.gradle.api.NamedDomainObjectContainer">NamedDomainObjectContainer&lt;DomainObjectType&gt;</a>.
Some containers can hold objects of different types and implement <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.PolymorphicDomainObjectContainer.html#org.gradle.api.PolymorphicDomainObjectContainer">PolymorphicDomainObjectContainer&lt;BaseType&gt;</a>.
The simplest way to interact with containers is through these interfaces.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how you can use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.NamedDomainObjectContainer.html#org.gradle.api.NamedDomainObjectContainer:named(java.lang.String)">named()</a> method to configure existing tasks, and the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.NamedDomainObjectContainer.html#org.gradle.api.NamedDomainObjectContainer:register(java.lang.String)">register()</a> method to create new tasks:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named("check")                    // <b class="conum">(1)</b>
tasks.register("myTask1")               // <b class="conum">(2)</b>

tasks.named&lt;JavaCompile&gt;("compileJava") // <b class="conum">(3)</b>
tasks.register&lt;Copy&gt;("myCopy1")         // <b class="conum">(4)</b>

tasks.named("assemble") {               // <b class="conum">(5)</b>
    dependsOn(":myTask1")
}
tasks.register("myTask2") {             // <b class="conum">(6)</b>
    description = "Some meaningful words"
}

tasks.named&lt;Test&gt;("test") {             // <b class="conum">(7)</b>
    testLogging.showStackTraces = true
}
tasks.register&lt;Copy&gt;("myCopy2") {       // <b class="conum">(8)</b>
    from("source")
    into("destination")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Gets a reference of type <code>Task</code> to the existing task named <code>check</code></p>
</li>
<li>
<p>Registers a new untyped task named <code>myTask1</code></p>
</li>
<li>
<p>Gets a reference to the existing task named <code>compileJava</code> of type <code>JavaCompile</code></p>
</li>
<li>
<p>Registers a new task named <code>myCopy1</code> of type <code>Copy</code></p>
</li>
<li>
<p>Gets a reference to the existing (untyped) task named <code>assemble</code> and configures it you can only configure properties and methods that are available on <code>Task</code> with this syntax</p>
</li>
<li>
<p>Registers a new untyped task named <code>myTask2</code> and configures it you can only configure properties and methods that are available on <code>Task</code> in this case</p>
</li>
<li>
<p>Gets a reference to the existing task named <code>test</code> of type <code>Test</code> and configures it in this case you have access to the properties and methods of the specified type</p>
</li>
<li>
<p>Registers a new task named <code>myCopy2</code> of type <code>Copy</code> and configures it</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The above sample relies on the <a href="task_configuration_avoidance.html#task_configuration_avoidance">configuration avoidance APIs</a>. If you need or want to eagerly configure or register container elements, simply replace <code>named()</code> with <code>getByName()</code> and <code>register()</code> with <code>create()</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using_kotlin_delegated_properties"><a class="anchor" href="#using_kotlin_delegated_properties"></a><a class="link" href="#using_kotlin_delegated_properties">Using Kotlin delegated properties</a></h5>
<div class="paragraph">
<p>Another way to interact with containers is via Kotlin delegated properties.
These are particularly useful if you need a reference to a container element that you can use elsewhere in the build.
Additionally, Kotlin delegated properties can easily be renamed via IDE refactoring.</p>
</div>
<div class="paragraph">
<p>The following example achieves the same result as the one in the previous section, but it uses delegated properties and reuses those references instead of string-literal task paths:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val check by tasks.existing
val myTask1 by tasks.registering

val compileJava by tasks.existing(JavaCompile::class)
val myCopy1 by tasks.registering(Copy::class)

val assemble by tasks.existing {
    dependsOn(myTask1)  // <b class="conum">(1)</b>
}
val myTask2 by tasks.registering {
    description = "Some meaningful words"
}

val test by tasks.existing(Test::class) {
    testLogging.showStackTraces = true
}
val myCopy2 by tasks.registering(Copy::class) {
    from("source")
    into("destination")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Uses the reference to the <code>myTask1</code> task rather than a task path</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The above sample relies on the <a href="task_configuration_avoidance.html#task_configuration_avoidance">configuration avoidance APIs</a>. If you need or want to eagerly configure or register container elements, simply replace <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/existing.html"><code>existing()</code></a> with <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/getting.html"><code>getting()</code></a> and <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/registering.html"><code>registering()</code></a> with <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.kotlin.dsl/creating.html"><code>creating()</code></a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="configuring_multiple_container_elements_together"><a class="anchor" href="#configuring_multiple_container_elements_together"></a><a class="link" href="#configuring_multiple_container_elements_together">Configuring multiple container elements together</a></h5>
<div class="paragraph">
<p>When configuring several elements of a container, you can group interactions in a block to avoid repeating the container&#8217;s name on each interaction.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates a combination of type-safe accessors, the container API, and Kotlin delegated properties:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks {
    test {
        testLogging.showStackTraces = true
    }
    val myCheck by registering {
        doLast { /* assert on something meaningful */ }
    }
    check {
        dependsOn(myCheck)
    }
    register("myHelp") {
        doLast { /* do something helpful */ }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="kotdsl:properties"><a class="anchor" href="#kotdsl:properties"></a><a class="link" href="#kotdsl:properties">Working with runtime properties</a></h4>
<div class="paragraph">
<p>Gradle has two main sources of properties defined at runtime: <a href="#sec:project_properties"><em>project properties</em></a> and <a href="writing_build_scripts_intermediate.html#sec:extra_properties"><em>extra properties</em></a>.</p>
</div>
<div class="paragraph">
<p>The Kotlin DSL provides specific syntax for working with these property types, which we will explore in the following sections.</p>
</div>
<div class="sect4">
<h5 id="project_properties"><a class="anchor" href="#project_properties"></a><a class="link" href="#project_properties">Project properties</a></h5>
<div class="paragraph">
<p>The Kotlin DSL allows you to access project properties by binding them via Kotlin delegated properties.</p>
</div>
<div class="paragraph">
<p>The following snippet demonstrates this technique for a couple of project properties, one of which <em>must</em> be defined:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myProperty: String by project  // <b class="conum">(1)</b>
val myNullableProperty: String? by project // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Makes the <code>myProperty</code> project property available via a <code>myProperty</code> delegated property the project property must exist in this case, otherwise the build will fail when the build script attempts to use the <code>myProperty</code> value</p>
</li>
<li>
<p>Does the same for the <code>myNullableProperty</code> project property, but the build won&#8217;t fail on using the <code>myNullableProperty</code> value as long as you check for null (standard <a href="https://kotlinlang.org/docs/reference/null-safety.html">Kotlin rules for null safety</a> apply)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The same approach works in both settings and initialization scripts, except you use <code>by settings</code> and <code>by gradle</code> respectively in place of <code>by project</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="extra_properties"><a class="anchor" href="#extra_properties"></a><a class="link" href="#extra_properties">Extra properties</a></h5>
<div class="paragraph">
<p>Extra properties are available on any object that implements the
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.ExtensionAware.html#org.gradle.api.plugins.ExtensionAware">ExtensionAware</a> interface.</p>
</div>
<div class="paragraph">
<p>In Kotlin DSL, you can access and create extra properties via delegated properties, using the <code>by extra</code> syntax as demonstrated in the following sample:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myNewProperty by extra("initial value")  // <b class="conum">(1)</b>
val myOtherNewProperty by extra { "calculated initial value" }  // <b class="conum">(2)</b>

val myExtraProperty: String by extra  // <b class="conum">(3)</b>
val myExtraNullableProperty: String? by extra  // <b class="conum">(4)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Creates a new extra property called <code>myNewProperty</code> in the current context (the project in this case) and initializes it with the value <code>"initial value"</code>, which also determines the property&#8217;s <em>type</em></p>
</li>
<li>
<p>Create a new extra property whose initial value is calculated by the provided lambda</p>
</li>
<li>
<p>Binds an existing extra property from the current context (the project in this case) to a <code>myProperty</code> reference</p>
</li>
<li>
<p>Does the same as the previous line but allows the property to have a null value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This approach works for all Gradle scripts: project build scripts, script plugins, settings scripts, and initialization scripts.</p>
</div>
<div class="paragraph">
<p>You can also access extra properties on a root project from a subproject using the following syntax:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">my-sub-project/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myNewProperty: String by rootProject.extra  // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Binds the root project&#8217;s <code>myNewProperty</code> extra property to a reference of the same name</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Extra properties aren&#8217;t just limited to projects.
For example, <code>Task</code> extends <code>ExtensionAware</code>, so you can attach extra properties to tasks as well.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example that defines a new <code>myNewTaskProperty</code> on the <code>test</code> task and then uses that property to initialize another task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks {
    test {
        val reportType by extra("dev")  // <b class="conum">(1)</b>
        doLast {
            // Use 'suffix' for post-processing of reports
        }
    }

    register&lt;Zip&gt;("archiveTestReports") {
        val reportType: String by test.get().extra  // <b class="conum">(2)</b>
        archiveAppendix = reportType
        from(test.get().reports.html.outputLocation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Creates a new <code>reportType</code> extra property on the <code>test</code> task</p>
</li>
<li>
<p>Makes the <code>test</code> task&#8217;s <code>reportType</code> extra property available to configure the <code>archiveTestReports</code> task</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you&#8217;re happy to use eager configuration rather than the configuration avoidance APIs, you could use a single, "global" property for the report type, like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    doLast { /* ... */ }
}

val testReportType by tasks.test.get().extra("dev")  // <b class="conum">(1)</b>

tasks.create&lt;Zip&gt;("archiveTestsReports") {
    archiveAppendix = testReportType  // <b class="conum">(2)</b>
    from(test.reports.html.outputLocation)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Creates and initializes an extra property on the <code>test</code> task, binding it to a "global" property</p>
</li>
<li>
<p>Uses the "global" property to initialize the <code>archiveTestReports</code> task</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There is one last syntax for extra properties that treats <code>extra</code> as a map.
We generally recommend against using this, as it bypasses Kotlin&#8217;s type checking and limits IDE support.
However, it is more succinct than the delegated properties syntax and can be used if you only need to set an extra property without referencing it later.</p>
</div>
<div class="paragraph">
<p>Here is a simple example demonstrating how to set and read extra properties using the map syntax:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">extra["myNewProperty"] = "initial value"  // <b class="conum">(1)</b>

tasks.register("myTask") {
    doLast {
        println("Property: ${project.extra["myNewProperty"]}")  // <b class="conum">(2)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Creates a new project extra property called <code>myNewProperty</code> and sets its value</p>
</li>
<li>
<p>Reads the value from the project extra property we created  note the <code>project.</code> qualifier on <code>extra[&#8230;&#8203;]</code>, otherwise Gradle will assume we want to read an extra property from the <em>task</em></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="kotdsl:types"><a class="anchor" href="#kotdsl:types"></a><a class="link" href="#kotdsl:types">Working with Gradle types</a></h4>
<div class="paragraph">
<p><code>Property</code>, <code>Provider</code>, and <code>NamedDomainObjectProvider</code> are <a href="#properties_and_providers">types</a> that represent deferred and lazy evaluation of values and objects.
The Kotlin DSL provides a specialized syntax for working with these types.</p>
</div>
<div class="sect4">
<h5 id="using_a_property"><a class="anchor" href="#using_a_property"></a><a class="link" href="#using_a_property">Using a <code>Property</code></a></h5>
<div class="paragraph">
<p>A property represents a value that can be set and read lazily:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting a value: <code>property.set(value)</code> or <code>property = value</code></p>
</li>
<li>
<p>Accessing the value: <code>property.get()</code></p>
</li>
<li>
<p>Using the delegate syntax: <code>val propValue: String by property</code></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myProperty: Property&lt;String&gt; = project.objects.property(String::class.java)

myProperty.set("Hello, Gradle!") // Set the value
println(myProperty.get())        // Access the value

// Using delegate syntax
val propValue: String by myProperty
println(propValue)

// Using lazy syntax
myProperty = "Hi, Gradle!" // Set the value
println(myProperty.get())  // Access the value</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_a_provider"><a class="anchor" href="#using_a_provider"></a><a class="link" href="#using_a_provider">Using a <code>Provider</code></a></h5>
<div class="paragraph">
<p>A provider represents a read-only, lazily-evaluated value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accessing the value: <code>provider.get()</code></p>
</li>
<li>
<p>Chaining: <code>provider.map { transform(it) }</code></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val versionProvider: Provider&lt;String&gt; = project.provider { "1.0.0" }

println(versionProvider.get()) // Access the value

// Chaining transformations
val majorVersion: Provider&lt;String&gt; = versionProvider.map { it.split(".")[0] }
println(majorVersion.get()) // Prints: "1"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_a_nameddomainobjectprovider"><a class="anchor" href="#using_a_nameddomainobjectprovider"></a><a class="link" href="#using_a_nameddomainobjectprovider">Using a <code>NamedDomainObjectProvider</code></a></h5>
<div class="paragraph">
<p>A named domain object provider represents a lazily-evaluated named object from a Gradle container (like tasks or extensions):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accessing the object: <code>namedObjectProvider.get()</code></p>
</li>
<li>
<p>Configuring the object: <code>namedObjectProvider.configure { &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myTaskProvider: NamedDomainObjectProvider&lt;Task&gt; = tasks.named("build")

// Configuring the task
myTaskProvider.configure {
    doLast {
        println("Build task completed!")
    }
}

// Accessing the task
val myTask: Task = myTaskProvider.get()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="kotdsl:assignment"><a class="anchor" href="#kotdsl:assignment"></a><a class="link" href="#kotdsl:assignment">Lazy property assignment</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s Kotlin DSL supports lazy property assignment using the <code>=</code> operator.</p>
</div>
<div class="paragraph">
<p>Lazy property assignment reduces verbosity when <a href="#lazy_properties">lazy properties</a> are used.
It works for properties that are publicly seen as <code>final</code> (without a setter) and have type <code>Property</code> or <code>ConfigurableFileCollection</code>.
Since properties must be <code>final</code>, we generally recommend avoiding custom setters for properties with lazy types and, if possible, implementing such properties via an abstract getter.</p>
</div>
<div class="paragraph">
<p>Using the <code>=</code> operator is the preferred way to call <code>set()</code> in the Kotlin DSL:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

abstract class WriteJavaVersionTask : DefaultTask() {
    @get:Input
    abstract val javaVersion: Property&lt;String&gt;
    @get:OutputFile
    abstract val output: RegularFileProperty

    @TaskAction
    fun execute() {
        output.get().asFile.writeText("Java version: ${javaVersion.get()}")
    }
}

tasks.register&lt;WriteJavaVersionTask&gt;("writeJavaVersion") {
    javaVersion.set("17") // <b class="conum">(1)</b>
    javaVersion = "17" // <b class="conum">(2)</b>
    javaVersion = java.toolchain.languageVersion.map { it.toString() } // <b class="conum">(3)</b>
    output = layout.buildDirectory.file("writeJavaVersion/javaVersion.txt")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set value with the <code>.set()</code> method</p>
</li>
<li>
<p>Set value with lazy property assignment using the <code>=</code> operator</p>
</li>
<li>
<p>The <code>=</code> operator can be used also for assigning lazy values</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="ide_support"><a class="anchor" href="#ide_support"></a><a class="link" href="#ide_support">IDE support</a></h5>
<div class="paragraph">
<p>Lazy property assignment is supported from IntelliJ 2022.3 and from Android Studio Giraffe.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:kotlin-dsl_plugin"><a class="anchor" href="#sec:kotlin-dsl_plugin"></a><a class="link" href="#sec:kotlin-dsl_plugin">Kotlin DSL Plugin</a></h4>
<div class="paragraph">
<p>The Kotlin DSL Plugin provides a convenient way to develop Kotlin-based projects that contribute build logic.
This includes <a href="#sec:using_buildsrc">buildSrc projects</a>, <a href="#composite_builds">included builds</a>, and <a href="#custom_plugins">Gradle plugins</a>.</p>
</div>
<div class="paragraph">
<p>The plugin achieves this by doing the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Applies the <a href="https://kotlinlang.org/docs/reference/using-gradle.html#targeting-the-jvm">Kotlin Plugin</a>, which adds support for compiling Kotlin source files.</p>
</li>
<li>
<p>Adds the <code>kotlin-stdlib</code>, <code>kotlin-reflect</code>, and <code>gradleKotlinDsl()</code> dependencies to the <code>compileOnly</code> and <code>testImplementation</code> configurations, enabling the use of those Kotlin libraries and the Gradle API in your Kotlin code.</p>
</li>
<li>
<p>Configures the Kotlin compiler with the same settings used for Kotlin DSL scripts, ensuring consistency between your build logic and those scripts:</p>
<div class="ulist">
<ul>
<li>
<p>Adds <a href="#sec:kotlin_compiler_arguments">Kotlin compiler arguments</a>,</p>
</li>
<li>
<p>Registers the <a href="https://kotlinlang.org/docs/sam-with-receiver-plugin.html">SAM-with-receiver Kotlin compiler plugin</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enables support for <a href="#sec:precompile_script_plugin">precompiled script plugins</a>.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Each Gradle release is meant to be used with a specific version of the <code>kotlin-dsl</code> plugin.
Compatibility between arbitrary Gradle releases and <code>kotlin-dsl</code> plugin versions is not guaranteed.
Using an unexpected version of the <code>kotlin-dsl</code> plugin will emit a warning and can cause hard-to-diagnose problems.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This is the basic configuration you need to use the plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}

repositories {
    // The org.jetbrains.kotlin.jvm plugin requires a repository
    // where to download the Kotlin compiler dependencies from.
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Kotlin DSL Plugin leverages <a href="#toolchains">Java Toolchains</a>.
By default, the code will target Java 8.
You can change that by defining a Java toolchain to be used by the project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/myproject.java-conventions.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:kotlin"><a class="anchor" href="#sec:kotlin"></a><a class="link" href="#sec:kotlin">Embedded Kotlin</a></h4>
<div class="paragraph">
<p>Gradle embeds Kotlin in order to provide support for Kotlin-based scripts.</p>
</div>
<div class="sect4">
<h5 id="kotlin_versions"><a class="anchor" href="#kotlin_versions"></a><a class="link" href="#kotlin_versions">Kotlin versions</a></h5>
<div class="paragraph">
<p>Gradle ships with <code>kotlin-compiler-embeddable</code> plus matching versions of <code>kotlin-stdlib</code> and <code>kotlin-reflect</code> libraries.
For details, see the Kotlin section of Gradle&#8217;s <a href="#kotlin">compatibility matrix</a>.
The <code>kotlin</code> package from those modules is visible through the Gradle classpath.</p>
</div>
<div class="paragraph">
<p>The <a href="https://kotlinlang.org/docs/reference/compatibility.html">compatibility</a> guarantees provided by Kotlin apply for both backward and forward compatibility.</p>
</div>
<div class="sect5">
<h6 id="backward_compatibility"><a class="anchor" href="#backward_compatibility"></a><a class="link" href="#backward_compatibility">Backward compatibility</a></h6>
<div class="paragraph">
<p>Our approach is to only make backward-incompatible Kotlin upgrades with major Gradle releases.
We clearly document the Kotlin version shipped with each release and announce upgrade plans ahead of major releases.</p>
</div>
<div class="paragraph">
<p>Plugin authors aiming to maintain compatibility with older Gradle versions must limit their API usage to what is supported by those versions.
This is no different from working with any new API in Gradle.
For example, if a new API for dependency resolution is introduced, a plugin must either drop support for older Gradle versions or organize its code to conditionally execute the new code path on compatible versions.</p>
</div>
</div>
<div class="sect5">
<h6 id="forward_compatibility"><a class="anchor" href="#forward_compatibility"></a><a class="link" href="#forward_compatibility">Forward compatibility</a></h6>
<div class="paragraph">
<p>The primary compatibility concern lies between the external <code>kotlin-gradle-plugin</code> version and the <code>kotlin-stdlib</code> version shipped with Gradle.
More broadly, this applies to any plugin that transitively depends on <code>kotlin-stdlib</code> and its version provided by Gradle.
As long as the versions are compatible, everything should work as expected.
This issue will diminish as the Kotlin language matures.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:kotlin_compiler_arguments"><a class="anchor" href="#sec:kotlin_compiler_arguments"></a><a class="link" href="#sec:kotlin_compiler_arguments">Kotlin compiler arguments</a></h5>
<div class="paragraph">
<p>The following Kotlin compiler arguments are used for compiling Kotlin DSL scripts, as well as Kotlin sources and scripts in projects with the <code>kotlin-dsl</code> plugin applied:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-java-parameters</code></dt>
<dd>
<p>Generate metadata for Java &gt;= 1.8 reflection on method parameters.
See <a href="https://kotlinlang.org/docs/compiler-reference.html#kotlin-jvm-compiler-options">Kotlin/JVM compiler options</a> in the Kotlin documentation for more information.</p>
</dd>
<dt class="hdlist1"><code>-Xjvm-default=all</code></dt>
<dd>
<p>Makes all non-abstract members of Kotlin interfaces default for the Java classes implementing them.
This is to provide a better interoperability with Java and Groovy for plugins written in Kotlin.
See <a href="https://kotlinlang.org/docs/java-to-kotlin-interop.html#default-methods-in-interfaces">Default methods in interfaces</a> in the Kotlin documentation for more information.</p>
</dd>
<dt class="hdlist1"><code>-Xsam-conversions=class</code></dt>
<dd>
<p>Sets up the implementation strategy for SAM (single abstract method) conversion to always generate anonymous classes, instead of using the <code>invokedynamic</code> JVM instruction.
This is to provide a better support for configuration cache and incremental build.
See <a href="https://youtrack.jetbrains.com/issue/KT-44912">KT-44912</a> in the Kotlin issue tracker for more information.</p>
</dd>
<dt class="hdlist1"><code>-Xjsr305=strict</code> &amp; <code>-Xjspecify-annotations=strict</code></dt>
<dd>
<p>Sets up Kotlin&#8217;s Java interoperability to strictly follow JSR-305 and JSpecify annotations for increased null safety.
See <a href="https://kotlinlang.org/docs/reference/java-interop.html#compiler-configuration">Calling Java code from Kotlin</a> in the Kotlin documentation for more information.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:interoperability"><a class="anchor" href="#sec:interoperability"></a><a class="link" href="#sec:interoperability">Interoperability</a></h4>
<div class="paragraph">
<p>When mixing languages in your build logic, you may have to cross language boundaries.
An extreme example would be a build that uses tasks and plugins that are implemented in Java, Groovy and Kotlin, while also using both Kotlin DSL and Groovy DSL build scripts.</p>
</div>
<div class="quoteblock">
<blockquote>
Kotlin is designed with Java Interoperability in mind. Existing Java code can be called from Kotlin in a natural way, and Kotlin code can be used from Java rather smoothly as well.
</blockquote>
<div class="attribution">
&#8212; Kotlin reference documentation
</div>
</div>
<div class="paragraph">
<p>Both <a href="https://kotlinlang.org/docs/reference/java-interop.html">calling Java from Kotlin</a> and <a href="https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html">calling Kotlin from Java</a> are very well covered in the Kotlin reference documentation.</p>
</div>
<div class="paragraph">
<p>The same mostly applies to interoperability with Groovy code.
In addition, the Kotlin DSL provides several ways to opt into Groovy semantics, which we look at next.</p>
</div>
<div class="sect4">
<h5 id="static_extensions"><a class="anchor" href="#static_extensions"></a><a class="link" href="#static_extensions">Static extensions</a></h5>
<div class="paragraph">
<p>Both the Groovy and Kotlin languages support extending existing classes via <a href="https://groovy-lang.org/metaprogramming.html#_extension_modules">Groovy Extension modules</a> and <a href="https://kotlinlang.org/docs/reference/extensions.html">Kotlin extensions</a>.</p>
</div>
<div class="paragraph">
<p>To call a Kotlin extension function from Groovy, call it as a static function, passing the receiver as the first parameter:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">TheTargetTypeKt.kotlinExtensionFunction(receiver, "parameters", 42, aReference)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Kotlin extension functions are package-level functions.
You can learn how to locate the name of the type declaring a given Kotlin extension in the <a href="https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html#package-level-functions">Package-Level Functions</a> section of the Kotlin reference documentation.</p>
</div>
<div class="paragraph">
<p>To call a Groovy extension method from Kotlin, the same approach applies: call it as a static function passing the receiver as the first parameter:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">TheTargetTypeGroovyExtension.groovyExtensionMethod(receiver, "parameters", 42, aReference)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="named_parameters_and_default_arguments"><a class="anchor" href="#named_parameters_and_default_arguments"></a><a class="link" href="#named_parameters_and_default_arguments">Named parameters and default arguments</a></h5>
<div class="paragraph">
<p>Both the Groovy and Kotlin languages support named function parameters and default arguments, although they are implemented very differently.
Kotlin has fully-fledged support for both, as described in the Kotlin language reference under<a href="https://kotlinlang.org/docs/reference/functions.html#named-arguments">named arguments</a> and <a href="https://kotlinlang.org/docs/reference/functions.html#default-arguments">default arguments</a>.
Groovy implements <a href="https://groovy-lang.org/objectorientation.html#_named_arguments">named arguments</a> in a non-type-safe way based on a <code>Map&lt;String, ?&gt;</code> parameter, which means they cannot be combined with <a href="https://groovy-lang.org/objectorientation.html#_default_arguments">default arguments</a>.
In other words, you can only use one or the other in Groovy for any given method.</p>
</div>
<div class="sect5">
<h6 id="calling_kotlin_from_groovy"><a class="anchor" href="#calling_kotlin_from_groovy"></a><a class="link" href="#calling_kotlin_from_groovy">Calling Kotlin from Groovy</a></h6>
<div class="paragraph">
<p>To call a Kotlin function that has named arguments from Groovy, just use a normal method call with positional parameters:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">kotlinFunction("value1", "value2", 42)</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no way to provide values by argument name.</p>
</div>
<div class="paragraph">
<p>To call a Kotlin function that has default arguments from Groovy, always pass values for all the function parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="calling_groovy_from_kotlin"><a class="anchor" href="#calling_groovy_from_kotlin"></a><a class="link" href="#calling_groovy_from_kotlin">Calling Groovy from Kotlin</a></h6>
<div class="paragraph">
<p>To call a Groovy function with named arguments from Kotlin, you need to pass a <code>Map&lt;String, ?&gt;</code>, as shown in this example:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">groovyNamedArgumentTakingMethod(mapOf(
    "parameterName" to "value",
    "other" to 42,
    "and" to aReference))</code></pre>
</div>
</div>
<div class="paragraph">
<p>To call a Groovy function with default arguments from Kotlin, always pass values for all the parameters.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="groovy_closures_from_kotlin"><a class="anchor" href="#groovy_closures_from_kotlin"></a><a class="link" href="#groovy_closures_from_kotlin">Groovy closures from Kotlin</a></h5>
<div class="paragraph">
<p>You may sometimes have to call Groovy methods that take <a href="https://groovy-lang.org/closures.html">Closure</a> arguments from Kotlin code.
For example, some third-party plugins written in Groovy expect closure arguments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle plugins written in any language should prefer the type <code>Action&lt;T&gt;</code> type in place of closures. Groovy closures and Kotlin lambdas are automatically mapped to arguments of that type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to provide a way to construct closures while preserving Kotlin&#8217;s strong typing, two helper methods exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>closureOf&lt;T&gt; {}</code></p>
</li>
<li>
<p><code>delegateClosureOf&lt;T&gt; {}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both methods are useful in different circumstances and depend upon the method you are passing the <code>Closure</code> instance into.</p>
</div>
<div class="paragraph">
<p>Some plugins expect simple closures, as with the <a href="https://plugins.gradle.org/plugin/com.jfrog.bintray">Bintray</a> plugin:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">bintray {
    pkg(closureOf&lt;PackageConfig&gt; {
        // Config for the package here
    })
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In other cases, like with the <a href="https://plugins.gradle.org/plugin/org.gretty">Gretty Plugin</a> when configuring farms, the plugin expects a delegate closure:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">farms {
    farm("OldCoreWar", delegateClosureOf&lt;FarmExtension&gt; {
        // Config for the war here
    })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There sometimes isn&#8217;t a good way to tell, from looking at the source code, which version to use.
Usually, if you get a <code>NullPointerException</code> with <code>closureOf&lt;T&gt; {}</code>, using <code>delegateClosureOf&lt;T&gt; {}</code>
will resolve the problem.</p>
</div>
<div class="paragraph">
<p>These two utility functions are useful for <em>configuration closures</em>, but some plugins might expect Groovy closures for other purposes.
The <code>KotlinClosure0</code> to <code>KotlinClosure2</code> types allows adapting Kotlin functions to Groovy closures with more flexibility:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">somePlugin {

    // Adapt parameter-less function
    takingParameterLessClosure(KotlinClosure0({
        "result"
    }))

    // Adapt unary function
    takingUnaryClosure(KotlinClosure1&lt;String, String&gt;({
        "result from single parameter $this"
    }))

    // Adapt binary function
    takingBinaryClosure(KotlinClosure2&lt;String, String, String&gt;({ a, b -&gt;
        "result from parameters $a and $b"
    }))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="the_kotlin_dsl_groovy_builder"><a class="anchor" href="#the_kotlin_dsl_groovy_builder"></a><a class="link" href="#the_kotlin_dsl_groovy_builder">The Kotlin DSL Groovy Builder</a></h5>
<div class="paragraph">
<p>If some plugin makes heavy use of <a href="https://groovy-lang.org/metaprogramming.html">Groovy metaprogramming</a>, then using it from Kotlin or Java or any statically-compiled language can be very cumbersome.</p>
</div>
<div class="paragraph">
<p>The Kotlin DSL provides a <code>withGroovyBuilder {}</code> utility extension that attaches the Groovy metaprogramming semantics to objects of type <code>Any</code>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates several features of the method on the object <code>target</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">target.withGroovyBuilder {                                          // <b class="conum">(1)</b>

    // GroovyObject methods available                               // <b class="conum">(2)</b>
    if (hasProperty("foo")) { /*...*/ }
    val foo = getProperty("foo")
    setProperty("foo", "bar")
    invokeMethod("name", arrayOf("parameters", 42, aReference))

    // Kotlin DSL utilities
    "name"("parameters", 42, aReference)                            // <b class="conum">(3)</b>
        "blockName" {                                               // <b class="conum">(4)</b>
            // Same Groovy Builder semantics on `blockName`
        }
    "another"("name" to "example", "url" to "https://example.com/") // <b class="conum">(5)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The receiver is a <a href="https://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyObject.html">GroovyObject</a> and provides Kotlin helpers</p>
</li>
<li>
<p>The <code>GroovyObject</code> API is available</p>
</li>
<li>
<p>Invoke the <code>methodName</code> method, passing some parameters</p>
</li>
<li>
<p>Configure the <code>blockName</code> property, maps to a <code>Closure</code> taking method invocation</p>
</li>
<li>
<p>Invoke <code>another</code> method taking named arguments, maps to a Groovy named arguments <code>Map&lt;String, ?&gt;</code> taking method invocation</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="using_a_groovy_script"><a class="anchor" href="#using_a_groovy_script"></a><a class="link" href="#using_a_groovy_script">Using a Groovy script</a></h5>
<div class="paragraph">
<p>Another option when dealing with problematic plugins that assume a Groovy DSL build script is to configure them in a Groovy DSL build script that is applied from the main Kotlin DSL build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">dynamic-groovy-plugin-configuration.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">native {    // <b class="conum">(1)</b>
    dynamic {
        groovy as Usual
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("dynamic-groovy-plugin") version "1.0"   // <b class="conum">(2)</b>
}
apply(from = "dynamic-groovy-plugin-configuration.gradle")  // <b class="conum">(3)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The Groovy script uses dynamic Groovy to configure plugin</p>
</li>
<li>
<p>The Kotlin build script requests and applies the plugin</p>
</li>
<li>
<p>The Kotlin build script applies the Groovy script</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting"><a class="anchor" href="#sec:troubleshooting"></a><a class="link" href="#sec:troubleshooting">Troubleshooting</a></h4>
<div class="paragraph">
<p>The IDE support is provided by two components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Kotlin Plugin (used by IntelliJ IDEA/Android Studio).</p>
</li>
<li>
<p>Gradle.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The level of support varies based on the versions of each.</p>
</div>
<div class="paragraph">
<p>If you encounter issues, first run <code>./gradlew tasks</code> from the command line to determine if the problem is specific to the IDE.
If the issue persists on the command line, it likely originates from the build itself rather than IDE integration.</p>
</div>
<div class="paragraph">
<p>However, if the build runs successfully on the command line but your script editor reports errors, try restarting your IDE and invalidating its caches.</p>
</div>
<div class="paragraph">
<p>If the issue persists, and you suspect a problem with the Kotlin DSL script editor, try the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <code>./gradlew tasks</code> to gather more details.</p>
</li>
<li>
<p>Check the logs in one of these locations:</p>
<div class="ulist">
<ul>
<li>
<p><code>$HOME/Library/Logs/gradle-kotlin-dsl</code> on macOS</p>
</li>
<li>
<p><code>$HOME/.gradle-kotlin-dsl/log</code> on Linux</p>
</li>
<li>
<p><code>$HOME/AppData/Local/gradle-kotlin-dsl/log</code> on Windows</p>
</li>
</ul>
</div>
</li>
<li>
<p>Report the issue on the <a href="https://github.com/gradle/gradle/issues/">Gradle issue tracker</a>, including as much detail as possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From version 5.1 onward, the log directory is automatically cleaned.
Logs are checked periodically (at most, every 24 hours), and files are deleted if unused for 7 days.</p>
</div>
<div class="paragraph">
<p>If this doesnt help pinpoint the problem, you can enable the <code>org.gradle.kotlin.dsl.logging.tapi</code> system property in your IDE.
This causes the Gradle Daemon to log additional details in its log file located at <code>$HOME/.gradle/daemon</code>.</p>
</div>
<div class="paragraph">
<p>In IntelliJ IDEA, enable this property by navigating to <code>Help &gt; Edit Custom VM Options&#8230;&#8203;</code> and adding: <code>-Dorg.gradle.kotlin.dsl.logging.tapi=true</code>.</p>
</div>
<div class="paragraph">
<p>For IDE problems outside the Kotlin DSL script editor, please open issues in the corresponding IDE&#8217;s issue tracker:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="">JetBrains&#8217;s IDEA issue tracker</a></p>
</li>
<li>
<p><a href="">Google&#8217;s Android Studio issue tracker</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Lastly, if you face problems with Gradle itself or with the Kotlin DSL, please open issues on the <a href="https://github.com/gradle/gradle/issues/">Gradle issue tracker</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="kotdsl:limitations"><a class="anchor" href="#kotdsl:limitations"></a><a class="link" href="#kotdsl:limitations">Limitations</a></h4>
<div class="ulist">
<ul>
<li>
<p>The Kotlin DSL is <a href="https://github.com/gradle/gradle/issues/15886">known to be slower than the Groovy DSL</a> on first use, for example with clean checkouts or on ephemeral continuous integration agents.
Changing something in the <em>buildSrc</em> directory also has an impact as it invalidates build-script caching.
The main reason for this is the slower script compilation for Kotlin DSL.</p>
</li>
<li>
<p>In IntelliJ IDEA, you must <a href="https://www.jetbrains.com/help/idea/gradle.html#gradle_import">import your project from the Gradle model</a> in order to get content assist and refactoring support for your Kotlin DSL build scripts.</p>
</li>
<li>
<p>Kotlin DSL script compilation avoidance has known issues.
If you encounter problems, it can be disabled by <a href="#sec:gradle_system_properties">setting</a> the <code>org.gradle.kotlin.dsl.scriptCompilationAvoidance</code> system property to <code>false</code>.</p>
</li>
<li>
<p>The Kotlin DSL will not support the <code>model {}</code> block, which is part of the <a href="https://blog.gradle.org/state-and-future-of-the-gradle-software-model">discontinued Gradle Software Model</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you run into trouble or discover a suspected bug, please report the issue in the <a href="https://github.com/gradle/gradle/issues/">Gradle issue tracker</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="script-default-imports"><a class="anchor" href="#script-default-imports"></a><a class="link" href="#script-default-imports">Default Imports</a></h3>
<div class="paragraph">
<p>To make build scripts more concise, Gradle automatically adds a set of import statements to scripts.</p>
</div>
<div class="paragraph">
<p>Gradle implicitly adds the following imports to each script (for both Groovy and Kotlin):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">import org.gradle.*
import org.gradle.api.*
import org.gradle.api.artifacts.*
import org.gradle.api.artifacts.capability.*
import org.gradle.api.artifacts.component.*
import org.gradle.api.artifacts.dsl.*
import org.gradle.api.artifacts.ivy.*
import org.gradle.api.artifacts.maven.*
import org.gradle.api.artifacts.query.*
import org.gradle.api.artifacts.repositories.*
import org.gradle.api.artifacts.result.*
import org.gradle.api.artifacts.transform.*
import org.gradle.api.artifacts.type.*
import org.gradle.api.artifacts.verification.*
import org.gradle.api.attributes.*
import org.gradle.api.attributes.java.*
import org.gradle.api.attributes.plugin.*
import org.gradle.api.cache.*
import org.gradle.api.capabilities.*
import org.gradle.api.component.*
import org.gradle.api.configuration.*
import org.gradle.api.credentials.*
import org.gradle.api.distribution.*
import org.gradle.api.distribution.plugins.*
import org.gradle.api.execution.*
import org.gradle.api.file.*
import org.gradle.api.flow.*
import org.gradle.api.initialization.*
import org.gradle.api.initialization.definition.*
import org.gradle.api.initialization.dsl.*
import org.gradle.api.initialization.resolve.*
import org.gradle.api.invocation.*
import org.gradle.api.java.archives.*
import org.gradle.api.jvm.*
import org.gradle.api.launcher.cli.*
import org.gradle.api.logging.*
import org.gradle.api.logging.configuration.*
import org.gradle.api.model.*
import org.gradle.api.plugins.*
import org.gradle.api.plugins.antlr.*
import org.gradle.api.plugins.catalog.*
import org.gradle.api.plugins.jvm.*
import org.gradle.api.plugins.quality.*
import org.gradle.api.plugins.scala.*
import org.gradle.api.problems.*
import org.gradle.api.project.*
import org.gradle.api.provider.*
import org.gradle.api.publish.*
import org.gradle.api.publish.ivy.*
import org.gradle.api.publish.ivy.plugins.*
import org.gradle.api.publish.ivy.tasks.*
import org.gradle.api.publish.maven.*
import org.gradle.api.publish.maven.plugins.*
import org.gradle.api.publish.maven.tasks.*
import org.gradle.api.publish.plugins.*
import org.gradle.api.publish.tasks.*
import org.gradle.api.reflect.*
import org.gradle.api.reporting.*
import org.gradle.api.reporting.components.*
import org.gradle.api.reporting.dependencies.*
import org.gradle.api.reporting.dependents.*
import org.gradle.api.reporting.model.*
import org.gradle.api.reporting.plugins.*
import org.gradle.api.resources.*
import org.gradle.api.services.*
import org.gradle.api.specs.*
import org.gradle.api.tasks.*
import org.gradle.api.tasks.ant.*
import org.gradle.api.tasks.application.*
import org.gradle.api.tasks.bundling.*
import org.gradle.api.tasks.compile.*
import org.gradle.api.tasks.diagnostics.*
import org.gradle.api.tasks.diagnostics.artifact.transforms.*
import org.gradle.api.tasks.diagnostics.configurations.*
import org.gradle.api.tasks.incremental.*
import org.gradle.api.tasks.javadoc.*
import org.gradle.api.tasks.options.*
import org.gradle.api.tasks.scala.*
import org.gradle.api.tasks.testing.*
import org.gradle.api.tasks.testing.junit.*
import org.gradle.api.tasks.testing.junitplatform.*
import org.gradle.api.tasks.testing.testng.*
import org.gradle.api.tasks.util.*
import org.gradle.api.tasks.wrapper.*
import org.gradle.api.toolchain.management.*
import org.gradle.authentication.*
import org.gradle.authentication.aws.*
import org.gradle.authentication.http.*
import org.gradle.build.event.*
import org.gradle.buildconfiguration.tasks.*
import org.gradle.buildinit.*
import org.gradle.buildinit.plugins.*
import org.gradle.buildinit.specs.*
import org.gradle.buildinit.tasks.*
import org.gradle.caching.*
import org.gradle.caching.configuration.*
import org.gradle.caching.http.*
import org.gradle.caching.local.*
import org.gradle.concurrent.*
import org.gradle.external.javadoc.*
import org.gradle.ide.visualstudio.*
import org.gradle.ide.visualstudio.plugins.*
import org.gradle.ide.visualstudio.tasks.*
import org.gradle.ide.xcode.*
import org.gradle.ide.xcode.plugins.*
import org.gradle.ide.xcode.tasks.*
import org.gradle.ivy.*
import org.gradle.jvm.*
import org.gradle.jvm.application.scripts.*
import org.gradle.jvm.application.tasks.*
import org.gradle.jvm.tasks.*
import org.gradle.jvm.toolchain.*
import org.gradle.language.*
import org.gradle.language.assembler.*
import org.gradle.language.assembler.plugins.*
import org.gradle.language.assembler.tasks.*
import org.gradle.language.base.*
import org.gradle.language.base.artifact.*
import org.gradle.language.base.compile.*
import org.gradle.language.base.plugins.*
import org.gradle.language.base.sources.*
import org.gradle.language.c.*
import org.gradle.language.c.plugins.*
import org.gradle.language.c.tasks.*
import org.gradle.language.cpp.*
import org.gradle.language.cpp.plugins.*
import org.gradle.language.cpp.tasks.*
import org.gradle.language.java.artifact.*
import org.gradle.language.jvm.tasks.*
import org.gradle.language.nativeplatform.*
import org.gradle.language.nativeplatform.tasks.*
import org.gradle.language.objectivec.*
import org.gradle.language.objectivec.plugins.*
import org.gradle.language.objectivec.tasks.*
import org.gradle.language.objectivecpp.*
import org.gradle.language.objectivecpp.plugins.*
import org.gradle.language.objectivecpp.tasks.*
import org.gradle.language.plugins.*
import org.gradle.language.rc.*
import org.gradle.language.rc.plugins.*
import org.gradle.language.rc.tasks.*
import org.gradle.language.scala.tasks.*
import org.gradle.language.swift.*
import org.gradle.language.swift.plugins.*
import org.gradle.language.swift.tasks.*
import org.gradle.maven.*
import org.gradle.model.*
import org.gradle.nativeplatform.*
import org.gradle.nativeplatform.platform.*
import org.gradle.nativeplatform.plugins.*
import org.gradle.nativeplatform.tasks.*
import org.gradle.nativeplatform.test.*
import org.gradle.nativeplatform.test.cpp.*
import org.gradle.nativeplatform.test.cpp.plugins.*
import org.gradle.nativeplatform.test.cunit.*
import org.gradle.nativeplatform.test.cunit.plugins.*
import org.gradle.nativeplatform.test.cunit.tasks.*
import org.gradle.nativeplatform.test.googletest.*
import org.gradle.nativeplatform.test.googletest.plugins.*
import org.gradle.nativeplatform.test.plugins.*
import org.gradle.nativeplatform.test.tasks.*
import org.gradle.nativeplatform.test.xctest.*
import org.gradle.nativeplatform.test.xctest.plugins.*
import org.gradle.nativeplatform.test.xctest.tasks.*
import org.gradle.nativeplatform.toolchain.*
import org.gradle.nativeplatform.toolchain.plugins.*
import org.gradle.normalization.*
import org.gradle.platform.*
import org.gradle.platform.base.*
import org.gradle.platform.base.binary.*
import org.gradle.platform.base.component.*
import org.gradle.platform.base.plugins.*
import org.gradle.plugin.devel.*
import org.gradle.plugin.devel.plugins.*
import org.gradle.plugin.devel.tasks.*
import org.gradle.plugin.management.*
import org.gradle.plugin.use.*
import org.gradle.plugins.ear.*
import org.gradle.plugins.ear.descriptor.*
import org.gradle.plugins.ide.*
import org.gradle.plugins.ide.api.*
import org.gradle.plugins.ide.eclipse.*
import org.gradle.plugins.ide.idea.*
import org.gradle.plugins.signing.*
import org.gradle.plugins.signing.signatory.*
import org.gradle.plugins.signing.signatory.pgp.*
import org.gradle.plugins.signing.type.*
import org.gradle.plugins.signing.type.pgp.*
import org.gradle.process.*
import org.gradle.swiftpm.*
import org.gradle.swiftpm.plugins.*
import org.gradle.swiftpm.tasks.*
import org.gradle.testing.base.*
import org.gradle.testing.base.plugins.*
import org.gradle.testing.jacoco.plugins.*
import org.gradle.testing.jacoco.tasks.*
import org.gradle.testing.jacoco.tasks.rules.*
import org.gradle.testkit.runner.*
import org.gradle.util.*
import org.gradle.vcs.*
import org.gradle.vcs.git.*
import org.gradle.work.*
import org.gradle.workers.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, for Groovy, the following imports are added too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">import java.lang.*
import java.io.*
import java.net.*
import java.util.*
import java.time.*
import java.math.BigDecimal
import java.math.BigInteger
import javax.inject.Inject</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="best_practices"><a class="anchor" href="#best_practices"></a><a class="link" href="#best_practices">BEST PRACTICES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="best_practices"><a class="anchor" href="#best_practices"></a><a class="link" href="#best_practices">Best Practices for Authoring Gradle Builds</a></h3>
<div class="sect3">
<h4 id="introduction"><a class="anchor" href="#introduction"></a><a class="link" href="#introduction">Introduction</a></h4>
<div class="paragraph">
<p>Gradle is a powerful and flexible tool for building software, but along with these benefits comes complexity and the need for clear guidance on best practices.
There are many scenarios where how to best use Gradle is unclear, as Gradle provides several ways of accomplishing the same goals.
Often there is a need to determine if a current solution is likely to cause problems down the line, or if problems could have been avoided in advance by using Gradle differently.
This guide aims to help Gradle authors navigate these scenarios and make informed decisions about how to use Gradle effectively.</p>
</div>
<div class="sect4">
<h5 id="what_this_guide_is"><a class="anchor" href="#what_this_guide_is"></a><a class="link" href="#what_this_guide_is">What this Guide is</a></h5>
<div class="paragraph">
<p>This section outlines best practices for authoring Gradle builds that are maintainable, function properly, and are aligned with Gradle&#8217;s core design philosophy.
Some of these practices are things to do, and some are things to avoid doing.</p>
</div>
<div class="paragraph">
<p>This guide is informed by real-world experience in some of the largest software ecosystems using Gradle.
It targets all levels of Gradle expertise, from beginners to advanced users.
Not every practice here will be applicable to every build, however these are meant to be widely applicable and beneficial to many different usage scenarios.</p>
</div>
<div class="paragraph">
<p>This guide is <strong>not</strong> meant as instructions for how to use Gradle.
For that purpose, we provide extensive tutorials and reference materials <a href="getting_started_eng.html#introduction">elsewhere</a> in the Gradle documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="principles"><a class="anchor" href="#principles"></a><a class="link" href="#principles">Principles</a></h5>
<div class="paragraph">
<p>The items in this guide are meant to be <em>brief</em>, <em>understandable</em>, and <em>actionable</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Build authors should be able to quickly recognize when they are following best practices and when they are not.</p>
</li>
<li>
<p>After reading, they should understand why a particular approach is beneficial or problematic and where to find further reference material.</p>
</li>
<li>
<p>Recommendations should be widely applicable to <em>many</em> or <em>most</em> typical builds and should provide specific, concrete advice.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="index"><a class="anchor" href="#index"></a><a class="link" href="#index">Index</a></h4>
<div class="paragraph">
<p>To view all Gradle Best Practices at a glance, along with the Gradle version they were introduced in, visit the <a href="#best_practices_index">Index Page</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="best_practices_2"><a class="anchor" href="#best_practices_2"></a><a class="link" href="#best_practices_2">Best Practices</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="#best_practices_general">General Best Practices</a></p>
</li>
<li>
<p><a href="#best_practices_structuring_builds">Best Practices for Structuring Builds</a></p>
</li>
<li>
<p><a href="#best_practices_for_dependencies">Best Practices for Dependencies</a></p>
</li>
<li>
<p><a href="#best_practices_for_tasks">Best Practices for Tasks</a></p>
</li>
<li>
<p><a href="#best_practices_for_performance">Best Practices for Performance</a></p>
</li>
<li>
<p><a href="#best_practices_for_security">Best Practices for Security</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="other_advice"><a class="anchor" href="#other_advice"></a><a class="link" href="#other_advice">Other Advice</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="#performance_gradle">Improving the Performance of Gradle Builds</a></p>
</li>
<li>
<p><a href="#sec:structuring_recommendations">Structuring Gradle Builds</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="references"><a class="anchor" href="#references"></a><a class="link" href="#references">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="tags_reference.html#tags_reference">Tags Used in Best Practices</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_index"><a class="anchor" href="#best_practices_index"></a><a class="link" href="#best_practices_index">Best Practices Index</a></h3>
<div class="paragraph">
<p>The table below provides a complete list of documented Gradle Best Practices.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>There are currently <strong>27 Best Practices</strong>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Use this as a quick reference to track newly added recommendations, check adoption status, or explore areas for improving your build:</p>
</div>
<table class="tableblock frame-all grid-all stretch table">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Title</th>
<th class="tableblock halign-left valign-top">Section</th>
<th class="tableblock halign-left valign-top">Added in Gradle Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_kotlin_dsl">Use Kotlin DSL</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_latest_minor_versions">Use the Latest Minor Version of Gradle</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_the_plugins_block">Apply Plugins Using the plugins Block</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#do_not_use_internal_apis">Do Not Use Internal APIs</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_the_gradle_properties_file">Set build flags in gradle.properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#modularize_builds">Modularize Your Builds</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structuring Builds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#no_source_in_root">Do Not Put Source Files in the Root Project</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structuring Builds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#favor_composite_builds">Favor build-logic Composite Builds for Build Logic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structuring Builds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_empty_projects">Avoid Unintentionally Creating Empty Projects</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structuring Builds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#single-gav-string">Single GAV String</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_version_catalogs">Use Version Catalogs to Centralize Dependency Versions</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#name_version_catalog_entries">Name Version Catalog Entries Appropriately</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#set_up_repositories_in_settings">Set up your Dependency Repositories in the Settings file</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dont_depend_on_kotlin_stdlib">Dont Explicitly Depend on the Kotlin Standard Library</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_duplicate_dependencies">Avoid Redundant Dependency Declarations</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_content_filtering">Use Content Filtering with multiple Repositories</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_depends_on">Avoid DependsOn</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_cacheability_annotations">Favor @CacheableTask and @DisableCachingByDefault over cacheIf(Spec) and doNotCacheIf(String, Spec)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#group_describe_tasks">Group and Describe custom Tasks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_provider_get_outside_task_action">Do not call <code>get()</code> on a Provider outside a Task action</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dont_resolve_configurations_before_task_execution">Don&#8217;t resolve Configurations before Task Execution</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_eager_file_collection_apis">Avoid using eager APIs on File Collections</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_utf8_encoding">Enable UTF8</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_build_cache">Use the Build Cache</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#use_configuration_cache">Use the Configuration Cache</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#avoid_computations_in_configuration_phase">Avoid Expensive Computations in Configuration Phase</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#best_practices_for_security">Validate the Gradle Distribution SHA-256 Checksum</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.1.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="best_practices_general"><a class="anchor" href="#best_practices_general"></a><a class="link" href="#best_practices_general">General Gradle Best Practices</a></h3>
<div class="sect3">
<h4 id="use_kotlin_dsl"><a class="anchor" href="#use_kotlin_dsl"></a><a class="link" href="#use_kotlin_dsl">Use Kotlin DSL</a></h4>
<div class="paragraph">
<p>Prefer the Kotlin DSL (<code>build.gradle.kts</code>) over the Groovy DSL (<code>build.gradle</code>) when authoring new builds or creating new subprojects in existing builds.</p>
</div>
<div class="sect4">
<h5 id="explanation"><a class="anchor" href="#explanation"></a><a class="link" href="#explanation">Explanation</a></h5>
<div class="paragraph">
<p>The Kotlin DSL offers several advantages over the Groovy DSL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Strict typing</strong>: IDEs provide better auto-completion and navigation with the Kotlin DSL.</p>
</li>
<li>
<p><strong>Improved readability</strong>: Code written in Kotlin is often easier to follow and understand.</p>
</li>
<li>
<p><strong>Single-language stack</strong>: Projects that already use Kotlin for production and test code dont need to introduce Groovy just for the build.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since Gradle 8.0, <a href="https://blog.gradle.org/kotlin-dsl-is-now-the-default-for-new-gradle-builds">Kotlin DSL is the default</a> for new builds created with <code>gradle init</code>.
Android Studio also <a href="https://developer.android.com/build/migrate-to-kotlin-dsl#timeline">defaults to Kotlin DSL</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="references_2"><a class="anchor" href="#references_2"></a><a class="link" href="#references_2">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#kotdsl:kotlin_dsl">Kotlin DSL Primer</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags"><a class="anchor" href="#tags"></a><a class="link" href="#tags">Tags</a></h5>
<div class="paragraph">
<p><a href="tags_reference.html#tag:kotlin-dsl"><code>#kotlin-dsl</code></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_latest_minor_versions"><a class="anchor" href="#use_latest_minor_versions"></a><a class="link" href="#use_latest_minor_versions">Use the Latest Minor Version of Gradle</a></h4>
<div class="paragraph">
<p>Stay on the latest minor version of the major Gradle release you&#8217;re using, and regularly update your plugins to the latest compatible versions.</p>
</div>
<div class="sect4">
<h5 id="explanation_2"><a class="anchor" href="#explanation_2"></a><a class="link" href="#explanation_2">Explanation</a></h5>
<div class="paragraph">
<p>Gradle follows a fairly predictable, time-based release cadence.
Only the latest minor version of the current and previous major release is actively supported.</p>
</div>
<div class="paragraph">
<p>We recommend the following strategy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Try upgrading directly to the latest minor version of your current major Gradle release.</p>
</li>
<li>
<p>If that fails, upgrade one minor version at a time to isolate regressions or compatibility issues.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each new minor version includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Performance and stability improvements.</p>
</li>
<li>
<p>Deprecation warnings that help you prepare for the next major release.</p>
</li>
<li>
<p>Fixes for known bugs and security vulnerabilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the <code>wrapper</code> task to update your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew wrapper --gradle-version &lt;version&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also install the latest Gradle versions easily using tools like <a href="https://sdkman.io/">SDKMAN!</a> or <a href="https://brew.sh/">Homebrew</a>, depending on your platform.</p>
</div>
</div>
<div class="sect4">
<h5 id="plugin_compatibility"><a class="anchor" href="#plugin_compatibility"></a><a class="link" href="#plugin_compatibility">Plugin Compatibility</a></h5>
<div class="paragraph">
<p>Always use the latest compatible version of each plugin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgrade Gradle before plugins.</p>
</li>
<li>
<p>Test plugin compatibility using <a href="https://slack.engineering/shadow-jobs/">shadow jobs</a>.</p>
</li>
<li>
<p>Consult changelogs when updating.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subscribe to the Gradle <a href="https://newsletter.gradle.org/">newsletter</a> to stay informed about new Gradle releases, features, and plugins.</p>
</div>
</div>
<div class="sect4">
<h5 id="references_3"><a class="anchor" href="#references_3"></a><a class="link" href="#references_3">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="upgrading_version_9.html#upgrading_version_9">Upgrade Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_2"><a class="anchor" href="#tags_2"></a><a class="link" href="#tags_2">Tags</a></h5>
<div class="paragraph">
<p><a href="tags_reference.html#tag:plugins"><code>#plugins</code></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_the_plugins_block"><a class="anchor" href="#use_the_plugins_block"></a><a class="link" href="#use_the_plugins_block">Apply Plugins Using the <code>plugins</code> Block</a></h4>
<div class="paragraph">
<p>You should always use the <code>plugins</code> block to <a href="plugin_basics.html#applying_plugins">apply plugins</a> in your build scripts.</p>
</div>
<div class="sect4">
<h5 id="explanation_3"><a class="anchor" href="#explanation_3"></a><a class="link" href="#explanation_3">Explanation</a></h5>
<div class="paragraph">
<p>The <code>plugins</code> block is the preferred way to apply plugins in Gradle.
The plugins API allows Gradle to better manage the loading of plugins and it is both more concise and less error-prone than adding dependencies to the buildscript&#8217;s classpath explicitly in order to use the <code>apply</code> method.</p>
</div>
<div class="paragraph">
<p>It allows Gradle to optimize the loading and reuse of plugin classes and helps inform tools about the potential properties and values in extensions the plugins will add to the build script.
It is constrained to be idempotent (produce the same result every time) and side effect-free (safe for Gradle to execute at any time).</p>
</div>
</div>
<div class="sect4">
<h5 id="example"><a class="anchor" href="#example"></a><a class="link" href="#example">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this"><a class="anchor" href="#dont_do_this"></a><a class="link" href="#dont_do_this">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildscript {
    repositories {
        gradlePluginPortal() // <b class="conum">(1)</b>
    }

    dependencies {
        classpath("com.google.protobuf:com.google.protobuf.gradle.plugin:0.9.4") // <b class="conum">(2)</b>
    }
}

apply(plugin = "java") // <b class="conum">(3)</b>
apply(plugin = "com.google.protobuf") // <b class="conum">(4)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildscript {
    repositories {
        gradlePluginPortal() // <b class="conum">(1)</b>
    }

    dependencies {
        classpath("com.google.protobuf:com.google.protobuf.gradle.plugin:0.9.4") // <b class="conum">(2)</b>
    }
}

apply plugin: "java" // <b class="conum">(3)</b>
apply plugin: "com.google.protobuf" // <b class="conum">(4)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Declare a Repository</strong>: To use the legacy plugin application syntax, you need to explicitly tell Gradle where to find a plugin.</p>
</li>
<li>
<p><strong>Declare a Plugin Dependency</strong>: To use the legacy plugin application syntax with third-party plugins, you need to explicitly tell Gradle the full coordinates of the plugin.</p>
</li>
<li>
<p><strong>Apply a Core Plugin</strong>: This is very similar using either method.</p>
</li>
<li>
<p><strong>Apply a Third-Party Plugin</strong>: The syntax is the same as for core Gradle plugins, but the version is not present at the point of application in your buildscript.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead"><a class="anchor" href="#do_this_instead"></a><a class="link" href="#do_this_instead">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/usePluginsBlock-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/usePluginsBlock-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java") // <b class="conum">(1)</b>
    id("com.google.protobuf").version("0.9.4") // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("java") // <b class="conum">(1)</b>
    id("com.google.protobuf").version("0.9.4") // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Apply a Core Plugin</strong>: This is very similar using either method.</p>
</li>
<li>
<p><strong>Apply a Third-Party Plugin</strong>: You specify the version using method chaining in the <code>plugins</code> block itself.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_4"><a class="anchor" href="#references_4"></a><a class="link" href="#references_4">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="plugins_intermediate.html#using_plugins">Using Plugins</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_3"><a class="anchor" href="#tags_3"></a><a class="link" href="#tags_3">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="do_not_use_internal_apis"><a class="anchor" href="#do_not_use_internal_apis"></a><a class="link" href="#do_not_use_internal_apis">Do Not Use Internal APIs</a></h4>
<div class="paragraph">
<p>Do not use APIs from a package where any segment of the package is <code>internal</code>, or types that have <code>Internal</code> or <code>Impl</code> as a suffix in the name.</p>
</div>
<div class="sect4">
<h5 id="explanation_4"><a class="anchor" href="#explanation_4"></a><a class="link" href="#explanation_4">Explanation</a></h5>
<div class="paragraph">
<p>Using internal APIs is inherently risky and can cause significant problems during upgrades.
Gradle and many plugins (such as Android Gradle Plugin and Kotlin Gradle Plugin) treat these internal APIs as subject to unannounced breaking changes during any new Gradle release, even during minor releases.
There have been numerous cases where even highly experienced plugin developers have been bitten by their usage of such APIs leading to unexpected breakages for their users.</p>
</div>
<div class="paragraph">
<p>If you require specific functionality that is missing, its best to submit a feature request.
As a temporary workaround consider copying the necessary code into your own codebase and extending a Gradle public type with your own custom implementation using the copied code.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_2"><a class="anchor" href="#example_2"></a><a class="link" href="#example_2">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_2"><a class="anchor" href="#dont_do_this_2"></a><a class="link" href="#dont_do_this_2">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.gradle.api.internal.attributes.AttributeContainerInternal

configurations.create("bad") {
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named&lt;Usage&gt;(Usage.JAVA_RUNTIME))
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named&lt;Category&gt;(Category.LIBRARY))
    }
    val badMap = (attributes as AttributeContainerInternal).asMap() // <b class="conum">(1)</b>
    logger.warn("Bad map")
    badMap.forEach { (key, value) -&gt;
        logger.warn("$key -&gt; $value")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.gradle.api.internal.attributes.AttributeContainerInternal

configurations.create("bad") {
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))
    }
    def badMap = (attributes as AttributeContainerInternal).asMap() // <b class="conum">(1)</b>
    logger.warn("Bad map")
    badMap.each {
        logger.warn("${it.key} -&gt; ${it.value}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Casting to <code>AttributeContainerInternal</code> and using <code>toMap()</code> should be avoided as it relies on an internal API.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_2"><a class="anchor" href="#do_this_instead_2"></a><a class="link" href="#do_this_instead_2">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidInternal-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidInternal-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.create("good") {
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named&lt;Usage&gt;(Usage.JAVA_RUNTIME))
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named&lt;Category&gt;(Category.LIBRARY))
    }
    val goodMap = attributes.keySet().associate { // <b class="conum">(1)</b>
        Attribute.of(it.name, it.type) to attributes.getAttribute(it)
    }
    logger.warn("Good map")
    goodMap.forEach { (key, value) -&gt;
        logger.warn("$key -&gt; $value")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.create("good") {
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))
    }
    def goodMap = attributes.keySet().collectEntries {
        [Attribute.of(it.name, it.type), attributes.getAttribute(it as Attribute&lt;Object&gt;)]
    }
    logger.warn("Good map")
    goodMap.each {
        logger.warn("$it.key -&gt; $it.value")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Implementing your own version of <code>toMap()</code> that only uses public APIs is a lot more robust.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_5"><a class="anchor" href="#references_5"></a><a class="link" href="#references_5">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/current/javadoc/">Gradle API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_4"><a class="anchor" href="#tags_4"></a><a class="link" href="#tags_4">Tags</a></h5>
<div class="paragraph">
<p><a href="tags_reference.html#tag:upgrades"><code>#upgrades</code></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_the_gradle_properties_file"><a class="anchor" href="#use_the_gradle_properties_file"></a><a class="link" href="#use_the_gradle_properties_file">Set build flags in <code>gradle.properties</code></a></h4>
<div class="paragraph">
<p>Set Gradle build property flags in the <code>gradle.properties</code> file.</p>
</div>
<div class="sect4">
<h5 id="explanation_5"><a class="anchor" href="#explanation_5"></a><a class="link" href="#explanation_5">Explanation</a></h5>
<div class="paragraph">
<p>Instead of using command-line options or environment variables, set build flags in the root project&#8217;s <code>gradle.properties</code> file.</p>
</div>
<div class="paragraph">
<p>Gradle comes with a long list of <a href="#sec:gradle_configuration_properties">Gradle properties</a>, which have names that begin with <code>org.gradle</code> and can be used to configure the behavior of the build tool.
These properties can have a <strong>major impact</strong> on build performance, so its important to understand how they work.</p>
</div>
<div class="paragraph">
<p>You should not rely on supplying these properties via the command-line for every Gradle invocation.
Providing these properties via the command line is intended for short-term testing and debugging purposes, but its prone to being forgotten or inconsistently applied across environments.
A permanent, idiomatic location to set and share these properties is in the <code>gradle.properties</code> file located in the root project directory.
This file should be added to source control in order to share these properties across different machines and between developers.</p>
</div>
<div class="paragraph">
<p>You should understand the default values of the properties your build uses and avoid explicitly setting properties to those defaults.
Any change to a property&#8217;s default value in Gradle will follow the standard <a href="#backwards_compatibility">deprecation cycle</a>, and users will be properly notified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Properties set this way are not inherited across build boundaries when using <a href="#composite_builds">composite builds</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_3"><a class="anchor" href="#example_3"></a><a class="link" href="#example_3">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_3"><a class="anchor" href="#dont_do_this_3"></a><a class="link" href="#dont_do_this_3">Don&#8217;t Do This</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> build.gradle.kts
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> build.gradle
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("first") {
    doLast {
        throw GradleException("First task failing as expected")
    }
}

tasks.register("second") {
    doLast {
        logger.lifecycle("Second task succeeding as expected")
    }
}

tasks.register("run") {
    dependsOn("first", "second")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("first") {
    doLast {
        throw new GradleException("First task failing as expected")
    }
}

tasks.register("second") {
    doLast {
        logger.lifecycle("Second task succeeding as expected")
    }
}

tasks.register("run") {
    dependsOn("first", "second")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This build is run with <code>gradle run -Dorg.gradle.continue=true</code>, so that the failure of the <code>first</code> task does <strong>not</strong> prevent the <code>second</code> task from executing.</p>
</div>
<div class="paragraph">
<p>This relies on person running the build to remember to set this property, which is error prone and not portable across different machines and environments.</p>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_3"><a class="anchor" href="#do_this_instead_3"></a><a class="link" href="#do_this_instead_3">Do This Instead</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> build.gradle.kts
 gradle.properties
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> build.gradle
 gradle.properties
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.continue=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>This build sets the <code>org.gradle.continue</code> property in the <code>gradle.properties</code> file.</p>
</div>
<div class="paragraph">
<p>Now it can be executed using only <code>gradle run</code>, and the continue property will always be set automatically across all environments.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_6"><a class="anchor" href="#references_6"></a><a class="link" href="#references_6">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:gradle_configuration_properties">Gradle properties</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_5"><a class="anchor" href="#tags_5"></a><a class="link" href="#tags_5">Tags</a></h5>
<div class="paragraph">
<p><a href="tags_reference.html#tag:properties"><code>#properties</code></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_structuring_builds"><a class="anchor" href="#best_practices_structuring_builds"></a><a class="link" href="#best_practices_structuring_builds">Best Practices for Structuring Builds</a></h3>
<div class="sect3">
<h4 id="modularize_builds"><a class="anchor" href="#modularize_builds"></a><a class="link" href="#modularize_builds">Modularize Your Builds</a></h4>
<div class="paragraph">
<p>Modularize your builds by splitting your code into multiple projects.</p>
</div>
<div class="sect4">
<h5 id="explanation_6"><a class="anchor" href="#explanation_6"></a><a class="link" href="#explanation_6">Explanation</a></h5>
<div class="paragraph">
<p>Splitting your build&#8217;s source into multiple Gradle projects (modules) is essential for leveraging Gradle&#8217;s automatic work avoidance and parallelization features.
When a source file changes, Gradle only recompiles the affected projects.
If all your sources reside in a single project, Gradle can&#8217;t avoid recompilation and won&#8217;t be able to run tasks in parallel.
Splitting your source into multiple projects can provide additional performance benefits by minimizing each subproject&#8217;s compilation classpath and ensuring code generating tools such as annotation and symbol processors run only on the relevant files.</p>
</div>
<div class="paragraph">
<p>Do this <em>soon</em>.
Don&#8217;t wait until you hit some arbitrary number of source files or classes to do this, instead structure your build into multiple projects from the start using whatever natural boundaries exist in your codebase.</p>
</div>
<div class="paragraph">
<p>Exactly how to best split your source varies with every build, as it depends on the particulars of that build.
Here are some common patterns we found that can work well and make cohesive projects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API vs. Implementation</p>
</li>
<li>
<p>Front-end vs. Back-end</p>
</li>
<li>
<p>Core business logic vs. UI</p>
</li>
<li>
<p>Vertical slices (e.g., feature modules each containing UI + business logic)</p>
</li>
<li>
<p>Inputs to source generation vs. their consumers</p>
</li>
<li>
<p>Or simply closely related classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ultimately, the specific scheme matters less than ensuring that your build is split logically and consistently.</p>
</div>
<div class="paragraph">
<p>Expanding a build to hundreds of projects is common, and Gradle is designed to scale to this size and beyond.
In the extreme, tiny projects containing only a class or two are probably counterproductive.
However, you should typically err on the side of adding more projects rather than fewer.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_4"><a class="anchor" href="#example_4"></a><a class="link" href="#example_4">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_4"><a class="anchor" href="#dont_do_this_4"></a><a class="link" href="#dont_do_this_4">Don&#8217;t Do This</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A common way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> app // This project contains a mix of classes
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         CommonsUtil.java
                         GuavaUtil.java
                         Main.java
                         Util.java
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A common way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> app // This project contains a mix of classes
     build.gradle
     src
         main
             java
                 org
                     example
                         CommonsUtil.java
                         GuavaUtil.java
                         Main.java
                         Util.java
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("app") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include("app") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    application // <b class="conum">(2)</b>
}

dependencies {
    implementation("com.google.guava:guava:31.1-jre") // <b class="conum">(3)</b>
    implementation("commons-lang:commons-lang:2.6")
}

application {
    mainClass = "org.example.Main"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application' // <b class="conum">(2)</b>
}

dependencies {
    implementation 'com.google.guava:guava:31.1-jre' // <b class="conum">(3)</b>
    implementation 'commons-lang:commons-lang:2.6'
}

application {
    mainClass = "org.example.Main"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This build contains only a single project (in addition to the root project) that contains all the source code.  If there is any change to any source file, Gradle will have to recompile and rebuild everything.  While incremental compilation will help (especially in this simplified example) this is still less efficient then avoidance.  Gradle also won&#8217;t be able to run any tasks in parallel, since all these tasks are in the same project, so this design won&#8217;t scale nicely.</p>
</li>
<li>
<p>As there is only a single project in this build, the <code>application</code> plugin must be applied here.  This means that the <code>application</code> plugin will be affect all source files in the build, even those which have no need for it.</p>
</li>
<li>
<p>Likewise, the dependencies here are only needed by each particular implmentation of util.  There&#8217;s no need for the implementation using Guava to have access to the Commons library, but it does because they are all in the same project.  This also means that the classpath for each subproject is much larger than it needs to be, which can lead to longer build times and other confusion.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_4"><a class="anchor" href="#do_this_instead_4"></a><a class="link" href="#do_this_instead_4">Do This Instead</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A better way to structure this build</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> app
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         Main.java
 settings.gradle.kts
 util
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         Util.java
 util-commons
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         CommonsUtil.java
 util-guava
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         GuavaUtil.java</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A better way to structure this build</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> app // App contains only the core application logic
     build.gradle
     src
         main
             java
                 org
                     example
                         Main.java
 settings.gradle
 util // Util contains only the core utility logic
     build.gradle
     src
         main
             java
                 org
                     example
                         Util.java
 util-commons // One particular implementation of util, using Apache Commons
     build.gradle
     src
         main
             java
                 org
                     example
                         CommonsUtil.java
 util-guava // Another implementation of util, using Guava
     build.gradle
     src
         main
             java
                 org
                     example
                         GuavaUtil.java</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("app") // <b class="conum">(1)</b>
include("util")
include("util-commons")
include("util-guava")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include("app") // <b class="conum">(1)</b>
include("util")
include("util-commons")
include("util-guava")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This is the build.gradle file for the app module

plugins {
    application // <b class="conum">(2)</b>
}

dependencies { // <b class="conum">(3)</b>
    implementation(project(":util-guava"))
    implementation(project(":util-commons"))
}

application {
    mainClass = "org.example.Main"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This is the build.gradle file for the app module

plugins {
    id "application" // <b class="conum">(2)</b>
}

dependencies { // <b class="conum">(3)</b>
    implementation project(":util-guava")
    implementation project(":util-commons")
}

application {
    mainClass = "org.example.Main"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This is the build.gradle file for the util-commons module

plugins { // <b class="conum">(4)</b>
    `java-library`
}

dependencies { // <b class="conum">(5)</b>
    api(project(":util"))
    implementation("commons-lang:commons-lang:2.6")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This is the build.gradle file for the util-commons module

plugins { // <b class="conum">(4)</b>
    id "java-library"
}

dependencies { // <b class="conum">(5)</b>
    api project(":util")
    implementation "commons-lang:commons-lang:2.6"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This is the build.gradle file for the util-guava module

plugins {
    `java-library`
}

dependencies {
    api(project(":util"))
    implementation("com.google.guava:guava:31.1-jre")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This is the build.gradle file for the util-guava module

plugins {
    id "java-library"
}

dependencies {
    api project(":util")
    implementation "com.google.guava:guava:31.1-jre"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This build logically splits the source into multiple projects.  Each project can be built independently, and Gradle can run tasks in parallel.  This means that if you change a single source file in one of the projects, Gradle will only need to recompile and rebuild that project, not the entire build.</p>
</li>
<li>
<p>The <code>application</code> plugin is only applied to the <code>app</code> project, which is the only project that needs it.</p>
</li>
<li>
<p>Each project only adds the dependencies it needs.  This means that the classpath for each subproject is much smaller, which can lead to faster build times and less confusion.</p>
</li>
<li>
<p>Each project only adds the specific plugins it needs.</p>
</li>
<li>
<p>Each project only adds the dependencies it needs.  Projects can effectively use <a href="#sec:java_library_separation">API vs. Implementation separation</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_7"><a class="anchor" href="#references_7"></a><a class="link" href="#references_7">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#multi_project_builds">Structuring Projects with Gradle</a></p>
</li>
<li>
<p><a href="#sec:settings_file">Organizing Gradle Projects</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_6"><a class="anchor" href="#tags_6"></a><a class="link" href="#tags_6">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="no_source_in_root"><a class="anchor" href="#no_source_in_root"></a><a class="link" href="#no_source_in_root">Do Not Put Source Files in the Root Project</a></h4>
<div class="paragraph">
<p>Do not put source files in your root project; instead, put them in a separate project.</p>
</div>
<div class="sect4">
<h5 id="explanation_7"><a class="anchor" href="#explanation_7"></a><a class="link" href="#explanation_7">Explanation</a></h5>
<div class="paragraph">
<p>The root project is a special <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.api/-project/index.html">Project</a> in Gradle that serves as the entry point for your build.</p>
</div>
<div class="paragraph">
<p>It is the place to configure some settings and conventions that apply globally to the entire build, that are not configured via <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.api.initialization/-settings/index.html">Settings</a>.
For example, you can <em>declare</em> (but not apply) plugins here to ensure the same plugin version is consistently available across all projects and define other configurations shared by all projects within the build.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Be careful not to apply plugins unnecessarily in the root project - many plugins only affect source code and should only be applied to the projects that contain source code.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The root project should not be used for source files, instead they should be located in a separate Gradle project.</p>
</div>
<div class="paragraph">
<p>Setting up your build like this from the start will also make it easier to add new projects as your build grows in the future.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_5"><a class="anchor" href="#example_5"></a><a class="link" href="#example_5">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_5"><a class="anchor" href="#dont_do_this_5"></a><a class="link" href="#dont_do_this_5">Don&#8217;t Do This</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A common way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> build.gradle.kts // Applies the `java-library` plugin to the root project
 settings.gradle.kts
 src // This directory shouldn't exist
     main
         java
             org
                 example
                     MyClass1.java</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A common way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> build.gradle // Applies the `java-library` plugin to the root project
 settings.gradle
 src // This directory shouldn't exist
     main
         java
             org
                 example
                     MyClass1.java</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins { // <b class="conum">(1)</b>
    `java-library`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library' // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>java-library</code> plugin is applied to the root project, as there are Java source files are in the root project.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_5"><a class="anchor" href="#do_this_instead_5"></a><a class="link" href="#do_this_instead_5">Do This Instead</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A better way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> core
     build.gradle.kts // Applies the `java-library` plugin to only the `core` project
     src // Source lives in a "core" (sub)project
         main
             java
                 org
                     example
                         MyClass1.java
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">A better way to structure new builds</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> core
     build.gradle // Applies the `java-library` plugin to only the `core` project
     src // Source lives in a "core" (sub)project
         main
             java
                 org
                     example
                         MyClass1.java
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("core") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include("core") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This is the build.gradle.kts file for the core module

plugins { // <b class="conum">(2)</b>
    `java-library`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This is the build.gradle file for the core module

plugins { // <b class="conum">(2)</b>
    id 'java-library'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The root project exists only to configure the build, informing Gradle of a (sub)project named <code>core</code>.</p>
</li>
<li>
<p>The <code>java-library</code> plugin is only applied to the <code>core</code> project, which contains the Java source files.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_8"><a class="anchor" href="#references_8"></a><a class="link" href="#references_8">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#multi_project_builds">Structuring Projects with Gradle</a></p>
</li>
<li>
<p><a href="#sec:settings_file">Organizing Gradle Projects</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_7"><a class="anchor" href="#tags_7"></a><a class="link" href="#tags_7">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="favor_composite_builds"><a class="anchor" href="#favor_composite_builds"></a><a class="link" href="#favor_composite_builds">Favor <code>build-logic</code> Composite Builds for Build Logic</a></h4>
<div class="paragraph">
<p>You should set up a <a href="#defining_composite_builds">Composite Build</a> (often called an "included build") to hold your build logicincluding any custom plugins, convention plugins, and other build-specific customizations.</p>
</div>
<div class="sect4">
<h5 id="explanation_8"><a class="anchor" href="#explanation_8"></a><a class="link" href="#explanation_8">Explanation</a></h5>
<div class="paragraph">
<p>The preferred location for build logic is an included build (typically named <code>build-logic</code>), <strong>not</strong> in <code>buildSrc</code>.</p>
</div>
<div class="paragraph">
<p>The automatically available <code>buildSrc</code> is great for rapid prototyping, but it comes with some subtle disadvantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There are classloader differences in how these 2 approaches behave that can be surprising; included builds are treated just like external dependencies, which is a simpler mental model.  Dependency resolution behaves subtly differently in <code>buildSrc</code>.</p>
</li>
<li>
<p>There can potentially be fewer task invalidations in a build when files in an included build are modified, leading to faster builds.  Any change in <code>buildSrc</code> causes the entire build to become out-of-date, whereas changes in a subproject of an included build only cause projects in the build using the products of that particular subproject to be out-of-date.</p>
</li>
<li>
<p>Included builds are complete Gradle builds and can be opened, worked on, and built independently as standalone projects.  It is straightforward to publish their products, including plugins, in order to share them with other projects.</p>
</li>
<li>
<p>The <code>buildSrc</code> project automatically applies the <code>java</code> plugin, which may be unnecessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One important caveat to this recommendation is when creating <code>Settings</code> plugins.
Defining these in a <code>build-logic</code> project requires it to be included in the <code>pluginManagement</code> block of the main build&#8217;s <code>settings.gradle(.kts)</code> file, in order to make these plugins available to the build early enough to be applied to the <code>Settings</code> instance.
This is possible, but reduces Build Caching capability, potentially impacting performance.
A better solution is to use a separate, minimal, included build (e.g. <code>build-logic-settings</code>) to hold only <code>Settings</code> plugins.</p>
</div>
<div class="paragraph">
<p>Another potential reason to use <code>buildSrc</code> is if you have a very large number of subprojects within your included <code>build-logic</code>.
Applying a different set of <code>build-logic</code> plugins to the subprojects in your <em>including</em> build will result in a different classpath being used for each.
This may have performance implications and make your build harder to understand.
Using different plugin combinations can cause features like <a href="#build_services">Build Services</a> to break in difficult to diagnose ways.</p>
</div>
<div class="paragraph">
<p>Ideally, there would be no difference between using <code>buildSrc</code> and an included build, as <code>buildSrc</code> is intended to behave like an implicitly available included build.
However, due to historical reasons, these subtle differences still exist.
As this changes, this recommendation may be revised in the future.
For now, these differences can introduce confusion.</p>
</div>
<div class="paragraph">
<p>Since setting up a composite build requires only minimal additional configuration, we recommend using it over <code>buildSrc</code> in most cases.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_6"><a class="anchor" href="#example_6"></a><a class="link" href="#example_6">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_6"><a class="anchor" href="#dont_do_this_6"></a><a class="link" href="#dont_do_this_6">Don&#8217;t Do This</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> build.gradle.kts
 buildSrc
     build.gradle.kts
     src
         main
             java
                 org
                     example
                         MyPlugin.java
                         MyTask.java
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> build.gradle
 buildSrc
     build.gradle
     src
         main
             java
                 org
                     example
                         MyPlugin.java
                         MyTask.java
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This file is located in /buildSrc

plugins {
    `java-gradle-plugin`
}

gradlePlugin {
    plugins {
        create("myPlugin") {
            id = "org.example.myplugin"
            implementationClass = "org.example.MyPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This file is located in /buildSrc

plugins {
    id "java-gradle-plugin"
}

gradlePlugin {
    plugins {
        create("myPlugin") {
            id = "org.example.myplugin"
            implementationClass = "org.example.MyPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Set up a Plugin Build</strong>: This is the same using either method.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "favor-composite-builds"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = "favor-composite-builds"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong><code>buildSrc</code> products are automatically usable</strong>: There is no additional configuration with this method.</p>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_6"><a class="anchor" href="#do_this_instead_6"></a><a class="link" href="#do_this_instead_6">Do This Instead</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> build-logic
     plugin
         build.gradle.kts
         src
             main
                 java
                     org
                         example
                             MyPlugin.java
                             MyTask.java
     settings.gradle.kts
 build.gradle.kts
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> build-logic
     plugin
         build.gradle
         src
             main
                 java
                     org
                         example
                             MyPlugin.java
                             MyTask.java
     settings.gradle
 build.gradle
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This file is located in /build-logic/plugin

plugins {
    `java-gradle-plugin`
}

gradlePlugin {
    plugins {
        create("myPlugin") {
            id = "org.example.myplugin"
            implementationClass = "org.example.MyPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This file is located in /build-logic/plugin

plugins {
    id "java-gradle-plugin"
}

gradlePlugin {
    plugins {
        create("myPlugin") {
            id = "org.example.myplugin"
            implementationClass = "org.example.MyPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Set up a Plugin Build</strong>: This is the same using either method.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This file is located in the root project

includeBuild("build-logic") // <b class="conum">(1)</b>

rootProject.name = "favor-composite-builds"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This file is located in the root project

includeBuild("build-logic") // <b class="conum">(1)</b>

rootProject.name = "favor-composite-builds"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// This file is located in /build-logic

rootProject.name = "build-logic"

include("plugin") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// This file is located in /build-logic

rootProject.name = "build-logic"

include("plugin") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Composite builds must be explicitly included</strong>: Use the <code>includeBuild</code> method to locate and include a build in order to use its products.</p>
</li>
<li>
<p><strong>Structure your included build into subprojects</strong>: This allows the main build to only depend on the necessary parts of the included build.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_9"><a class="anchor" href="#references_9"></a><a class="link" href="#references_9">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="part3_multi_project_builds.html#step_3_understand_composite_builds">Composite Builds in the Multi-Project Builds Tutorial</a></p>
</li>
<li>
<p><a href="#composite_builds">Composite Builds reference documentation</a></p>
</li>
<li>
<p><a href="https://github.com/gradle/gradle/issues/6045">Gradle Issue #6045: buildSrc vs. included builds</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_8"><a class="anchor" href="#tags_8"></a><a class="link" href="#tags_8">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code>, <code><a href="tags_reference.html#tag:composite-builds">#composite-builds</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_empty_projects"><a class="anchor" href="#avoid_empty_projects"></a><a class="link" href="#avoid_empty_projects">Avoid Unintentionally Creating Empty Projects</a></h4>
<div class="paragraph">
<p>When using a hierarchical directory structure to organize your Gradle projects, make sure to avoid unintentionally creating empty projects in your build.</p>
</div>
<div class="sect4">
<h5 id="explanation_9"><a class="anchor" href="#explanation_9"></a><a class="link" href="#explanation_9">Explanation</a></h5>
<div class="paragraph">
<p>When you use the <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.api.initialization/-settings/include.html">Settings.include()</a> method to include a project in your Grade settings file, you typically include projects by supplying the directory name like <code>include("featureA")</code>.
This usage assumes that <code>featureA</code> is located at the root of your build.</p>
</div>
<div class="paragraph">
<p>You can include projects located in nested subdirectories by specifying their full project path using <code>:</code> as a separator between path segments.
For instance, if project <code>search</code> was located in a subdirectory named <code>features</code>, itself located in a subdirectory named <code>subs</code>, you could call <code>include(":subs:features:search")</code> to include it.</p>
</div>
<div class="paragraph">
<p>Nesting projects in a sensible hierarchical directory structure is common practice in larger Gradle builds.
This approach helps organize large builds and improves comprehensibility, compared to placing all projects directly under the build&#8217;s root.</p>
</div>
<div class="paragraph">
<p>However, without further configuration, Gradle will create empty projects for each element in every hierarchical path, even if some of those directories do not contain actual Gradle projects.
In the example above, Gradle will create a project named <code>:subs</code>, a project named <code>:subs:features</code>, and a project named <code>:subs:features:search</code>.
This behavior is usually not intended, as you likely only want to include the <code>search</code> project.</p>
</div>
<div class="paragraph">
<p>Unused projects - even if empty - can surprise maintainers, clutter reports, and make your build harder to understand.
They also introduce unintended side effects.
If you use <code>allprojects { &#8230;&#8203; }</code> or <code>subprojects { &#8230;&#8203; }</code>, plugins and configuration blocks will apply to every project, including the empty ones.
This can degrade build performance.
Additionally, invoking tasks on deeply nested projects requires using the full project path, such as <code>gradle :subs:features:search:build</code>, instead of the shorter <code>gradle :search:build</code>.</p>
</div>
<div class="paragraph">
<p>To avoid these downsides when using a hierarchical project structure, you can provide a flat name when including the project and explicitly set the <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.api/-project/get-project-dir.html">Project.projectDir</a> property for any projects located in nested directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">include(':my-web-module')
project(':my-web-module').projectDir = file("subs/web/my-web-module")</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will prevent Gradle from creating empty projects for each element of the project&#8217;s path.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Always use an identical <em>logical</em> project <strong>name</strong> and <em>physical</em> project <strong>location</strong> to avoid confusion.
Don&#8217;t include a project named <code>:search</code> and locate it at <code>features/ui/default-search-toolbar</code>, as this will lead to confusion about the location of the project.
Instead, locate this project at <code>features/ui/search</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should avoid unnecessarily deep directory structures.
For builds containing only a few projects, its usually better to keep the structure flat by placing all projects at the root of the build.
This eliminates the need to explicitly set <code>projectDir</code>.
Within the context of a particular build, the <em>pathless</em> project name should clearly indicate where the project is located.
You can also run the <a href="project_report_plugin.html#project_report_plugin">projects report</a> for more information about the projects in your build and their locations.</p>
</div>
<div class="paragraph">
<p>If you find yourself facing ambiguity about project locations, consider simplifying the directory layout by flattening the structure, or using longer, more descriptive project names.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_7"><a class="anchor" href="#example_7"></a><a class="link" href="#example_7">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_7"><a class="anchor" href="#dont_do_this_7"></a><a class="link" href="#dont_do_this_7">Don&#8217;t Do This</a></h6>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin"> settings.gradle
 app/ // <b class="conum">(1)</b>
    build.gradle
    src/
 subs/ // <b class="conum">(2)</b>
     web/ // <b class="conum">(3)</b>
         my-web-module/ // <b class="conum">(4)</b>
             src/
             build.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> settings.gradle
 app/ // <b class="conum">(1)</b>
    build.gradle
    src/
 subs/ // <b class="conum">(2)</b>
     web/ // <b class="conum">(3)</b>
         my-web-module/ // <b class="conum">(4)</b>
             src/
             build.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A project named <code>app</code> located at the root of the build</p>
</li>
<li>
<p>A directory named <code>subs</code> that is <strong>not</strong> intended to represent a Gradle project, but is used to organize the build</p>
</li>
<li>
<p>Another organizational directory <strong>not</strong> intended to represent a Gradle project</p>
</li>
<li>
<p>A Gradle project named <code>my-web-module</code> that <strong>should</strong> be included in the build</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include(":app") // <b class="conum">(1)</b>
include(":subs:web:my-web-module") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include(":app") // <b class="conum">(1)</b>
include(":subs:web:my-web-module") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Including the <code>app</code> project located at the root of the build requires no additional configuration</p>
</li>
<li>
<p>Including a project named <code>:subs:my-web-module</code> located in a nested subdirectory causes Gradle to create empty projects for each element of the path</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">avoidEmptyProjects-avoid.out</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-out hljs" data-lang="out">&gt; Task :projects

Projects:

------------------------------------------------------------
Root project 'avoidEmptyProjects-avoid'
------------------------------------------------------------

Location: /home/user/gradle/samples

Project hierarchy:

Root project 'avoidEmptyProjects-avoid'
+--- Project ':app'
\--- Project ':subs'
     \--- Project ':subs:web'
          \--- Project ':subs:web:my-web-module'

Project locations:

project ':app' - /app
project ':subs' - /subs
project ':subs:web' - /subs/web
project ':subs:web:my-web-module' - /subs/web/my-web-module

To see a list of the tasks of a project, run gradle &lt;project-path&gt;:tasks
For example, try running gradle :app:tasks

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The output of running the <code>projects</code> report on the above build shows that Gradle created empty projects for <code>:subs</code> and <code>:subs:web</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_7"><a class="anchor" href="#do_this_instead_7"></a><a class="link" href="#do_this_instead_7">Do This Instead</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include(":app")

include(":my-web-module")
project(":my-web-module").projectDir = file("subs/web/my-web-module") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include(":app")

include(":my-web-module")
project(":my-web-module").projectDir = file("subs/web/my-web-module") // <b class="conum">(1)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>After including the <code>:subs:web:my-web-module</code> project, its <code>projectDir</code> property is set to the physical location of the project</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">avoidEmptyProjects-do.out</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-out hljs" data-lang="out">&gt; Task :projects

Projects:

------------------------------------------------------------
Root project 'avoidEmptyProjects-do'
------------------------------------------------------------

Location: /home/user/gradle/samples

Project hierarchy:

Root project 'avoidEmptyProjects-do'
+--- Project ':app'
\--- Project ':my-web-module'

Project locations:

project ':app' - /app
project ':my-web-module' - /subs/web/my-web-module

To see a list of the tasks of a project, run gradle &lt;project-path&gt;:tasks
For example, try running gradle :app:tasks

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The output of running the <code>projects</code> report on the above build shows that now Gradle only creates the intended projects for this build.</p>
</div>
<div class="paragraph">
<p>You can also now invoke tasks on the <code>my-web-module</code> project using the shorter name <code>:my-web-module</code> like <code>gradle :my-web-module:build</code>, instead of <code>gradle :subs:web:my-web-module:build</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_10"><a class="anchor" href="#references_10"></a><a class="link" href="#references_10">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#multi_project_builds">Multi-Project Builds</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_9"><a class="anchor" href="#tags_9"></a><a class="link" href="#tags_9">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_for_dependencies"><a class="anchor" href="#best_practices_for_dependencies"></a><a class="link" href="#best_practices_for_dependencies">Best Practices for Dependencies</a></h3>
<div class="sect3">
<h4 id="use_version_catalogs"><a class="anchor" href="#use_version_catalogs"></a><a class="link" href="#use_version_catalogs">Use Version Catalogs to Centralize Dependency Versions</a></h4>
<div class="paragraph">
<p>Use Version Catalogs provide a centralized, declarative way to manage dependency versions throughout a build.</p>
</div>
<div class="sect4">
<h5 id="explanation_10"><a class="anchor" href="#explanation_10"></a><a class="link" href="#explanation_10">Explanation</a></h5>
<div class="paragraph">
<p>When you define your dependency versions in a single, shared version catalog, you reduce duplication and make upgrades easier.
Instead of changing dozens of <code>build.gradle(.kts)</code> files, you update the version in one place.
This simplifies maintenance, improves consistency, and reduces the risk of accidental version drift between modules.
Consistent version declarations across projects also make it easier to reason about behavior during testingespecially in modular builds where transitive upgrades can silently change runtime behavior in later stages of the build.</p>
</div>
<div class="paragraph">
<p>However, version catalogs only influence declared versions, not resolved versions.
Use them in combination with <a href="#sec:dependency-locking">dependency locking</a> and <a href="#using-resolution-rules">version alignment</a> to enforce consistency across builds.
To influence resolved versions, check out <a href="#platforms">platforms</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_8"><a class="anchor" href="#example_8"></a><a class="link" href="#example_8">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_8"><a class="anchor" href="#dont_do_this_8"></a><a class="link" href="#dont_do_this_8">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>Avoid declaring versions in <code>project.ext</code>, constants, or local variables:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    id("com.github.ben-manes.versions").version("0.45.0")
}
val groovyVersion = "3.0.5"

dependencies {
    api("org.codehaus.groovy:groovy:$groovyVersion")
    api("org.codehaus.groovy:groovy-json:$groovyVersion")
    api("org.codehaus.groovy:groovy-nio:$groovyVersion")

    testImplementation("org.junit.jupiter:junit-jupiter:5.10.0")
}

dependencies {
    implementation("org.apache.commons:commons-lang3") {
        version {
            strictly("[3.8, 4.0[")
            prefer("3.9")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('java-library')
    id('com.github.ben-manes.versions').version('0.45.0')
}
def groovyVersion = '3.0.5'

dependencies {
    api("org.codehaus.groovy:groovy:$groovyVersion")
    api("org.codehaus.groovy:groovy-json:$groovyVersion")
    api("org.codehaus.groovy:groovy-nio:$groovyVersion")

    testImplementation("org.junit.jupiter:junit-jupiter:5.10.0")

    implementation("org.apache.commons:commons-lang3") {
        version {
            strictly("[3.8, 4.0[")
            prefer("3.9")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Avoid misusing version catalogs for unrelated concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dont use them to store shared strings or non-library constants</p>
</li>
<li>
<p>Dont overload them with arbitrary logic or plugin-specific configuration</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_8"><a class="anchor" href="#do_this_instead_8"></a><a class="link" href="#do_this_instead_8">Do This Instead</a></h6>
<div class="paragraph">
<p>Use a centralized <code>libs.versions.toml</code> file in your <code>gradle/</code> directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle/libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
groovy = "3.0.5"
junit-jupiter = "5.10.0"

[libraries]
groovy-core = { module = "org.codehaus.groovy:groovy", version.ref = "groovy" }
groovy-json = { module = "org.codehaus.groovy:groovy-json", version.ref = "groovy" }
groovy-nio = { module = "org.codehaus.groovy:groovy-nio", version.ref = "groovy" }
commons-lang3 = { group = "org.apache.commons", name = "commons-lang3", version = { strictly = "[3.8, 4.0[", prefer="3.9" } }
junit-jupiter = { module = "org.junit.jupiter:junit-jupiter", version.ref = "junit-jupiter" }

[bundles]
groovy = ["groovy-core", "groovy-json", "groovy-nio"]

[plugins]
versions = { id = "com.github.ben-manes.versions", version = "0.45.0" }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useVersionCatalogs-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useVersionCatalogs-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    alias(libs.plugins.versions)
}
dependencies {
    api(libs.bundles.groovy)
    testImplementation(libs.junit.jupiter)
    implementation(libs.commons.lang3)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('java-library')
    alias(libs.plugins.versions)
}
dependencies {
    api(libs.bundles.groovy)
    testImplementation(libs.junit.jupiter)
    implementation(libs.commons.lang3)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_11"><a class="anchor" href="#references_11"></a><a class="link" href="#references_11">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#version-catalog">Version Catalogs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_10"><a class="anchor" href="#tags_10"></a><a class="link" href="#tags_10">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:version-catalog">#version-catalog</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="name_version_catalog_entries"><a class="anchor" href="#name_version_catalog_entries"></a><a class="link" href="#name_version_catalog_entries">Name Version Catalog Entries Appropriately</a></h4>
<div class="paragraph">
<p>Consistent and descriptive names in your version catalog enhance readability and maintainability across your build scripts.</p>
</div>
<div class="sect4">
<h5 id="explanation_11"><a class="anchor" href="#explanation_11"></a><a class="link" href="#explanation_11">Explanation</a></h5>
<div class="paragraph">
<p>Version catalogs provide a centralized way to manage dependencies by mapping full dependency coordinates to concise, reusable aliases like <code>airlift-aircompressor</code>.
Adopting clear naming conventions for those aliases ensures that developers can easily identify and use dependencies throughout the project.</p>
</div>
<div class="paragraph">
<p>Aliases are typically made up of 1 to 3 segments.
For example <code>org.apache.commons:commons-lang3</code> could be represented as <code>commonsLang3</code>, <code>apache-commonsLang3</code>, or <code>commons-lang3</code>.</p>
</div>
<div class="paragraph">
<p>The following guidelines help in naming catalog entries effectively:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use dashes to separate segments</strong>: Prefer hyphen/dashes (<code>-</code>) over underscores (<code>_</code>) to separate different parts of the entry name.</p>
<div class="paragraph">
<p>Example: For <code>org.apache.logging.log4j:log4j-api</code>, use <code>log4j-api</code></p>
</div>
</li>
<li>
<p><strong>Derive the first segment from the project group</strong>: Use a unique identifier from the project&#8217;s group ID as the first segment. Do not include the top level domain in the segment (<code>com</code>, <code>org</code>, <code>net</code>, <code>dev</code>).</p>
<div class="paragraph">
<p>Example: For <code>com.fasterxml.jackson.core:jackson-databind</code>, use <code>jackson-databind</code> or <code>jackson-core-databind</code></p>
</div>
</li>
<li>
<p><strong>Derive the second segment from the artifact ID</strong>: Use a unique identifier from the artifact ID as the second segment.</p>
<div class="paragraph">
<p>Example: For <code>com.linecorp.armeria:armeria-grpc</code>, use <code>armeria-grpc</code></p>
</div>
</li>
<li>
<p><strong>Avoid generic terms in the segments</strong>: Exclude terms that are obvious or implied in the context of your project (<code>core</code>, <code>java</code>, <code>gradle</code>, <code>module</code>, <code>sdk</code>), especially if the term appears by itself.</p>
<div class="paragraph">
<p>Example: For <code>com.google.googlejavaformat:google-java-format</code>, use <code>google-java-format</code>, not <code>google-java</code> or <code>java</code></p>
</div>
</li>
<li>
<p><strong>Omit redundant segments</strong>: If the group and artifact IDs are the same, avoid repeating them.</p>
<div class="paragraph">
<p>Example: For <code>io.ktor:ktor-client-core</code>, use <code>ktor-client-core</code>, not <code>ktor-ktor-client-core</code></p>
</div>
</li>
<li>
<p><strong>Convert internal dashes to camelCase</strong>: If the artifact ID contains dashes, convert them to camelCase for better readability in code.</p>
<div class="paragraph">
<p>Example: <code>spring-boot-starter-web</code> becomes <code>springBootStarterWeb</code></p>
</div>
</li>
<li>
<p><strong>Suffix plugin libraries with <code>-plugin</code></strong>: When referencing a plugin as a library (not in the <code>[plugins]</code> section), append <code>-plugin</code> to the name.</p>
<div class="paragraph">
<p>Example: For <code>org.owasp:dependency-check-gradle</code>, use <code>dependency-check-plugin</code></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="example_9"><a class="anchor" href="#example_9"></a><a class="link" href="#example_9">Example</a></h5>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle/libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
slf4j = "2.0.13"
jackson = "2.17.1"
groovy = "3.0.5"
checkstyle = "8.37"
commonsLang = "3.9"

[libraries]
# SLF4J
slf4j-api = { module = "org.slf4j:slf4j-api", version.ref = "slf4j" }

# Jackson
jackson-databind = { module = "com.fasterxml.jackson.core:jackson-databind", version.ref = "jackson" }
jackson-dataformatCsv = { module = "com.fasterxml.jackson.dataformat:jackson-dataformat-csv", version.ref = "jackson" }

# Groovy bundle
groovy-core = { module = "org.codehaus.groovy:groovy", version.ref = "groovy" }
groovy-json = { module = "org.codehaus.groovy:groovy-json", version.ref = "groovy" }
groovy-nio = { module = "org.codehaus.groovy:groovy-nio", version.ref = "groovy" }

# Apache Commons Lang
commons-lang3 = { group = "org.apache.commons", name = "commons-lang3", version = { strictly = "[3.8, 4.0[", prefer = "3.9" } }

[bundles]
groovy = ["groovy-core", "groovy-json", "groovy-nio"]

[plugins]
versions = { id = "com.github.ben-manes.versions", version = "0.45.0" }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/versionCatalogNaming-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/versionCatalogNaming-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    alias(libs.plugins.versions)
}

repositories {
    mavenCentral()
}

dependencies {
    // SLF4J
    implementation(libs.slf4j.api)

    // Jackson
    implementation(libs.jackson.databind)
    implementation(libs.jackson.dataformatCsv)

    // Groovy bundle
    api(libs.bundles.groovy)

    // Commons Lang
    implementation(libs.commons.lang3)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    alias(libs.plugins.versions)
}

repositories {
    mavenCentral()
}

dependencies {
    // SLF4J
    implementation libs.slf4j.api

    // Jackson
    implementation libs.jackson.databind
    implementation libs.jackson.dataformatCsv

    // Groovy bundle
    api libs.bundles.groovy

    // Commons Lang
    implementation libs.commons.lang3
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_12"><a class="anchor" href="#references_12"></a><a class="link" href="#references_12">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://blog.gradle.org/best-practices-naming-version-catalog-entries">Best Practices for Naming Gradle Version Catalog Entries</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_11"><a class="anchor" href="#tags_11"></a><a class="link" href="#tags_11">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:version-catalog">#version-catalog</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="set_up_repositories_in_settings"><a class="anchor" href="#set_up_repositories_in_settings"></a><a class="link" href="#set_up_repositories_in_settings">Set up your Dependency Repositories in the Settings file</a></h4>
<div class="paragraph">
<p>Declare your repositories for your plugins and dependencies in <code>settings.gradle.kts</code>.</p>
</div>
<div class="sect4">
<h5 id="explanation_12"><a class="anchor" href="#explanation_12"></a><a class="link" href="#explanation_12">Explanation</a></h5>
<div class="paragraph">
<p>Using <code>settings.gradle.kts</code> file to declare repositories has several benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Avoids repetition</strong>: Centralizing repository declarations eliminates the need to repeat them in each project&#8217;s <code>build.gradle.kts</code>.</p>
</li>
<li>
<p><strong>Improves debuggability</strong>: Ensures all projects resolve dependencies during resolution from the same repositories, in a consistent order.</p>
</li>
<li>
<p><strong>Matches the build model</strong>: Repositories are not part of the project definition; they are part of global build logic, so settings is a more appropriate place for them.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While <a href="https://github.com/gradle/gradle/issues/32443"><code>dependencyResolutionManagement.repositories</code> is an incubating API</a>, it is the preferred way of declaring repositories.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_10"><a class="anchor" href="#example_10"></a><a class="link" href="#example_10">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_9"><a class="anchor" href="#dont_do_this_9"></a><a class="link" href="#dont_do_this_9">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>You could set up repositories in individual <code>build.gradle.kts</code> files with:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildscript {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}

plugins {
    id("java")
}

repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildscript {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}

plugins {
    id("java")
}

repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_9"><a class="anchor" href="#do_this_instead_9"></a><a class="link" href="#do_this_instead_9">Do This Instead</a></h6>
<div class="paragraph">
<p>Instead, you should set them up in <code>settings.gradle.kts</code> like this:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/settingsRepositories-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/settingsRepositories-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">pluginManagement {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}
dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.FAIL_ON_PROJECT_REPOS
    repositories {
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">pluginManagement {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}
dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.FAIL_ON_PROJECT_REPOS
    repositories {
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tags_12"><a class="anchor" href="#tags_12"></a><a class="link" href="#tags_12">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:structuring-builds">#structuring-builds</a></code>, <code><a href="tags_reference.html#tag:repositories">#repositories</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dont_depend_on_kotlin_stdlib"><a class="anchor" href="#dont_depend_on_kotlin_stdlib"></a><a class="link" href="#dont_depend_on_kotlin_stdlib">Don&#8217;t Explicitly Depend on the Kotlin Standard Library</a></h4>
<div class="paragraph">
<p>The Kotlin Gradle Plugin automatically adds a dependency on the Kotlin standard library (<code>stdlib</code>) to each source set, so there is no need to declare it explicitly.</p>
</div>
<div class="sect4">
<h5 id="explanation_13"><a class="anchor" href="#explanation_13"></a><a class="link" href="#explanation_13">Explanation</a></h5>
<div class="paragraph">
<p>The version of the standard library added is the same as the version of the Kotlin Gradle Plugin applied to the project.
If your build does not require a specific or different version of the standard library, you should avoid adding it manually.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Setting the <code>kotlin.stdlib.default.dependency</code> property to <code>false</code> prevents the Kotlin plugin from automatically adding the Kotlin standard library dependency to your project. This can be useful in specific scenarios, such as when you want to manage the Kotlin standard library dependency version manually.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_11"><a class="anchor" href="#example_11"></a><a class="link" href="#example_11">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_10"><a class="anchor" href="#dont_do_this_10"></a><a class="link" href="#dont_do_this_10">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    kotlin("jvm").version("2.0.21")
}

dependencies {
    api(kotlin("stdlib")) // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("org.jetbrains.kotlin.jvm") version "2.0.21"
}

dependencies {
    api("org.jetbrains.kotlin:kotlin-stdlib:2.0.21") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong><code>stdlib</code> is explicitly depended upon</strong>: This project contains an implicit dependency on the Kotlin standard library, which is required to compile its source code.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_10"><a class="anchor" href="#do_this_instead_10"></a><a class="link" href="#do_this_instead_10">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/kotlinStdLib-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/kotlinStdLib-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    kotlin("jvm").version("2.0.21") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("org.jetbrains.kotlin.jvm") version "2.0.21"  // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong><code>stdlib</code> dependency is not included explicitly</strong>: The standard library remains available for use, and source code requiring it can be compiled without any issues.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_13"><a class="anchor" href="#references_13"></a><a class="link" href="#references_13">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/current/kotlin-dsl/gradle/org.gradle.kotlin.dsl/kotlin.html">the <code>kotlin()</code> function</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_13"><a class="anchor" href="#tags_13"></a><a class="link" href="#tags_13">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:dependencies">#dependencies</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_duplicate_dependencies"><a class="anchor" href="#avoid_duplicate_dependencies"></a><a class="link" href="#avoid_duplicate_dependencies">Avoid Redundant Dependency Declarations</a></h4>
<div class="paragraph">
<p>Avoid declaring the same dependency multiple times, especially when it is already available transitively or through another configuration.</p>
</div>
<div class="sect4">
<h5 id="explanation_14"><a class="anchor" href="#explanation_14"></a><a class="link" href="#explanation_14">Explanation</a></h5>
<div class="paragraph">
<p>Duplicating dependencies in Gradle build scripts can lead to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Increased maintenance</strong>: Declaring a dependency in multiple places makes it harder to manage.</p>
</li>
<li>
<p><strong>Unexpected behavior</strong>: Declaring the same dependency in multiple configurations (e.g., <code>compileOnly</code> and <code>implementation</code>) can result in hard-to-diagnose classpath issues.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="example_12"><a class="anchor" href="#example_12"></a><a class="link" href="#example_12">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_11"><a class="anchor" href="#dont_do_this_11"></a><a class="link" href="#dont_do_this_11">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

dependencies {
    api("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0")
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

dependencies {
    api("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0")
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Redundant dependency in <code>implementation</code> scope.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_11"><a class="anchor" href="#do_this_instead_11"></a><a class="link" href="#do_this_instead_11">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidDuplicateDependencies-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidDuplicateDependencies-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

dependencies {
    api("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

dependencies {
    api("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.10.0") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Declare dependency once</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tags_14"><a class="anchor" href="#tags_14"></a><a class="link" href="#tags_14">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:dependencies">#dependencies</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="single-gav-string"><a class="anchor" href="#single-gav-string"></a><a class="link" href="#single-gav-string">Declare Dependencies using a single GAV (<code>group:artifact:version</code>) String</a></h4>
<div class="paragraph">
<p>When declaring dependencies without a <a href="#version-catalog">version catalog</a>, prefer using the single GAV string notation <code>implementation("org.example:library:1.0")</code>.
Avoid using the named argument notation.
The named argument notation has been deprecated and will no longer be supported starting in Gradle 10.</p>
</div>
<div class="sect4">
<h5 id="explanation_15"><a class="anchor" href="#explanation_15"></a><a class="link" href="#explanation_15">Explanation</a></h5>
<div class="paragraph">
<p>All of these declarations will be treated equivalently when Gradle resolves dependencies.
However, the single-string form is more concise, easier to read, and is widely adopted in the broader JVM ecosystem.</p>
</div>
<div class="paragraph">
<p>This format is also recommended by <a href="https://central.sonatype.com/artifact/com.google.guava/guava">Maven Central</a> in its documentation and usage examples, making it the most familiar and consistent style for developers across tools.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_13"><a class="anchor" href="#example_13"></a><a class="link" href="#example_13">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_12"><a class="anchor" href="#dont_do_this_12"></a><a class="link" href="#dont_do_this_12">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(group = "com.fasterxml.jackson.core", name = "jackson-databind", version = "32.17.0")  // <b class="conum">(1)</b>
    api(group = "com.google.guava", name = "guava", version = "32.1.2-jre") {
        exclude(group = "com.google.code.findbugs", module = "jsr305")  // <b class="conum">(2)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation(group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.17.0') // <b class="conum">(1)</b>
    api(group: 'com.google.guava', name: 'guava', version: '32.1.2-jre') {
        exclude(group: 'com.google.code.findbugs', module: 'jsr305')    // <b class="conum">(2)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Avoid the named argument notation when declaring dependencies</p>
</li>
<li>
<p>Other modifiers methods and constraints like <code>exclude</code> are not included in this recommendation and can use named argument notation as needed</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_12"><a class="anchor" href="#do_this_instead_12"></a><a class="link" href="#do_this_instead_12">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useGavString-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useGavString-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.fasterxml.jackson.core:jackson-databind:2.17.0") // <b class="conum">(1)</b>
    api("com.google.guava:guava:32.1.2-jre") {
        exclude(group = "com.google.code.findbugs", module = "jsr305")  // <b class="conum">(2)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('com.fasterxml.jackson.core:jackson-databind:2.17.0') // <b class="conum">(1)</b>
    api('com.google.guava:guava:32.1.2-jre') {
        exclude(group: 'com.google.code.findbugs', module: 'jsr305')    // <b class="conum">(2)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use the string notation instead when declaring dependencies</p>
</li>
<li>
<p>Other modifiers methods and constraints like <code>exclude</code> are not included in this recommendation and can use named argument notation as needed</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_14"><a class="anchor" href="#references_14"></a><a class="link" href="#references_14">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#declaring-dependencies-basics">Declaring Dependencies Basics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_15"><a class="anchor" href="#tags_15"></a><a class="link" href="#tags_15">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:dependencies">#dependencies</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_content_filtering"><a class="anchor" href="#use_content_filtering"></a><a class="link" href="#use_content_filtering">Use Content Filtering with multiple Repositories</a></h4>
<div class="paragraph">
<p>When using multiple repositories in a build, use <a href="#repository-content-filtering">repository content filtering</a> to ensure that dependencies are resolved from an appropriate repository.</p>
</div>
<div class="sect4">
<h5 id="explanation_16"><a class="anchor" href="#explanation_16"></a><a class="link" href="#explanation_16">Explanation</a></h5>
<div class="paragraph">
<p>If your build declares more than one repository, you should declare content filters on these repositories to ensure you search for and obtain dependencies from the correct place.</p>
</div>
<div class="paragraph">
<p>Content filtering is necessary if you have a reason to restrict searching for a dependency to a particular repository, and can be a good idea even if acceptable dependency artifacts exist in multiple locations.</p>
</div>
<div class="paragraph">
<p>When possible, you should use the <a href="#sec:declaring-content-repositories">exclusiveContent</a> feature to restrict dependencies to a particular known repository.</p>
</div>
<div class="paragraph">
<p>Content filtering has three main benefits:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Performance</strong>, since you only query repositories for dependencies that should actually exist within them</p>
</li>
<li>
<p><strong>Security</strong>, by avoiding asking potentially every repository for every dependency (even ones they shouldn&#8217;t contain), you improve resiliency to supply chain attacks by avoiding leaking information about your dependencies to other repositories, or even downloading potentially malicious artifacts</p>
</li>
<li>
<p><strong>Reliability</strong>, by avoiding searching repositories that contain invalid or incorrect metadata for particular dependencies, which could result in obtaining incorrect transitive dependencies</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Repositories will be searched for dependencies that pass their filters in the order they are declared.
Often the last repository is declared without any filters in order to serve as a default <em>fallback repository</em> that is queried for any dependencies that don&#8217;t pass the filters present on the other repositories.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Carefully consider using content filtering with a fallback repository.
This can pose a security risk, so make sure you fully trust the fallback repository.
This setup can result in inadvertently (and silently) resolving dependencies from the fallback repository that were intended to come from filtered repositories if the dependencies were not available in those repositories.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_14"><a class="anchor" href="#example_14"></a><a class="link" href="#example_14">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_13"><a class="anchor" href="#dont_do_this_13"></a><a class="link" href="#dont_do_this_13">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>Don&#8217;t add multiple repositories without content filtering:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositories {
        mavenCentral()
        google()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositories {
        mavenCentral()
        google()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_13"><a class="anchor" href="#do_this_instead_13"></a><a class="link" href="#do_this_instead_13">Do This Instead</a></h6>
<div class="paragraph">
<p>Use content filtering to ensure that the proper repositories are searched first for the expected artifacts:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/contentFiltering-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/contentFiltering-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositories {
        google {
            content {
                // Use this repository for androidx and GMS dependencies
                includeGroupByRegex("androidx.*")
                includeGroup("com.google.gms")
            }
        }
        // Specify the fallback repository last
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositories {
        google {
            content {
                // Use this repository for androidx and GMS dependencies
                includeGroupByRegex("androidx.*")
                includeGroup("com.google.gms")
            }
        }
        // Specify the fallback repository last
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In many cases, it is better to use exclusive content filtering, as it ensures that dependencies <em>can only be found in the expected repository</em>.
If they are not present there, they will not be found at all.</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/contentFilteringExclusive-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/contentFilteringExclusive-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositories {
        exclusiveContent {
            forRepository {
                google()
            }
            filter {
                // Only use this repository, and use this repository only, for androidx and GMS dependencies
                includeGroupByRegex("androidx.*")
                includeGroup("com.google.gms")
            }
        }
        // Specify the fallback repository last
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositories {
        exclusiveContent {
            forRepository {
                google()
            }
            filter {
                // Only use this repository, and use this repository only, for androidx and GMS dependencies
                includeGroupByRegex("androidx.*")
                includeGroup("com.google.gms")
            }
        }
        // Specify the fallback repository last
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_15"><a class="anchor" href="#references_15"></a><a class="link" href="#references_15">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#repository-content-filtering">Filtering Repository Content</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_16"><a class="anchor" href="#tags_16"></a><a class="link" href="#tags_16">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:repositories">#repositories</a></code>, <code><a href="tags_reference.html#tag:dependencies">#dependencies</a></code></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_for_tasks"><a class="anchor" href="#best_practices_for_tasks"></a><a class="link" href="#best_practices_for_tasks">Best Practices for Tasks</a></h3>
<div class="sect3">
<h4 id="avoid_depends_on"><a class="anchor" href="#avoid_depends_on"></a><a class="link" href="#avoid_depends_on">Avoid DependsOn</a></h4>
<div class="paragraph">
<p>The task <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DefaultTask.html#setDependsOn(java.lang.Iterable)">dependsOn</a> method should only be used for <a href="#sec:lifecycle_tasks">lifecycle tasks</a> (tasks without task actions).</p>
</div>
<div class="sect4">
<h5 id="explanation_17"><a class="anchor" href="#explanation_17"></a><a class="link" href="#explanation_17">Explanation</a></h5>
<div class="paragraph">
<p>Tasks with actions should declare their inputs and outputs so that Gradles up-to-date checking can automatically determine when these tasks need to be run or rerun.</p>
</div>
<div class="paragraph">
<p>Using <code>dependsOn</code> to link tasks is a much coarser-grained mechanism that does <strong>not</strong> allow Gradle to understand why a task requires a prerequisite task to run, or which specific files from a prerequisite task are needed.
<code>dependsOn</code> forces Gradle to assume that <em>every</em> file produced by a prerequisite task is needed by this task.
This can lead to unnecessary task execution and decreased build performance.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_15"><a class="anchor" href="#example_15"></a><a class="link" href="#example_15">Example</a></h5>
<div class="paragraph">
<p>Here is a task that writes output to two separate files:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SimplePrintingTask : DefaultTask() {
    @get:OutputFile
    abstract val messageFile: RegularFileProperty

    @get:OutputFile
    abstract val audienceFile: RegularFileProperty

    @TaskAction // <b class="conum">(1)</b>
    fun run() {
        messageFile.get().asFile.writeText("Hello")
        audienceFile.get().asFile.writeText("World")
    }
}

tasks.register&lt;SimplePrintingTask&gt;("helloWorld") { // <b class="conum">(2)</b>
    messageFile.set(layout.buildDirectory.file("message.txt"))
    audienceFile.set(layout.buildDirectory.file("audience.txt"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SimplePrintingTask extends DefaultTask {
    @OutputFile
    abstract RegularFileProperty getMessageFile()

    @OutputFile
    abstract RegularFileProperty getAudienceFile()

    @TaskAction // <b class="conum">(1)</b>
    void run() {
        messageFile.get().asFile.write("Hello")
        audienceFile.get().asFile.write("World")
    }
}

tasks.register("helloWorld", SimplePrintingTask) { // <b class="conum">(2)</b>
    messageFile = layout.buildDirectory.file("message.txt")
    audienceFile = layout.buildDirectory.file("audience.txt")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Task With Multiple Outputs</strong>: <code>helloWorld</code> task prints "Hello" to its <code>messageFile</code> and "World" to its <code>audienceFile</code>.</p>
</li>
<li>
<p><strong>Registering the Task</strong>: <code>helloWorld</code> produces "message.txt" and "audience.txt" outputs.</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="dont_do_this_14"><a class="anchor" href="#dont_do_this_14"></a><a class="link" href="#dont_do_this_14">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>If you want to translate the greeting in the <code>message.txt</code> file using another task, you could do this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SimpleTranslationTask : DefaultTask() {
    @get:InputFile
    abstract val messageFile: RegularFileProperty

    @get:OutputFile
    abstract val translatedFile: RegularFileProperty

    init {
        messageFile.convention(project.layout.buildDirectory.file("message.txt"))
        translatedFile.convention(project.layout.buildDirectory.file("translated.txt"))
    }

    @TaskAction // <b class="conum">(1)</b>
    fun run() {
        val message = messageFile.get().asFile.readText(Charsets.UTF_8)
        val translatedMessage = if (message == "Hello") "Bonjour" else "Unknown"

        logger.lifecycle("Translation: " + translatedMessage)
        translatedFile.get().asFile.writeText(translatedMessage)
    }
}

tasks.register&lt;SimpleTranslationTask&gt;("translateBad") {
    dependsOn(tasks.named("helloWorld")) // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SimpleTranslationTask extends DefaultTask {
    @InputFile
    abstract RegularFileProperty getMessageFile()

    @OutputFile
    abstract RegularFileProperty getTranslatedFile()

    SimpleTranslationTask() {
        messageFile.convention(project.layout.buildDirectory.file("message.txt"))
        translatedFile.convention(project.layout.buildDirectory.file("translated.txt"))
    }

    @TaskAction // <b class="conum">(1)</b>
    void run() {
        def message = messageFile.get().asFile.text
        def translatedMessage = message == "Hello" ? "Bonjour" : "Unknown"

        logger.lifecycle("Translation: " + translatedMessage)
        translatedFile.get().asFile.write(translatedMessage)
    }
}

tasks.register("translateBad", SimpleTranslationTask) {
    dependsOn(tasks.named("helloWorld")) // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Translation Task Setup</strong>: <code>translateBad</code> requires <code>helloWorld</code> to run first to produce the message file otherwise it will fail with an error as the file does not exist.</p>
</li>
<li>
<p><strong>Explicit Task Dependency</strong>: Running <code>translateBad</code> will cause <code>helloWorld</code> to run first, but Gradle does not understand <em>why</em>.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_14"><a class="anchor" href="#do_this_instead_14"></a><a class="link" href="#do_this_instead_14">Do This Instead</a></h6>
<div class="paragraph">
<p>Instead, you should explicitly wire task inputs and outputs like this:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidDependsOn-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidDependsOn-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SimpleTranslationTask : DefaultTask() {
    @get:InputFile
    abstract val messageFile: RegularFileProperty

    @get:OutputFile
    abstract val translatedFile: RegularFileProperty

    init {
        messageFile.convention(project.layout.buildDirectory.file("message.txt"))
        translatedFile.convention(project.layout.buildDirectory.file("translated.txt"))
    }

    @TaskAction // <b class="conum">(1)</b>
    fun run() {
        val message = messageFile.get().asFile.readText(Charsets.UTF_8)
        val translatedMessage = if (message == "Hello") "Bonjour" else "Unknown"

        logger.lifecycle("Translation: " + translatedMessage)
        translatedFile.get().asFile.writeText(translatedMessage)
    }
}

tasks.register&lt;SimpleTranslationTask&gt;("translateGood") {
    inputs.file(tasks.named&lt;SimplePrintingTask&gt;("helloWorld").map { messageFile }) // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SimpleTranslationTask extends DefaultTask {
    @InputFile
    abstract RegularFileProperty getMessageFile()

    @OutputFile
    abstract RegularFileProperty getTranslatedFile()

    SimpleTranslationTask() {
        messageFile.convention(project.layout.buildDirectory.file("message.txt"))
        translatedFile.convention(project.layout.buildDirectory.file("translated.txt"))
    }

    @TaskAction // <b class="conum">(1)</b>
    void run() {
        def message = messageFile.get().asFile.text
        def translatedMessage = message == "Hello" ? "Bonjour" : "Unknown"

        logger.lifecycle("Translation: " + translatedMessage)
        translatedFile.get().asFile.write(translatedMessage)
    }
}

tasks.register("translateGood", SimpleTranslationTask) {
    inputs.file(tasks.named("helloWorld", SimplePrintingTask).map { messageFile }) // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Register Implicit Task Dependency</strong>: <code>translateGood</code> requires only one of the files that is produced by <code>helloWorld</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle now understands that <code>translateGood</code> requires <code>helloWorld</code> to have run successfully first because it needs to create the <code>message.txt</code> file which is then used by the translation task.
Gradle can use this information to optimize task scheduling.
Using the <code>map</code> method avoids eagerly retrieving the <code>helloWorld</code> task until the output is needed to determine if <code>translateGood</code> should run.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_16"><a class="anchor" href="#references_16"></a><a class="link" href="#references_16">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="incremental_build.html#sec:task_input_output_side_effects">Task Inputs and Outputs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_17"><a class="anchor" href="#tags_17"></a><a class="link" href="#tags_17">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code>, <code><a href="tags_reference.html#tag:inputs-and-outputs">#inputs-and-outputs</a></code>, <code><a href="tags_reference.html#tag:up-to-date-checking">#up-to-date-checking</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_cacheability_annotations"><a class="anchor" href="#use_cacheability_annotations"></a><a class="link" href="#use_cacheability_annotations">Favor <code>@CacheableTask</code> and <code>@DisableCachingByDefault</code> over <code>cacheIf(Spec)</code> and <code>doNotCacheIf(String, Spec)</code></a></h4>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskOutputs.html#cacheIf(org.gradle.api.specs.Spec)"><code>cacheIf</code></a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskOutputs.html#doNotCacheIf(java.lang.String,org.gradle.api.specs.Spec)"><code>doNotCacheIf</code></a> methods should only be used in situations where the <a href="#build_cache">cacheability</a> of a task varies between different task instances or cannot be determined until the task is executed by Gradle.
You should instead favor annotating the task class itself with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/CacheableTask.html"><code>@CacheableTask</code></a> annotation for any task that is <em>always</em> cacheable.
Likewise, the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/DisableCachingByDefault.html"><code>@DisableCachingByDefault</code></a> should be used to always disable caching for all instances of a task type.</p>
</div>
<div class="sect4">
<h5 id="explanation_18"><a class="anchor" href="#explanation_18"></a><a class="link" href="#explanation_18">Explanation</a></h5>
<div class="paragraph">
<p>Annotating a task type will ensure that <em>each task instance</em> of that type is properly understood by Gradle to be cacheable (or not cacheable).
This removes the need to remember to configure each of the task instances separately in build scripts.</p>
</div>
<div class="paragraph">
<p>Using the annotations also <em>documents</em> the intended cacheability of the task type within its own source, appearing in Javadoc and making the task&#8217;s behavior clear to other developers without requiring them to inspect each task instance&#8217;s configuration.
It is also slightly more efficient than running a test to determine cacheability.</p>
</div>
<div class="paragraph">
<p>Remember that only tasks that produce reproducible and relocatable output should be marked as <code>@CacheableTask</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_16"><a class="anchor" href="#example_16"></a><a class="link" href="#example_16">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_15"><a class="anchor" href="#dont_do_this_15"></a><a class="link" href="#dont_do_this_15">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>If you want to reuse the output of a task, you shouldn&#8217;t do this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class BadCalculatorTask : DefaultTask() { // <b class="conum">(1)</b>
    @get:Input
    abstract val first: Property&lt;Int&gt;

    @get:Input
    abstract val second: Property&lt;Int&gt;

    @get:OutputFile
    abstract val outputFile: RegularFileProperty

    @TaskAction
    fun run() {
        val result = first.get() + second.get()
        logger.lifecycle("Result: $result")
        outputFile.get().asFile.writeText(result.toString())
    }
}

tasks.register&lt;Delete&gt;("clean") {
    delete(layout.buildDirectory)
}

tasks.register&lt;BadCalculatorTask&gt;("addBad1") {
    first = 10
    second = 25
    outputFile = layout.buildDirectory.file("badOutput.txt")
    outputs.cacheIf { true } // <b class="conum">(2)</b>
}

tasks.register&lt;BadCalculatorTask&gt;("addBad2") { // <b class="conum">(3)</b>
    first = 3
    second = 7
    outputFile = layout.buildDirectory.file("badOutput2.txt")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class BadCalculatorTask extends DefaultTask {
    @Input
    abstract Property&lt;Integer&gt; getFirst()

    @Input
    abstract Property&lt;Integer&gt; getSecond()

    @OutputFile
    abstract RegularFileProperty getOutputFile()

    @TaskAction
    void run() {
        def result = first.get() + second.get()
        logger.lifecycle("Result: " + result)
        outputFile.get().asFile.write(result.toString())
    }
}

tasks.register("clean", Delete) {
    delete layout.buildDirectory
}

tasks.register("addBad1", BadCalculatorTask) {
    first = 10
    second = 25
    outputFile = layout.buildDirectory.file("badOutput.txt")
    outputs.cacheIf { true }
}

tasks.register("addBad2", BadCalculatorTask) {
    first = 3
    second = 7
    outputFile = layout.buildDirectory.file("badOutput2.txt")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Define a Task</strong>: The <code>BadCalculatorTask</code> type is deterministic and produces relocatable output, but is not annotated.</p>
</li>
<li>
<p><strong>Mark the Task Instance as Cacheable</strong>: This example shows how to mark a specific task instance as cacheable.</p>
</li>
<li>
<p><strong>Forget to Mark a Task Instance as Cacheable</strong>: Unfortunately, the <code>addBad2</code> instance of the <code>BadCalculatorTask</code> type is not marked as cacheable, so it will not be cached, despite behaving the same as <code>addBad1</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_15"><a class="anchor" href="#do_this_instead_15"></a><a class="link" href="#do_this_instead_15">Do This Instead</a></h6>
<div class="paragraph">
<p>As this task meets the criteria for cacheability (we can imagine a more complex calculation in the <code>@TaskAction</code> that would benefit from automatic work avoidance via caching), you should mark the <em>task type itself</em> as cacheable like this:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useCacheabilityAnnotations-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/useCacheabilityAnnotations-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableTask // <b class="conum">(1)</b>
abstract class GoodCalculatorTask : DefaultTask() {
    @get:Input
    abstract val first: Property&lt;Int&gt;

    @get:Input
    abstract val second: Property&lt;Int&gt;

    @get:OutputFile
    abstract val outputFile: RegularFileProperty

    @TaskAction
    fun run() {
        val result = first.get() + second.get()
        logger.lifecycle("Result: $result")
        outputFile.get().asFile.writeText(result.toString())
    }
}

tasks.register&lt;Delete&gt;("clean") {
    delete(layout.buildDirectory)
}

tasks.register&lt;GoodCalculatorTask&gt;("addGood1") { // <b class="conum">(2)</b>
    first = 10
    second = 25
    outputFile = layout.buildDirectory.file("goodOutput.txt")
}

tasks.register&lt;GoodCalculatorTask&gt;("addGood2") {
    first = 3
    second = 7
    outputFile = layout.buildDirectory.file("goodOutput2.txt")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableTask // <b class="conum">(1)</b>
abstract class GoodCalculatorTask extends DefaultTask {
    @Input
    abstract Property&lt;Integer&gt; getFirst()

    @Input
    abstract Property&lt;Integer&gt; getSecond()

    @OutputFile
    abstract RegularFileProperty getOutputFile()

    @TaskAction
    void run() {
        def result = first.get() + second.get()
        logger.lifecycle("Result: " + result)
        outputFile.get().asFile.write(result.toString())
    }
}

tasks.register("clean", Delete) {
    delete layout.buildDirectory
}

tasks.register("addGood1", GoodCalculatorTask) {
    first = 10
    second = 25
    outputFile = layout.buildDirectory.file("goodOutput.txt")
}

tasks.register("addGood2", GoodCalculatorTask) { // <b class="conum">(2)</b>
    first = 3
    second = 7
    outputFile = layout.buildDirectory.file("goodOutput2.txt")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Annotate the Task Type</strong>: Applying the <code>@CacheableTask</code> to a task type informs Gradle that instances of this task should <em>always</em> be cached.</p>
</li>
<li>
<p><strong>Nothing Else Needs To Be Done</strong>: When we register task instances, nothing else needs to be done - Gradle knows to cache them.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_17"><a class="anchor" href="#references_17"></a><a class="link" href="#references_17">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:caching_tasks">Caching Tasks</a></p>
</li>
<li>
<p><a href="#sec:task_output_caching_details">Cacheable Tasks</a></p>
</li>
<li>
<p><a href="#non_cacheable_tasks">Non-cacheable Tasks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_18"><a class="anchor" href="#tags_18"></a><a class="link" href="#tags_18">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code>, <code><a href="tags_reference.html#tag:caching">#caching</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_provider_get_outside_task_action"><a class="anchor" href="#avoid_provider_get_outside_task_action"></a><a class="link" href="#avoid_provider_get_outside_task_action">Do not call <code>get()</code> on a Provider outside a Task action</a></h4>
<div class="paragraph">
<p>When configuring tasks and extensions do not call <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#get()"><code>get()</code></a> on a provider, use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map(org.gradle.api.Transformer)"><code>map()</code></a>, or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#flatMap(org.gradle.api.Transformer)"><code>flatMap()</code></a> instead.</p>
</div>
<div class="sect4">
<h5 id="explanation_19"><a class="anchor" href="#explanation_19"></a><a class="link" href="#explanation_19">Explanation</a></h5>
<div class="paragraph">
<p>A provider should be evaluated as late as possible.
Calling <code>get()</code> forces immediate evaluation, which can trigger unintended side effects, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The value of the provider becomes an input to configuration, causing potential configuration cache misses.</p>
</li>
<li>
<p>The value may be evaluated too early, meaning you might not be using the final or correct value of the property. This may lead to painful and hard to debug ordering issues.</p>
</li>
<li>
<p>It breaks Gradles ability to build dependencies and to track task inputs and outputs, making automatic task dependency wiring impossible. See <a href="#working_with_task_dependencies_in_lazy_properties">Working with task inputs and outputs</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is preferable to avoid explicitly evaluating a <code>Provider</code> at all, and deferring to <code>map</code>/<code>flatMap</code> to connect <code>Providers</code> to <code>Providers</code> implicitly.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_17"><a class="anchor" href="#example_17"></a><a class="link" href="#example_17">Example</a></h5>
<div class="paragraph">
<p>Here is a task that writes an input <code>String</code> to a file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyTask : DefaultTask() {
    @get:Input
    abstract val myInput: Property&lt;String&gt;

    @get:OutputFile
    abstract val myOutput: RegularFileProperty

    @TaskAction
    fun doAction() {
        val outputFile = myOutput.get().asFile
        val outputText = myInput.get() // <b class="conum">(1)</b>
        println(outputText)
        outputFile.writeText(outputText)
    }
}

val currentEnvironment: Provider&lt;String&gt; = providers.gradleProperty("currentEnvironment").orElse("234") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyTask extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getMyInput()

    @OutputFile
    abstract RegularFileProperty getMyOutput()

    @TaskAction
    void doAction() {
        def outputFile = myOutput.get().asFile
        def outputText = myInput.get() // <b class="conum">(1)</b>
        println(outputText)
        outputFile.write(outputText)
    }
}

Provider&lt;String&gt; currentEnvironment = providers.gradleProperty("currentEnvironment").orElse("234") // <b class="conum">(2)</b></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Using <code>Provider.get()</code> in the task action</p>
</li>
<li>
<p>Gradle property that we wish to use as input</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="dont_do_this_16"><a class="anchor" href="#dont_do_this_16"></a><a class="link" href="#dont_do_this_16">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>You could call <code>get()</code> at configuration time to set up this task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;MyTask&gt;("avoidThis") {
    myInput = "currentEnvironment=${currentEnvironment.get()}"  // <b class="conum">(1)</b>
    myOutput = layout.buildDirectory.get().asFile.resolve("output-avoid.txt")  // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("avoidThis", MyTask) {
    myInput = "currentEnvironment=${currentEnvironment.get()}"  // <b class="conum">(1)</b>
    myOutput = new File(layout.buildDirectory.get().asFile, "output-avoid.txt")  // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Reading the value of <code>currentEnvironment</code> at configuration time</strong>: This value might change by the time the task start executing.</p>
</li>
<li>
<p><strong>Reading the value of <code>buildDirectory</code> at configuration time</strong>: This value might change by the time the task start executing.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_16"><a class="anchor" href="#do_this_instead_16"></a><a class="link" href="#do_this_instead_16">Do This Instead</a></h6>
<div class="paragraph">
<p>Instead, you should explicitly wire task inputs and outputs like this:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidProviderGetOutsideTaskAction-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidProviderGetOutsideTaskAction-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;MyTask&gt;("doThis") {
    myInput = currentEnvironment.map { "currentEnvironment=$it" }  // <b class="conum">(1)</b>
    myOutput = layout.buildDirectory.file("output-do.txt")  // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("doThis", MyTask) {
    myInput = currentEnvironment.map { "currentEnvironment=$it" }  // <b class="conum">(1)</b>
    myOutput = layout.buildDirectory.file("output-do.txt")  // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Using <code>map()</code> to transform <code>currentEnvironment</code></strong>: <code>map</code> transform runs only when the value is read.</p>
</li>
<li>
<p><strong>Using <code>file()</code> to create a new <code>Provider&lt;RegularFile&gt;</code></strong>: the value of the <code>buildDirectory</code> is only checked when the value of the provider is read.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_18"><a class="anchor" href="#references_18"></a><a class="link" href="#references_18">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="incremental_build.html#sec:task_input_output_side_effects">Task Inputs and Outputs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_19"><a class="anchor" href="#tags_19"></a><a class="link" href="#tags_19">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code>, <code><a href="tags_reference.html#tag:inputs-and-outputs">#inputs-and-outputs</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="group_describe_tasks"><a class="anchor" href="#group_describe_tasks"></a><a class="link" href="#group_describe_tasks">Group and Describe custom Tasks</a></h4>
<div class="paragraph">
<p>When defining custom task types or registering ad-hoc tasks, always set a clear <code>group</code> and <code>description</code>.</p>
</div>
<div class="sect4">
<h5 id="explanation_20"><a class="anchor" href="#explanation_20"></a><a class="link" href="#explanation_20">Explanation</a></h5>
<div class="paragraph">
<p>A good group name is short, lowercase, and reflects the purpose or domain of the task.
For example: <code>documentation</code>, <code>verification</code>, <code>release</code>, or <code>publishing</code>.</p>
</div>
<div class="paragraph">
<p>Before creating a new group, look for an existing group name that aligns with your tasks intent.
Its often better to reuse an established category to keep the task output organized and familiar to users.</p>
</div>
<div class="paragraph">
<p>This information is used in the <a href="#sec:listing_tasks">Tasks Report</a> (shown via <code>./gradlew tasks</code>) to group and describe available tasks in a readable format.</p>
</div>
<div class="paragraph">
<p>Providing a group and description ensures that your tasks are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Displayed clearly in the report</p>
</li>
<li>
<p>Categorized appropriately</p>
</li>
<li>
<p>Understandable to other users (and to your future self)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Tasks with no group are hidden from the <a href="#sec:listing_tasks">Tasks Report</a> unless <code>--all</code> is specified.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_18"><a class="anchor" href="#example_18"></a><a class="link" href="#example_18">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_17"><a class="anchor" href="#dont_do_this_17"></a><a class="link" href="#dont_do_this_17">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>Tasks without a group appear under the "other" category in <code>./gradlew tasks --all</code> output, making them harder to locate:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("generateDocs") {
    // Build logic to generate documentation
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('generateDocs') {
    // Build logic to generate documentation
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradlew :app:tasks --all

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Other tasks
-----------
compileJava - Compiles main Java source.
compileTestJava - Compiles test Java source.
generateDocs
processResources - Processes main resources.
processTestResources - Processes test resources.
startScripts - Creates OS specific scripts to run the project as a JVM application.</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_17"><a class="anchor" href="#do_this_instead_17"></a><a class="link" href="#do_this_instead_17">Do this Instead</a></h6>
<div class="paragraph">
<p>When defining custom tasks, always assign a clear <code>group</code> and <code>description</code>:</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/groupTasks-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/groupTasks-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("generateDocs") {
    group = "documentation"
    description = "Generates project documentation from source files."
    // Build logic to generate documentation
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('generateDocs') {
    group = 'documentation'
    description = 'Generates project documentation from source files.'
    // Build logic to generate documentation
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradlew :app:tasks --all

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Documentation tasks
-------------------
generateDocs - Generates project documentation from source files.
javadoc - Generates Javadoc API documentation for the 'main' feature.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_19"><a class="anchor" href="#references_19"></a><a class="link" href="#references_19">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:task_groups">Task Group and Description</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_20"><a class="anchor" href="#tags_20"></a><a class="link" href="#tags_20">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_eager_file_collection_apis"><a class="anchor" href="#avoid_eager_file_collection_apis"></a><a class="link" href="#avoid_eager_file_collection_apis">Avoid using eager APIs on File Collections</a></h4>
<div class="paragraph">
<p>When working with Gradle&#8217;s file collection types, be careful to avoid triggering dependency resolution during the configuration phase.</p>
</div>
<div class="sect4">
<h5 id="explanation_21"><a class="anchor" href="#explanation_21"></a><a class="link" href="#explanation_21">Explanation</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/Configuration.html"><code>Configuration</code></a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html"><code>FileCollection</code></a> types extend the JDKs <code>Collection&lt;File&gt;</code> interface.</p>
</div>
<div class="paragraph">
<p>However, calling some available methods from this interfacesuch as <code>.size()</code>, <code>.isEmpty()</code>, <code>getFiles()</code>, <code>asPath()</code>, or <code>.toList()</code>on these Gradle types will implicitly trigger resolution of their dependencies.
The same is possible using Kotlin stdlib collection extension methods or Groovy GDK collection extensions.
Converting a <code>Configuration</code> to a <code>Set&lt;File&gt;</code> also discards any implicit task dependencies it carries.</p>
</div>
<div class="paragraph">
<p>You should avoid using these methods when configuring your build.
Instead, use the methods defined directly on the Gradle interfaces - this is a necessary <em>first step</em> towards preventing eager resolutions.
Be sure to use <a href="#working_with_files_in_lazy_properties">lazy types and APIs</a> that defer resolution to wire task dependencies and inputs correctly.
Some methods that cause resolution are not obvious.
Be sure to check the actual behavior when using configurations in an atypical way.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_19"><a class="anchor" href="#example_19"></a><a class="link" href="#example_19">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_18"><a class="anchor" href="#dont_do_this_18"></a><a class="link" href="#dont_do_this_18">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class FileCounterTask: DefaultTask() {
    @get:InputFiles
    abstract val countMe: ConfigurableFileCollection

    @TaskAction
    fun countFiles() {
        logger.lifecycle("Count: " + countMe.files.size)
    }
}

tasks.register&lt;FileCounterTask&gt;("badCountingTask") {
    if (!configurations.runtimeClasspath.get().isEmpty()) { // <b class="conum">(1)</b>
        logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.get().state == RESOLVED))
        countMe.from(configurations.runtimeClasspath)
    }
}

tasks.register&lt;FileCounterTask&gt;("badCountingTask2") {
    val files = configurations.runtimeClasspath.get().files // <b class="conum">(2)</b>
    countMe.from(files)
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.get().state == RESOLVED))
}

tasks.register&lt;FileCounterTask&gt;("badCountingTask3") {
    val files = configurations.runtimeClasspath.get() + layout.projectDirectory.file("extra.txt") // <b class="conum">(3)</b>
    countMe.from(files)
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.get().state == RESOLVED))
}

tasks.register&lt;Zip&gt;("badZippingTask") { // <b class="conum">(4)</b>
    if (!configurations.runtimeClasspath.get().isEmpty()) {
        logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.get().state == RESOLVED))
        from(configurations.runtimeClasspath)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class FileCounterTask extends DefaultTask {
    @InputFiles
    abstract ConfigurableFileCollection getCountMe();

    @TaskAction
    void countFiles() {
        logger.lifecycle("Count: " + countMe.files.size())
    }
}

tasks.register("badCountingTask", FileCounterTask) {
    if (!configurations.runtimeClasspath.isEmpty()) { // <b class="conum">(1)</b>
        logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.state == RESOLVED))
        countMe.from(configurations.runtimeClasspath)
    }
}

tasks.register("badCountingTask2", FileCounterTask) {
    def files = configurations.runtimeClasspath.files // <b class="conum">(2)</b>
    countMe.from(files)
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.state == RESOLVED))
}

tasks.register("badCountingTask3", FileCounterTask) {
    def files = configurations.runtimeClasspath + layout.projectDirectory.file("extra.txt") // <b class="conum">(3)</b>
    countMe.from(files)
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.state == RESOLVED))
}

tasks.register("badZippingTask", Zip) { // <b class="conum">(4)</b>
    if (!configurations.runtimeClasspath.isEmpty()) {
        logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.state == RESOLVED))
        from(configurations.runtimeClasspath)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong><code>isEmpty()</code> causes resolution</strong>: Many seemingly harmless Collection API methods like <code>isEmpty()</code> cause Gradle to resolve dependencies.</p>
</li>
<li>
<p><strong>Accessing files directly</strong>: Using <code>getFiles()</code> to access the files in a <code>Configuration</code> will also cause Gradle to resolve the file collection.</p>
</li>
<li>
<p><strong>Adding a file via plus operator</strong>: Using the plus operator will force the <code>runtimeClasspath</code> configuration to be resolved implicitly.
The implementation of <code>Configuration</code> doesn&#8217;t override the plus operator for regular files, therefore it falls back to using the eager API, which causes resolution.</p>
</li>
<li>
<p><strong>Be careful with indirect inputs</strong>: Some built-in tasks, for example subtypes of <code>AbstractCopyTask</code> like <code>Zip</code>, allow adding inputs indirectly and can have the same problems.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_18"><a class="anchor" href="#do_this_instead_18"></a><a class="link" href="#do_this_instead_18">Do This Instead</a></h6>
<div class="paragraph">
<p>To avoid issues, always defer resolution until the execution phase.
Use APIs that support lazy evaluation.</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidJdkCollectionApiOnFileCollections-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidJdkCollectionApiOnFileCollections-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class FileCounterTask: DefaultTask() {
    @get:InputFiles
    abstract val countMe: ConfigurableFileCollection

    @TaskAction
    fun countFiles() {
        logger.lifecycle("Count: " + countMe.files.size)
    }
}

tasks.register&lt;FileCounterTask&gt;("goodCountingTask") {
    countMe.from(configurations.runtimeClasspath) // <b class="conum">(1)</b>
    countMe.from(layout.projectDirectory.file("extra.txt"))
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.get().state == RESOLVED))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class FileCounterTask extends DefaultTask {
    @InputFiles
    abstract ConfigurableFileCollection getCountMe();

    @TaskAction
    void countFiles() {
        logger.lifecycle("Count: " + countMe.files.size())
    }
}

tasks.register("goodCountingTask", FileCounterTask) {
    countMe.from(configurations.runtimeClasspath) // <b class="conum">(1)</b>
    countMe.from(layout.projectDirectory.file("extra.txt")) // <b class="conum">(2)</b>
    logger.lifecycle("Resolved: " + (configurations.runtimeClasspath.state == RESOLVED))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Add configurations to Task properties or Specs directly</strong>: This will defer resolution until the task is executed.</p>
</li>
<li>
<p><strong>Add files to Specs separately</strong>: This allows combining files with file collections without triggering implicit resolutions.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tags_21"><a class="anchor" href="#tags_21"></a><a class="link" href="#tags_21">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code>, <code><a href="tags_reference.html#tag:inputs-and-outputs">#inputs-and-outputs</a></code>, <code><a href="tags_reference.html#tag:configurations">#configurations</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dont_resolve_configurations_before_task_execution"><a class="anchor" href="#dont_resolve_configurations_before_task_execution"></a><a class="link" href="#dont_resolve_configurations_before_task_execution">Don&#8217;t resolve Configurations before Task Execution</a></h4>
<div class="paragraph">
<p>Resolving configurations before the task execution phase can lead to incorrect results and slower builds.</p>
</div>
<div class="sect4">
<h5 id="explanation_22"><a class="anchor" href="#explanation_22"></a><a class="link" href="#explanation_22">Explanation</a></h5>
<div class="paragraph">
<p>Resolving a configuration - either directly via calling its <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/Configuration.html#resolve()"><code>resolve()</code></a> method or indirectly via accessing its set of artifacts - returns a set of files that does not preserve references to the tasks that produced those files.</p>
</div>
<div class="paragraph">
<p>Configurations <em>are</em> file collections and can be added to <code>@InputFiles</code> properties on other tasks.
It is important to do this correctly to avoid breaking automatic task dependency wiring between a consumer task and any tasks that are implicitly required to produce the artifacts being consumed.
For example, if a configuration contains a project dependency, Gradle knows that consumers of the configuration must first run any tasks that produce that project&#8217;s artifacts.</p>
</div>
<div class="paragraph">
<p>In addition to correctness concerns, resolving configurations during the configuration phase can slow down the build, even when running unrelated tasks (e.g., <code>help</code>) that don&#8217;t require the resolved dependencies.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_20"><a class="anchor" href="#example_20"></a><a class="link" href="#example_20">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_19"><a class="anchor" href="#dont_do_this_19"></a><a class="link" href="#dont_do_this_19">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    runtimeOnly(project(":lib")) // <b class="conum">(1)</b>
}

abstract class BadClasspathPrinter : DefaultTask() {
    @get:InputFiles
    var classpath: Set&lt;File&gt; = emptySet() // <b class="conum">(2)</b>

    private fun calculateDigest(fileOrDirectory: File): Int {
        require(fileOrDirectory.exists()) { "File or directory $fileOrDirectory doesn't exist" }
        return 0 // actual implementation is stripped
    }

    @TaskAction
    fun run() {
        logger.lifecycle(
            classpath.joinToString("\n") {
                val digest = calculateDigest(it) // <b class="conum">(3)</b>
                "$it#$digest"
            }
        )
    }
}

tasks.register("badClasspathPrinter", BadClasspathPrinter::class) {
    classpath = configurations.named("runtimeClasspath").get().resolve() // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    runtimeOnly(project(":lib")) // <b class="conum">(1)</b>
}

abstract class BadClasspathPrinter extends DefaultTask {
    @InputFiles
    Set&lt;File&gt; classpath = [] as Set // <b class="conum">(2)</b>

    protected int calculateDigest(File fileOrDirectory) {
        if (!fileOrDirectory.exists()) {
            throw new IllegalArgumentException("File or directory $fileOrDirectory doesn't exist")
        }
        return 0 // actual implementation is stripped
    }

    @TaskAction
    void run() {
        logger.lifecycle(
            classpath.collect { file -&gt;
                def digest = calculateDigest(file) // <b class="conum">(3)</b>
                "$file#$digest"
            }.join("\n")
        )
    }
}

tasks.register("badClasspathPrinter", BadClasspathPrinter) {
    classpath = configurations.named("runtimeClasspath").get().resolve() // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Add project dependency</strong>: The  <code>:lib</code> project must be built in order to resolve the runtime classpath successfully.</p>
</li>
<li>
<p><strong>Declare input property as Set of files</strong>: A simple <code>Set</code> input doesn&#8217;t track task dependencies.</p>
</li>
<li>
<p><strong>Dependency artifacts are used to calculate digest</strong>: Artifacts from the already resolved classpath are used to calculate the digest.</p>
</li>
<li>
<p><strong>Resolve runtimeClasspath</strong>: The implicit task dependency on <code>:library:jar</code> task is lost here when the configuration is resolved prior to task execution.
The <code>lib</code> project will not be built when the <code>:app:badClasspathPrinter</code> task is run, leading to a failure in <code>calculateDigest</code> because the <code>lib.jar</code> file will not exist.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_19"><a class="anchor" href="#do_this_instead_19"></a><a class="link" href="#do_this_instead_19">Do This Instead</a></h6>
<div class="paragraph">
<p>To avoid issues, always defer resolution to the execution phase by using lazy APIs like <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a>.</p>
</div>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidResolvingConfigurationsManually-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidResolvingConfigurationsManually-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    runtimeOnly(project(":lib")) // <b class="conum">(1)</b>
}

abstract class GoodClasspathPrinter : DefaultTask() {
    @get:InputFiles
    abstract val classpath: ConfigurableFileCollection // <b class="conum">(2)</b>

    private fun calculateDigest(fileOrDirectory: File): Int {
        require(fileOrDirectory.exists()) { "File or directory $fileOrDirectory doesn't exist" }
        return 0 // actual implementation is stripped
    }

    @TaskAction
    fun run() {
        logger.lifecycle(
            classpath.joinToString("\n") {
                val digest = calculateDigest(it) // <b class="conum">(3)</b>
                "$it#$digest"
            }
        )
    }
}

tasks.register("goodClasspathPrinter", GoodClasspathPrinter::class.java) {
    classpath.from(configurations.named("runtimeClasspath")) // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    runtimeOnly(project(":lib")) // <b class="conum">(1)</b>
}

abstract class GoodClasspathPrinter extends DefaultTask {

    @InputFiles
    abstract ConfigurableFileCollection getClasspath() // <b class="conum">(2)</b>

    protected int calculateDigest(File fileOrDirectory) {
        if (!fileOrDirectory.exists()) {
            throw new IllegalArgumentException("File or directory $fileOrDirectory doesn't exist")
        }
        return 0 // actual implementation is stripped
    }

    @TaskAction
    void run() {
        logger.lifecycle(
            classpath.collect { file -&gt;
                def digest = calculateDigest(file) // <b class="conum">(3)</b>
                "$file#$digest"
            }.join("\n")
        )
    }
}

tasks.register("goodClasspathPrinter", GoodClasspathPrinter) {
    classpath.from(configurations.named("runtimeClasspath")) // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Add project dependency</strong>: This is the same.</p>
</li>
<li>
<p><strong>Declare input files property as ConfigurableFileCollection</strong>: This lazy collection type will track task dependencies.</p>
</li>
<li>
<p><strong>Dependency artifacts are resolved to calculate digest</strong>: The classpath will be resolved at execution time to calculate the digest.</p>
</li>
<li>
<p><strong>Configuration is passed to input property directly</strong>: Using <code>from</code> causes the configuration to be lazily wired to the input proeprty.
The configuration will be resolved when necessary, preserving task dependencies.
The output reveals that the <code>lib</code> project is now built when the <code>:app:goodClasspathPrinter</code> task is run because of the implicit task dependency, and the <code>lib.jar</code> file is found when calculating the digest.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tags_22"><a class="anchor" href="#tags_22"></a><a class="link" href="#tags_22">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code>, <code><a href="tags_reference.html#tag:inputs-and-outputs">#inputs-and-outputs</a></code>, <code><a href="tags_reference.html#tag:configurations">#configurations</a></code></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_for_performance"><a class="anchor" href="#best_practices_for_performance"></a><a class="link" href="#best_practices_for_performance">Best Practices for Performance</a></h3>
<div class="sect3">
<h4 id="use_utf8_encoding"><a class="anchor" href="#use_utf8_encoding"></a><a class="link" href="#use_utf8_encoding">Use UTF-8 File Encoding</a></h4>
<div class="paragraph">
<p>Set <code>UTF-8</code> as the default file encoding to ensure consistent behavior across platforms.</p>
</div>
<div class="sect4">
<h5 id="explanation_23"><a class="anchor" href="#explanation_23"></a><a class="link" href="#explanation_23">Explanation</a></h5>
<div class="paragraph">
<p>Use <code>UTF-8</code> as the default file encoding to ensure consistent behavior across environments and avoid caching issues caused by platform-dependent default encodings.</p>
</div>
<div class="paragraph">
<p>This is especially important when working with build caching, since differences in file encoding between environments can cause unexpected cache misses.</p>
</div>
<div class="paragraph">
<p>To enforce <code>UTF-8</code> encoding, add the following to your <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.jvmargs=-Dfile.encoding=UTF-8</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Do not rely on the default encoding of the underlying JVM or operating system, as this may differ between environments and lead to inconsistent behavior.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="references_20"><a class="anchor" href="#references_20"></a><a class="link" href="#references_20">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#system_file_encoding">File encoding and Caching</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_23"><a class="anchor" href="#tags_23"></a><a class="link" href="#tags_23">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:properties">#properties</a></code>, <code><a href="tags_reference.html#tag:caching">#caching</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_build_cache"><a class="anchor" href="#use_build_cache"></a><a class="link" href="#use_build_cache">Use the Build Cache</a></h4>
<div class="paragraph">
<p>Use the Build Cache to save time by reusing outputs produced by previous builds.</p>
</div>
<div class="sect4">
<h5 id="explanation_24"><a class="anchor" href="#explanation_24"></a><a class="link" href="#explanation_24">Explanation</a></h5>
<div class="paragraph">
<p>The Build Cache avoids re-executing tasks when their inputs haven&#8217;t changed by reusing outputs from previous builds.</p>
</div>
<div class="paragraph">
<p>This prevents redundant work.
If the inputs are the same, the outputs will be too, resulting in faster, more efficient builds.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_21"><a class="anchor" href="#example_21"></a><a class="link" href="#example_21">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_20"><a class="anchor" href="#dont_do_this_20"></a><a class="link" href="#dont_do_this_20">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>Build caching is disabled by default:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># caching is off by default
# org.gradle.caching=false</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_20"><a class="anchor" href="#do_this_instead_20"></a><a class="link" href="#do_this_instead_20">Do This Instead</a></h6>
<div class="paragraph">
<p>To enable the Build Cache, add the following to your <code>gradle.properties</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.caching=true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When you build your project for the first time, Gradle populates the cache with the outputs of tasks like compilation.</p>
</div>
<div class="paragraph">
<p>Even if you run <code>./gradlew clean</code> to delete the build directory, Gradle can reuse cached outputs in subsequent builds.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; ./gradlew clean
:clean
BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>On subsequent builds, instead of executing the <code>:compileJava</code> task again, the outputs of the task will be loaded from the Build Cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; ./gradlew compileJava
&gt; Task :compileJava FROM-CACHE

BUILD SUCCESSFUL in 0s
1 actionable task: 1 from cache</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_21"><a class="anchor" href="#references_21"></a><a class="link" href="#references_21">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:build_cache_intro">Build Cache Overview</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_24"><a class="anchor" href="#tags_24"></a><a class="link" href="#tags_24">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:properties">#properties</a></code>, <code><a href="tags_reference.html#tag:caching">#caching</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_configuration_cache"><a class="anchor" href="#use_configuration_cache"></a><a class="link" href="#use_configuration_cache">Use the Configuration Cache</a></h4>
<div class="paragraph">
<p>Use the Configuration Cache to significantly improve build performance by caching the result of the configuration phase and reusing it in subsequent builds.</p>
</div>
<div class="sect4">
<h5 id="explanation_25"><a class="anchor" href="#explanation_25"></a><a class="link" href="#explanation_25">Explanation</a></h5>
<div class="paragraph">
<p>The Configuration Cache works by saving the result of the configuration phase.
On the next build, if nothing relevant has changed, Gradle skips configuration entirely and loads the cached task graph from disk, jumping straight to task execution.</p>
</div>
<div class="paragraph">
<p>This can dramatically reduce build time for large builds, but its just as valuable for smaller builds where configuration overhead can dominate short iterations.
Faster feedback helps developers stay focused, without waiting on redundant configuration work.</p>
</div>
<div class="paragraph">
<p>Its important to understand how this differs from the Build Cache.
The Build Cache stores the outputs of task execution, while the Configuration Cache stores the configured task graph before execution begins.
These are independent mechanisms that solve different problems, but they are designed to work together for optimal performance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Configuration Cache is the preferred way to execute Gradle builds, but it is not enabled by default.
Many existing builds and plugins are not yet fully compatible, and adopting it may involve refactoring of build logic.
Enabling it by default could lead to unexpected build failures, so Gradle uses an opt-in adoption model to allow teams to verify compatibility and adopt configuration caching incrementally and safely.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_22"><a class="anchor" href="#example_22"></a><a class="link" href="#example_22">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_21"><a class="anchor" href="#dont_do_this_21"></a><a class="link" href="#dont_do_this_21">Don&#8217;t Do This</a></h6>
<div class="paragraph">
<p>Configuration Caching is not enabled by default:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># caching is off by default
# org.gradle.configuration-cache=false</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_21"><a class="anchor" href="#do_this_instead_21"></a><a class="link" href="#do_this_instead_21">Do This Instead</a></h6>
<div class="paragraph">
<p>To enable the Configuration Cache, add the following to your <code>gradle.properties</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache=true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When you build your project for the first time, Gradle stores the outcome of the configuration phase, including the task graph, in the Configuration Cache.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; ./gradlew compileJava

Configuration cache entry stored.
&gt; Task :processResources NO-SOURCE
&gt; Task :processTestResources NO-SOURCE
&gt; Task :compileJava
&gt; Task :classes
&gt; Task :compileTestJava NO-SOURCE
&gt; Task :testClasses UP-TO-DATE
&gt; Task :test NO-SOURCE
&gt; Task :check UP-TO-DATE
&gt; Task :jar
&gt; Task :assemble
&gt; Task :build

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>On subsequent builds, instead of reconfiguring tasks like <code>:compileJava</code>, Gradle loads the task graph from the Configuration Cache and proceeds directly to execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; ./gradlew compileJava

Configuration cache entry reused.
&gt; Task :processResources NO-SOURCE
&gt; Task :processTestResources NO-SOURCE
&gt; Task :compileJava
&gt; Task :classes
&gt; Task :compileTestJava NO-SOURCE
&gt; Task :testClasses UP-TO-DATE
&gt; Task :test NO-SOURCE
&gt; Task :check UP-TO-DATE
&gt; Task :jar
&gt; Task :assemble
&gt; Task :build

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_22"><a class="anchor" href="#references_22"></a><a class="link" href="#references_22">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#config_cache:usage:enable">Enabling The Configuration Cache</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_25"><a class="anchor" href="#tags_25"></a><a class="link" href="#tags_25">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:properties">#properties</a></code>, <code><a href="tags_reference.html#tag:caching">#caching</a></code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_computations_in_configuration_phase"><a class="anchor" href="#avoid_computations_in_configuration_phase"></a><a class="link" href="#avoid_computations_in_configuration_phase">Avoid Expensive Computations in Configuration Phase</a></h4>
<div class="paragraph">
<p>Avoid expensive computations in the <a href="#build_phases">configuration phase</a>, instead, move them to task actions.</p>
</div>
<div class="sect4">
<h5 id="explanation_26"><a class="anchor" href="#explanation_26"></a><a class="link" href="#explanation_26">Explanation</a></h5>
<div class="paragraph">
<p>In order for Gradle to execute tasks it first needs to build the project task graph.
As part of discovering what tasks to include in the task graph, Gradle will configure all the tasks that are directly requested, any task dependencies of the requested tasks, and also any tasks that are not lazily registered.
This work is done in the configuration phase.</p>
</div>
<div class="paragraph">
<p>Performing expensive or slow operations such as file or network I/O, or CPU-heavy calculations in the configuration phase forces these to run even when they might be unnecessary to complete the requested work of the invoked tasks.
It is better to move these operations to task actions so that they run only when required.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_23"><a class="anchor" href="#example_23"></a><a class="link" href="#example_23">Example</a></h5>
<div class="sect5">
<h6 id="dont_do_this_22"><a class="anchor" href="#dont_do_this_22"></a><a class="link" href="#dont_do_this_22">Don&#8217;t Do This</a></h6>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyTask : DefaultTask() {
    @get:Input
    lateinit var computationResult: String
    @TaskAction
    fun run() {
        logger.lifecycle(computationResult)
    }
}

fun heavyWork(): String {
    println("Start heavy work")
    Thread.sleep(5000)
    println("Finish heavy work")
    return "Heavy computation result"
}

tasks.register&lt;MyTask&gt;("myTask") {
    computationResult = heavyWork() // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyTask extends DefaultTask {
    @Input
    String computationResult
    @TaskAction
    void run() {
        logger.lifecycle(computationResult)
    }
}

String heavyWork() {
    logger.lifecycle("Start heavy work")
    Thread.sleep(5000)
    logger.lifecycle("Finish heavy work")
    return "Heavy computation result"
}

tasks.register("myTask", MyTask) {
    computationResult = heavyWork() // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Performing heavy computation during configuration phase.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="do_this_instead_22"><a class="anchor" href="#do_this_instead_22"></a><a class="link" href="#do_this_instead_22">Do This Instead</a></h6>
<div style="text-align: right;">
  <a class="download-project-link"
     data-base-path="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidComputationInConfigurationPhase-do/"
     href="https://download-directory.github.io/?url=https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/bestPractices/avoidComputationInConfigurationPhase-do/kotlin">
    <img src="https://img.shields.io/badge/Download%20Project-GitHub-blue?logo=github&style=flat" alt="Download"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyTask : DefaultTask() {
    @TaskAction
    fun run() {
        logger.lifecycle(heavyWork()) // <b class="conum">(1)</b>
    }

    fun heavyWork(): String {
        logger.lifecycle("Start heavy work")
        Thread.sleep(5000)
        logger.lifecycle("Finish heavy work")
        return "Heavy computation result"
    }
}

tasks.register&lt;MyTask&gt;("myTask")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyTask extends DefaultTask {
    @TaskAction
    void run() {
        logger.lifecycle(heavyWork()) // <b class="conum">(1)</b>
    }
    String heavyWork() {
        logger.lifecycle("Start heavy work")
        Thread.sleep(5000)
        logger.lifecycle("Finish heavy work")
        return "Heavy computation result"
    }
}

tasks.register("myTask", MyTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Performing heavy computation during execution phase in a task action.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="references_23"><a class="anchor" href="#references_23"></a><a class="link" href="#references_23">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="#lazy_configuration">lazy configuration</a></p>
</li>
<li>
<p><a href="#build_lifecycle">Build Lifecycle</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_26"><a class="anchor" href="#tags_26"></a><a class="link" href="#tags_26">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:tasks">#tasks</a></code></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="best_practices_for_security"><a class="anchor" href="#best_practices_for_security"></a><a class="link" href="#best_practices_for_security">Best Practices for Security</a></h3>
<div class="sect3">
<h4 id="validate_gradle_checksum"><a class="anchor" href="#validate_gradle_checksum"></a><a class="link" href="#validate_gradle_checksum">Validate the Gradle Distribution SHA-256 Checksum</a></h4>
<div class="paragraph">
<p>Set <code>distributionSha256Sum</code> in <code>gradle-wrapper.properties</code> to verify the integrity of the downloaded Gradle distribution.</p>
</div>
<div class="sect4">
<h5 id="explanation_27"><a class="anchor" href="#explanation_27"></a><a class="link" href="#explanation_27">Explanation</a></h5>
<div class="paragraph">
<p>Always set the <code>distributionSha256Sum</code> property in your <code>gradle-wrapper.properties</code> file to verify the integrity of the downloaded Gradle distribution.
This ensures the <code>gradle-X.X-bin.zip</code> file matches the official SHA-256 checksum published by Gradle, protecting your build from corruption or tampering.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">distributionUrl=https\://services.gradle.org/distributions/gradle-8.6-bin.zip
distributionSha256Sum=2b3f4...sha256-here...f4511</code></pre>
</div>
</div>
<div class="paragraph">
<p>This validation step enhances security by preventing the execution of compromised or incomplete Gradle distributions.</p>
</div>
<div class="paragraph">
<p>The official SHA-256 checksums can be found on the <a href="https://gradle.org/releases/">Gradle releases page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="references_24"><a class="anchor" href="#references_24"></a><a class="link" href="#references_24">References</a></h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.org/releases/">Gradle Releases with Checksums</a></p>
</li>
<li>
<p><a href="#gradle_wrapper">Gradle Wrapper Reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="tags_27"><a class="anchor" href="#tags_27"></a><a class="link" href="#tags_27">Tags</a></h5>
<div class="paragraph">
<p><code><a href="tags_reference.html#tag:properties">#properties</a></code>, <code><a href="tags_reference.html#tag:wrapper">#wrapper</a></code></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="core_plugins"><a class="anchor" href="#core_plugins"></a><a class="link" href="#core_plugins">CORE PLUGINS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="plugin_reference"><a class="anchor" href="#plugin_reference"></a><a class="link" href="#plugin_reference">Gradle Plugin Reference</a></h3>
<div class="paragraph">
<p>This page contains links and short descriptions for all the core plugins provided by Gradle itself.</p>
</div>
<div class="sect3">
<h4 id="jvm_languages_and_frameworks"><a class="anchor" href="#jvm_languages_and_frameworks"></a><a class="link" href="#jvm_languages_and_frameworks">JVM languages and frameworks</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="java_plugin.html#java_plugin">Java</a></dt>
<dd>
<p>Provides support for building any type of Java project.</p>
</dd>
<dt class="hdlist1"><a href="#java_library_plugin">Java Library</a></dt>
<dd>
<p>Provides support for building a Java library.</p>
</dd>
<dt class="hdlist1"><a href="#java_platform_plugin">Java Platform</a></dt>
<dd>
<p>Provides support for building a Java platform.</p>
</dd>
<dt class="hdlist1"><a href="#groovy_plugin">Groovy</a></dt>
<dd>
<p>Provides support for building any type of <a href="https://groovy-lang.org/">Groovy</a> project.</p>
</dd>
<dt class="hdlist1"><a href="#scala_plugin">Scala</a></dt>
<dd>
<p>Provides support for building any type of <a href="https://www.scala-lang.org/">Scala</a> project.</p>
</dd>
<dt class="hdlist1"><a href="antlr_plugin.html#antlr_plugin">ANTLR</a></dt>
<dd>
<p>Provides support for generating parsers using <a href="http://www.antlr.org/">ANTLR</a>.</p>
</dd>
<dt class="hdlist1"><a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a></dt>
<dd>
<p>Provides support for modeling and configuring multiple test suite invocations.</p>
</dd>
<dt class="hdlist1"><a href="test_report_aggregation_plugin.html#test_report_aggregation_plugin">Test Report Aggregation</a></dt>
<dd>
<p>Aggregates the results of multiple <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a> task invocations (potentially spanning multiple Gradle projects) into a single HTML report.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="native_languages"><a class="anchor" href="#native_languages"></a><a class="link" href="#native_languages">Native languages</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="cpp_application_plugin.html#cpp_application_plugin">C++ Application</a></dt>
<dd>
<p>Provides support for building C++ applications on Windows, Linux, and macOS.</p>
</dd>
<dt class="hdlist1"><a href="cpp_library_plugin.html#cpp_library_plugin">C++ Library</a></dt>
<dd>
<p>Provides support for building C++ libraries on Windows, Linux, and macOS.</p>
</dd>
<dt class="hdlist1"><a href="cpp_unit_test_plugin.html#cpp_unit_test_plugin">C++ Unit Test</a></dt>
<dd>
<p>Provides support for building and running C++ executable-based tests on Windows, Linux, and macOS.</p>
</dd>
<dt class="hdlist1"><a href="swift_application_plugin.html#swift_application_plugin">Swift Application</a></dt>
<dd>
<p>Provides support for building Swift applications on Linux and macOS.</p>
</dd>
<dt class="hdlist1"><a href="swift_library_plugin.html#swift_library_plugin">Swift Library</a></dt>
<dd>
<p>Provides support for building Swift libraries on Linux and macOS.</p>
</dd>
<dt class="hdlist1"><a href="xctest_plugin.html#xctest_plugin">XCTest</a></dt>
<dd>
<p>Provides support for building and running XCTest-based tests on Linux and macOS.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="packaging_and_distribution"><a class="anchor" href="#packaging_and_distribution"></a><a class="link" href="#packaging_and_distribution">Packaging and distribution</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#application_plugin">Application</a></dt>
<dd>
<p>Provides support for building JVM-based, runnable applications.</p>
</dd>
<dt class="hdlist1"><a href="war_plugin.html#war_plugin">WAR</a></dt>
<dd>
<p>Provides support for building and packaging WAR-based Java web applications.</p>
</dd>
<dt class="hdlist1"><a href="ear_plugin.html#ear_plugin">EAR</a></dt>
<dd>
<p>Provides support for building and packaging Java EE applications.</p>
</dd>
<dt class="hdlist1"><a href="#publishing_maven">Maven Publish</a></dt>
<dd>
<p>Provides support for <a href="#publishing_components">publishing artifacts</a> to Maven-compatible repositories.</p>
</dd>
<dt class="hdlist1"><a href="#publishing_ivy">Ivy Publish</a></dt>
<dd>
<p>Provides support for <a href="#publishing_components">publishing artifacts</a> to Ivy-compatible repositories.</p>
</dd>
<dt class="hdlist1"><a href="distribution_plugin.html#distribution_plugin">Distribution</a></dt>
<dd>
<p>Makes it easy to create ZIP and tarball distributions of your project.</p>
</dd>
<dt class="hdlist1"><a href="java_library_distribution_plugin.html#java_library_distribution_plugin">Java Library Distribution</a></dt>
<dd>
<p>Provides support for creating a ZIP distribution of a Java library project that includes its runtime dependencies.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="code_analysis"><a class="anchor" href="#code_analysis"></a><a class="link" href="#code_analysis">Code analysis</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="checkstyle_plugin.html#checkstyle_plugin">Checkstyle</a></dt>
<dd>
<p>Performs quality checks on your projects Java source files using <a href="https://checkstyle.org/index.html">Checkstyle</a> and generates associated reports.</p>
</dd>
<dt class="hdlist1"><a href="pmd_plugin.html#pmd_plugin">PMD</a></dt>
<dd>
<p>Performs quality checks on your projects Java source files using <a href="http://pmd.github.io/">PMD</a> and generates associated reports.</p>
</dd>
<dt class="hdlist1"><a href="jacoco_plugin.html#jacoco_plugin">JaCoCo</a></dt>
<dd>
<p>Provides code coverage metrics for your Java project using <a href="http://www.eclemma.org/jacoco/">JaCoCo</a>.</p>
</dd>
<dt class="hdlist1"><a href="jacoco_report_aggregation_plugin.html#jacoco_report_aggregation_plugin">JaCoCo Report Aggregation</a></dt>
<dd>
<p>Aggregates the results of multiple JaCoCo code coverage reports (potentially spanning multiple Gradle projects) into a single HTML report.</p>
</dd>
<dt class="hdlist1"><a href="codenarc_plugin.html#codenarc_plugin">CodeNarc</a></dt>
<dd>
<p>Performs quality checks on your Groovy source files using <a href="https://codenarc.org/">CodeNarc</a> and generates associated reports.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ide_integration"><a class="anchor" href="#ide_integration"></a><a class="link" href="#ide_integration">IDE integration</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="eclipse_plugin.html#eclipse_plugin">Eclipse</a></dt>
<dd>
<p>Generates Eclipse project files for the build that can be opened by the IDE. This set of plugins can also be used to fine tune <a href="http://projects.eclipse.org/projects/tools.buildship">Buildship&#8217;s</a> import process for Gradle builds.</p>
</dd>
<dt class="hdlist1"><a href="idea_plugin.html#idea_plugin">IntelliJ IDEA</a></dt>
<dd>
<p>Generates IDEA project files for the build that can be opened by the IDE. It can also be used to fine tune IDEA&#8217;s import process for Gradle builds.</p>
</dd>
<dt class="hdlist1"><a href="visual_studio_plugin.html#visual_studio_plugin">Visual Studio</a></dt>
<dd>
<p>Generates Visual Studio solution and project files for build that can be opened by the IDE.</p>
</dd>
<dt class="hdlist1"><a href="xcode_plugin.html#xcode_plugin">Xcode</a></dt>
<dd>
<p>Generates Xcode workspace and project files for the build that can be opened by the IDE.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="utility"><a class="anchor" href="#utility"></a><a class="link" href="#utility">Utility</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="base_plugin.html#base_plugin">Base</a></dt>
<dd>
<p>Provides common lifecycle tasks, such as <code>clean</code>, and other features common to most builds.</p>
</dd>
<dt class="hdlist1"><a href="build_init_plugin.html#build_init_plugin">Build Init</a></dt>
<dd>
<p>Generates a new Gradle build of a specified type, such as a Java library. It can also generate a build script from a Maven POM  see <a href="migrating_from_maven.html#migrating_from_maven">Migrating from Maven to Gradle</a> for more details.</p>
</dd>
<dt class="hdlist1"><a href="signing_plugin.html#signing_plugin">Signing</a></dt>
<dd>
<p>Provides support for digitally signing generated files and artifacts.</p>
</dd>
<dt class="hdlist1"><a href="java_gradle_plugin.html#java_gradle_plugin">Plugin Development</a></dt>
<dd>
<p>Makes it easier to develop and publish a Gradle plugin.</p>
</dd>
<dt class="hdlist1"><a href="project_report_plugin.html#project_report_plugin">Project Report Plugin</a></dt>
<dd>
<p>Helps to generate reports containing useful information about your build.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gradle_types"><a class="anchor" href="#gradle_types"></a><a class="link" href="#gradle_types">GRADLE TYPES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="lazy_evaluation"><a class="anchor" href="#lazy_evaluation"></a><a class="link" href="#lazy_evaluation">Lazy vs Eager Evaluation</a></h3>
<div class="paragraph">
<p>Understanding <strong>when</strong> values in your build are computed is crucial for writing fast and reliable build logic.
Gradle differentiates between <strong>eager</strong> and <strong>lazy</strong> evaluation:</p>
</div>
<div class="sect3">
<h4 id="eager_evaluation"><a class="anchor" href="#eager_evaluation"></a><a class="link" href="#eager_evaluation">Eager Evaluation</a></h4>
<div class="paragraph">
<p>Values are computed immediately during the <strong>configuration phase</strong>, before tasks ever run.</p>
</div>
<div class="paragraph">
<p>Eager evaluation comes with drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Slows down builds</strong>  even when tasks arent executed.</p>
</li>
<li>
<p><strong>Breaks compatibility</strong>   with and configuration caching.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Essentially, eager evaluation performs unnecessary work and reduces flexibility.</p>
</div>
</div>
<div class="sect3">
<h4 id="lazy_evaluation_2"><a class="anchor" href="#lazy_evaluation_2"></a><a class="link" href="#lazy_evaluation_2">Lazy Evaluation</a></h4>
<div class="paragraph">
<p>Lazy values are computed on-demand, typically during the <strong>execution phase</strong>, using Gradles Provider API (<code>Provider&lt;T&gt;</code> and <code>Property&lt;T&gt;</code>).</p>
</div>
<div class="paragraph">
<p>This approach has key benefits:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Deferred resolution</strong>  values are only computed when needed.</p>
</li>
<li>
<p><strong>Better performance</strong>  avoids unnecessary computation during configuration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Lazy evaluation enables build features like incremental builds, build caching, and configuration cache compatibility.</p>
</div>
</div>
<div class="sect3">
<h4 id="lazy_apis"><a class="anchor" href="#lazy_apis"></a><a class="link" href="#lazy_apis">Lazy APIs</a></h4>
<div class="paragraph">
<p>Lazy APIs were explicitly designed to avoid configuring tasks that arent going to be run, especially in large projects or Android builds where configuration overhead can be significant.</p>
</div>
<div class="paragraph">
<p>For example, you might use a <code>String</code> in your build script, but this value is <strong>eagerly evaluated</strong> during the <strong>configuration phase</strong>.
Instead, you should use Gradles <code>Property&lt;String&gt;</code> type, which defers evaluation until its needed during task <strong>execution</strong>.</p>
</div>
<div class="paragraph">
<p>Another example which is a common pitfall is using <code>tasks.withType(Test) {}</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test) {
    // configure all tasks eagerly
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This eagerly configures all <code>Test</code> tasks, even in builds where those tasks may never run.
Instead, use <code>configureEach</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    // configure only those tasks actually needed
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named("test") {
    // configure only if task will be executed
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This use of <code>configureEach</code> and <code>tasks.named(&#8230;&#8203;)</code> ensures configurations only apply to tasks invoked by the build.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="properties_and_providers"><a class="anchor" href="#properties_and_providers"></a><a class="link" href="#properties_and_providers">Properties and Providers</a></h3>
<div class="paragraph">
<p>Gradle provides properties that are important for <a href="#lazy_configuration">lazy configuration</a>.
When implementing a custom task or plugin, it&#8217;s imperative that you use these lazy properties.</p>
</div>
<div class="paragraph">
<p>Gradle represents lazy properties with two interfaces:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> - Represents a value that can be queried and changed.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> - Represents a value that can only be queried and cannot be changed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Properties and providers manage <em>values and configurations</em> in a build script.</p>
</div>
<div class="paragraph">
<p>In this example, <code>configuration</code> is a <code>Property&lt;String&gt;</code> that is set to the <code>configurationProvider</code> <code>Provider&lt;String&gt;</code>.
The <code>configurationProvider</code> lazily provides the value <code>"Hello, Gradle!"</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyIntroTask : DefaultTask() {
    @get:Input
    abstract val configuration: Property&lt;String&gt;

    @TaskAction
    fun printConfiguration() {
        println("Configuration value: ${configuration.get()}")
    }
}

val configurationProvider: Provider&lt;String&gt; = project.provider { "Hello, Gradle!" }

tasks.register("myIntroTask", MyIntroTask::class) {
    configuration = configurationProvider
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyIntroTask extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getConfiguration()

    @TaskAction
    void printConfiguration() {
        println "Configuration value: ${configuration.get()}"
    }
}

Provider&lt;String&gt; configurationProvider = project.provider { "Hello, Gradle!" }

tasks.register("myIntroTask", MyIntroTask) {
    it.setConfiguration(configurationProvider)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="understanding_properties"><a class="anchor" href="#understanding_properties"></a><a class="link" href="#understanding_properties">Understanding Properties</a></h4>
<div class="paragraph">
<p>Properties in Gradle are variables that hold values.
They can be defined and accessed within the build script to store information like file paths, version numbers, or custom values.</p>
</div>
<div class="paragraph">
<p>Properties can be set and retrieved using the <code>project</code> object:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Setting a property
val simpleMessageProperty: Property&lt;String&gt; = project.objects.property(String::class)
simpleMessageProperty.set("Hello, World from a Property!")
// Accessing a property
println(simpleMessageProperty.get())</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Setting a property
def simpleMessageProperty = project.objects.property(String)
simpleMessageProperty.set("Hello, World from a Property!")
// Accessing a property
println(simpleMessageProperty.get())</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are configurable.</p>
</li>
<li>
<p><code>Property</code> extends the <code>Provider</code> interface.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#set-T-">Property.set(T)</a> specifies a value for the property, overwriting whatever value may have been present.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#set-org.gradle.api.provider.Provider-">Property.set(Provider)</a> specifies a <code>Provider</code> for the value for the property, overwriting whatever value may have been present.
This allows you to wire together <code>Provider</code> and <code>Property</code> instances before the values are configured.</p>
</li>
<li>
<p>A <code>Property</code> can be created by the factory method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(Class)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="understanding_providers"><a class="anchor" href="#understanding_providers"></a><a class="link" href="#understanding_providers">Understanding Providers</a></h4>
<div class="paragraph">
<p>Providers are objects that represent a value that may not be immediately available.
Providers are useful for lazy evaluation and can be used to model values that may change over time or depend on other tasks or inputs:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Setting a provider
val simpleMessageProvider: Provider&lt;String&gt; = project.providers.provider { "Hello, World from a Provider!" }
// Accessing a provider
println(simpleMessageProvider.get())</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Setting a provider
def simpleMessageProvider = project.providers.provider { "Hello, World from a Provider!" }
// Accessing a provider
println(simpleMessageProvider.get())</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are read-only.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#get--">Provider.get()</a> returns the current value of the property.</p>
</li>
<li>
<p>A <code>Provider</code> can be created from another <code>Provider</code> using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a>.</p>
</li>
<li>
<p>Many other types extend <code>Provider</code> and can be used wherever a <code>Provider</code> is required.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="chaining_providers"><a class="anchor" href="#chaining_providers"></a><a class="link" href="#chaining_providers">Chaining Providers</a></h4>
<div class="paragraph">
<p>Chaining <code>Providers</code> preserves laziness and is essential to use when writing build logic.</p>
</div>
<div class="paragraph">
<p>These methods allow you to transform, combine, or provide fallback values without triggering eager evaluation:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>map()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transforms the value using a function, producing a new <code>Provider</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flatMap()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transforms the value into another <code>Provider</code>, and flattens the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>zip()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Combines multiple <code>Providers</code> into one, applying a function to their values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>orElse()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supplies a fallback <code>Provider</code> if the original is missing or undefined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Using <code>map()</code> is a common example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val majorVersion: Provider&lt;String&gt; = versionProvider.map { it.split(".")[0] }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can see the following example for a detailed breakdown at <code>Provider</code> chaining using <code>map()</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("printFloatFromFile") {
    // Type: RegularFile
    def myFile = layout.projectDirectory.file("someNumber.txt")

    // Type: Provider&lt;Float&gt;
    def floatProvider = project.providers
        // Type: Provider&lt;FileContents&gt;
        .fileContents(myFile)
        // Type: Provider&lt;String&gt;
        .asText
        // Type: Provider&lt;Float&gt;
        .map {
            // Type: Float
            it.toFloat()
        }

    doLast {
        // Type: Provider&lt;Float&gt;
        println "&gt;&gt;&gt; Float value from file: $floatProvider"
        // Type: Float
        println "&gt;&gt;&gt; Float value from file: ${floatProvider.get()}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed_properties"><a class="anchor" href="#managed_properties"></a><a class="link" href="#managed_properties">Using Gradle Managed Properties</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s managed properties allow you to declare properties as getters (Java, Groovy) or properties (Kotlin).</p>
</div>
<div class="paragraph">
<p>Gradle then automatically provides the implementation for these properties, managing their state.</p>
</div>
<div class="paragraph">
<p>A property may be <em>mutable</em>, meaning that it is of type <code>Property</code>, which has both a <code>get()</code> and a <code>set()</code> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyPropertyTask : DefaultTask() {
    @get:Input
    abstract val messageProperty: Property&lt;String&gt; // message property

    @TaskAction
    fun printMessage() {
        println(messageProperty.get())
    }
}

tasks.register&lt;MyPropertyTask&gt;("myPropertyTask") {
    messageProperty.set("Hello, Gradle!")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyPropertyTask extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getMessageProperty()

    @TaskAction
    void printMessage() {
        println(messageProperty.get())
    }
}

tasks.register('myPropertyTask', MyPropertyTask) {
    messageProperty.set("Hello, Gradle!")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or <em>read-only</em>, meaning that it is of type <code>Provider</code>, which only has a <code>get()</code> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyProviderTask : DefaultTask() {
    val messageProvider: Provider&lt;String&gt; = project.providers.provider { "Hello, Gradle!" } // message provider

    @TaskAction
    fun printMessage() {
        println(messageProvider.get())
    }
}

tasks.register&lt;MyProviderTask&gt;("MyProviderTask") {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyProviderTask extends DefaultTask {
    final Provider&lt;String&gt; messageProvider = project.providers.provider { "Hello, Gradle!" }

    @TaskAction
    void printMessage() {
        println(messageProvider.get())
    }
}

tasks.register('MyProviderTask', MyProviderTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="mutable_managed_properties"><a class="anchor" href="#mutable_managed_properties"></a><a class="link" href="#mutable_managed_properties">Mutable Managed Properties</a></h5>
<div class="paragraph">
<p>A mutable managed property is declared using a getter method of type <code>Property&lt;T&gt;</code>, where <code>T</code> can be any serializable type or a <a href="#managed_types">fully managed Gradle type</a>.
The property must not have any setter methods.</p>
</div>
<div class="paragraph">
<p>Here is an example of a task type with an <code>uri</code> property of type <code>URI</code>:</p>
</div>
<div class="listingblock">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class Download extends DefaultTask {
    @Input
    public abstract Property&lt;URI&gt; getUri(); // abstract getter of type Property&lt;T&gt;

    @TaskAction
    void run() {
        System.out.println("Downloading " + getUri().get()); // Use the `uri` property
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for a property to be considered a mutable managed property, the property&#8217;s getter methods must have <code>public</code> or <code>protected</code> visibility.
It is recommended to also make the property <code>abstract</code>, so Gradle can manage the initialization of the property.</p>
</div>
<div class="paragraph">
<p>The property type must be one of the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Property&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Where <code>T</code> is typically <code>Double</code>, <code>Integer</code>, <code>Long</code>, <code>String</code>, or <code>Bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RegularFileProperty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurable regular file location, whose value is mutable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DirectoryProperty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurable directory location, whose value is mutable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ListProperty&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of elements of type <code>T</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SetProperty&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set of elements of type <code>T</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MapProperty&lt;K, V&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map of <code>K</code> type keys with <code>V</code> type values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConfigurableFileCollection</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A mutable <code>FileCollection</code> which represents a collection of file system locations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConfigurableFileTree</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A mutable <code>FileTree</code> which represents a hierarchy of files</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="read_only_managed_properties"><a class="anchor" href="#read_only_managed_properties"></a><a class="link" href="#read_only_managed_properties">Read-only Managed Properties (Providers)</a></h5>
<div class="paragraph">
<p>You can declare a read-only managed property, also known as a provider, using a getter method of type <code>Provider&lt;T&gt;</code>.
The method implementation needs to derive the value.
It can, for example, derive the value from other properties.</p>
</div>
<div class="paragraph">
<p>Here is an example of a task type with a <code>uri</code> provider that is derived from a <code>location</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class Download extends DefaultTask {
    @Input
    public abstract Property&lt;String&gt; getLocation();

    @Internal
    public Provider&lt;URI&gt; getUri() {
        return getLocation().map(l -&gt; URI.create("https://" + l));
    }

    @TaskAction
    void run() {
        System.out.println("Downloading " + getUri().get());  // Use the `uri` provider (read-only property)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="read_only_managed_nested_properties"><a class="anchor" href="#read_only_managed_nested_properties"></a><a class="link" href="#read_only_managed_nested_properties">Read-only Managed Nested Properties (Nested Providers)</a></h5>
<div class="paragraph">
<p>You can declare a read-only managed nested property by adding an abstract getter method for the property to a type annotated with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/Nested.html"><code>@Nested</code></a>.
The property should not have any setter methods.
Gradle provides the implementation for the getter method and creates a value for the property.</p>
</div>
<div class="paragraph">
<p>This pattern is useful when a custom type has a nested complex type which has the same lifecycle.
If the lifecycle is different, consider using <code>Property&lt;NestedType&gt;</code> instead.</p>
</div>
<div class="paragraph">
<p>Here is an example of a task type with a <code>resource</code> property.
The <code>Resource</code> type is also a custom Gradle type and defines some managed properties:</p>
</div>
<div class="listingblock">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class Download extends DefaultTask {
    @Nested
    public abstract Resource getResource(); // Use an abstract getter method annotated with @Nested

    @TaskAction
    void run() {
        // Use the `resource` property
        System.out.println("Downloading https://" + getResource().getHostName().get() + "/" + getResource().getPath().get());
    }
}

public interface Resource {
    @Input
    Property&lt;String&gt; getHostName();
    @Input
    Property&lt;String&gt; getPath();
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="read_only_managed_name_property"><a class="anchor" href="#read_only_managed_name_property"></a><a class="link" href="#read_only_managed_name_property">Read-only Managed "name" Property (Provider)</a></h5>
<div class="paragraph">
<p>If the type contains an abstract property called "name" of type <code>String</code>, Gradle provides an implementation for the getter
method, and extends each constructor with a "name" parameter, which comes before all other constructor parameters.</p>
</div>
<div class="paragraph">
<p>If the type is an interface, Gradle will provide a constructor with a single "name" parameter and <code>@Inject</code> semantics.</p>
</div>
<div class="paragraph">
<p>You can have your type implement or extend the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Named.html">Named</a> interface, which defines such a read-only "name" property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.gradle.api.Named

interface MyType : Named {
    // Other properties and methods...
}

class MyTypeImpl(override val name: String) : MyType {
    // Implement other properties and methods...
}

// Usage
val instance = MyTypeImpl("myName")
println(instance.name) // Prints: myName</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed_types"><a class="anchor" href="#managed_types"></a><a class="link" href="#managed_types">Using Gradle Managed Types</a></h4>
<div class="paragraph">
<p>A managed type as an abstract class or interface with no fields and whose properties are all managed.
These types have their state entirely managed by Gradle.</p>
</div>
<div class="paragraph">
<p>For example, this managed type is defined as an interface:</p>
</div>
<div class="listingblock">
<div class="title">Resource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface Resource {
    @Input
    Property&lt;String&gt; getHostName();
    @Input
    Property&lt;String&gt; getPath();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <em>named managed type</em> is a managed type that additionally has an abstract property "name" of type <code>String</code>.
Named managed types are especially useful as the element type of <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectContainer.html">NamedDomainObjectContainer</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface MyNamedType {
    val name: String
}

class MyNamedTypeImpl(override val name: String) : MyNamedType

class MyPluginExtension(project: Project) {
    val myNamedContainer: NamedDomainObjectContainer&lt;MyNamedType&gt; =
        project.container(MyNamedType::class.java) { name -&gt;
            project.objects.newInstance(MyNamedTypeImpl::class.java, name)
        }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface MyNamedType {
    String getName()
}

class MyNamedTypeImpl implements MyNamedType {
    String name

    MyNamedTypeImpl(String name) {
        this.name = name
    }
}

class MyPluginExtension {
    NamedDomainObjectContainer&lt;MyNamedType&gt; myNamedContainer

    MyPluginExtension(Project project) {
        myNamedContainer = project.container(MyNamedType) { name -&gt;
            new MyNamedTypeImpl(name)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using_java_bean_properties"><a class="anchor" href="#using_java_bean_properties"></a><a class="link" href="#using_java_bean_properties">Using Java Bean Properties</a></h4>
<div class="paragraph">
<p>Sometimes you may see properties implemented in the Java bean property style.
That is, they do not use a <code>Property&lt;T&gt;</code> or <code>Provider&lt;T&gt;</code> types but are instead implemented with concrete setter and getter methods (or corresponding conveniences in Groovy or Kotlin).</p>
</div>
<div class="paragraph">
<p>This style of property definition is legacy in Gradle and is discouraged:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyTask extends DefaultTask {
    private String someProperty;

    public String getSomeProperty() {
        return someProperty;
    }

    public void setSomeProperty(String someProperty) {
        this.someProperty = someProperty;
    }

    @TaskAction
    public void myAction() {
        System.out.println("SomeProperty: " + someProperty);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="collection_types"><a class="anchor" href="#collection_types"></a><a class="link" href="#collection_types">Collections</a></h3>
<div class="paragraph">
<p>Gradle provides types for maintaining collections of objects, intended to work well to extends Gradle&#8217;s DSLs and provide useful features such as lazy configuration.</p>
</div>
<div class="sect3">
<h4 id="available_collections"><a class="anchor" href="#available_collections"></a><a class="link" href="#available_collections">Available collections</a></h4>
<div class="paragraph">
<p>These collection types are used for managing collections of objects, particularly in the context of build scripts and plugins:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#domainobjectset"><code>DomainObjectSet&lt;T&gt;</code></a>: Represents a set of objects of type T. This set does not allow duplicate elements, and you can add, remove, and query objects in the set.</p>
</li>
<li>
<p><a href="#nameddomainobjectset"><code>NamedDomainObjectSet&lt;T&gt;</code></a>: A specialization of <code>DomainObjectSet</code> where each object has a unique name associated with it. This is often used for collections where each element needs to be uniquely identified by a name.</p>
</li>
<li>
<p><a href="#nameddomainobjectlist"><code>NamedDomainObjectList&lt;T&gt;</code></a>: Similar to <code>NamedDomainObjectSet</code>, but represents a list of objects where order matters. Each element has a unique name associated with it, and you can access elements by index as well as by name.</p>
</li>
<li>
<p><a href="#nameddomainobjectcontainer"><code>NamedDomainObjectContainer&lt;T&gt;</code></a>: A container for managing objects of type T, where each object has a unique name. This container provides methods for adding, removing, and querying objects by name.</p>
</li>
<li>
<p><a href="#extensiblepolymorphicdomainobjectcontainer"><code>ExtensiblePolymorphicDomainObjectContainer&lt;T&gt;</code></a>: An extension of <code>NamedDomainObjectContainer</code> that allows you to define instantiation strategies for different types of objects. This is useful when you have a container that can hold multiple types of objects, and you want to control how each type of object is instantiated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These types are commonly used in Gradle plugins and build scripts to manage collections of objects, such as tasks, configurations, or custom domain objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="domainobjectset"><a class="anchor" href="#domainobjectset"></a><a class="link" href="#domainobjectset"><code>DomainObjectSet</code></a></h4>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DomainObjectSet.html"><code>DomainObjectSet</code></a> simply holds a set of configurable objects.</p>
</div>
<div class="paragraph">
<p>Compared to <code>NamedDomainObjectContainer</code>, a <code>DomainObjectSet</code> doesn&#8217;t manage the objects in the collection.
They need to be created and added manually.</p>
</div>
<div class="paragraph">
<p>You can create an instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#domainObjectSet-java.lang.Class-">ObjectFactory.domainObjectSet()</a> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyPluginExtensionDomainObjectSet {
    // Define a domain object set to hold strings
    val myStrings: DomainObjectSet&lt;String&gt; = project.objects.domainObjectSet(String::class)

    // Add some strings to the domain object set
    fun addString(value: String) {
        myStrings.add(value)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyPluginExtensionDomainObjectSet {
    // Define a domain object set to hold strings
    DomainObjectSet&lt;String&gt; myStrings = project.objects.domainObjectSet(String)

    // Add some strings to the domain object set
    void addString(String value) {
        myStrings.add(value)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="nameddomainobjectset"><a class="anchor" href="#nameddomainobjectset"></a><a class="link" href="#nameddomainobjectset"><code>NamedDomainObjectSet</code></a></h4>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectSet.html"><code>NamedDomainObjectSet</code></a> holds a set of configurable objects, where each element has a name associated with it.</p>
</div>
<div class="paragraph">
<p>This is similar to <code>NamedDomainObjectContainer</code>, however a <code>NamedDomainObjectSet</code> doesn&#8217;t manage the objects in the collection.
They need to be created and added manually.</p>
</div>
<div class="paragraph">
<p>You can create an instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#namedDomainObjectSet-java.lang.Class-">ObjectFactory.namedDomainObjectSet()</a> method.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Person(val name: String)

abstract class MyPluginExtensionNamedDomainObjectSet {
    // Define a named domain object set to hold Person objects
    private val people: NamedDomainObjectSet&lt;Person&gt; = project.objects.namedDomainObjectSet(Person::class)

    // Add a person to the set
    fun addPerson(name: String) {
        people.plus(name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Person {
    String name
}

abstract class MyPluginExtensionNamedDomainObjectSet {
    // Define a named domain object set to hold Person objects
    NamedDomainObjectSet&lt;Person&gt; people = project.objects.namedDomainObjectSet(Person)

    // Add a person to the set
    void addPerson(String name) {
        people.create(name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="nameddomainobjectlist"><a class="anchor" href="#nameddomainobjectlist"></a><a class="link" href="#nameddomainobjectlist"><code>NamedDomainObjectList</code></a></h4>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectList.html"><code>NamedDomainObjectList</code></a> holds a list of configurable objects, where each element has a name associated with it.</p>
</div>
<div class="paragraph">
<p>This is similar to <code>NamedDomainObjectContainer</code>, however a <code>NamedDomainObjectList</code> doesn&#8217;t manage the objects in the collection.
They need to be created and added manually.</p>
</div>
<div class="paragraph">
<p>You can create an instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#namedDomainObjectList-java.lang.Class-">ObjectFactory.namedDomainObjectList()</a> method.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Person(val name: String)

abstract class MyPluginExtensionNamedDomainObjectList {
    // Define a named domain object list to hold Person objects
    private val people: NamedDomainObjectList&lt;Person&gt; = project.objects.namedDomainObjectList(Person::class)

    // Add a person to the container
    fun addPerson(name: String) {
        people.plus(name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Person {
    String name
}

abstract class MyPluginExtensionNamedDomainObjectList {
    // Define a named domain object container to hold Person objects
    NamedDomainObjectList&lt;Person&gt; people = project.container(Person)

    // Add a person to the container
    void addPerson(String name) {
        people.create(name: name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="nameddomainobjectcontainer"><a class="anchor" href="#nameddomainobjectcontainer"></a><a class="link" href="#nameddomainobjectcontainer"><code>NamedDomainObjectContainer</code></a></h4>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectContainer.html"><code>NamedDomainObjectContainer</code></a> manages a set of objects, where each element has a name associated with it.</p>
</div>
<div class="paragraph">
<p>The container takes care of creating and configuring the elements, and provides a DSL that build scripts can use to define and configure elements.
It is intended to hold objects which are themselves configurable, for example a set of custom Gradle objects.</p>
</div>
<div class="paragraph">
<p>Gradle uses <code>NamedDomainObjectContainer</code> type extensively throughout the API.
For example, the <code>project.tasks</code> object used to manage the tasks of a project is a <code>NamedDomainObjectContainer&lt;Task&gt;</code>.</p>
</div>
<div class="paragraph">
<p>You can create a container instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> service, which provides the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#domainObjectContainer-java.lang.Class-">ObjectFactory.domainObjectContainer()</a> method.
This is also available using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#container-java.lang.Class-">Project.container()</a> method, however in a custom Gradle type it&#8217;s generally better to use the injected <code>ObjectFactory</code> service instead of passing around a <code>Project</code> instance.</p>
</div>
<div class="paragraph">
<p>You can also create a container instance using a <a href="#read_only_managed_properties">read-only managed property</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Person(val name: String)

abstract class MyPluginExtensionNamedDomainObjectContainer {
    // Define a named domain object container to hold Person objects
    private val people: NamedDomainObjectContainer&lt;Person&gt; = project.container(Person::class)

    // Add a person to the container
    fun addPerson(name: String) {
        people.create(name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Person {
    String name
}

abstract class MyPluginExtensionNamedDomainObjectContainer {
    // Define a named domain object container to hold Person objects
    NamedDomainObjectContainer&lt;Person&gt; people = project.container(Person)

    // Add a person to the container
    void addPerson(String name) {
        people.create(name: name)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In order to use a type with any of the <code>domainObjectContainer()</code> methods, it must either</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be a <a href="#managed_types">named managed type</a>; or</p>
</li>
<li>
<p>expose a property named &#8220;name&#8221; as the unique, and constant, name for the object. The <code>domainObjectContainer(Class)</code>
variant of the method creates new instances by calling the constructor of the class that takes a string argument, which is the desired name of the object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Objects created this way are treated as custom Gradle types, and so can make use of the features discussed in this chapter, for example service injection or
managed properties.</p>
</div>
<div class="paragraph">
<p>See the above link for <code>domainObjectContainer()</code> method variants that allow custom instantiation strategies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface DownloadExtension {
    NamedDomainObjectContainer&lt;Resource&gt; getResources();
}

public interface Resource {
    // Type must have a read-only 'name' property
    String getName();

    Property&lt;URI&gt; getUri();

    Property&lt;String&gt; getUserName();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For each container property, Gradle automatically adds a block to the Groovy and Kotlin DSL that you can use to configure the contents of the container:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.gradle.sample.download")
}

download {
    // Can use a block to configure the container contents
    resources {
        register("gradle") {
            uri = uri("https://gradle.org")
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("org.gradle.sample.download")
}

download {
    // Can use a block to configure the container contents
    resources {
        register('gradle') {
            uri = uri('https://gradle.org')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensiblepolymorphicdomainobjectcontainer"><a class="anchor" href="#extensiblepolymorphicdomainobjectcontainer"></a><a class="link" href="#extensiblepolymorphicdomainobjectcontainer"><code>ExtensiblePolymorphicDomainObjectContainer</code></a></h4>
<div class="paragraph">
<p>An <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/ExtensiblePolymorphicDomainObjectContainer.html">ExtensiblePolymorphicDomainObjectContainer</a> is a <code>NamedDomainObjectContainer</code> that allows you to
define instantiation strategies for different types of objects.</p>
</div>
<div class="paragraph">
<p>You can create an instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#polymorphicDomainObjectContainer-java.lang.Class-">ObjectFactory.polymorphicDomainObjectContainer()</a> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Animal(val name: String)

class Dog(name: String, val breed: String) : Animal(name)

abstract class MyPluginExtensionExtensiblePolymorphicDomainObjectContainer(objectFactory: ObjectFactory) {
    // Define a container for animals
    private val animals: ExtensiblePolymorphicDomainObjectContainer&lt;Animal&gt; = objectFactory.polymorphicDomainObjectContainer(Animal::class)

    // Add a dog to the container
    fun addDog(name: String, breed: String) {
        var dog : Dog = Dog(name, breed)
        animals.add(dog)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Animal {
    String name
}

abstract class Dog extends Animal {
    String breed
}

abstract class MyPluginExtensionExtensiblePolymorphicDomainObjectContainer {
    // Define a container for animals
    ExtensiblePolymorphicDomainObjectContainer&lt;Animal&gt; animals

    MyPluginExtensionExtensiblePolymorphicDomainObjectContainer(ObjectFactory objectFactory) {
        // Create the container
        animals = objectFactory.polymorphicDomainObjectContainer(Animal)
    }

    // Add a dog to the container
    void addDog(String name, String breed) {
        animals.create(Dog, name: name, breed: breed)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="service_injection"><a class="anchor" href="#service_injection"></a><a class="link" href="#service_injection">Services and Service Injection</a></h3>
<div class="paragraph">
<p>Gradle provides a number of useful services that can be used by custom Gradle types.
For example, the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a> service can be used by a task to run work in parallel, as seen in the <a href="#worker_api">worker API</a> section.
The services are made available through <em>service injection</em>.</p>
</div>
<div class="sect3">
<h4 id="services_for_injection"><a class="anchor" href="#services_for_injection"></a><a class="link" href="#services_for_injection">Available services</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
You should avoid injecting types not listed below. Internal services can sometimes technically be injected, but this practice is not supported and may lead to breaking changes in the future.
Only inject the services explicitly listed below to ensure stability and compatibility.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following services are available for injection in all Gradle instantiated objects:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#objectfactory"><code>ObjectFactory</code></a> - Allows model objects to be created.</p>
</li>
<li>
<p><a href="#providerfactory"><code>ProviderFactory</code></a> - Creates <code>Provider</code> instances.</p>
</li>
<li>
<p><a href="#filesystemoperations"><code>FileSystemOperations</code></a> - Allows a task to run operations on the filesystem such as deleting files, copying files or syncing directories.</p>
</li>
<li>
<p><a href="#archiveoperations"><code>ArchiveOperations</code></a> - Allows a task to run operations on archive files such as ZIP or TAR files.</p>
</li>
<li>
<p><a href="#execoperations"><code>ExecOperations</code></a> - Allows a task to run external processes with dedicated support for running external <code>java</code> programs.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="additional_services_in_workers"><a class="anchor" href="#additional_services_in_workers"></a><a class="link" href="#additional_services_in_workers">Additional services in workers</a></h5>
<div class="paragraph">
<p>The following services are available for injection in worker API actions and parameters:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#workerexecutor"><code>WorkerExecutor</code></a> - Allows a task to run work in parallel.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="additional_services_in_projects"><a class="anchor" href="#additional_services_in_projects"></a><a class="link" href="#additional_services_in_projects">Additional services in projects</a></h5>
<div class="paragraph">
<p>The following services are available for injection in project plugins, extensions and objects created in a project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#sec:projectlayout"><code>ProjectLayout</code></a> - Provides access to key project locations.</p>
</li>
<li>
<p><a href="#workerexecutor"><code>WorkerExecutor</code></a> - Allows a task to run work in parallel.</p>
</li>
<li>
<p><a href="#toolingmodelbuilderregistry"><code>ToolingModelBuilderRegistry</code></a> - Allows a plugin to registers a Gradle tooling API model.</p>
</li>
<li>
<p><a href="#testeventreporterfactory"><code>TestEventReporterFactory</code></a> - Allows a plugin to access Gradle&#8217;s test events and its corresponding API.</p>
</li>
<li>
<p><a href="#dependencyfactory"><code>DependencyFactory</code></a> - Allows a plugin to create dependencies in a type-safe way.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="additional_services_in_settings"><a class="anchor" href="#additional_services_in_settings"></a><a class="link" href="#additional_services_in_settings">Additional services in settings</a></h5>
<div class="paragraph">
<p>The following services are available for injection in settings plugins, extensions and objects created in a project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#buildlayout"><code>BuildLayout</code></a> - Provides access to important locations for a Gradle build.</p>
</li>
<li>
<p><a href="#toolingmodelbuilderregistry"><code>ToolingModelBuilderRegistry</code></a> - Allows a plugin to registers a Gradle tooling API model.</p>
</li>
<li>
<p><a href="#dependencyfactory"><code>DependencyFactory</code></a> - Allows a plugin to create dependencies in a type-safe way.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="objectfactory"><a class="anchor" href="#objectfactory"></a><a class="link" href="#objectfactory"><code>ObjectFactory</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html"><code>ObjectFactory</code></a> is a service for creating custom Gradle types, allowing you to define nested objects and DSLs in your build logic.
It provides methods for creating instances of different types, such as properties (<code>Property&lt;T&gt;</code>), collections (<code>ListProperty&lt;T&gt;</code>, <code>SetProperty&lt;T&gt;</code>, <code>MapProperty&lt;K, V&gt;</code>), file-related objects (<code>RegularFileProperty</code>, <code>DirectoryProperty</code>, <code>ConfigurableFileCollection</code>, <code>ConfigurableFileTree</code>), and more.</p>
</div>
<div class="paragraph">
<p>You can obtain an instance of <code>ObjectFactory</code> using the <code>project.objects</code> property.
Here&#8217;s a simple example demonstrating how to use <code>ObjectFactory</code> to create a property and set its value:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("myObjectFactoryTask") {
    doLast {
        val objectFactory = project.objects
        val myProperty = objectFactory.property(String::class)
        myProperty.set("Hello, Gradle!")
        println(myProperty.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("myObjectFactoryTask") {
    doLast {
        def objectFactory = project.objects
        def myProperty = objectFactory.property(String)
        myProperty.set("Hello, Gradle!")
        println myProperty.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It is preferable to let Gradle create objects automatically by using <a href="#managed_properties">managed properties</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using <code>ObjectFactory</code> to create these objects ensures that they are properly managed by Gradle, especially in terms of configuration avoidance and lazy evaluation.
This means that the values of these objects are only calculated when needed, which can improve build performance.</p>
</div>
<div class="paragraph">
<p>In the following example, a project extension called <code>DownloadExtension</code> receives an <code>ObjectFactory</code> instance through its constructor.
The constructor uses this to create a nested <code>Resource</code> object (also a custom Gradle type) and makes this object available through the <code>resource</code> property:</p>
</div>
<div class="listingblock">
<div class="title">DownloadExtension.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class DownloadExtension {
    // A nested instance
    private final Resource resource;

    @Inject
    public DownloadExtension(ObjectFactory objectFactory) {
        // Use an injected ObjectFactory to create a Resource object
        resource = objectFactory.newInstance(Resource.class);
    }

    public Resource getResource() {
        return resource;
    }
}

public interface Resource {
    Property&lt;URI&gt; getUri();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is another example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyObjectFactoryTask
@Inject constructor(private var objectFactory: ObjectFactory) : DefaultTask() {

    @TaskAction
    fun doTaskAction() {
        val outputDirectory = objectFactory.directoryProperty()
        outputDirectory.convention(project.layout.projectDirectory)
        println(outputDirectory.get())
    }
}

tasks.register("myInjectedObjectFactoryTask", MyObjectFactoryTask::class) {}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyObjectFactoryTask extends DefaultTask {
    private ObjectFactory objectFactory

    @Inject //@javax.inject.Inject
    MyObjectFactoryTask(ObjectFactory objectFactory) {
        this.objectFactory = objectFactory
    }

    @TaskAction
    void doTaskAction() {
        var outputDirectory = objectFactory.directoryProperty()
        outputDirectory.convention(project.layout.projectDirectory)
        println(outputDirectory.get())
    }
}

tasks.register("myInjectedObjectFactoryTask",MyObjectFactoryTask) {}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>MyObjectFactoryTask</code> task uses an <code>ObjectFactory</code> instance, which is injected into the task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:projectlayout"><a class="anchor" href="#sec:projectlayout"></a><a class="link" href="#sec:projectlayout"><code>ProjectLayout</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.ProjectLayout.html"><code>ProjectLayout</code></a> is a service that provides access to the layout of a Gradle project&#8217;s directories and files.
It&#8217;s part of the <code>org.gradle.api.file</code> package and allows you to query the project&#8217;s layout to get information about source sets, build directories, and other file-related aspects of the project.</p>
</div>
<div class="paragraph">
<p>You can obtain a <code>ProjectLayout</code> instance from a <code>Project</code> object using the <code>project.layout</code> property.
Here&#8217;s a simple example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("showLayout") {
    doLast {
        val layout = project.layout
        println("Project Directory: ${layout.projectDirectory}")
        println("Build Directory: ${layout.buildDirectory.get()}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('showLayout') {
    doLast {
        def layout = project.layout
        println "Project Directory: ${layout.projectDirectory}"
        println "Build Directory: ${layout.buildDirectory.get()}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyProjectLayoutTask
@Inject constructor(private var projectLayout: ProjectLayout) : DefaultTask() {

    @TaskAction
    fun doTaskAction() {
        val outputDirectory = projectLayout.projectDirectory
        println(outputDirectory)
    }
}

tasks.register("myInjectedProjectLayoutTask", MyProjectLayoutTask::class) {}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyProjectLayoutTask extends DefaultTask {
    private ProjectLayout projectLayout

    @Inject //@javax.inject.Inject
    MyProjectLayoutTask(ProjectLayout projectLayout) {
        this.projectLayout = projectLayout
    }

    @TaskAction
    void doTaskAction() {
        var outputDirectory = projectLayout.projectDirectory
        println(outputDirectory)
    }
}

tasks.register("myInjectedProjectLayoutTask",MyProjectLayoutTask) {}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>MyProjectLayoutTask</code> task uses a <code>ProjectLayout</code> instance, which is injected into the task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="buildlayout"><a class="anchor" href="#buildlayout"></a><a class="link" href="#buildlayout"><code>BuildLayout</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.BuildLayout.html"><code>BuildLayout</code></a> is a service that provides access to the root and settings directory in a Settings plugin or a Settings script, it is analogous to <code>ProjectLayout</code>.
It&#8217;s part of the <code>org.gradle.api.file</code> package to access standard build-wide file system locations as lazily computed value.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These APIs are currently incubating but eventually should replace existing accessors in Settings, which return eagerly computed locations:<br>
<code>Settings.rootDir</code> &#8594; <code>Settings.layout.rootDirectory</code><br>
<code>Settings.settingsDir</code> &#8594; <code>Settings.layout.settingsDirectory</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can obtain a <code>BuildLayout</code> instance from a <code>Settings</code> object using the <code>settings.layout</code> property.
Here&#8217;s a simple example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">println("Root Directory: ${settings.layout.rootDirectory}")
println("Settings Directory: ${settings.layout.settingsDirectory}")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">println "Root Directory: ${settings.layout.rootDirectory}"
println "Settings Directory: ${settings.layout.settingsDirectory}"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyBuildLayoutPlugin @Inject constructor(private val buildLayout: BuildLayout) : Plugin&lt;Settings&gt; {
    override fun apply(settings: Settings) {
        println(buildLayout.rootDirectory)
    }
}

apply&lt;MyBuildLayoutPlugin&gt;()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyBuildLayoutPlugin implements Plugin&lt;Settings&gt; {
    private BuildLayout buildLayout

    @Inject //@javax.inject.Inject
    MyBuildLayoutPlugin(BuildLayout buildLayout) {
        this.buildLayout = buildLayout
    }

    @Override void apply(Settings settings) {
        // the meat and potatoes of the plugin
        println buildLayout.rootDirectory
    }
}

apply plugin: MyBuildLayoutPlugin</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This code defines a <code>MyBuildLayoutPlugin</code> plugin that implements the <code>Plugin</code> interface for the <code>Settings</code> type.
The plugin expects a <code>BuildLayout</code> instance to be injected into its constructor using the <code>@Inject</code> annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="providerfactory"><a class="anchor" href="#providerfactory"></a><a class="link" href="#providerfactory"><code>ProviderFactory</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html"><code>ProviderFactory</code></a> is a service that provides methods for creating different types of providers.
Providers are used to model values that may be computed lazily in your build scripts.</p>
</div>
<div class="paragraph">
<p>The <code>ProviderFactory</code> interface provides methods for creating various types of providers, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>provider(Callable&lt;T&gt; value)</code> to create a provider with a value that is lazily computed based on a <code>Callable</code>.</p>
</li>
<li>
<p><code>provider(Provider&lt;T&gt; value)</code> to create a provider that simply wraps an existing provider.</p>
</li>
<li>
<p><code>property(Class&lt;T&gt; type)</code> to create a property provider for a specific type.</p>
</li>
<li>
<p><code>gradleProperty(Class&lt;T&gt; type)</code> to create a property provider that reads its value from a Gradle project property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example demonstrating the use of <code>ProviderFactory</code> using <code>project.providers</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("printMessage") {
    doLast {
        val providerFactory = project.providers
        val messageProvider = providerFactory.provider { "Hello, Gradle!" }
        println(messageProvider.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('printMessage') {
    doLast {
        def providerFactory = project.providers
        def messageProvider = providerFactory.provider { "Hello, Gradle!" }
        println messageProvider.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The task named <code>printMessage</code> uses the <code>ProviderFactory</code> to create a <code>provider</code> that supplies the message string.</p>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyProviderFactoryTask
@Inject constructor(private var providerFactory: ProviderFactory) : DefaultTask() {

    @TaskAction
    fun doTaskAction() {
        val outputDirectory = providerFactory.provider { "build/my-file.txt" }
        println(outputDirectory.get())
    }
}

tasks.register("myInjectedProviderFactoryTask", MyProviderFactoryTask::class) {}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyProviderFactoryTask extends DefaultTask {
    private ProviderFactory providerFactory

    @Inject //@javax.inject.Inject
    MyProviderFactoryTask(ProviderFactory providerFactory) {
        this.providerFactory = providerFactory
    }

    @TaskAction
    void doTaskAction() {
        var outputDirectory = providerFactory.provider { "build/my-file.txt" }
        println(outputDirectory.get())
    }
}

tasks.register("myInjectedProviderFactoryTask",MyProviderFactoryTask) {}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ProviderFactory</code> service is injected into the <code>MyProviderFactoryTask</code> task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="workerexecutor"><a class="anchor" href="#workerexecutor"></a><a class="link" href="#workerexecutor"><code>WorkerExecutor</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html"><code>WorkerExecutor</code></a> is a service that allows you to perform parallel execution of tasks using worker processes.
This is particularly useful for tasks that perform CPU-intensive or long-running operations, as it allows them to be executed in parallel, improving build performance.</p>
</div>
<div class="paragraph">
<p>Using <code>WorkerExecutor</code>, you can submit units of work (called actions) to be executed in separate worker processes.
This helps isolate the work from the main Gradle process, providing better reliability and performance.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a basic example of how you might use <code>WorkerExecutor</code> in a build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyWorkAction : WorkAction&lt;WorkParameters.None&gt; {
    private val greeting: String = "Hello from a Worker!"

    override fun execute() {
        println(greeting)
    }
}

abstract class MyWorkerTask
@Inject constructor(private var workerExecutor: WorkerExecutor) : DefaultTask() {
    @get:Input
    abstract val booleanFlag: Property&lt;Boolean&gt;
    @TaskAction
    fun doThings() {
        workerExecutor.noIsolation().submit(MyWorkAction::class.java) {}
    }
}

tasks.register("myWorkTask", MyWorkerTask::class) {}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyWorkAction implements WorkAction&lt;WorkParameters.None&gt; {
    private final String greeting;

    @Inject
    public MyWorkAction() {
        this.greeting = "Hello from a Worker!";
    }

    @Override
    public void execute() {
        System.out.println(greeting);
    }
}

abstract class MyWorkerTask extends DefaultTask {
    @Input
    abstract Property&lt;Boolean&gt; getBooleanFlag()

    @Inject
    abstract WorkerExecutor getWorkerExecutor()

    @TaskAction
    void doThings() {
        workerExecutor.noIsolation().submit(MyWorkAction) {}
    }
}

tasks.register("myWorkTask", MyWorkerTask) {}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#worker_api">the worker API</a> for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="filesystemoperations"><a class="anchor" href="#filesystemoperations"></a><a class="link" href="#filesystemoperations"><code>FileSystemOperations</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html"><code>FileSystemOperations</code></a> is a service that provides methods for performing file system operations such as copying, deleting, and syncing.
It is part of the <code>org.gradle.api.file</code> package and is typically used in custom tasks or plugins to interact with the file system.</p>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyFileSystemOperationsTask
@Inject constructor(private var fileSystemOperations: FileSystemOperations) : DefaultTask() {

    @TaskAction
    fun doTaskAction() {
        fileSystemOperations.sync {
            from("src")
            into("dest")
        }
    }
}

tasks.register("myInjectedFileSystemOperationsTask", MyFileSystemOperationsTask::class)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyFileSystemOperationsTask extends DefaultTask {
    private FileSystemOperations fileSystemOperations

    @Inject //@javax.inject.Inject
    MyFileSystemOperationsTask(FileSystemOperations fileSystemOperations) {
        this.fileSystemOperations = fileSystemOperations
    }

    @TaskAction
    void doTaskAction() {
        fileSystemOperations.sync {
            from 'src'
            into 'dest'
        }
    }
}

tasks.register("myInjectedFileSystemOperationsTask", MyFileSystemOperationsTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>FileSystemOperations</code> service is injected into the <code>MyFileSystemOperationsTask</code> task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>With some ceremony, it is possible to use <code>FileSystemOperations</code> in an ad-hoc task defined in a build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface InjectedFsOps {
    @get:Inject val fs: FileSystemOperations
}

tasks.register("myAdHocFileSystemOperationsTask") {
    val injected = project.objects.newInstance&lt;InjectedFsOps&gt;()
    doLast {
        injected.fs.copy {
            from("src")
            into("dest")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface InjectedFsOps {
    @Inject //@javax.inject.Inject
    FileSystemOperations getFs()
}

tasks.register('myAdHocFileSystemOperationsTask') {
    def injected = project.objects.newInstance(InjectedFsOps)
    doLast {
        injected.fs.copy {
            from 'source'
            into 'destination'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>First, you need to declare an interface with a property of type <code>FileSystemOperations</code>, here named <code>InjectedFsOps</code>, to serve as an injection point.
Then call the method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#newInstance(java.lang.Class,java.lang.Object%2E%2E%2E)"><code>ObjectFactory.newInstance</code></a> to generate an implementation of the interface that holds an injected service.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This is a good time to consider extracting the ad-hoc task into a proper class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="archiveoperations"><a class="anchor" href="#archiveoperations"></a><a class="link" href="#archiveoperations"><code>ArchiveOperations</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ArchiveOperations.html"><code>ArchiveOperations</code></a> is a service that provides methods for accessing the contents of archives, such as ZIP and TAR files.
It is part of the <code>org.gradle.api.file</code> package and is typically used in custom tasks or plugins to unpack archive files.</p>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyArchiveOperationsTask
@Inject constructor(
    private val archiveOperations: ArchiveOperations,
    private val layout: ProjectLayout,
    private val fs: FileSystemOperations
) : DefaultTask() {
    @TaskAction
    fun doTaskAction() {
        fs.sync {
            from(archiveOperations.zipTree(layout.projectDirectory.file("sources.jar")))
            into(layout.buildDirectory.dir("unpacked-sources"))
        }
    }
}

tasks.register("myInjectedArchiveOperationsTask", MyArchiveOperationsTask::class)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyArchiveOperationsTask extends DefaultTask {
    private ArchiveOperations archiveOperations
    private ProjectLayout layout
    private FileSystemOperations fs

    @Inject
    MyArchiveOperationsTask(ArchiveOperations archiveOperations, ProjectLayout layout, FileSystemOperations fs) {
        this.archiveOperations = archiveOperations
        this.layout = layout
        this.fs = fs
    }

    @TaskAction
    void doTaskAction() {
        fs.sync {
            from(archiveOperations.zipTree(layout.projectDirectory.file("sources.jar")))
            into(layout.buildDirectory.dir("unpacked-sources"))
        }
    }
}

tasks.register("myInjectedArchiveOperationsTask", MyArchiveOperationsTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ArchiveOperations</code> service is injected into the <code>MyArchiveOperationsTask</code> task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>With some ceremony, it is possible to use <code>ArchiveOperations</code> in an ad-hoc task defined in a build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface InjectedArcOps {
    @get:Inject val arcOps: ArchiveOperations
}

tasks.register("myAdHocArchiveOperationsTask") {
    val injected = project.objects.newInstance&lt;InjectedArcOps&gt;()
    val archiveFile = "${project.projectDir}/sources.jar"
    doLast {
        injected.arcOps.zipTree(archiveFile)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface InjectedArcOps {
    @Inject //@javax.inject.Inject
    ArchiveOperations getArcOps()
}

tasks.register('myAdHocArchiveOperationsTask') {
    def injected = project.objects.newInstance(InjectedArcOps)
    def archiveFile = "${projectDir}/sources.jar"

    doLast {
        injected.arcOps.zipTree(archiveFile)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>First, you need to declare an interface with a property of type <code>ArchiveOperations</code>, here named <code>InjectedArcOps</code>, to serve as an injection point.
Then call the method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#newInstance(java.lang.Class,java.lang.Object%2E%2E%2E)"><code>ObjectFactory.newInstance</code></a> to generate an implementation of the interface that holds an injected service.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This is a good time to consider extracting the ad-hoc task into a proper class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="execoperations"><a class="anchor" href="#execoperations"></a><a class="link" href="#execoperations"><code>ExecOperations</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/ExecOperations.html"><code>ExecOperations</code></a> is a service that provides methods for executing external processes (commands) from within a build script.
It is part of the <code>org.gradle.process</code> package and is typically used in custom tasks or plugins to run command-line tools or scripts as part of the build process.</p>
</div>
<div class="paragraph">
<p>Here is an example using <code>javax.inject.Inject</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyExecOperationsTask
@Inject constructor(private var execOperations: ExecOperations) : DefaultTask() {

    @TaskAction
    fun doTaskAction() {
        execOperations.exec {
            commandLine("ls", "-la")
        }
    }
}

tasks.register("myInjectedExecOperationsTask", MyExecOperationsTask::class)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyExecOperationsTask extends DefaultTask {
    private ExecOperations execOperations

    @Inject //@javax.inject.Inject
    MyExecOperationsTask(ExecOperations execOperations) {
        this.execOperations = execOperations
    }

    @TaskAction
    void doTaskAction() {
        execOperations.exec {
            commandLine 'ls', '-la'
        }
    }
}

tasks.register("myInjectedExecOperationsTask", MyExecOperationsTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ExecOperations</code> is injected into the <code>MyExecOperationsTask</code> task&#8217;s constructor using the <code>@Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>With some ceremony, it is possible to use <code>ExecOperations</code> in an ad-hoc task defined in a build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface InjectedExecOps {
    @get:Inject val execOps: ExecOperations
}

tasks.register("myAdHocExecOperationsTask") {
    val injected = project.objects.newInstance&lt;InjectedExecOps&gt;()

    doLast {
        injected.execOps.exec {
            commandLine("ls", "-la")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface InjectedExecOps {
    @Inject //@javax.inject.Inject
    ExecOperations getExecOps()
}

tasks.register('myAdHocExecOperationsTask') {
    def injected = project.objects.newInstance(InjectedExecOps)

    doLast {
        injected.execOps.exec {
            commandLine 'ls', '-la'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>First, you need to declare an interface with a property of type <code>ExecOperations</code>, here named <code>InjectedExecOps</code>, to serve as an injection point.
Then call the method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#newInstance(java.lang.Class,java.lang.Object%2E%2E%2E)"><code>ObjectFactory.newInstance</code></a> to generate an implementation of the interface that holds an injected service.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This is a good time to consider extracting the ad-hoc task into a proper class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="toolingmodelbuilderregistry"><a class="anchor" href="#toolingmodelbuilderregistry"></a><a class="link" href="#toolingmodelbuilderregistry"><code>ToolingModelBuilderRegistry</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/provider/model/ToolingModelBuilderRegistry.html"><code>ToolingModelBuilderRegistry</code></a> is a service that allows you to register custom tooling model builders.
Tooling models are used to provide rich IDE integration for Gradle projects, allowing IDEs to understand and work with the project&#8217;s structure, dependencies, and other aspects.</p>
</div>
<div class="paragraph">
<p>The <code>ToolingModelBuilderRegistry</code> interface is part of the <code>org.gradle.tooling.provider.model</code> package and is typically used in custom Gradle plugins that provide enhanced IDE support.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simplified example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Implements the ToolingModelBuilder interface.
// This interface is used in Gradle to define custom tooling models that can
// be accessed by IDEs or other tools through the Gradle tooling API.
class OrtModelBuilder : ToolingModelBuilder {
    private val repositories: MutableMap&lt;String, String&gt; = mutableMapOf()

    private val platformCategories: Set&lt;String&gt; = setOf("platform", "enforced-platform")

    private val visitedDependencies: MutableSet&lt;ModuleComponentIdentifier&gt; = mutableSetOf()
    private val visitedProjects: MutableSet&lt;ModuleVersionIdentifier&gt; = mutableSetOf()

    private val logger = Logging.getLogger(OrtModelBuilder::class.java)
    private val errors: MutableList&lt;String&gt; = mutableListOf()
    private val warnings: MutableList&lt;String&gt; = mutableListOf()

    override fun canBuild(modelName: String): Boolean {
        return false
    }

    override fun buildAll(modelName: String, project: Project): Any {
        return "model"
    }
}

// Plugin is responsible for registering a custom tooling model builder
// (OrtModelBuilder) with the ToolingModelBuilderRegistry, which allows
// IDEs and other tools to access the custom tooling model.
class OrtModelPlugin(private val registry: ToolingModelBuilderRegistry) : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        registry.register(OrtModelBuilder())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Implements the ToolingModelBuilder interface.
// This interface is used in Gradle to define custom tooling models that can
// be accessed by IDEs or other tools through the Gradle tooling API.
class OrtModelBuilder implements ToolingModelBuilder {
    private Map&lt;String, String&gt; repositories = [:]

    private Set&lt;String&gt; platformCategories = ["platform", "enforced-platform"]

    private Set&lt;ModuleComponentIdentifier&gt; visitedDependencies = []
    private Set&lt;ModuleVersionIdentifier&gt; visitedProjects = []

    private static final logger = Logging.getLogger(OrtModelBuilder.class)
    private List&lt;String&gt; errors = []
    private List&lt;String&gt; warnings = []

    @Override
    boolean canBuild(String modelName) {
        return false
    }

    @Override
    Object buildAll(String modelName, Project project) {
        return null
    }
}

// Plugin is responsible for registering a custom tooling model builder
// (OrtModelBuilder) with the ToolingModelBuilderRegistry, which allows
// IDEs and other tools to access the custom tooling model.
class OrtModelPlugin implements Plugin&lt;Project&gt; {
    ToolingModelBuilderRegistry registry

    OrtModelPlugin(ToolingModelBuilderRegistry registry) {
        this.registry = registry
    }

    void apply(Project project) {
        registry.register(new OrtModelBuilder())
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more at <a href="#tooling_api">Tooling API</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="testeventreporterfactory"><a class="anchor" href="#testeventreporterfactory"></a><a class="link" href="#testeventreporterfactory"><code>TestEventReporterFactory</code></a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This API is incubating.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/TestEventReporterFactory.html"><code>TestEventReporterFactory</code></a> is a service that provides access to the test event reporting API.</p>
</div>
<div class="paragraph">
<p>You can learn more at <a href="#test_reporting_api">Test Reporting API</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="dependencyfactory"><a class="anchor" href="#dependencyfactory"></a><a class="link" href="#dependencyfactory"><code>DependencyFactory</code></a></h4>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/DependencyFactory.html"><code>DependencyFactory</code></a> is a service that provides methods for creating dependencies in a type-safe way.</p>
</div>
<div class="paragraph">
<p>You can learn more in the <a href="#sec:differences_with_top_level_dependencies">Implementing Binary Plugins guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="service_injection_patterns"><a class="anchor" href="#service_injection_patterns"></a><a class="link" href="#service_injection_patterns">Service injection patterns</a></h4>
<div class="paragraph">
<p>There are two ways that services can be provided to an object.</p>
</div>
<div class="sect4">
<h5 id="constructor_injection"><a class="anchor" href="#constructor_injection"></a><a class="link" href="#constructor_injection">Constructor injection</a></h5>
<div class="paragraph">
<p>A service can be injected into the constructor of the class. The constructor must be public and annotated with the <code>javax.inject.Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>Gradle uses the declared type of each constructor parameter to determine the services that the object requires.
The order of the constructor parameters and their names are not significant and can be whatever you like.</p>
</div>
<div class="paragraph">
<p>Here is an example that shows a task type that receives an <code>WorkerExecutor</code> via its constructor:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Download extends DefaultTask {
    private final WorkerExecutor workerExecutor;

    // Inject an WorkerExecutor into the constructor
    @Inject
    public Download(WorkerExecutor workerExecutor) {
        this.workerExecutor = workerExecutor;
    }

    @TaskAction
    void run() {
        // ...use workerExecutor to run some work
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="property_injection"><a class="anchor" href="#property_injection"></a><a class="link" href="#property_injection">Property injection</a></h5>
<div class="paragraph">
<p>A service can be injected by adding a property getter method annotated with the <code>javax.inject.Inject</code> annotation to the class.</p>
</div>
<div class="paragraph">
<p>Gradle defers the creation of the service until the getter method is called. This can be more performant than constructor injection.</p>
</div>
<div class="paragraph">
<p>The property getter method must be <code>public</code> or <code>protected</code>. Gradle uses the declared return type of the getter method to determine the service to make available.</p>
</div>
<div class="paragraph">
<p>The method should be <code>abstract</code> or, in cases where this isn&#8217;t possible, should have a dummy method body.
The method body is discarded. The name of the property is not significant and can be whatever you like.</p>
</div>
<div class="paragraph">
<p>Here is an example that shows a task type that receives two services via property getter methods:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class Download extends DefaultTask {
    // Preferrably, use an abstract getter method
    @Inject
    protected abstract ObjectFactory getObjectFactory();

    // Alternatively, use a getter method with a dummy implementation
    @Inject
    protected WorkerExecutor getWorkerExecutor() {
        // Method body is ignored
        throw new UnsupportedOperationException();
    }

    @TaskAction
    void run() {
        WorkerExecutor workerExecutor = getWorkerExecutor();
        ObjectFactory objectFactory = getObjectFactory();
        // Use the executor and factory ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working_with_files"><a class="anchor" href="#working_with_files"></a><a class="link" href="#working_with_files">Working With Files</a></h3>
<div class="paragraph">
<p>File operations are fundamental to nearly every Gradle build.
They involve handling source files, managing file dependencies, and generating reports.
Gradle provides a robust API that simplifies these operations, enabling developers to perform necessary file tasks easily.</p>
</div>
<div class="sect3">
<h4 id="sec:hard_coded_file_paths"><a class="anchor" href="#sec:hard_coded_file_paths"></a><a class="link" href="#sec:hard_coded_file_paths">Hardcoded paths and laziness</a></h4>
<div class="paragraph">
<p>It is best practice to <strong>avoid</strong> hardcoded paths in build scripts.</p>
</div>
<div class="paragraph">
<p>In addition to avoiding hardcoded paths, Gradle encourages laziness in its build scripts.
This means that tasks and operations should be deferred until they are actually needed rather than executed eagerly.</p>
</div>
<div class="paragraph">
<p>Many examples in this chapter use hard-coded paths as string literals.
This makes them easy to understand, but it is not good practice.
The problem is that paths often change, and the more places you need to change them, the more likely you will miss one and break the build.</p>
</div>
<div class="paragraph">
<p>Where possible, you should use tasks, task properties, and <a href="#understanding_properties">project properties</a>  in that order of preference  to configure file paths.</p>
</div>
<div class="paragraph">
<p>For example, if you create a task that packages the compiled classes of a Java application,  you should use an implementation similar to this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val archivesDirPath = layout.buildDirectory.dir("archives")

tasks.register&lt;Zip&gt;("packageClasses") {
    archiveAppendix = "classes"
    destinationDirectory = archivesDirPath

    from(tasks.compileJava)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def archivesDirPath = layout.buildDirectory.dir('archives')

tasks.register('packageClasses', Zip) {
    archiveAppendix = "classes"
    destinationDirectory = archivesDirPath

    from compileJava
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>compileJava</code> task is the source of the files to package, and the project property <code>archivesDirPath</code> stores the location of the archives, as we are likely to use it elsewhere in the build.</p>
</div>
<div class="paragraph">
<p>Using a task directly as an argument like this relies on it having <a href="incremental_build.html#sec:task_inputs_outputs">defined outputs</a>, so it won&#8217;t always be possible.
This example could be further improved by relying on the Java plugin&#8217;s convention for <code>destinationDirectory</code> rather than overriding it, but it does demonstrate the use of project properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:locating_files"><a class="anchor" href="#sec:locating_files"></a><a class="link" href="#sec:locating_files">Locating files</a></h4>
<div class="paragraph">
<p>To perform some action on a file, you need to know where it is, and that&#8217;s the information provided by file paths.
Gradle builds on the standard Java <code><a href="https://docs.oracle.com/javase/8/docs/api//java/io/File.html">File</a></code> class, which represents the location of a single file and provides APIs for dealing with collections of paths.</p>
</div>
<div class="sect4">
<h5 id="using_projectlayout"><a class="anchor" href="#using_projectlayout"></a><a class="link" href="#using_projectlayout">Using <code>ProjectLayout</code></a></h5>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.ProjectLayout.html"><code>ProjectLayout</code></a> class is used to access various directories and files within a project.
It provides methods to retrieve paths to the project directory, build directory, settings file, and other important locations within the project&#8217;s file structure.
This class is particularly useful when you need to work with files in a build script or plugin in different project paths:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val archivesDirPath = layout.buildDirectory.dir("archives")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def archivesDirPath = layout.buildDirectory.dir('archives')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more about the <code>ProjectLayout</code> class in <a href="#sec:projectlayout">Services</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:single_file_paths"><a class="anchor" href="#sec:single_file_paths"></a><a class="link" href="#sec:single_file_paths">Using <code>Project.file()</code></a></h5>
<div class="paragraph">
<p>Gradle provides the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method for specifying the location of a single file or directory.</p>
</div>
<div class="paragraph">
<p>Relative paths are resolved relative to the project directory, while absolute paths remain unchanged.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Never use <code>new File(relative path)</code> unless passed to <code>file()</code> or <code>files()</code> or <code>from()</code> or other methods defined in terms of <code>file()</code> or <code>files()</code>.
Otherwise, this creates a path relative to the current working directory (CWD).
Gradle can make no guarantees about the location of the CWD, which means builds that rely on it may break at any time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are some examples of using the <code>file()</code> method with different types of arguments:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Using a relative path
var configFile = file("src/config.xml")

// Using an absolute path
configFile = file(configFile.absolutePath)

// Using a File object with a relative path
configFile = file(File("src/config.xml"))

// Using a java.nio.file.Path object with a relative path
configFile = file(Paths.get("src", "config.xml"))

// Using an absolute java.nio.file.Path object
configFile = file(Paths.get(System.getProperty("user.home")).resolve("global-config.xml"))</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Using a relative path
File configFile = file('src/config.xml')

// Using an absolute path
configFile = file(configFile.absolutePath)

// Using a File object with a relative path
configFile = file(new File('src/config.xml'))

// Using a java.nio.file.Path object with a relative path
configFile = file(Paths.get('src', 'config.xml'))

// Using an absolute java.nio.file.Path object
configFile = file(Paths.get(System.getProperty('user.home')).resolve('global-config.xml'))</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see, you can pass strings, <code>File</code> instances and <code><a href="https://docs.oracle.com/javase/8/docs/api//java/nio/file/Path.html">Path</a></code> instances to the <code>file()</code> method, all of which result in an absolute <code>File</code> object.</p>
</div>
<div class="paragraph">
<p>In the case of multi-project builds, the <code>file()</code> method will always turn relative paths into paths relative to the current project directory, which may be a child project.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_projectlayout_settingsdirectory"><a class="anchor" href="#using_projectlayout_settingsdirectory"></a><a class="link" href="#using_projectlayout_settingsdirectory">Using <code>ProjectLayout.settingsDirectory()</code></a></h5>
<div class="paragraph">
<p>To use a path relative to the <em>settings</em> directory, access the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:layout"><code>Project.layout</code></a>, retrieve the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.ProjectLayout.html#org.gradle.api.file.ProjectLayout:settingsDirectory"><code>settingsDirectory</code></a> from it, and construct an absolute path.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val configFile = layout.settingsDirectory.file("shared/config.xml").asFile</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">File configFile = layout.settingsDirectory.file("shared/config.xml").asFile</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;re working on a multi-project build in the directory: <code>dev/projects/AcmeHealth</code>.
The build script above is at: <code>AcmeHealth/subprojects/AcmePatientRecordLib/build.gradle</code>.
The absolute file path will resolve to: <code>dev/projects/AcmeHealth/shared/config.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">dev
 projects
    AcmeHealth
       subprojects
          AcmePatientRecordLib
             build.gradle
          ...
       shared
          config.xml
       ...
    ...
 settings.gradle</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>Project</code> also provides <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:rootProject">Project.getRootProject()</a> for multi-project builds which, in the example, would resolve to: <code>dev/projects/AcmeHealth/subprojects/AcmePatientRecordLib</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:file_collections"><a class="anchor" href="#sec:file_collections"></a><a class="link" href="#sec:file_collections">Using <code>FileCollection</code></a></h5>
<div class="paragraph">
<p>A <em>file collection</em> is simply a set of file paths represented by the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a> interface.</p>
</div>
<div class="paragraph">
<p>The set of paths can be <em>any</em> file path.
The file paths don&#8217;t have to be related in any way, so they don&#8217;t have to be in the same directory or have a shared parent directory.</p>
</div>
<div class="paragraph">
<p>The recommended way to specify a collection of files is to use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object...)</a> method, which returns a <code>FileCollection</code> instance.
This flexible method allows you to pass multiple strings, <code>File</code> instances, collections of strings, collections of <code>File</code>s, and more.
You can also pass in tasks as arguments if they have <a href="incremental_build.html#sec:task_inputs_outputs">defined outputs</a>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<code>files()</code> properly handles relative paths and <code>File(relative path)</code> instances, resolving them relative to the project directory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As with the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method covered in the <a href="#sec:single_file_paths">previous section</a>, all relative paths are evaluated relative to the current project directory.
The following example demonstrates some of the variety of argument types you can use  strings, <code>File</code> instances, lists, or  <code><a href="https://docs.oracle.com/javase/8/docs/api//java/nio/file/Path.html">Path</a>s</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val collection: FileCollection = layout.files(
    "src/file1.txt",
    File("src/file2.txt"),
    listOf("src/file3.csv", "src/file4.csv"),
    Paths.get("src", "file5.txt")
)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">FileCollection collection = layout.files('src/file1.txt',
                                  new File('src/file2.txt'),
                                  ['src/file3.csv', 'src/file4.csv'],
                                  Paths.get('src', 'file5.txt'))</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>File collections have important attributes in Gradle.
They can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>created lazily</p>
</li>
<li>
<p>iterated over</p>
</li>
<li>
<p>filtered</p>
</li>
<li>
<p>combined</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Lazy creation</em> of a file collection is useful when evaluating the files that make up a collection when a build runs.
In the following example, we query the file system to find out what files exist in a particular directory and then make those into a file collection:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("list") {
    val projectDirectory = layout.projectDirectory
    doLast {
        var srcDir: File? = null

        val collection = projectDirectory.files({
            srcDir?.listFiles()
        })

        srcDir = projectDirectory.file("src").asFile
        println("Contents of ${srcDir.name}")
        collection.map { it.relativeTo(projectDirectory.asFile) }.sorted().forEach { println(it) }

        srcDir = projectDirectory.file("src2").asFile
        println("Contents of ${srcDir.name}")
        collection.map { it.relativeTo(projectDirectory.asFile) }.sorted().forEach { println(it) }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('list') {
    Directory projectDirectory = layout.projectDirectory
    doLast {
        File srcDir

        // Create a file collection using a closure
        collection = projectDirectory.files { srcDir.listFiles() }

        srcDir = projectDirectory.file('src').asFile
        println "Contents of $srcDir.name"
        collection.collect { projectDirectory.asFile.relativePath(it) }.sort().each { println it }

        srcDir = projectDirectory.file('src2').asFile
        println "Contents of $srcDir.name"
        collection.collect { projectDirectory.asFile.relativePath(it) }.sort().each { println it }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q list
Contents of src
src/dir1
src/file1.txt
Contents of src2
src2/dir1
src2/dir2</pre>
</div>
</div>
<div class="paragraph">
<p>The key to lazy creation is passing a closure (in Groovy) or a <code>Provider</code> (in Kotlin) to the <code>files()</code> method.
Your closure or provider must return a value of a type accepted by <code>files()</code>, such as <code>List&lt;File&gt;</code>, <code>String</code>, or <code>FileCollection</code>.</p>
</div>
<div class="paragraph">
<p><em>Iterating over a file collection</em> can be done through the <code>each()</code> method (in Groovy) or <code>forEach</code> method (in Kotlin) on the collection or using the collection in a <code>for</code> loop.
In both approaches, the file collection is treated as a set of <code>File</code> instances, i.e., your iteration variable will be of type <code>File</code>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates such iteration.
It also demonstrates how you can convert file collections to other types using the <code>as</code> operator (or supported properties):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Iterate over the files in the collection
collection.forEach { file: File -&gt;
    println(file.name)
}

// Convert the collection to various types
val set: Set&lt;File&gt; = collection.files
val list: List&lt;File&gt; = collection.toList()
val path: String = collection.asPath
val file: File = collection.singleFile

// Add and subtract collections
val union = collection + projectLayout.files("src/file2.txt")
val difference = collection - projectLayout.files("src/file2.txt")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Iterate over the files in the collection
collection.each { File file -&gt;
    println file.name
}

// Convert the collection to various types
Set set = collection.files
Set set2 = collection as Set
List list = collection as List
String path = collection.asPath
File file = collection.singleFile

// Add and subtract collections
def union = collection + projectLayout.files('src/file2.txt')
def difference = collection - projectLayout.files('src/file2.txt')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also see at the end of the example <em>how to combine file collections</em> using the <code>+</code> and <code>-</code> operators to merge and subtract them.
An important feature of the resulting file collections is that they are <em>live</em>.
In other words, when you combine file collections this way, the result always reflects what&#8217;s currently in the source file collections, even if they change during the build.</p>
</div>
<div class="paragraph">
<p>For example, imagine <code>collection</code> in the above example gains an extra file or two after <code>union</code> is created.
As long as you use <code>union</code> after those files are added to <code>collection</code>, <code>union</code> will also contain those additional files.
The same goes for the <code>different</code> file collection.</p>
</div>
<div class="paragraph">
<p>Live collections are also important when it comes to <em>filtering</em>.
Suppose you want to use a subset of a file collection.
In that case, you can take advantage of the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html#filter-org.gradle.api.specs.Spec-">FileCollection.filter(org.gradle.api.specs.Spec)</a> method to determine which files to "keep".
In the following example, we create a new collection that consists of only the files that end with <code>.txt</code> in the source collection:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val textFiles: FileCollection = collection.filter { f: File -&gt;
    f.name.endsWith(".txt")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">FileCollection textFiles = collection.filter { File f -&gt;
    f.name.endsWith(".txt")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q filterTextFiles
src/file1.txt
src/file2.txt
src/file5.txt</pre>
</div>
</div>
<div class="paragraph">
<p>If <code>collection</code> changes at any time, either by adding or removing files from itself, then <code>textFiles</code> will immediately reflect the change because it is also a live collection.
Note that the closure you pass to <code>filter()</code> takes a <code>File</code> as an argument and should return a boolean.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:specifying_multiple_files"><a class="anchor" href="#sec:specifying_multiple_files"></a><a class="link" href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a></h5>
<div class="paragraph">
<p>Many objects in Gradle have properties which accept a set of input files.
For example, the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a> task has a <code>source</code> property that defines the source files to compile.
You can set the value of this property using any of the types supported by the <a href="#sec:file_collections">files()</a> method, as mentioned in the API docs.
This means you can, for example, set the property to a <code>File</code>, <code>String</code>, collection, <code>FileCollection</code> or even a closure or <code>Provider</code>.</p>
</div>
<div class="paragraph">
<p><strong>This is a feature of specific tasks</strong>!
That means implicit conversion will not happen for just any task that has a <code>FileCollection</code> or <code>FileTree</code> property.
If you want to know whether implicit conversion happens in a particular situation, you will need to read the relevant documentation, such as the corresponding task&#8217;s API docs.
Alternatively, you can remove all doubt by explicitly using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object...)</a> in your build.</p>
</div>
<div class="paragraph">
<p>Here are some examples of the different types of arguments that the <code>source</code> property can take:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;JavaCompile&gt;("compile") {
    // Use a File object to specify the source directory
    source = fileTree(file("src/main/java"))

    // Use a String path to specify the source directory
    source = fileTree("src/main/java")

    // Use a collection to specify multiple source directories
    source = fileTree(listOf("src/main/java", "../shared/java"))

    // Use a FileCollection (or FileTree in this case) to specify the source files
    source = fileTree("src/main/java").matching { include("org/gradle/api/**") }

    // Using a closure to specify the source files.
    setSource({
        // Use the contents of each zip file in the src dir
        file("src").listFiles().filter { it.name.endsWith(".zip") }.map { zipTree(it) }
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('compile', JavaCompile) {

    // Use a File object to specify the source directory
    source = file('src/main/java')

    // Use a String path to specify the source directory
    source = 'src/main/java'

    // Use a collection to specify multiple source directories
    source = ['src/main/java', '../shared/java']

    // Use a FileCollection (or FileTree in this case) to specify the source files
    source = fileTree(dir: 'src/main/java').matching { include 'org/gradle/api/**' }

    // Using a closure to specify the source files.
    source = {
        // Use the contents of each zip file in the src dir
        file('src').listFiles().findAll {it.name.endsWith('.zip')}.collect { zipTree(it) }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>One other thing to note is that properties like <code>source</code> have corresponding methods in core Gradle tasks.
Those methods follow the convention of <em>appending</em> to collections of values rather than replacing them.
Again, this method accepts any of the types supported by the <a href="#sec:file_collections">files()</a> method, as shown here:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;JavaCompile&gt;("compile") {
    // Add some source directories use String paths
    source("src/main/java", "src/main/groovy")

    // Add a source directory using a File object
    source(file("../shared/java"))

    // Add some source directories using a closure
    setSource({ file("src/test/").listFiles() })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">compile {
    // Add some source directories use String paths
    source 'src/main/java', 'src/main/groovy'

    // Add a source directory using a File object
    source file('../shared/java')

    // Add some source directories using a closure
    source { file('src/test/').listFiles() }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As this is a common convention, we recommend that you follow it in your own custom tasks.
Specifically, if you plan to add a method to configure a collection-based property, make sure the method appends rather than replaces values.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:file_trees"><a class="anchor" href="#sec:file_trees"></a><a class="link" href="#sec:file_trees">Using <code>FileTree</code></a></h5>
<div class="paragraph">
<p>A <em>file tree</em> is a file collection that retains the directory structure of the files it contains and has the type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html">FileTree</a>.
This means all the paths in a file tree must have a shared parent directory.
The following diagram highlights the distinction between file trees and file collections in the typical case of copying files:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/file-collection-vs-file-tree.png" alt="file collection vs file tree">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although <code>FileTree</code> extends <code>FileCollection</code> (an is-a relationship), their behaviors differ.
In other words, you can use a file tree wherever a file collection is required, but remember that a file collection is a flat list/set of files, while a file tree is a file and directory hierarchy.
To convert a file tree to a flat collection, use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html#getFiles--">FileTree.getFiles()</a> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The simplest way to create a file tree is to pass a file or directory path to the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a> method.
This will create a tree of all the files and directories in that base directory (but not the base directory itself).
The following example demonstrates how to use this method and how to filter the files and directories using Ant-style patterns:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create a file tree with a base directory
var tree: ConfigurableFileTree = fileTree("src/main")

// Add include and exclude patterns to the tree
tree.include("**/*.java")
tree.exclude("**/Abstract*")

// Create a tree using closure
tree = fileTree("src") {
    include("**/*.java")
}

// Create a tree using a map
tree = fileTree("dir" to "src", "include" to "**/*.java")
tree = fileTree("dir" to "src", "includes" to listOf("**/*.java", "**/*.xml"))
tree = fileTree("dir" to "src", "include" to "**/*.java", "exclude" to "**/*test*/**")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create a file tree with a base directory
ConfigurableFileTree tree = fileTree(dir: 'src/main')

// Add include and exclude patterns to the tree
tree.include '**/*.java'
tree.exclude '**/Abstract*'

// Create a tree using closure
tree = fileTree('src') {
    include '**/*.java'
}

// Create a tree using a map
tree = fileTree(dir: 'src', include: '**/*.java')
tree = fileTree(dir: 'src', includes: ['**/*.java', '**/*.xml'])
tree = fileTree(dir: 'src', include: '**/*.java', exclude: '**/*test*/**')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can see more examples of supported patterns in the API docs for <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/util/PatternFilterable.html">PatternFilterable</a>.</p>
</div>
<div class="paragraph">
<p>By default, <code>fileTree()</code> returns a <code>FileTree</code> instance that applies some default exclude patterns for convenience  the same defaults as Ant.
For the complete default exclude list, see <a href="http://ant.apache.org/manual/dirtasks.html#defaultexcludes">the Ant manual</a>.</p>
</div>
<div id="sec:change_default_excludes" class="paragraph">
<p>If those default excludes prove problematic, you can work around the issue by changing the default excludes in the settings script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.apache.tools.ant.DirectoryScanner

DirectoryScanner.removeDefaultExclude("**/.git")
DirectoryScanner.removeDefaultExclude("**/.git/**")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.apache.tools.ant.DirectoryScanner

DirectoryScanner.removeDefaultExclude('**/.git')
DirectoryScanner.removeDefaultExclude('**/.git/**')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Gradle does not support changing default excludes during the execution phase.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can do many of the same things with file trees that you can with file collections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>iterate over them (depth first)</p>
</li>
<li>
<p>filter them (using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html#matching-org.gradle.api.Action-">FileTree.matching(org.gradle.api.Action)</a> and Ant-style patterns)</p>
</li>
<li>
<p>merge them</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also traverse file trees using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html#visit-org.gradle.api.Action-">FileTree.visit(org.gradle.api.Action)</a> method.
All of these techniques are demonstrated in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Iterate over the contents of a tree
tree.forEach{ file: File -&gt;
    println(file)
}

// Filter a tree
val filtered: FileTree = tree.matching {
    include("org/gradle/api/**")
}

// Add trees together
val sum: FileTree = tree + fileTree("src/test")

// Visit the elements of the tree
tree.visit {
    println("${this.relativePath} =&gt; ${this.file}")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Iterate over the contents of a tree
tree.each {File file -&gt;
    println file
}

// Filter a tree
FileTree filtered = tree.matching {
    include 'org/gradle/api/**'
}

// Add trees together
FileTree sum = tree + fileTree(dir: 'src/test')

// Visit the elements of the tree
tree.visit {element -&gt;
    println "$element.relativePath =&gt; $element.file"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="copying_files"><a class="anchor" href="#copying_files"></a><a class="link" href="#copying_files">Copying files</a></h4>
<div class="paragraph">
<p>Copying files in Gradle primarily uses <code>CopySpec</code>, a mechanism that makes it easy to manage resources such as source code, configuration files, and other assets in your project build process.</p>
</div>
<div class="sect4">
<h5 id="sec:using_the_copyspec_class"><a class="anchor" href="#sec:using_the_copyspec_class"></a><a class="link" href="#sec:using_the_copyspec_class">Understanding <code>CopySpec</code></a></h5>
<div class="paragraph">
<p><code>CopySpec</code> is a copy specification that allows you to define what files to copy, where to copy them from, and where to copy them.
It provides a flexible and expressive way to specify complex file copying operations, including filtering files based on patterns, renaming files, and including/excluding files based on various criteria.</p>
</div>
<div class="paragraph">
<p><code>CopySpec</code> instances are used in the <code>Copy</code> task to specify the files and directories to be copied.</p>
</div>
<div class="paragraph">
<p><code>CopySpec</code> has two important attributes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It is independent of tasks, allowing you to <em>share copy specs within a build</em>.</p>
</li>
<li>
<p>It is hierarchical, providing <em>fine-grained control</em> within the overall copy specification.</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="sub:sharing_copy_specs"><a class="anchor" href="#sub:sharing_copy_specs"></a><a class="link" href="#sub:sharing_copy_specs">1. Sharing copy specs</a></h6>
<div class="paragraph">
<p>Consider a build with several tasks that copy a project&#8217;s static website resources or add them to an archive.
One task might copy the resources to a folder for a local HTTP server, and another might package them into a distribution.
You could manually specify the file locations and appropriate inclusions each time they are needed, but human error is more likely to creep in, resulting in inconsistencies between tasks.</p>
</div>
<div class="paragraph">
<p>One solution is the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:copySpec(org.gradle.api.Action)">Project.copySpec(org.gradle.api.Action)</a> method.
This allows you to create a copy spec outside a task, which can then be attached to an appropriate task using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#with-org.gradle.api.file.CopySpec...-">CopySpec.with(org.gradle.api.file.CopySpec&#8230;&#8203;)</a> method.
The following example demonstrates how this is done:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val webAssetsSpec: CopySpec = copySpec {
    from("src/main/webapp")
    include("**/*.html", "**/*.png", "**/*.jpg")
    rename("(.+)-staging(.+)", "$1$2")
}

tasks.register&lt;Copy&gt;("copyAssets") {
    into(layout.buildDirectory.dir("inPlaceApp"))
    with(webAssetsSpec)
}

tasks.register&lt;Zip&gt;("distApp") {
    archiveFileName = "my-app-dist.zip"
    destinationDirectory = layout.buildDirectory.dir("dists")

    from(appClasses)
    with(webAssetsSpec)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">CopySpec webAssetsSpec = copySpec {
    from 'src/main/webapp'
    include '**/*.html', '**/*.png', '**/*.jpg'
    rename '(.+)-staging(.+)', '$1$2'
}

tasks.register('copyAssets', Copy) {
    into layout.buildDirectory.dir("inPlaceApp")
    with webAssetsSpec
}

tasks.register('distApp', Zip) {
    archiveFileName = 'my-app-dist.zip'
    destinationDirectory = layout.buildDirectory.dir('dists')

    from appClasses
    with webAssetsSpec
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Both the <code>copyAssets</code> and <code>distApp</code> tasks will process the static resources under <code>src/main/webapp</code>, as specified by <code>webAssetsSpec</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The configuration defined by <code>webAssetsSpec</code> will <em>not</em> apply to the app classes included by the <code>distApp</code> task.
That&#8217;s because <code>from appClasses</code> is its own child specification independent of <code>with webAssetsSpec</code>.</p>
</div>
<div class="paragraph">
<p>This can be confusing, so it&#8217;s probably best to treat <code>with()</code> as an extra <code>from()</code> specification in the task.
Hence, it doesn&#8217;t make sense to define a standalone copy spec without at least one <code>from()</code> defined.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Suppose you encounter a scenario in which you want to apply the same copy configuration to <em>different</em> sets of files.
In that case, you can share the configuration block directly without using <code>copySpec()</code>.
Here&#8217;s an example that has two independent tasks that happen to want to process image files only:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val webAssetPatterns = Action&lt;CopySpec&gt; {
    include("**/*.html", "**/*.png", "**/*.jpg")
}

tasks.register&lt;Copy&gt;("copyAppAssets") {
    into(layout.buildDirectory.dir("inPlaceApp"))
    from("src/main/webapp", webAssetPatterns)
}

tasks.register&lt;Zip&gt;("archiveDistAssets") {
    archiveFileName = "distribution-assets.zip"
    destinationDirectory = layout.buildDirectory.dir("dists")

    from("distResources", webAssetPatterns)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def webAssetPatterns = {
    include '**/*.html', '**/*.png', '**/*.jpg'
}

tasks.register('copyAppAssets', Copy) {
    into layout.buildDirectory.dir("inPlaceApp")
    from 'src/main/webapp', webAssetPatterns
}

tasks.register('archiveDistAssets', Zip) {
    archiveFileName = 'distribution-assets.zip'
    destinationDirectory = layout.buildDirectory.dir('dists')

    from 'distResources', webAssetPatterns
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, we assign the copy configuration to its own variable and apply it to whatever <code>from()</code> specification we want.
This doesn&#8217;t just work for inclusions but also exclusions, file renaming, and file content filtering.</p>
</div>
</div>
<div class="sect5">
<h6 id="sub:using_child_copy_specifications"><a class="anchor" href="#sub:using_child_copy_specifications"></a><a class="link" href="#sub:using_child_copy_specifications">2. Using child specifications</a></h6>
<div class="paragraph">
<p>If you only use a single copy spec, the file filtering and renaming will apply to <em>all</em> files copied.
Sometimes, this is what you want, but not always.
Consider the following example that copies files into a directory structure that a Java Servlet container can use to deliver a website:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/exploded-war-child-copy-spec-example.png" alt="exploded war child copy spec example">
</div>
</div>
<div class="paragraph">
<p>This is not a straightforward copy as the <code>WEB-INF</code> directory and its subdirectories don&#8217;t exist within the project, so they must be created during the copy.
In addition, we only want HTML and image files going directly into the root folder  <code>build/explodedWar</code>  and only JavaScript files going into the <code>js</code> directory.
We need separate filter patterns for those two sets of files.</p>
</div>
<div class="paragraph">
<p>The solution is to use <em>child specifications</em>, which can be applied to both <code>from()</code> and <code>into()</code> declarations.
The following task definition does the necessary work:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("nestedSpecs") {
    into(layout.buildDirectory.dir("explodedWar"))
    exclude("**/*staging*")
    from("src/dist") {
        include("**/*.html", "**/*.png", "**/*.jpg")
    }
    from(sourceSets.main.get().output) {
        into("WEB-INF/classes")
    }
    into("WEB-INF/lib") {
        from(configurations.runtimeClasspath)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('nestedSpecs', Copy) {
    into layout.buildDirectory.dir("explodedWar")
    exclude '**/*staging*'
    from('src/dist') {
        include '**/*.html', '**/*.png', '**/*.jpg'
    }
    from(sourceSets.main.output) {
        into 'WEB-INF/classes'
    }
    into('WEB-INF/lib') {
        from configurations.runtimeClasspath
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice how the <code>src/dist</code> configuration has a nested inclusion specification; it is the child copy spec.
You can, of course, add content filtering and renaming here as required.
A child copy spec is still a copy spec.</p>
</div>
<div class="paragraph">
<p>The above example also demonstrates how you can copy files into a subdirectory of the destination either by using a child <code>into()</code> on a <code>from()</code> or a child <code>from()</code> on an <code>into()</code>.
Both approaches are acceptable, but you should create and follow a convention to ensure consistency across your build files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Don&#8217;t get your <code>into()</code> specifications mixed up.
For a normal copy, one to the filesystem rather than an archive, there should always be <em>one</em> "root" <code>into()</code> that specifies the overall destination directory of the copy.
Any other <code>into()</code> should have a child spec attached, and its path will be relative to the root <code>into()</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One final thing to be aware of is that a child copy spec inherits its destination path, include patterns, exclude patterns, copy actions, name mappings, and filters from its parent.
So, be careful where you place your configuration.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:sync_task"><a class="anchor" href="#sec:sync_task"></a><a class="link" href="#sec:sync_task">Using the <code>Sync</code> task</a></h5>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Sync.html">Sync</a> task, which extends the <code>Copy</code> task, copies the source files into the destination directory and then removes any files from the destination directory which it did not copy.
It synchronizes the contents of a directory with its source.</p>
</div>
<div class="paragraph">
<p>This can be useful for doing things such as installing your application, creating an exploded copy of your archives, or maintaining a copy of the project&#8217;s dependencies.</p>
</div>
<div class="paragraph">
<p>Here is an example that maintains a copy of the project&#8217;s runtime dependencies in the <code>build/libs</code> directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Sync&gt;("libs") {
    from(configurations["runtime"])
    into(layout.buildDirectory.dir("libs"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('libs', Sync) {
    from configurations.runtime
    into layout.buildDirectory.dir('libs')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also perform the same function in your own tasks with the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:sync(org.gradle.api.Action)">Project.sync(org.gradle.api.Action)</a> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:copying_single_file_example"><a class="anchor" href="#sec:copying_single_file_example"></a><a class="link" href="#sec:copying_single_file_example">Using the <code>Copy</code> task</a></h5>
<div class="paragraph">
<p>You can copy a file by creating an instance of Gradle&#8217;s builtin <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html">Copy</a> task and configuring it with the location of the file and where you want to put it.</p>
</div>
<div class="paragraph">
<p>This example mimics copying a generated report into a directory that will be packed into an archive, such as a ZIP or TAR:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyReport") {
    from(layout.buildDirectory.file("reports/my-report.pdf"))
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyReport', Copy) {
    from layout.buildDirectory.file("reports/my-report.pdf")
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The file and directory paths are then used to specify what file to copy using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html#org.gradle.api.tasks.Copy:from(java.lang.Object[])">Copy.from(java.lang.Object&#8230;&#8203;)</a> and which directory to copy it to using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html#org.gradle.api.tasks.Copy:into(java.lang.Object)">Copy.into(java.lang.Object)</a>.</p>
</div>
<div class="paragraph">
<p>Although hard-coded paths make for simple examples, they make the build brittle.
Using a reliable, single source of truth, such as a task or shared project property, is better.
In the following modified example, we use a report task defined elsewhere that has the report&#8217;s location stored in its <code>outputFile</code> property:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyReport2") {
    from(myReportTask.flatMap { it.outputFile })
    into(archiveReportsTask.flatMap { it.dirToArchive })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyReport2', Copy) {
    from myReportTask.outputFile
    into archiveReportsTask.dirToArchive
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We have also assumed that the reports will be archived by <code>archiveReportsTask</code>, which provides us with the directory that will be archived and hence where we want to put the copies of the reports.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:copying_multiple_files_example"><a class="anchor" href="#sec:copying_multiple_files_example"></a><a class="link" href="#sec:copying_multiple_files_example">Copying multiple files</a></h5>
<div class="paragraph">
<p>You can extend the previous examples to multiple files very easily by providing multiple arguments to <code>from()</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyReportsForArchiving") {
    from(layout.buildDirectory.file("reports/my-report.pdf"), layout.projectDirectory.file("src/docs/manual.pdf"))
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyReportsForArchiving', Copy) {
    from layout.buildDirectory.file("reports/my-report.pdf"), layout.projectDirectory.file("src/docs/manual.pdf")
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Two files are now copied into the archive directory.</p>
</div>
<div class="paragraph">
<p>You can also use multiple <code>from()</code> statements to do the same thing, as shown in the first example of the section <a href="#sec:copying_files">File copying in depth</a>.</p>
</div>
<div class="paragraph">
<p>But what if you want to copy all the PDFs in a directory without specifying each one?
To do this, attach inclusion and/or exclusion patterns to the copy specification.
Here, we use a string pattern to include PDFs only:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyPdfReportsForArchiving") {
    from(layout.buildDirectory.dir("reports"))
    include("*.pdf")
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyPdfReportsForArchiving', Copy) {
    from layout.buildDirectory.dir("reports")
    include "*.pdf"
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>One thing to note, as demonstrated in the following diagram, is that only the PDFs that reside directly in the <code>reports</code> directory are copied:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/copy-with-flat-filter-example.png" alt="copy with flat filter example">
</div>
</div>
<div class="paragraph">
<p>You can include files in subdirectories by using an Ant-style glob pattern (<code>**/*</code>), as done in this updated example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyAllPdfReportsForArchiving") {
    from(layout.buildDirectory.dir("reports"))
    include("**/*.pdf")
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyAllPdfReportsForArchiving', Copy) {
    from layout.buildDirectory.dir("reports")
    include "**/*.pdf"
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This task has the following effect:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/copy-with-deep-filter-example.png" alt="copy with deep filter example">
</div>
</div>
<div class="paragraph">
<p>Remember that a deep filter like this has the side effect of copying the directory structure below <code>reports</code> and the files.
If you want to copy the files without the directory structure, you must use an explicit <code>fileTree(<em>dir</em>) { <em>includes</em> }.files</code> expression.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:copying_directories_example"><a class="anchor" href="#sec:copying_directories_example"></a><a class="link" href="#sec:copying_directories_example">Copying directory hierarchies</a></h5>
<div class="paragraph">
<p>You may need to copy files as well as the directory structure in which they reside.
This is the default behavior when you specify a directory as the <code>from()</code> argument, as demonstrated by the following example that copies everything in the <code>reports</code> directory, including all its subdirectories, to the destination:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyReportsDirForArchiving") {
    from(layout.buildDirectory.dir("reports"))
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyReportsDirForArchiving', Copy) {
    from layout.buildDirectory.dir("reports")
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The key aspect that users need help with is controlling how much of the directory structure goes to the destination.
In the above example, do you get a <code>toArchive/reports</code> directory, or does everything in <code>reports</code> go straight into <code>toArchive</code>?
The answer is the latter. If a directory is part of the <code>from()</code> path, then it <em>won&#8217;t</em> appear in the destination.</p>
</div>
<div class="paragraph">
<p>So how do you ensure that <code>reports</code> itself is copied across, but not any other directory in <code>${layout.buildDirectory}</code>?
The answer is to add it as an include pattern:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyReportsDirForArchiving2") {
    from(layout.buildDirectory) {
        include("reports/**")
    }
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyReportsDirForArchiving2', Copy) {
    from(layout.buildDirectory) {
        include "reports/**"
    }
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll get the same behavior as before except with one extra directory level in the destination, i.e., <code>toArchive/reports</code>.</p>
</div>
<div class="paragraph">
<p>One thing to note is how the <code>include()</code> directive applies only to the <code>from()</code>, whereas the directive in the previous section applied to the whole task.
These different <a href="#sub:using_child_copy_specifications">levels of granularity</a> in the copy specification allow you to handle most requirements that you will come across easily.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:copying_files"><a class="anchor" href="#sec:copying_files"></a><a class="link" href="#sec:copying_files">Understanding file copying</a></h5>
<div class="paragraph">
<p>The basic process of copying files in Gradle is a simple one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define a task of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html">Copy</a></p>
</li>
<li>
<p>Specify which files (and potentially directories) to copy</p>
</li>
<li>
<p>Specify a destination for the copied files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But this apparent simplicity hides a rich API that allows fine-grained control of which files are copied, where they go, and what happens to them as they are copied  renaming of the files and token substitution of file content are both possibilities, for example.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the last two items on the list, which involve <a href="#sec:using_the_copyspec_class"><code>CopySpec</code></a>.
The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html">CopySpec</a> interface, which the <code>Copy</code> task implements, offers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#from-java.lang.Object...-">CopySpec.from(java.lang.Object&#8230;&#8203;)</a> method to define what to copy</p>
</li>
<li>
<p>An <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#into-java.lang.Object-">CopySpec.into(java.lang.Object)</a> method to define the destination</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CopySpec</code> has several additional methods that allow you to control the copying process, but these two are the only required ones.
<code>into()</code> is straightforward, requiring a directory path as its argument in any form supported by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method.
The <code>from()</code> configuration is far more flexible.</p>
</div>
<div class="paragraph">
<p>Not only does <code>from()</code> accept multiple arguments, it also allows several different types of argument.
For example, some of the most common types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>String</code>  treated as a file path or, if it starts with "file://", a file URI</p>
</li>
<li>
<p>A <code>File</code>  used as a file path</p>
</li>
<li>
<p>A <code>FileCollection</code> or <code>FileTree</code>  all files in the collection are included in the copy</p>
</li>
<li>
<p>A task  the files or directories that form a task&#8217;s <a href="incremental_build.html#sec:task_inputs_outputs">defined outputs</a> are included</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In fact, <code>from()</code> accepts all the same arguments as <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a> so see that method for a more detailed list of acceptable types.</p>
</div>
<div class="paragraph">
<p>Something else to consider is what type of thing a file path refers to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file  the file is copied as is</p>
</li>
<li>
<p>A directory  this is effectively treated as a file tree: everything in it, including subdirectories, is copied. However, the directory itself is not included in the copy.</p>
</li>
<li>
<p>A non-existent file  the path is ignored</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example that uses multiple <code>from()</code> specifications, each with a different argument type.
You will probably also notice that <code>into()</code> is configured lazily using a closure (in Groovy) or a Provider (in Kotlin)  a technique that also works with <code>from()</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("anotherCopyTask") {
    // Copy everything under src/main/webapp
    from("src/main/webapp")
    // Copy a single file
    from("src/staging/index.html")
    // Copy the output of a task
    from(copyTask)
    // Copy the output of a task using Task outputs explicitly.
    from(tasks["copyTaskWithPatterns"].outputs)
    // Copy the contents of a Zip file
    from(zipTree("src/main/assets.zip"))
    // Determine the destination directory later
    into({ getDestDir() })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('anotherCopyTask', Copy) {
    // Copy everything under src/main/webapp
    from 'src/main/webapp'
    // Copy a single file
    from 'src/staging/index.html'
    // Copy the output of a task
    from copyTask
    // Copy the output of a task using Task outputs explicitly.
    from copyTaskWithPatterns.outputs
    // Copy the contents of a Zip file
    from zipTree('src/main/assets.zip')
    // Determine the destination directory later
    into { getDestDir() }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that the lazy configuration of <code>into()</code> is different from a <a href="#sub:using_child_copy_specifications">child specification</a>, even though the syntax is similar.
Keep an eye on the number of arguments to distinguish between them.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:project_copy_method"><a class="anchor" href="#sec:project_copy_method"></a><a class="link" href="#sec:project_copy_method">Copying files in your own tasks</a></h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Using the <code>Project.copy</code> method at execution time, as described here, is not compatible with the <a href="#config_cache:requirements:use_project_during_execution">configuration cache</a>.
A possible solution is to implement the task as a proper class and use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html#copy-org.gradle.api.Action-">FileSystemOperations.copy</a> method instead, as described in the <a href="#config_cache:troubleshooting">configuration cache chapter</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Occasionally, you want to copy files or directories as <em>part</em> of a task.
For example, a custom archiving task based on an unsupported archive format might want to copy files to a temporary directory before they are archived.
You still want to take advantage of Gradle&#8217;s copy API without introducing an extra <code>Copy</code> task.</p>
</div>
<div class="paragraph">
<p>The solution is to use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:copy(org.gradle.api.Action)">Project.copy(org.gradle.api.Action)</a> method.
Configuring it with a copy spec works like the <code>Copy</code> task.
Here&#8217;s a trivial example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("copyMethod") {
    doLast {
        copy {
            from("src/main/webapp")
            into(layout.buildDirectory.dir("explodedWar"))
            include("**/*.html")
            include("**/*.jsp")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyMethod') {
    doLast {
        copy {
            from 'src/main/webapp'
            into layout.buildDirectory.dir('explodedWar')
            include '**/*.html'
            include '**/*.jsp'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The above example demonstrates the basic syntax and also highlights two major limitations of using the <code>copy()</code> method:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>copy()</code> method is not <a href="incremental_build.html#incremental_build">incremental</a>.
The example&#8217;s <code>copyMethod</code> task will <em>always</em> execute because it has no information about what files make up the task&#8217;s inputs.
You have to define the task inputs and outputs manually.</p>
</li>
<li>
<p>Using a task as a copy source, i.e., as an argument to <code>from()</code>, won&#8217;t create an automatic task dependency between your task and that copy source.
As such, if you use the <code>copy()</code> method as part of a task action, you must explicitly declare all inputs and outputs to get the correct behavior.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following example shows how to work around these limitations using the <a href="incremental_build.html#sec:task_input_output_runtime_api">dynamic API for task inputs and outputs</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("copyMethodWithExplicitDependencies") {
    // up-to-date check for inputs, plus add copyTask as dependency
    inputs.files(copyTask)
        .withPropertyName("inputs")
        .withPathSensitivity(PathSensitivity.RELATIVE)
    outputs.dir("some-dir") // up-to-date check for outputs
        .withPropertyName("outputDir")
    doLast {
        copy {
            // Copy the output of copyTask
            from(copyTask)
            into("some-dir")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyMethodWithExplicitDependencies') {
    // up-to-date check for inputs, plus add copyTask as dependency
    inputs.files(copyTask)
        .withPropertyName("inputs")
        .withPathSensitivity(PathSensitivity.RELATIVE)
    outputs.dir('some-dir') // up-to-date check for outputs
        .withPropertyName("outputDir")
    doLast {
        copy {
            // Copy the output of copyTask
            from copyTask
            into 'some-dir'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>These limitations make it preferable to use the <code>Copy</code> task wherever possible because of its built-in support for incremental building and task dependency inference.
That is why the <code>copy()</code> method is intended for use by <a href="#custom_tasks">custom tasks</a> that need to copy files as part of their function.
Custom tasks that use the <code>copy()</code> method should declare the necessary inputs and outputs relevant to the copy action.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="renaming_files"><a class="anchor" href="#renaming_files"></a><a class="link" href="#renaming_files">Renaming files</a></h4>
<div class="paragraph">
<p>Renaming files in Gradle can be done using the <code>CopySpec</code> API, which provides methods for renaming files as they are copied.</p>
</div>
<div class="sect4">
<h5 id="sec:renaming_files_example"><a class="anchor" href="#sec:renaming_files_example"></a><a class="link" href="#sec:renaming_files_example">Using <code>Copy.rename()</code></a></h5>
<div class="paragraph">
<p>If the files used and generated by your builds sometimes don&#8217;t have names that suit, you can rename those files as you copy them.
Gradle allows you to do this as part of a copy specification using the <code>rename()</code> configuration.</p>
</div>
<div class="paragraph">
<p>The following example removes the "-staging" marker from the names of any files that have it:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyFromStaging") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWar"))

    rename("(.+)-staging(.+)", "$1$2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyFromStaging', Copy) {
    from "src/main/webapp"
    into layout.buildDirectory.dir('explodedWar')

    rename '(.+)-staging(.+)', '$1$2'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As in the above example, you can use regular expressions for this or closures that use more complex logic to determine the target filename.
For example, the following task truncates filenames:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyWithTruncate") {
    from(layout.buildDirectory.dir("reports"))
    rename { filename: String -&gt;
        if (filename.length &gt; 10) {
            filename.slice(0..7) + "~" + filename.length
        }
        else filename
    }
    into(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyWithTruncate', Copy) {
    from layout.buildDirectory.dir("reports")
    rename { String filename -&gt;
        if (filename.size() &gt; 10) {
            return filename[0..7] + "~" + filename.size()
        }
        else return filename
    }
    into layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As with filtering, you can also rename a subset of files by configuring it as part of a child specification on a <code>from()</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:renaming_files"><a class="anchor" href="#sec:renaming_files"></a><a class="link" href="#sec:renaming_files">Using <code>Copyspec.rename{}</code></a></h5>
<div class="paragraph">
<p>The <a href="#sec:renaming_files_example">example of how to rename files on copy</a> gives you most of the information you need to perform this operation.
It demonstrates the two options for renaming:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using a regular expression</p>
</li>
<li>
<p>Using a closure</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Regular expressions are a flexible approach to renaming, particularly as Gradle supports regex groups that allow you to remove and replace parts of the source filename.
The following example shows how you can remove the string "-staging" from any filename that contains it using a simple regular expression:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("rename") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWar"))
    // Use a regular expression to map the file name
    rename("(.+)-staging(.+)", "$1$2")
    rename("(.+)-staging(.+)".toRegex().pattern, "$1$2")
    // Use a closure to convert all file names to upper case
    rename { fileName: String -&gt;
        fileName.uppercase()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('rename', Copy) {
    from 'src/main/webapp'
    into layout.buildDirectory.dir('explodedWar')
    // Use a regular expression to map the file name
    rename '(.+)-staging(.+)', '$1$2'
    rename(/(.+)-staging(.+)/, '$1$2')
    // Use a closure to convert all file names to upper case
    rename { String fileName -&gt;
        fileName.toUpperCase()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use any regular expression supported by the Java <code><a href="https://docs.oracle.com/javase/8/docs/api//java/util/regex/Pattern.html">Pattern</a></code> class and the substitution string.
The second argument of <code>rename()</code> works on the same principles as the <code><a href="https://docs.oracle.com/javase/8/docs/api//java/util/regex/Matcher.html#appendReplacement(java.lang.StringBuffer,%20java.lang.String)">Matcher.appendReplacement()</a></code> method.</p>
</div>
<div class="openblock">
<div class="title">Regular expressions in Groovy build scripts</div>
<div class="content">
<div class="paragraph">
<p>There are two common issues people come across when using regular expressions in this context:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you use a slashy string (those delimited by '/') for the first argument, you <em>must</em> include the parentheses for <code>rename()</code> as shown in the above example.</p>
</li>
<li>
<p>It&#8217;s safest to use single quotes for the second argument, otherwise you need to escape the '$' in group substitutions, i.e. <code>"\$1\$2"</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first is a minor inconvenience, but slashy strings have the advantage that you don&#8217;t have to escape backslash ('\') characters in the regular expression.
The second issue stems from Groovy&#8217;s support for embedded expressions using <code>${ }</code> syntax in double-quoted and slashy strings.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The closure syntax for <code>rename()</code> is straightforward and can be used for any requirements that simple regular expressions can&#8217;t handle.
You&#8217;re given a file&#8217;s name, and you return a new name for that file or <code>null</code> if you don&#8217;t want to change the name.
Be aware that the closure will be executed for every file copied, so try to avoid expensive operations where possible.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="filtering_files"><a class="anchor" href="#filtering_files"></a><a class="link" href="#filtering_files">Filtering files</a></h4>
<div class="paragraph">
<p>Filtering files in Gradle involves selectively including or excluding files based on certain criteria.</p>
</div>
<div class="sect4">
<h5 id="using_copyspec_include_and_copyspec_exclude"><a class="anchor" href="#using_copyspec_include_and_copyspec_exclude"></a><a class="link" href="#using_copyspec_include_and_copyspec_exclude">Using <code>CopySpec.include()</code> and <code>CopySpec.exclude()</code></a></h5>
<div class="paragraph">
<p>You can apply filtering in any copy specification through the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#include-java.lang.String...-">CopySpec.include(java.lang.String&#8230;&#8203;)</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#exclude-java.lang.String...-">CopySpec.exclude(java.lang.String&#8230;&#8203;)</a> methods.</p>
</div>
<div class="paragraph">
<p>These methods are typically used with Ant-style include or exclude patterns, as described in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/util/PatternFilterable.html">PatternFilterable</a>.</p>
</div>
<div class="paragraph">
<p>You can also perform more complex logic by using a closure that takes a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTreeElement.html">FileTreeElement</a> and returns <code>true</code> if the file should be included or <code>false</code> otherwise.
The following example demonstrates both forms, ensuring that only <code>.html</code> and <code>.jsp</code> files are copied, except for those <code>.html</code> files with the word "DRAFT" in their content:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyTaskWithPatterns") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWar"))
    include("**/*.html")
    include("**/*.jsp")
    exclude { details: FileTreeElement -&gt;
        details.file.name.endsWith(".html") &amp;&amp;
            details.file.readText().contains("DRAFT")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyTaskWithPatterns', Copy) {
    from 'src/main/webapp'
    into layout.buildDirectory.dir('explodedWar')
    include '**/*.html'
    include '**/*.jsp'
    exclude { FileTreeElement details -&gt;
        details.file.name.endsWith('.html') &amp;&amp;
            details.file.text.contains('DRAFT')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A question you may ask yourself at this point is what happens when inclusion and exclusion patterns overlap? Which pattern wins? Here are the basic rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there are no explicit inclusions or exclusions, everything is included</p>
</li>
<li>
<p>If at least one inclusion is specified, only files and directories matching the patterns are included</p>
</li>
<li>
<p>Any exclusion pattern overrides any inclusions, so if a file or directory matches at least one exclusion pattern, it won&#8217;t be included, regardless of the inclusion patterns</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bear these rules in mind when creating combined inclusion and exclusion specifications so that you end up with the exact behavior you want.</p>
</div>
<div class="paragraph">
<p>Note that the inclusions and exclusions in the above example will apply to <em>all</em> <code>from()</code> configurations.
If you want to apply filtering to a subset of the copied files, you&#8217;ll need to use <a href="#sub:using_child_copy_specifications">child specifications</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:filtering_files"><a class="anchor" href="#sec:filtering_files"></a><a class="link" href="#sec:filtering_files">Filtering file content</a></h4>
<div class="paragraph">
<p>Filtering file content in Gradle involves replacing placeholders or tokens in files with dynamic values.</p>
</div>
<div class="sect4">
<h5 id="using_copyspec_filter"><a class="anchor" href="#using_copyspec_filter"></a><a class="link" href="#using_copyspec_filter">Using <code>CopySpec.filter()</code></a></h5>
<div class="paragraph">
<p>Transforming the content of files while they are being copied involves basic templating that uses token substitution, removal of lines of text, or even more complex filtering using a full-blown template engine.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates several forms of filtering, including token substitution using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#expand-java.util.Map-">CopySpec.expand(java.util.Map)</a> method and another using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#filter-java.lang.Class-">CopySpec.filter(java.lang.Class)</a> with an <a href="https://ant.apache.org/manual/Types/filterchain.html">Ant filter</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.apache.tools.ant.filters.FixCrLfFilter
import org.apache.tools.ant.filters.ReplaceTokens
tasks.register&lt;Copy&gt;("filter") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWar"))
    // Substitute property tokens in files
    expand("copyright" to "2009", "version" to "2.3.1")
    // Use some of the filters provided by Ant
    filter(FixCrLfFilter::class)
    filter(ReplaceTokens::class, "tokens" to mapOf("copyright" to "2009", "version" to "2.3.1"))
    // Use a closure to filter each line
    filter { line: String -&gt;
        "[$line]"
    }
    // Use a closure to remove lines
    filter { line: String -&gt;
        if (line.startsWith('-')) null else line
    }
    filteringCharset = "UTF-8"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.apache.tools.ant.filters.FixCrLfFilter
import org.apache.tools.ant.filters.ReplaceTokens

tasks.register('filter', Copy) {
    from 'src/main/webapp'
    into layout.buildDirectory.dir('explodedWar')
    // Substitute property tokens in files
    expand(copyright: '2009', version: '2.3.1')
    // Use some of the filters provided by Ant
    filter(FixCrLfFilter)
    filter(ReplaceTokens, tokens: [copyright: '2009', version: '2.3.1'])
    // Use a closure to filter each line
    filter { String line -&gt;
        "[$line]"
    }
    // Use a closure to remove lines
    filter { String line -&gt;
        line.startsWith('-') ? null : line
    }
    filteringCharset = 'UTF-8'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>filter()</code> method has two variants, which behave differently:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one takes a <code><a href="https://docs.oracle.com/javase/8/docs/api//java/io/FilterReader.html">FilterReader</a></code> and is designed to work with Ant filters, such as <code>ReplaceTokens</code></p>
</li>
<li>
<p>one takes a closure or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Transformer.html">Transformer</a> that defines the transformation for each line of the source file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that both variants assume the source files are text-based.
When you use the <code>ReplaceTokens</code> class with <code>filter()</code>, you create a template engine that replaces tokens of the form <code>@tokenName@</code> (the Ant-style token) with values you define.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_copyspec_expand"><a class="anchor" href="#using_copyspec_expand"></a><a class="link" href="#using_copyspec_expand">Using <code>CopySpec.expand()</code></a></h5>
<div class="paragraph">
<p>The <code>expand()</code> method treats the source files as <a href="https://docs.groovy-lang.org/latest/html/api/groovy/text/SimpleTemplateEngine.html">Groovy templates</a>, which evaluates and expands expressions of the form <code>${expression}.</code></p>
</div>
<div class="paragraph">
<p>You can pass in property names and values that are then expanded in the source files. <code>expand()</code> allows for more than basic token substitution as the embedded expressions are full-blown Groovy expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Specifying the character set when reading and writing the file is good practice.
Otherwise, the transformations won&#8217;t work properly for non-ASCII text.
You configure the character set with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html#setFilteringCharset-java.lang.String-">CopySpec.setFilteringCharset(String)</a> property.
If it&#8217;s not specified, the JVM default character set is used, which will likely differ from the one you want.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:setting_file_permissions"><a class="anchor" href="#sec:setting_file_permissions"></a><a class="link" href="#sec:setting_file_permissions">Setting file permissions</a></h4>
<div class="paragraph">
<p>Setting file permissions in Gradle involves specifying the permissions for files or directories created or modified during the build process.</p>
</div>
<div class="sect4">
<h5 id="using_copyspec_filepermissions"><a class="anchor" href="#using_copyspec_filepermissions"></a><a class="link" href="#using_copyspec_filepermissions">Using <code>CopySpec.filePermissions{}</code></a></h5>
<div class="paragraph">
<p>For any <code>CopySpec</code> involved in copying files, may it be the <code>Copy</code> task itself, or any child specifications, you can explicitly set the permissions the destination files will have via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopyProcessingSpec.html#filePermissions-org.gradle.api.Action-">CopySpec.filePermissions {}</a> configurations block.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_copyspec_dirpermissions"><a class="anchor" href="#using_copyspec_dirpermissions"></a><a class="link" href="#using_copyspec_dirpermissions">Using <code>CopySpec.dirPermissions{}</code></a></h5>
<div class="paragraph">
<p>You can do the same for directories too, independently of files, via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopyProcessingSpec.html#dirPermissions-org.gradle.api.Action-">CopySpec.dirPermissions {}</a> configurations block.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Not setting permissions explicitly will preserve the permissions of the original files or directories.
The exception are archive tasks, see <a href="#sec:reproducible_archives">Reproducible archives</a> for details.
</td>
</tr>
</table>
</div>
<div id="ex-setting-file-permissions-for-files-and-directories" class="exampleblock">
<div class="title">Example 1. <a href="#ex-setting-file-permissions-for-files-and-directories">Setting file permissions for files and directories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("permissions") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWar"))
    filePermissions {
        user {
            read = true
            execute = true
        }
        other.execute = false
    }
    dirPermissions {
        unix("r-xr-x---")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('permissions', Copy) {
    from 'src/main/webapp'
    into layout.buildDirectory.dir('explodedWar')
    filePermissions {
        user {
            read = true
            execute = true
        }
        other.execute = false
    }
    dirPermissions {
        unix('r-xr-x---')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For a detailed description of file permissions, see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FilePermissions.html">FilePermissions</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/UserClassFilePermissions.html">UserClassFilePermissions</a>.
For details on the convenience method used in the samples, see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFilePermissions.html#unix-java.lang.String-">ConfigurableFilePermissions.unix(String)</a>.</p>
</div>
<div class="paragraph">
<p>Using empty configuration blocks for file or directory permissions still sets them explicitly, just to fixed default values.
Everything inside one of these configuration blocks is relative to the default values.
Default permissions differ for files and directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>file</strong>: read &amp; write for <strong>owner</strong>, read for <strong>group</strong>, read for <strong>other</strong> (<code>0644</code>, <code>rw-r&#8212;&#8203;r--</code>)</p>
</li>
<li>
<p><strong>directory</strong>: read, write &amp; execute for <strong>owner</strong>, read &amp; execute for <strong>group</strong>, read &amp; execute for <strong>other</strong> (<code>0755</code>, <code>rwxr-xr-x</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to set permissions for a specific file. See the following example:</p>
</div>
<div id="ex-setting-file-permissions-for-a-specific-file" class="exampleblock">
<div class="title">Example 2. <a href="#ex-setting-file-permissions-for-a-specific-file">Setting file permissions for a specific file</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("specificPermissions") {
    from("src/main/webapp")
    into(layout.buildDirectory.dir("explodedWarWithScript"))
    eachFile {
        if (name == "script.sh") {
            permissions {
                user {
                    execute = true
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("specificPermissions", Copy) {
    from 'src/main/webapp'
    into layout.buildDirectory.dir('explodedWarWithScript')
    eachFile {
        if (name == "script.sh") {
            permissions {
                user {
                    execute = true
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Setting file permissions explicitly for a file doesn&#8217;t support <code>UP-TO-DATE</code> checks, so a task using this setting will always run.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:moving_files_example"><a class="anchor" href="#sec:moving_files_example"></a><a class="link" href="#sec:moving_files_example">Moving files and directories</a></h4>
<div class="paragraph">
<p>Moving files and directories in Gradle is a straightforward process that can be accomplished using several APIs.
When implementing file-moving logic in your build scripts, it&#8217;s important to consider file paths, conflicts, and task dependencies.</p>
</div>
<div class="sect4">
<h5 id="using_file_renameto"><a class="anchor" href="#using_file_renameto"></a><a class="link" href="#using_file_renameto">Using <code>File.renameTo()</code></a></h5>
<div class="paragraph">
<p><code>File.renameTo()</code> is a method in Java (and by extension, in Gradle&#8217;s Groovy DSL) used to rename or move a file or directory.
When you call <code>renameTo()</code> on a <code>File</code> object, you provide another <code>File</code> object representing the new name or location.
If the operation is successful, <code>renameTo()</code> returns <code>true</code>; otherwise, it returns <code>false</code>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to note that <code>renameTo()</code> has some limitations and platform-specific behavior.</p>
</div>
<div class="paragraph">
<p>In this example, the <code>moveFile</code> task uses the <code>Copy</code> task type to specify the source and destination directories.
Inside the <code>doLast</code> closure, it uses <code>File.renameTo()</code> to move the file from the source directory to the destination directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">task moveFile {
    doLast {
        def sourceFile = file('source.txt')
        def destFile = file('destination/new_name.txt')

        if (sourceFile.renameTo(destFile)) {
            println "File moved successfully."
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_the_copy_task"><a class="anchor" href="#using_the_copy_task"></a><a class="link" href="#using_the_copy_task">Using the <code>Copy</code> task</a></h5>
<div class="paragraph">
<p>In this example, the <code>moveFile</code> task copies the file <code>source.txt</code> to the destination directory and renames it to <code>new_name.txt</code> in the process.
This achieves a similar effect to moving a file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">task moveFile(type: Copy) {
    from 'source.txt'
    into 'destination'
    rename { fileName -&gt;
        'new_name.txt'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:deleting_files_example"><a class="anchor" href="#sec:deleting_files_example"></a><a class="link" href="#sec:deleting_files_example">Deleting files and directories</a></h4>
<div class="paragraph">
<p>Deleting files and directories in Gradle involves removing them from the file system.</p>
</div>
<div class="sect4">
<h5 id="using_the_delete_task"><a class="anchor" href="#using_the_delete_task"></a><a class="link" href="#using_the_delete_task">Using the <code>Delete</code> task</a></h5>
<div class="paragraph">
<p>You can easily delete files and directories using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Delete.html">Delete</a> task.
You must specify which files and directories to delete in a way supported by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a> method.</p>
</div>
<div class="paragraph">
<p>For example, the following task deletes the entire contents of a build&#8217;s output directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("myClean") {
    delete(buildDir)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('myClean', Delete) {
    delete buildDir
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you want more control over which files are deleted, you can&#8217;t use inclusions and exclusions the same way you use them for copying files.
Instead, you use the built-in filtering mechanisms of <code>FileCollection</code> and <code>FileTree</code>.
The following example does just that to clear out temporary files from a source directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("cleanTempFiles") {
    delete(fileTree("src").matching {
        include("**/*.tmp")
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('cleanTempFiles', Delete) {
    delete fileTree("src").matching {
        include "**/*.tmp"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_project_delete"><a class="anchor" href="#using_project_delete"></a><a class="link" href="#using_project_delete">Using <code>Project.delete()</code></a></h5>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:delete(org.gradle.api.Action)">Project.delete(org.gradle.api.Action)</a> method can delete files and directories.</p>
</div>
<div class="paragraph">
<p>This method takes one or more arguments representing the files or directories to be deleted.</p>
</div>
<div class="paragraph">
<p>For example, the following task deletes the entire contents of a build&#8217;s output directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("myClean") {
    delete(buildDir)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('myClean', Delete) {
    delete buildDir
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you want more control over which files are deleted, you can&#8217;t use inclusions and exclusions the same way you use them for copying files.
Instead, you use the built-in filtering mechanisms of <code>FileCollection</code> and <code>FileTree</code>.
The following example does just that to clear out temporary files from a source directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("cleanTempFiles") {
    delete(fileTree("src").matching {
        include("**/*.tmp")
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('cleanTempFiles', Delete) {
    delete fileTree("src").matching {
        include "**/*.tmp"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_archives_example"><a class="anchor" href="#sec:creating_archives_example"></a><a class="link" href="#sec:creating_archives_example">Creating archives</a></h4>
<div class="paragraph">
<p>From the perspective of Gradle, packing files into an archive is effectively a copy in which the destination is the archive file rather than a directory on the file system.
Creating archives looks a lot like copying, with all the same features.</p>
</div>
<div class="sect4">
<h5 id="using_the_zip_tar_or_jar_task"><a class="anchor" href="#using_the_zip_tar_or_jar_task"></a><a class="link" href="#using_the_zip_tar_or_jar_task">Using the <code>Zip</code>, <code>Tar</code>, or <code>Jar</code> task</a></h5>
<div class="paragraph">
<p>The simplest case involves archiving the entire contents of a directory, which this example demonstrates by creating a ZIP of the <code>toArchive</code> directory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Zip&gt;("packageDistribution") {
    archiveFileName = "my-distribution.zip"
    destinationDirectory = layout.buildDirectory.dir("dist")

    from(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('packageDistribution', Zip) {
    archiveFileName = "my-distribution.zip"
    destinationDirectory = layout.buildDirectory.dir('dist')

    from layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice how we specify the destination and name of the archive instead of an <code>into()</code>: both are required. You often won&#8217;t see them explicitly set because most projects apply the <a href="base_plugin.html#base_plugin">Base Plugin</a>.
It provides some conventional values for those properties.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates this; you can learn more about the conventions in the <a href="#sec:archive_naming">archive naming</a> section.</p>
</div>
<div class="paragraph">
<p>Each type of archive has its own task type, the most common ones being <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>.
They all share most of the configuration options of <code>Copy</code>, including filtering and renaming.</p>
</div>
<div class="paragraph">
<p>One of the most common scenarios involves copying files into specified archive subdirectories.
For example, let&#8217;s say you want to package all PDFs into a <code>docs</code> directory in the archive&#8217;s root.
This <code>docs</code> directory doesn&#8217;t exist in the source location, so you must create it as part of the archive.
You do this by adding an <code>into()</code> declaration for just the PDFs:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    base
}

version = "1.0.0"

tasks.register&lt;Zip&gt;("packageDistribution") {
    from(layout.buildDirectory.dir("toArchive")) {
        exclude("**/*.pdf")
    }

    from(layout.buildDirectory.dir("toArchive")) {
        include("**/*.pdf")
        into("docs")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'base'
}

version = "1.0.0"

tasks.register('packageDistribution', Zip) {
    from(layout.buildDirectory.dir("toArchive")) {
        exclude "**/*.pdf"
    }

    from(layout.buildDirectory.dir("toArchive")) {
        include "**/*.pdf"
        into "docs"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see, you can have multiple <code>from()</code> declarations in a copy specification, each with its own configuration.
See <a href="#sub:using_child_copy_specifications">Using child copy specifications</a> for more information on this feature.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:archives"><a class="anchor" href="#sec:archives"></a><a class="link" href="#sec:archives">Understanding archive creation</a></h5>
<div class="paragraph">
<p>Archives are essentially self-contained file systems, and Gradle treats them as such.
This is why working with archives is similar to working with files and directories.</p>
</div>
<div class="paragraph">
<p>Out of the box, Gradle supports the creation of ZIP and TAR archives and, by extension, Java&#8217;s JAR, WAR, and EAR formatsJava&#8217;s archive formats are all ZIPs.
Each of these formats has a corresponding task type to create them: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.War.html">War</a>, and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.plugins.ear.Ear.html">Ear</a>.
These all work the same way and are based on copy specifications, just like the <code>Copy</code> task.</p>
</div>
<div class="paragraph">
<p>Creating an archive file is essentially a file copy in which the destination is implicit, i.e., the archive file itself.
Here is a basic example that specifies the path and name of the target archive file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Zip&gt;("packageDistribution") {
    archiveFileName = "my-distribution.zip"
    destinationDirectory = layout.buildDirectory.dir("dist")

    from(layout.buildDirectory.dir("toArchive"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('packageDistribution', Zip) {
    archiveFileName = "my-distribution.zip"
    destinationDirectory = layout.buildDirectory.dir('dist')

    from layout.buildDirectory.dir("toArchive")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The full power of copy specifications is available to you when creating archives, which means you can do content filtering, file renaming, or anything else covered in the previous section.
A common requirement is copying files into subdirectories of the archive that don&#8217;t exist in the source folders, something that can be achieved with <code>into()</code> <a href="#sub:using_child_copy_specifications">child specifications</a>.</p>
</div>
<div class="paragraph">
<p>Gradle allows you to create as many archive tasks as you want, but it&#8217;s worth considering that many convention-based plugins provide their own.
For example, the Java plugin adds a <code>jar</code> task for packaging a project&#8217;s compiled classes and resources in a JAR.
Many of these plugins provide sensible conventions for the names of archives and the copy specifications used.
We recommend you use these tasks wherever you can rather than overriding them with your own.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:archive_naming"><a class="anchor" href="#sec:archive_naming"></a><a class="link" href="#sec:archive_naming">Naming archives</a></h5>
<div class="paragraph">
<p>Gradle has several conventions around the naming of archives and where they are created based on the plugins your project uses.
The main convention is provided by the <a href="base_plugin.html#base_plugin">Base Plugin</a>, which defaults to creating archives in the <code>layout.buildDirectory.dir("distributions")</code> directory and typically uses archive names of the form <em>[projectName]-[version].[type]</em>.</p>
</div>
<div class="paragraph">
<p>The following example comes from a project named <code>archive-naming</code>, hence the <code>myZip</code> task creates an archive named <code>archive-naming-1.0.zip</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    base
}

version = "1.0"

tasks.register&lt;Zip&gt;("myZip") {
    from("somedir")
    val projectDir = layout.projectDirectory.asFile
    doLast {
        println(archiveFileName.get())
        println(destinationDirectory.get().asFile.relativeTo(projectDir))
        println(archiveFile.get().asFile.relativeTo(projectDir))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'base'
}

version = 1.0

tasks.register('myZip', Zip) {
    from 'somedir'
    File projectDir = layout.projectDirectory.asFile
    doLast {
        println archiveFileName.get()
        println projectDir.relativePath(destinationDirectory.get().asFile)
        println projectDir.relativePath(archiveFile.get().asFile)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q myZip
archive-naming-1.0.zip
build/distributions
build/distributions/archive-naming-1.0.zip</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the archive name does <em>not</em> derive from the task&#8217;s name that creates it.</p>
</div>
<div class="paragraph">
<p>If you want to change the name and location of a generated archive file, you can provide values for the corresponding task&#8217;s <code>archiveFileName</code> and <code>destinationDirectory</code> properties.
These override any conventions that would otherwise apply.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can make use of the default archive name pattern provided by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:archiveFileName">AbstractArchiveTask.getArchiveFileName()</a>: <em>[archiveBaseName]-[archiveAppendix]-[archiveVersion]-[archiveClassifier].[archiveExtension]</em>.
You can set each of these properties on the task separately.
Note that the Base Plugin uses the convention of the project name for <em>archiveBaseName</em>, project version for <em>archiveVersion</em>, and the archive type for <em>archiveExtension</em>.
It does not provide values for the other properties.</p>
</div>
<div class="paragraph">
<p>This example  from the same project as the one above  configures just the <code>archiveBaseName</code> property, overriding the default value of the project name:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Zip&gt;("myCustomZip") {
    archiveBaseName = "customName"
    from("somedir")

    doLast {
        println(archiveFileName.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('myCustomZip', Zip) {
    archiveBaseName = 'customName'
    from 'somedir'

    doLast {
        println archiveFileName.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q myCustomZip
customName-1.0.zip</pre>
</div>
</div>
<div class="paragraph">
<p>You can also override the default <code>archiveBaseName</code> value for <em>all</em> the archive tasks in your build by configuring the <code>archivesName</code> property in the <code>base</code> block, as demonstrated by the following example.
The block is defined by the <code>base</code> plugin and backed by the <code>BasePluginExtension</code> class.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    base
}

version = "1.0"

base {
    archivesName = "gradle"
    distsDirectory = layout.buildDirectory.dir("custom-dist")
    libsDirectory = layout.buildDirectory.dir("custom-libs")
}

val myZip by tasks.registering(Zip::class) {
    from("somedir")
}

val myOtherZip by tasks.registering(Zip::class) {
    archiveAppendix = "wrapper"
    archiveClassifier = "src"
    from("somedir")
}

tasks.register("echoNames") {
    val projectNameString = project.name
    val archiveFileName = myZip.flatMap { it.archiveFileName }
    val myOtherArchiveFileName = myOtherZip.flatMap { it.archiveFileName }
    doLast {
        println("Project name: $projectNameString")
        println(archiveFileName.get())
        println(myOtherArchiveFileName.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'base'
}

version = 1.0
base {
    archivesName = "gradle"
    distsDirectory = layout.buildDirectory.dir('custom-dist')
    libsDirectory = layout.buildDirectory.dir('custom-libs')
}

def myZip = tasks.register('myZip', Zip) {
    from 'somedir'
}

def myOtherZip = tasks.register('myOtherZip', Zip) {
    archiveAppendix = 'wrapper'
    archiveClassifier = 'src'
    from 'somedir'
}

tasks.register('echoNames') {
    def projectNameString = project.name
    def archiveFileName = myZip.flatMap { it.archiveFileName }
    def myOtherArchiveFileName = myOtherZip.flatMap { it.archiveFileName }
    doLast {
        println "Project name: $projectNameString"
        println archiveFileName.get()
        println myOtherArchiveFileName.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q echoNames
Project name: archives-changed-base-name
gradle-1.0.zip
gradle-wrapper-1.0-src.zip</pre>
</div>
</div>
<div class="paragraph">
<p>You can find all the possible archive task properties in the API documentation for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a>.
Still, we have also summarized the main ones here:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>archiveFileName</code>  <code>Property&lt;String&gt;</code>, default: <code><em>archiveBaseName</em>-<em>archiveAppendix</em>-<em>archiveVersion</em>-<em>archiveClassifier</em>.<em>archiveExtension</em></code></dt>
<dd>
<p>The complete file name of the generated archive. If any of the properties in the default value are empty, their '-' separator is dropped.</p>
</dd>
<dt class="hdlist1"><code>archiveFile</code>  <code>Provider&lt;RegularFile&gt;</code>, <em>read-only</em>, default: <code><em>destinationDirectory</em>/<em>archiveFileName</em></code></dt>
<dd>
<p>The absolute file path of the generated archive.</p>
</dd>
<dt class="hdlist1"><code>destinationDirectory</code>  <code>DirectoryProperty</code>, default: depends on archive type</dt>
<dd>
<p>The target directory in which to put the generated archive. By default, JARs and WARs go into <code>layout.buildDirectory.dir("libs")</code>. ZIPs and TARs go into <code>layout.buildDirectory.dir("distributions")</code>.</p>
</dd>
<dt class="hdlist1"><code>archiveBaseName</code>  <code>Property&lt;String&gt;</code>, default: <code><em>project.name</em></code></dt>
<dd>
<p>The base name portion of the archive file name, typically a project name or some other descriptive name for what it contains.</p>
</dd>
<dt class="hdlist1"><code>archiveAppendix</code>  <code>Property&lt;String&gt;</code>, default: <code>null</code></dt>
<dd>
<p>The appendix portion of the archive file name that comes immediately after the base name. It is typically used to distinguish between different forms of content, such as code and docs, or a minimal distribution versus a full or complete one.</p>
</dd>
<dt class="hdlist1"><code>archiveVersion</code>  <code>Property&lt;String&gt;</code>, default: <code><em>project.version</em></code></dt>
<dd>
<p>The version portion of the archive file name, typically in the form of a normal project or product version.</p>
</dd>
<dt class="hdlist1"><code>archiveClassifier</code>  <code>Property&lt;String&gt;</code>, default: <code>null</code></dt>
<dd>
<p>The classifier portion of the archive file name. Often used to distinguish between archives that target different platforms.</p>
</dd>
<dt class="hdlist1"><code>archiveExtension</code>  <code>Property&lt;String&gt;</code>, default: depends on archive type and compression type</dt>
<dd>
<p>The filename extension for the archive. By default, this is set based on the archive task type and the compression type (if you&#8217;re creating a TAR). Will be one of: <code>zip</code>, <code>jar</code>, <code>war</code>, <code>tar</code>, <code>tgz</code> or <code>tbz2</code>. You can of course set this to a custom extension if you wish.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:sharing_content_between_multiple_archives"><a class="anchor" href="#sec:sharing_content_between_multiple_archives"></a><a class="link" href="#sec:sharing_content_between_multiple_archives">Sharing content between multiple archives</a></h5>
<div class="paragraph">
<p><a href="#sub:sharing_copy_specs">As described in the <code>CopySpec</code> section above</a>, you can use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:copySpec(org.gradle.api.Action)">Project.copySpec(org.gradle.api.Action)</a> method to share content between archives.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:archive_contents"><a class="anchor" href="#sec:archive_contents"></a><a class="link" href="#sec:archive_contents">Using archives as file trees</a></h5>
<div class="paragraph">
<p>An archive is a directory and file hierarchy packed into a single file.
In other words, it&#8217;s a special case of a file tree, and that&#8217;s exactly how Gradle treats archives.</p>
</div>
<div class="paragraph">
<p>Instead of using the <code>fileTree()</code> method, which only works on normal file systems, you use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:tarTree(java.lang.Object)">Project.tarTree(java.lang.Object)</a> methods to wrap archive files of the corresponding type (note that JAR, WAR and EAR files are ZIPs).
Both methods return <code>FileTree</code> instances that you can then use in the same way as normal file trees.
For example, you can extract some or all of the files of an archive by copying its contents to some directory on the file system.
Or you can merge one archive into another.</p>
</div>
<div class="paragraph">
<p>Here are some simple examples of creating archive-based file trees:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create a ZIP file tree using path
val zip: FileTree = zipTree("someFile.zip")

// Create a TAR file tree using path
val tar: FileTree = tarTree("someFile.tar")

// tar tree attempts to guess the compression based on the file extension
// however if you must specify the compression explicitly you can:
val someTar: FileTree = tarTree(resources.gzip("someTar.ext"))</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create a ZIP file tree using path
FileTree zip = zipTree('someFile.zip')

// Create a TAR file tree using path
FileTree tar = tarTree('someFile.tar')

//tar tree attempts to guess the compression based on the file extension
//however if you must specify the compression explicitly you can:
FileTree someTar = tarTree(resources.gzip('someTar.ext'))</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can see a practical example of extracting an archive file <a href="#sec:unpacking_archives_example">in the unpacking archives section</a> below.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:reproducible_archives"><a class="anchor" href="#sec:reproducible_archives"></a><a class="link" href="#sec:reproducible_archives">Reproducible archives</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Starting with Gradle 9, archives are reproducible by default.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s desirable to recreate archives exactly the same, byte for byte, on different machines.
Building an artifact from source code should produce the same result no matter when and where it is built.
This is necessary for projects like <a href="https://reproducible-builds.org/">reproducible-builds.org</a>.</p>
</div>
<div class="paragraph">
<p>Reproducing the same byte-for-byte archive generally poses some challenges since the order of the files in an archive can be influenced by the underlying file system.
Each time a ZIP, TAR, JAR, WAR or EAR is built from source, the order of the files inside the archive may change.
Files on disk can also have different timestamps or permissions depending on the environment.</p>
</div>
<div class="paragraph">
<p>Starting with Gradle 9.0.0, all <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a> (e.g. <code>Jar</code>, <code>Zip</code>) tasks produce reproducible archives by default:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File order in the archive is deterministic</p>
</li>
<li>
<p>Files have fixed timestamps (exact values depend on the archive type)</p>
</li>
<li>
<p>Directories have fixed permissions set to <code>0755</code></p>
</li>
<li>
<p>Files have fixed permissions set to <code>0644</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can <a href="#sec:setting_file_permissions">further customize</a> the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:dirPermissions-org.gradle.api.Action-">directory permissions</a>
or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:filePermissions-org.gradle.api.Action-">file permissions</a>
while keeping the archives reproducible.</p>
</div>
<div class="sect4">
<h5 id="sec:revert_reproducible_archives"><a class="anchor" href="#sec:revert_reproducible_archives"></a><a class="link" href="#sec:revert_reproducible_archives">Preserve file system-defined aspects</a></h5>
<div class="paragraph">
<p>If desired, you can revert individual aspects of reproducible archives.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;AbstractArchiveTask&gt;().configureEach {
    // Use file timestamps from the file system
    isPreserveFileTimestamps = true   // <b class="conum">(1)</b>
    // Make file order based on the file system
    isReproducibleFileOrder = false   // <b class="conum">(2)</b>
    // Use permissions from the file system
    useFileSystemPermissions()        // <b class="conum">(3)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(AbstractArchiveTask).configureEach {
    // Use file timestamps from the file system
    preserveFileTimestamps = true  // <b class="conum">(1)</b>
    // Make file order based on the file system
    reproducibleFileOrder = false  // <b class="conum">(2)</b>
    // Use permissions from the file system
    useFileSystemPermissions()     // <b class="conum">(3)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:preserveFileTimestamps"><code>isPreserveFileTimestamps</code></a> to <code>true</code> to use timestamp values from the file system.</p>
</li>
<li>
<p>Set <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:reproducibleFileOrder"><code>isReproducibleFileOrder</code></a> to <code>false</code> to preserve the file order based on the file system.</p>
</li>
<li>
<p>Call <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:useFileSystemPermissions()"><code>useFileSystemPermissions()</code></a> to preserve the permissions from the file system.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In case the file system is already the source of truth for the permissions, e.g., via the version control tools, you can preserve the permissions across all archives tasks by configuring a property:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.archives.use-file-system-permissions=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:permissions_inside_archives"><a class="anchor" href="#sec:permissions_inside_archives"></a><a class="link" href="#sec:permissions_inside_archives">Permissions for files inside archives</a></h4>
<div class="paragraph">
<p>Setting file permissions in Gradle archives is done in the same way as when copying file, see <a href="#sec:setting_file_permissions">Setting file permissions</a> for details.
The main difference is that archive tasks by default set the permissions of files and directories in the archive to fixed values, which are <code>0644</code> for files and <code>0755</code> for directories for reproducibility.</p>
</div>
<div class="paragraph">
<p>We recognize two main cases, where users may want to change the permissions of files and directories in archives:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Case where the file system is already the source of truth for the permissions.
For such configuration see <a href="#sec:revert_reproducible_archives">Preserve file system-defined aspects</a> section.</p>
</li>
<li>
<p>Case where the permissions of files and directories in the archive should be set to specific values, for example to set the executable bit on a script file.
For such configuration see <a href="#sec:setting_file_permissions">Setting file permissions</a> section.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:unpacking_archives_example"><a class="anchor" href="#sec:unpacking_archives_example"></a><a class="link" href="#sec:unpacking_archives_example">Unpacking archives</a></h4>
<div class="paragraph">
<p>Archives are effectively self-contained file systems, so unpacking them is a case of copying the files from that file system onto the local file system  or even into another archive.
Gradle enables this by providing some wrapper functions that make archives available as hierarchical collections of files (<a href="#sec:file_trees">file trees</a>).</p>
</div>
<div class="sect4">
<h5 id="using_project_ziptree_and_project_tartree"><a class="anchor" href="#using_project_ziptree_and_project_tartree"></a><a class="link" href="#using_project_ziptree_and_project_tartree">Using <code>Project.zipTree</code> and <code>Project.tarTree</code></a></h5>
<div class="paragraph">
<p>The two functions of interest are <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:tarTree(java.lang.Object)">Project.tarTree(java.lang.Object)</a>, which produce a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html">FileTree</a> from a corresponding archive file.</p>
</div>
<div class="paragraph">
<p>That file tree can then be used in a <code>from()</code> specification, like so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("unpackFiles") {
    from(zipTree("src/resources/thirdPartyResources.zip"))
    into(layout.buildDirectory.dir("resources"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('unpackFiles', Copy) {
    from zipTree("src/resources/thirdPartyResources.zip")
    into layout.buildDirectory.dir("resources")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As with a normal copy, you can control which files are unpacked via <a href="#sec:filtering_files">filters</a> and even <a href="#sec:renaming_files">rename files</a> as they are unpacked.</p>
</div>
<div class="paragraph">
<p>More advanced processing can be handled by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.AbstractCopyTask.html#eachFile(org.gradle.api.Action)">eachFile()</a> method.
For example, you might need to extract different subtrees of the archive into different paths within the destination directory.
The following sample uses the method to extract the files within the archive&#8217;s <code>libs</code> directory into the root destination directory, rather than into a <code>libs</code> subdirectory:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("unpackLibsDirectory") {
    from(zipTree("src/resources/thirdPartyResources.zip")) {
        include("libs/**")  // <b class="conum">(1)</b>
        eachFile {
            relativePath = RelativePath(true, *relativePath.segments.drop(1).toTypedArray())  // <b class="conum">(2)</b>
        }
        includeEmptyDirs = false  // <b class="conum">(3)</b>
    }
    into(layout.buildDirectory.dir("resources"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('unpackLibsDirectory', Copy) {
    from(zipTree("src/resources/thirdPartyResources.zip")) {
        include "libs/**"  // <b class="conum">(1)</b>
        eachFile { fcd -&gt;
            fcd.relativePath = new RelativePath(true, fcd.relativePath.segments.drop(1))  // <b class="conum">(2)</b>
        }
        includeEmptyDirs = false  // <b class="conum">(3)</b>
    }
    into layout.buildDirectory.dir("resources")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Extracts only the subset of files that reside in the <code>libs</code> directory</p>
</li>
<li>
<p>Remaps the path of the extracting files into the destination directory by dropping the <code>libs</code> segment from the file path</p>
</li>
<li>
<p>Ignores the empty directories resulting from the remapping, see Caution note below</p>
</li>
</ol>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can not change the destination path of empty directories with this technique.
You can learn more in <a href="https://github.com/gradle/gradle/issues/2940">this issue</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re a Java developer wondering why there is no <code>jarTree()</code> method, that&#8217;s because <code>zipTree()</code> works perfectly well for JARs, WARs, and EARs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_uber_jar_example"><a class="anchor" href="#sec:creating_uber_jar_example"></a><a class="link" href="#sec:creating_uber_jar_example">Creating "uber" or "fat" JARs</a></h4>
<div class="paragraph">
<p>In Java, applications and their dependencies were typically packaged as separate JARs within a single distribution archive.
That still happens, but another approach that is now common is placing the classes and resources of the dependencies directly into the application JAR, creating what is known as an Uber or fat JAR.</p>
</div>
<div class="paragraph">
<p>Creating "uber" or "fat" JARs in Gradle involves packaging all dependencies into a single JAR file, making it easier to distribute and run the application.</p>
</div>
<div class="sect4">
<h5 id="using_the_shadow_plugin"><a class="anchor" href="#using_the_shadow_plugin"></a><a class="link" href="#using_the_shadow_plugin">Using the Shadow Plugin</a></h5>
<div class="paragraph">
<p>Gradle does not have full built-in support for creating uber JARs, but you can use third-party plugins like the <a href="https://github.com/GradleUp/shadow">Shadow plugin</a> (<code>com.gradleup.shadow</code>) to achieve this.
This plugin packages your project classes and dependencies into a single JAR file.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_project_ziptree_and_the_jar_task"><a class="anchor" href="#using_project_ziptree_and_the_jar_task"></a><a class="link" href="#using_project_ziptree_and_the_jar_task">Using <code>Project.zipTree()</code> and the <code>Jar</code> task</a></h5>
<div class="paragraph">
<p>To copy the contents of other JAR files into the application JAR, use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> method and the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a> task.
This is demonstrated by the <code>uberJar</code> task in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    java
}

version = "1.0.0"

repositories {
    mavenCentral()
}

dependencies {
    implementation("commons-io:commons-io:2.6")
}

tasks.register&lt;Jar&gt;("uberJar") {
    archiveClassifier = "uber"

    from(sourceSets.main.get().output)

    dependsOn(configurations.runtimeClasspath)
    from({
        configurations.runtimeClasspath.get().filter { it.name.endsWith("jar") }.map { zipTree(it) }
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

version = '1.0.0'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'commons-io:commons-io:2.6'
}

tasks.register('uberJar', Jar) {
    archiveClassifier = 'uber'

    from sourceSets.main.output

    dependsOn configurations.runtimeClasspath
    from {
        configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, we&#8217;re taking the runtime dependencies of the project  <code>configurations.runtimeClasspath.files</code>  and wrapping each of the JAR files with the <code>zipTree()</code> method.
The result is a collection of ZIP file trees, the contents of which are copied into the uber JAR alongside the application classes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_directories_example"><a class="anchor" href="#sec:creating_directories_example"></a><a class="link" href="#sec:creating_directories_example">Creating directories</a></h4>
<div class="paragraph">
<p>Many tasks need to create directories to store the files they generate, which is why Gradle <a href="incremental_build.html#incremental_build">automatically manages</a> this aspect of tasks when they explicitly define file and directory outputs.
All core Gradle tasks ensure that any output directories they need are created, if necessary, using this mechanism.</p>
</div>
<div class="sect4">
<h5 id="using_file_mkdirs_and_files_createdirectories"><a class="anchor" href="#using_file_mkdirs_and_files_createdirectories"></a><a class="link" href="#using_file_mkdirs_and_files_createdirectories">Using <code>File.mkdirs</code> and <code>Files.createDirectories</code></a></h5>
<div class="paragraph">
<p>In cases where you need to create a directory manually, you can use the standard <code><a href="https://docs.oracle.com/javase/8/docs/api//java/nio/file/Files.html#createDirectories-java.nio.file.Path-java.nio.file.attribute.FileAttribute...-">Files.createDirectories</a></code> or <code><a href="https://docs.oracle.com/javase/8/docs/api//java/io/File.html#mkdirs--">File.mkdirs</a></code> methods from within your build scripts or custom task implementations.</p>
</div>
<div class="paragraph">
<p>Here is a simple example that creates a single <code>images</code> directory in the project folder:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("ensureDirectory") {
    // Store target directory into a variable to avoid project reference in the configuration cache
    val directory = file("images")

    doLast {
        Files.createDirectories(directory.toPath())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('ensureDirectory') {
    // Store target directory into a variable to avoid project reference in the configuration cache
    def directory = file("images")

    doLast {
        Files.createDirectories(directory.toPath())
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As described in the <a href="https://ant.apache.org/manual/Tasks/mkdir.html">Apache Ant manual</a>, the <code>mkdir</code> task will automatically create all necessary directories in the given path.
It will do nothing if the directory already exists.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_project_mkdir"><a class="anchor" href="#using_project_mkdir"></a><a class="link" href="#using_project_mkdir">Using <code>Project.mkdir</code></a></h5>
<div class="paragraph">
<p>You can create directories in Gradle using the <code>mkdir</code> method, which is available in the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#mkdir-java.lang.Object-"><code>Project</code> object</a>.
This method takes a <code>File</code> object or a <code>String</code> representing the path of the directory to be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('createDirs') {
    doLast {
        mkdir 'src/main/resources'
        mkdir file('build/generated')

        // Create multiple dirs
        mkdir files(['src/main/resources', 'src/test/resources'])

        // Check dir existence
        def dir = file('src/main/resources')
        if (!dir.exists()) {
            mkdir dir
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:install_executable"><a class="anchor" href="#sec:install_executable"></a><a class="link" href="#sec:install_executable">Installing executables</a></h4>
<div class="paragraph">
<p>When you are building a standalone executable, you may want to install this file on your system, so it ends up in your path.</p>
</div>
<div class="sect4">
<h5 id="using_the_copy_task_2"><a class="anchor" href="#using_the_copy_task_2"></a><a class="link" href="#using_the_copy_task_2">Using the <code>Copy</code> task</a></h5>
<div class="paragraph">
<p>You can use a <code>Copy</code> task to install the executable into shared directories like <code>/usr/local/bin</code>.
The installation directory probably contains many other executables, some of which may even be unreadable by Gradle.
To support the unreadable files in the <code>Copy</code> task&#8217;s destination directory and to avoid time consuming up-to-date checks, you can use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:doNotTrackState(java.lang.String)">Task.doNotTrackState()</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("installExecutable") {
    from("build/my-binary")
    into("/usr/local/bin")
    doNotTrackState("Installation directory contains unrelated files")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("installExecutable", Copy) {
    from "build/my-binary"
    into "/usr/local/bin"
    doNotTrackState("Installation directory contains unrelated files")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:copy_deploy"><a class="anchor" href="#sec:copy_deploy"></a><a class="link" href="#sec:copy_deploy">Deploying single files into application servers</a></h4>
<div class="paragraph">
<p>Deploying a single file to an application server typically refers to the process of transferring a packaged application artifact, such as a WAR file, to the application server&#8217;s deployment directory.</p>
</div>
<div class="sect4">
<h5 id="using_the_copy_task_3"><a class="anchor" href="#using_the_copy_task_3"></a><a class="link" href="#using_the_copy_task_3">Using the <code>Copy</code> task</a></h5>
<div class="paragraph">
<p>When working with application servers, you can use a <code>Copy</code> task to deploy the application archive (e.g. a WAR file).
Since you are deploying a single file, the destination directory of the <code>Copy</code> is the whole deployment directory.
The deployment directory sometimes does contain unreadable files like named pipes, so Gradle may have problems doing up-to-date checks.
In order to support this use-case, you can use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:doNotTrackState(java.lang.String)">Task.doNotTrackState()</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    war
}

tasks.register&lt;Copy&gt;("deployToTomcat") {
    from(tasks.war)
    into(layout.projectDirectory.dir("tomcat/webapps"))
    doNotTrackState("Deployment directory contains unreadable files")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'war'
}

tasks.register("deployToTomcat", Copy) {
    from war
    into layout.projectDirectory.dir('tomcat/webapps')
    doNotTrackState("Deployment directory contains unreadable files")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="structuring_builds"><a class="anchor" href="#structuring_builds"></a><a class="link" href="#structuring_builds">STRUCTURING BUILDS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="organizing_gradle_projects"><a class="anchor" href="#organizing_gradle_projects"></a><a class="link" href="#organizing_gradle_projects">Structuring and Organizing Gradle Projects</a></h3>
<div class="paragraph">
<p>It is important to structure your Gradle project to optimize build performance.
A multi-project build is the standard in Gradle.</p>
</div>
<div class="sect3">
<h4 id="sub:project_locations"><a class="anchor" href="#sub:project_locations"></a><a class="link" href="#sub:project_locations">Project Concepts</a></h4>
<div class="paragraph">
<p>There are four key concepts to understand Gradle projects:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Root project</strong>: The top-level project in a build that contains the <code>settings.gradle(.kts)</code> file and typically aggregates all subprojects.</p>
</li>
<li>
<p><strong>Subprojects</strong>: Individual modules (components) that are part of a multi-project build and are included by the root project via the <code>settings.gradle(.kts)</code> file.</p>
</li>
<li>
<p><strong>Settings file</strong>: A <code>settings.gradle(.kts)</code> configuration file used to define the structure of a multi-project build, including which subprojects are part of it and optionally how they&#8217;re named or located.</p>
</li>
<li>
<p><strong>Build scripts</strong>: <code>build.gradle(.kts)</code> files that define how a project is built (applying plugins, declaring dependencies, configuring tasks, etc&#8230;&#8203;) executed per project (subprojects can each have one).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at an example:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">my-project/     // <b class="conum">(1)</b>
 settings.gradle.kts // <b class="conum">(2)</b>
 app/                    // <b class="conum">(3)</b>
    build.gradle.kts        // <b class="conum">(4)</b>
    src/
 core/                   // <b class="conum">(3)</b>
    build.gradle.kts        // <b class="conum">(4)</b>
    src/
 util/                   // <b class="conum">(3)</b>
     build.gradle.kts        // <b class="conum">(4)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">my-project/     // <b class="conum">(1)</b>
 settings.gradle // <b class="conum">(2)</b>
 app/                // <b class="conum">(3)</b>
    build.gradle        // <b class="conum">(4)</b>
    src/
 core/               // <b class="conum">(3)</b>
    build.gradle        // <b class="conum">(4)</b>
    src/
 util/               // <b class="conum">(3)</b>
     build.gradle        // <b class="conum">(4)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Root project directory</p>
</li>
<li>
<p>Settings file</p>
</li>
<li>
<p>Subproject</p>
</li>
<li>
<p>Subproject build file</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_single_project_builds"><a class="anchor" href="#sec:creating_single_project_builds"></a><a class="link" href="#sec:creating_single_project_builds">Single-Project Build</a></h4>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-1.png" alt="structuring builds 1">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s look at a <em>basic</em> multi-project build example that contains a root project and a single subproject.</p>
</div>
<div class="paragraph">
<p>The root project is called <code>my-project</code>, located somewhere on your machine.
From Gradle&#8217;s perspective, the root is the top-level directory <code>.</code>.</p>
</div>
<div class="paragraph">
<p>The project contains a single subproject called <code>app</code>:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.   // <b class="conum">(1)</b>
 settings.gradle.kts // <b class="conum">(2)</b>
 app/                   // <b class="conum">(3)</b>
     build.gradle.kts       // <b class="conum">(4)</b>
     src/               // <b class="conum">(5)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.   // <b class="conum">(1)</b>
 settings.gradle // <b class="conum">(2)</b>
 app/                 // <b class="conum">(3)</b>
     build.gradle        // <b class="conum">(4)</b>
     src/             // <b class="conum">(5)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Root project</p>
</li>
<li>
<p>Settings file</p>
</li>
<li>
<p>Subproject</p>
</li>
<li>
<p>Subproject build file</p>
</li>
<li>
<p>Source code and more</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This is the recommended project structure for starting any Gradle project.
The <a href="build_init_plugin.html#build_init_plugin">Build Init plugin</a> also generates skeleton projects that follow this structure - a root project with a single subproject:</p>
</div>
<div class="paragraph">
<p>The <code>settings.gradle(.kts)</code> file describes the project structure to Gradle:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/basic-multiproject">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "my-project"
include("app")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'my-project'
include 'app'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, Gradle will look for a build file for the <code>app</code> subproject in the <code>./app</code> directory.</p>
</div>
<div class="paragraph">
<p>You can view the structure of a multi-project build by running the <code>projects</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew -q projects
Projects:
------------------------------------------------------------
Root project 'my-project'
------------------------------------------------------------
Location: /home/user/gradle/samples
Project hierarchy:
Root project 'my-project'
\--- Project ':app'
Project locations:
project ':app' - /app
To see a list of the tasks of a project, run gradle &lt;project-path&gt;:tasks
For example, try running gradle :app:tasks</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>app</code> subproject is a Java application that applies the <a href="#application_plugin">Java Application plugin</a> and configures the main class.</p>
</div>
<div class="paragraph">
<p>The application prints <code>Hello World</code> to the console:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("application")
}

application {
    mainClass = "com.example.Hello"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
}

application {
    mainClass = 'com.example.Hello'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">app/src/main/java/com/example/Hello.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello, world!");
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can run the application by executing the <code>run</code> task from the <a href="#application_plugin">Application plugin</a> in the project root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew -q run
Hello, world!</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_multi_project_builds"><a class="anchor" href="#sec:creating_multi_project_builds"></a><a class="link" href="#sec:creating_multi_project_builds">Multi-Project Build (<code>include()</code>)</a></h4>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-2.png" alt="structuring builds 2">
</div>
</div>
<div class="paragraph">
<p>In the settings file, you can use the <code>include</code> method to add another subproject to the root project:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/standardLayouts">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("project1", "project2:child1", "project3:child1")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include 'project1', 'project2:child1', 'project3:child1'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>include</code> method takes <a href="multi_project_builds_intermediate.html#sec:project_path">project paths</a> as arguments.
The project path is assumed to be equal to the relative physical file system path.
For example, a path <code>services:api</code> is mapped by default to a folder <code>./services/api</code> (relative to the project root <code>.</code>).</p>
</div>
<div class="paragraph">
<p>More examples of how to work with the project path can be found in the DSL documentation of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[])">Settings.include(java.lang.String[])</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add another subproject called <code>lib</code> to the previously created project.</p>
</div>
<div class="paragraph">
<p>All we need to do is add another <code>include</code> statement in the root settings file:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/multiple-subprojects">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "my-project"
include("app")
include("lib")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'my-project'
include 'app'
include 'lib'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle will then look for the build file of the new <code>lib</code> subproject in the <code>./lib/</code> directory:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.       // <b class="conum">(1)</b>
 settings.gradle.kts // <b class="conum">(2)</b>
 app/                    // <b class="conum">(3)</b>
    build.gradle.kts        // <b class="conum">(4)</b>
    src/
 lib/                    // <b class="conum">(3)</b>
     build.gradle.kts        // <b class="conum">(4)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.       // <b class="conum">(1)</b>
 settings.gradle // <b class="conum">(2)</b>
 app/                // <b class="conum">(3)</b>
    build.gradle        // <b class="conum">(4)</b>
    src/
 lib/                // <b class="conum">(3)</b>
     build.gradle        // <b class="conum">(4)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Root project</p>
</li>
<li>
<p>Settings file</p>
</li>
<li>
<p>Subproject</p>
</li>
<li>
<p>Subproject build file</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can learn more about multi-project builds in <a href="#multi_project_builds">Multi-Project Builds</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_sources"><a class="anchor" href="#sec:build_sources"></a><a class="link" href="#sec:build_sources">Sharing Build Logic (<code>buildSrc</code>)</a></h4>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-3.png" alt="structuring builds 3">
</div>
</div>
<div class="paragraph">
<p>When projects grow in size and complexity, it&#8217;s common to see the same logic repeated across multiple subprojectslike applying the same plugins, configuring the same tasks, or declaring the same dependencies.</p>
</div>
<div class="paragraph">
<p>Duplicated build logic is hard to maintain and easy to get wrong.
Gradle provides a built-in way to centralize and reuse this logic: a special directory called <code>buildSrc</code>.</p>
</div>
<div class="paragraph">
<p><code>buildSrc</code> is a separate build located in the root of your Gradle project.
Any code you put in this directory is automatically compiled and added to the classpath of your main build.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at our multi-project build:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 settings.gradle.kts
 app/
    build.gradle.kts    // <b class="conum">(1)</b>
    src/
 lib/
     build.gradle.kts    // <b class="conum">(1)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 settings.gradle
 app/
    build.gradle    // <b class="conum">(1)</b>
    src/
 lib/
     build.gradle    // <b class="conum">(1)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Subproject build script, applies <code>java-library</code> and testing logic</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We now encapsulate reusable configuration logic in a <code>java-library-convention.gradle.kts</code> file.</p>
</div>
<div class="paragraph">
<p>Because the file is named <code>java-library-convention.gradle.kts</code>, Gradle automatically registers it as a plugin with the ID <code>java-library-convention</code>.
It compiles and makes this plugin available to all other build scripts in the project.</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 settings.gradle.kts
 buildSrc/
    build.gradle.kts
    src/main/kotlin/
        java-library-convention.gradle.kts  // <b class="conum">(1)</b>
 app/
    build.gradle.kts    // <b class="conum">(2)</b>
    src/
 lib/
     build.gradle.kts    // <b class="conum">(2)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 settings.gradle
 buildSrc/
    build.gradle
    src/main/groovy/
        java-library-convention.gradle  // <b class="conum">(1)</b>
 app/
    build.gradle    // <b class="conum">(2)</b>
    src/
 lib/
     build.gradle    // <b class="conum">(2)</b>
     src/</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Applies <code>java-library</code> and testing logic</p>
</li>
<li>
<p>Subproject build script, applies <code>java-library</code> and testing logic</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can learn more about multi-project builds in <a href="#sharing_build_logic_between_subprojects">Sharing Build Logc between Subprojects using BuildSrc</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:composite_builds"><a class="anchor" href="#sec:composite_builds"></a><a class="link" href="#sec:composite_builds">Composite Builds (<code>includeBuild()</code>)</a></h4>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-4.png" alt="structuring builds 4">
</div>
</div>
<div class="paragraph">
<p>In Gradle, composite builds (or included builds) are ways to compose multiple builds together.</p>
</div>
<div class="paragraph">
<p>They allow you to work with multiple Gradle projects (builds) as if they were part of a single build, without needing to publish artifacts to a repository.</p>
</div>
<div class="paragraph">
<p>Imagine we want to break up our multi-project build into two separate builds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A shared library in <code>libs</code></p>
</li>
<li>
<p>An application that uses it (our previous multi-project build)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We want to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Keep them in separate builds (they could be in separate repos)</p>
</li>
<li>
<p>But develop them together without publishing <code>lib</code></p>
</li>
</ul>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 settings.gradle.kts
 buildSrc/
    build.gradle.kts
    src/main/kotlin/
        java-library-convention.gradle.kts
 app/
    build.gradle.kts
    src/
 core/
    build.gradle.kts
    src/
 util/
    build.gradle.kts
    src/
 libs/           // <b class="conum">(1)</b>
     lib/
         settings.gradle.kts
         build.gradle.kts
         src/</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 settings.gradle
 buildSrc/
    build.gradle
    src/main/groovy/
        java-library-convention.gradle
 app/
    build.gradle
    src/
 core/
    build.gradle
    src/
 util/
    build.gradle
    src/
 libs/           // <b class="conum">(1)</b>
     lib/
         settings.gradle
         build.gradle
         src/</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Standalone, reusable library (included build)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here, <code>lib</code> is a separate Gradle build that lives in <code>libs/lib</code>.
Its not part of the normal <code>include(&#8230;&#8203;)</code> multi-project structure.</p>
</div>
<div class="paragraph">
<p>Instead, we treat it as an included build, a distinct build that we can use without publishing it to a repository.</p>
</div>
<div class="paragraph">
<p>In the root <code>settings.gradle(.kts)</code>, we tell Gradle to include <code>lib</code> as part of a composite build using <code>includeBuild()</code>:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/dependencyManagement/customizingResolution-capabilitySubstitutionRule">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">includeBuild("lib")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">includeBuild 'lib'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more about multi-project builds in <a href="#composite_builds">Composite Builds</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:structuring_recommendations"><a class="anchor" href="#sec:structuring_recommendations"></a><a class="link" href="#sec:structuring_recommendations">Structuring Recommendations</a></h4>
<div class="paragraph">
<p>Source code and build logic should be organized in a clear, consistent, and meaningful way.
This section outlines recommendations that lead to readable and maintainable Gradle projects.
It also highlights common pitfalls and how to avoid them to ensure your builds stay robust and scalable.</p>
</div>
<div class="sect4">
<h5 id="sec:separate_language_source_files"><a class="anchor" href="#sec:separate_language_source_files"></a><a class="link" href="#sec:separate_language_source_files">Use separate Language-specific Source Files</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s language plugins define conventions for discovering and compiling source code.
For example, when the <a href="java_plugin.html#java_plugin">Java plugin</a> is applied, Gradle automatically compiles source files in <code>src/main/java</code>.</p>
</div>
<div class="paragraph">
<p>Other language plugins follow a similar convention: the last part of the source directory (e.g., <code>java</code>, <code>groovy</code>, <code>kotlin</code>) indicates the language of the source files it contains.</p>
</div>
<div class="paragraph">
<p>Some compilers support cross-compilation of multiple languages from the same directory.
For example, the Groovy compiler can compile both Java and Groovy source files from <code>src/main/groovy</code>.</p>
</div>
<div class="paragraph">
<p>However, Gradle recommends separating source files by language into distinct directories (e.g., <code>src/main/java</code> and <code>src/main/kotlin</code>).
This improves build performance and makes builds more predictableboth for Gradle and for humans reading the project layout.</p>
</div>
<div class="paragraph">
<p>Heres an example source layout for a project using both Java and Kotlin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 build.gradle.kts
 src
     main
         java
            HelloWorld.java
         kotlin
             Utils.kt</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 build.gradle
 src
     main
         java
            HelloWorld.java
         kotlin
             Utils.kt</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:separate_test_type_source_files"><a class="anchor" href="#sec:separate_test_type_source_files"></a><a class="link" href="#sec:separate_test_type_source_files">Use separate Source Files per Test type</a></h5>
<div class="paragraph">
<p>It&#8217;s common for a project to define and run multiple types of testssuch as unit tests, integration tests, functional tests, or smoke tests.
To keep things maintainable and organized, Gradle recommends storing each test types source code in its own dedicated source directory.</p>
</div>
<div class="paragraph">
<p>For example, instead of placing all tests under <code>src/test/java</code>, you might use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">src/
 test/                      // Unit tests
    java/
 integrationTest/           // Integration tests
    java/
 functionalTest/            // Functional tests
     java/</code></pre>
</div>
</div>
<div class="paragraph">
<p>To see how this works in practice, check out the
<a href="../samples/sample_jvm_multi_project_with_additional_test_types.html">example project</a> which demonstrates how to define a custom <code>integrationTest</code> source set and task in a Java-based project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle allows you to define multiple source sets and test tasks, so you can fully isolate and control each type of test in your build.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:use_standard_conventions"><a class="anchor" href="#sec:use_standard_conventions"></a><a class="link" href="#sec:use_standard_conventions">Use standard Conventions</a></h5>
<div class="paragraph">
<p>All Gradle core plugins follow the <strong>convention over configuration</strong> principle, a well-known software engineering paradigm that favors sensible defaults over manual setup.
You can read more about it here: <a href="https://en.wikipedia.org/wiki/Convention_over_configuration">Convention over configuration</a>.</p>
</div>
<div class="paragraph">
<p>Gradle plugins provide predefined behaviors and directory structures that "just work" in most cases.
Lets take the <a href="java_plugin.html#java_plugin">Java Plugin</a> as an example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default source directory is <code>src/main/java</code>.</p>
</li>
<li>
<p>The default output location for compiled classes and packaged artifacts (like JARs) is <code>build/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While Gradle allows you to override most defaults, doing so can make your build harder to understand and maintainespecially for teams or newcomers.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Stick to standard conventions unless you have a strong reason to deviate (e.g., adapting to a legacy layout).
Refer to the reference documentation for each plugin to learn about its default conventions and behaviors.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:settings_file"><a class="anchor" href="#sec:settings_file"></a><a class="link" href="#sec:settings_file">Use a Settings file</a></h5>
<div class="paragraph">
<p>Every time you run a Gradle build, Gradle attempts to locate a <code>settings.gradle</code> (Groovy DSL) or <code>settings.gradle.kts</code> (Kotlin DSL) file.
To do this, it walks up the directory hierarchy from the current working directory to the filesystem root.
As soon as it finds a settings file, it stops searching and uses that as the entry point for the build.</p>
</div>
<div class="paragraph">
<p>In a <a href="#multi_project_builds">multi-project build</a>, the settings file is <strong>required</strong>.
It defines which projects are part of the build and enables Gradle to correctly configure and evaluate the entire project hierarchy.</p>
</div>
<div class="paragraph">
<p>You may also need a settings file to <a href="#organizing_gradle_projects">add shared libraries or plugins</a> to the build classpath using <code>pluginManagement</code> or <code>dependencyResolutionManagement</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows a standard Gradle project layout:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 settings.gradle.kts
 subproject-one
    build.gradle.kts
 subproject-two
     build.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 settings.gradle
 subproject-one
    build.gradle
 subproject-two
     build.gradle</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="multi_project_builds"><a class="anchor" href="#multi_project_builds"></a><a class="link" href="#multi_project_builds">Multi-Project Builds</a></h3>
<div class="paragraph">
<p>As projects grow, it&#8217;s common to split them into smaller, focused modules that are built, tested, and released together.
Gradle supports this through multi-project builds, allowing you to organize related codebases under a single build while keeping each module logically isolated.</p>
</div>
<div class="sect3">
<h4 id="multi_project_layout"><a class="anchor" href="#multi_project_layout"></a><a class="link" href="#multi_project_layout">Multi-Project Layout</a></h4>
<div class="paragraph">
<p>A multi-project build consists of a root project and one or more subprojects, all defined in a single <code>settings.gradle(.kts)</code> file.
This structure supports modularization, parallel execution, and code reuse.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-6.png" alt="structuring builds 6">
</div>
</div>
<div class="paragraph">
<p>A typical multi-project structure looks like this:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">my-project/
 settings.gradle.kts     // <b class="conum">(1)</b>
 build.gradle.kts            // <b class="conum">(2)</b>
 app/                    // <b class="conum">(3)</b>
    build.gradle.kts        // <b class="conum">(4)</b>
 core/                   // <b class="conum">(3)</b>
    build.gradle.kts        // <b class="conum">(5)</b>
 util/                   // <b class="conum">(3)</b>
     build.gradle.kts        // <b class="conum">(6)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">my-project/
 settings.gradle         // <b class="conum">(1)</b>
 build.gradle        // <b class="conum">(2)</b>
 app/                    // <b class="conum">(3)</b>
    build.gradle    // <b class="conum">(4)</b>
 core/                   // <b class="conum">(3)</b>
    build.gradle    // <b class="conum">(5)</b>
 util/                   // <b class="conum">(3)</b>
     build.gradle    // <b class="conum">(6)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Declares subprojects</p>
</li>
<li>
<p>Root project build logic (optional)</p>
</li>
<li>
<p>Subproject</p>
</li>
<li>
<p>App module</p>
</li>
<li>
<p>Shared core logic</p>
</li>
<li>
<p>Utility code</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each subproject can define its own build logic, dependencies, and plugins.</p>
</div>
<div class="paragraph">
<p>In <code>settings.gradle(.kts)</code>, you include subprojects by name using <code>include()</code>.
The <code>include()</code> method takes <a href="multi_project_builds_intermediate.html#sec:project_path">project paths</a> as arguments:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "my-project"
include("app", "core", "util")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'my-project'
include('app', 'core', 'util')</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, a project path corresponds to the relative physical location of the project directory.
For example, the path <code>services:api</code> maps to the directory <code>./services/api</code>, relative to the root project.</p>
</div>
<div class="paragraph">
<p>You can find more examples and detailed usage in the DSL reference for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[])"><code>Settings.include(String&#8230;&#8203;)</code></a>.</p>
</div>
<div class="sect4">
<h5 id="sub:modifying_element_of_the_project_tree"><a class="anchor" href="#sub:modifying_element_of_the_project_tree"></a><a class="link" href="#sub:modifying_element_of_the_project_tree">Project Descriptors</a></h5>
<div class="paragraph">
<p>To further describe the project architecture to Gradle, the settings file provides <em>project descriptors</em>.</p>
</div>
<div class="paragraph">
<p>You can modify these descriptors in the settings file at any time.</p>
</div>
<div class="paragraph">
<p>To access a descriptor, you can:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/customLayout">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("project-a")
println(rootProject.name)
println(project(":project-a").name)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include('project-a')
println rootProject.name
println project(':project-a').name</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using this descriptor, you can change the name, project directory, and build file of a project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "main"
include("project-a")
project(":project-a").projectDir = file("custom/my-project-a")
project(":project-a").buildFileName = "project-a.gradle.kts"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'main'
include('project-a')
project(':project-a').projectDir = file('custom/my-project-a')
project(':project-a').buildFileName = 'project-a.gradle'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Consult the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/ProjectDescriptor.html">ProjectDescriptor</a> class in the API documentation for more information.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Setting the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:projectDir">Project.projectDir</a> property is important when locating projects in nested subdirectories to <a href="#avoid_empty_projects">avoid unintentionally creating empty projects</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="include_existing_projects_only"><a class="anchor" href="#include_existing_projects_only"></a><a class="link" href="#include_existing_projects_only">Including projects without an existing directory</a></h5>
<div class="paragraph">
<p>When you include a subproject in your <code>settings.gradle(.kts)</code> file, Gradle expects that the associated directory for that project exists and is writable.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Starting with <strong>Gradle 9.0.0</strong>, this is enforced strictly: <strong>If a project directory is missing or read-only, the build will fail.</strong> This replaces earlier behavior where Gradle would silently allow missing project directories.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here&#8217;s how you can create a missing directory at configuration time:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("project-without-directory")
project(":project-without-directory").projectDir.mkdirs()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">include 'project-without-directory'
project(":project-without-directory").projectDir.mkdirs()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:naming_recommendations"><a class="anchor" href="#sec:naming_recommendations"></a><a class="link" href="#sec:naming_recommendations">Naming recommendations</a></h4>
<div class="paragraph">
<p>As your project grows, naming and consistency get increasingly more important.</p>
</div>
<div class="paragraph">
<p>To keep your builds maintainable, we recommend the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Keep default project names for subprojects</strong>:
It is possible to configure custom project names in the settings file.
However, its an unnecessary extra effort for the developers to track which projects belong to what folders.</p>
</li>
<li>
<p><strong>Use lower case hyphenation for all project names</strong>:
All letters are lowercase, and words are separated with a dash (<code>-</code>) character.</p>
</li>
<li>
<p><strong>Define the root project name in the settings file</strong>:
The <code>rootProject.name</code> effectively assigns a name to the build, used in reports like Build Scan.
If the root project name is not set, the name will be the container directory name, which can be unstable (i.e., you can check out your project in any directory).
The name will be generated randomly if the root project name is not set and checked out to a file system&#8217;s root (e.g., <code>/</code> or <code>C:\</code>).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="declaring_dependencies_between_subprojects"><a class="anchor" href="#declaring_dependencies_between_subprojects"></a><a class="link" href="#declaring_dependencies_between_subprojects">Declaring dependencies between Subprojects</a></h4>
<div class="paragraph">
<p>What if one subproject depends on another?
What if one subproject depends on the artifact produced by another?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-7.png" alt="structuring builds 7">
</div>
</div>
<div class="paragraph">
<p>This is a common use case in multi-project builds.
Gradle supports this scenario with <a href="#sec:project-dependencies">project dependencies</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:project_jar_dependencies"><a class="anchor" href="#sec:project_jar_dependencies"></a><a class="link" href="#sec:project_jar_dependencies">Depending on another Project</a></h5>
<div class="paragraph">
<p>Consider a multi-project build with the following layout:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 api
    src
      ...
    build.gradle.kts
 services
    person-service
        src
          ...
        build.gradle.kts
 shared
    src
      ...
    build.gradle.kts
 settings.gradle.kts</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 api
    src
      ...
    build.gradle
 services
    person-service
        src
          ...
        build.gradle
 shared
    src
      ...
    build.gradle
 settings.gradle</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>person-service</code> depends on both <code>api</code> and <code>shared</code></p>
</li>
<li>
<p><code>api</code> depends on <code>shared</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You declare these relationships using the project path, which uses colons (<code>:</code>) to indicate nesting.
For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:shared</code> refers to the <code>shared</code> subproject</p>
</li>
<li>
<p><code>services:person-service</code> refers to a nested subproject</p>
</li>
</ul>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/basic-dependencies">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div id="javadependencies_2" class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "dependencies-java"
include("api", "shared", "services:person-service")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java")
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation("junit:junit:4.13")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">api/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java")
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation("junit:junit:4.13")
    implementation(project(":shared"))
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/person-service/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java")
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation("junit:junit:4.13")
    implementation(project(":shared"))
    implementation(project(":api"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'basic-dependencies'
include 'api', 'shared', 'services:person-service'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation "junit:junit:4.13"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">api/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation "junit:junit:4.13"
    implementation project(':shared')
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/person-service/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation "junit:junit:4.13"
    implementation project(':shared')
    implementation project(':api')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more details on project paths, consult the DSL documentation for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[])">Settings.include(String&#8230;&#8203;)</a>.</p>
</div>
<div class="paragraph">
<p>A project dependency affects both the build order and classpath:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The required project will be built first.</p>
</li>
<li>
<p>Its compiled classes and transitive dependencies are added to the consuming projects classpath.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, running <code>./gradlew :api:compileJava</code> will first build <code>shared</code>, then <code>api</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:depending_on_output_of_another_project"><a class="anchor" href="#sec:depending_on_output_of_another_project"></a><a class="link" href="#sec:depending_on_output_of_another_project">Depending on Artifacts produced by another Project</a></h5>
<div class="paragraph">
<p>Sometimes, you only need the output of a specific task from another projectnot the entire project itself.</p>
</div>
<div class="paragraph">
<p>While you can create task-to-task dependencies between projects, Gradle discourages this because it creates tight coupling between tasks.</p>
</div>
<div class="paragraph">
<p>Instead, use outgoing artifacts to expose a tasks output and model it as a dependency.
Gradles <a href="variant_aware_resolution.html#sec:understanding-variant-selection">variant-aware dependency management</a> allows one project to consume artifacts from another in a structured, on-demand way.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sharing_build_logic_between_subprojects"><a class="anchor" href="#sharing_build_logic_between_subprojects"></a><a class="link" href="#sharing_build_logic_between_subprojects">Sharing Build Logic using <code>buildSrc</code></a></h3>
<div class="paragraph">
<p>Subprojects in a multi-project build often share common dependencies.</p>
</div>
<div class="paragraph">
<p>Rather than duplicating the same dependency declarations across multiple build scripts, Gradle allows you to centralize shared build logic in a special directory.
This way, you can declare the dependency version in one place and have it automatically apply to all subprojects.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-8.png" alt="structuring builds 8">
</div>
</div>
<div class="sect3">
<h4 id="sec:sharing_logic_via_convention_plugins"><a class="anchor" href="#sec:sharing_logic_via_convention_plugins"></a><a class="link" href="#sec:sharing_logic_via_convention_plugins">Using <code>buildSrc</code></a></h4>
<div class="paragraph">
<p><code>buildSrc</code> is a special directory in a Gradle build that allows you to organize and share build logic, such as custom plugins, tasks, configurations, and utility functions, across all projects in your build.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-9.png" alt="structuring builds 9">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at an example with the following structure:</p>
</div>
<div class="paragraph">
<p>A typical multi-project build has the following layout:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 api
    src/
    build.gradle.kts    // <b class="conum">(1)</b>
 services
    src/
    build.gradle.kts    // <b class="conum">(1)</b>
 shared
    src/
    build.gradle.kts    // <b class="conum">(1)</b>
 settings.gradle.kts</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A build script that contains build logic, including parts that are shared with other subprojects.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 api
    src/
    build.gradle    // <b class="conum">(1)</b>
 services
    src/
    build.gradle    // <b class="conum">(1)</b>
 shared
    src/
    build.gradle    // <b class="conum">(1)</b>
 settings.gradle</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A build script that contains build logic, including parts that are shared with other subprojects.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The build file for <code>api</code>, <code>services</code>, and <code>shared</code> has many commonalities:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/buildSrc">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">api/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.slf4j:slf4j-api:2.0.9")
    implementation("com.fasterxml.jackson.core:jackson-databind:2.17.1")
    testImplementation("org.junit.jupiter:junit-jupiter:5.11.3")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.slf4j:slf4j-api:2.0.9")
    implementation("com.google.guava:guava:32.1.2-jre")
    testImplementation("org.junit.jupiter:junit-jupiter:5.11.3")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.slf4j:slf4j-api:2.0.9")
    implementation("com.google.guava:guava:32.1.2-jre")
    testImplementation("org.junit.jupiter:junit-jupiter:5.11.3")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">api/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.slf4j:slf4j-api:2.0.9'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.17.1'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.11.3'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'com.google.guava:guava:32.1.2-jre'
    implementation 'org.slf4j:slf4j-api:2.0.9'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.11.3'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'com.google.guava:guava:32.1.2-jre'
    implementation 'org.slf4j:slf4j-api:2.0.9'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.11.3'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To avoid duplicating build logic across <code>api</code>, <code>services</code>, and <code>shared</code>, we can move the shared parts into <code>buildSrc</code>.
This allows us to define dependencies and other configurations once and apply them uniformly to all subprojects.</p>
</div>
<div class="paragraph">
<p>For example, if you need to update the version of <code>org.slf4j:slf4j-api:1.7.32</code>, you only have to change it oncein the build logic inside <code>buildSrc</code>rather than updating every individual build script.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s expand the layout to include a <code>buildSrc</code> directory:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 buildSrc
    src
      main
         kotlin
            java-common-conventions.gradle.kts  // <b class="conum">(1)</b>
    build.gradle.kts
 api
    src/
    build.gradle.kts            // <b class="conum">(2)</b>
 services
    src/
    build.gradle.kts            // <b class="conum">(2)</b>
 shared
    src/
    build.gradle.kts            // <b class="conum">(2)</b>
 settings.gradle.kts</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A shared build script.</p>
</li>
<li>
<p>Applies the shared build script.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 buildSrc
    src
      main
         groovy
            java-common-conventions.gradle  // <b class="conum">(1)</b>
    build.gradle
 api
    src/
    build.gradle            // <b class="conum">(2)</b>
 services
    src/
    build.gradle            // <b class="conum">(2)</b>
 shared
    src/
    build.gradle            // <b class="conum">(2)</b>
 settings.gradle</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A shared build script.</p>
</li>
<li>
<p>Applies the shared build script.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>When a <code>buildSrc</code> directory is present at the root of a Gradle build, Gradle treats it as a <a href="#composite_builds">Composite Build</a>.
Upon detecting the <code>buildSrc</code> directory, Gradle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Treats <code>buildSrc</code> as an independent Gradle project with its own <code>build.gradle(.kts)</code> file and its own <code>src/</code> folder.</p>
</li>
<li>
<p>Compiles all classes and scripts in <code>buildSrc</code> (typically under <code>src/main/kotlin</code> or <code>src/main/groovy</code>) before evaluating any other build scripts in the main build.</p>
</li>
<li>
<p>Makes the compiled classes and scripts available on the classpath of all other project build scripts in the root project and subprojects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As such, our new <code>buildSrc</code> has the following build file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}

repositories {
    gradlePluginPortal()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy-gradle-plugin'
}

repositories {
    gradlePluginPortal()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the <code>buildSrc</code>, the build script <code>java-common-conventions.gradle(.kts)</code> is created in <code>src/main/kotlin</code> or <code>src/main/groovy</code>.
It contains dependencies and other build information that is common to our subprojects:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/java-common-conventions.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.slf4j:slf4j-api:2.0.9")
    testImplementation("org.junit.jupiter:junit-jupiter:5.11.3")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/java-common-conventions.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.slf4j:slf4j-api:2.0.9'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.11.3'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you create a script file like <code>java-common-conventions.gradle(.kts)</code>, you can treat it as a plugin and apply it in your subprojects.
The ID of the plugin is the name of the build file without the <code>gradle(.kts)</code> extension.
This kind of plugin is called a <strong>convention plugin</strong>.</p>
</div>
<div class="paragraph">
<p>The shared logic is removed from the <code>api</code>, <code>services</code>, and <code>shared</code> build files.
And the <code>shared</code> plugin is applied in the files instead:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/multiproject/buildSrc">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">api/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.fasterxml.jackson.core:jackson-databind:2.17.1")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.google.guava:guava:32.1.2-jre")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.google.guava:guava:32.1.2-jre")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">api/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.fasterxml.jackson.core:jackson-databind:2.17.1")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">services/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.google.guava:guava:32.1.2-jre")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">shared/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("java-common-conventions")
}

dependencies {
    implementation("com.google.guava:guava:32.1.2-jre")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>From now on, if you want to change something like the version of <code>slf4j-api</code>, you only need to update it in <code>buildSrc</code>, and the change will automatically apply to all subprojects.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_buildsrc"><a class="anchor" href="#sec:using_buildsrc"></a><a class="link" href="#sec:using_buildsrc">About the <code>buildSrc</code> directory</a></h4>
<div class="paragraph">
<p><code>buildSrc</code> is a special, Gradle-recognized directory that provides a convenient way to organize and reuse custom build logic across your build. Gradle automatically treats it as an included build with several advantages:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Reusable Build Logic</strong>: You can centralize common build logic, tasks, and plugins in <code>buildSrc</code>. This promotes consistency and maintainability across subprojects, as changes in <code>buildSrc</code> are automatically reflected wherever its logic is used.</p>
</li>
<li>
<p><strong>Automatic Compilation and Classpath Inclusion</strong>: Gradle automatically compiles the code in <code>buildSrc</code> and includes it in the classpath of all build scripts. This allows classes, plugins, and utilities defined in <code>buildSrc</code> to be used directly without additional setup.</p>
</li>
<li>
<p><strong>Cleaner Build Scripts</strong>: Moving logic into <code>buildSrc</code> keeps your projects main build scripts focused and decluttered, improving readability and maintainability.</p>
</li>
<li>
<p><strong>Ease of Testing</strong>: Since <code>buildSrc</code> is treated as a standalone build, you can write and run unit tests for your custom tasks and plugins just like any other project code.</p>
</li>
<li>
<p><strong>Convenient Plugin Development</strong>: If you&#8217;re writing custom Gradle plugins for internal use, <code>buildSrc</code> provides an easy way to define and use them without publishing to an external repository.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>buildSrc</code> follows the same <a href="java_plugin.html#javalayout">source layout conventions</a> as regular Java, Groovy, or Kotlin projects and has direct access to the Gradle API.
Dependencies can be declared in its own <code>build.gradle</code> or <code>build.gradle.kts</code> file.</p>
</div>
<div class="paragraph">
<p>In a multi-project build, only one <code>buildSrc</code> directory is allowed, and it must reside in the root project directory.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Changes to code in <code>buildSrc</code> will invalidate the configuration phase and require re-execution of all tasks, potentially slowing down the build.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="using_a_composite_build_named_build_logic"><a class="anchor" href="#using_a_composite_build_named_build_logic"></a><a class="link" href="#using_a_composite_build_named_build_logic">Using a Composite Build Named <code>build-logic</code></a></h5>
<div class="paragraph">
<p>In addition to <code>buildSrc</code>, another powerful way to share build logic across subprojects is by using a dedicated composite build, typically named <code>build-logic</code>.</p>
</div>
<div class="paragraph">
<p>A typical multi-project build using <code>build-logic</code> as a composite build looks like this:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">.
 build-logic/                   // <b class="conum">(1)</b>
    build.gradle.kts
    settings.gradle.kts
    src/main/kotlin
        java-common-conventions.gradle.kts
 api/
    build.gradle.kts           // <b class="conum">(2)</b>
 services/
    build.gradle.kts           // <b class="conum">(2)</b>
 shared/
    build.gradle.kts           // <b class="conum">(2)</b>
 settings.gradle.kts            // <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Standalone build logic project that defines convention plugins.</p>
</li>
<li>
<p>Applies shared plugin(s) from the composite build.</p>
</li>
<li>
<p>Includes build-logic as an included build.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">.
 build-logic/                // <b class="conum">(1)</b>
    build.gradle
    settings.gradle
    src/main/groovy
        java-common-conventions.gradle
 api/
    build.gradle            // <b class="conum">(2)</b>
 services/
    build.gradle            // <b class="conum">(2)</b>
 shared/
    build.gradle            // <b class="conum">(2)</b>
 settings.gradle             // <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Standalone build logic project that defines convention plugins.</p>
</li>
<li>
<p>Applies shared plugin(s) from the composite build.</p>
</li>
<li>
<p>Includes <code>build-logic</code> as an included build.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more in <a href="#composite_builds">Composite Builds</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:convention_plugins_vs_cross_configuration"><a class="anchor" href="#sec:convention_plugins_vs_cross_configuration"></a><a class="link" href="#sec:convention_plugins_vs_cross_configuration">Avoid cross-project configuration using <code>subprojects</code> and <code>allprojects</code></a></h4>
<div class="paragraph">
<p>An improper way to share build logic between subprojects is <em>cross-project configuration</em> via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#subprojects-groovy.lang.Closure-"><code>subprojects {}</code></a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#allprojects-groovy.lang.Closure-"><code>allprojects {}</code></a> DSL constructs.</p>
</div>
<div class="paragraph">
<p>With <a href="glossary.html#sub:terminology_cross_configuration">cross-project configuration</a>, build logic can be injected into a subproject which is not obvious when looking at its build script.</p>
</div>
<div class="paragraph">
<p>In the long run, cross-project configuration usually grows in complexity and becomes a burden.
Cross-project configuration can also introduce configuration-time coupling between projects, which can prevent optimizations like configuration-on-demand from working properly.</p>
</div>
</div>
<div class="sect3">
<h4 id="convention_plugins_versus_cross_project_configuration"><a class="anchor" href="#convention_plugins_versus_cross_project_configuration"></a><a class="link" href="#convention_plugins_versus_cross_project_configuration">Convention plugins versus cross-project configuration</a></h4>
<div class="paragraph">
<p>The two most common uses of cross-project configuration can be better modeled using convention plugins:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Applying plugins or other configurations to subprojects of a certain type.<br>
Often, the cross-project configuration logic is <code>if subproject is of type X, then configure Y</code>.
This is equivalent to applying <code>X-conventions</code> plugin directly to a subproject.</p>
</li>
<li>
<p>Extracting information from subprojects of a certain type.<br>
This use case can be modeled using <a href="variant_aware_resolution.html#sec:variant-aware-matching">outgoing configuration variants</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="composite_builds"><a class="anchor" href="#composite_builds"></a><a class="link" href="#composite_builds">Composite Builds</a></h3>
<div class="paragraph">
<p>A composite build is a build that includes other builds.</p>
</div>
<div id="composite_build_intro" class="paragraph">
<p>A composite build is similar to a Gradle multi-project build, except that instead of including <code>subprojects</code>, entire <code>builds</code> are included.</p>
</div>
<div class="sect3">
<h4 id="defining_composite_builds"><a class="anchor" href="#defining_composite_builds"></a><a class="link" href="#defining_composite_builds">Composite Build Layout</a></h4>
<div class="paragraph">
<p>Composite builds allow you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Combine builds that are usually developed independently, for instance, when trying out a bug fix in a library that your application uses.</p>
</li>
<li>
<p>Decompose a large multi-project build into smaller, more isolated chunks that can be worked on independently or together as needed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A build that is included in a composite build is referred to as an <strong>included build</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/structuring-builds-4.png" alt="structuring builds 4">
</div>
</div>
<div class="paragraph">
<p>Included builds do not share any configuration with the composite build or the other included builds.
Each included build is configured and executed in isolation.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how two Gradle builds, normally developed separately, can be combined into a composite build:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">my-composite
 settings.gradle.kts
 build.gradle.kts
 my-app
    settings.gradle.kts
    app
        build.gradle.kts
        src/main/java/org/sample/my-app/Main.java
 my-utils
     settings.gradle.kts
     number-utils
        build.gradle.kts
        src/main/java/org/sample/numberutils/Numbers.java
     string-utils
         build.gradle.kts
         src/main/java/org/sample/stringutils/Strings.java</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">my-composite
 settings.gradle
 build.gradle
 my-app
    settings.gradle
    app
        build.gradle
        src/main/java/org/sample/my-app/Main.java
 my-utils
     settings.gradle
     number-utils
        build.gradle
        src/main/java/org/sample/numberutils/Numbers.java
     string-utils
         build.gradle
         src/main/java/org/sample/stringutils/Strings.java</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>my-utils</code> multi-project build produces two Java libraries, <code>number-utils</code> and <code>string-utils</code>.
The <code>my-app</code> build produces an executable using functions from those libraries.</p>
</div>
<div class="paragraph">
<p>The <code>my-app</code> build does not depend directly on <code>my-utils</code>.
Instead, it declares binary dependencies on the libraries produced by <code>my-utils</code>:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/samples/build-organization/composite-builds/basic">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">my-app/app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("application")
}

application {
    mainClass = "org.sample.myapp.Main"
}

dependencies {
    implementation("org.sample:number-utils:1.0")
    implementation("org.sample:string-utils:1.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">my-app/app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
}

application {
    mainClass = 'org.sample.myapp.Main'
}

dependencies {
    implementation 'org.sample:number-utils:1.0'
    implementation 'org.sample:string-utils:1.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="command_line_composite"><a class="anchor" href="#command_line_composite"></a><a class="link" href="#command_line_composite">Defining a Composite Build via <code>--include-build</code></a></h4>
<div class="paragraph">
<p>The <code>--include-build</code> command-line argument turns the executed build into a composite, substituting dependencies from the included build into the executed build.</p>
</div>
<div class="paragraph">
<p>For example, the output of <code>./gradlew run --include-build ../my-utils</code> run from <code>my-app</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew --include-build ../my-utils run
link:https://docs.gradle.org/9.1.0/samples/build-organization/composite-builds/basic/tests/basicCli.out[role=include]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="settings_defined_composite"><a class="anchor" href="#settings_defined_composite"></a><a class="link" href="#settings_defined_composite">Defining a Composite Build via the Settings file</a></h4>
<div class="paragraph">
<p>It&#8217;s possible to make the above arrangement persistent by using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:includeBuild(java.lang.Object)">Settings.includeBuild(java.lang.Object)</a> to declare the included build in the <code>settings.gradle(.kts)</code> file.</p>
</div>
<div class="paragraph">
<p>The settings file can be used to add subprojects and included builds simultaneously.</p>
</div>
<div class="paragraph">
<p>Included builds are added by location:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">includeBuild("my-utils")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">includeBuild 'my-utils'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="separate_composite" class="paragraph">
<p>In the example, the settings.gradle(.kts) file combines otherwise separate builds:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/samples/build-organization/composite-builds/basic">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "my-composite"

includeBuild("my-app")
includeBuild("my-utils")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'my-composite'

includeBuild 'my-app'
includeBuild 'my-utils'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To execute the <code>run</code> task in the <code>my-app</code> build from <code>my-composite</code>, run <code>./gradlew my-app:app:run</code>.</p>
</div>
<div class="paragraph">
<p>You can optionally define a <code>run</code> task in <code>my-composite</code> that depends on <code>my-app:app:run</code> so that you can execute <code>./gradlew run</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("run") {
    dependsOn(gradle.includedBuild("my-app").task(":app:run"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('run') {
    dependsOn gradle.includedBuild('my-app').task(':app:run')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="included_plugin_builds"><a class="anchor" href="#included_plugin_builds"></a><a class="link" href="#included_plugin_builds">Including Builds that define Gradle Plugins</a></h5>
<div class="paragraph">
<p>A special case of included builds are builds that define Gradle plugins.</p>
</div>
<div class="paragraph">
<p>These builds should be included using the <code>includeBuild</code> statement inside the <code>pluginManagement {}</code> block of the settings file.</p>
</div>
<div class="paragraph">
<p>Using this mechanism, the included build may also contribute a settings plugin that can be applied in the settings file itself:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/developingPlugins/testingPlugins">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">pluginManagement {
    includeBuild("../url-verifier-plugin")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">pluginManagement {
    includeBuild '../url-verifier-plugin'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="included_builds"><a class="anchor" href="#included_builds"></a><a class="link" href="#included_builds">Restrictions on Included Builds</a></h4>
<div class="paragraph">
<p>Most builds can be included in a composite, including other composite builds.
There are some restrictions.</p>
</div>
<div class="paragraph">
<p>In a regular build, Gradle ensures that each project has a unique <em>project path</em>.
It makes projects identifiable and addressable without conflicts.</p>
</div>
<div class="paragraph">
<p>In a composite build, Gradle adds additional qualification to each project from an included build to avoid project path conflicts.
The full path to identify a project in a composite build is called a <em>build-tree path</em>.
It consists of a <em>build path</em> of an included build and a <em>project path</em> of the project.</p>
</div>
<div class="paragraph">
<p>By default, build paths and project paths are derived from directory names and structure on disk.
Since included builds can be located anywhere on disk, their build path is determined by the name of the containing directory.
This can sometimes lead to conflicts.</p>
</div>
<div class="paragraph">
<p>To summarize, the included builds must fulfill these requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each included build must have a unique build path.</p>
</li>
<li>
<p>Each included build path must not conflict with any project path of the main build.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These conditions guarantee that each project can be uniquely identified even in a composite build.</p>
</div>
<div class="paragraph">
<p>If conflicts arise, the way to resolve them is by changing the <em>build name</em> of an included build:</p>
</div>
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">includeBuild("some-included-build") {
    name = "other-name"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When a composite build is included in another composite build, both builds have the same parent.
In other words, the nested composite build structure is flattened.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="interacting_with_composite_builds"><a class="anchor" href="#interacting_with_composite_builds"></a><a class="link" href="#interacting_with_composite_builds">Interacting with a Composite Build</a></h4>
<div class="paragraph">
<p>Interacting with a composite build is generally similar to a regular multi-project build.
Tasks can be executed, tests can be run, and builds can be imported into the IDE.</p>
</div>
<div class="sect4">
<h5 id="composite_build_executing_tasks"><a class="anchor" href="#composite_build_executing_tasks"></a><a class="link" href="#composite_build_executing_tasks">Executing tasks</a></h5>
<div class="paragraph">
<p>Tasks from an included build can be executed from the command-line or IDE in the same way as tasks from a regular multi-project build.
Executing a task will result in task dependencies being executed, as well as those tasks required to build dependency artifacts from other included builds.</p>
</div>
<div class="paragraph">
<p>You can call a task in an included build using a fully qualified path, for example, <code>:included-build-name:project-name:taskName</code>.
Project and task names can be <a href="#sec:name_abbreviation">abbreviated</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew :included-build:subproject-a:compileJava
&gt; Task :included-build:subproject-a:compileJava

$ ./gradlew :i-b:sA:cJ
&gt; Task :included-build:subproject-a:compileJava</pre>
</div>
</div>
<div class="paragraph">
<p>To <a href="#sec:excluding_tasks_from_the_command_line">exclude a task from the command line</a>, you need to provide the fully qualified path to the task.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Included build tasks are automatically executed to generate required dependency artifacts, or the <a href="#included_build_task_dependencies">including build can declare a dependency on a task from an included build</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="composite_build_ide_integration"><a class="anchor" href="#composite_build_ide_integration"></a><a class="link" href="#composite_build_ide_integration">Importing into the IDE</a></h5>
<div class="paragraph">
<p>One of the most useful features of composite builds is IDE integration.</p>
</div>
<div class="paragraph">
<p>Importing a composite build permits sources from separate Gradle builds to be easily developed together.
For every included build, each subproject is included as an IntelliJ IDEA Module or Eclipse Project.
Source dependencies are configured, providing cross-build navigation and refactoring.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="included_build_declaring_substitutions"><a class="anchor" href="#included_build_declaring_substitutions"></a><a class="link" href="#included_build_declaring_substitutions">Declaring dependencies substituted by an Included Build</a></h4>
<div class="paragraph">
<p>By default, Gradle will configure each included build to determine the dependencies it can provide.
The algorithm for doing this is simple.
Gradle will inspect the group and name for the projects in the included build and substitute project dependencies for any external dependency matching <code>${project.group}:${project.name}</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, substitutions are not registered for the <em>main</em> build.</p>
</div>
<div class="paragraph">
<p>To make the (sub)projects of the main build addressable by <code>${project.group}:${project.name}</code>, you can tell Gradle to treat the main build like an included build by self-including it: <code>includeBuild(".")</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are cases when the default substitutions determined by Gradle are insufficient or must be corrected for a particular composite.
For these cases, explicitly declaring the substitutions for an included build is possible.</p>
</div>
<div class="paragraph">
<p>For example, a single-project build called <code>anonymous-library</code>, produces a Java utility library but does not declare a value for the group attribute:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/samples/build-organization/composite-builds/declared-substitution">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    java
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When this build is included in a composite, it will attempt to substitute for the dependency module <code>undefined:anonymous-library</code> (<code>undefined</code> being the default value for <code>project.group</code>, and <code>anonymous-library</code> being the root project name).
Clearly, this isn&#8217;t useful in a composite build.</p>
</div>
<div class="paragraph">
<p>To use the unpublished library in a composite build, you can explicitly declare the substitutions that it provides:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">includeBuild("anonymous-library") {
    dependencySubstitution {
        substitute(module("org.sample:number-utils")).using(project(":"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">includeBuild('anonymous-library') {
    dependencySubstitution {
        substitute module('org.sample:number-utils') using project(':')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this configuration, the <code>my-app</code> composite build will substitute any dependency on <code>org.sample:number-utils</code> with a dependency on the root project of <code>anonymous-library</code>.</p>
</div>
<div class="sect4">
<h5 id="deactivate_included_build_substitutions"><a class="anchor" href="#deactivate_included_build_substitutions"></a><a class="link" href="#deactivate_included_build_substitutions">Deactivate included build substitutions for a configuration</a></h5>
<div class="paragraph">
<p>If you need to <a href="#sec:resolvable-consumable-configs">resolve</a> a published version of a module that is also available as part of an included build, you can deactivate the included build substitution rules on the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> of the Configuration that is resolved.
This is necessary because the rules are globally applied in the build, and Gradle does not consider published versions during resolution by default.</p>
</div>
<div class="paragraph">
<p>For example, we create a separate <code>publishedRuntimeClasspath</code> configuration that gets resolved to the published versions of modules that also exist in one of the local builds.
This is done by deactivating global dependency substitution rules:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/snippets/dependencyManagement/customizingResolution-deactivateGlobalSubstitution">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.create("publishedRuntimeClasspath") {
    resolutionStrategy.useGlobalDependencySubstitutionRules = false

    extendsFrom(configurations.runtimeClasspath.get())
    isCanBeConsumed = false
    attributes.attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.create('publishedRuntimeClasspath') {
    resolutionStrategy.useGlobalDependencySubstitutionRules = false

    extendsFrom(configurations.runtimeClasspath)
    canBeConsumed = false
    attributes.attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A use-case would be to compare published and locally built JAR files.</p>
</div>
</div>
<div class="sect4">
<h5 id="included_build_substitution_requirements"><a class="anchor" href="#included_build_substitution_requirements"></a><a class="link" href="#included_build_substitution_requirements">Cases where included build substitutions must be declared</a></h5>
<div class="paragraph">
<p>Many builds will function automatically as an included build, without declared substitutions.
Here are some common cases where declared substitutions are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the <code>archivesBaseName</code> property is used to set the name of the published artifact.</p>
</li>
<li>
<p>When a configuration other than <code>default</code> is published.</p>
</li>
<li>
<p>When the <code>MavenPom.addFilter()</code> is used to publish artifacts that don&#8217;t match the project name.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used for publishing and the publication coordinates don&#8217;t match <code>${project.group}:${project.name}</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="included_build_substitution_limitations"><a class="anchor" href="#included_build_substitution_limitations"></a><a class="link" href="#included_build_substitution_limitations">Cases where composite build substitutions won&#8217;t work</a></h5>
<div class="paragraph">
<p>Some builds won&#8217;t function correctly when included in a composite, even when dependency substitutions are explicitly declared.
This limitation is because a substituted project dependency will always point to the <code>default</code> configuration of the target project.
Any time the artifacts and dependencies specified for the default configuration of a project don&#8217;t match what is published to a repository, the composite build may exhibit different behavior.</p>
</div>
<div class="paragraph">
<p>Here are some cases where the published module metadata may be different from the project default configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a configuration other than <code>default</code> is published.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used.</p>
</li>
<li>
<p>When the <code>POM</code> or <code>ivy.xml</code> file is tweaked as part of publication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Builds using these features function incorrectly when included in a composite build.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="included_build_task_dependencies"><a class="anchor" href="#included_build_task_dependencies"></a><a class="link" href="#included_build_task_dependencies">Depending on Tasks in an Included Build</a></h4>
<div class="paragraph">
<p>While included builds are isolated from one another and cannot declare direct dependencies, a composite build can declare task dependencies on its included builds.
The included builds are accessed using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuilds">Gradle.getIncludedBuilds()</a> or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuild(java.lang.String)">Gradle.includedBuild(java.lang.String)</a>, and a task reference is obtained via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.IncludedBuild.html#org.gradle.api.initialization.IncludedBuild:task(java.lang.String)">IncludedBuild.task(java.lang.String)</a> method.</p>
</div>
<div class="paragraph">
<p>Using these APIs, it is possible to declare a dependency on a task in a particular included build:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/samples/build-organization/composite-builds/basic">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("run") {
    dependsOn(gradle.includedBuild("my-app").task(":app:run"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('run') {
    dependsOn gradle.includedBuild('my-app').task(':app:run')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or you can declare a dependency on tasks with a certain path in some or all of the included builds:</p>
</div>
<div style="text-align: right;">
  <a href="https://github.com/gradle/gradle/tree/master/platforms/documentation/docs/src/samples/build-organization/composite-builds/hierarchical-multirepo">
    <img src="https://img.shields.io/badge/View%20full%20project-GitHub-blue?logo=github&style=flat" alt="View full sample project on GitHub"/>
  </a>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("publishDeps") {
    dependsOn(gradle.includedBuilds.map { it.task(":publishMavenPublicationToMavenRepository") })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('publishDeps') {
    dependsOn gradle.includedBuilds*.task(':publishMavenPublicationToMavenRepository')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="current_limitations_and_future_work"><a class="anchor" href="#current_limitations_and_future_work"></a><a class="link" href="#current_limitations_and_future_work">Limitations of Composite Builds</a></h4>
<div class="paragraph">
<p>Limitations of the current implementation include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No support for included builds with publications that don&#8217;t mirror the project default configuration.<br>
See <a href="#included_build_substitution_limitations">Cases where composite builds won&#8217;t work</a>.</p>
</li>
<li>
<p>Multiple composite builds may conflict when run in parallel if more than one includes the same build.<br>
Gradle does not share the project lock of a shared composite build between Gradle invocations to prevent concurrent execution.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration_and_execution"><a class="anchor" href="#configuration_and_execution"></a><a class="link" href="#configuration_and_execution">Configuration On Demand</a></h3>
<div class="paragraph">
<p>Configuration-on-demand attempts to configure only the relevant projects for the requested tasks, i.e., it only evaluates the build script file of projects participating in the build.
This way, the configuration time of a large multi-project build can be reduced.</p>
</div>
<div class="paragraph">
<p>The configuration-on-demand feature is <em>incubating</em>, so only some builds are guaranteed to work correctly.
The feature works well for <a href="#sec:decoupled_projects">decoupled</a> multi-project builds.</p>
</div>
<div class="paragraph">
<p>In configuration-on-demand mode, projects are configured as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The root project is always configured.</p>
</li>
<li>
<p>The project in the directory where the build is executed is also configured, but only when Gradle is executed without any tasks.<br>
This way, the default tasks behave correctly when projects are configured on demand.</p>
</li>
<li>
<p>The standard project dependencies are supported, and relevant projects are configured.<br>
If project A has a compile dependency on project B, then building A causes the configuration of both projects.</p>
</li>
<li>
<p>The task dependencies declared via the task path are supported and cause relevant projects to be configured.<br>
Example: <code>someTask.dependsOn(":some-other-project:someOtherTask")</code></p>
</li>
<li>
<p>A task requested via task path from the command line (or tooling API) causes the relevant project to be configured.<br>
For example, building <code>project-a:project-b:someTask</code> causes configuration of <code>project-b</code>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec:configuration_on_demand"><a class="anchor" href="#sec:configuration_on_demand"></a><a class="link" href="#sec:configuration_on_demand">Enable <code>configuration-on-demand</code></a></h4>
<div class="paragraph">
<p>You can enable configuration-on-demand using the <code>--configure-on-demand</code> flag or adding <code>org.gradle.configureondemand=true</code> to the <code>gradle.properties</code> file.</p>
</div>
<div class="paragraph">
<p>To configure on demand with every build run, see <a href="#sec:gradle_configuration_properties">Gradle properties</a>.</p>
</div>
<div class="paragraph">
<p>To configure on demand for a given build, see <a href="#sec:command_line_performance">command-line performance-oriented options</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:decoupled_projects"><a class="anchor" href="#sec:decoupled_projects"></a><a class="link" href="#sec:decoupled_projects">Decoupled projects</a></h4>
<div class="paragraph">
<p>Gradle allows projects to access each other&#8217;s configurations and tasks during the configuration and execution phases.
While this flexibility empowers build authors, it limits Gradle&#8217;s ability to perform optimizations such as <a href="#sec:parallel_execution">parallel project builds</a> and <a href="#configuration_and_execution">configuration on demand</a>.</p>
</div>
<div class="paragraph">
<p>Projects are considered decoupled when they interact solely through declared dependencies and task dependencies.
Any direct modification or reading of another project&#8217;s object creates coupling between the projects.
Coupling during configuration can result in flawed build outcomes when using 'configuration on demand', while coupling during execution can affect parallel execution.</p>
</div>
<div class="paragraph">
<p>One common source of coupling is configuration injection, such as using <code>allprojects{}</code> or <code>subprojects{}</code> in build scripts.</p>
</div>
<div class="paragraph">
<p>To avoid coupling issues, it&#8217;s recommended to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Refrain from referencing other subprojects' build scripts and prefer <a href="glossary.html#sub:terminology_cross_project_configuration">cross-project configuration</a> from the root project.</p>
</li>
<li>
<p>Avoid dynamically changing other projects' configurations during execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As Gradle evolves, it aims to provide features that leverage decoupled projects while offering solutions for common use cases like configuration injection without introducing coupling.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:parallel_execution"><a class="anchor" href="#sec:parallel_execution"></a><a class="link" href="#sec:parallel_execution">Parallel projects</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s parallel execution feature optimizes CPU utilization to accelerate builds by concurrently executing tasks from different projects.</p>
</div>
<div class="paragraph">
<p>To enable parallel execution, use the <code>--parallel</code> <a href="#sec:command_line_performance">command-line argument</a> or configure your <a href="#sec:gradle_configuration_properties">build environment</a>.
Gradle automatically determines the optimal number of parallel threads based on CPU cores.</p>
</div>
<div class="paragraph">
<p>During parallel execution, each worker handles a specific project exclusively.
Task dependencies are respected, with workers prioritizing upstream tasks.
However, tasks may not execute in alphabetical order, as in sequential mode.
It&#8217;s crucial to correctly declare task dependencies and inputs/outputs to avoid ordering issues.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="isolated_projects"><a class="anchor" href="#isolated_projects"></a><a class="link" href="#isolated_projects">Isolated Projects</a></h3>
<div class="paragraph">
<p>Isolated Projects is a pre-alpha Gradle feature that extends the configuration cache to further improve performance, particularly the performance of Android Studio and IDEA sync.</p>
</div>
<div class="paragraph">
<p>When Isolated Projects is enabled, the configuration model of Gradle projects are "isolated" from each other.
This means that build logic, such as build scripts or plugins, applied to a project cannot directly access the mutable state of another project.
This allows configuration and tooling model creation for each project to safely run in parallel, with the result cached and invalidated independently for each project.</p>
</div>
<div class="sect3">
<h4 id="status_as_of_gradle_8_11"><a class="anchor" href="#status_as_of_gradle_8_11"></a><a class="link" href="#status_as_of_gradle_8_11">Status as of Gradle 8.11</a></h4>
<div class="paragraph">
<p>When Isolated Projects is enabled, Gradle applies two levels of caching during IDE sync:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gradle starts by applying coarse-grained caching.</p>
<div class="paragraph">
<p>To do this, Gradle caches the result of the entire sync operation and reuses it when nothing that affects the IDE model has changed.
When the cache entry can be reused, Gradle short-circuits the entire sync operation and returns the cached result to the IDE.</p>
</div>
</li>
<li>
<p>Generally, the settings and build scripts affect the IDE model, but the project&#8217;s source code does not.
So, when these scripts change, the cache entry cannot be reused.
When this happens, Gradle falls back to fine-grained caching.</p>
<div class="paragraph">
<p>To do this, Gradle caches the result of creating the tooling models for each project and reuses these models when nothing that affects them has changed.
When a project&#8217;s cached models can be reused, Gradle short-circuits all work on that project, including the configuration phase and other work such as dependency resolution.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This means that Gradle will only configure and create tooling models for projects whose configuration has changed.
This work is done in parallel for each project.</p>
</div>
</div>
<div class="sect3">
<h4 id="current_limitations"><a class="anchor" href="#current_limitations"></a><a class="link" href="#current_limitations">Current limitations</a></h4>
<div class="paragraph">
<p>Isolated Projects is a pre-alpha feature, and as such, the current implementation has a number of limitations.
These will be addressed in future Gradle releases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle, IntelliJ IDEA, Android Studio, and Kotlin plugins are not yet 100% compatible with Isolated Projects, so you should expect to see some violations reported. The teams are actively working on fixing these incompatibilities.</p>
</li>
<li>
<p>Parallel configuration does not support <a href="#sec:configuration_on_demand">Configuration on Demand</a>. All projects will be configured, even if they aren&#8217;t running tasks.</p>
</li>
<li>
<p>Changes to included builds invalidate all cached results, even when the change would not affect the cached results.</p>
</li>
<li>
<p>The implementation does not exploit the isolation to limit peak memory consumption. Currently, peak memory consumption is a function of how many projects must be configured.</p>
</li>
<li>
<p>All caching, including the configuration cache, is done on the local machine. Remote caching is not supported yet.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="how_do_i_use_it"><a class="anchor" href="#how_do_i_use_it"></a><a class="link" href="#how_do_i_use_it">How do I use it?</a></h4>
<div class="paragraph">
<p>You will need Gradle 8.5 or later to use Isolated Projects, preferably a recent nightly.
You should also use the most recent version of IDEA or Android Studio.</p>
</div>
<div class="paragraph">
<p>The feature is off by default.
You can enable it by setting the <code>org.gradle.unsafe.isolated-projects</code> Gradle property to <code>true</code>.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle build -Dorg.gradle.unsafe.isolated-projects=true</pre>
</div>
</div>
<div class="paragraph">
<p>When enabled, Gradle will fail the build whenever build logic attempts to cross project boundaries and access the model of another project.
Gradle collects all of these access problems in the configuration cache report, as it does other problems.</p>
</div>
<div class="paragraph">
<p>The configuration cache command-line options can be used to control how Gradle handles these problems. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--configuration-cache-problems=warn</code> can be used to treat access problems as warnings instead of errors.</p>
</li>
<li>
<p><code>-Dorg.gradle.configuration-cache.max-problems=x</code> can be used to increase the maximum number of problems included in the report.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also use <code>-Dorg.gradle.internal.invalidate-coupled-projects=false</code> to force parallel configuration when there are access problems.</p>
</div>
<div class="paragraph">
<p>Note that these options disable the validation that makes execution parallel- and caching-safe when Isolated Projects is enabled, so you may see some unexpected behavior when using them.</p>
</div>
</div>
<div class="sect3">
<h4 id="build_logic_constraints"><a class="anchor" href="#build_logic_constraints"></a><a class="link" href="#build_logic_constraints">Build logic constraints</a></h4>
<div class="paragraph">
<p>Isolated Projects prevents build logic from accessing the state of another project.
This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using most methods on the <code>Project</code> type. A small number of methods that return immutable information about the project are allowed:</p>
<div class="ulist">
<ul>
<li>
<p><code>getName()</code></p>
</li>
<li>
<p><code>getPath()</code></p>
</li>
<li>
<p><code>getBuildTreePath()</code></p>
</li>
<li>
<p><code>getProjectDir()</code></p>
</li>
<li>
<p><code>getRootDir()</code></p>
</li>
<li>
<p><code>getChildProjects()</code></p>
</li>
<li>
<p><code>getSubprojects()</code></p>
</li>
<li>
<p><code>getAllProjects()</code></p>
</li>
<li>
<p><code>project()</code> overloads</p>
</li>
<li>
<p><code>subprojects()</code> overloads</p>
</li>
<li>
<p><code>allprojects()</code> overloads</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that Isolated Projects is a pre-alpha feature.
These constraints are not final and can change at any time.</p>
</div>
</div>
<div class="sect3">
<h4 id="changelog"><a class="anchor" href="#changelog"></a><a class="link" href="#changelog">ChangeLog</a></h4>
<div class="sect4">
<h5 id="gradle_8_11"><a class="anchor" href="#gradle_8_11"></a><a class="link" href="#gradle_8_11">Gradle 8.11</a></h5>
<div class="sect5">
<h6 id="projects_configured_in_parallel"><a class="anchor" href="#projects_configured_in_parallel"></a><a class="link" href="#projects_configured_in_parallel">Projects configured in parallel</a></h6>
<div class="paragraph">
<p>When building from the command line (i.e. for task execution) with Isolated Projects enabled, projects are now configured in parallel.</p>
</div>
<div class="paragraph">
<p>Parallel configuration does not yet support Configuration on Demand. All projects will be configured, even those which have no tasks to run.
If this tradeoff is undesirable and you want projects to configure serially with Configure on Demand, set the
<code>org.gradle.internal.isolated-projects.configure-on-demand.tasks</code> system property to <code>true</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="gradle_8_9"><a class="anchor" href="#gradle_8_9"></a><a class="link" href="#gradle_8_9">Gradle 8.9</a></h5>
<div class="sect5">
<h6 id="lift_restriction_on_string_based_task_dependency_notation"><a class="anchor" href="#lift_restriction_on_string_based_task_dependency_notation"></a><a class="link" href="#lift_restriction_on_string_based_task_dependency_notation">Lift restriction on string-based task dependency notation</a></h6>
<div class="paragraph">
<p>Depending on a task from another project in string-notated form is a common idiom:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">foo.dependsOn(":a:bar")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starting with this release, this is no longer considered a violation of Isolated Projects boundaries.</p>
</div>
</div>
<div class="sect5">
<h6 id="gradle_init_generates_isolated_projects_compatible_projects"><a class="anchor" href="#gradle_init_generates_isolated_projects_compatible_projects"></a><a class="link" href="#gradle_init_generates_isolated_projects_compatible_projects"><code>gradle init</code> generates Isolated Projects compatible projects</a></h6>
<div class="paragraph">
<p>The <a href="build_init_plugin.html#build_init_plugin">Build Init Plugin</a> supports creating multi-module projects.</p>
</div>
<div class="paragraph">
<p>Starting with this release, <code>gradle init</code> generates projects compatible with Isolated Projects restrictions.</p>
</div>
</div>
<div class="sect5">
<h6 id="isolatedproject_provides_a_project_identifier_in_composite_builds"><a class="anchor" href="#isolatedproject_provides_a_project_identifier_in_composite_builds"></a><a class="link" href="#isolatedproject_provides_a_project_identifier_in_composite_builds"><code>IsolatedProject</code> provides a project identifier in composite builds</a></h6>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/project/IsolatedProject.html">IsolatedProject</a> type was introduced in Gradle 8.8 to explicitly mark the project state that is safe to access across projects.</p>
</div>
<div class="paragraph">
<p>Gradle 8.9 adds a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/project/IsolatedProject.html#getBuildTreePath()"><code>buildTreePath</code></a> member, which serves as a unique project identifier in <a href="#composite_builds">composite build</a> setups.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="gradle_8_8"><a class="anchor" href="#gradle_8_8"></a><a class="link" href="#gradle_8_8">Gradle 8.8</a></h5>
<div class="sect5">
<h6 id="new_gradle_lifecycle_callbacks"><a class="anchor" href="#new_gradle_lifecycle_callbacks"></a><a class="link" href="#new_gradle_lifecycle_callbacks">New Gradle lifecycle callbacks</a></h6>
<div class="paragraph">
<p>This release introduces a new <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/invocation/GradleLifecycle.html"><code>GradleLifecycle</code></a> API, accessible via <code>gradle.lifecycle</code>, which plugin authors and build engineers can use to register actions to be executed at certain points in the build lifecycle.</p>
</div>
<div class="paragraph">
<p>Actions registered as <code>GradleLifecycle</code> callbacks (currently, <code>beforeProject</code> and <code>afterProject</code>) are <strong><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/IsolatedAction.html)">isolated</a></strong>, running in an isolated context that is private to every project.
This will allow Gradle to perform additional performance optimizations and will be required in the future to take advantage of parallelism during the build configuration phase.</p>
</div>
<div class="paragraph">
<p>While the existing callbacks continue to work, we encourage everyone to adopt the new API and provide us with early feedback.</p>
</div>
<div class="paragraph">
<p>The example below shows how this new API could be used in a settings script or <a href="#project_vs_settings_vs_init_plugins">settings plugins</a> to apply configuration to all projects,
while avoiding <a href="#sec:convention_plugins_vs_cross_configuration">cross-project configuration</a>:</p>
</div>
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">include("sub1")
include("sub2")

gradle.lifecycle.beforeProject {
    apply(plugin = "base")
    repositories {
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="isolated_project_views"><a class="anchor" href="#isolated_project_views"></a><a class="link" href="#isolated_project_views">Isolated project views</a></h6>
<div class="paragraph">
<p>There is now support for obtaining an isolated view of a project as an   <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/project/IsolatedProject.html"><code>IsolatedProject</code></a> via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#getIsolated--"><code>Project.getIsolated()</code></a>.</p>
</div>
<div class="paragraph">
<p>The view exposes only those properties that are safe to access across project boundaries when running the build configuration phase in parallel (to be supported in a future release).</p>
</div>
<div class="paragraph">
<p>The example below shows how the API could be used from a <code>Project</code> configuration callback to query the root project directory in a parallel-safe way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradle.lifecycle.beforeProject {
    val rootDir = project.isolated.rootProject.projectDirectory
    println("The root project directory is $rootDir")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developing_tasks"><a class="anchor" href="#developing_tasks"></a><a class="link" href="#developing_tasks">DEVELOPING TASKS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="more_about_tasks"><a class="anchor" href="#more_about_tasks"></a><a class="link" href="#more_about_tasks">Understanding Tasks</a></h3>
<div class="paragraph">
<p>A task represents some <strong>independent unit of work</strong> that a build performs, such as compiling classes, creating a JAR, generating Javadoc, or publishing archives to a repository.</p>
</div>
<p>
  <div style="position:relative;padding-top:56.25%;">
    <iframe src="https://www.youtube-nocookie.com/embed/FB5muea-2Z0?si=XcoZGjrw0KD5FSIJ&rel=0" frameborder="0" allowfullscreen
      style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
  </div>
</p>
<div class="paragraph">
<p>Before reading this chapter, it&#8217;s recommended that you first read the <a href="gradle_directories_intermediate.html#gradle_directories">Learning The Basics</a> and complete the <a href="part1_gradle_init_project.html#part1_gradle_init">Tutorial</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:more_listing_tasks"><a class="anchor" href="#sec:more_listing_tasks"></a><a class="link" href="#sec:more_listing_tasks">Listing tasks</a></h4>
<div class="paragraph">
<p>All available tasks in your project come from Gradle plugins and build scripts.</p>
</div>
<div class="paragraph">
<p>You can list all the available tasks in a project by running the following command in the terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew tasks</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a very basic Gradle project as an example.
The project has the following structure:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradle-project
 app
    build.gradle.kts    // empty file - no build logic
    ...                 // some java code
 settings.gradle.kts     // includes app subproject
 gradle
    ...
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradle-project
 app
    build.gradle    // empty file - no build logic
    ...             // some java code
 settings.gradle     // includes app subproject
 gradle
    ...
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The settings file contains the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "gradle-project"
include("app")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'gradle-project'
include('app')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Currently, the <code>app</code> subproject&#8217;s build file is empty.</p>
</div>
<div class="paragraph">
<p>To see the tasks available in the <code>app</code> subproject, run <code>./gradlew :app:tasks</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Help tasks
----------
buildEnvironment - Displays all buildscript dependencies declared in project ':app'.
dependencies - Displays all dependencies declared in project ':app'.
dependencyInsight - Displays the insight into a specific dependency in project ':app'.
help - Displays a help message.
javaToolchains - Displays the detected java toolchains.
kotlinDslAccessorsReport - Prints the Kotlin code for accessing the currently available project extensions and conventions.
outgoingVariants - Displays the outgoing variants of project ':app'.
projects - Displays the sub-projects of project ':app'.
properties - Displays the properties of project ':app'.
resolvableConfigurations - Displays the configurations that can be resolved in project ':app'.
tasks - Displays the tasks runnable from project ':app'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We observe that only a small number of help tasks are available at the moment.
This is because the core of Gradle only provides tasks that analyze your build.
Other tasks, such as the those that build your project or compile your code, are added by plugins.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s explore this by adding the <a href="base_plugin.html#base_plugin">Gradle core <code>base</code> plugin</a> to the <code>app</code> build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("base")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('base')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>base</code> plugin adds central lifecycle tasks.
Now when we run <code>./gradlew app:tasks</code>, we can see the <code>assemble</code> and <code>build</code> tasks are available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Build tasks
-----------
assemble - Assembles the outputs of this project.
build - Assembles and tests this project.
clean - Deletes the build directory.

Help tasks
----------
buildEnvironment - Displays all buildscript dependencies declared in project ':app'.
dependencies - Displays all dependencies declared in project ':app'.
dependencyInsight - Displays the insight into a specific dependency in project ':app'.
help - Displays a help message.
javaToolchains - Displays the detected java toolchains.
outgoingVariants - Displays the outgoing variants of project ':app'.
projects - Displays the sub-projects of project ':app'.
properties - Displays the properties of project ':app'.
resolvableConfigurations - Displays the configurations that can be resolved in project ':app'.
tasks - Displays the tasks runnable from project ':app'.

Verification tasks
------------------
check - Runs all checks.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_outcomes"><a class="anchor" href="#sec:task_outcomes"></a><a class="link" href="#sec:task_outcomes">Task outcomes</a></h4>
<div class="paragraph">
<p>When Gradle executes a task, it labels the task with outcomes via the console.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/author-tasks-1.png" alt="author tasks 1">
</div>
</div>
<div class="paragraph">
<p>These labels are based on whether a task has actions to execute and if Gradle executed them.
Actions include, but are not limited to, compiling code, zipping files, and publishing archives.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>(no label)</code> or <code>EXECUTED</code></dt>
<dd>
<p><strong>Task executed its actions.</strong></p>
<div class="ulist">
<ul>
<li>
<p>Task has actions and Gradle executed them.</p>
</li>
<li>
<p>Task has no actions and some dependencies, and Gradle executed one or more of the dependencies. See also <a href="#sec:lifecycle_tasks">Lifecycle Tasks</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>UP-TO-DATE</code></dt>
<dd>
<p><strong>Task&#8217;s outputs did not change.</strong></p>
<div class="ulist">
<ul>
<li>
<p>Task has outputs and inputs but they have not changed. See <a href="incremental_build.html#incremental_build">Incremental Build</a>.</p>
</li>
<li>
<p>Task has actions, but the task tells Gradle it did not change its outputs.</p>
</li>
<li>
<p>Task has no actions and some dependencies, but all the dependencies are <code>UP-TO-DATE</code>, <code>SKIPPED</code> or <code>FROM-CACHE</code>. See <a href="#sec:lifecycle_tasks">Lifecycle Tasks</a>.</p>
</li>
<li>
<p>Task has no actions and no dependencies.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>FROM-CACHE</code></dt>
<dd>
<p><strong>Task&#8217;s outputs could be found from a previous execution.</strong></p>
<div class="ulist">
<ul>
<li>
<p>Task has outputs restored from the build cache. See <a href="#build_cache">Build Cache</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>SKIPPED</code></dt>
<dd>
<p><strong>Task did not execute its actions.</strong></p>
<div class="ulist">
<ul>
<li>
<p>Task has been explicitly excluded from the command-line. See <a href="#sec:excluding_tasks_from_the_command_line">Excluding tasks from execution</a>.</p>
</li>
<li>
<p>Task has an <code>onlyIf</code> predicate return false. See <a href="#sec:using_a_predicate">Using a predicate</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>NO-SOURCE</code></dt>
<dd>
<p><strong>Task did not need to execute its actions.</strong></p>
<div class="ulist">
<ul>
<li>
<p>Task has inputs and outputs, but <a href="incremental_build.html#skip-when-empty">no sources</a> (i.e., inputs were not found).</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_groups"><a class="anchor" href="#sec:task_groups"></a><a class="link" href="#sec:task_groups">Task group and description</a></h4>
<div class="paragraph">
<p>Task groups and descriptions are used to organize and describe tasks.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Groups </dt>
<dd>
<p>Task groups are used to categorize tasks. When you run <code>./gradlew tasks</code>, tasks are listed under their respective groups, making it easier to understand their purpose and relationship to other tasks. Groups are set using the <code>group</code> property.</p>
</dd>
<dt class="hdlist1">Descriptions </dt>
<dd>
<p>Descriptions provide a brief explanation of what a task does. When you run <code>./gradlew tasks</code>, the descriptions are shown next to each task, helping you understand its purpose and how to use it. Descriptions are set using the <code>description</code> property.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Let&#8217;s consider a basic Java application as an example.
The build contains a subproject called <code>app</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s list the available tasks in <code>app</code> at the moment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Application tasks
-----------------
run - Runs this project as a JVM application.

Build tasks
-----------
assemble - Assembles the outputs of this project.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the <code>:run</code> task is part of the <code>Application</code> group with the description <code>Runs this project as a JVM application</code>.
In code, it would look something like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("run") {
    group = "Application"
    description = "Runs this project as a JVM application."
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("run") {
    group = "Application"
    description = "Runs this project as a JVM application."
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:hidden_tasks"><a class="anchor" href="#sec:hidden_tasks"></a><a class="link" href="#sec:hidden_tasks">Private and hidden tasks</a></h4>
<div class="paragraph">
<p>Gradle doesn&#8217;t support marking a task as <em>private</em>.</p>
</div>
<div class="paragraph">
<p>However, tasks will only show up when running <code>:tasks</code> if <code>task.group</code> is set or no other task depends on it.</p>
</div>
<div class="paragraph">
<p>For instance, the following task will not appear when running <code>./gradlew :app:tasks</code> because it does not have a group; it is called a <em>hidden</em> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("helloTask") {
    println("Hello")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("helloTask") {
    println 'Hello'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Although <code>helloTask</code> is not listed, it can still be executed by Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Application tasks
-----------------
run - Runs this project as a JVM application

Build tasks
-----------
assemble - Assembles the outputs of this project.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s add a group to the same task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("helloTask") {
    group = "Other"
    description = "Hello task"
    println("Hello")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("helloTask") {
    group = "Other"
    description = "Hello task"
    println 'Hello'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now that the group is added, the task is visible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Application tasks
-----------------
run - Runs this project as a JVM application

Build tasks
-----------
assemble - Assembles the outputs of this project.

Other tasks
-----------
helloTask - Hello task</code></pre>
</div>
</div>
<div class="paragraph">
<p>In contrast, <code>./gradlew tasks --all</code> will show all tasks; <em>hidden</em> and <em>visible</em> tasks are listed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:grouping_tasks"><a class="anchor" href="#sec:grouping_tasks"></a><a class="link" href="#sec:grouping_tasks">Grouping tasks</a></h4>
<div class="paragraph">
<p>If you want to customize which tasks are shown to users when listed, you can group tasks and set the visibility of each group.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Remember, even if you <em>hide</em> tasks, they are still available, and Gradle can still run them.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s start with an example built by Gradle <code>init</code> for a Java application with multiple subprojects.
The project structure is as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradle-project
 app
    build.gradle.kts
    src                 // some java code
        ...
 utilities
    build.gradle.kts
    src                 // some java code
        ...
 list
    build.gradle.kts
    src                 // some java code
        ...
 buildSrc
    build.gradle.kts
    settings.gradle.kts
    src                 // common build logic
        ...
 settings.gradle.kts
 gradle
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradle-project
 app
    build.gradle
    src             // some java code
        ...
 utilities
    build.gradle
    src             // some java code
        ...
 list
    build.gradle
    src             // some java code
        ...
 buildSrc
    build.gradle
    settings.gradle
    src             // common build logic
        ...
 settings.gradle
 gradle
 gradlew
 gradlew.bat</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Run <code>app:tasks</code> to see available tasks in the <code>app</code> subproject:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Application tasks
-----------------
run - Runs this project as a JVM application

Build tasks
-----------
assemble - Assembles the outputs of this project.
build - Assembles and tests this project.
buildDependents - Assembles and tests this project and all projects that depend on it.
buildNeeded - Assembles and tests this project and all projects it depends on.
classes - Assembles main classes.
clean - Deletes the build directory.
jar - Assembles a jar archive containing the classes of the 'main' feature.
testClasses - Assembles test classes.

Distribution tasks
------------------
assembleDist - Assembles the main distributions
distTar - Bundles the project as a distribution.
distZip - Bundles the project as a distribution.
installDist - Installs the project as a distribution as-is.

Documentation tasks
-------------------
javadoc - Generates Javadoc API documentation for the 'main' feature.

Help tasks
----------
buildEnvironment - Displays all buildscript dependencies declared in project ':app'.
dependencies - Displays all dependencies declared in project ':app'.
dependencyInsight - Displays the insight into a specific dependency in project ':app'.
help - Displays a help message.
javaToolchains - Displays the detected java toolchains.
kotlinDslAccessorsReport - Prints the Kotlin code for accessing the currently available project extensions and conventions.
outgoingVariants - Displays the outgoing variants of project ':app'.
projects - Displays the sub-projects of project ':app'.
properties - Displays the properties of project ':app'.
resolvableConfigurations - Displays the configurations that can be resolved in project ':app'.
tasks - Displays the tasks runnable from project ':app'.

Verification tasks
------------------
check - Runs all checks.
test - Runs the test suite.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we look at the list of tasks available, even for a standard Java project, it&#8217;s extensive.
Many of these tasks are rarely required directly by developers using the build.</p>
</div>
<div class="paragraph">
<p>We can configure the <code>:tasks</code> task and limit the tasks shown to a certain group.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create our own group so that all tasks are hidden by default by updating the <code>app</code> build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val myBuildGroup = "my app build"               // Create a group name

tasks.register&lt;TaskReportTask&gt;("tasksAll") {    // Register the tasksAll task
group = myBuildGroup
description = "Show additional tasks."
setShowDetail(true)
}

tasks.named&lt;TaskReportTask&gt;("tasks") {          // Move all existing tasks to the group
displayGroup = myBuildGroup
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def myBuildGroup = "my app build"               // Create a group name

tasks.register("tasksAll", TaskReportTask) {    // Register the tasksAll task
    group = myBuildGroup
    description = "Show additional tasks."
    setShowDetail(true)
}

tasks.named("tasks", TaskReportTask) {          // Move all existing tasks to the group
    displayGroup = myBuildGroup
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now, when we list tasks available in <code>app</code>, the list is shorter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

My app build tasks
------------------
tasksAll - Show additional tasks.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_categories"><a class="anchor" href="#sec:task_categories"></a><a class="link" href="#sec:task_categories">Task categories</a></h4>
<div class="paragraph">
<p>Gradle distinguishes between two categories of tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Lifecycle tasks</strong></p>
</li>
<li>
<p><strong>Actionable tasks</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Lifecycle tasks</strong> define targets you can call, such as <code>:build</code> your project.
Lifecycle tasks do not provide Gradle with actions.
They must be <em>wired</em> to actionable tasks.
The <a href="base_plugin.html#base_plugin"><code>base</code> Gradle plugin</a> only adds lifecycle tasks.</p>
</div>
<div class="paragraph">
<p><strong>Actionable tasks</strong> define actions for Gradle to take, such as <code>:compileJava</code>, which compiles the Java code of your project.
Actions include creating JARs, zipping files, publishing archives, and much more.
Plugins like the <a href="#java_library_plugin"><code>java-library</code> plugin</a> adds actionable tasks.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s update the build script of the previous example, which is currently an empty file so that our <code>app</code> subproject is a Java library:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('java-library')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once again, we list the available tasks to see what new tasks are available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

Build tasks
-----------
assemble - Assembles the outputs of this project.
build - Assembles and tests this project.
buildDependents - Assembles and tests this project and all projects that depend on it.
buildNeeded - Assembles and tests this project and all projects it depends on.
classes - Assembles main classes.
clean - Deletes the build directory.
jar - Assembles a jar archive containing the classes of the 'main' feature.
testClasses - Assembles test classes.

Documentation tasks
-------------------
javadoc - Generates Javadoc API documentation for the 'main' feature.

Help tasks
----------
buildEnvironment - Displays all buildscript dependencies declared in project ':app'.
dependencies - Displays all dependencies declared in project ':app'.
dependencyInsight - Displays the insight into a specific dependency in project ':app'.
help - Displays a help message.
javaToolchains - Displays the detected java toolchains.
outgoingVariants - Displays the outgoing variants of project ':app'.
projects - Displays the sub-projects of project ':app'.
properties - Displays the properties of project ':app'.
resolvableConfigurations - Displays the configurations that can be resolved in project ':app'.
tasks - Displays the tasks runnable from project ':app'.

Verification tasks
------------------
check - Runs all checks.
test - Runs the test suite.</code></pre>
</div>
</div>
<div class="paragraph">
<p>We see that many new tasks are available such as <code>jar</code> and <code>testClasses</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>java-library</code> plugin has wired actionable tasks to lifecycle tasks.
If we call the <code>:build</code> task, we can see several tasks have been executed, including the <code>:app:compileJava</code> task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$./gradlew :app:build

&gt; Task :app:compileJava
&gt; Task :app:processResources NO-SOURCE
&gt; Task :app:classes
&gt; Task :app:jar
&gt; Task :app:assemble
&gt; Task :app:compileTestJava
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :app:testClasses
&gt; Task :app:test
&gt; Task :app:check
&gt; Task :app:build</code></pre>
</div>
</div>
<div class="paragraph">
<p>The actionable <code>:compileJava</code> task is wired to the lifecycle <code>:build</code> task.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:incremental_tasks"><a class="anchor" href="#sec:incremental_tasks"></a><a class="link" href="#sec:incremental_tasks">Incremental tasks</a></h4>
<div class="paragraph">
<p>A key feature of Gradle tasks is their incremental nature.</p>
</div>
<div class="paragraph">
<p>Gradle can reuse results from prior builds.
Therefore, if we&#8217;ve built our project before and made only minor changes, rerunning <code>:build</code> will not require Gradle to perform extensive work.</p>
</div>
<div class="paragraph">
<p>For example, if we modify only the test code in our project, leaving the production code unchanged, executing the build will solely recompile the test code.
Gradle marks the tasks for the production code as <code>UP-TO-DATE</code>, indicating that it remains unchanged since the last successful build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$./gradlew :app:build

gradle@MacBook-Pro temp1 % ./gradlew :app:build
&gt; Task :app:compileJava UP-TO-DATE
&gt; Task :app:processResources NO-SOURCE
&gt; Task :app:classes UP-TO-DATE
&gt; Task :app:jar UP-TO-DATE
&gt; Task :app:assemble UP-TO-DATE
&gt; Task :app:compileTestJava
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :app:testClasses
&gt; Task :app:test
&gt; Task :app:check UP-TO-DATE
&gt; Task :app:build UP-TO-DATE</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:caching_tasks"><a class="anchor" href="#sec:caching_tasks"></a><a class="link" href="#sec:caching_tasks">Caching tasks</a></h4>
<div class="paragraph">
<p>Gradle can reuse results from past builds using the build cache.</p>
</div>
<div class="paragraph">
<p>To enable this feature, activate the build cache by using the <code>--build-cache</code> <a href="#command_line_interface">command line</a> parameter or by setting <code>org.gradle.caching=true</code> in your <a href="#sec:gradle_configuration_properties"><code>gradle.properties</code></a> file.</p>
</div>
<div class="paragraph">
<p>This optimization has the potential to accelerate your builds significantly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$./gradlew :app:clean :app:build --build-cache

&gt; Task :app:compileJava FROM-CACHE
&gt; Task :app:processResources NO-SOURCE
&gt; Task :app:classes UP-TO-DATE
&gt; Task :app:jar
&gt; Task :app:assemble
&gt; Task :app:compileTestJava FROM-CACHE
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :app:testClasses UP-TO-DATE
&gt; Task :app:test FROM-CACHE
&gt; Task :app:check UP-TO-DATE
&gt; Task :app:build</code></pre>
</div>
</div>
<div class="paragraph">
<p>When Gradle can fetch outputs of a task from the cache, it labels the task with <code>FROM-CACHE</code>.</p>
</div>
<div class="paragraph">
<p>The build cache is handy if you switch between branches regularly.
Gradle supports both local and remote build caches.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:developing_tasks"><a class="anchor" href="#sec:developing_tasks"></a><a class="link" href="#sec:developing_tasks">Developing tasks</a></h4>
<div class="paragraph">
<p>When developing Gradle tasks, you have two choices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use an existing Gradle task type such as <code>Zip</code>, <code>Copy</code>, or <code>Delete</code></p>
</li>
<li>
<p>Create your own Gradle task type such as <code>MyResolveTask</code> or <code>CustomTaskUsingToolchains</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Task types are simply subclasses of the Gradle <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html"><code>Task</code></a> class.</p>
</div>
<div class="paragraph">
<p>With Gradle tasks, there are three states to consider:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Registering</strong> a task - using a task (implemented by you or provided by Gradle) in your build logic.</p>
</li>
<li>
<p><strong>Configuring</strong> a task - defining inputs and outputs for a registered task.</p>
</li>
<li>
<p><strong>Implementing</strong> a task - creating a custom task class (i.e., custom class type).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Registration</strong> is commonly done with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskContainer.html#register-java.lang.String-java.lang.Class-"><code>register()</code></a> method.<br>
<strong>Configuring</strong> a task is commonly done with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskCollection.html#named-java.lang.String-java.lang.Class-"><code>named()</code></a> method.<br>
<strong>Implementing</strong> a task is commonly done by extending Gradle&#8217;s <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DefaultTask.html"><code>DefaultTask</code></a> class:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("myCopy")                              // <b class="conum">(1)</b>

tasks.named&lt;Copy&gt;("myCopy") {                               // <b class="conum">(2)</b>
    from("resources")
    into("target")
    include("**/*.txt", "**/*.xml", "**/*.properties")
}

abstract class MyCopyTask : DefaultTask() {                 // <b class="conum">(3)</b>
    @TaskAction
    fun copyFiles() {
        val sourceDir = File("sourceDir")
        val destinationDir = File("destinationDir")
        sourceDir.listFiles()?.forEach { file -&gt;
            if (file.isFile &amp;&amp; file.extension == "txt") {
                file.copyTo(File(destinationDir, file.name))
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Register the <code>myCopy</code> task of type <code>Copy</code> to let Gradle know we intend to use it in our build logic.</p>
</li>
<li>
<p>Configure the registered <code>myCopy</code> task with the inputs and outputs it needs according to its <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/Copy.html">API</a>.</p>
</li>
<li>
<p>Implement a custom task type called <code>MyCopyTask</code> which extends <code>DefaultTask</code> and defines the <code>copyFiles</code> task action.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("myCopy", Copy)                              // <b class="conum">(1)</b>

tasks.named("myCopy", Copy) {                               // <b class="conum">(2)</b>
    from "resources"
    into "target"
    include "**/*.txt", "**/*.xml", "**/*.properties"
}

abstract class MyCopyTask extends DefaultTask {             // <b class="conum">(3)</b>
    @TaskAction
    void copyFiles() {
        fileTree('sourceDir').matching {
            include '**/*.txt'
        }.forEach { file -&gt;
            file.copyTo(file.path.replace('sourceDir', 'destinationDir'))
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Register the <code>myCopy</code> task of type <code>Copy</code> to let Gradle know we intend to use it in our build logic.</p>
</li>
<li>
<p>Configure the registered <code>myCopy</code> task with the inputs and outputs it needs according to its <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/Copy.html">API</a>.</p>
</li>
<li>
<p>Implement a custom task type called <code>MyCopyTask</code> which extends <code>DefaultTask</code> and defines the <code>copyFiles</code> task action.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining_tasks"><a class="anchor" href="#sec:defining_tasks"></a><a class="link" href="#sec:defining_tasks">1. Registering tasks</a></h5>
<div class="paragraph">
<p>You define actions for Gradle to take by registering tasks in build scripts or plugins.</p>
</div>
<div class="paragraph">
<p>Tasks are defined using strings for task names:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("hello") {
    doLast {
        println("hello")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('hello') {
    doLast {
        println 'hello'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example above, the task is added to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskCollection.html"><code>TasksCollection</code></a> using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskContainer.html#register-java.lang.String-java.lang.Class-"><code>register()</code></a> method in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskContainer.html"><code>TaskContainer</code></a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:configuring_tasks"><a class="anchor" href="#sec:configuring_tasks"></a><a class="link" href="#sec:configuring_tasks">2. Configuring tasks</a></h5>
<div class="paragraph">
<p>Gradle tasks must be configured to complete their action(s) successfully.
If a task needs to ZIP a file, it must be configured with the file name and location.
You can refer to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/bundling/Zip.html">API</a> for the Gradle <code>Zip</code> task to learn how to configure it appropriately.</p>
</div>
<div class="paragraph">
<p>Lets look at the <code>Copy</code> task provided by Gradle as an example.
We first register a task called <code>myCopy</code> of type <code>Copy</code> in the build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("myCopy")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('myCopy', Copy)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This registers a copy task with no default behavior.
Since the task is of type <code>Copy</code>, a Gradle supported task type, it can be configured using its <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/Copy.html">API</a>.</p>
</div>
<div class="paragraph">
<p>The following examples show several ways to achieve the same configuration:</p>
</div>
<div class="sect5">
<h6 id="1_using_the_named_method"><a class="anchor" href="#1_using_the_named_method"></a><a class="link" href="#1_using_the_named_method">1. Using the <code>named()</code> method:</a></h6>
<div class="paragraph">
<p>Use <code>named()</code> to configure an existing task registered elsewhere:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;Copy&gt;("myCopy") {
    from("resources")
    into("target")
    include("**/*.txt", "**/*.xml", "**/*.properties")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('myCopy') {
    from 'resources'
    into 'target'
    include('**/*.txt', '**/*.xml', '**/*.properties')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="2_using_a_configuration_block"><a class="anchor" href="#2_using_a_configuration_block"></a><a class="link" href="#2_using_a_configuration_block">2. Using a configuration block:</a></h6>
<div class="paragraph">
<p>Use a block to configure the task immediately upon registering it:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copy") {
   from("resources")
   into("target")
   include("**/*.txt", "**/*.xml", "**/*.properties")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copy', Copy) {
   from 'resources'
   into 'target'
   include('**/*.txt', '**/*.xml', '**/*.properties')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="3_name_method_as_call"><a class="anchor" href="#3_name_method_as_call"></a><a class="link" href="#3_name_method_as_call">3. Name method as call:</a></h6>
<div class="paragraph">
<p>A popular option that is only supported in Groovy is the shorthand notation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">copy {
    from("resources")
    into("target")
    include("**/*.txt", "**/*.xml", "**/*.properties")
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This option breaks task configuration avoidance and is not recommended!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardless of the method chosen, the task is configured with the name of the files to be copied and the location of the files.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:implementing_tasks"><a class="anchor" href="#sec:implementing_tasks"></a><a class="link" href="#sec:implementing_tasks">3. Implementing tasks</a></h5>
<div class="paragraph">
<p>Gradle provides many task types including <code>Delete</code>, <code>Javadoc</code>, <code>Copy</code>, <code>Exec</code>, <code>Tar</code>, and <code>Pmd</code>.
You can implement a custom task type if Gradle does not provide a task type that meets your build logic needs.</p>
</div>
<div class="paragraph">
<p>To create a custom task class, you extend <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DefaultTask.html"><code>DefaultTask</code></a> and make the extending class abstract:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyCopyTask : DefaultTask() {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyCopyTask extends DefaultTask {

}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="controlling_task_execution"><a class="anchor" href="#controlling_task_execution"></a><a class="link" href="#controlling_task_execution">Controlling Task Execution</a></h3>
<div class="paragraph">
<p>Task dependencies allow tasks to be executed in a specific order based on their dependencies.
This ensures that tasks dependent on others are only executed after those dependencies have completed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/writing-tasks-2.png" alt="writing tasks 2">
</div>
</div>
<div class="paragraph">
<p>Task dependencies can be categorized as either <strong>implicit</strong> or <strong>explicit</strong>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implicit dependencies </dt>
<dd>
<p>These dependencies are automatically inferred by Gradle based on the tasks' actions and configuration. For example, if <code>taskB</code> uses the output of <code>taskA</code> (e.g., a file generated by <code>taskA</code>), Gradle will automatically ensure that <code>taskA</code> is executed before <code>taskB</code> to fulfill this dependency.</p>
</dd>
<dt class="hdlist1">Explicit dependencies </dt>
<dd>
<p>These dependencies are explicitly declared in the build script using the <code>dependsOn</code>, <code>mustRunAfter</code>, or <code>shouldRunAfter</code> methods. For example, if you want to ensure that <code>taskB</code> always runs after <code>taskA</code>, you can explicitly declare this dependency using <code>taskB.mustRunAfter(taskA)</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Both implicit and explicit dependencies play a crucial role in defining the order of task execution and ensuring that tasks are executed in the correct sequence to produce the desired build output.</p>
</div>
<div class="sect3">
<h4 id="sec:more_task_dependencies"><a class="anchor" href="#sec:more_task_dependencies"></a><a class="link" href="#sec:more_task_dependencies">Task dependencies</a></h4>
<div class="paragraph">
<p>Gradle inherently understands the dependencies among tasks.
Consequently, it can determine the tasks that need execution when you target a specific task.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take an example application with an <code>app</code> subproject and a <code>some-logic</code> subproject:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "gradle-project"
include("app")
include("some-logic")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'gradle-project'
include('app')
include('some-logic')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s imagine that the <code>app</code> subproject depends on the subproject called <code>some-logic</code>, which contains some Java code.
We add this dependency in the <code>app</code> build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("application")                       // app is now a java application
}

application {
    mainClass.set("hello.HelloWorld")       // main class name required by the application plugin
}

dependencies {
    implementation(project(":some-logic"))  // dependency on some-logic
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('application')                       // app is now a java application
}

application {
    mainClass = 'hello.HelloWorld'          // main class name required by the application plugin
}

dependencies {
    implementation(project(':some-logic'))  // dependency on some-logic
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If we run <code>:app:build</code> again, we see the Java code of <code>some-logic</code> is also compiled by Gradle automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$./gradlew :app:build

&gt; Task :app:processResources NO-SOURCE
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :some-logic:compileJava UP-TO-DATE
&gt; Task :some-logic:processResources NO-SOURCE
&gt; Task :some-logic:classes UP-TO-DATE
&gt; Task :some-logic:jar UP-TO-DATE
&gt; Task :app:compileJava
&gt; Task :app:classes
&gt; Task :app:jar UP-TO-DATE
&gt; Task :app:startScripts
&gt; Task :app:distTar
&gt; Task :app:distZip
&gt; Task :app:assemble
&gt; Task :app:compileTestJava UP-TO-DATE
&gt; Task :app:testClasses UP-TO-DATE
&gt; Task :app:test
&gt; Task :app:check
&gt; Task :app:build

BUILD SUCCESSFUL in 430ms
9 actionable tasks: 5 executed, 4 up-to-date</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding_dependencies_to_tasks"><a class="anchor" href="#sec:adding_dependencies_to_tasks"></a><a class="link" href="#sec:adding_dependencies_to_tasks">Adding dependencies</a></h4>
<div class="paragraph">
<p>There are several ways you can define the dependencies of a task.</p>
</div>
<div class="paragraph">
<p>Defining dependencies using task names and the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DefaultTask.html#dependsOn-java.lang.Object&#8230;&#8203;-">dependsOn()`</a> method is simplest.</p>
</div>
<div class="paragraph">
<p>The following is an example which adds a dependency from <code>taskX</code> to <code>taskY</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("taskX") {
    dependsOn("taskY")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("taskX") {
    dependsOn "taskY"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskX
taskY
taskX</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information about task dependencies, see the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html">Task</a> API.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:ordering_tasks"><a class="anchor" href="#sec:ordering_tasks"></a><a class="link" href="#sec:ordering_tasks">Ordering tasks</a></h4>
<div class="paragraph">
<p>In some cases, it is useful to control the <em>order</em> in which two tasks will execute, without introducing an explicit dependency between those tasks.</p>
</div>
<div class="paragraph">
<p>The primary difference between a task <em>ordering</em> and a task <em>dependency</em> is that an ordering rule does not influence which tasks will be executed, only the order in which they will be executed.</p>
</div>
<div class="paragraph">
<p>Task ordering can be useful in a number of scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enforce sequential ordering of tasks (e.g., <code>build</code> never runs before <code>clean</code>).</p>
</li>
<li>
<p>Run build validations early in the build (e.g., validate I have the correct credentials before starting the work for a release build).</p>
</li>
<li>
<p>Get feedback faster by running quick verification tasks before long verification tasks (e.g., unit tests should run before integration tests).</p>
</li>
<li>
<p>A task that aggregates the results of all tasks of a particular type (e.g., test report task combines the outputs of all executed test tasks).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Two ordering rules are available: "<em>must run after</em>" and "<em>should run after</em>".</p>
</div>
<div class="paragraph">
<p>To specify a "must run after" or "should run after" ordering between 2 tasks, you use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#mustRunAfter-java.lang.Object&#8230;&#8203;-">Task.mustRunAfter(java.lang.Object...)</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#shouldRunAfter-java.lang.Object&#8230;&#8203;-">Task.shouldRunAfter(java.lang.Object...)</a> methods.
These methods accept a task instance, a task name, or any other input accepted by <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#dependsOn-java.lang.Object&#8230;&#8203;-">Task.dependsOn(java.lang.Object...)</a>.</p>
</div>
<div class="paragraph">
<p>When you use "must run after", you specify that <code>taskY</code> must always run after <code>taskX</code> when the build requires the execution of <code>taskX</code> and <code>taskY</code>.
So if you only run <code>taskY</code> with <code>mustRunAfter</code>, you won&#8217;t cause <code>taskX</code> to run.
This is expressed as <code>taskY.mustRunAfter(taskX)</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val taskX by tasks.registering {
    doLast {
        println("taskX")
    }
}
val taskY by tasks.registering {
    doLast {
        println("taskY")
    }
}
taskY {
    mustRunAfter(taskX)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def taskX = tasks.register('taskX') {
    doLast {
        println 'taskX'
    }
}
def taskY = tasks.register('taskY') {
    doLast {
        println 'taskY'
    }
}
taskY.configure {
    mustRunAfter taskX
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskY taskX
taskX
taskY</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The "should run after" ordering rule is similar but less strict, as it will be ignored in two situations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If using that rule introduces an ordering cycle.</p>
</li>
<li>
<p>When using parallel execution and all task dependencies have been satisfied apart from the "should run after" task, then this task will be run regardless of whether or not its "should run after" dependencies have been run.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should use "should run after" where the ordering is helpful but not strictly required:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val taskX by tasks.registering {
    doLast {
        println("taskX")
    }
}
val taskY by tasks.registering {
    doLast {
        println("taskY")
    }
}
taskY {
    shouldRunAfter(taskX)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def taskX = tasks.register('taskX') {
    doLast {
        println 'taskX'
    }
}
def taskY = tasks.register('taskY') {
    doLast {
        println 'taskY'
    }
}
taskY.configure {
    shouldRunAfter taskX
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskY taskX
taskX
taskY</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the examples above, it is still possible to execute <code>taskY</code> without causing <code>taskX</code> to run:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskY
taskY</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The "should run after" ordering rule will be ignored if it introduces an ordering cycle:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val taskX by tasks.registering {
    doLast {
        println("taskX")
    }
}
val taskY by tasks.registering {
    doLast {
        println("taskY")
    }
}
val taskZ by tasks.registering {
    doLast {
        println("taskZ")
    }
}
taskX { dependsOn(taskY) }
taskY { dependsOn(taskZ) }
taskZ { shouldRunAfter(taskX) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def taskX = tasks.register('taskX') {
    doLast {
        println 'taskX'
    }
}
def taskY = tasks.register('taskY') {
    doLast {
        println 'taskY'
    }
}
def taskZ = tasks.register('taskZ') {
    doLast {
        println 'taskZ'
    }
}
taskX.configure { dependsOn(taskY) }
taskY.configure { dependsOn(taskZ) }
taskZ.configure { shouldRunAfter(taskX) }</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskX
taskZ
taskY
taskX</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that <code>taskY.mustRunAfter(taskX)</code> or <code>taskY.shouldRunAfter(taskX)</code> does not imply any execution dependency between the tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is possible to execute <code>taskX</code> and <code>taskY</code> independently. The ordering rule only has an effect when both tasks are scheduled for execution.</p>
</li>
<li>
<p>When run with <code>--continue</code>, it is possible for <code>taskY</code> to execute if <code>taskX</code> fails.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:finalizer_tasks"><a class="anchor" href="#sec:finalizer_tasks"></a><a class="link" href="#sec:finalizer_tasks">Finalizer tasks</a></h4>
<div class="paragraph">
<p>Finalizer tasks are useful when the build creates a resource that must be cleaned up, regardless of whether the build fails or succeeds.
An example of such a resource is a web container that is started before an integration test task and must be shut down, even if some tests fail.</p>
</div>
<div class="paragraph">
<p>Finalizer tasks are automatically added to the task graph when the finalized task is scheduled to run.</p>
</div>
<div class="paragraph">
<p>To specify a finalizer task, you use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#finalizedBy-java.lang.Object&#8230;&#8203;-">Task.finalizedBy(java.lang.Object&#8230;&#8203;)</a> method.
This method accepts a task instance, a task name, or any other input accepted by <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#dependsOn-java.lang.Object&#8230;&#8203;-">Task.dependsOn(java.lang.Object&#8230;&#8203;)</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val taskX by tasks.registering {
    doLast {
        println("taskX")
    }
}
val taskY by tasks.registering {
    doLast {
        println("taskY")
    }
}

taskX { finalizedBy(taskY) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def taskX = tasks.register('taskX') {
    doLast {
        println 'taskX'
    }
}
def taskY = tasks.register('taskY') {
    doLast {
        println 'taskY'
    }
}

taskX.configure { finalizedBy taskY }</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskX
taskX
taskY</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Finalizer tasks are executed even if the finalized task fails or if the finalized task is considered <code>UP-TO-DATE</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val taskX by tasks.registering {
    doLast {
        println("taskX")
        throw RuntimeException()
    }
}
val taskY by tasks.registering {
    doLast {
        println("taskY")
    }
}

taskX { finalizedBy(taskY) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def taskX = tasks.register('taskX') {
    doLast {
        println 'taskX'
        throw new RuntimeException()
    }
}
def taskY = tasks.register('taskY') {
    doLast {
        println 'taskY'
    }
}

taskX.configure { finalizedBy taskY }</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q taskX
taskX
taskY

FAILURE: Build failed with an exception.

* Where:
Build file '/home/user/gradle/samples/build.gradle' line: 4

* What went wrong:
Execution failed for task ':taskX'.
&gt; java.lang.RuntimeException (no error message)

* Try:
&gt; Run with --stacktrace option to get the stack trace.
&gt; Run with --info or --debug option to get more log output.
&gt; Run with --scan to generate a Build Scan (Powered by Develocity).
&gt; Get more help at https://help.gradle.org.

BUILD FAILED in 0s</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping_tasks"><a class="anchor" href="#sec:skipping_tasks"></a><a class="link" href="#sec:skipping_tasks">Skipping tasks</a></h4>
<div class="paragraph">
<p>Gradle offers multiple ways to skip the execution of a task.</p>
</div>
<div class="sect4">
<h5 id="sec:using_a_predicate"><a class="anchor" href="#sec:using_a_predicate"></a><a class="link" href="#sec:using_a_predicate">1. Using a predicate</a></h5>
<div class="paragraph">
<p>You can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#onlyIf-org.gradle.api.specs.Spec-"><code>Task.onlyIf</code></a> to attach a predicate to a task.
The task&#8217;s actions will only be executed if the predicate is evaluated to be <code>true</code>.</p>
</div>
<div class="paragraph">
<p>The predicate is passed to the task as a parameter and returns <code>true</code> if the task will execute and <code>false</code> if the task will be skipped.
The predicate is evaluated just before the task is executed.</p>
</div>
<div class="paragraph">
<p>Passing an optional reason string to <code>onlyIf()</code> is useful for explaining why the task is skipped:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val hello by tasks.registering {
    doLast {
        println("hello world")
    }
}

hello {
    val skipProvider = providers.gradleProperty("skipHello")
    onlyIf("there is no property skipHello") {
        !skipProvider.isPresent()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def hello = tasks.register('hello') {
    doLast {
        println 'hello world'
    }
}

hello.configure {
    def skipProvider = providers.gradleProperty("skipHello")
    onlyIf("there is no property skipHello") {
        !skipProvider.present
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello -PskipHello
&gt; Task :hello SKIPPED

BUILD SUCCESSFUL in 0s</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To find why a task was skipped, run the build with the <code>--info</code> logging level.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ gradle hello -PskipHello --info
...

&gt; Task :hello SKIPPED
Skipping task ':hello' as task onlyIf 'there is no property skipHello' is false.
:hello (Thread[included builds,5,main]) completed. Took 0.018 secs.

BUILD SUCCESSFUL in 13s</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_stopexecutionexception"><a class="anchor" href="#sec:using_stopexecutionexception"></a><a class="link" href="#sec:using_stopexecutionexception">2. Using <code>StopExecutionException</code></a></h5>
<div class="paragraph">
<p>If the logic for skipping a task can&#8217;t be expressed with a predicate, you can use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/StopExecutionException.html"><code>StopExecutionException</code></a>.</p>
</div>
<div class="paragraph">
<p>If this exception is thrown by an action, the task action as well as the execution of any following action is skipped.
The build continues by executing the next task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val compile by tasks.registering {
    doLast {
        println("We are doing the compile.")
    }
}

compile {
    doFirst {
        // Here you would put arbitrary conditions in real life.
        if (true) {
            throw StopExecutionException()
        }
    }
}
tasks.register("myTask") {
    dependsOn(compile)
    doLast {
        println("I am not affected")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def compile = tasks.register('compile') {
    doLast {
        println 'We are doing the compile.'
    }
}

compile.configure {
    doFirst {
        // Here you would put arbitrary conditions in real life.
        if (true) {
            throw new StopExecutionException()
        }
    }
}
tasks.register('myTask') {
    dependsOn('compile')
    doLast {
        println 'I am not affected'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q myTask
I am not affected</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This feature is helpful if you work with tasks provided by Gradle.
It allows you to add <em>conditional</em> execution of the built-in actions of such a task.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
<div class="sect4">
<h5 id="sec:enabling_and_disabling_tasks"><a class="anchor" href="#sec:enabling_and_disabling_tasks"></a><a class="link" href="#sec:enabling_and_disabling_tasks">3. Enabling and Disabling tasks</a></h5>
<div class="paragraph">
<p>Every task has an <code>enabled</code> flag, which defaults to <code>true</code>.
Setting it to <code>false</code> prevents executing the task&#8217;s actions.</p>
</div>
<div class="paragraph">
<p>A disabled task will be labeled <code>SKIPPED</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val disableMe by tasks.registering {
    doLast {
        println("This should not be printed if the task is disabled.")
    }
}

disableMe {
    enabled = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def disableMe = tasks.register('disableMe') {
    doLast {
        println 'This should not be printed if the task is disabled.'
    }
}

disableMe.configure {
    enabled = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle disableMe
&gt; Task :disableMe SKIPPED

BUILD SUCCESSFUL in 0s</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_timeouts"><a class="anchor" href="#sec:task_timeouts"></a><a class="link" href="#sec:task_timeouts">4. Task timeouts</a></h5>
<div class="paragraph">
<p>Every task has a <code>timeout</code> property, which can be used to limit its execution time.
When a task reaches its timeout, its task execution thread is interrupted.
The task will be marked as <code>FAILED</code>.</p>
</div>
<div class="paragraph">
<p><a href="#sec:finalizer_tasks">Finalizer tasks</a> are executed.
If <code>--continue</code> is used, other tasks continue running.</p>
</div>
<div class="paragraph">
<p>Tasks that don&#8217;t respond to interrupts can&#8217;t be timed out.
All of Gradle&#8217;s built-in tasks respond to timeouts.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("hangingTask") {
    doLast {
        Thread.sleep(100000)
    }
    timeout = Duration.ofMillis(500)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("hangingTask") {
    doLast {
        Thread.sleep(100000)
    }
    timeout = Duration.ofMillis(500)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_rules"><a class="anchor" href="#sec:task_rules"></a><a class="link" href="#sec:task_rules">Task rules</a></h4>
<div class="paragraph">
<p>Sometimes you want to have a task whose behavior depends on a large or infinite number value range of parameters.
A very nice and expressive way to provide such tasks are task rules:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.addRule("Pattern: ping&lt;ID&gt;") {
    val taskName = this
    if (startsWith("ping")) {
        task(taskName) {
            doLast {
                println("Pinging: " + (taskName.replace("ping", "")))
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.addRule("Pattern: ping&lt;ID&gt;") { String taskName -&gt;

    if (taskName.startsWith("ping")) {
        task(taskName) {
            doLast {
                println "Pinging: " + (taskName - 'ping')
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q pingServer1
Pinging: Server1</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>String</code> parameter is used as a description for the rule, which is shown with <code>./gradlew tasks</code>.</p>
</div>
<div class="paragraph">
<p>Rules are not only used when calling tasks from the command line.
You can also create <code>dependsOn</code> relations on rule based tasks:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.addRule("Pattern: ping&lt;ID&gt;") {
    val taskName = this
    if (startsWith("ping")) {
        task(taskName) {
            doLast {
                println("Pinging: " + (taskName.replace("ping", "")))
            }
        }
    }
}

tasks.register("groupPing") {
    dependsOn("pingServer1", "pingServer2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.addRule("Pattern: ping&lt;ID&gt;") { String taskName -&gt;

    if (taskName.startsWith("ping")) {
        task(taskName) {
            doLast {
                println "Pinging: " + (taskName - 'ping')
            }
        }
    }
}

tasks.register('groupPing') {
    dependsOn 'pingServer1', 'pingServer2'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q groupPing
Pinging: Server1
Pinging: Server2</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you run <code>./gradlew -q tasks</code>, you won&#8217;t find a task named <code>pingServer1</code> or <code>pingServer2</code>, but this script is executing logic based on the request to run those tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:exclude_task"><a class="anchor" href="#sec:exclude_task"></a><a class="link" href="#sec:exclude_task">Exclude tasks from execution</a></h4>
<div class="paragraph">
<p>You can exclude a task from execution using the <code>-x</code> or <code>--exclude-task</code> command-line option and provide the task&#8217;s name to exclude.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew build -x test</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance, you can run the <code>check</code> task but exclude the <code>test</code> task from running.
This approach can lead to unexpected outcomes, particularly if you exclude an actionable task that produces results needed by other tasks.
Instead of relying on the <code>-x</code> parameter, defining a suitable lifecycle task for the desired action is recommended.</p>
</div>
<div class="paragraph">
<p>Using <code>-x</code> is a practice that should be avoided, although still commonly observed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="organizing_tasks"><a class="anchor" href="#organizing_tasks"></a><a class="link" href="#organizing_tasks">Organizing Tasks</a></h3>
<div class="paragraph">
<p>There are two types of tasks, actionable and lifecycle tasks.</p>
</div>
<div class="paragraph">
<p>Actionable tasks in Gradle are tasks that perform actual work, such as compiling code.
Lifecycle tasks are tasks that do not do work themselves.
These tasks have no actions, instead, they bundle actionable tasks and serve as <em>targets</em> for the build.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/writing-tasks-6.png" alt="writing tasks 6">
</div>
</div>
<div class="paragraph">
<p>A well-organized setup of lifecycle tasks enhances the accessibility of your build for new users and simplifies integration with CI.</p>
</div>
<div class="sect3">
<h4 id="sec:lifecycle_tasks"><a class="anchor" href="#sec:lifecycle_tasks"></a><a class="link" href="#sec:lifecycle_tasks">Lifecycle tasks</a></h4>
<div class="paragraph">
<p>Lifecycle tasks can be particularly beneficial for separating work between users or machines (CI vs local).
For example, a developer on a local machine might not want to run an entire build on every single change.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a standard <code>app</code> as an example which applies the <code>base</code> plugin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <a href="base_plugin.html#base_plugin">Gradle <code>base</code> plugin</a> defines several lifecycle tasks, including <code>build</code>, <code>assemble</code>, and <code>check</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We group the <code>build</code>, <code>check</code> task, and the <code>run</code> task by adding the following lines to the <code>app</code> build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.build {
    group = myBuildGroup
}

tasks.check {
    group = myBuildGroup
    description = "Runs checks (including tests)."
}

tasks.named("run") {
    group = myBuildGroup
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.build {
    group = myBuildGroup
}

tasks.check {
    group = myBuildGroup
    description = "Runs checks (including tests)."
}

tasks.named('run') {
    group = myBuildGroup
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If we now look at the <code>app:tasks</code> list, we can see the three tasks are available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

My app build tasks
------------------
build - Assembles and tests this project.
check - Runs checks (including tests).
run - Runs this project as a JVM application
tasksAll - Show additional tasks.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is already useful if the standard lifecycle tasks are sufficient.
Moving the groups around helps clarify the tasks you expect to used in your build.</p>
</div>
<div class="paragraph">
<p>In many cases, there are more specific requirements that you want to address.
One common scenario is running quality checks without running tests.
Currently, the <code>:check</code> task runs tests and the code quality checks.
Instead, we want to run code quality checks all the time, but not the lengthy test.</p>
</div>
<div class="paragraph">
<p>To add a quality check lifecycle task, we introduce an additional lifecycle task called <code>qualityCheck</code> and a plugin called <a href="https://github.com/spotbugs/spotbugs"><code>spotbugs</code></a>.</p>
</div>
<div class="paragraph">
<p>To add a lifecycle task, use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskContainer.html#register-java.lang.String-java.lang.Class-"><code>tasks.register()</code></a>.
The only thing you need to provide is a name.
Put this task in our group and wire the actionable tasks that belong to this new lifecycle task using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/DefaultTask.html#dependsOn-java.lang.Object&#8230;&#8203;-"><code>dependsOn()</code></a> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("com.github.spotbugs") version "6.0.7"           // spotbugs plugin
}

tasks.register("qualityCheck") {                        // qualityCheck task
    group = myBuildGroup                                // group
    description = "Runs checks (excluding tests)."      // description
    dependsOn(tasks.classes, tasks.spotbugsMain)        // dependencies
    dependsOn(tasks.testClasses, tasks.spotbugsTest)    // dependencies
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'com.github.spotbugs' version '6.0.7'            // spotbugs plugin
}

tasks.register('qualityCheck') {                        // qualityCheck task
    group = myBuildGroup                                // group
    description = 'Runs checks (excluding tests).'      // description
    dependsOn tasks.classes, tasks.spotbugsMain         // dependencies
    dependsOn tasks.testClasses, tasks.spotbugsTest     // dependencies
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that you don&#8217;t need to list all the tasks that Gradle will execute.
Just specify the targets you want to collect here.
Gradle will determine which other tasks it needs to call to reach these goals.</p>
</div>
<div class="paragraph">
<p>In the example, we add the <code>classes</code> task, a lifecycle task to compile all our production code, and the <code>spotbugsMain</code> task, which checks our production code.</p>
</div>
<div class="paragraph">
<p>We also add a description that will show up in the task list that helps distinguish the two check tasks better.</p>
</div>
<div class="paragraph">
<p>Now, if run './gradlew :app:tasks', we can see that our new <code>qualityCheck</code> lifecycle task is available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:tasks

&gt; Task :app:tasks

------------------------------------------------------------
Tasks runnable from project ':app'
------------------------------------------------------------

My app build tasks
------------------
build - Assembles and tests this project.
check - Runs checks (including tests).
qualityCheck - Runs checks (excluding tests).
run - Runs this project as a JVM application
tasksAll - Show additional tasks.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run it, we can see that it runs checkstyle but not the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:qualityCheck

&gt; Task :buildSrc:checkKotlinGradlePluginConfigurationErrors
&gt; Task :buildSrc:generateExternalPluginSpecBuilders UP-TO-DATE
&gt; Task :buildSrc:extractPrecompiledScriptPluginPlugins UP-TO-DATE
&gt; Task :buildSrc:compilePluginsBlocks UP-TO-DATE
&gt; Task :buildSrc:generatePrecompiledScriptPluginAccessors UP-TO-DATE
&gt; Task :buildSrc:generateScriptPluginAdapters UP-TO-DATE
&gt; Task :buildSrc:compileKotlin UP-TO-DATE
&gt; Task :buildSrc:compileJava NO-SOURCE
&gt; Task :buildSrc:compileGroovy NO-SOURCE
&gt; Task :buildSrc:pluginDescriptors UP-TO-DATE
&gt; Task :buildSrc:processResources UP-TO-DATE
&gt; Task :buildSrc:classes UP-TO-DATE
&gt; Task :buildSrc:jar UP-TO-DATE
&gt; Task :app:processResources NO-SOURCE
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :list:compileJava UP-TO-DATE
&gt; Task :utilities:compileJava UP-TO-DATE
&gt; Task :app:compileJava
&gt; Task :app:classes
&gt; Task :app:compileTestJava
&gt; Task :app:testClasses
&gt; Task :app:spotbugsTest
&gt; Task :app:spotbugsMain
&gt; Task :app:qualityCheck

BUILD SUCCESSFUL in 1s
16 actionable tasks: 5 executed, 11 up-to-date</code></pre>
</div>
</div>
<div class="paragraph">
<p>So far, we have looked at tasks in individual subprojects, which is useful for local development when you work on code in one subproject.</p>
</div>
<div class="paragraph">
<p>With this setup, developers only need to know that they can call Gradle with <code>:subproject-name:tasks</code> to see which tasks are available and useful for them.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:global_lifecycle_tasks"><a class="anchor" href="#sec:global_lifecycle_tasks"></a><a class="link" href="#sec:global_lifecycle_tasks">Global lifecycle tasks</a></h4>
<div class="paragraph">
<p>Another place to invoke lifecycle tasks is within the root build; this is especially useful for Continuous Integration (CI).</p>
</div>
<div class="paragraph">
<p>Gradle tasks play a crucial role in CI or CD systems, where activities like compiling all code, running tests, or building and packaging the complete application are typical.
To facilitate this, you can include lifecycle tasks that span multiple subprojects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle has been around for a long time, and you will frequently observe build files in the root directory serving various purposes.
In older Gradle versions, many tasks were defined within the root Gradle build file, resulting in various issues.
Therefore, exercise caution when determining the content of this file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One of the few elements that should be placed in the root build file is global lifecycle tasks.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s continue using the Gradle <code>init</code> Java application multi-project as an example.</p>
</div>
<div class="paragraph">
<p>This time, we&#8217;re incorporating a build script in the root project.
We&#8217;ll establish two groups for our global lifecycle tasks: one for tasks relevant to local development, such as running all checks, and another exclusively for our CI system.</p>
</div>
<div class="paragraph">
<p>Once again, we narrowed down the tasks listed to our specific groups:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val globalBuildGroup = "My global build"
val ciBuildGroup = "My CI build"

tasks.named&lt;TaskReportTask&gt;("tasks") {
    displayGroups = listOf&lt;String&gt;(globalBuildGroup, ciBuildGroup)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def globalBuildGroup = "My global build"
def ciBuildGroup = "My CI build"

tasks.named(TaskReportTask, "tasks") {
    displayGroups = [globalBuildGroup, ciBuildGroup]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You could hide the CI tasks if you wanted to by updating <code>displayGroups</code>.</p>
</div>
<div class="paragraph">
<p>Currently, the root project exposes no tasks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :tasks

&gt; Task :tasks

------------------------------------------------------------
Tasks runnable from root project 'gradle-project'
------------------------------------------------------------

No tasks</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In this file, we don&#8217;t apply a plugin!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s add a <code>qualityCheckApp</code> task to execute all code quality checks in the <code>app</code> subproject.
Similarly, for CI purposes, we implement a <code>checkAll</code> task that runs all tests:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("qualityCheckApp") {
    group = globalBuildGroup
    description = "Runs checks on app (globally)"
    dependsOn(":app:qualityCheck" )
}

tasks.register("checkAll") {
    group = ciBuildGroup
    description = "Runs checks for all projects (CI)"
    dependsOn(subprojects.map { ":${it.name}:check" })
    dependsOn(gradle.includedBuilds.map { it.task(":checkAll") })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("qualityCheckApp") {
    group = globalBuildGroup
    description = "Runs checks on app (globally)"
    dependsOn(":app:qualityCheck")
}

tasks.register("checkAll") {
    group = ciBuildGroup
    description = "Runs checks for all projects (CI)"
    dependsOn subprojects.collect { ":${it.name}:check" }
    dependsOn gradle.includedBuilds.collect { it.task(":checkAll") }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>So we can now ask Gradle to show us the tasks for the root project and, by default, it will only show us the <code>qualityCheckAll</code> task (and optionally the <code>checkAll</code> task depending on the value of <code>displayGroups</code>).</p>
</div>
<div class="paragraph">
<p>It should be clear what a user should run locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :tasks

&gt; Task :tasks

------------------------------------------------------------
Tasks runnable from root project 'gradle-project'
------------------------------------------------------------

My CI build tasks
-----------------
checkAll - Runs checks for all projects (CI)

My global build tasks
---------------------
qualityCheckApp - Runs checks on app (globally)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run the <code>:checkAll</code> task, we see that it compiles all the code and runs the code quality checks (including <code>spotbug</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :checkAll

&gt; Task :buildSrc:checkKotlinGradlePluginConfigurationErrors
&gt; Task :buildSrc:generateExternalPluginSpecBuilders UP-TO-DATE
&gt; Task :buildSrc:extractPrecompiledScriptPluginPlugins UP-TO-DATE
&gt; Task :buildSrc:compilePluginsBlocks UP-TO-DATE
&gt; Task :buildSrc:generatePrecompiledScriptPluginAccessors UP-TO-DATE
&gt; Task :buildSrc:generateScriptPluginAdapters UP-TO-DATE
&gt; Task :buildSrc:compileKotlin UP-TO-DATE
&gt; Task :buildSrc:compileJava NO-SOURCE
&gt; Task :buildSrc:compileGroovy NO-SOURCE
&gt; Task :buildSrc:pluginDescriptors UP-TO-DATE
&gt; Task :buildSrc:processResources UP-TO-DATE
&gt; Task :buildSrc:classes UP-TO-DATE
&gt; Task :buildSrc:jar UP-TO-DATE
&gt; Task :utilities:processResources NO-SOURCE
&gt; Task :app:processResources NO-SOURCE
&gt; Task :utilities:processTestResources NO-SOURCE
&gt; Task :app:processTestResources NO-SOURCE
&gt; Task :list:compileJava
&gt; Task :list:processResources NO-SOURCE
&gt; Task :list:classes
&gt; Task :list:jar
&gt; Task :utilities:compileJava
&gt; Task :utilities:classes
&gt; Task :utilities:jar
&gt; Task :utilities:compileTestJava NO-SOURCE
&gt; Task :utilities:testClasses UP-TO-DATE
&gt; Task :utilities:test NO-SOURCE
&gt; Task :utilities:check UP-TO-DATE
&gt; Task :list:compileTestJava
&gt; Task :list:processTestResources NO-SOURCE
&gt; Task :list:testClasses
&gt; Task :app:compileJava
&gt; Task :app:classes
&gt; Task :app:compileTestJava
&gt; Task :app:testClasses
&gt; Task :list:test
&gt; Task :list:check
&gt; Task :app:test
&gt; Task :app:spotbugsTest
&gt; Task :app:spotbugsMain
&gt; Task :app:check
&gt; Task :checkAll

BUILD SUCCESSFUL in 1s
21 actionable tasks: 12 executed, 9 up-to-date</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lazy_configuration"><a class="anchor" href="#lazy_configuration"></a><a class="link" href="#lazy_configuration">Configuring Tasks Lazily</a></h3>
<div class="paragraph">
<p>Knowing when and where a particular value is configured is difficult to track as a build grows in complexity.
Gradle provides several ways to manage this using <strong>lazy configuration</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/writing-tasks-4.png" alt="writing tasks 4">
</div>
</div>
<div class="sect3">
<h4 id="lazy_properties"><a class="anchor" href="#lazy_properties"></a><a class="link" href="#lazy_properties">Understanding Lazy properties</a></h4>
<div class="paragraph">
<p>Gradle provides lazy properties, which delay calculating a propertys value until its actually required.</p>
</div>
<div class="paragraph">
<p>Lazy properties provide three main benefits:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Deferred Value Resolution:</strong> Allows wiring Gradle models without needing to know when a property&#8217;s value will be known.
For example, you may want to set the input source files of a task based on the source directories property of an extension, but the extension property value isn&#8217;t known until the build script or some other plugin configures them.</p>
</li>
<li>
<p><strong>Automatic Task Dependency Management:</strong> Connects output of one task to input of another, automatically determining task dependencies.
Property instances carry information about which task, if any, produces their value.
Build authors do not need to worry about keeping task dependencies in sync with configuration changes.</p>
</li>
<li>
<p><strong>Improved Build Performance:</strong> Avoids resource-intensive work during configuration, impacting build performance positively.
For example, when a configuration value comes from parsing a file but is only used when functional tests are run, using a property instance to capture this means that the file is parsed only when the functional tests are run (and not when <code>clean</code> is run, for example).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle represents lazy properties with two interfaces:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> </dt>
<dd>
<p>Represents a value that can only be queried and cannot be changed.</p>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are read-only.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#get--">Provider.get()</a> returns the current value of the property.</p>
</li>
<li>
<p>A <code>Provider</code> can be created from another <code>Provider</code> using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a>.</p>
</li>
<li>
<p>Many other types extend <code>Provider</code> and can be used wherever a <code>Provider</code> is required.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> </dt>
<dd>
<p>Represents a value that can be queried and changed.</p>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are configurable.</p>
</li>
<li>
<p><code>Property</code> extends the <code>Provider</code> interface.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#set-T-">Property.set(T)</a> specifies a value for the property, overwriting whatever value may have been present.</p>
</li>
<li>
<p>The method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#set-org.gradle.api.provider.Provider-">Property.set(Provider)</a> specifies a <code>Provider</code> for the value for the property, overwriting whatever value may have been present.
This allows you to wire together <code>Provider</code> and <code>Property</code> instances before the values are configured.</p>
</li>
<li>
<p>A <code>Property</code> can be created by the factory method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(Class)</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Lazy properties are intended to be passed around and only queried when required.
This typically happens during the <a href="#build_phases">execution phase</a>.</p>
</div>
<div class="paragraph">
<p>The following demonstrates a task with a configurable <code>greeting</code> property and a read-only <code>message</code> property:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Greeting : DefaultTask() { // <b class="conum">(1)</b>
    @get:Input
    abstract val greeting: Property&lt;String&gt; // <b class="conum">(2)</b>

    @Internal
    val message: Provider&lt;String&gt; = greeting.map { it + " from Gradle" } // <b class="conum">(3)</b>

    @TaskAction
    fun printMessage() {
        logger.quiet(message.get())
    }
}

tasks.register&lt;Greeting&gt;("greeting") {
    greeting.set("Hi") // <b class="conum">(4)</b>
    greeting = "Hi" // <b class="conum">(5)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Greeting extends DefaultTask { // <b class="conum">(1)</b>
    @Input
    abstract Property&lt;String&gt; getGreeting() // <b class="conum">(2)</b>

    @Internal
    final Provider&lt;String&gt; message = greeting.map { it + ' from Gradle' } // <b class="conum">(3)</b>

    @TaskAction
    void printMessage() {
        logger.quiet(message.get())
    }
}

tasks.register("greeting", Greeting) {
    greeting.set('Hi') // <b class="conum">(4)</b>
    greeting = 'Hi' // <b class="conum">(5)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A task that displays a greeting</p>
</li>
<li>
<p>A configurable greeting</p>
</li>
<li>
<p>Read-only property calculated from the greeting</p>
</li>
<li>
<p>Configure the greeting</p>
</li>
<li>
<p>Alternative notation to calling Property.set()</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle greeting

&gt; Task :greeting
Hi from Gradle

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Greeting</code> task has a property of type <code>Property&lt;String&gt;</code> to represent the configurable greeting and a property of type <code>Provider&lt;String&gt;</code> to represent the calculated, read-only, message.
The message <code>Provider</code> is created from the greeting <code>Property</code> using the <code>map()</code> method; its value is kept up-to-date as the value of the greeting property changes.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating_property_provider"><a class="anchor" href="#creating_property_provider"></a><a class="link" href="#creating_property_provider">Creating a Property or Provider instance</a></h4>
<div class="paragraph">
<p>Neither <code>Provider</code> nor its subtypes, such as <code>Property</code>, are intended to be implemented by a build script or plugin.
Gradle provides factory methods to create instances of these types instead.</p>
</div>
<div class="paragraph">
<p>In the previous example, two factory methods were presented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(Class)</a> create a new <code>Property</code> instance.
An instance of the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> can be referenced from <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#getObjects--">Project.getObjects()</a> or by injecting <code>ObjectFactory</code> through a constructor or method.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a> creates a new <code>Provider</code> from an existing <code>Provider</code> or <code>Property</code> instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="#lazy_configuration_reference">Quick Reference</a> for all of the types and factories available.</p>
</div>
<div class="paragraph">
<p>A <code>Provider</code> can also be created by the factory method <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:provider(java.util.concurrent.Callable)">ProviderFactory.provider(Callable)</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>There are no specific methods to create a provider using a <code>groovy.lang.Closure</code>.</p>
</div>
<div class="paragraph">
<p>When writing a plugin or build script with Groovy, you can use the <code>map(Transformer)</code> method with a closure, and Groovy will convert the closure to a <code>Transformer</code>.</p>
</div>
<div class="paragraph">
<p>Similarly, when writing a plugin or build script with Kotlin, the Kotlin compiler will convert a Kotlin function into a <code>Transformer</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="connecting_properties_together"><a class="anchor" href="#connecting_properties_together"></a><a class="link" href="#connecting_properties_together">Connecting properties together</a></h4>
<div class="paragraph">
<p>An important feature of lazy properties is that they can be connected together so that changes to one property are automatically reflected in other properties.</p>
</div>
<div class="paragraph">
<p>Here is an example where the property of a task is connected to a property of a project extension:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// A project extension
interface MessageExtension {
    // A configurable greeting
    abstract val greeting: Property&lt;String&gt;
}

// A task that displays a greeting
abstract class Greeting : DefaultTask() {
    // Configurable by the user
    @get:Input
    abstract val greeting: Property&lt;String&gt;

    // Read-only property calculated from the greeting
    @Internal
    val message: Provider&lt;String&gt; = greeting.map { it + " from Gradle" }

    @TaskAction
    fun printMessage() {
        logger.quiet(message.get())
    }
}

// Create the project extension
val messages = project.extensions.create&lt;MessageExtension&gt;("messages")

// Create the greeting task
tasks.register&lt;Greeting&gt;("greeting") {
    // Attach the greeting from the project extension
    // Note that the values of the project extension have not been configured yet
    greeting = messages.greeting
}

messages.apply {
    // Configure the greeting on the extension
    // Note that there is no need to reconfigure the task's `greeting` property. This is automatically updated as the extension property changes
    greeting = "Hi"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// A project extension
interface MessageExtension {
    // A configurable greeting
    Property&lt;String&gt; getGreeting()
}

// A task that displays a greeting
abstract class Greeting extends DefaultTask {
    // Configurable by the user
    @Input
    abstract Property&lt;String&gt; getGreeting()

    // Read-only property calculated from the greeting
    @Internal
    final Provider&lt;String&gt; message = greeting.map { it + ' from Gradle' }

    @TaskAction
    void printMessage() {
        logger.quiet(message.get())
    }
}

// Create the project extension
project.extensions.create('messages', MessageExtension)

// Create the greeting task
tasks.register("greeting", Greeting) {
    // Attach the greeting from the project extension
    // Note that the values of the project extension have not been configured yet
    greeting = messages.greeting
}

messages {
    // Configure the greeting on the extension
    // Note that there is no need to reconfigure the task's `greeting` property. This is automatically updated as the extension property changes
    greeting = 'Hi'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle greeting

&gt; Task :greeting
Hi from Gradle

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>This example calls the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#set-org.gradle.api.provider.Provider-">Property.set(Provider)</a> method to attach a <code>Provider</code> to a <code>Property</code> to supply the value of the property.
In this case, the <code>Provider</code> happens to be a <code>Property</code> as well, but you can connect any <code>Provider</code> implementation, for example one created using <code>Provider.map()</code></p>
</div>
</div>
<div class="sect3">
<h4 id="working_with_files_in_lazy_properties"><a class="anchor" href="#working_with_files_in_lazy_properties"></a><a class="link" href="#working_with_files_in_lazy_properties">Working with files</a></h4>
<div class="paragraph">
<p>In <a href="#working_with_files">Working with Files</a>, we introduced four collection types for <code>File</code>-like objects:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Read-only Type</th>
<th class="tableblock halign-left valign-top">Configurable Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileCollection.html">ConfigurableFileCollection</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html">FileTree</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Avoid using <code>FileTree</code> when order matters  it has no guaranteed, stable file order and may cause unpredictable behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All of these types are also considered lazy types.</p>
</div>
<div class="paragraph">
<p>There are more strongly typed models used to represent elements of the file system:
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/Directory.html">Directory</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/RegularFile.html">RegularFile</a>.
These types shouldn&#8217;t be confused with the standard Java <a href="https://docs.oracle.com/javase/8/docs/api//java/io/File.html">File</a> type as they are used to tell Gradle that you expect more specific values such as a directory or a non-directory, regular file.</p>
</div>
<div class="paragraph">
<p>Gradle provides two specialized <code>Property</code> subtypes for dealing with values of these types:
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/RegularFileProperty.html">RegularFileProperty</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html">DirectoryProperty</a>. <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> has methods to create these: <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileProperty--">ObjectFactory.fileProperty()</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#directoryProperty--">ObjectFactory.directoryProperty()</a>.</p>
</div>
<div class="paragraph">
<p>A <code>DirectoryProperty</code> can also be used to create a lazily evaluated <code>Provider</code> for a <code>Directory</code> and <code>RegularFile</code> via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#dir-java.lang.String-">DirectoryProperty.dir(String)</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#file-java.lang.String-">DirectoryProperty.file(String)</a> respectively.
These methods create providers whose values are calculated relative to the location for the <code>DirectoryProperty</code> they were created from.
The values returned from these providers will reflect changes to the <code>DirectoryProperty</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// A task that generates a source file and writes the result to an output directory
abstract class GenerateSource : DefaultTask() {
    // The configuration file to use to generate the source file
    @get:InputFile
    abstract val configFile: RegularFileProperty

    // The directory to write source files to
    @get:OutputDirectory
    abstract val outputDir: DirectoryProperty

    @TaskAction
    fun compile() {
        val inFile = configFile.get().asFile
        logger.quiet("configuration file = $inFile")
        val dir = outputDir.get().asFile
        logger.quiet("output dir = $dir")
        val className = inFile.readText().trim()
        val srcFile = File(dir, "${className}.java")
        srcFile.writeText("public class ${className} { }")
    }
}

// Create the source generation task
tasks.register&lt;GenerateSource&gt;("generate") {
    // Configure the locations, relative to the project and build directories
    configFile = layout.projectDirectory.file("src/config.txt")
    outputDir = layout.buildDirectory.dir("generated-source")
}

// Change the build directory
// Don't need to reconfigure the task properties. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir("output")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// A task that generates a source file and writes the result to an output directory
abstract class GenerateSource extends DefaultTask {
    // The configuration file to use to generate the source file
    @InputFile
    abstract RegularFileProperty getConfigFile()

    // The directory to write source files to
    @OutputDirectory
    abstract DirectoryProperty getOutputDir()

    @TaskAction
    def compile() {
        def inFile = configFile.get().asFile
        logger.quiet("configuration file = $inFile")
        def dir = outputDir.get().asFile
        logger.quiet("output dir = $dir")
        def className = inFile.text.trim()
        def srcFile = new File(dir, "${className}.java")
        srcFile.text = "public class ${className} { ... }"
    }
}

// Create the source generation task
tasks.register('generate', GenerateSource) {
    // Configure the locations, relative to the project and build directories
    configFile = layout.projectDirectory.file('src/config.txt')
    outputDir = layout.buildDirectory.dir('generated-source')
}

// Change the build directory
// Don't need to reconfigure the task properties. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir('output')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-text lang-groovy">
<div class="content">
<pre>$ gradle generate

&gt; Task :generate
configuration file = /home/user/gradle/samples/src/config.txt
output dir = /home/user/gradle/samples/output/generated-source

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="listingblock multi-language-text lang-kotlin">
<div class="content">
<pre>$ gradle generate

&gt; Task :generate
configuration file = /home/user/gradle/samples/kotlin/src/config.txt
output dir = /home/user/gradle/samples/kotlin/output/generated-source

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>This example creates providers that represent locations in the project and build directories through <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#getLayout--">Project.getLayout()</a> with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#getBuildDirectory--">ProjectLayout.getBuildDirectory()</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#getProjectDirectory--">ProjectLayout.getProjectDirectory()</a>.</p>
</div>
<div class="paragraph">
<p>To close the loop, note that a <code>DirectoryProperty</code>, or a simple <code>Directory</code>, can be turned into a <code>FileTree</code> that allows the files and directories contained in the directory to be queried with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#getAsFileTree--">DirectoryProperty.getAsFileTree()</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/Directory.html#getAsFileTree--">Directory.getAsFileTree()</a>.
From a <code>DirectoryProperty</code> or a <code>Directory</code>, you can create <code>FileCollection</code> instances containing a set of the files contained in the directory with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#files-java.lang.Object...-">DirectoryProperty.files(Object...)</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/Directory.html#files-java.lang.Object...-">Directory.files(Object...)</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="working_with_task_dependencies_in_lazy_properties"><a class="anchor" href="#working_with_task_dependencies_in_lazy_properties"></a><a class="link" href="#working_with_task_dependencies_in_lazy_properties">Working with task inputs and outputs</a></h4>
<div class="paragraph">
<p>Many builds have several tasks connected together, where one task consumes the outputs of another task as an input.</p>
</div>
<div class="paragraph">
<p>To make this work, we need to configure each task to know where to look for its inputs and where to place its outputs.
Ensure that the producing and consuming tasks are configured with the same location and attach task dependencies between the tasks.
This can be cumbersome and brittle if any of these values are configurable by a user or configured by multiple plugins, as task properties need to be configured in the correct order and locations, and task dependencies kept in sync as values change.</p>
</div>
<div class="paragraph">
<p>The <code>Property</code> API makes this easier by keeping track of the value of a property and the task that produces the value.</p>
</div>
<div class="paragraph">
<p>As an example, consider the following plugin with a producer and consumer task which are wired together:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Producer : DefaultTask() {
    @get:OutputFile
    abstract val outputFile: RegularFileProperty

    @TaskAction
    fun produce() {
        val message = "Hello, World!"
        val output = outputFile.get().asFile
        output.writeText( message)
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer : DefaultTask() {
    @get:InputFile
    abstract val inputFile: RegularFileProperty

    @TaskAction
    fun consume() {
        val input = inputFile.get().asFile
        val message = input.readText()
        logger.quiet("Read '${message}' from ${input}")
    }
}

val producer = tasks.register&lt;Producer&gt;("producer")
val consumer = tasks.register&lt;Consumer&gt;("consumer")

consumer {
    // Connect the producer task output to the consumer task input
    // Don't need to add a task dependency to the consumer task. This is automatically added
    inputFile = producer.flatMap { it.outputFile }
}

producer {
    // Set values for the producer lazily
    // Don't need to update the consumer.inputFile property. This is automatically updated as producer.outputFile changes
    outputFile = layout.buildDirectory.file("file.txt")
}

// Change the build directory.
// Don't need to update producer.outputFile and consumer.inputFile. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir("output")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Producer extends DefaultTask {
    @OutputFile
    abstract RegularFileProperty getOutputFile()

    @TaskAction
    void produce() {
        String message = 'Hello, World!'
        def output = outputFile.get().asFile
        output.text = message
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer extends DefaultTask {
    @InputFile
    abstract RegularFileProperty getInputFile()

    @TaskAction
    void consume() {
        def input = inputFile.get().asFile
        def message = input.text
        logger.quiet("Read '${message}' from ${input}")
    }
}

def producer = tasks.register("producer", Producer)
def consumer = tasks.register("consumer", Consumer)

consumer.configure {
    // Connect the producer task output to the consumer task input
    // Don't need to add a task dependency to the consumer task. This is automatically added
    inputFile = producer.flatMap { it.outputFile }
}

producer.configure {
    // Set values for the producer lazily
    // Don't need to update the consumer.inputFile property. This is automatically updated as producer.outputFile changes
    outputFile = layout.buildDirectory.file('file.txt')
}

// Change the build directory.
// Don't need to update producer.outputFile and consumer.inputFile. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir('output')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-text lang-groovy">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producer
Wrote 'Hello, World!' to /home/user/gradle/samples/output/file.txt

&gt; Task :consumer
Read 'Hello, World!' from /home/user/gradle/samples/output/file.txt

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="listingblock multi-language-text lang-kotlin">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producer
Wrote 'Hello, World!' to /home/user/gradle/samples/kotlin/output/file.txt

&gt; Task :consumer
Read 'Hello, World!' from /home/user/gradle/samples/kotlin/output/file.txt

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the task outputs and inputs are connected before any location is defined.
The setters can be called at any time before the task is executed, and the change will automatically affect all related input and output properties.</p>
</div>
<div class="paragraph">
<p>Another important thing to note in this example is the absence of any explicit task dependency.
Task outputs represented using <code>Providers</code> keep track of which task produces their value, and using them as task inputs will implicitly add the correct task dependencies.</p>
</div>
<div class="paragraph">
<p>Implicit task dependencies also work for input properties that are not files:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Producer : DefaultTask() {
    @get:OutputFile
    abstract val outputFile: RegularFileProperty

    @TaskAction
    fun produce() {
        val message = "Hello, World!"
        val output = outputFile.get().asFile
        output.writeText( message)
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer : DefaultTask() {
    @get:Input
    abstract val message: Property&lt;String&gt;

    @TaskAction
    fun consume() {
        logger.quiet(message.get())
    }
}

val producer = tasks.register&lt;Producer&gt;("producer") {
    // Set values for the producer lazily
    // Don't need to update the consumer.inputFile property. This is automatically updated as producer.outputFile changes
    outputFile = layout.buildDirectory.file("file.txt")
}
tasks.register&lt;Consumer&gt;("consumer") {
    // Connect the producer task output to the consumer task input
    // Don't need to add a task dependency to the consumer task. This is automatically added
    message = producer.flatMap { it.outputFile }.map { it.asFile.readText() }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Producer extends DefaultTask {
    @OutputFile
    abstract RegularFileProperty getOutputFile()

    @TaskAction
    void produce() {
        String message = 'Hello, World!'
        def output = outputFile.get().asFile
        output.text = message
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getMessage()

    @TaskAction
    void consume() {
        logger.quiet(message.get())
    }
}

def producer = tasks.register('producer', Producer) {
    // Set values for the producer lazily
    // Don't need to update the consumer.inputFile property. This is automatically updated as producer.outputFile changes
    outputFile = layout.buildDirectory.file('file.txt')
}
tasks.register('consumer', Consumer) {
    // Connect the producer task output to the consumer task input
    // Don't need to add a task dependency to the consumer task. This is automatically added
    message = producer.flatMap { it.outputFile }.map { it.asFile.text }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-text lang-groovy">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producer
Wrote 'Hello, World!' to /home/user/gradle/samples/build/file.txt

&gt; Task :consumer
Hello, World!

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="listingblock multi-language-text lang-kotlin">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producer
Wrote 'Hello, World!' to /home/user/gradle/samples/kotlin/build/file.txt

&gt; Task :consumer
Hello, World!

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="working_with_collections"><a class="anchor" href="#working_with_collections"></a><a class="link" href="#working_with_collections">Working with collections</a></h4>
<div class="paragraph">
<p>Gradle provides two lazy property types to help configure <code>Collection</code> properties.</p>
</div>
<div class="paragraph">
<p>These work exactly like any other <code>Provider</code> and, just like file providers, they have additional modeling around them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>List</code> values the interface is called <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/ListProperty.html">ListProperty</a>.<br>
You can create a new <code>ListProperty</code> using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#listProperty-java.lang.Class-">ObjectFactory.listProperty(Class)</a> and specifying the element type.</p>
</li>
<li>
<p>For <code>Set</code> values the interface is called <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/SetProperty.html">SetProperty</a>.<br>
You can create a new <code>SetProperty</code> using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#setProperty-java.lang.Class-">ObjectFactory.setProperty(Class)</a> and specifying the element type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This type of property allows you to overwrite the entire collection value with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasMultipleValues.html#set-java.lang.Iterable-">HasMultipleValues.set(Iterable)</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasMultipleValues.html#set-org.gradle.api.provider.Provider-">HasMultipleValues.set(Provider)</a> or add new elements through the various <code>add</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasMultipleValues.html#add-T-">HasMultipleValues.add(T)</a>: Add a single element to the collection</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasMultipleValues.html#add-org.gradle.api.provider.Provider-">HasMultipleValues.add(Provider)</a>: Add a lazily calculated element to the collection</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasMultipleValues.html#addAll-org.gradle.api.provider.Provider-">HasMultipleValues.addAll(Provider)</a>: Add a lazily calculated collection of elements to the list</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Just like every <code>Provider</code>, the collection is calculated when <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#get--">Provider.get()</a> is called. The following example shows the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/ListProperty.html">ListProperty</a> in action:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Producer : DefaultTask() {
    @get:OutputFile
    abstract val outputFile: RegularFileProperty

    @TaskAction
    fun produce() {
        val message = "Hello, World!"
        val output = outputFile.get().asFile
        output.writeText( message)
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer : DefaultTask() {
    @get:InputFiles
    abstract val inputFiles: ListProperty&lt;RegularFile&gt;

    @TaskAction
    fun consume() {
        inputFiles.get().forEach { inputFile -&gt;
            val input = inputFile.asFile
            val message = input.readText()
            logger.quiet("Read '${message}' from ${input}")
        }
    }
}

val producerOne = tasks.register&lt;Producer&gt;("producerOne")
val producerTwo = tasks.register&lt;Producer&gt;("producerTwo")
tasks.register&lt;Consumer&gt;("consumer") {
    // Connect the producer task outputs to the consumer task input
    // Don't need to add task dependencies to the consumer task. These are automatically added
    inputFiles.add(producerOne.get().outputFile)
    inputFiles.add(producerTwo.get().outputFile)
}

// Set values for the producer tasks lazily
// Don't need to update the consumer.inputFiles property. This is automatically updated as producer.outputFile changes
producerOne { outputFile = layout.buildDirectory.file("one.txt") }
producerTwo { outputFile = layout.buildDirectory.file("two.txt") }

// Change the build directory.
// Don't need to update the task properties. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir("output")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Producer extends DefaultTask {
    @OutputFile
    abstract RegularFileProperty getOutputFile()

    @TaskAction
    void produce() {
        String message = 'Hello, World!'
        def output = outputFile.get().asFile
        output.text = message
        logger.quiet("Wrote '${message}' to ${output}")
    }
}

abstract class Consumer extends DefaultTask {
    @InputFiles
    abstract ListProperty&lt;RegularFile&gt; getInputFiles()

    @TaskAction
    void consume() {
        inputFiles.get().each { inputFile -&gt;
            def input = inputFile.asFile
            def message = input.text
            logger.quiet("Read '${message}' from ${input}")
        }
    }
}

def producerOne = tasks.register('producerOne', Producer)
def producerTwo = tasks.register('producerTwo', Producer)
tasks.register('consumer', Consumer) {
    // Connect the producer task outputs to the consumer task input
    // Don't need to add task dependencies to the consumer task. These are automatically added
    inputFiles.add(producerOne.get().outputFile)
    inputFiles.add(producerTwo.get().outputFile)
}

// Set values for the producer tasks lazily
// Don't need to update the consumer.inputFiles property. This is automatically updated as producer.outputFile changes
producerOne.configure { outputFile = layout.buildDirectory.file('one.txt') }
producerTwo.configure { outputFile = layout.buildDirectory.file('two.txt') }

// Change the build directory.
// Don't need to update the task properties. These are automatically updated as the build directory changes
layout.buildDirectory = layout.projectDirectory.dir('output')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-text lang-groovy">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producerOne
Wrote 'Hello, World!' to /home/user/gradle/samples/output/one.txt

&gt; Task :producerTwo
Wrote 'Hello, World!' to /home/user/gradle/samples/output/two.txt

&gt; Task :consumer
Read 'Hello, World!' from /home/user/gradle/samples/output/one.txt
Read 'Hello, World!' from /home/user/gradle/samples/output/two.txt

BUILD SUCCESSFUL in 0s
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="listingblock multi-language-text lang-kotlin">
<div class="content">
<pre>$ gradle consumer

&gt; Task :producerOne
Wrote 'Hello, World!' to /home/user/gradle/samples/kotlin/output/one.txt

&gt; Task :producerTwo
Wrote 'Hello, World!' to /home/user/gradle/samples/kotlin/output/two.txt

&gt; Task :consumer
Read 'Hello, World!' from /home/user/gradle/samples/kotlin/output/one.txt
Read 'Hello, World!' from /home/user/gradle/samples/kotlin/output/two.txt

BUILD SUCCESSFUL in 0s
3 actionable tasks: 3 executed</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="working_with_maps"><a class="anchor" href="#working_with_maps"></a><a class="link" href="#working_with_maps">Working with maps</a></h4>
<div class="paragraph">
<p>Gradle provides a lazy <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/MapProperty.html">MapProperty</a> type to allow <code>Map</code> values to be configured.
You can create a <code>MapProperty</code> instance using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#mapProperty-java.lang.Class-java.lang.Class-">ObjectFactory.mapProperty(Class, Class)</a>.</p>
</div>
<div class="paragraph">
<p>Similar to other property types, a <code>MapProperty</code> has a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/MapProperty.html#set-java.util.Map-">set()</a> method that you can use to specify the value for the property.
Some additional methods allow entries with lazy values to be added to the map.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Generator: DefaultTask() {
    @get:Input
    abstract val properties: MapProperty&lt;String, Int&gt;

    @TaskAction
    fun generate() {
        properties.get().forEach { entry -&gt;
            logger.quiet("${entry.key} = ${entry.value}")
        }
    }
}

// Some values to be configured later
var b = 0
var c = 0

tasks.register&lt;Generator&gt;("generate") {
    properties.put("a", 1)
    // Values have not been configured yet
    properties.put("b", providers.provider { b })
    properties.putAll(providers.provider { mapOf("c" to c, "d" to c + 1) })
}

// Configure the values. There is no need to reconfigure the task
b = 2
c = 3</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Generator extends DefaultTask {
    @Input
    abstract MapProperty&lt;String, Integer&gt; getProperties()

    @TaskAction
    void generate() {
        properties.get().each { key, value -&gt;
            logger.quiet("${key} = ${value}")
        }
    }
}

// Some values to be configured later
def b = 0
def c = 0

tasks.register('generate', Generator) {
    properties.put("a", 1)
    // Values have not been configured yet
    properties.put("b", providers.provider { b })
    properties.putAll(providers.provider { [c: c, d: c + 1] })
}

// Configure the values. There is no need to reconfigure the task
b = 2
c = 3</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle generate

&gt; Task :generate
a = 1
b = 2
c = 3
d = 4

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="applying_conventions"><a class="anchor" href="#applying_conventions"></a><a class="link" href="#applying_conventions">Applying a convention to a property</a></h4>
<div class="paragraph">
<p>Often, you want to apply some <em>convention</em>, or default value to a property to be used if no value has been configured.
You can use the <code>convention()</code> method for this.
This method accepts either a value or a <code>Provider</code>, and this will be used as the value until some other value is configured.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("show") {
    val property = objects.property(String::class)

    // Set a convention
    property.convention("convention 1")

    println("value = " + property.get())

    // Can replace the convention
    property.convention("convention 2")
    println("value = " + property.get())

    property.set("explicit value")

    // Once a value is set, the convention is ignored
    property.convention("ignored convention")

    doLast {
        println("value = " + property.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("show") {
    def property = objects.property(String)

    // Set a convention
    property.convention("convention 1")

    println("value = " + property.get())

    // Can replace the convention
    property.convention("convention 2")
    println("value = " + property.get())

    property.set("explicit value")

    // Once a value is set, the convention is ignored
    property.convention("ignored convention")

    doLast {
        println("value = " + property.get())
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle show
value = convention 1
value = convention 2

&gt; Task :show
value = explicit value

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="sect4">
<h5 id="where_to_apply_conventions_from"><a class="anchor" href="#where_to_apply_conventions_from"></a><a class="link" href="#where_to_apply_conventions_from">Where to apply conventions from?</a></h5>
<div class="paragraph">
<p>There are several appropriate locations for setting a convention on a property at configuration time (i.e., before execution).</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// setting convention when registering a task from plugin
class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        project.getTasks().register&lt;GreetingTask&gt;("hello") {
            greeter.convention("Greeter")
        }
    }
}

apply&lt;GreetingPlugin&gt;()

tasks.withType&lt;GreetingTask&gt;().configureEach {
    // setting convention from build script
    guest.convention("Guest")
}

abstract class GreetingTask : DefaultTask() {
    // setting convention from constructor
    @get:Input
    abstract val guest: Property&lt;String&gt;

    init {
        guest.convention("person2")
    }

    // setting convention from declaration
    @Input
    val greeter = project.objects.property&lt;String&gt;().convention("person1")

    @TaskAction
    fun greet() {
        println("hello, ${guest.get()}, from ${greeter.get()}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// setting convention when registering a task from plugin
class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        project.getTasks().register("hello", GreetingTask) {
            greeter.convention("Greeter")
        }
    }
}

apply plugin: GreetingPlugin

tasks.withType(GreetingTask).configureEach {
    // setting convention from build script
    guest.convention("Guest")
}

abstract class GreetingTask extends DefaultTask {
    // setting convention from constructor
    @Input
    abstract Property&lt;String&gt; getGuest()

    GreetingTask() {
        guest.convention("person2")
    }

    // setting convention from declaration
    @Input
    final Property&lt;String&gt; greeter = project.objects.property(String).convention("person1")

    @TaskAction
    void greet() {
        println("hello, ${guest.get()}, from ${greeter.get()}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="from_a_plugins_apply_method"><a class="anchor" href="#from_a_plugins_apply_method"></a><a class="link" href="#from_a_plugins_apply_method">From a plugin&#8217;s <code>apply()</code> method</a></h6>
<div class="paragraph">
<p>Plugin authors may configure a convention on a lazy property from a plugin&#8217;s <code>apply()</code> method, while performing preliminary configuration of the task or extension defining the property.
This works well for regular plugins (meant to be distributed and used in the wild), and internal <a href="#sec:sharing_logic_via_convention_plugins">convention plugins</a> (which often configure properties defined by third party plugins in a uniform way for the entire build).</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// setting convention when registering a task from plugin
class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        project.getTasks().register&lt;GreetingTask&gt;("hello") {
            greeter.convention("Greeter")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// setting convention when registering a task from plugin
class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        project.getTasks().register("hello", GreetingTask) {
            greeter.convention("Greeter")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="from_a_build_script"><a class="anchor" href="#from_a_build_script"></a><a class="link" href="#from_a_build_script">From a build script</a></h6>
<div class="paragraph">
<p>Build engineers may configure a convention on a lazy property from shared build logic that is configuring tasks (for instance, from third-party plugins) in a standard way for the entire build.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply&lt;GreetingPlugin&gt;()

tasks.withType&lt;GreetingTask&gt;().configureEach {
    // setting convention from build script
    guest.convention("Guest")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(GreetingTask).configureEach {
    // setting convention from build script
    guest.convention("Guest")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that for project-specific values, instead of conventions, you should prefer setting explicit values (using <code>Property.set(&#8230;&#8203;)</code> or <code>ConfigurableFileCollection.setFrom(&#8230;&#8203;)</code>, for instance),
as conventions are only meant to define defaults.</p>
</div>
</div>
<div class="sect5">
<h6 id="from_the_task_initialization"><a class="anchor" href="#from_the_task_initialization"></a><a class="link" href="#from_the_task_initialization">From the task initialization</a></h6>
<div class="paragraph">
<p>A task author may configure a convention on a lazy property from the task constructor or (if in Kotlin) initializer block.
This approach works for properties with trivial defaults, but it is not appropriate if additional context (external to the task implementation) is required in order to set a suitable default.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// setting convention from constructor
@get:Input
abstract val guest: Property&lt;String&gt;

init {
    guest.convention("person2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// setting convention from constructor
@Input
abstract Property&lt;String&gt; getGuest()

GreetingTask() {
    guest.convention("person2")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="next_to_the_property_declaration"><a class="anchor" href="#next_to_the_property_declaration"></a><a class="link" href="#next_to_the_property_declaration">Next to the property declaration</a></h6>
<div class="paragraph">
<p>You may configure a convention on a lazy property next to the place where the property is declared.
Note this option is not available for <a href="#managed_properties">managed properties</a>, and has the same caveats as configuring a convention from the task constructor.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// setting convention from declaration
@Input
val greeter = project.objects.property&lt;String&gt;().convention("person1")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// setting convention from declaration
@Input
final Property&lt;String&gt; greeter = project.objects.property(String).convention("person1")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unmodifiable_property"><a class="anchor" href="#unmodifiable_property"></a><a class="link" href="#unmodifiable_property">Making a property unmodifiable</a></h4>
<div class="paragraph">
<p>Most properties of a task or project are intended to be configured by plugins or build scripts so that they can use specific values for that build.</p>
</div>
<div class="paragraph">
<p>For example, a property that specifies the output directory for a compilation task may start with a value specified by a plugin.
Then a build script might change the value to some custom location, then this value is used by the task when it runs.
However, once the task starts to run, we want to prevent further property changes.
This way we avoid errors that result from different consumers, such as the task action, Gradle&#8217;s up-to-date checks, build caching, or other tasks, using different values for the property.</p>
</div>
<div class="paragraph">
<p>Lazy properties provide several methods that you can use to disallow changes to their value once the value has been configured.
The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html#finalizeValue--">finalizeValue()</a> method calculates the <em>final</em> value for the property and prevents further changes to the property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">libVersioning.version.finalizeValue()</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the property&#8217;s value comes from a <code>Provider</code>, the provider is queried for its current value, and the result becomes the final value for the property.
This final value replaces the provider and the property no longer tracks the value of the provider.
Calling this method also makes a property instance unmodifiable and any further attempts to change the value of the property will fail.
Gradle automatically makes the properties of a task final when the task starts execution.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/HasConfigurableValue.html#finalizeValueOnRead--">finalizeValueOnRead()</a> method is similar, except that the property&#8217;s final value is not calculated until the value of the property is queried.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">modifiedFiles.finalizeValueOnRead()</code></pre>
</div>
</div>
<div class="paragraph">
<p>In other words, this method calculates the final value lazily as required, whereas <code>finalizeValue()</code> calculates the final value eagerly.
This method can be used when the value may be expensive to calculate or may not have been configured yet.
You also want to ensure that all consumers of the property see the same value when they query the value.</p>
</div>
</div>
<div class="sect3">
<h4 id="lazy_configuration_faqs"><a class="anchor" href="#lazy_configuration_faqs"></a><a class="link" href="#lazy_configuration_faqs">Using the Provider API</a></h4>
<div class="paragraph">
<p>Guidelines to be successful with the Provider API:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> types have all of the overloads you need to query or configure a value. For this reason, you should follow the following guidelines:</p>
<div class="ulist">
<ul>
<li>
<p>For configurable properties, expose the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> directly through a single getter.</p>
</li>
<li>
<p>For non-configurable properties, expose an <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> directly through a single getter.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Do not try to simplify calls like <code>obj.getProperty().get()</code> and <code>obj.getProperty().set(T)</code> in your code by introducing additional getters and setters.
Using such wrapper methods would undermine the purpose of <code>Property</code> and prevent wiring of properties together.
It would cause the current value to be obtained immediately (rather than being lazily evaluated).</p>
</li>
<li>
<p>When migrating your plugin to use providers, follow these guidelines:</p>
<div class="ulist">
<ul>
<li>
<p>If it&#8217;s a new property, expose it as a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> using a single getter.</p>
</li>
<li>
<p>If it&#8217;s incubating, change it to use a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> using a single getter.</p>
</li>
<li>
<p>If it&#8217;s a stable property, add a new <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a> and deprecate the old one. You should wire the old getter/setters into the new property as appropriate.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="lazy_configuration_reference"><a class="anchor" href="#lazy_configuration_reference"></a><a class="link" href="#lazy_configuration_reference">Provider Files API Reference</a></h5>
<div class="paragraph">
<p>Use these types for <em>read-only</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a>&lt;<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/RegularFile.html">RegularFile</a>&gt;</dt>
<dd>
<p>File on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#flatMap-org.gradle.api.Transformer-">Provider.flatMap(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#file-java.lang.String-">DirectoryProperty.file(String)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider</a>&lt;<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/Directory.html">Directory</a>&gt;</dt>
<dd>
<p>Directory on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#flatMap-org.gradle.api.Transformer-">Provider.flatMap(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#dir-java.lang.String-">DirectoryProperty.dir(String)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p>Unstructured collection of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(Object[])</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(Object...)</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#files-java.lang.Object...-">DirectoryProperty.files(Object...)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html">FileTree</a></dt>
<dd>
<p>Hierarchy of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(Object)</a> will produce a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a>, or you can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#zipTree-java.lang.Object-">Project.zipTree(Object)</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#tarTree-java.lang.Object-">Project.tarTree(Object)</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html#getAsFileTree--">DirectoryProperty.getAsFileTree()</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="property_files_api_reference"><a class="anchor" href="#property_files_api_reference"></a><a class="link" href="#property_files_api_reference">Property Files API Reference</a></h5>
<div class="paragraph">
<p>Use these types for <em>mutable</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/RegularFileProperty.html">RegularFileProperty</a></dt>
<dd>
<p>File on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileProperty--">ObjectFactory.fileProperty()</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html">DirectoryProperty</a></dt>
<dd>
<p>Directory on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#directoryProperty--">ObjectFactory.directoryProperty()</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileCollection.html">ConfigurableFileCollection</a></dt>
<dd>
<p>Unstructured collection of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileCollection--">ObjectFactory.fileCollection()</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a></dt>
<dd>
<p>Hierarchy of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileTree--">ObjectFactory.fileTree()</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p>Hierarchy of source directories</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#sourceDirectorySet-java.lang.String-java.lang.String-">ObjectFactory.sourceDirectorySet(String, String)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="lazy_collections_api_reference"><a class="anchor" href="#lazy_collections_api_reference"></a><a class="link" href="#lazy_collections_api_reference">Lazy Collections API Reference</a></h5>
<div class="paragraph">
<p>Use these types for <em>mutable</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/ListProperty.html">ListProperty&lt;T&gt;</a></dt>
<dd>
<p>a property whose value is <code>List&lt;T&gt;</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#listProperty-java.lang.Class-">ObjectFactory.listProperty(Class)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/SetProperty.html">SetProperty&lt;T&gt;</a></dt>
<dd>
<p>a property whose value is <code>Set&lt;T&gt;</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#setProperty-java.lang.Class-">ObjectFactory.setProperty(Class)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="lazy_objects_api_reference"><a class="anchor" href="#lazy_objects_api_reference"></a><a class="link" href="#lazy_objects_api_reference">Lazy Objects API Reference</a></h5>
<div class="paragraph">
<p>Use these types for <em>read only</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html">Provider&lt;T&gt;</a></dt>
<dd>
<p>a property whose value is an instance of <code>T</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#map-org.gradle.api.Transformer-">Provider.map(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Provider.html#flatMap-org.gradle.api.Transformer-">Provider.flatMap(Transformer)</a>.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:provider(java.util.concurrent.Callable)">ProviderFactory.provider(Callable)</a>. Always prefer one of the other factory methods over this method.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Use these types for <em>mutable</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/Property.html">Property&lt;T&gt;</a></dt>
<dd>
<p>a property whose value is an instance of <code>T</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(Class)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks_parallel_worker"><a class="anchor" href="#tasks_parallel_worker"></a><a class="link" href="#tasks_parallel_worker">Developing Parallel Tasks</a></h3>
<div class="paragraph">
<p>Gradle provides an API that can split tasks into sections that can be executed in parallel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/writing-tasks-5.png" alt="writing tasks 5">
</div>
</div>
<div class="paragraph">
<p>This allows Gradle to fully utilize the resources available and complete builds faster.</p>
</div>
<div class="sect3">
<h4 id="worker_api"><a class="anchor" href="#worker_api"></a><a class="link" href="#worker_api">The Worker API</a></h4>
<div class="paragraph">
<p>The Worker API provides the ability to break up the execution of a task action into discrete units of work and then execute that work concurrently and asynchronously.</p>
</div>
</div>
<div class="sect3">
<h4 id="worker_api_example"><a class="anchor" href="#worker_api_example"></a><a class="link" href="#worker_api_example">Worker API example</a></h4>
<div class="paragraph">
<p>The best way to understand how to use the API is to go through the process of converting an existing custom task to use the Worker API:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You&#8217;ll start by creating a custom task class that generates MD5 hashes for a configurable set of files.</p>
</li>
<li>
<p>Then, you&#8217;ll convert this custom task to use the Worker API.</p>
</li>
<li>
<p>Then, we&#8217;ll explore running the task with different levels of isolation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the process, you&#8217;ll learn about the basics of the Worker API and the capabilities it provides.</p>
</div>
<div class="sect4">
<h5 id="step_1_create_a_custom_task_class"><a class="anchor" href="#step_1_create_a_custom_task_class"></a><a class="link" href="#step_1_create_a_custom_task_class">Step 1. Create a custom task class</a></h5>
<div class="paragraph">
<p>First, create a custom task that generates MD5 hashes of a configurable set of files.</p>
</div>
<div class="paragraph">
<p>In a new directory, create a <code>buildSrc/build.gradle(.kts)</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("commons-io:commons-io:2.5")
    implementation("commons-codec:commons-codec:1.9") // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation 'commons-io:commons-io:2.5'
    implementation 'commons-codec:commons-codec:1.9' // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Your custom task class will use <a href="https://commons.apache.org/proper/commons-codec/">Apache Commons Codec</a> to generate MD5 hashes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Next, create a custom task class in your <code>buildSrc/src/main/java</code> directory.
You should name this class <code>CreateMD5</code>:</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/CreateMD5.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.apache.commons.codec.digest.DigestUtils;
import org.apache.commons.io.FileUtils;
import org.gradle.api.file.DirectoryProperty;
import org.gradle.api.file.RegularFile;
import org.gradle.api.provider.Provider;
import org.gradle.api.tasks.OutputDirectory;
import org.gradle.api.tasks.SourceTask;
import org.gradle.api.tasks.TaskAction;
import org.gradle.workers.WorkerExecutor;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

abstract public class CreateMD5 extends SourceTask { // <b class="conum">(1)</b>

    @OutputDirectory
    abstract public DirectoryProperty getDestinationDirectory(); // <b class="conum">(2)</b>

    @TaskAction
    public void createHashes() {
        for (File sourceFile : getSource().getFiles()) { // <b class="conum">(3)</b>
            try {
                InputStream stream = new FileInputStream(sourceFile);
                System.out.println("Generating MD5 for " + sourceFile.getName() + "...");
                // Artificially make this task slower.
                Thread.sleep(3000); // <b class="conum">(4)</b>
                Provider&lt;RegularFile&gt; md5File = getDestinationDirectory().file(sourceFile.getName() + ".md5");  // <b class="conum">(5)</b>
                FileUtils.writeStringToFile(md5File.get().getAsFile(), DigestUtils.md5Hex(stream), (String) null);
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/SourceTask.html">SourceTask</a> is a convenience type for tasks that operate on a set of source files.</p>
</li>
<li>
<p>The task output will go into a configured directory.</p>
</li>
<li>
<p>The task iterates over all the files defined as "source files" and creates an MD5 hash of each.</p>
</li>
<li>
<p>Insert an artificial sleep to simulate hashing a large file (the sample files won&#8217;t be that large).</p>
</li>
<li>
<p>The MD5 hash of each file is written to the output directory into a file of the same name with an "md5" extension.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Next, create a <code>build.gradle(.kts)</code> that registers your new <code>CreateMD5</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins { id("base") } // <b class="conum">(1)</b>

tasks.register&lt;CreateMD5&gt;("md5") {
    destinationDirectory = project.layout.buildDirectory.dir("md5") // <b class="conum">(2)</b>
    source(project.layout.projectDirectory.file("src")) // <b class="conum">(3)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins { id 'base' } // <b class="conum">(1)</b>

tasks.register("md5", CreateMD5) {
    destinationDirectory = project.layout.buildDirectory.dir("md5") // <b class="conum">(2)</b>
    source(project.layout.projectDirectory.file('src')) // <b class="conum">(3)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Apply the <code>base</code> plugin so that you&#8217;ll have a <code>clean</code> task to use to remove the output.</p>
</li>
<li>
<p>MD5 hash files will be written to <code>build/md5</code>.</p>
</li>
<li>
<p>This task will generate MD5 hash files for every file in the <code>src</code> directory.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will need some source to generate MD5 hashes from.
Create three files in the <code>src</code> directory:</p>
</div>
<div class="listingblock">
<div class="title">src/einstein.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Intellectual growth should commence at birth and cease only at death.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">src/feynman.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">I was born not knowing and have had only a little time to change that here and there.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">src/hawking.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Intelligence is the ability to adapt to change.</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, you can test your task by running it <code>./gradlew md5</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle md5</pre>
</div>
</div>
<div class="paragraph">
<p>The output should look similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :md5
Generating MD5 for einstein.txt...
Generating MD5 for feynman.txt...
Generating MD5 for hawking.txt...

BUILD SUCCESSFUL in 9s
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>build/md5</code> directory, you should now see corresponding files with an <code>md5</code> extension containing MD5 hashes of the files from the <code>src</code> directory.
Notice that the task takes at least 9 seconds to run because it hashes each file one at a time (i.e., three files at ~3 seconds apiece).</p>
</div>
</div>
<div class="sect4">
<h5 id="converting_to_worker_api"><a class="anchor" href="#converting_to_worker_api"></a><a class="link" href="#converting_to_worker_api">Step 2. Convert to the Worker API</a></h5>
<div class="paragraph">
<p>Although this task processes each file in sequence, the processing of each file is independent of any other file.
This work can be done in parallel and take advantage of multiple processors.
This is where the Worker API can help.</p>
</div>
<div class="paragraph">
<p>To use the Worker API, you need to define an interface that represents the parameters of each unit of work and extends <code>org.gradle.workers.WorkParameters</code>.</p>
</div>
<div class="paragraph">
<p>For the generation of MD5 hash files, the unit of work will require two parameters:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the file to be hashed and,</p>
</li>
<li>
<p>the file to write the hash to.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There is no need to create a concrete implementation because Gradle will generate one for us at runtime.</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/MD5WorkParameters.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.file.RegularFileProperty;
import org.gradle.workers.WorkParameters;

public interface MD5WorkParameters extends WorkParameters {
    RegularFileProperty getSourceFile(); // <b class="conum">(1)</b>
    RegularFileProperty getMD5File();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use <code>Property</code> objects to represent the source and MD5 hash files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then, you need to refactor the part of your custom task that does the work for each individual file into a separate class.
This class is your "unit of work" implementation, and it should be an abstract class that extends <code>org.gradle.workers.WorkAction</code>:</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/GenerateMD5.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.apache.commons.codec.digest.DigestUtils;
import org.apache.commons.io.FileUtils;
import org.gradle.workers.WorkAction;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

public abstract class GenerateMD5 implements WorkAction&lt;MD5WorkParameters&gt; { // <b class="conum">(1)</b>
    @Override
    public void execute() {
        try {
            File sourceFile = getParameters().getSourceFile().getAsFile().get();
            File md5File = getParameters().getMD5File().getAsFile().get();
            InputStream stream = new FileInputStream(sourceFile);
            System.out.println("Generating MD5 for " + sourceFile.getName() + "...");
            // Artificially make this task slower.
            Thread.sleep(3000);
            FileUtils.writeStringToFile(md5File, DigestUtils.md5Hex(stream), (String) null);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Do not implement the <code>getParameters()</code> method - Gradle will inject this at runtime.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, change your custom task class to submit work to the
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a> instead of doing the work itself.</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/CreateMD5.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Action;
import org.gradle.api.file.RegularFile;
import org.gradle.api.provider.Provider;
import org.gradle.api.tasks.*;
import org.gradle.workers.*;
import org.gradle.api.file.DirectoryProperty;

import javax.inject.Inject;
import java.io.File;

abstract public class CreateMD5 extends SourceTask {

    @OutputDirectory
    abstract public DirectoryProperty getDestinationDirectory();

    @Inject
    abstract public WorkerExecutor getWorkerExecutor(); // <b class="conum">(1)</b>

    @TaskAction
    public void createHashes() {
        WorkQueue workQueue = getWorkerExecutor().noIsolation(); // <b class="conum">(2)</b>

        for (File sourceFile : getSource().getFiles()) {
            Provider&lt;RegularFile&gt; md5File = getDestinationDirectory().file(sourceFile.getName() + ".md5");
            workQueue.submit(GenerateMD5.class, parameters -&gt; { // <b class="conum">(3)</b>
                parameters.getSourceFile().set(sourceFile);
                parameters.getMD5File().set(md5File);
            });
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a> service is required in order to submit your work.
Create an abstract getter method annotated <code>javax.inject.Inject</code>, and Gradle will inject the service at runtime when the task is created.</p>
</li>
<li>
<p>Before submitting work, get a <code>WorkQueue</code> object with the desired isolation mode (described below).</p>
</li>
<li>
<p>When submitting the unit of work, specify the unit of work implementation, in this case <code>GenerateMD5</code>, and configure its parameters.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point, you should be able to rerun your task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle clean md5

&gt; Task :md5
Generating MD5 for einstein.txt...
Generating MD5 for feynman.txt...
Generating MD5 for hawking.txt...

BUILD SUCCESSFUL in 3s
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The results should look the same as before, although the MD5 hash files may be generated in a different order since the units of work are executed in parallel.
This time, however, the task runs much faster.
This is because the Worker API executes the MD5 calculation for each file in parallel rather than in sequence.</p>
</div>
</div>
<div class="sect4">
<h5 id="step_3_change_the_isolation_mode"><a class="anchor" href="#step_3_change_the_isolation_mode"></a><a class="link" href="#step_3_change_the_isolation_mode">Step 3. Change the isolation mode</a></h5>
<div class="paragraph">
<p>The isolation mode controls how strongly Gradle will isolate items of work from each other and the rest of the Gradle runtime.</p>
</div>
<div class="paragraph">
<p>There are three methods on <code>WorkerExecutor</code> that control this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>noIsolation()</code></p>
</li>
<li>
<p><code>classLoaderIsolation()</code></p>
</li>
<li>
<p><code>processIsolation()</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>noIsolation()</code> mode is the lowest level of isolation and will prevent a unit of work from changing the project state.
This is the fastest isolation mode because it requires the least overhead to set up and execute the work item.
However, it will use a single shared classloader for all units of work.
This means that each unit of work can affect one another through static class state.
It also means that every unit of work uses the same version of libraries on the buildscript classpath.
If you wanted the user to be able to configure the task to run with a different (but compatible) version of the
<a href="https://commons.apache.org/proper/commons-codec/">Apache Commons Codec</a> library, you would need to use a different isolation mode.</p>
</div>
<div class="paragraph">
<p>First, you must change the dependency in <code>buildSrc/build.gradle</code> to be <code>compileOnly</code>.
This tells Gradle that it should use this dependency when building the classes, but should not put it on the build script classpath:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("commons-io:commons-io:2.5")
    compileOnly("commons-codec:commons-codec:1.9")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation 'commons-io:commons-io:2.5'
    compileOnly 'commons-codec:commons-codec:1.9'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Next, change the <code>CreateMD5</code> task to allow the user to configure the version of the codec library that they want to use.
It will resolve the appropriate version of the library at runtime and configure the workers to use this version.</p>
</div>
<div class="paragraph">
<p>The <code>classLoaderIsolation()</code> method tells Gradle to run this work in a thread with an isolated classloader:</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/CreateMD5.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.gradle.api.Action;
import org.gradle.api.file.ConfigurableFileCollection;
import org.gradle.api.file.DirectoryProperty;
import org.gradle.api.file.RegularFile;
import org.gradle.api.provider.Provider;
import org.gradle.api.tasks.*;
import org.gradle.process.JavaForkOptions;
import org.gradle.workers.*;

import javax.inject.Inject;
import java.io.File;
import java.util.Set;

abstract public class CreateMD5 extends SourceTask {

    @InputFiles
    abstract public ConfigurableFileCollection getCodecClasspath(); // <b class="conum">(1)</b>

    @OutputDirectory
    abstract public DirectoryProperty getDestinationDirectory();

    @Inject
    abstract public WorkerExecutor getWorkerExecutor();

    @TaskAction
    public void createHashes() {
        WorkQueue workQueue = getWorkerExecutor().classLoaderIsolation(workerSpec -&gt; {
            workerSpec.getClasspath().from(getCodecClasspath()); // <b class="conum">(2)</b>
        });

        for (File sourceFile : getSource().getFiles()) {
            Provider&lt;RegularFile&gt; md5File = getDestinationDirectory().file(sourceFile.getName() + ".md5");
            workQueue.submit(GenerateMD5.class, parameters -&gt; {
                parameters.getSourceFile().set(sourceFile);
                parameters.getMD5File().set(md5File);
            });
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Expose an input property for the codec library classpath.</p>
</li>
<li>
<p>Configure the classpath on the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/ClassLoaderWorkerSpec.html">ClassLoaderWorkerSpec</a> when creating the work queue.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Next, you need to configure your build so that it has a repository to look up the codec version at task execution time.
We also create a dependency to resolve our codec library from this repository:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins { id("base") }

repositories {
    mavenCentral() // <b class="conum">(1)</b>
}

val codec = configurations.create("codec") { // <b class="conum">(2)</b>
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
    }
    isCanBeConsumed = false
}

dependencies {
    codec("commons-codec:commons-codec:1.10") // <b class="conum">(3)</b>
}

tasks.register&lt;CreateMD5&gt;("md5") {
    codecClasspath.from(codec) // <b class="conum">(4)</b>
    destinationDirectory = project.layout.buildDirectory.dir("md5")
    source(project.layout.projectDirectory.file("src"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins { id 'base' }

repositories {
    mavenCentral() // <b class="conum">(1)</b>
}

configurations.create('codec') { // <b class="conum">(2)</b>
    attributes {
        attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))
    }
    canBeConsumed = false
}

dependencies {
    codec 'commons-codec:commons-codec:1.10' // <b class="conum">(3)</b>
}

tasks.register('md5', CreateMD5) {
    codecClasspath.from(configurations.codec) // <b class="conum">(4)</b>
    destinationDirectory = project.layout.buildDirectory.dir('md5')
    source(project.layout.projectDirectory.file('src'))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Add a repository to resolve the codec library - this can be a different repository than the one used to build the <code>CreateMD5</code> task class.</p>
</li>
<li>
<p>Add a <em>configuration</em> to resolve our codec library version.</p>
</li>
<li>
<p>Configure an alternate, compatible version of <a href="https://commons.apache.org/proper/commons-codec/">Apache Commons Codec</a>.</p>
</li>
<li>
<p>Configure the <code>md5</code> task to use the configuration as its classpath.
Note that the configuration will not be resolved until the task is executed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, if you run your task, it should work as expected using the configured version of the codec library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle clean md5

&gt; Task :md5
Generating MD5 for einstein.txt...
Generating MD5 for feynman.txt...
Generating MD5 for hawking.txt...

BUILD SUCCESSFUL in 3s
3 actionable tasks: 3 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="step_4_create_a_worker_daemon"><a class="anchor" href="#step_4_create_a_worker_daemon"></a><a class="link" href="#step_4_create_a_worker_daemon">Step 4. Create a Worker Daemon</a></h5>
<div class="paragraph">
<p>Sometimes, it is desirable to utilize even greater levels of isolation when executing items of work.
For instance, external libraries may rely on certain system properties to be set, which may conflict between work items.
Or a library might not be compatible with the version of JDK that Gradle is running with and may need to be run with a different version.</p>
</div>
<div class="paragraph">
<p>The Worker API can accommodate this using the <code>processIsolation()</code> method that causes the work to execute in a separate "worker daemon".
These worker processes will be session-scoped and can be reused within the same build session, but they won&#8217;t persist across builds.
However, if system resources get low, Gradle will stop unused worker daemons.</p>
</div>
<div class="paragraph">
<p>To utilize a worker daemon, use the <code>processIsolation()</code> method when creating the <code>WorkQueue</code>.
You may also want to configure custom settings for the new process:</p>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/CreateMD5.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Action;
import org.gradle.api.file.ConfigurableFileCollection;
import org.gradle.api.file.DirectoryProperty;
import org.gradle.api.file.RegularFile;
import org.gradle.api.provider.Provider;
import org.gradle.api.tasks.*;
import org.gradle.process.JavaForkOptions;
import org.gradle.workers.*;

import javax.inject.Inject;
import java.io.File;
import java.util.Set;

abstract public class CreateMD5 extends SourceTask {

    @InputFiles
    abstract public ConfigurableFileCollection getCodecClasspath(); // <b class="conum">(1)</b>

    @OutputDirectory
    abstract public DirectoryProperty getDestinationDirectory();

    @Inject
    abstract public WorkerExecutor getWorkerExecutor();

    @TaskAction
    public void createHashes() {
        // <b class="conum">(1)</b>
        WorkQueue workQueue = getWorkerExecutor().processIsolation(workerSpec -&gt; {
            workerSpec.getClasspath().from(getCodecClasspath());
            workerSpec.forkOptions(options -&gt; {
                options.setMaxHeapSize("64m"); // <b class="conum">(2)</b>
            });
        });

        for (File sourceFile : getSource().getFiles()) {
            Provider&lt;RegularFile&gt; md5File = getDestinationDirectory().file(sourceFile.getName() + ".md5");
            workQueue.submit(GenerateMD5.class, parameters -&gt; {
                parameters.getSourceFile().set(sourceFile);
                parameters.getMD5File().set(md5File);
            });
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Change the isolation mode to <code>PROCESS</code>.</p>
</li>
<li>
<p>Set up the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/JavaForkOptions.html">JavaForkOptions</a> for the new process.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, you should be able to run your task, and it will work as expected but using worker daemons instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle clean md5

&gt; Task :md5
Generating MD5 for einstein.txt...
Generating MD5 for feynman.txt...
Generating MD5 for hawking.txt...

BUILD SUCCESSFUL in 3s
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the execution time may be high.
This is because Gradle has to start a new process for each worker daemon, which is expensive.</p>
</div>
<div class="paragraph">
<p>However, if you run your task a second time, you will see that it runs much faster.
This is because the worker daemon(s) started during the initial build have persisted and are available for use immediately during subsequent builds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle clean md5

&gt; Task :md5
Generating MD5 for einstein.txt...
Generating MD5 for feynman.txt...
Generating MD5 for hawking.txt...

BUILD SUCCESSFUL in 1s
3 actionable tasks: 3 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="isolation-modes"><a class="anchor" href="#isolation-modes"></a><a class="link" href="#isolation-modes">Isolation modes</a></h4>
<div class="paragraph">
<p>Gradle provides three isolation modes that can be configured when creating a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkQueue.html">WorkQueue</a> and are specified using one of the following methods on <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html#noIsolation--"><code>WorkerExecutor.noIsolation()</code></a></dt>
<dd>
<p>This states that the work should be run in a thread with minimal isolation.<br>
For instance, it will share the same classloader that the task is loaded from.
This is the fastest level of isolation.</p>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html#classLoaderIsolation-org.gradle.api.Action-"><code>WorkerExecutor.classLoaderIsolation()</code></a></dt>
<dd>
<p>This states that the work should be run in a thread with an isolated classloader. <br>
The classloader will have the classpath from the classloader that the unit of work implementation class was loaded from as well as any additional classpath entries added through <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/ClassLoaderWorkerSpec.html#getClasspath--"><code>ClassLoaderWorkerSpec.getClasspath()</code></a>.</p>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/WorkerExecutor.html#processIsolation-org.gradle.api.Action-"><code>WorkerExecutor.processIsolation()</code></a></dt>
<dd>
<p>This states that the work should be run with a maximum isolation level by executing the work in a separate process.<br>
The classloader of the process will use the classpath from the classloader that the unit of work was loaded from as well as any additional classpath entries added through <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/ClassLoaderWorkerSpec.html#getClasspath--"><code>ClassLoaderWorkerSpec.getClasspath()</code></a>.
Furthermore, the process will be a <em>worker daemon</em> that will stay alive and can be reused for future work items with the same requirements.
This process can be configured with different settings than the Gradle JVM using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/ProcessWorkerSpec.html#forkOptions-org.gradle.api.Action-">ProcessWorkerSpec.forkOptions(org.gradle.api.Action)</a>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="worker-daemons"><a class="anchor" href="#worker-daemons"></a><a class="link" href="#worker-daemons">Worker Daemons</a></h5>
<div class="paragraph">
<p>When using <code>processIsolation()</code>, Gradle will start a long-lived <em>worker daemon</em> process that can be reused for future work items.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create a WorkQueue with process isolation
val workQueue = workerExecutor.processIsolation() {
    // Configure the options for the forked process
    forkOptions {
        maxHeapSize = "512m"
        systemProperty("org.gradle.sample.showFileSize", "true")
    }
}

// Create and submit a unit of work for each file
source.forEach { file -&gt;
    workQueue.submit(ReverseFile::class) {
        fileToReverse = file
        destinationDir = outputDir
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create a WorkQueue with process isolation
WorkQueue workQueue = workerExecutor.processIsolation() { ProcessWorkerSpec spec -&gt;
    // Configure the options for the forked process
    forkOptions { JavaForkOptions options -&gt;
        options.maxHeapSize = "512m"
        options.systemProperty "org.gradle.sample.showFileSize", "true"
    }
}

// Create and submit a unit of work for each file
source.each { file -&gt;
    workQueue.submit(ReverseFile.class) { ReverseParameters parameters -&gt;
        parameters.fileToReverse = file
        parameters.destinationDir = outputDir
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a unit of work for a worker daemon is submitted, Gradle will first look to see if a compatible, idle daemon already exists.
If so, it will send the unit of work to the idle daemon, marking it as busy.
If not, it will start a new daemon.
When evaluating compatibility, Gradle looks at a number of criteria, all of which can be controlled through <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/workers/ProcessWorkerSpec.html#forkOptions-org.gradle.api.Action-">ProcessWorkerSpec.forkOptions(org.gradle.api.Action)</a>.</p>
</div>
<div class="paragraph">
<p>By default, a worker daemon starts with a maximum heap of 512MB.
This can be changed by adjusting the workers' fork options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">executable</dt>
<dd>
<p>A daemon is considered compatible only if it uses the same Java executable.</p>
</dd>
<dt class="hdlist1">classpath</dt>
<dd>
<p>A daemon is considered compatible if its classpath contains all the classpath entries requested.<br>
Note that a daemon is considered compatible only if the classpath exactly matches the requested classpath.</p>
</dd>
<dt class="hdlist1">heap settings</dt>
<dd>
<p>A daemon is considered compatible if it has at least the same heap size settings as requested.<br>
In other words, a daemon that has higher heap settings than requested would be considered compatible.</p>
</dd>
<dt class="hdlist1">jvm arguments</dt>
<dd>
<p>A daemon is compatible if it has set all the JVM arguments requested.<br>
Note that a daemon is compatible if it has additional JVM arguments beyond those requested (except for those treated especially, such as heap settings, assertions, debug, etc.).</p>
</dd>
<dt class="hdlist1">system properties</dt>
<dd>
<p>A daemon is considered compatible if it has set all the system properties requested with the same values.<br>
Note that a daemon is compatible if it has additional system properties beyond those requested.</p>
</dd>
<dt class="hdlist1">environment variables</dt>
<dd>
<p>A daemon is considered compatible if it has set all the environment variables requested with the same values.<br>
Note that a daemon is compatible if it has more environment variables than requested.</p>
</dd>
<dt class="hdlist1">bootstrap classpath</dt>
<dd>
<p>A daemon is considered compatible if it contains all the bootstrap classpath entries requested.<br>
Note that a daemon is compatible if it has more bootstrap classpath entries than requested.</p>
</dd>
<dt class="hdlist1">debug</dt>
<dd>
<p>A daemon is considered compatible only if debug is set to the same value as requested (<code>true</code> or <code>false</code>).</p>
</dd>
<dt class="hdlist1">enable assertions</dt>
<dd>
<p>A daemon is considered compatible only if enable assertions are set to the same value as requested (<code>true</code> or <code>false</code>).</p>
</dd>
<dt class="hdlist1">default character encoding</dt>
<dd>
<p>A daemon is considered compatible only if the default character encoding is set to the same value as requested.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Worker daemons will remain running until the build daemon that started them is stopped or system memory becomes scarce.
When system memory is low, Gradle will stop worker daemons to minimize memory consumption.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A step-by-step description of converting a normal task action to use the worker API can be found in the section on <a href="#tasks_parallel_worker">developing parallel tasks</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cancellation_and_timeouts"><a class="anchor" href="#cancellation_and_timeouts"></a><a class="link" href="#cancellation_and_timeouts">Cancellation and timeouts</a></h4>
<div class="paragraph">
<p>To support cancellation (e.g., when the user stops the build with CTRL+C) and task timeouts, custom tasks should react to interrupting their executing thread.
The same is true for work items submitted via the worker API.
If a task does not respond to an interrupt within 10s, the daemon will shut down to free up system resources.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom_tasks"><a class="anchor" href="#custom_tasks"></a><a class="link" href="#custom_tasks">Advanced Tasks</a></h3>
<div class="sect3">
<h4 id="incremental_tasks"><a class="anchor" href="#incremental_tasks"></a><a class="link" href="#incremental_tasks">Incremental tasks</a></h4>
<div class="paragraph">
<p>In Gradle, implementing a task that skips execution when its inputs and outputs are already <code>UP-TO-DATE</code> is simple and efficient, thanks to the <a href="incremental_build.html#incremental_build">Incremental Build</a> feature.</p>
</div>
<div class="paragraph">
<p>However, there are times when only a few input files have changed since the last execution, and it is best to avoid reprocessing all the unchanged inputs.
This situation is common in tasks that transform input files into output files on a one-to-one basis.</p>
</div>
<div class="paragraph">
<p>To optimize your build process you can use an incremental task.
This approach ensures that only out-of-date input files are processed, improving build performance.</p>
</div>
<div class="sect4">
<h5 id="sec:implementing_an_incremental_task"><a class="anchor" href="#sec:implementing_an_incremental_task"></a><a class="link" href="#sec:implementing_an_incremental_task">Implementing an incremental task</a></h5>
<div class="paragraph">
<p>For a task to process inputs incrementally, that task must contain an <em>incremental</em> task action.</p>
</div>
<div class="paragraph">
<p>This is a task action method that has a single <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html">InputChanges</a> parameter.
That parameter tells Gradle that the action only wants to process the changed inputs.</p>
</div>
<div class="paragraph">
<p>In addition, the task needs to declare at least one incremental file input property by using either <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/Incremental.html"><code>@Incremental</code></a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/SkipWhenEmpty.html"><code>@SkipWhenEmpty</code></a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">public class IncrementalReverseTask : DefaultTask() {

    @get:Incremental
    @get:InputDirectory
    val inputDir: DirectoryProperty = project.objects.directoryProperty()

    @get:OutputDirectory
    val outputDir: DirectoryProperty = project.objects.directoryProperty()

    @get:Input
    val inputProperty: RegularFileProperty = project.objects.fileProperty() // File input property

    @TaskAction
    fun execute(inputs: InputChanges) { // InputChanges parameter
        val msg = if (inputs.isIncremental) "CHANGED inputs are out of date"
                  else "ALL inputs are out of date"
        println(msg)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class IncrementalReverseTask extends DefaultTask {

    @Incremental
    @InputDirectory
    def File inputDir

    @OutputDirectory
    def File outputDir

    @Input
    def inputProperty // File input property

    @TaskAction
    void execute(InputChanges inputs) { // InputChanges parameter
        println inputs.incremental ? "CHANGED inputs are out of date"
                                   : "ALL inputs are out of date"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>To query incremental changes for an input file property, that property must always return the same instance.
The easiest way to accomplish this is to use one of the following property types: <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/RegularFileProperty.html"><code>RegularFileProperty</code></a>, <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/DirectoryProperty.html"><code>DirectoryProperty</code></a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileCollection.html"><code>ConfigurableFileCollection</code></a>.</p>
</div>
<div class="paragraph">
<p>You can learn more about <code>RegularFileProperty</code> and <code>DirectoryProperty</code> in <a href="#lazy_configuration">Lazy Configuration</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The incremental task action can use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a> to find out what files have changed for a given file-based input property, be it of type <code>RegularFileProperty</code>, <code>DirectoryProperty</code> or <code>ConfigurableFileCollection</code>.</p>
</div>
<div class="paragraph">
<p>The method returns an <code>Iterable</code> of type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/FileChange.html">FileChanges</a>, which in turn can be queried for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/FileChange.html#getFile--">affected file</a></p>
</li>
<li>
<p>the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/FileChange.html#getChangeType--">change type</a> (<code>ADDED</code>, <code>REMOVED</code> or <code>MODIFIED</code>)</p>
</li>
<li>
<p>the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/FileChange.html#getNormalizedPath--">normalized path</a> of the changed file</p>
</li>
<li>
<p>the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/work/FileChange.html#getFileType--">file type</a> of the changed file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example demonstrates an incremental task that has a directory input.
It assumes that the directory contains a collection of text files and copies them to an output directory, reversing the text within each file:</p>
</div>
<div id="taskDefinition" class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class IncrementalReverseTask : DefaultTask() {
    @get:Incremental
    @get:PathSensitive(PathSensitivity.NAME_ONLY)
    @get:InputDirectory
    abstract val inputDir: DirectoryProperty

    @get:OutputDirectory
    abstract val outputDir: DirectoryProperty

    @get:Input
    abstract val inputProperty: Property&lt;String&gt;

    @TaskAction
    fun execute(inputChanges: InputChanges) {
        println(
            if (inputChanges.isIncremental) "Executing incrementally"
            else "Executing non-incrementally"
        )

        inputChanges.getFileChanges(inputDir).forEach { change -&gt;
            if (change.fileType == FileType.DIRECTORY) return@forEach

            println("${change.changeType}: ${change.normalizedPath}")
            val targetFile = outputDir.file(change.normalizedPath).get().asFile
            if (change.changeType == ChangeType.REMOVED) {
                targetFile.delete()
            } else {
                targetFile.writeText(change.file.readText().reversed())
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class IncrementalReverseTask extends DefaultTask {
    @Incremental
    @PathSensitive(PathSensitivity.NAME_ONLY)
    @InputDirectory
    abstract DirectoryProperty getInputDir()

    @OutputDirectory
    abstract DirectoryProperty getOutputDir()

    @Input
    abstract Property&lt;String&gt; getInputProperty()

    @TaskAction
    void execute(InputChanges inputChanges) {
        println(inputChanges.incremental
            ? 'Executing incrementally'
            : 'Executing non-incrementally'
        )

        inputChanges.getFileChanges(inputDir).each { change -&gt;
            if (change.fileType == FileType.DIRECTORY) return

            println "${change.changeType}: ${change.normalizedPath}"
            def targetFile = outputDir.file(change.normalizedPath).get().asFile
            if (change.changeType == ChangeType.REMOVED) {
                targetFile.delete()
            } else {
                targetFile.text = change.file.text.reverse()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The type of the <code>inputDir</code> property, its annotations, and the <code>execute()</code> action use <code>getFileChanges()</code> to process the subset of files that have changed since the last build.
The action deletes a target file if the corresponding input file has been removed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If, for some reason, the task is executed non-incrementally (by running with <code>--rerun-tasks</code>, for example), all files are reported as <code>ADDED</code>, irrespective of the previous state.
In this case, Gradle automatically removes the previous outputs, so the incremental task must only process the given files.</p>
</div>
<div class="paragraph">
<p>For a simple transformer task like the above example, the task action must generate output files for any out-of-date inputs and delete output files for any removed inputs.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
A task may only contain a single incremental task action.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:which_inputs_are_considered_out_of_date"><a class="anchor" href="#sec:which_inputs_are_considered_out_of_date"></a><a class="link" href="#sec:which_inputs_are_considered_out_of_date">Which inputs are considered out of date?</a></h5>
<div class="paragraph">
<p>When a task has been previously executed, and the only changes since that execution are to incremental input file properties, Gradle can intelligently determine which input files need to be processed, a concept known as incremental execution.</p>
</div>
<div class="paragraph">
<p>In this scenario, the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a> method, available in the <code>org.gradle.work.InputChanges</code> class, provides details for all input files associated with the given property that have been <code>ADDED</code>, <code>REMOVED</code> or <code>MODIFIED</code>.</p>
</div>
<div class="paragraph">
<p>However, there are many cases where Gradle cannot determine which input files need to be processed (i.e., non-incremental execution). Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is no history available from a previous execution.</p>
</li>
<li>
<p>You are building with a different version of Gradle.
Currently, Gradle does not use task history from a different version.</p>
</li>
<li>
<p>An <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskOutputs.html#upToDateWhen-groovy.lang.Closure-"><code>upToDateWhen</code></a> criterion added to the task returns <code>false</code>.</p>
</li>
<li>
<p>An input property has changed since the previous execution.</p>
</li>
<li>
<p>A non-incremental input file property has changed since the previous execution.</p>
</li>
<li>
<p>One or more output files have changed since the previous execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these cases, Gradle will report all input files as <code>ADDED</code>, and the <code>getFileChanges()</code> method will return details for all the files that comprise the given input property.</p>
</div>
<div class="paragraph">
<p>You can check if the task execution is incremental or not with the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges.html##org.gradle.work.InputChanges:incremental"><code>InputChanges.isIncremental()</code></a> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:an_incremental_task_in_action"><a class="anchor" href="#sec:an_incremental_task_in_action"></a><a class="link" href="#sec:an_incremental_task_in_action">An incremental task in action</a></h5>
<div class="paragraph">
<p>Consider an instance of <code>IncrementalReverseTask</code> executed against a set of inputs for the first time.</p>
</div>
<div class="paragraph">
<p>In this case, all inputs will be considered <code>ADDED</code>, as shown here:</p>
</div>
<div id="ex:incremental_task_definition" class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;IncrementalReverseTask&gt;("incrementalReverse") {
    inputDir = file("inputs")
    outputDir = layout.buildDirectory.dir("outputs")
    inputProperty = project.findProperty("taskInputProperty") as String? ?: "original"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('incrementalReverse', IncrementalReverseTask) {
    inputDir = file('inputs')
    outputDir = layout.buildDirectory.dir("outputs")
    inputProperty = project.properties['taskInputProperty'] ?: 'original'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The build layout:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">.
 build.gradle
 inputs
     1.txt
     2.txt
     3.txt</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradle -q incrementalReverse
Executing non-incrementally
ADDED: 1.txt
ADDED: 2.txt
ADDED: 3.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Naturally, when the task is executed again with no changes, then the entire task is <code>UP-TO-DATE</code>, and the task action is not executed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradle incrementalReverse
&gt; Task :incrementalReverse UP-TO-DATE

BUILD SUCCESSFUL in 0s
1 actionable task: 1 up-to-date</code></pre>
</div>
</div>
<div class="paragraph">
<p>When an input file is modified in some way or a new input file is added, then re-executing the task results in those files being returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a>.</p>
</div>
<div class="paragraph">
<p>The following example modifies the content of one file and adds another before running the incremental task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("updateInputs") {
    val inputsDir = layout.projectDirectory.dir("inputs")
    outputs.dir(inputsDir)
    doLast {
        inputsDir.file("1.txt").asFile.writeText("Changed content for existing file 1.")
        inputsDir.file("4.txt").asFile.writeText("Content for new file 4.")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('updateInputs') {
    def inputsDir = layout.projectDirectory.dir('inputs')
    outputs.dir(inputsDir)
    doLast {
        inputsDir.file('1.txt').asFile.text = 'Changed content for existing file 1.'
        inputsDir.file('4.txt').asFile.text = 'Content for new file 4.'
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q updateInputs incrementalReverse
Executing incrementally
MODIFIED: 1.txt
ADDED: 4.txt</pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The various mutation tasks (<code>updateInputs</code>, <code>removeInput</code>, etc) are only present to demonstrate the behavior of incremental tasks.
They should not be viewed as the kinds of tasks or task implementations you should have in your own build scripts.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an existing input file is removed, then re-executing the task results in that file being returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a> as <code>REMOVED</code>.</p>
</div>
<div class="paragraph">
<p>The following example removes one of the existing files before executing the incremental task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("removeInput") {
    delete("inputs/3.txt")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('removeInput', Delete) {
    delete 'inputs/3.txt'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q removeInput incrementalReverse
Executing incrementally
REMOVED: 3.txt</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle cannot determine which input files are out-of-date when an <em>output</em> file is deleted (or modified).
In this case, details for <em>all</em> the input files for the given property are returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a>.</p>
</div>
<div class="paragraph">
<p>The following example removes one of the output files from the build directory.
However, all the input files are considered to be <code>ADDED</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Delete&gt;("removeOutput") {
    delete(layout.buildDirectory.file("outputs/1.txt"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('removeOutput', Delete) {
    delete layout.buildDirectory.file("outputs/1.txt")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q removeOutput incrementalReverse
Executing non-incrementally
ADDED: 1.txt
ADDED: 2.txt
ADDED: 3.txt</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The last scenario we want to cover concerns what happens when a non-file-based input property is modified.
In such cases, Gradle cannot determine how the property impacts the task outputs, so the task is executed non-incrementally.
This means that <em>all</em> input files for the given property are returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html#org.gradle.work.InputChanges:getFileChanges(org.gradle.api.file.FileCollection)"><code>InputChanges.getFileChanges()</code></a> and they are all treated as <code>ADDED</code>.</p>
</div>
<div class="paragraph">
<p>The following example sets the project property <code>taskInputProperty</code> to a new value when running the <code>incrementalReverse</code> task.
That project property is used to initialize the task&#8217;s <code>inputProperty</code> property, as you can see in the <a href="#ex:incremental_task_definition">first example of this section</a>.</p>
</div>
<div class="paragraph">
<p>Here is the expected output in this case:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ gradle -q -PtaskInputProperty=changed incrementalReverse
Executing non-incrementally
ADDED: 1.txt
ADDED: 2.txt
ADDED: 3.txt</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_and_using_command_line_options"><a class="anchor" href="#sec:declaring_and_using_command_line_options"></a><a class="link" href="#sec:declaring_and_using_command_line_options">Command Line options</a></h4>
<div class="paragraph">
<p>Sometimes, a user wants to declare the value of an exposed task property on the command line instead of the build script.
Passing property values on the command line is particularly helpful if they change more frequently.</p>
</div>
<div class="paragraph">
<p>The task API supports a mechanism for marking a property to automatically generate a corresponding command line parameter with a specific name at runtime.</p>
</div>
<div class="sect4">
<h5 id="sec:declaring_task_option"><a class="anchor" href="#sec:declaring_task_option"></a><a class="link" href="#sec:declaring_task_option">Step 1. Declare a command-line option</a></h5>
<div class="paragraph">
<p>To expose a new command line option for a task property, annotate the corresponding setter method of a property with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/options/Option.html">Option</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@Option(option = "flag", description = "Sets the flag")</code></pre>
</div>
</div>
<div class="paragraph">
<p>An option requires a mandatory identifier.
You can provide an optional description.</p>
</div>
<div class="paragraph">
<p>A task can expose as many command line options as properties available in the class.</p>
</div>
<div class="paragraph">
<p>Options may be declared in superinterfaces of the task class as well.
If multiple interfaces declare the same property but with different option flags, they will both work to set the property.</p>
</div>
<div class="paragraph">
<p>In the example below, the custom task <code>UrlVerify</code> verifies whether a URL can be resolved by making an HTTP call and checking the response code. The URL to be verified is configurable through the property <code>url</code>.
The setter method for the property is annotated with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/options/Option.html">@Option</a>:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="title">UrlVerify.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.tasks.options.Option;

public class UrlVerify extends DefaultTask {
    private String url;

    @Option(option = "url", description = "Configures the URL to be verified.")
    public void setUrl(String url) {
        this.url = url;
    }

    @Input
    public String getUrl() {
        return url;
    }

    @TaskAction
    public void verify() {
        getLogger().quiet("Verifying URL '{}'", url);

        // verify URL by making a HTTP call
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All options declared for a task can be <a href="#sec:listing_task_options">rendered as console output</a> by running the <code>help</code> task and the <code>--task</code> option.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_task_option_command_line"><a class="anchor" href="#sec:using_task_option_command_line"></a><a class="link" href="#sec:using_task_option_command_line">Step 2. Use an option on the command line</a></h5>
<div class="paragraph">
<p>There are a few rules for options on the command line:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The option uses a double-dash as a prefix, e.g., <code>--url</code>.
A single dash does not qualify as valid syntax for a task option.</p>
</li>
<li>
<p>The option argument follows directly after the task declaration, e.g., <code>verifyUrl --url=http://www.google.com/</code>.</p>
</li>
<li>
<p>Multiple task options can be declared in any order on the command line following the task name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Building upon the earlier example, the build script creates a task instance of type <code>UrlVerify</code> and provides a value from the command line through the exposed option:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;UrlVerify&gt;("verifyUrl")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('verifyUrl', UrlVerify)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q verifyUrl --url=http://www.google.com/
Verifying URL 'http://www.google.com/'</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:supported_task_option_data_types"><a class="anchor" href="#sec:supported_task_option_data_types"></a><a class="link" href="#sec:supported_task_option_data_types">Supported data types for options</a></h5>
<div class="paragraph">
<p>Gradle limits the data types that can be used for declaring command line options.</p>
</div>
<div class="paragraph">
<p>The use of the command line differs per type:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>boolean</code>, <code>Boolean</code>, <code>Property&lt;Boolean&gt;</code></dt>
<dd>
<p>Describes an option with the value <code>true</code> or <code>false</code>.<br>
Passing the option on the command line treats the value as <code>true</code>.
For example, <code>--foo</code> equates to <code>true</code>.<br>
The absence of the option uses the default value of the property.
For each boolean option, an opposite option is created automatically.
For example, <code>--no-foo</code> is created for the provided option <code>--foo</code> and <code>--bar</code> is created for <code>--no-bar</code>.
Options whose name starts with <code>--no</code> are disabled options and set the option value to <code>false</code>.
An opposite option is only created if no option with the same name already exists for the task.</p>
</dd>
<dt class="hdlist1"><code>Double</code>, <code>Property&lt;Double&gt;</code></dt>
<dd>
<p>Describes an option with a double value.<br>
Passing the option on the command line also requires a value, e.g., <code>--factor=2.2</code> or <code>--factor 2.2</code>.</p>
</dd>
<dt class="hdlist1"><code>Integer</code>, <code>Property&lt;Integer&gt;</code></dt>
<dd>
<p>Describes an option with an integer value.<br>
Passing the option on the command line also requires a value, e.g., <code>--network-timeout=5000</code> or <code>--network-timeout 5000</code>.</p>
</dd>
<dt class="hdlist1"><code>Long</code>, <code>Property&lt;Long&gt;</code></dt>
<dd>
<p>Describes an option with a long value.<br>
Passing the option on the command line also requires a value, e.g., <code>--threshold=2147483648</code> or <code>--threshold 2147483648</code>.</p>
</dd>
<dt class="hdlist1"><code>String</code>, <code>Property&lt;String&gt;</code></dt>
<dd>
<p>Describes an option with an arbitrary String value.<br>
Passing the option on the command line also requires a value, e.g., <code>--container-id=2x94held</code> or <code>--container-id 2x94held</code>.</p>
</dd>
<dt class="hdlist1"><code>enum</code>, <code>Property&lt;enum&gt;</code></dt>
<dd>
<p>Describes an option as an enumerated type.<br>
Passing the option on the command line also requires a value e.g., <code>--log-level=DEBUG</code> or <code>--log-level debug</code>.<br>
The value is not case-sensitive.</p>
</dd>
<dt class="hdlist1"><code>List&lt;T&gt;</code> where <code>T</code> is <code>Double</code>, <code>Integer</code>, <code>Long</code>, <code>String</code>, <code>enum</code></dt>
<dd>
<p>Describes an option that can take multiple values of a given type.<br>
The values for the option have to be provided as multiple declarations, e.g., <code>--image-id=123 --image-id=456</code>.<br>
Other notations, such as comma-separated lists or multiple values separated by a space character, are currently not supported.</p>
</dd>
<dt class="hdlist1"><code>ListProperty&lt;T&gt;</code>, <code>SetProperty&lt;T&gt;</code> where <code>T</code> is <code>Double</code>, <code>Integer</code>, <code>Long</code>, <code>String</code>, <code>enum</code></dt>
<dd>
<p>Describes an option that can take multiple values of a given type.<br>
The values for the option have to be provided as multiple declarations, e.g., <code>--image-id=123 --image-id=456</code>.<br>
Other notations, such as comma-separated lists or multiple values separated by a space character, are currently not supported.</p>
</dd>
<dt class="hdlist1"><code>DirectoryProperty</code>, <code>RegularFileProperty</code></dt>
<dd>
<p>Describes an option with a file system element.<br>
Passing the option on the command line also requires a value representing a path, e.g., <code>--output-file=file.txt</code> or <code>--output-dir outputDir</code>.<br>
Relative paths are resolved relative to the project directory of the project that owns this property instance.
See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemLocationProperty.html#set-java.io.File"><code>FileSystemLocationProperty.set()</code></a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:documenting_available_task_option_values"><a class="anchor" href="#sec:documenting_available_task_option_values"></a><a class="link" href="#sec:documenting_available_task_option_values">Documenting available values for an option</a></h5>
<div class="paragraph">
<p>Theoretically, an option for a property type <code>String</code> or <code>List&lt;String&gt;</code> can accept any arbitrary value.
Accepted values for such an option can be documented programmatically with the help of the annotation <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/options/OptionValues.html">OptionValues</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@OptionValues('file')</code></pre>
</div>
</div>
<div class="paragraph">
<p>This annotation may be assigned to any method that returns a <code>List</code> of one of the supported data types.
You need to specify an option identifier to indicate the relationship between the option and available values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Passing a value on the command line not supported by the option does not fail the build or throw an exception. You must implement custom logic for such behavior in the task action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example below demonstrates the use of multiple options for a single task.
The task implementation provides a list of available values for the option <code>output-type</code>:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="title">UrlProcess.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.tasks.options.Option;
import org.gradle.api.tasks.options.OptionValues;

public abstract class UrlProcess extends DefaultTask {
    private String url;
    private OutputType outputType;

    @Input
    @Option(option = "http", description = "Configures the http protocol to be allowed.")
    public abstract Property&lt;Boolean&gt; getHttp();

    @Option(option = "url", description = "Configures the URL to send the request to.")
    public void setUrl(String url) {
        if (!getHttp().getOrElse(true) &amp;&amp; url.startsWith("http://")) {
            throw new IllegalArgumentException("HTTP is not allowed");
        } else {
            this.url = url;
        }
    }

    @Input
    public String getUrl() {
        return url;
    }

    @Option(option = "output-type", description = "Configures the output type.")
    public void setOutputType(OutputType outputType) {
        this.outputType = outputType;
    }

    @OptionValues("output-type")
    public List&lt;OutputType&gt; getAvailableOutputTypes() {
        return new ArrayList&lt;OutputType&gt;(Arrays.asList(OutputType.values()));
    }

    @Input
    public OutputType getOutputType() {
        return outputType;
    }

    @TaskAction
    public void process() {
        getLogger().quiet("Writing out the URL response from '{}' to '{}'", url, outputType);

        // retrieve content from URL and write to output
    }

    private static enum OutputType {
        CONSOLE, FILE
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_task_options"><a class="anchor" href="#sec:listing_task_options"></a><a class="link" href="#sec:listing_task_options">Listing command line options</a></h5>
<div class="paragraph">
<p>Command line options using the annotations <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/options/Option.html">Option</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/options/OptionValues.html">OptionValues</a> are self-documenting.</p>
</div>
<div class="paragraph">
<p>You will see <a href="#sec:declaring_task_option">declared options</a> and their <a href="#sec:documenting_available_task_option_values">available values</a> reflected in the console output of the <code>help</code> task.
The output renders options alphabetically, except for boolean disable options, which appear following the enable option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q help --task processUrl
Detailed task information for processUrl

Path
     :processUrl

Type
     UrlProcess (UrlProcess)

Options
     --http     Configures the http protocol to be allowed.

     --no-http     Disables option --http.

     --output-type     Configures the output type.
                       Available values are:
                            CONSOLE
                            FILE

     --url     Configures the URL to send the request to.

     --rerun     Causes the task to be re-run even if up-to-date.

Description
     -

Group
     -</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="limitations"><a class="anchor" href="#limitations"></a><a class="link" href="#limitations">Limitations</a></h5>
<div class="paragraph">
<p>Support for declaring command line options currently comes with a few limitations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Command line options can only be declared for custom tasks via annotation.
There&#8217;s no programmatic equivalent for defining options.</p>
</li>
<li>
<p>Options cannot be declared globally, e.g., on a project level or as part of a plugin.</p>
</li>
<li>
<p>When assigning an option on the command line, the task exposing the option needs to be spelled out explicitly, e.g., <code>gradle check --tests abc</code> does not work even though the <code>check</code> task depends on the <code>test</code> task.</p>
</li>
<li>
<p>If you specify a task option name that conflicts with the name of a built-in Gradle option, use the <code>--</code> delimiter before calling your task to reference that option.
For more information, see <a href="#sec:disambiguate_task_options_from_built_in_options">Disambiguate Task Options from Built-in Options</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="verification_failures"><a class="anchor" href="#verification_failures"></a><a class="link" href="#verification_failures">Verification failures</a></h4>
<div class="paragraph">
<p>Normally, exceptions thrown during task execution result in a failure that immediately terminates a build.
The outcome of the task will be <code>FAILED</code>, the result of the build will be <code>FAILED</code>, and no further tasks will be executed.
When <a href="#sec:continue_build_on_failure">running with the <code>--continue</code> flag</a>, Gradle will continue to run other requested tasks in the build after encountering a task failure.
However, any tasks that depend on a failed task will not be executed.</p>
</div>
<div class="paragraph">
<p>There is a special type of exception that behaves differently when downstream tasks only rely on the outputs of a failing task.
A task can throw a subtype of <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/VerificationException.html">VerificationException</a> to indicate that it has failed in a controlled manner such that its output is still valid for consumers.
A task depends on the <strong>outcome</strong> of another task when it directly depends on it using <code>dependsOn</code>.
When Gradle is run with <code>--continue</code>, consumer tasks that depend on a producer task&#8217;s output (via a relationship between task inputs and outputs) can still run after the producer fails.</p>
</div>
<div class="paragraph">
<p>A failed unit test, for instance, will cause a failing outcome for the test task.
However, this doesn&#8217;t prevent another task from reading and processing the (valid) test results the task produced.
Verification failures are used in exactly this manner by the <a href="test_report_aggregation_plugin.html#test_report_aggregation_plugin"><code>Test Report Aggregation Plugin</code></a>.</p>
</div>
<div class="paragraph">
<p>Verification failures are also useful for tasks that need to report a failure even after producing useful output consumable by other tasks.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val process = tasks.register("process") {
    val outputFile = layout.buildDirectory.file("processed.log")
    outputs.files(outputFile) // <b class="conum">(1)</b>

    doLast {
        val logFile = outputFile.get().asFile
        logFile.appendText("Step 1 Complete.") // <b class="conum">(2)</b>
        throw VerificationException("Process failed!") // <b class="conum">(3)</b>
        logFile.appendText("Step 2 Complete.") // <b class="conum">(4)</b>
    }
}

tasks.register("postProcess") {
    inputs.files(process) // <b class="conum">(5)</b>

    doLast {
        println("Results: ${inputs.files.singleFile.readText()}") // <b class="conum">(6)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("process") {
    def outputFile = layout.buildDirectory.file("processed.log")
    outputs.files(outputFile) // <b class="conum">(1)</b>

    doLast {
        def logFile = outputFile.get().asFile
        logFile &lt;&lt; "Step 1 Complete." // <b class="conum">(2)</b>
        throw new VerificationException("Process failed!") // <b class="conum">(3)</b>
        logFile &lt;&lt; "Step 2 Complete." // <b class="conum">(4)</b>
    }
}

tasks.register("postProcess") {
    inputs.files(tasks.named("process")) // <b class="conum">(5)</b>

    doLast {
        println("Results: ${inputs.files.singleFile.text}") // <b class="conum">(6)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle postProcess --continue
&gt; Task :process FAILED

&gt; Task :postProcess
Results: Step 1 Complete.
2 actionable tasks: 2 executed

FAILURE: Build failed with an exception.</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><strong>Register Output</strong>: The <code>process</code> task writes its output to a log file.</p>
</li>
<li>
<p><strong>Modify Output</strong>: The task writes to its output file as it executes.</p>
</li>
<li>
<p><strong>Task Failure</strong>: The task throws a <code>VerificationException</code> and fails at this point.</p>
</li>
<li>
<p><strong>Continue to Modify Output</strong>: This line never runs due to the exception stopping the task.</p>
</li>
<li>
<p><strong>Consume Output</strong>: The <code>postProcess</code> task depends on the output of the <code>process</code> task due to using that task&#8217;s outputs as its own inputs.</p>
</li>
<li>
<p><strong>Use Partial Result</strong>: With the <code>--continue</code> flag set, Gradle still runs the requested <code>postProcess</code> task despite the <code>process</code> task&#8217;s failure.  <code>postProcess</code> can read and display the partial (though still valid) result.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_services"><a class="anchor" href="#build_services"></a><a class="link" href="#build_services">Using Shared Build Services</a></h3>
<div class="paragraph">
<p>Shared build services allow tasks to share state or resources.
For example, tasks might share a cache of pre-computed values or use a web service or database instance.</p>
</div>
<div class="paragraph">
<p>A build service is an object that holds the state for tasks to use.
It provides an alternative mechanism for hooking into a Gradle build and receiving information about task execution and operation completion.</p>
</div>
<div class="paragraph">
<p>Build services are configuration cacheable.</p>
</div>
<div class="paragraph">
<p>Gradle manages the service lifecycle, creating the service instance only when required and cleaning it up when no longer needed.
Gradle can also coordinate access to the build service, ensuring that no more than a specified number of tasks use the service concurrently.</p>
</div>
<div class="sect3">
<h4 id="implementing_a_build_service"><a class="anchor" href="#implementing_a_build_service"></a><a class="link" href="#implementing_a_build_service">Implementing a build service</a></h4>
<div class="paragraph">
<p>To implement a build service, create an abstract class that implements <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildService.html">BuildService</a>.
Then, define methods you want the tasks to use on this type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class BaseCountingService implements BuildService&lt;CountingParams&gt;, AutoCloseable {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A build service implementation is treated as a <a href="#properties_and_providers">custom Gradle type</a> and can use any of the features available to custom Gradle types.</p>
</div>
<div class="paragraph">
<p>A build service can optionally take parameters, which Gradle injects into the service instance when creating it.
To provide parameters, you define an abstract class (or interface) that holds the parameters.
The parameters type must implement (or extend) <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceParameters.html">BuildServiceParameters</a>.
The service implementation can access the parameters using <code>this.getParameters()</code>.
The parameters type is also a <a href="#properties_and_providers">custom Gradle type</a>.</p>
</div>
<div class="paragraph">
<p>When the build service does not require any parameters, you can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceParameters.None.html">BuildServiceParameters.None</a> as the type of parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface CountingParams extends BuildServiceParameters {
    Property&lt;Integer&gt; getInitial()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A build service implementation can also optionally implement <code>AutoCloseable</code>, in which case Gradle will call the build service instance&#8217;s <code>close()</code> method when it discards the service instance.
This happens sometime between the completion of the last task that uses the build service and the end of the build.</p>
</div>
<div class="paragraph">
<p>Here is an example of a service that takes parameters and is closeable:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">WebServer.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.file.DirectoryProperty;
import org.gradle.api.provider.Property;
import org.gradle.api.services.BuildService;
import org.gradle.api.services.BuildServiceParameters;

import java.net.URI;
import java.net.URISyntaxException;

public abstract class WebServer implements BuildService&lt;WebServer.Params&gt;, AutoCloseable {

    // Some parameters for the web server
    interface Params extends BuildServiceParameters {
        Property&lt;Integer&gt; getPort();

        DirectoryProperty getResources();
    }

    private final URI uri;

    public WebServer() throws URISyntaxException {
        // Use the parameters
        int port = getParameters().getPort().get();
        uri = new URI(String.format("https://localhost:%d/", port));

        // Start the server ...

        System.out.println(String.format("Server is running at %s", uri));
    }

    // A public method for tasks to use
    public URI getUri() {
        return uri;
    }

    @Override
    public void close() {
        // Stop the server ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that you should <strong>not</strong> implement the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildService.html#getParameters--">BuildService.getParameters()</a> method, as Gradle will provide an implementation of this.</p>
</div>
<div class="paragraph">
<p>A build service implementation must be thread-safe, as it will potentially be used by multiple tasks concurrently.</p>
</div>
</div>
<div class="sect3">
<h4 id="using_a_build_service_from_a_task"><a class="anchor" href="#using_a_build_service_from_a_task"></a><a class="link" href="#using_a_build_service_from_a_task">Registering a build service and connecting it to a task</a></h4>
<div class="paragraph">
<p>To create a build service, you register the service instance using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceRegistry.html#registerIfAbsent-java.lang.String-java.lang.Class-org.gradle.api.Action-">BuildServiceRegistry.registerIfAbsent()</a> method.</p>
</div>
<div class="paragraph">
<p>Registering the service does not create the service instance.
This happens on demand when a task first uses the service.
The service instance will not be created if no task uses the service during a build.</p>
</div>
<div class="paragraph">
<p>Currently, build services are scoped to a build, rather than a project, and these services are available to be shared by the tasks of all projects.
You can access the registry of shared build services via <code>Project.getGradle().getSharedServices()</code>.</p>
</div>
<div class="sect4">
<h5 id="sec:service_references"><a class="anchor" href="#sec:service_references"></a><a class="link" href="#sec:service_references">Registering a build service to be consumed via <code>@ServiceReference</code> task properties</a></h5>
<div class="paragraph">
<p>Here is an example of a plugin that registers the previous service when the task property consuming the service is annotated with <code>@ServiceReference</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">DownloadPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Plugin;
import org.gradle.api.Project;
import org.gradle.api.provider.Provider;

public class DownloadPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        // Register the service
        project.getGradle().getSharedServices().registerIfAbsent("web", WebServer.class, spec -&gt; {
            // Provide some parameters
            spec.getParameters().getPort().set(5005);
        });

        project.getTasks().register("download", Download.class, task -&gt; {
            task.getOutputFile().set(project.getLayout().getBuildDirectory().file("result.zip"));
        });
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see, there is no need to assign the build service provider returned by <code>registerIfAbsent()</code> to the task, the service is automatically injected into all matching properties that were annotated with <code>@ServiceReference</code>.</p>
</div>
<div class="paragraph">
<p>Here is an example of a task that consumes the previous service via a property annotated with <code>@ServiceReference</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.DefaultTask;
import org.gradle.api.file.RegularFileProperty;
import org.gradle.api.provider.Property;
import org.gradle.api.services.ServiceReference;
import org.gradle.api.tasks.OutputFile;
import org.gradle.api.tasks.TaskAction;

import java.net.URI;

public abstract class Download extends DefaultTask {
    // This property provides access to the service instance
    @ServiceReference("web")
    abstract Property&lt;WebServer&gt; getServer();

    @OutputFile
    abstract RegularFileProperty getOutputFile();

    @TaskAction
    public void download() {
        // Use the server to download a file
        WebServer server = getServer().get();
        URI uri = server.getUri().resolve("somefile.zip");
        System.out.println(String.format("Downloading %s", uri));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Automatic matching of registered build services with service reference properties is done by type and (optionally) by name (for properties that declare the name of the service they expect).
In case multiple services would match the requested service type (i.e. multiple services were registered for the same type, and a service name was not provided in the <code>@ServiceReference</code> annotation),
you will need also to assign the shared build service provider manually to the task property.</p>
</div>
<div class="paragraph">
<p>Read on to compare that to when the task property consuming the service is instead annotated with <code>@Internal</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="registering_a_build_service_to_be_consumed_via_internal_task_properties"><a class="anchor" href="#registering_a_build_service_to_be_consumed_via_internal_task_properties"></a><a class="link" href="#registering_a_build_service_to_be_consumed_via_internal_task_properties">Registering a build service to be consumed via <code>@Internal</code> task properties</a></h5>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">DownloadPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Plugin;
import org.gradle.api.Project;
import org.gradle.api.provider.Provider;

public class DownloadPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        // Register the service
        Provider&lt;WebServer&gt; serviceProvider = project.getGradle().getSharedServices().registerIfAbsent("web", WebServer.class, spec -&gt; {
            // Provide some parameters
            spec.getParameters().getPort().set(5005);
        });

        project.getTasks().register("download", Download.class, task -&gt; {
            // Connect the service provider to the task
            task.getServer().set(serviceProvider);
            // Declare the association between the task and the service
            task.usesService(serviceProvider);
            task.getOutputFile().set(project.getLayout().getBuildDirectory().file("result.zip"));
        });
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, the plugin registers the service and receives a <code>Provider&lt;WebService&gt;</code> back.
This provider can be connected to task properties to pass the service to the task.
Note that for a task property annotated with <code>@Internal</code>, the task property needs to (1) be explicitly assigned with the provider obtained during registation, and (2) you must tell Gradle the task uses the service via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:usesService(org.gradle.api.provider.Provider)">Task.usesService</a>.
None of that is needed when the task property consuming the service is annotated with <code>@ServiceReference</code>.</p>
</div>
<div class="paragraph">
<p>Here is an example of a task that consumes the previous service via a property annotated with <code>@Internal</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.DefaultTask;
import org.gradle.api.file.RegularFileProperty;
import org.gradle.api.provider.Property;
import org.gradle.api.tasks.Internal;
import org.gradle.api.tasks.OutputFile;
import org.gradle.api.tasks.TaskAction;

import java.net.URI;

public abstract class Download extends DefaultTask {
    // This property provides access to the service instance
    @Internal
    abstract Property&lt;WebServer&gt; getServer();

    @OutputFile
    abstract RegularFileProperty getOutputFile();

    @TaskAction
    public void download() {
        // Use the server to download a file
        WebServer server = getServer().get();
        URI uri = server.getUri().resolve("somefile.zip");
        System.out.println(String.format("Downloading %s", uri));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that using a service with any annotation other than <code>@ServiceReference</code> or <code>@Internal</code> is currently not supported.
For example, it is currently impossible to mark a service as an input to a task.</p>
</div>
</div>
<div class="sect4">
<h5 id="using_shared_build_services_from_configuration_actions"><a class="anchor" href="#using_shared_build_services_from_configuration_actions"></a><a class="link" href="#using_shared_build_services_from_configuration_actions">Using shared build services from configuration actions</a></h5>
<div class="paragraph">
<p>Generally, build services are intended to be used by tasks, and as they usually represent some potentially expensive state to create, you should avoid using them at configuration time. However, sometimes, using the service at configuration time can make sense.
This is possible; call <code>get()</code> on the provider.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using_a_build_service_with_the_worker_api"><a class="anchor" href="#using_a_build_service_with_the_worker_api"></a><a class="link" href="#using_a_build_service_with_the_worker_api">Using a build service with the Worker API</a></h4>
<div class="paragraph">
<p>In addition to using a build service from a task, you can use a build service from a <a href="#converting_to_worker_api">Worker API action</a>, an <a href="#sec:implementing-artifact-transforms">artifact transform</a> or another build service.
To do this, pass the build service <code>Provider</code> as a parameter of the consuming action or service, in the same way you pass other parameters to the action or service.</p>
</div>
<div class="paragraph">
<p>For example, to pass a <code>MyServiceType</code> service to Worker API action, you might add a property of type <code>Property&lt;MyServiceType&gt;</code> to the action&#8217;s parameters object and then connect the <code>Provider&lt;MyServiceType&gt;</code> that you receive when registering the service to this property:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">Download.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.DefaultTask;
import org.gradle.api.provider.Property;
import org.gradle.api.services.ServiceReference;
import org.gradle.api.tasks.TaskAction;
import org.gradle.workers.WorkAction;
import org.gradle.workers.WorkParameters;
import org.gradle.workers.WorkQueue;
import org.gradle.workers.WorkerExecutor;

import javax.inject.Inject;
import java.net.URI;

public abstract class Download extends DefaultTask {

    public static abstract class DownloadWorkAction implements WorkAction&lt;DownloadWorkAction.Parameters&gt; {
        interface Parameters extends WorkParameters {
            // This property provides access to the service instance from the work action
            abstract Property&lt;WebServer&gt; getServer();
        }

        @Override
        public void execute() {
            // Use the server to download a file
            WebServer server = getParameters().getServer().get();
            URI uri = server.getUri().resolve("somefile.zip");
            System.out.println(String.format("Downloading %s", uri));
        }
    }

    @Inject
    abstract public WorkerExecutor getWorkerExecutor();

    // This property provides access to the service instance from the task
    @ServiceReference("web")
    abstract Property&lt;WebServer&gt; getServer();

    @TaskAction
    public void download() {
        WorkQueue workQueue = getWorkerExecutor().noIsolation();
        workQueue.submit(DownloadWorkAction.class, parameter -&gt; {
            parameter.getServer().set(getServer());
        });
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Currently, it is impossible to use a build service with a worker API action that uses ClassLoader or process isolation modes.</p>
</div>
</div>
<div class="sect3">
<h4 id="accessing_the_build_service_concurrently"><a class="anchor" href="#accessing_the_build_service_concurrently"></a><a class="link" href="#accessing_the_build_service_concurrently">Accessing the build service concurrently</a></h4>
<div class="paragraph">
<p>You can constrain concurrent execution when you register the service, by using the <code>Property</code> object returned from <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceSpec.html#getMaxParallelUsages--">BuildServiceSpec.getMaxParallelUsages()</a>.
When this property has no value, which is the default, Gradle does not constrain access to the service.
When this property has a value &gt; 0, Gradle will allow no more than the specified number of tasks to use the service concurrently.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When the consuming task property is annotated with <code>@Internal</code>, for the constraint to take effect, the build service <strong>must</strong> be registered with the consuming task via
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:usesService(org.gradle.api.provider.Provider)">Task.usesService</a>. NOTE: at this time, Gradle cannot discover indirect usage of services (for instance, if an additional service is used only by a service that the task uses directly).
As a workaround, indirect usage may be declared explicitly to Gradle by either adding a <code>@ServiceReference</code> property to the task and assigning the service that is only used indirectly to it (making it a direct reference),
or invoking <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:usesService(org.gradle.api.provider.Provider)">Task.usesService</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="operation_listener"><a class="anchor" href="#operation_listener"></a><a class="link" href="#operation_listener">Receiving information about task execution</a></h4>
<div class="paragraph">
<p>A build service can be used to receive events as tasks are executed.
To do this, create and register a build service that implements <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/OperationCompletionListener.html">OperationCompletionListener</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">TaskEventsService.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.services.BuildService;
import org.gradle.api.services.BuildServiceParameters;
import org.gradle.tooling.events.FinishEvent;
import org.gradle.tooling.events.OperationCompletionListener;
import org.gradle.tooling.events.task.TaskFinishEvent;

public abstract class TaskEventsService implements BuildService&lt;BuildServiceParameters.None&gt;,
    OperationCompletionListener { // <b class="conum">(1)</b>

    @Override
    public void onFinish(FinishEvent finishEvent) {
        if (finishEvent instanceof TaskFinishEvent) { // <b class="conum">(2)</b>
            // Handle task finish event...
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Implement the <code>OperationCompletionListener</code> interface and the <code>BuildService</code> interface.</p>
</li>
<li>
<p>Check if the finish event is a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/task/TaskFinishEvent.html">TaskFinishEvent</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then, in the plugin, you can use the methods on the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/build/event/BuildEventsListenerRegistry.html">BuildEventsListenerRegistry</a> service to start receiving events:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">TaskEventsPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Plugin;
import org.gradle.api.Project;
import org.gradle.api.provider.Provider;
import org.gradle.build.event.BuildEventsListenerRegistry;

import javax.inject.Inject;

public abstract class TaskEventsPlugin implements Plugin&lt;Project&gt; {
    @Inject
    public abstract BuildEventsListenerRegistry getEventsListenerRegistry(); // <b class="conum">(1)</b>

    @Override
    public void apply(Project project) {
        Provider&lt;TaskEventsService&gt; serviceProvider =
            project.getGradle().getSharedServices().registerIfAbsent(
                "taskEvents", TaskEventsService.class, spec -&gt; {}); // <b class="conum">(2)</b>

        getEventsListenerRegistry().onTaskCompletion(serviceProvider); // <b class="conum">(3)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use <a href="#service_injection">service injection</a> to obtain an instance of the <code>BuildEventsListenerRegistry</code>.</p>
</li>
<li>
<p>Register the build service as usual.</p>
</li>
<li>
<p>Use the service <code>Provider</code> to subscribe to the build service to build events.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developing_plugins"><a class="anchor" href="#developing_plugins"></a><a class="link" href="#developing_plugins">DEVELOPING PLUGINS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="custom_plugins"><a class="anchor" href="#custom_plugins"></a><a class="link" href="#custom_plugins">Understanding Plugins</a></h3>
<div class="paragraph">
<p>Gradle comes with a set of powerful core systems such as dependency management, task execution, and project configuration.
But everything else it can do is supplied by plugins.</p>
</div>
<div class="paragraph">
<p>Plugins encapsulate logic for specific tasks or integrations, such as compiling code, running tests, or deploying artifacts.
By applying plugins, users can easily add new features to their build process without having to write complex code from scratch.</p>
</div>
<div class="paragraph">
<p>This plugin-based approach allows Gradle to be lightweight and modular.
It also promotes code reuse and maintainability, as plugins can be shared across projects or within an organization.</p>
</div>
<div class="paragraph">
<p>Before reading this chapter, it&#8217;s recommended that you first read <a href="gradle_directories_intermediate.html#gradle_directories">Learning The Basics</a> and complete the <a href="part1_gradle_init_project.html#part1_gradle_init">Tutorial</a>.</p>
</div>
<div class="sect3">
<h4 id="plugins_introduction"><a class="anchor" href="#plugins_introduction"></a><a class="link" href="#plugins_introduction">Plugins Introduction</a></h4>
<div class="paragraph">
<p>Plugins can be sourced from Gradle or the Gradle community.
But when users want to organize their build logic or need specific build capabilities not provided by existing plugins, they can develop their own.</p>
</div>
<div class="paragraph">
<p>As such, we distinguish between three different kinds of plugins:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Core Plugins</strong> - plugins that come from Gradle.</p>
</li>
<li>
<p><strong>Community Plugins</strong> - plugins that come from <a href="https://plugins.gradle.org/">Gradle Plugin Portal</a> or a public repository.</p>
</li>
<li>
<p><strong>Local or Custom Plugins</strong> - plugins that you develop yourself.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="core_plugins_2"><a class="anchor" href="#core_plugins_2"></a><a class="link" href="#core_plugins_2">Core Plugins</a></h5>
<div class="paragraph">
<p>The term <strong>core plugin</strong> refers to a plugin that is part of the Gradle distribution such as the <a href="#java_library_plugin">Java Library Plugin</a>.
They are always available.</p>
</div>
</div>
<div class="sect4">
<h5 id="community_plugins"><a class="anchor" href="#community_plugins"></a><a class="link" href="#community_plugins">Community Plugins</a></h5>
<div class="paragraph">
<p>The term <strong>community plugin</strong> refers to a plugin published to the Gradle Plugin Portal (or another public repository) such as the <a href="https://plugins.gradle.org/plugin/com.diffplug.gradle.spotless">Spotless Plugin</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="local_or_custom_plugins"><a class="anchor" href="#local_or_custom_plugins"></a><a class="link" href="#local_or_custom_plugins">Local or Custom Plugins</a></h5>
<div class="paragraph">
<p>The term <strong>local or custom plugin</strong> refers to a plugin you write yourself for your own build.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom_plugins_2"><a class="anchor" href="#custom_plugins_2"></a><a class="link" href="#custom_plugins_2">Custom plugins</a></h4>
<div class="paragraph">
<p>There are three types of <strong>custom plugins</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Location:</th>
<th class="tableblock halign-left valign-top">Most likely:</th>
<th class="tableblock halign-left valign-top">Benefit:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:build_script_plugins">1</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:build_script_plugins">Script plugins</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>.gradle(.kts)</code> script file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A local plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plugin is automatically compiled and included in the classpath of the build script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:precompile_script_plugin">2</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:precompile_script_plugin">Precompiled script plugins</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:using_buildsrc"><code>buildSrc</code></a> folder or <a href="#composite_builds">composite</a> build</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A convention plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plugin is automatically compiled, tested, and available on the classpath of the build script. The plugin is visible to every build script used by the build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:custom_plugins_standalone_project">3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:custom_plugins_standalone_project">Binary plugins</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standalone project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A shared plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plugin JAR is produced and published. The plugin can be used in multiple builds and shared with others.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:build_script_plugins"><a class="anchor" href="#sec:build_script_plugins"></a><a class="link" href="#sec:build_script_plugins">Script plugins</a></h4>
<div class="paragraph">
<p><strong>Script plugins</strong> are typically small, local plugins written in script files for tasks specific to a single build or project.
They do not need to be reused across multiple projects.
Script plugins <strong>are not recommended</strong> but many other forms of plugins evolve from script plugins.</p>
</div>
<div class="paragraph">
<p>To create a plugin, you need to write a class that implements the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Plugin.html">Plugin</a> interface.</p>
</div>
<div id="sec:writing_a_simple_plugin" class="paragraph">
<p>The following sample creates a <code>GreetingPlugin</code>, which adds a <code>hello</code> task to a project when applied:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        project.task("hello") {
            doLast {
                println("Hello from the GreetingPlugin")
            }
        }
    }
}

// Apply the plugin
apply&lt;GreetingPlugin&gt;()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        project.task('hello') {
            doLast {
                println 'Hello from the GreetingPlugin'
            }
        }
    }
}

// Apply the plugin
apply plugin: GreetingPlugin</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Hello from the GreetingPlugin</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Project</code> object is passed as a parameter in <code>apply()</code>, which the plugin can use to configure the project however it needs to (such as adding tasks, configuring dependencies, etc.).
In this example, the plugin is written directly in the build file which is <strong>not a recommended practice</strong>.</p>
</div>
<div class="paragraph">
<p>When the plugin is written in a separate script file, it can be applied using <code>apply(from = "file_name.gradle.kts")</code> or <code>apply from: 'file_name.gradle'</code>.
In the example below, the plugin is coded in the <code>other.gradle(.kts)</code> script file.
Then, the <code>other.gradle(.kts)</code> is applied to <code>build.gradle(.kts)</code> using <code>apply from</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">other.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class GreetingScriptPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        project.task("hi") {
            doLast {
                println("Hi from the GreetingScriptPlugin")
            }
        }
    }
}

// Apply the plugin
apply&lt;GreetingScriptPlugin&gt;()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">other.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class GreetingScriptPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        project.task('hi') {
            doLast {
                println 'Hi from the GreetingScriptPlugin'
            }
        }
    }
}

// Apply the plugin
apply plugin: GreetingScriptPlugin</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply(from = "other.gradle.kts")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">apply from: 'other.gradle'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hi
Hi from the GreetingScriptPlugin</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Script plugins should be avoided.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="sec:precompile_script_plugin"><a class="anchor" href="#sec:precompile_script_plugin"></a><a class="link" href="#sec:precompile_script_plugin">Precompiled script plugins</a></h4>
<div class="paragraph">
<p><strong>Precompiled script plugins</strong> are compiled into class files and packaged into a JAR before they are executed.
These plugins use the Groovy DSL or Kotlin DSL instead of pure Java, Kotlin, or Groovy.
They are best used as <strong>convention plugins</strong> that share build logic across projects or as a way to neatly organize build logic.</p>
</div>
<div class="paragraph">
<p>To create a precompiled script plugin, you can:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use Gradle&#8217;s Kotlin DSL - The plugin is a <code>.gradle.kts</code> file, and apply <code> <code>kotlin-dsl</code> </code>.</p>
</li>
<li>
<p>Use Gradle&#8217;s Groovy DSL - The plugin is a <code>.gradle</code> file, and apply <code>id("groovy-gradle-plugin")</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To apply a precompiled script plugin, you need to know its ID.
The ID is derived from the plugin script&#8217;s filename and its (optional) package declaration.</p>
</div>
<div class="paragraph">
<p>For example, the script <code>src/main/*/some-java-library.gradle(.kts)</code> has a plugin ID of <code>some-java-library</code> (assuming it has no package declaration).
Likewise, <code>src/main/*/my/some-java-library.gradle(.kts)</code> has a plugin ID of <code>my.some-java-library</code> as long as it has a package declaration of <code>my</code>.</p>
</div>
<div class="paragraph">
<p>Precompiled script plugin names have two important limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They cannot start with <code>org.gradle</code>.</p>
</li>
<li>
<p>They cannot have the same name as a <a href="#plugin_reference">core plugin</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the plugin is applied to a project, Gradle creates an instance of the plugin class and calls the instance&#8217;s <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Plugin.html#apply-T-">Plugin.apply()</a> method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A new instance of a <code>Plugin</code> is created within each project applying that plugin.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s rewrite the <code>GreetingPlugin</code> script plugin as a precompiled script plugin.
Since we are using the Groovy or Kotlin DSL, the file essentially becomes the plugin.
The original script plugin simply created a <code>hello</code> task which printed a greeting, this is what we will do in the pre-compiled script plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/GreetingPlugin.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("hello") {
    doLast {
        println("Hello from the convention GreetingPlugin")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/GreetingPlugin.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("hello") {
    doLast {
        println("Hello from the convention GreetingPlugin")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>GreetingPlugin</code> can now be applied in other subprojects' builds by using its ID:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    application
    id("GreetingPlugin")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
    id('GreetingPlugin')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Hello from the convention GreetingPlugin</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:convention_plugins"><a class="anchor" href="#sec:convention_plugins"></a><a class="link" href="#sec:convention_plugins">Convention plugins</a></h4>
<div class="paragraph">
<p>A <strong>convention plugin</strong> is typically a precompiled script plugin that configures existing core and community plugins with your own conventions (i.e. default values) such as setting the Java version by using <code>java.toolchain.languageVersion = JavaLanguageVersion.of(17)</code>.
Convention plugins are also used to enforce project standards and help streamline the build process.
They can apply and configure plugins, create new tasks and extensions, set dependencies, and much more.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take an example build with three subprojects: one for <code>data-model</code>, one for <code>database-logic</code> and one for <code>app</code> code.
The project has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">.
 buildSrc
    src
      ...
    build.gradle.kts
 data-model
    src
      ...
    build.gradle.kts
 database-logic
    src
      ...
    build.gradle.kts
 app
    src
      ...
    build.gradle.kts
 settings.gradle.kts</code></pre>
</div>
</div>
<div class="paragraph">
<p>The build file of the <code>database-logic</code> subproject is as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">database-logic/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    id("org.jetbrains.kotlin.jvm") version "2.2.0"
}

repositories {
    mavenCentral()
}

java {
    toolchain.languageVersion.set(JavaLanguageVersion.of(11))
}

tasks.test {
    useJUnitPlatform()
}

kotlin {
    jvmToolchain(11)
}

// More build logic</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">database-logic/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'org.jetbrains.kotlin.jvm' version '2.2.0'
}

repositories {
    mavenCentral()
}

java {
    toolchain.languageVersion.set(JavaLanguageVersion.of(11))
}

tasks.test {
    useJUnitPlatform()
}

kotlin {
    jvmToolchain {
        languageVersion.set(JavaLanguageVersion.of(11))
    }
}

// More build logic</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We apply the <code>java-library</code> plugin and add the <code>org.jetbrains.kotlin.jvm</code> plugin for Kotlin support.
We also configure Kotlin, Java, tests and more.</p>
</div>
<div class="paragraph">
<p>Our build file is beginning to grow&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>The more plugins we apply and the more plugins we configure, the larger it gets.
There&#8217;s also repetition in the build files of the <code>app</code> and <code>data-model</code> subprojects, especially when configuring common extensions like setting the Java version and Kotlin support.</p>
</div>
<div class="paragraph">
<p>To address this, we use convention plugins.
This allows us to avoid repeating configuration in each build file and keeps our build scripts more concise and maintainable.
In convention plugins, we can encapsulate arbitrary build configuration or custom build logic.</p>
</div>
<div class="paragraph">
<p>To develop a convention plugin, we recommend using <a href="#sec:using_buildsrc"><code>buildSrc</code></a>  which represents a completely separate Gradle build.
<code>buildSrc</code> has its own settings file to define where dependencies of this build are located.</p>
</div>
<div class="paragraph">
<p>We add a Kotlin script called <code>my-java-library.gradle.kts</code> inside the <code>buildSrc/src/main/kotlin</code> directory.
Or conversely, a Groovy script called <code>my-java-library.gradle</code> inside the <code>buildSrc/src/main/groovy</code> directory.
We put all the plugin application and configuration from the <code>database-logic</code> build file into it:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/my-java-library.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    id("org.jetbrains.kotlin.jvm")
}

repositories {
    mavenCentral()
}

java {
    toolchain.languageVersion.set(JavaLanguageVersion.of(11))
}

tasks.test {
    useJUnitPlatform()
}

kotlin {
    jvmToolchain(11)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/my-java-library.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'org.jetbrains.kotlin.jvm'
}

repositories {
    mavenCentral()
}

java {
    toolchain.languageVersion.set(JavaLanguageVersion.of(11))
}

tasks.test {
    useJUnitPlatform()
}

kotlin {
    jvmToolchain {
        languageVersion.set(JavaLanguageVersion.of(11))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The name of the file <code>my-java-library</code> is the ID of our brand-new plugin, which we can now use in all of our subprojects.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Why is the version of <code>id 'org.jetbrains.kotlin.jvm'</code> missing? See <a href="#sec:applying_external_plugins">Applying External Plugins to Pre-Compiled Script Plugins</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>database-logic</code> build file becomes much simpler by removing all the redundant build logic and applying our convention <code>my-java-library</code> plugin instead:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">database-logic/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("my-java-library")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">database-logic/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id('my-java-library')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This convention plugin enables us to easily share common configurations across all our build files.
Any modifications can be made in one place, simplifying maintenance.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_plugins_standalone_project"><a class="anchor" href="#sec:custom_plugins_standalone_project"></a><a class="link" href="#sec:custom_plugins_standalone_project">Binary plugins</a></h4>
<div class="paragraph">
<p><strong>Binary plugins</strong> in Gradle are plugins that are built as standalone JAR files and applied to a project using the <code>plugins{}</code> block in the build script.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s move our <code>GreetingPlugin</code> to a standalone project so that we can publish it and share it with others.
The plugin is essentially moved from the <code>buildSrc</code> folder to its own build called <code>greeting-plugin</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can publish the plugin from <code>buildSrc</code>, but this is not recommended practice. Plugins that are ready for publication should be in their own build.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>greeting-plugin</code> is simply a Java project that produces a JAR containing the plugin classes.</p>
</div>
<div class="paragraph">
<p>The easiest way to package and publish a plugin to a repository is to use the <a href="java_gradle_plugin.html#java_gradle_plugin">Gradle Plugin Development Plugin</a>.
This plugin provides the necessary tasks and configurations (including the plugin metadata) to compile your script into a plugin that can be applied in other builds.</p>
</div>
<div class="paragraph">
<p>Here is a simple build script for the <code>greeting-plugin</code> project using the Gradle Plugin Development Plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-gradle-plugin`
}

gradlePlugin {
    plugins {
        create("simplePlugin") {
            id = "org.example.greeting"
            implementationClass = "org.example.GreetingPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-gradle-plugin'
}

gradlePlugin {
    plugins {
        simplePlugin {
            id = 'org.example.greeting'
            implementationClass = 'org.example.GreetingPlugin'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more on publishing plugins, see <a href="#plugin-publishing-plugin">Publishing Plugins</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="project_vs_settings_vs_init_plugins"><a class="anchor" href="#project_vs_settings_vs_init_plugins"></a><a class="link" href="#project_vs_settings_vs_init_plugins">Project vs Settings vs Init plugins</a></h4>
<div class="paragraph">
<p>In the example used through this section, the plugin accepts the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a> type as a type parameter.
However, Gradle supports applying plugins in three distinct contexts: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html"><code>Project</code></a>, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html"><code>Settings</code></a>, and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html"><code>Init</code></a>.
Each type of plugin serves a different purpose and is applied in a different phase of the build lifecycle.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Project Plugin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A project plugin is applied to an individual project within a build. It can customize build logic, register tasks, and configure project-specific settings. These plugins are applied in <code>build.gradle</code> or <code>build.gradle.kts</code> files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Settings Plugin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A settings plugin is applied in the <code>settings.gradle</code> or <code>settings.gradle.kts</code> file. It is used to configure settings that apply to the entire build, such as which subprojects are included, where to find build logic, and buildscript repositories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Init Plugin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An init plugin is applied in an <code>init.gradle</code> or <code>init.gradle.kts</code> file. It configures settings that apply globally across multiple Gradle builds on a machine, such as setting up plugin repositories, enforcing conventions, or applying common plugins to all builds.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When writing <strong>precompiled script plugins</strong>, Gradle determines the intended plugin target (<code>Project</code>, <code>Settings</code>, or <code>Init</code>) based on the file name of the plugin source file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Filename Suffix</th>
<th class="tableblock halign-left valign-top">Applies To</th>
<th class="tableblock halign-left valign-top">Recognized As</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.gradle</code>, <code>.gradle.kts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Plugin&lt;Project&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.settings.gradle</code>, <code>.settings.gradle.kts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Plugin&lt;Settings&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.init.gradle</code>, <code>.init.gradle.kts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Init</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Plugin&lt;Init&gt;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, a file named <code>myplugin.gradle.kts</code> will always be treated as a Project plugineven if it&#8217;s applied from a <code>settings.gradle.kts</code> file. To create a plugin for the settings context, it must be named something like <code>myplugin.settings.gradle.kts</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implemention_plugins"><a class="anchor" href="#implemention_plugins"></a><a class="link" href="#implemention_plugins">Implementation Options for Plugins</a></h3>
<div class="paragraph">
<p>The choice between script, precompiled script, or binary plugins depends on your specific requirements and preferences.</p>
</div>
<div class="paragraph">
<p><strong>Script Plugins</strong> are simple and easy to write.
They are written in Kotlin DSL or Groovy DSL.
They are suitable for small, one-off tasks or for quick experimentation.
However, they can become hard to maintain as the build script grows in size and complexity.</p>
</div>
<div class="paragraph">
<p><strong>Precompiled Script Plugins</strong> are Kotlin or Groovy DSL scripts compiled into Java class files packaged in a library.
They offer better performance and maintainability compared to script plugins, and they can be reused across different projects.
You can also write them in Groovy DSL but that is not recommended.</p>
</div>
<div class="paragraph">
<p><strong>Binary Plugins</strong> are full-fledged plugins written in Java, Groovy, or Kotlin, compiled into JAR files, and published to a repository.
They offer the best performance, maintainability, and reusability.
They are suitable for complex build logic that needs to be shared across projects, builds, and teams.
You can also write them in Scala or Groovy but that is not recommended.</p>
</div>
<div class="paragraph">
<p>Here is a breakdown of all options for implementing Gradle plugins:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>#</strong></th>
<th class="tableblock halign-left valign-top"><strong>Using:</strong></th>
<th class="tableblock halign-left valign-top"><strong>Type:</strong></th>
<th class="tableblock halign-left valign-top"><strong>The Plugin is:</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recommended?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kotlin DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">in a <code>.gradle.kts</code> file as an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No<sup class="footnote" id="_footnote_1">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groovy DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">in a <code>.gradle</code> file as an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kotlin DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-compiled script plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a <code>.gradle.kts</code> file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groovy DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-compiled script plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a <code>.gradle</code> file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ok<sup class="footnote" id="_footnote_2">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface in Java.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kotlin / Kotlin DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface in Kotlin and/or Kotlin DSL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groovy / Groovy DSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface in Groovy and/or Groovy DSL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ok<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary plugin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an abstract class that implements the <code>apply(Project project)</code> method of the <code>Plugin&lt;Project&gt;</code> interface in Scala.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you suspect issues with your plugin code, try creating a <a href="https://scans.gradle.com/">Build Scan</a> to identify bottlenecks.
The <a href="https://github.com/gradle/gradle-profiler">Gradle profiler</a> can help automate Build Scan generation and gather more low-level information.</p>
</div>
</div>
<div class="sect2">
<h3 id="implemention_precompiled_plugins"><a class="anchor" href="#implemention_precompiled_plugins"></a><a class="link" href="#implemention_precompiled_plugins">Implementing Pre-compiled Script Plugins</a></h3>
<div class="paragraph">
<p>A <strong>precompiled script plugin</strong> is typically a Kotlin script that has been compiled and distributed as Java class files packaged in a library.
These scripts are intended to be consumed as binary Gradle plugins and are recommended for use as convention plugins.</p>
</div>
<div class="paragraph">
<p>A <strong>convention plugin</strong> is a plugin that normally configures existing core and community plugins with your own conventions (i.e. default values) such as setting the Java version by using <code>java.toolchain.languageVersion = JavaLanguageVersion.of(17)</code>.
Convention plugins are also used to enforce project standards and help streamline the build process.
They can apply and configure plugins, create new tasks and extensions, set dependencies, and much more.</p>
</div>
<div class="sect3">
<h4 id="sec:the_plugin_id"><a class="anchor" href="#sec:the_plugin_id"></a><a class="link" href="#sec:the_plugin_id">Setting the plugin ID</a></h4>
<div class="paragraph">
<p>The plugin ID for a precompiled script is derived from its file name and optional package declaration.</p>
</div>
<div class="paragraph">
<p>For example, a script named <code>code-quality.gradle(.kts)</code> located in <code>src/main/groovy</code> (or <code>src/main/kotlin</code>) without a package declaration would be exposed as the <code>code-quality</code> plugin:</p>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("code-quality")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy-gradle-plugin'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'code-quality'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On the other hand, a script named <code>code-quality.gradle.kts</code> located in <code>src/main/kotlin/my</code> with the package declaration <code>my</code> would be exposed as the <code>my.code-quality</code> plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("my.code-quality")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When creating precompiled script plugins intended for <code>Settings</code> or <code>Init</code> scripts, the filename suffix determines where Gradle applies them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.settings.gradle</code> or <code>.settings.gradle.kts</code>  interpreted as <code>Plugin&lt;Settings&gt;</code></p>
</li>
<li>
<p><code>.init.gradle</code> or <code>.init.gradle.kts</code>  interpreted as <code>Plugin&lt;Init&gt;</code></p>
</li>
<li>
<p><code>.gradle</code> or <code>.gradle.kts</code>  interpreted as the default <code>Plugin&lt;Project&gt;</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Groovy pre-compiled script plugins cannot have packages.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:getting_input_from_the_build"><a class="anchor" href="#sec:getting_input_from_the_build"></a><a class="link" href="#sec:getting_input_from_the_build">Making a plugin configurable using extensions</a></h4>
<div class="paragraph">
<p><strong>Extension objects</strong> are commonly used in plugins to expose configuration options and additional functionality to build scripts.</p>
</div>
<div class="paragraph">
<p>When you apply a plugin that defines an extension, you can access the extension object and configure its properties or call its methods to customize the behavior of the plugin or tasks provided by the plugin.</p>
</div>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a> has an associated <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/plugins/ExtensionContainer.html">ExtensionContainer</a> object that contains all the settings and properties for the plugins that have been applied to the project.
You can provide configuration for your plugin by adding an extension object to this container.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s update our <code>greetings</code> example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/greetings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create extension object
interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
}

// Add the 'greeting' extension object to project
val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/greetings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create extension object
interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
}

// Add the 'greeting' extension object to project
def extension = project.extensions.create("greeting", GreetingPluginExtension)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can set the value of the <code>message</code> property directly with <code>extension.message.set("Hi from Gradle,")</code>.</p>
</div>
<div class="paragraph">
<p>However, the <code>GreetingPluginExtension</code> object becomes available as a project property with the same name as the extension object.
You can now access <code>message</code> like so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/greetings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Where the&lt;GreetingPluginExtension&gt;() is equivalent to project.extensions.getByType(GreetingPluginExtension::class.java)
the&lt;GreetingPluginExtension&gt;().message.set("Hi from Gradle")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/greetings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">extensions.findByType(GreetingPluginExtension).message.set("Hi from Gradle")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you apply the <code>greetings</code> plugin, you can set the convention in your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    application
    id("greetings")
}

greeting {
    message = "Hello from Gradle"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
    id('greetings')
}

configure(greeting) {
    message = "Hello from Gradle"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:plugin_conventions"><a class="anchor" href="#sec:plugin_conventions"></a><a class="link" href="#sec:plugin_conventions">Adding default configuration as conventions</a></h4>
<div class="paragraph">
<p>In plugins, you can define default values, also known as <strong>conventions</strong>, using the <code>project</code> object.</p>
</div>
<div class="paragraph">
<p>Convention properties are properties that are initialized with default values but can be overridden:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/greetings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create extension object
interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
}

// Add the 'greeting' extension object to project
val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")

// Set a default value for 'message'
extension.message.convention("Hello from Gradle")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/greetings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create extension object
interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
}

// Add the 'greeting' extension object to project
def extension = project.extensions.create("greeting", GreetingPluginExtension)

// Set a default value for 'message'
extension.message.convention("Hello from Gradle")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>extension.message.convention(&#8230;&#8203;)</code> sets a convention for the <code>message</code> property of the extension.
This convention specifies that the value of <code>message</code> should default to <code>"Hello from Gradle"</code>.</p>
</div>
<div class="paragraph">
<p>If the <code>message</code> property is not explicitly set, its value will be automatically set to <code>"Hello from Gradle"</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:mapping_extension_properties_to_task_properties"><a class="anchor" href="#sec:mapping_extension_properties_to_task_properties"></a><a class="link" href="#sec:mapping_extension_properties_to_task_properties">Mapping extension properties to task properties</a></h4>
<div class="paragraph">
<p>Using an extension and mapping it to a custom task&#8217;s input/output properties is common in plugins.</p>
</div>
<div class="paragraph">
<p>In this example, the message property of the <code>GreetingPluginExtension</code> is mapped to the message property of the <code>GreetingTask</code> as an input:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/greetings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Create extension object
interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
}

// Add the 'greeting' extension object to project
val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")

// Set a default value for 'message'
extension.message.convention("Hello from Gradle")

// Create a greeting task
abstract class GreetingTask : DefaultTask() {
    @Input
    val message = project.objects.property&lt;String&gt;()

    @TaskAction
    fun greet() {
        println("Message: ${message.get()}")
    }
}

// Register the task and set the convention
tasks.register&lt;GreetingTask&gt;("hello") {
    message.convention(extension.message)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/greetings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Create extension object
interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
}

// Add the 'greeting' extension object to project
def extension = project.extensions.create("greeting", GreetingPluginExtension)

// Set a default value for 'message'
extension.message.convention("Hello from Gradle")

// Create a greeting task
abstract class GreetingTask extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getMessage()

    @TaskAction
    void greet() {
        println("Message: ${message.get()}")
    }
}

// Register the task and set the convention
tasks.register("hello", GreetingTask) {
    message.convention(extension.message)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Message: Hello from Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>This means that changes to the extension&#8217;s <code>message</code> property will trigger the task to be considered out-of-date, ensuring that the task is re-executed with the new message.</p>
</div>
<div class="paragraph">
<p>You can find out more about types that you can use in task implementations and extensions in <a href="#lazy_configuration">Lazy Configuration</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:applying_external_plugins"><a class="anchor" href="#sec:applying_external_plugins"></a><a class="link" href="#sec:applying_external_plugins">Applying external plugins</a></h4>
<div class="paragraph">
<p>In order to apply an external plugin in a precompiled script plugin, it has to be added to the plugin project&#8217;s implementation classpath in the plugin&#8217;s build file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("com.bmuschko:gradle-docker-plugin:6.4.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy-gradle-plugin'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'com.bmuschko:gradle-docker-plugin:6.4.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It can then be applied in the precompiled script plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/my-plugin.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("com.bmuschko.docker-remote-api")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/my-plugin.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'com.bmuschko.docker-remote-api'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The plugin version in this case is defined in the dependency declaration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implemention_binary_plugins"><a class="anchor" href="#implemention_binary_plugins"></a><a class="link" href="#implemention_binary_plugins">Implementing Binary Plugins</a></h3>
<div class="paragraph">
<p><strong>Binary plugins</strong> refer to plugins that are compiled and distributed as JAR files.
These plugins are usually written in Java or Kotlin and provide custom functionality or tasks to a Gradle build.</p>
</div>
<div class="sect3">
<h4 id="plugin-development-plugin"><a class="anchor" href="#plugin-development-plugin"></a><a class="link" href="#plugin-development-plugin">Using the Plugin Development plugin</a></h4>
<div class="paragraph">
<p>The <a href="java_gradle_plugin.html#java_gradle_plugin">Gradle Plugin Development plugin</a> can be used to assist in developing Gradle plugins.</p>
</div>
<div class="paragraph">
<p>This plugin will automatically apply the <a href="java_plugin.html#java_plugin">Java Plugin</a>, add the <code>gradleApi()</code> dependency to the <code>api</code> configuration, generate the required plugin descriptors in the resulting JAR file, and configure the <a href="plugins_intermediate.html#sec:plugin_markers">Plugin Marker Artifact</a> to be used when publishing.</p>
</div>
<div class="paragraph">
<p>To apply and configure the plugin, add the following code to your build file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-gradle-plugin`
}

gradlePlugin {
    plugins {
        create("simplePlugin") {
            id = "org.example.greeting"
            implementationClass = "org.example.GreetingPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-gradle-plugin'
}

gradlePlugin {
    plugins {
        simplePlugin {
            id = 'org.example.greeting'
            implementationClass = 'org.example.GreetingPlugin'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Writing and using <a href="#sec:task_groups">custom task types</a> is recommended when developing plugins as it automatically benefits from <a href="incremental_build.html#incremental_build">incremental builds</a>.
As an added benefit of applying the plugin to your project, the task <code>validatePlugins</code> automatically checks for an existing input/output annotation for every public property defined in a custom task type implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_a_plugin_id"><a class="anchor" href="#sec:creating_a_plugin_id"></a><a class="link" href="#sec:creating_a_plugin_id">Creating a plugin ID</a></h4>
<div class="paragraph">
<p>Plugin IDs are meant to be globally unique, similar to Java package names (i.e., a reverse domain name).
This format helps prevent naming collisions and allows grouping plugins with similar ownership.</p>
</div>
<div class="paragraph">
<p>An explicit plugin identifier simplifies applying the plugin to a project.
Your plugin ID should combine components that reflect the namespace (a reasonable pointer to you or your organization) and the name of the plugin it provides.
For example, if your Github account is named <code>foo</code> and your plugin is named <code>bar</code>, a suitable plugin ID might be <code>com.github.foo.bar</code>.
Similarly, if the plugin was developed at the <code>baz</code> organization, the plugin ID might be <code>org.baz.bar</code>.</p>
</div>
<div class="paragraph">
<p>Plugin IDs should adhere to the following guidelines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>May contain any alphanumeric character, '.', and '-'.</p>
</li>
<li>
<p>Must contain at least one '.' character separating the namespace from the plugin&#8217;s name.</p>
</li>
<li>
<p>Conventionally use a lowercase reverse domain name convention for the namespace.</p>
</li>
<li>
<p>Conventionally use only lowercase characters in the name.</p>
</li>
<li>
<p><code>org.gradle</code>, <code>com.gradle</code>, and <code>com.gradleware</code> namespaces may not be used.</p>
</li>
<li>
<p>Cannot start or end with a '.' character.</p>
</li>
<li>
<p>Cannot contain consecutive '.' characters (i.e., '..').</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A namespace that identifies ownership and a name is sufficient for a plugin ID.</p>
</div>
<div class="paragraph">
<p>When bundling multiple plugins in a single JAR artifact, adhering to the same naming conventions is recommended.
This practice helps logically group related plugins.</p>
</div>
<div class="paragraph">
<p>There is no limit to the number of plugins that can be defined and registered (by different identifiers) within a single project.</p>
</div>
<div class="paragraph">
<p>The identifiers for plugins written as a class should be defined in the project&#8217;s build script containing the plugin classes.
For this, the <code>java-gradle-plugin</code> needs to be applied:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-gradle-plugin")
}

gradlePlugin {
    plugins {
        create("androidApplicationPlugin") {
            id = "com.android.application"
            implementationClass = "com.android.AndroidApplicationPlugin"
        }
        create("androidLibraryPlugin") {
            id = "com.android.library"
            implementationClass = "com.android.AndroidLibraryPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-gradle-plugin'
}

gradlePlugin {
    plugins {
        androidApplicationPlugin {
            id = 'com.android.application'
            implementationClass = 'com.android.AndroidApplicationPlugin'
        }
        androidLibraryPlugin {
            id = 'com.android.library'
            implementationClass = 'com.android.AndroidLibraryPlugin'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:working_with_files_in_custom_tasks_and_plugins"><a class="anchor" href="#sec:working_with_files_in_custom_tasks_and_plugins"></a><a class="link" href="#sec:working_with_files_in_custom_tasks_and_plugins">Working with files</a></h4>
<div class="paragraph">
<p>When developing plugins, it&#8217;s a good idea to be flexible when accepting input configuration for file locations.</p>
</div>
<div class="paragraph">
<p>It is recommended to use Gradle&#8217;s <a href="#managed_properties">managed properties</a> and <code>project.layout</code> to select file or directory locations.
This will enable lazy configuration so that the actual location will only be resolved when the file is needed and can be reconfigured at any time during build configuration.</p>
</div>
<div class="paragraph">
<p>This Gradle build file defines a task <code>GreetingToFileTask</code> that writes a greeting to a file.
It also registers two tasks: <code>greet</code>, which creates the file with the greeting, and <code>sayGreeting</code>, which prints the file&#8217;s contents.
The <code>greetingFile</code> property is used to specify the file path for the greeting:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class GreetingToFileTask : DefaultTask() {

    @get:OutputFile
    abstract val destination: RegularFileProperty

    @TaskAction
    fun greet() {
        val file = destination.get().asFile
        file.parentFile.mkdirs()
        file.writeText("Hello!")
    }
}

val greetingFile = objects.fileProperty()

tasks.register&lt;GreetingToFileTask&gt;("greet") {
    destination = greetingFile
}

tasks.register("sayGreeting") {
    dependsOn("greet")
    val greetingFile = greetingFile
    doLast {
        val file = greetingFile.get().asFile
        println("${file.readText()} (file: ${file.name})")
    }
}

greetingFile = layout.buildDirectory.file("hello.txt")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class GreetingToFileTask extends DefaultTask {

    @OutputFile
    abstract RegularFileProperty getDestination()

    @TaskAction
    def greet() {
        def file = getDestination().get().asFile
        file.parentFile.mkdirs()
        file.write 'Hello!'
    }
}

def greetingFile = objects.fileProperty()

tasks.register('greet', GreetingToFileTask) {
    destination = greetingFile
}

tasks.register('sayGreeting') {
    dependsOn greet
    doLast {
        def file = greetingFile.get().asFile
        println "${file.text} (file: ${file.name})"
    }
}

greetingFile = layout.buildDirectory.file('hello.txt')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q sayGreeting
Hello! (file: hello.txt)</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we configure the <code>greet</code> task <code>destination</code> property as a closure/provider, which is evaluated with
the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method to turn the return value of the closure/provider into a <code>File</code> object at the last minute.
Note that we specify the <code>greetingFile</code> property value <em>after</em> the task configuration.
This lazy evaluation is a key benefit of accepting any value when setting a file property and then resolving that value when reading the property.</p>
</div>
<div class="paragraph">
<p>You can learn more about working with files lazily in <a href="#working_with_files">Working with Files</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="capturing_user_input_to_configure_plugin_runtime_behavior"><a class="anchor" href="#capturing_user_input_to_configure_plugin_runtime_behavior"></a><a class="link" href="#capturing_user_input_to_configure_plugin_runtime_behavior">Making a plugin configurable using extensions</a></h4>
<div class="paragraph">
<p>Most plugins offer configuration options for build scripts and other plugins to customize how the plugin works.
Plugins do this using <strong>extension objects</strong>.</p>
</div>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a> has an associated <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/plugins/ExtensionContainer.html">ExtensionContainer</a> object that contains all the settings and properties for the plugins that have been applied to the project.
You can provide configuration for your plugin by adding an extension object to this container.</p>
</div>
<div class="paragraph">
<p>An extension object is simply an object with Java Bean properties representing the configuration.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add a <code>greeting</code> extension object to the project, which allows you to configure the greeting:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
}

class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        // Add the 'greeting' extension object
        val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")
        // Add a task that uses configuration from the extension object
        project.task("hello") {
            doLast {
                println(extension.message.get())
            }
        }
    }
}

apply&lt;GreetingPlugin&gt;()

// Configure the extension
the&lt;GreetingPluginExtension&gt;().message = "Hi from Gradle"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
}

class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        // Add the 'greeting' extension object
        def extension = project.extensions.create('greeting', GreetingPluginExtension)
        // Add a task that uses configuration from the extension object
        project.task('hello') {
            doLast {
                println extension.message.get()
            }
        }
    }
}

apply plugin: GreetingPlugin

// Configure the extension
greeting.message = 'Hi from Gradle'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Hi from Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>GreetingPluginExtension</code> is an object with a property called <code>message</code>.
The extension object is added to the project with the name <code>greeting</code>.
This object becomes available as a project property with the same name as the extension object.
<code>the&lt;GreetingPluginExtension&gt;()</code> is equivalent to <code>project.extensions.getByType(GreetingPluginExtension::class.java)</code>.</p>
</div>
<div class="paragraph">
<p>Often, you have several related properties you need to specify on a single plugin.
Gradle adds a configuration block for each extension object, so you can group settings:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
    val greeter: Property&lt;String&gt;
}

class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")
        project.task("hello") {
            doLast {
                println("${extension.message.get()} from ${extension.greeter.get()}")
            }
        }
    }
}

apply&lt;GreetingPlugin&gt;()

// Configure the extension using a DSL block
configure&lt;GreetingPluginExtension&gt; {
    message = "Hi"
    greeter = "Gradle"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
    Property&lt;String&gt; getGreeter()
}

class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        def extension = project.extensions.create('greeting', GreetingPluginExtension)
        project.task('hello') {
            doLast {
                println "${extension.message.get()} from ${extension.greeter.get()}"
            }
        }
    }
}

apply plugin: GreetingPlugin

// Configure the extension using a DSL block
greeting {
    message = 'Hi'
    greeter = 'Gradle'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Hi from Gradle</pre>
</div>
</div>
<div class="paragraph multi-language-text lang-kotlin">
<p>In this example, several settings can be grouped within the <code>configure&lt;GreetingPluginExtension&gt;</code> block.
The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#configure-java.lang.Object-groovy.lang.Closure-"><code>configure</code></a> function is used to configure an extension object.
It provides a convenient way to set properties or apply configurations to these objects.
The type used in the build script&#8217;s <code>configure</code> function (<code>GreetingPluginExtension</code>) must match the extension type.
Then, when the block is executed, the receiver of the block is the extension.</p>
</div>
<div class="paragraph multi-language-text lang-groovy">
<p>In this example, several settings can be grouped within the <code>greeting</code> closure. The name of the closure block in the build script (<code>greeting</code>) must match the extension object name.
Then, when the closure is executed, the fields on the extension object will be mapped to the variables within the closure based on the standard Groovy closure delegate feature.</p>
</div>
</div>
<div class="sect3">
<h4 id="declaring_a_dsl_configuration_container"><a class="anchor" href="#declaring_a_dsl_configuration_container"></a><a class="link" href="#declaring_a_dsl_configuration_container">Declaring a DSL configuration container</a></h4>
<div class="paragraph">
<p>Using an extension object <em>extends</em> the Gradle DSL to add a project property and DSL block for the plugin.
Because an extension object is a regular object, you can provide your own DSL nested inside the plugin block by adding properties and methods to the extension object.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the following build script for illustration purposes.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.myorg.server-env")
}

environments {
    create("dev") {
        url = "http://localhost:8080"
    }

    create("staging") {
        url = "http://staging.enterprise.com"
    }

    create("production") {
        url = "http://prod.enterprise.com"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.myorg.server-env'
}

environments {
    dev {
        url = 'http://localhost:8080'
    }

    staging {
        url = 'http://staging.enterprise.com'
    }

    production {
        url = 'http://prod.enterprise.com'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The DSL exposed by the plugin exposes a container for defining a set of environments.
Each environment the user configures has an arbitrary but declarative name and is represented with its own DSL configuration block.
The example above instantiates a development, staging, and production environment, including its respective URL.</p>
</div>
<div class="paragraph">
<p>Each environment must have a data representation in code to capture the values.
The name of an environment is immutable and can be passed in as a constructor parameter.
Currently, the only other parameter the data object stores is a URL.</p>
</div>
<div class="paragraph">
<p>The following <code>ServerEnvironment</code> object fulfills those requirements:</p>
</div>
<div class="listingblock">
<div class="title">ServerEnvironment.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract public class ServerEnvironment {
    private final String name;

    @javax.inject.Inject
    public ServerEnvironment(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    abstract public Property&lt;String&gt; getUrl();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle exposes the factory method
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#domainObjectContainer-java.lang.Class-org.gradle.api.NamedDomainObjectFactory-">ObjectFactory.domainObjectContainer(Class, NamedDomainObjectFactory)</a>
to create a container of data objects.
The parameter the method takes is the class representing the data.
The created instance of type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/NamedDomainObjectContainer.html">NamedDomainObjectContainer</a> can be exposed to the end user by adding it to the extension container with a specific name.</p>
</div>
<div class="paragraph">
<p>It&#8217;s common for a plugin to post-process the captured values within the plugin implementation, e.g., to configure tasks:</p>
</div>
<div class="listingblock">
<div class="title">ServerEnvironmentPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ServerEnvironmentPlugin implements Plugin&lt;Project&gt; {
    @Override
    public void apply(final Project project) {
        ObjectFactory objects = project.getObjects();

        NamedDomainObjectContainer&lt;ServerEnvironment&gt; serverEnvironmentContainer =
            objects.domainObjectContainer(ServerEnvironment.class, name -&gt; objects.newInstance(ServerEnvironment.class, name));
        project.getExtensions().add("environments", serverEnvironmentContainer);

        serverEnvironmentContainer.all(serverEnvironment -&gt; {
            String env = serverEnvironment.getName();
            String capitalizedServerEnv = env.substring(0, 1).toUpperCase() + env.substring(1);
            String taskName = "deployTo" + capitalizedServerEnv;
            project.getTasks().register(taskName, Deploy.class, task -&gt; task.getUrl().set(serverEnvironment.getUrl()));
        });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, a deployment task is created dynamically for every user-configured environment.</p>
</div>
<div class="paragraph">
<p>You can find out more about implementing project extensions in <a href="#properties_and_providers">Developing Custom Gradle Types</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="modeling_dsl_like_apis"><a class="anchor" href="#modeling_dsl_like_apis"></a><a class="link" href="#modeling_dsl_like_apis">Modeling DSL-like APIs</a></h4>
<div class="paragraph">
<p>DSLs exposed by plugins should be readable and easy to understand.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s consider the following extension provided by a plugin.
In its current form, it offers a "flat" list of properties for configuring the creation of a website:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build-flat.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.myorg.site")
}

site {
    outputDir = layout.buildDirectory.file("mysite")
    websiteUrl = "https://gradle.org"
    vcsUrl = "https://github.com/gradle/gradle-site-plugin"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build-flat.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.myorg.site'
}

site {
    outputDir = layout.buildDirectory.file("mysite")
    websiteUrl = 'https://gradle.org'
    vcsUrl = 'https://github.com/gradle/gradle-site-plugin'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As the number of exposed properties grows, you should introduce a nested, more expressive structure.</p>
</div>
<div class="paragraph">
<p>The following code snippet adds a new configuration block named <code>siteInfo</code> as part of the extension.
This provides a stronger indication of what those properties mean:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.myorg.site")
}

site {
    outputDir = layout.buildDirectory.file("mysite")

    siteInfo {
        websiteUrl = "https://gradle.org"
        vcsUrl = "https://github.com/gradle/gradle-site-plugin"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.myorg.site'
}

site {
    outputDir = layout.buildDirectory.file("mysite")

    siteInfo {
        websiteUrl = 'https://gradle.org'
        vcsUrl = 'https://github.com/gradle/gradle-site-plugin'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Implementing the backing objects for such an extension is simple.
First, introduce a new data object for managing the properties <code>websiteUrl</code> and <code>vcsUrl</code>:</p>
</div>
<div class="listingblock">
<div class="title">SiteInfo.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract public class SiteInfo {

    abstract public Property&lt;String&gt; getWebsiteUrl();

    abstract public Property&lt;String&gt; getVcsUrl();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the extension, create an instance of the <code>siteInfo</code> class and a method to delegate the captured values to the data instance.</p>
</div>
<div class="paragraph">
<p>To configure underlying data objects, define a parameter of type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Action.html">Action</a>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates the use of <code>Action</code> in an extension definition:</p>
</div>
<div class="listingblock">
<div class="title">SiteExtension.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract public class SiteExtension {

    abstract public RegularFileProperty getOutputDir();

    @Nested
    abstract public SiteInfo getSiteInfo();

    public void siteInfo(Action&lt;? super SiteInfo&gt; action) {
        action.execute(getSiteInfo());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:mapping_extension_properties_to_task_properties_in_binary_plugins"><a class="anchor" href="#sec:mapping_extension_properties_to_task_properties_in_binary_plugins"></a><a class="link" href="#sec:mapping_extension_properties_to_task_properties_in_binary_plugins">Mapping extension properties to task properties</a></h4>
<div class="paragraph">
<p>Plugins commonly use an extension to capture user input from the build script and map it to a custom task&#8217;s input/output properties.
The build script author interacts with the extension&#8217;s DSL, while the plugin implementation handles the underlying logic:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Extension class to capture user input
class MyExtension {
    @Input
    var inputParameter: String? = null
}

// Custom task that uses the input from the extension
class MyCustomTask : org.gradle.api.DefaultTask() {
    @Input
    var inputParameter: String? = null

    @TaskAction
    fun executeTask() {
        println("Input parameter: $inputParameter")
    }
}

// Plugin class that configures the extension and task
class MyPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        // Create and configure the extension
        val extension = project.extensions.create("myExtension", MyExtension::class.java)
        // Create and configure the custom task
        project.tasks.register("myTask", MyCustomTask::class.java) {
            group = "custom"
            inputParameter = extension.inputParameter
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Extension class to capture user input
class MyExtension {
    @Input
    String inputParameter = null
}

// Custom task that uses the input from the extension
class MyCustomTask extends DefaultTask {
    @Input
    String inputParameter = null

    @TaskAction
    def executeTask() {
        println("Input parameter: $inputParameter")
    }
}

// Plugin class that configures the extension and task
class MyPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        // Create and configure the extension
        def extension = project.extensions.create("myExtension", MyExtension)
        // Create and configure the custom task
        project.tasks.register("myTask", MyCustomTask) {
            group = "custom"
            inputParameter = extension.inputParameter
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>MyExtension</code> class defines an <code>inputParameter</code> property that can be set in the build script.
The <code>MyPlugin</code> class configures this extension and uses its <code>inputParameter</code> value to configure the <code>MyCustomTask</code> task.
The <code>MyCustomTask</code> task then uses this input parameter in its logic.</p>
</div>
<div class="paragraph">
<p>You can learn more about types you can use in task implementations and extensions in <a href="#lazy_configuration">Lazy Configuration</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:plugin_conventions_in_binary_plugins"><a class="anchor" href="#sec:plugin_conventions_in_binary_plugins"></a><a class="link" href="#sec:plugin_conventions_in_binary_plugins">Adding default configuration with conventions</a></h4>
<div class="paragraph">
<p>Plugins should provide sensible defaults and standards in a specific context, reducing the number of decisions users need to make.
Using the <code>project</code> object, you can define default values.
These are known as <strong>conventions</strong>.</p>
</div>
<div class="paragraph">
<p>Conventions are properties that are initialized with default values and can be overridden by the user in their build script.
For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface GreetingPluginExtension {
    val message: Property&lt;String&gt;
}

class GreetingPlugin : Plugin&lt;Project&gt; {
    override fun apply(project: Project) {
        // Add the 'greeting' extension object
        val extension = project.extensions.create&lt;GreetingPluginExtension&gt;("greeting")
        extension.message.convention("Hello from GreetingPlugin")
        // Add a task that uses configuration from the extension object
        project.task("hello") {
            doLast {
                println(extension.message.get())
            }
        }
    }
}

apply&lt;GreetingPlugin&gt;()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface GreetingPluginExtension {
    Property&lt;String&gt; getMessage()
}

class GreetingPlugin implements Plugin&lt;Project&gt; {
    void apply(Project project) {
        // Add the 'greeting' extension object
        def extension = project.extensions.create('greeting', GreetingPluginExtension)
        extension.message.convention('Hello from GreetingPlugin')
        // Add a task that uses configuration from the extension object
        project.task('hello') {
            doLast {
                println extension.message.get()
            }
        }
    }
}

apply plugin: GreetingPlugin</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q hello
Hello from GreetingPlugin</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>GreetingPluginExtension</code> is a class that represents the convention.
The message property is the convention property with a default value of 'Hello from GreetingPlugin'.</p>
</div>
<div class="paragraph">
<p>Users can override this value in their build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">GreetingPluginExtension {
    message = "Custom message"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">GreetingPluginExtension {
    message = 'Custom message'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ gradle -q hello
Custom message</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="capabilities-vs-conventions"><a class="anchor" href="#capabilities-vs-conventions"></a><a class="link" href="#capabilities-vs-conventions">Separating capabilities from conventions</a></h4>
<div class="paragraph">
<p>Separating capabilities from conventions in plugins allows users to choose which tasks and conventions to apply.</p>
</div>
<div class="paragraph">
<p>For example, the Java Base plugin provides un-opinionated (i.e., generic) functionality like <code>SourceSets</code>, while the Java plugin adds tasks and conventions familiar to Java developers like <code>classes</code>, <code>jar</code> or <code>javadoc</code>.</p>
</div>
<div class="paragraph">
<p>When designing your own plugins, consider developing two plugins  one for capabilities and another for conventions  to offer flexibility to users.</p>
</div>
<div class="paragraph">
<p>In the example below, <code>MyPlugin</code> contains conventions, and <code>MyBasePlugin</code> defines capabilities.
Then, <code>MyPlugin</code> applies <code>MyBasePlugin</code>, this is called <em>plugin composition</em>.
To apply a plugin from another one:</p>
</div>
<div class="listingblock">
<div class="title">MyBasePlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Plugin;
import org.gradle.api.Project;

public class MyBasePlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        // define capabilities
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">MyPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Plugin;
import org.gradle.api.Project;

public class MyPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        project.getPluginManager().apply(MyBasePlugin.class);

        // define conventions
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="reacting_to_plugins"><a class="anchor" href="#reacting_to_plugins"></a><a class="link" href="#reacting_to_plugins">Reacting to plugins</a></h4>
<div class="paragraph">
<p>A common pattern in Gradle plugin implementations is configuring the runtime behavior of existing plugins and tasks in a build.</p>
</div>
<div class="paragraph">
<p>For example, a plugin could assume that it is applied to a Java-based project and automatically reconfigure the standard source directory:</p>
</div>
<div id="convention-api-usage-example" class="listingblock">
<div class="title">InhouseStrongOpinionConventionJavaPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class InhouseStrongOpinionConventionJavaPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        // Careful! Eagerly appyling plugins has downsides, and is not always recommended.
        project.getPluginManager().apply(JavaPlugin.class);
        SourceSetContainer sourceSets = project.getExtensions().getByType(SourceSetContainer.class);
        SourceSet main = sourceSets.getByName(SourceSet.MAIN_SOURCE_SET_NAME);
        main.getJava().setSrcDirs(Arrays.asList("src"));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The drawback to this approach is that it automatically forces the project to apply the Java plugin, imposing a strong opinion on it (i.e., reducing flexibility and generality).
In practice, the project applying the plugin might not even deal with Java code.</p>
</div>
<div class="paragraph">
<p>Instead of automatically applying the Java plugin, the plugin could react to the fact that the consuming project applies the Java plugin.
Only if that is the case, then a certain configuration is applied:</p>
</div>
<div class="listingblock">
<div class="title">InhouseConventionJavaPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class InhouseConventionJavaPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        project.getPluginManager().withPlugin("java", javaPlugin -&gt; {
            SourceSetContainer sourceSets = project.getExtensions().getByType(SourceSetContainer.class);
            SourceSet main = sourceSets.getByName(SourceSet.MAIN_SOURCE_SET_NAME);
            main.getJava().setSrcDirs(Arrays.asList("src"));
        });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reacting to plugins is preferred over applying plugins if there is no good reason to assume that the consuming project has the expected setup.</p>
</div>
<div class="paragraph">
<p>The same concept applies to task types:</p>
</div>
<div class="listingblock">
<div class="title">InhouseConventionWarPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class InhouseConventionWarPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        project.getTasks().withType(War.class).configureEach(war -&gt;
            war.setWebXml(project.file("src/someWeb.xml")));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="reacting_to_build_features"><a class="anchor" href="#reacting_to_build_features"></a><a class="link" href="#reacting_to_build_features">Reacting to build features</a></h4>
<div class="paragraph">
<p>Plugins can access the status of build features in the build.
The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeatures.html">Build Features API</a> allows checking whether the user requested a particular Gradle feature and if it is active in the current build.
An example of a build feature is the <a href="#config_cache">configuration cache</a>.</p>
</div>
<div class="paragraph">
<p>There are two main use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the status of build features in reports or statistics.</p>
</li>
<li>
<p>Incrementally adopting experimental Gradle features by disabling incompatible plugin functionality.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below is an example of a plugin that utilizes both of the cases.</p>
</div>
<div class="listingblock">
<div class="title">Reacting to build features</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class MyPlugin implements Plugin&lt;Project&gt; {

    @Inject
    protected abstract BuildFeatures getBuildFeatures(); // <b class="conum">(1)</b>

    @Override
    public void apply(Project p) {
        BuildFeatures buildFeatures = getBuildFeatures();

        Boolean configCacheRequested = buildFeatures.getConfigurationCache().getRequested() // <b class="conum">(2)</b>
            .getOrNull(); // could be null if user did not opt in nor opt out
        String configCacheUsage = describeFeatureUsage(configCacheRequested);
        MyReport myReport = new MyReport();
        myReport.setConfigurationCacheUsage(configCacheUsage);

        boolean isolatedProjectsActive = buildFeatures.getIsolatedProjects().getActive() // <b class="conum">(3)</b>
            .get(); // the active state is always defined
        if (!isolatedProjectsActive) {
            myOptionalPluginLogicIncompatibleWithIsolatedProjects();
        }
    }

    private String describeFeatureUsage(Boolean requested) {
        return requested == null ? "no preference" : requested ? "opt-in" : "opt-out";
    }

    private void myOptionalPluginLogicIncompatibleWithIsolatedProjects() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>BuildFeatures</code> service can be injected into plugins, tasks, and other managed types.</p>
</li>
<li>
<p>Accessing the <code>requested</code> status of a feature for reporting.</p>
</li>
<li>
<p>Using the <code>active</code> status of a feature to disable incompatible functionality.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="build_feature_properties"><a class="anchor" href="#build_feature_properties"></a><a class="link" href="#build_feature_properties">Build feature properties</a></h5>
<div class="paragraph">
<p>A <code>BuildFeature</code> status properties are represented with <code>Provider&lt;Boolean&gt;</code> types.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeature.html#getRequested--"><code>BuildFeature.getRequested()</code></a> status of a build feature determines if the user requested to enable or disable the feature.</p>
</div>
<div class="paragraph">
<p>When the <code>requested</code> provider value is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>true</code>&#8201;&#8212;&#8201;the user opted in for using the feature</p>
</li>
<li>
<p><code>false</code>&#8201;&#8212;&#8201;the user opted out from using the feature</p>
</li>
<li>
<p><code>undefined</code>&#8201;&#8212;&#8201;the user neither opted in nor opted out from using the feature</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeature.html#getActive--"><code>BuildFeature.getActive()</code></a> status of a build feature is always defined.
It represents the effective state of the feature in the build.</p>
</div>
<div class="paragraph">
<p>When the <code>active</code> provider value is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>true</code>&#8201;&#8212;&#8201;the feature <em>may</em> affect the build behavior in a way specific to the feature</p>
</li>
<li>
<p><code>false</code>&#8201;&#8212;&#8201;the feature will not affect the build behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the <code>active</code> status does not depend on the <code>requested</code> status.
Even if the user requests a feature, it may still not be active due to other build options being used in the build.
Gradle can also activate a feature by default, even if the user did not specify a preference.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom_dependencies_blocks"><a class="anchor" href="#custom_dependencies_blocks"></a><a class="link" href="#custom_dependencies_blocks">Using a custom <code>dependencies</code> block</a></h4>
<div class="paragraph">
<p>A plugin can provide dependency declarations in custom blocks that allow users to declare dependencies in a type-safe and context-aware way.</p>
</div>
<div class="paragraph">
<p>For instance, instead of users needing to know and use the underlying <code>Configuration</code> name to add dependencies, a custom <code>dependencies</code> block lets the plugin pick a meaningful name that
can be used consistently.</p>
</div>
<div class="sect4">
<h5 id="adding_a_custom_dependencies_block"><a class="anchor" href="#adding_a_custom_dependencies_block"></a><a class="link" href="#adding_a_custom_dependencies_block">Adding a custom <code>dependencies</code> block</a></h5>
<div class="paragraph">
<p>To add a custom <code>dependencies</code> block, you need to create a new <a href="#properties_and_providers">type</a> that will represent the set of dependency scopes available to users.
That new type needs to be accessible from a part of your plugin (from a domain object or extension).
Finally, the dependency scopes need to be wired back to underlying <code>Configuration</code> objects that will be used during dependency resolution.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.jvm.JvmComponentDependencies.html">JvmComponentDependencies</a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.jvm.JvmTestSuite.html">JvmTestSuite</a> for an example of how this is used in a Gradle core plugin.</p>
</div>
<div class="sect5">
<h6 id="1_create_an_interface_that_extends_dependencies"><a class="anchor" href="#1_create_an_interface_that_extends_dependencies"></a><a class="link" href="#1_create_an_interface_that_extends_dependencies">1. Create an interface that extends <code>Dependencies</code></a></h6>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also extend <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.GradleDependencies.html">GradleDependencies</a> to get access to Gradle-provided dependencies like <code>gradleApi()</code>.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">ExampleDependencies.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * Custom dependencies block for the example plugin.
 */
public interface ExampleDependencies extends Dependencies {</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="2_add_accessors_for_dependency_scopes"><a class="anchor" href="#2_add_accessors_for_dependency_scopes"></a><a class="link" href="#2_add_accessors_for_dependency_scopes">2. Add accessors for dependency scopes</a></h6>
<div class="paragraph">
<p>For each dependency scope your plugin wants to support, add a getter method that returns a <code>DependencyCollector</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">ExampleDependencies.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    /**
     * Dependency scope called "implementation"
     */
    DependencyCollector getImplementation();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="3_add_accessors_for_custom_dependencies_block"><a class="anchor" href="#3_add_accessors_for_custom_dependencies_block"></a><a class="link" href="#3_add_accessors_for_custom_dependencies_block">3. Add accessors for custom <code>dependencies</code> block</a></h6>
<div class="paragraph">
<p>To make the custom <code>dependencies</code> block configurable, the plugin needs to add a <code>getDependencies</code> method that returns the new type from above and a configurable block method named <code>dependencies</code>.</p>
</div>
<div class="paragraph">
<p>By convention, the accessors for your custom <code>dependencies</code> block should be called <code>getDependencies()</code>/<code>dependencies(Action)</code>.
This method could be named something else, but users would need to know that a different block can behave like a <code>dependencies</code> block.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">ExampleExtension.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    /**
     * Custom dependencies for this extension.
     */
    @Nested
    ExampleDependencies getDependencies();

    /**
     * Configurable block
     */
    default void dependencies(Action&lt;? super ExampleDependencies&gt; action) {
        action.execute(getDependencies());
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="4_wire_dependency_scope_to_configuration"><a class="anchor" href="#4_wire_dependency_scope_to_configuration"></a><a class="link" href="#4_wire_dependency_scope_to_configuration">4. Wire dependency scope to <code>Configuration</code></a></h6>
<div class="paragraph">
<p>Finally, the plugin needs to wire the custom <code>dependencies</code> block to some underlying <code>Configuration</code> objects. If this is not done, none of the dependencies declared in the custom block will
be available to dependency resolution.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">ExamplePlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        project.getConfigurations().dependencyScope("exampleImplementation", conf -&gt; {
            conf.fromDependencyCollector(example.getDependencies().getImplementation());
        });</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In this example, the name users will use to add dependencies is "implementation", but the underlying <code>Configuration</code> is named <code>exampleImplementation</code>.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">example {
    dependencies {
        implementation("junit:junit:4.13")
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">example {
    dependencies {
        implementation("junit:junit:4.13")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:differences_with_top_level_dependencies"><a class="anchor" href="#sec:differences_with_top_level_dependencies"></a><a class="link" href="#sec:differences_with_top_level_dependencies">Differences between the custom <code>dependencies</code> and the top-level <code>dependencies</code> blocks</a></h5>
<div class="paragraph">
<p>Each dependency scope returns a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyCollector.html"><code>DependencyCollector</code></a> that provides strongly-typed methods to add and configure dependencies.</p>
</div>
<div class="paragraph">
<p>There is also a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/DependencyFactory.html"><code>DependencyFactory</code></a> with factory methods to create new dependencies from different notations.
Dependencies can be created lazily using these factory methods, as shown below.</p>
</div>
<div class="paragraph">
<p>A custom <code>dependencies</code> block differs from the top-level <code>dependencies</code> block in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dependencies must be declared using a <code>String</code>, an instance of <code>Dependency</code>, a <code>FileCollection</code>, a <code>Provider</code> of <code>Dependency</code>, or a <code>ProviderConvertible</code> of <code>MinimalExternalModuleDependency</code>.</p>
</li>
<li>
<p>Outside of Gradle build scripts, you must explicitly call a getter for the <code>DependencyCollector</code> and <code>add</code>.</p>
<div class="ulist">
<ul>
<li>
<p><code>dependencies.add("implementation", x)</code> becomes <code>getImplementation().add(x)</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>You cannot add a dependency with an instance of <code>Project</code>. You must turn it into a <code>ProjectDependency</code> first.</p>
</li>
<li>
<p>You cannot add version catalog bundles directly.
Instead, use the <code>bundle</code> method on each configuration.</p>
<div class="ulist">
<ul>
<li>
<p>Kotlin and Groovy: <code>implementation(libs.bundles.testing)</code> becomes <code>implementation.bundle(libs.bundles.testing)</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>You cannot use providers for non-<code>Dependency</code> types directly.
Instead, map them to a <code>Dependency</code> using the <code>DependencyFactory</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Kotlin and Groovy: <code>implementation(myStringProvider)</code> becomes <code>implementation(myStringProvider.map { dependencyFactory.create(it) })</code></p>
</li>
<li>
<p>Java: <code>implementation(myStringProvider)</code> becomes <code>getImplementation().add(myStringProvider.map(getDependencyFactory()::create)</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Unlike the top-level <code>dependencies</code> block, constraints are not in a separate block.</p>
<div class="ulist">
<ul>
<li>
<p>Instead, constraints are added by decorating a dependency with <code>constraint(&#8230;&#8203;)</code> like <code>implementation(constraint("org:foo:1.0"))</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Keep in mind that the <code>dependencies</code> block may not provide access to the same methods as the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html">top-level <code>dependencies</code> block</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Plugins should prefer adding dependencies via their own <code>dependencies</code> block.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="providing_default_dependencies"><a class="anchor" href="#providing_default_dependencies"></a><a class="link" href="#providing_default_dependencies">Providing default dependencies</a></h4>
<div class="paragraph">
<p>The implementation of a plugin sometimes requires the use of an external dependency.</p>
</div>
<div class="paragraph">
<p>You might want to automatically download an artifact using Gradles dependency management mechanism and later use it in the action of a task type declared in the plugin.
Ideally, the plugin implementation does not need to ask the user for the coordinates of that dependency - it can simply predefine a sensible default version.</p>
</div>
<div class="paragraph">
<p>Lets look at an example of a plugin that downloads files containing data for further processing.
The plugin implementation declares a custom configuration that allows for <a href="declaring_dependencies.html#one-declaring-dependencies">assigning those external dependencies with dependency coordinates</a>:</p>
</div>
<div class="listingblock">
<div class="title">DataProcessingPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class DataProcessingPlugin implements Plugin&lt;Project&gt; {
    public void apply(Project project) {
        Configuration dataFiles = project.getConfigurations().create("dataFiles", c -&gt; {
            c.setVisible(false);
            c.setCanBeConsumed(false);
            c.setCanBeResolved(true);
            c.setDescription("The data artifacts to be processed for this plugin.");
            c.defaultDependencies(d -&gt; d.add(project.getDependencies().create("org.myorg:data:1.4.6")));
        });

        project.getTasks().withType(DataProcessing.class).configureEach(
            dataProcessing -&gt; dataProcessing.getDataFiles().from(dataFiles));
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataProcessing.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract public class DataProcessing extends DefaultTask {

    @InputFiles
    abstract public ConfigurableFileCollection getDataFiles();

    @TaskAction
    public void process() {
        System.out.println(getDataFiles().getFiles());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This approach is convenient for the end user as there is no need to actively declare a dependency.
The plugin already provides all the details about this implementation.</p>
</div>
<div class="paragraph">
<p>But what if the user wants to redefine the default dependency?</p>
</div>
<div class="paragraph">
<p>No problem.
The plugin also exposes the custom configuration that can be used to assign a different dependency.
Effectively, the default dependency is overwritten:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.myorg.data-processing")
}

dependencies {
    dataFiles("org.myorg:more-data:2.6")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.myorg.data-processing'
}

dependencies {
    dataFiles 'org.myorg:more-data:2.6'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You will find that this pattern works well for tasks that require an external dependency when the task&#8217;s action is executed.
You can go further and abstract the version to be used for the external dependency by exposing an extension property (e.g.
<code>toolVersion</code> in <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.testing.jacoco.plugins.JacocoPluginExtension.html">the JaCoCo plugin</a>).</p>
</div>
<div class="sect4">
<h5 id="minimizing_the_use_of_external_libraries"><a class="anchor" href="#minimizing_the_use_of_external_libraries"></a><a class="link" href="#minimizing_the_use_of_external_libraries">Minimizing the use of external libraries</a></h5>
<div class="paragraph">
<p>Using external libraries in your Gradle projects can bring great convenience, but be aware that they can introduce complex dependency graphs.
Gradle&#8217;s <code>buildEnvironment</code> task can help you visualize these dependencies, including those of your plugins.
Keep in mind that plugins share the same classloader, so conflicts may arise with different versions of the same library.</p>
</div>
<div class="paragraph">
<p>To demonstrate lets assume the following build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.asciidoctor.jvm.convert") version "4.0.2"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.asciidoctor.jvm.convert' version '4.0.2'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The output of the task clearly indicates the classpath of the <code>classpath</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle buildEnvironment

&gt; Task :buildEnvironment

------------------------------------------------------------
Root project 'external-libraries'
------------------------------------------------------------

classpath
\--- org.asciidoctor.jvm.convert:org.asciidoctor.jvm.convert.gradle.plugin:4.0.2
     \--- org.asciidoctor:asciidoctor-gradle-jvm:4.0.2
          +--- org.ysb33r.gradle:grolifant-rawhide:3.0.0
          |    \--- org.tukaani:xz:1.6
          +--- org.ysb33r.gradle:grolifant-herd:3.0.0
          |    +--- org.tukaani:xz:1.6
          |    +--- org.ysb33r.gradle:grolifant40:3.0.0
          |    |    +--- org.tukaani:xz:1.6
          |    |    +--- org.apache.commons:commons-collections4:4.4
          |    |    +--- org.ysb33r.gradle:grolifant-core:3.0.0
          |    |    |    +--- org.tukaani:xz:1.6
          |    |    |    +--- org.apache.commons:commons-collections4:4.4
          |    |    |    \--- org.ysb33r.gradle:grolifant-rawhide:3.0.0 (*)
          |    |    \--- org.ysb33r.gradle:grolifant-rawhide:3.0.0 (*)
          |    +--- org.ysb33r.gradle:grolifant50:3.0.0
          |    |    +--- org.tukaani:xz:1.6
          |    |    +--- org.ysb33r.gradle:grolifant40:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    |    \--- org.ysb33r.gradle:grolifant40-legacy-api:3.0.0
          |    |         +--- org.tukaani:xz:1.6
          |    |         +--- org.apache.commons:commons-collections4:4.4
          |    |         +--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    |         \--- org.ysb33r.gradle:grolifant40:3.0.0 (*)
          |    +--- org.ysb33r.gradle:grolifant60:3.0.0
          |    |    +--- org.tukaani:xz:1.6
          |    |    +--- org.ysb33r.gradle:grolifant40:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant50:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    |    \--- org.ysb33r.gradle:grolifant-rawhide:3.0.0 (*)
          |    +--- org.ysb33r.gradle:grolifant70:3.0.0
          |    |    +--- org.tukaani:xz:1.6
          |    |    +--- org.ysb33r.gradle:grolifant40:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant50:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant60:3.0.0 (*)
          |    |    \--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    +--- org.ysb33r.gradle:grolifant80:3.0.0
          |    |    +--- org.tukaani:xz:1.6
          |    |    +--- org.ysb33r.gradle:grolifant40:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant50:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant60:3.0.0 (*)
          |    |    +--- org.ysb33r.gradle:grolifant70:3.0.0 (*)
          |    |    \--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    +--- org.ysb33r.gradle:grolifant-core:3.0.0 (*)
          |    \--- org.ysb33r.gradle:grolifant-rawhide:3.0.0 (*)
          +--- org.asciidoctor:asciidoctor-gradle-base:4.0.2
          |    \--- org.ysb33r.gradle:grolifant-herd:3.0.0 (*)
          \--- org.asciidoctor:asciidoctorj-api:2.5.7

(*) - Indicates repeated occurrences of a transitive dependency subtree. Gradle expands transitive dependency subtrees only once per project; repeat occurrences only display the root of the subtree, followed by this annotation.

A web-based, searchable dependency report is available by adding the --scan option.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>A Gradle plugin does not run in its own, isolated classloader, so you must consider whether you truly need a library or if a simpler solution suffices.</p>
</div>
<div class="paragraph">
<p>For logic that is executed as part of task execution, use the <a href="#tasks_parallel_worker">Worker API</a> that allows you to isolate libraries.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="plugin-with-variants"><a class="anchor" href="#plugin-with-variants"></a><a class="link" href="#plugin-with-variants">Providing multiple variants of a plugin</a></h4>
<div class="paragraph">
<p>Variants of a plugin refer to different flavors or configurations of the plugin that are tailored to specific needs or use cases.
These variants can include different implementations, extensions, or configurations of the base plugin.</p>
</div>
<div class="paragraph">
<p>The most convenient way to configure additional plugin variants is to use <a href="how_to_create_feature_variants_of_a_library.html#feature_variants">feature variants</a>, a concept available in all Gradle projects that apply one of the Java plugins:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation 'com.google.guava:guava:30.1-jre'        // Regular dependency
    featureVariant 'com.google.guava:guava-gwt:30.1-jre'    // Feature variant dependency
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following example, each plugin variant is developed in isolation.
A separate source set is compiled and packaged in a separate jar for each variant.</p>
</div>
<div class="paragraph">
<p>The following sample demonstrates how to add a variant that is compatible with Gradle 7.0+ while the "main" variant is compatible with older versions:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val gradle7 = sourceSets.create("gradle7")

java {
    registerFeature(gradle7.name) {
        usingSourceSet(gradle7)
        capability(project.group.toString(), project.name, project.version.toString()) // <b class="conum">(1)</b>
    }
}

configurations.configureEach {
    if (isCanBeConsumed &amp;&amp; name.startsWith(gradle7.name))  {
        attributes {
            attribute(GradlePluginApiVersion.GRADLE_PLUGIN_API_VERSION_ATTRIBUTE, // <b class="conum">(2)</b>
                objects.named("7.0"))
        }
    }
}

tasks.named&lt;Copy&gt;(gradle7.processResourcesTaskName) { // <b class="conum">(3)</b>
    val copyPluginDescriptors = rootSpec.addChild()
    copyPluginDescriptors.into("META-INF/gradle-plugins")
    copyPluginDescriptors.from(tasks.pluginDescriptors)
}

dependencies {
    "gradle7CompileOnly"(gradleApi()) // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def gradle7 = sourceSets.create('gradle7')

java {
    registerFeature(gradle7.name) {
        usingSourceSet(gradle7)
        capability(project.group.toString(), project.name, project.version.toString()) // <b class="conum">(1)</b>
    }
}

configurations.configureEach {
    if (canBeConsumed &amp;&amp; name.startsWith(gradle7.name))  {
        attributes {
            attribute(GradlePluginApiVersion.GRADLE_PLUGIN_API_VERSION_ATTRIBUTE, // <b class="conum">(2)</b>
                      objects.named(GradlePluginApiVersion, '7.0'))
        }
    }
}

tasks.named(gradle7.processResourcesTaskName) { // <b class="conum">(3)</b>
    def copyPluginDescriptors = rootSpec.addChild()
    copyPluginDescriptors.into('META-INF/gradle-plugins')
    copyPluginDescriptors.from(tasks.pluginDescriptors)
}

dependencies {
    gradle7CompileOnly(gradleApi()) // <b class="conum">(4)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Only Gradle versions 7 or higher can be explicitly targeted by a variant, as support for this was only added in Gradle 7.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First, we declare a separate <em>source set</em> and a <em>feature variant</em> for our Gradle 7 plugin variant.
Then, we do some specific wiring to turn the feature into a proper Gradle plugin variant:</p>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Assign the <a href="#sec:declaring-component-capabilities">implicit capability that corresponds to the components GAV</a> to the variant.</p>
</li>
<li>
<p>Assign the <a href="#sec:gradle-plugins-default-attributes">Gradle API version attribute</a> to all <a href="#sec:resolvable-consumable-configs">consumable configurations</a> of our Gradle7 variant. Gradle uses this information to determine which variant to select during plugin resolution.</p>
</li>
<li>
<p>Configure the <code>processGradle7Resources</code> task to ensure the plugin descriptor file is added to the Gradle7 variant Jar.</p>
</li>
<li>
<p>Add a dependency to the <code>gradleApi()</code> for our new variant so that the API is visible during compilation time.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that there is currently no convenient way to access the API of other Gradle versions as the one you are building the plugin with.
Ideally, every variant should be able to declare a dependency on the API of the minimal Gradle version it supports.
This will be improved in the future.</p>
</div>
<div class="paragraph">
<p>The above snippet assumes that all variants of your plugin have the plugin class at the same location.
That is, if your plugin class is <code>org.example.GreetingPlugin</code>, you need to create a second variant of that class in <code>src/gradle7/java/org/example</code>.</p>
</div>
<div class="sect4">
<h5 id="using_version_specific_variants_of_multi_variant_plugins"><a class="anchor" href="#using_version_specific_variants_of_multi_variant_plugins"></a><a class="link" href="#using_version_specific_variants_of_multi_variant_plugins">Using version-specific variants of multi-variant plugins</a></h5>
<div class="paragraph">
<p>Given a dependency on a multi-variant plugin, Gradle will automatically choose its variant that best matches the current Gradle version when it resolves any of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plugins specified in the <a href="plugins_intermediate.html#sec:plugins_block"><code>plugins {}</code> block</a>;</p>
</li>
<li>
<p><code>buildscript</code> classpath dependencies;</p>
</li>
<li>
<p>dependencies in the root project of the <a href="#sec:using_buildsrc">build source (<code>buildSrc</code>)</a> that appear on the compile or runtime classpath;</p>
</li>
<li>
<p>dependencies in a project that applies the <a href="java_gradle_plugin.html#java_gradle_plugin">Java Gradle Plugin Development plugin</a> or the <a href="#sec:kotlin-dsl_plugin">Kotlin DSL plugin</a>, appearing on the compile or runtime classpath.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The best matching variant is the variant that targets the highest Gradle API version and does not exceed the current build&#8217;s Gradle version.</p>
</div>
<div class="paragraph">
<p>In all other cases, a plugin variant that does not specify the supported Gradle API version is preferred if such a variant is present.</p>
</div>
<div class="paragraph">
<p>In projects that use plugins as dependencies, requesting the variants of plugin dependencies that support a different Gradle version is possible.
This allows a multi-variant plugin that depends on other plugins to access their APIs, which are exclusively provided in their version-specific variants.</p>
</div>
<div class="paragraph">
<p>This snippet makes the <a href="#plugin-with-variants">plugin variant <code>gradle7</code> defined above</a> consume the matching variants of its dependencies on other multi-variant plugins:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.configureEach {
    if (isCanBeResolved &amp;&amp; name.startsWith(gradle7.name))  {
        attributes {
            attribute(GradlePluginApiVersion.GRADLE_PLUGIN_API_VERSION_ATTRIBUTE,
                objects.named("7.0"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.configureEach {
    if (canBeResolved &amp;&amp; name.startsWith(gradle7.name))  {
        attributes {
            attribute(GradlePluginApiVersion.GRADLE_PLUGIN_API_VERSION_ATTRIBUTE,
                objects.named(GradlePluginApiVersion, '7.0'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="testing_gradle_plugins"><a class="anchor" href="#testing_gradle_plugins"></a><a class="link" href="#testing_gradle_plugins">Testing Gradle plugins</a></h3>
<div class="paragraph">
<p>Testing plays a crucial role in the development process by ensuring reliable and high-quality software.
This principle applies to build code, including Gradle plugins.</p>
</div>
<div class="sect3">
<h4 id="the_sample_project"><a class="anchor" href="#the_sample_project"></a><a class="link" href="#the_sample_project">The sample project</a></h4>
<div class="paragraph">
<p>This section revolves around a sample project called the "URL verifier plugin".
This plugin creates a task named <code>verifyUrl</code> that checks whether a given URL can be resolved via HTTP GET.
The end user can provide the URL via an extension named <code>verification</code>.</p>
</div>
<div class="paragraph">
<p>The following build script assumes that the plugin JAR file has been published to a binary repository.
The script demonstrates how to apply the plugin to the project and configure its exposed extension:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.myorg.url-verifier")        // <b class="conum">(1)</b>
}

verification {
    url = "https://www.google.com/"  // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.myorg.url-verifier'         // <b class="conum">(1)</b>
}

verification {
    url = 'https://www.google.com/'     // <b class="conum">(2)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Applies the plugin to the project</p>
</li>
<li>
<p>Configures the URL to be verified through the exposed extension</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Executing the <code>verifyUrl</code> task renders a success message if the HTTP GET call to the configured URL returns with a 200 response code:</p>
</div>
<div id="verify-url-cmd-output" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">$ gradle verifyUrl

&gt; Task :verifyUrl
Successfully resolved URL 'https://www.google.com/'

BUILD SUCCESSFUL in 0s
5 actionable tasks: 5 executed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before diving into the code, let&#8217;s first revisit the different types of tests and the tooling that supports implementing them.</p>
</div>
</div>
<div class="sect3">
<h4 id="the_importance_of_testing"><a class="anchor" href="#the_importance_of_testing"></a><a class="link" href="#the_importance_of_testing">The importance of testing</a></h4>
<div class="paragraph">
<p>Testing is a crucial part of the software development life cycle, ensuring that software functions correctly and meets quality standards before release.
Automated testing allows developers to refactor and improve code with confidence.</p>
</div>
<div class="sect4">
<h5 id="testing-pyramid"><a class="anchor" href="#testing-pyramid"></a><a class="link" href="#testing-pyramid">The testing pyramid</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">Manual Testing </dt>
<dd>
<p>While manual testing is straightforward, it is error-prone and requires human effort. For Gradle plugins, manual testing involves using the plugin in a build script.</p>
</dd>
<dt class="hdlist1">Automated Testing </dt>
<dd>
<p>Automated testing includes unit, integration, and functional testing.</p>
</dd>
</dl>
</div>
<div class="imageblock right">
<div class="content">
<img src="img/testing-pyramid.png" alt="testing pyramid">
</div>
</div>
<div class="paragraph">
<p>The testing pyramid introduced by Mike Cohen in his book <a href="https://www.mountaingoatsoftware.com/books/succeeding-with-agile-software-development-using-scrum">Succeeding with Agile: Software Development Using Scrum</a> describes three types of automated tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Unit Testing:</strong> Verifies the smallest units of code, typically methods, in isolation. It uses Stubs or Mocks to isolate code from external dependencies.</p>
</li>
<li>
<p><strong>Integration Testing:</strong> Validates that multiple units or components work together.</p>
</li>
<li>
<p><strong>Functional Testing:</strong> Tests the system from the end user&#8217;s perspective, ensuring correct functionality. End-to-end tests for Gradle plugins simulate a build, apply the plugin, and execute specific tasks to verify functionality.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="tooling_support"><a class="anchor" href="#tooling_support"></a><a class="link" href="#tooling_support">Tooling support</a></h5>
<div class="paragraph">
<p>Testing Gradle plugins, both manually and automatically, is simplified with the appropriate tools.
The table below provides a summary of each testing approach.
You can choose any test framework you&#8217;re comfortable with.</p>
</div>
<div class="paragraph">
<p>For detailed explanations and code examples, refer to the specific sections below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test type</th>
<th class="tableblock halign-left valign-top">Tooling support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#manual-tests">Manual tests</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#composite_builds">Gradle composite builds</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#unit-tests">Unit tests</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any JVM-based test framework</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#integration-tests">Integration tests</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any JVM-based test framework</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#functional-tests">Functional tests</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any JVM-based test framework and <a href="#test_kit">Gradle TestKit</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="manual-tests"><a class="anchor" href="#manual-tests"></a><a class="link" href="#manual-tests">Setting up manual tests</a></h4>
<div class="paragraph">
<p>The <a href="#composite_builds">composite builds</a> feature of Gradle makes it easy to test a plugin manually.
The standalone plugin project and the consuming project can be combined into a single unit, making it straightforward to try out or debug changes without re-publishing the binary file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 include-plugin-build   // <b class="conum">(1)</b>
    build.gradle
    settings.gradle
 url-verifier-plugin    // <b class="conum">(2)</b>
     build.gradle
     settings.gradle
     src</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Consuming project that includes the plugin project</p>
</li>
<li>
<p>The plugin project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are two ways to include a plugin project in a consuming project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By using the command line option <code>--include-build</code>.</p>
</li>
<li>
<p>By using the method <code>includeBuild</code> in <code>settings.gradle</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following code snippet demonstrates the use of the settings file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">pluginManagement {
    includeBuild("../url-verifier-plugin")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">pluginManagement {
    includeBuild '../url-verifier-plugin'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The command line output of the <code>verifyUrl</code> task from the project <code>include-plugin-build</code> <a href="#verify-url-cmd-output">looks exactly the same as shown in the introduction</a>, except that it now executes as part of a composite build.</p>
</div>
<div class="paragraph">
<p>Manual testing has its place in the development process, but it is not a replacement for automated testing.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting_up_automated_tests"><a class="anchor" href="#setting_up_automated_tests"></a><a class="link" href="#setting_up_automated_tests">Setting up automated tests</a></h4>
<div class="paragraph">
<p>Setting up a suite of tests early on is crucial to the success of your plugin.
Automated tests become an invaluable safety net when upgrading the plugin to a new Gradle version or enhancing/refactoring the code.</p>
</div>
<div class="sect4">
<h5 id="organizing_test_source_code"><a class="anchor" href="#organizing_test_source_code"></a><a class="link" href="#organizing_test_source_code">Organizing test source code</a></h5>
<div class="paragraph">
<p>We recommend implementing a good distribution of unit, integration, and functional tests to cover the most important use cases.
Separating the source code for each test type automatically results in a project that is more maintainable and manageable.</p>
</div>
<div class="paragraph">
<p>By default, the Java project creates a convention for organizing unit tests in the directory <code>src/test/java</code>.
Additionally, if you apply the Groovy plugin, source code under the directory <code>src/test/groovy</code> is considered for compilation (with the same standard for Kotlin under the directory <code>src/test/kotlin</code>).
Consequently, source code directories for other test types should follow a similar pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 src
     functionalTest
        groovy      // <b class="conum">(1)</b>
     integrationTest
        groovy      // <b class="conum">(2)</b>
     main
        java        // <b class="conum">(3)</b>
     test
         groovy      // <b class="conum">(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Source directory containing functional tests</p>
</li>
<li>
<p>Source directory containing integration tests</p>
</li>
<li>
<p>Source directory containing production source code</p>
</li>
<li>
<p>Source directory containing unit tests</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The directories <code>src/integrationTest/groovy</code> and <code>src/functionalTest/groovy</code> are not based on an existing standard convention for Gradle projects.
You are free to choose any project layout that works best for you.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can configure the source directories for compilation and test execution.</p>
</div>
<div class="paragraph">
<p>The <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">Test Suite plugin</a> provides a DSL and API to model multiple groups of automated tests into test suites in JVM-based projects.
You can also rely on third-party plugins for convenience, such as the <a href="https://github.com/nebula-plugins/nebula-project-plugin#nebula-facet-plugin">Nebula Facet plugin</a> or the <a href="https://github.com/unbroken-dome/gradle-testsets-plugin">TestSets plugin</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="modeling_test_types"><a class="anchor" href="#modeling_test_types"></a><a class="link" href="#modeling_test_types">Modeling test types</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A new configuration DSL for modeling the below <code>integrationTest</code> suite is available via the incubating <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In Gradle, source code directories are represented using the concept of <a href="java_plugin.html#source_sets">source sets</a>.
A source set is configured to point to one or more directories containing source code.
When you define a source set, Gradle automatically sets up compilation tasks for the specified directories.</p>
</div>
<div class="paragraph">
<p>A pre-configured source set can be created with one line of build script code.
The source set automatically registers configurations to define dependencies for the sources of the source set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Define a source set named 'test' for test sources
sourceSets {
    test {
        java {
            srcDirs = ['src/test/java']
        }
    }
}
// Specify a test implementation dependency on JUnit
dependencies {
    testImplementation 'junit:junit:4.12'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use that to define an <code>integrationTestImplementation</code> dependency to the project itself, which represents the "main" variant of our project (i.e., the compiled plugin code):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val integrationTest by sourceSets.creating

dependencies {
    "integrationTestImplementation"(project)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def integrationTest = sourceSets.create("integrationTest")

dependencies {
    integrationTestImplementation(project)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Source sets are responsible for compiling source code, but they do not deal with executing the bytecode.
For test execution, a corresponding task of type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/Test.html">Test</a> needs to be established.
The following setup shows the execution of integration tests, referencing the classes and runtime classpath of the integration test source set:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val integrationTestTask = tasks.register&lt;Test&gt;("integrationTest") {
    description = "Runs the integration tests."
    group = "verification"
    testClassesDirs = integrationTest.output.classesDirs
    classpath = integrationTest.runtimeClasspath
    mustRunAfter(tasks.test)
}
tasks.check {
    dependsOn(integrationTestTask)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def integrationTestTask = tasks.register("integrationTest", Test) {
    description = 'Runs the integration tests.'
    group = "verification"
    testClassesDirs = integrationTest.output.classesDirs
    classpath = integrationTest.runtimeClasspath
    mustRunAfter(tasks.named('test'))
}
tasks.named('check') {
    dependsOn(integrationTestTask)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configuring_a_test_framework"><a class="anchor" href="#configuring_a_test_framework"></a><a class="link" href="#configuring_a_test_framework">Configuring a test framework</a></h5>
<div class="paragraph">
<p>Gradle does not dictate the use of a specific test framework. Popular choices include <a href="https://junit.org/">JUnit</a>, <a href="https://testng.org/">TestNG</a> and <a href="http://spockframework.org/">Spock</a>.
Once you choose an option, you have to add its dependency to the compile classpath for your tests.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how to use Spock for implementing tests:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    testImplementation(platform("org.spockframework:spock-bom:2.3-groovy-4.0"))
    testImplementation("org.spockframework:spock-core")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")

    "integrationTestImplementation"(platform("org.spockframework:spock-bom:2.3-groovy-4.0"))
    "integrationTestImplementation"("org.spockframework:spock-core")
    "integrationTestRuntimeOnly"("org.junit.platform:junit-platform-launcher")

    "functionalTestImplementation"(platform("org.spockframework:spock-bom:2.3-groovy-4.0"))
    "functionalTestImplementation"("org.spockframework:spock-core")
    "functionalTestRuntimeOnly"("org.junit.platform:junit-platform-launcher")
}

tasks.withType&lt;Test&gt;().configureEach {
    // Using JUnitPlatform for running tests
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    testImplementation platform("org.spockframework:spock-bom:2.3-groovy-4.0")
    testImplementation 'org.spockframework:spock-core'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

    integrationTestImplementation platform("org.spockframework:spock-bom:2.3-groovy-4.0")
    integrationTestImplementation 'org.spockframework:spock-core'
    integrationTestRuntimeOnly 'org.junit.platform:junit-platform-launcher'

    functionalTestImplementation platform("org.spockframework:spock-bom:2.3-groovy-4.0")
    functionalTestImplementation 'org.spockframework:spock-core'
    functionalTestRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

tasks.withType(Test).configureEach {
    // Using JUnitPlatform for running tests
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Spock is a Groovy-based BDD test framework that even includes APIs for creating Stubs and Mocks.
The Gradle team prefers Spock over other options for its expressiveness and conciseness.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="implementing_automated_tests"><a class="anchor" href="#implementing_automated_tests"></a><a class="link" href="#implementing_automated_tests">Implementing automated tests</a></h4>
<div class="paragraph">
<p>This section discusses representative implementation examples for unit, integration, and functional tests.
All test classes are based on the use of Spock, though it should be relatively easy to adapt the code to a different test framework.</p>
</div>
<div class="sect4">
<h5 id="unit-tests"><a class="anchor" href="#unit-tests"></a><a class="link" href="#unit-tests">Implementing unit tests</a></h5>
<div class="paragraph">
<p>The URL verifier plugin emits HTTP GET calls to check if a URL can be resolved successfully.
The method <code>DefaultHttpCaller.get(String)</code> is responsible for calling a given URL and returns an instance of type <code>HttpResponse</code>. <code>HttpResponse</code> is a POJO containing information about the HTTP response code and message:</p>
</div>
<div class="listingblock">
<div class="title">HttpResponse.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.myorg.http;

public class HttpResponse {
    private int code;
    private String message;

    public HttpResponse(int code, String message) {
        this.code = code;
        this.message = message;
    }

    public int getCode() {
        return code;
    }

    public String getMessage() {
        return message;
    }

    @Override
    public String toString() {
        return "HTTP " + code + ", Reason: " + message;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>HttpResponse</code> represents a good candidate for a unit test.
It does not reach out to any other classes nor does it use the Gradle API.</p>
</div>
<div class="listingblock">
<div class="title">HttpResponseTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">package org.myorg.http

import spock.lang.Specification

class HttpResponseTest extends Specification {

    private static final int OK_HTTP_CODE = 200
    private static final String OK_HTTP_MESSAGE = 'OK'

    def "can access information"() {
        when:
        def httpResponse = new HttpResponse(OK_HTTP_CODE, OK_HTTP_MESSAGE)

        then:
        httpResponse.code == OK_HTTP_CODE
        httpResponse.message == OK_HTTP_MESSAGE
    }

    def "can get String representation"() {
        when:
        def httpResponse = new HttpResponse(OK_HTTP_CODE, OK_HTTP_MESSAGE)

        then:
        httpResponse.toString() == "HTTP $OK_HTTP_CODE, Reason: $OK_HTTP_MESSAGE"
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When writing unit tests, it&#8217;s important to test boundary conditions and various forms of invalid input.
Try to extract as much logic as possible from classes that use the Gradle API to make it testable as unit tests.
It will result in maintainable code and faster test execution.
</td>
</tr>
</table>
</div>
<div id="sec:writing_tests_for_your_plugin" class="paragraph">
<p>You can use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testfixtures/ProjectBuilder.html">ProjectBuilder</a> class to create <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html">Project</a> instances to use when you test your plugin implementation.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="title">src/test/java/org/example/GreetingPluginTest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GreetingPluginTest {
    @Test
    public void greeterPluginAddsGreetingTaskToProject() {
        Project project = ProjectBuilder.builder().build();
        project.getPluginManager().apply("org.example.greeting");

        assertTrue(project.getTasks().getByName("hello") instanceof GreetingTask);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="integration-tests"><a class="anchor" href="#integration-tests"></a><a class="link" href="#integration-tests">Implementing integration tests</a></h5>
<div class="paragraph">
<p>Let&#8217;s look at a class that reaches out to another system, the piece of code that emits the HTTP calls.
At the time of executing a test for the class <code>DefaultHttpCaller</code>, the runtime environment needs to be able to reach out to the internet:</p>
</div>
<div class="listingblock">
<div class="title">DefaultHttpCaller.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.myorg.http;

import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URI;
import java.net.URISyntaxException;

public class DefaultHttpCaller implements HttpCaller {
    @Override
    public HttpResponse get(String url) {
        try {
            HttpURLConnection connection = (HttpURLConnection) new URI(url).toURL().openConnection();
            connection.setConnectTimeout(5000);
            connection.setRequestMethod("GET");
            connection.connect();

            int code = connection.getResponseCode();
            String message = connection.getResponseMessage();
            return new HttpResponse(code, message);
        } catch (IOException e) {
            throw new HttpCallException(String.format("Failed to call URL '%s' via HTTP GET", url), e);
        } catch (URISyntaxException e) {
            throw new RuntimeException(e);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implementing an integration test for <code>DefaultHttpCaller</code> doesn&#8217;t look much different from the unit test shown in the previous section:</p>
</div>
<div class="listingblock">
<div class="title">DefaultHttpCallerIntegrationTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">package org.myorg.http

import spock.lang.Specification
import spock.lang.Subject

class DefaultHttpCallerIntegrationTest extends Specification {
    @Subject HttpCaller httpCaller = new DefaultHttpCaller()

    def "can make successful HTTP GET call"() {
        when:
        def httpResponse = httpCaller.get('https://www.google.com/')

        then:
        httpResponse.code == 200
        httpResponse.message == 'OK'
    }

    def "throws exception when calling unknown host via HTTP GET"() {
        when:
        httpCaller.get('https://www.example.invalid/')

        then:
        def t = thrown(HttpCallException)
        t.message == "Failed to call URL 'https://www.example.invalid/' via HTTP GET"
        t.cause instanceof UnknownHostException
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="functional-tests"><a class="anchor" href="#functional-tests"></a><a class="link" href="#functional-tests">Implementing functional tests</a></h5>
<div class="paragraph">
<p>Functional tests verify the correctness of the plugin end-to-end.
In practice, this means applying, configuring, and executing the functionality of the plugin implementation.
The <code>UrlVerifierPlugin</code> class exposes an extension and a task instance that uses the URL value configured by the end user:</p>
</div>
<div class="listingblock">
<div class="title">UrlVerifierPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.myorg;

import org.gradle.api.Plugin;
import org.gradle.api.Project;
import org.myorg.tasks.UrlVerify;

public class UrlVerifierPlugin implements Plugin&lt;Project&gt; {
    @Override
    public void apply(Project project) {
        UrlVerifierExtension extension = project.getExtensions().create("verification", UrlVerifierExtension.class);
        UrlVerify verifyUrlTask = project.getTasks().create("verifyUrl", UrlVerify.class);
        verifyUrlTask.getUrl().set(extension.getUrl());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every Gradle plugin project should apply the <a href="java_gradle_plugin.html#java_gradle_plugin">plugin development plugin</a> to reduce boilerplate code.
By applying the plugin development plugin, the test source set is preconfigured for the use with TestKit.
If we want to use a custom source set for functional tests and leave the default test source set for only unit tests, we can configure the plugin development plugin to look for TestKit tests elsewhere.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradlePlugin {
    testSourceSets(functionalTest)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradlePlugin {
    testSourceSets(sourceSets.functionalTest)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Functional tests for Gradle plugins use an instance of <code>GradleRunner</code> to execute the build under test.
<code>GradleRunner</code> is an API provided by TestKit, which internally uses the Tooling API to execute the build.</p>
</div>
<div class="paragraph">
<p>The following example applies the plugin to the build script under test, configures the extension and executes the build with the task <code>verifyUrl</code>.
Please see the <a href="#test_kit">TestKit documentation</a> to get more familiar with the functionality of TestKit.</p>
</div>
<div class="listingblock">
<div class="title">UrlVerifierPluginFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">package org.myorg

import org.gradle.testkit.runner.GradleRunner
import spock.lang.Specification
import spock.lang.TempDir

import static org.gradle.testkit.runner.TaskOutcome.SUCCESS

class UrlVerifierPluginFunctionalTest extends Specification {
    @TempDir File testProjectDir
    File buildFile

    def setup() {
        buildFile = new File(testProjectDir, 'build.gradle')
        buildFile &lt;&lt; """
            plugins {
                id 'org.myorg.url-verifier'
            }
        """
    }

    def "can successfully configure URL through extension and verify it"() {
        buildFile &lt;&lt; """
            verification {
                url = 'https://www.google.com/'
            }
        """

        when:
        def result = GradleRunner.create()
            .withProjectDir(testProjectDir)
            .withArguments('verifyUrl')
            .withPluginClasspath()
            .build()

        then:
        result.output.contains("Successfully resolved URL 'https://www.google.com/'")
        result.task(":verifyUrl").outcome == SUCCESS
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="ide_integration_2"><a class="anchor" href="#ide_integration_2"></a><a class="link" href="#ide_integration_2">IDE integration</a></h6>
<div class="paragraph">
<p>TestKit determines the plugin classpath by running a specific Gradle task.
You will need to execute the <code>assemble</code> task to initially generate the plugin classpath or to reflect changes to it even when running TestKit-based functional tests from the IDE.</p>
</div>
<div class="paragraph">
<p>Some IDEs provide a convenience option to delegate the "test classpath generation and execution" to the build.
In IntelliJ, you can find this option under Preferences&#8230;&#8203; &gt; Build, Execution, Deployment &gt; Build Tools &gt; Gradle &gt; Runner &gt; Delegate IDE build/run actions to Gradle.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/intellij-delegate-to-build.png" alt="intellij delegate to build">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_portal"><a class="anchor" href="#publishing_portal"></a><a class="link" href="#publishing_portal">Publishing Plugins to the Gradle Plugin Portal</a></h3>
<div class="paragraph">
<p>Publishing a plugin is the primary way to make it available for others to use.
While you can publish to a private repository to restrict access, publishing to the <a href="https://plugins.gradle.org">Gradle Plugin Portal</a> makes your plugin available to anyone in the world.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/plugin-portal-page.png" alt="plugin portal page">
</div>
</div>
<div class="paragraph">
<p>This guide shows you how to use the <a href="https://plugins.gradle.org/plugin/com.gradle.plugin-publish"><code>com.gradle.plugin-publish</code></a> plugin to publish plugins to the <a href="https://plugins.gradle.org">Gradle Plugin Portal</a> using a convenient DSL.
This approach streamlines configuration steps and provides validation checks to ensure your plugin meets the Gradle Plugin Portal&#8217;s criteria.</p>
</div>
<div class="sect3">
<h4 id="prerequisites"><a class="anchor" href="#prerequisites"></a><a class="link" href="#prerequisites">Prerequisites</a></h4>
<div class="paragraph">
<p>You&#8217;ll need an existing Gradle plugin project for this tutorial. If you don&#8217;t have one, use the <a href="../samples/sample_gradle_plugin.html">Greeting plugin sample</a>.</p>
</div>
<div class="paragraph">
<p>Attempting to publish this plugin will safely fail with a permission error, so don&#8217;t worry about cluttering up the Gradle Plugin Portal with a trivial example plugin.</p>
</div>
</div>
<div class="sect3">
<h4 id="account_setup"><a class="anchor" href="#account_setup"></a><a class="link" href="#account_setup">Account setup</a></h4>
<div class="paragraph">
<p>Before publishing your plugin, you must create an account on the Gradle Plugin Portal.
Follow the instructions on the <a href="https://plugins.gradle.org/user/register">registration page</a> to create an account and obtain an API key from your profile page&#8217;s "API Keys" tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/plugin-portal-registration-page.png" alt="plugin portal registration page">
</div>
</div>
<div class="paragraph">
<p>Store your API key in your Gradle configuration (gradle.publish.key and gradle.publish.secret) or use a plugin like Seauc Credentials plugin for secure management.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/plugin-portal-api-keys.png" alt="plugin portal api keys">
</div>
</div>
<div class="paragraph">
<p>It is common practice to copy and paste the text into your <a href="#sec:gradle_configuration_properties">$HOME/.gradle/gradle.properties</a> file, but you can also place it in any other valid location.
All the plugin requires is that the <code>gradle.publish.key</code> and <code>gradle.publish.secret</code> are available as project properties when the appropriate Plugin Portal tasks are executed.</p>
</div>
<div class="paragraph">
<p>If you are concerned about placing your credentials in <code>gradle.properties</code>, check out the <a href="https://plugins.gradle.org/plugin/de.qaware.seu.as.code.credentials">Seauc Credentials plugin</a>.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can provide the API key via <code>GRADLE_PUBLISH_KEY</code> and <code>GRADLE_PUBLISH_SECRET</code> environment variables.
This approach might be useful for CI/CD pipelines.</p>
</div>
</div>
<div class="sect3">
<h4 id="plugin-publishing-plugin"><a class="anchor" href="#plugin-publishing-plugin"></a><a class="link" href="#plugin-publishing-plugin">Adding the Plugin Publishing Plugin</a></h4>
<div class="paragraph">
<p>To publish your plugin, add the <code>com.gradle.plugin-publish</code> plugin to your project&#8217;s <code>build.gradle</code> or <code>build.gradle.kts</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("com.gradle.plugin-publish") version "1.2.1"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'com.gradle.plugin-publish' version '1.2.1'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The latest version of the Plugin Publishing Plugin can be found on the <a href="https://plugins.gradle.org/plugin/com.gradle.plugin-publish">Gradle Plugin Portal</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since version 1.0.0 the Plugin Publish Plugin automatically applies the
<a href="java_gradle_plugin.html#java_gradle_plugin">Java Gradle Plugin Development Plugin</a> (assists with developing Gradle plugins) and the
<a href="#publishing_maven">Maven Publish Plugin</a> (generates plugin publication metadata).
If using older versions of the Plugin Publish Plugin, these helper plugins must be applied explicitly.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="configure_the_plugin_publishing_plugin"><a class="anchor" href="#configure_the_plugin_publishing_plugin"></a><a class="link" href="#configure_the_plugin_publishing_plugin">Configuring the Plugin Publishing Plugin</a></h4>
<div class="paragraph">
<p>Configure the <code>com.gradle.plugin-publish</code> plugin in your <code>build.gradle</code> or <code>build.gradle.kts</code> file.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">group = "io.github.johndoe" // <b class="conum">(1)</b>
version = "1.0" // <b class="conum">(2)</b>

gradlePlugin { // <b class="conum">(3)</b>
    website = "&lt;substitute your project website&gt;" // <b class="conum">(4)</b>
    vcsUrl = "&lt;uri to project source repository&gt;" // <b class="conum">(5)</b>

    // ... // <b class="conum">(6)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">group = 'io.github.johndoe' // <b class="conum">(1)</b>
version = '1.0'     // <b class="conum">(2)</b>

gradlePlugin { // <b class="conum">(3)</b>
    website = '&lt;substitute your project website&gt;' // <b class="conum">(4)</b>
    vcsUrl = '&lt;uri to project source repository&gt;' // <b class="conum">(5)</b>

    // ... // <b class="conum">(6)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Make sure your project has a <code>group</code> set which is used to identify the artifacts (jar and metadata) you publish for your plugins
in the repository of the Gradle Plugin Portal and which is descriptive of the plugin author or the organization the plugins belong too.</p>
</li>
<li>
<p>Set the version of your project, which will also be used as the version of your plugins.</p>
</li>
<li>
<p>Use the <code>gradlePlugin</code> block provided by the <a href="java_gradle_plugin.html#java_gradle_plugin">Java Gradle Plugin Development Plugin</a>
to configure further options for your plugin publication.</p>
</li>
<li>
<p>Set the website for your plugin&#8217;s project.</p>
</li>
<li>
<p>Provide the source repository URI so that others can find it, if they want to contribute.</p>
</li>
<li>
<p>Set specific properties for each plugin you want to publish; see next section.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Define common properties for all plugins, such as group, version, website, and source repository, using the <code>gradlePlugin{}</code> block:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradlePlugin { // <b class="conum">(1)</b>
    // ... // <b class="conum">(2)</b>

    plugins { // <b class="conum">(3)</b>
        create("greetingsPlugin") { // <b class="conum">(4)</b>
            id = "&lt;your plugin identifier&gt;" // <b class="conum">(5)</b>
            displayName = "&lt;short displayable name for plugin&gt;" // <b class="conum">(6)</b>
            description = "&lt;human-readable description of what your plugin is about&gt;" // <b class="conum">(7)</b>
            tags = listOf("tags", "for", "your", "plugins") // <b class="conum">(8)</b>
            implementationClass = "&lt;your plugin class&gt;"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradlePlugin { // <b class="conum">(1)</b>
    // ... // <b class="conum">(2)</b>

    plugins { // <b class="conum">(3)</b>
        greetingsPlugin { // <b class="conum">(4)</b>
            id = '&lt;your plugin identifier&gt;' // <b class="conum">(5)</b>
            displayName = '&lt;short displayable name for plugin&gt;' // <b class="conum">(6)</b>
            description = '&lt;human-readable description of what your plugin is about&gt;' // <b class="conum">(7)</b>
            tags.set(['tags', 'for', 'your', 'plugins']) // <b class="conum">(8)</b>
            implementationClass = '&lt;your plugin class&gt;'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Plugin specific configuration also goes into the <code>gradlePlugin</code> block.</p>
</li>
<li>
<p>This is where we previously added global properties.</p>
</li>
<li>
<p>Each plugin you publish will have its own block inside <code>plugins</code>.</p>
</li>
<li>
<p>The name of a plugin block must be unique for each plugin you publish; this is a property used only locally by your build and will not be part of the publication.</p>
</li>
<li>
<p>Set the unique <code>id</code> of the plugin, as it will be identified in the publication.</p>
</li>
<li>
<p>Set the plugin name in human-readable form.</p>
</li>
<li>
<p>Set a description to be displayed on the portal. It provides useful information to people who want to use your plugin.</p>
</li>
<li>
<p>Specifies the categories your plugin covers. It makes the plugin more likely to be discovered by people needing its functionality.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, consider the configuration for the <a href="https://plugins.gradle.org/plugin/org.ysb33r.gradletest">GradleTest plugin</a>, already published to the Gradle Plugin Portal.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradlePlugin {
    website = "https://github.com/ysb33r/gradleTest"
    vcsUrl = "https://github.com/ysb33r/gradleTest.git"
    plugins {
        create("gradletestPlugin") {
            id = "org.ysb33r.gradletest"
            displayName = "Plugin for compatibility testing of Gradle plugins"
            description = "A plugin that helps you test your plugin against a variety of Gradle versions"
            tags = listOf("testing", "integrationTesting", "compatibility")
            implementationClass = "org.ysb33r.gradle.gradletest.GradleTestPlugin"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradlePlugin {
    website = 'https://github.com/ysb33r/gradleTest'
    vcsUrl = 'https://github.com/ysb33r/gradleTest.git'
    plugins {
        gradletestPlugin {
            id = 'org.ysb33r.gradletest'
            displayName = 'Plugin for compatibility testing of Gradle plugins'
            description = 'A plugin that helps you test your plugin against a variety of Gradle versions'
            tags.addAll('testing', 'integrationTesting', 'compatibility')
            implementationClass = 'org.ysb33r.gradle.gradletest.GradleTestPlugin'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you browse the associated page on the Gradle Plugin Portal for the <a href="https://plugins.gradle.org/plugin/org.ysb33r.gradletest">GradleTest plugin</a>, you will see how the specified metadata is displayed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/plugin-portal-plugin-page.png" alt="plugin portal plugin page">
</div>
</div>
<div class="sect4">
<h5 id="sources_javadoc"><a class="anchor" href="#sources_javadoc"></a><a class="link" href="#sources_javadoc">Sources &amp; Javadoc</a></h5>
<div class="paragraph">
<p>The Plugin Publish Plugin automatically generates and publishes the <a href="#sec:java_packaging">Javadoc, and sources JARs</a> for your plugin publication.</p>
</div>
</div>
<div class="sect4">
<h5 id="sign_artifacts"><a class="anchor" href="#sign_artifacts"></a><a class="link" href="#sign_artifacts">Sign artifacts</a></h5>
<div class="paragraph">
<p>Starting from version 1.0.0 of Plugin Publish Plugin, the signing of published plugin artifacts has been made automatic.
To enable it, all that&#8217;s needed is to apply the <a href="signing_plugin.html#signing_plugin"><code>signing</code></a> plugin in your build.</p>
</div>
</div>
<div class="sect4">
<h5 id="shadow_dependencies"><a class="anchor" href="#shadow_dependencies"></a><a class="link" href="#shadow_dependencies">Shadow dependencies</a></h5>
<div class="paragraph">
<p>Starting from version 1.0.0 of Plugin Publish Plugin, shadowing your plugin&#8217;s dependencies (ie, publishing it as a fat jar) has been made automatic.
To enable it, all that&#8217;s needed is to apply the <a href="https://github.com/GradleUp/shadow"><code>com.gradleup.shadow</code></a> plugin in your build.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_your_plugin"><a class="anchor" href="#sec:publishing_your_plugin"></a><a class="link" href="#sec:publishing_your_plugin">Publishing the plugin</a></h4>
<div class="paragraph">
<p>If you publish your plugin internally for use within your organization, you can publish it like any other code artifact.
See the <a href="#publishing_ivy">Ivy</a> and <a href="#publishing_maven">Maven</a> chapters on publishing artifacts.</p>
</div>
<div class="paragraph">
<p>If you are interested in publishing your plugin to be used by the wider Gradle community, you can publish it to <a href="http://plugins.gradle.org">Gradle Plugin Portal</a>.
This site provides the ability to search for and gather information about plugins contributed by the Gradle community.
Please refer to the corresponding <a href="#publishing_portal">section</a> on making your plugin available on this site.</p>
</div>
<div class="sect4">
<h5 id="custom-plugin-repositories"><a class="anchor" href="#custom-plugin-repositories"></a><a class="link" href="#custom-plugin-repositories">Publish locally</a></h5>
<div class="paragraph">
<p>To check how the artifacts of your published plugin look or to use it only locally or internally in your company, you can publish it to any Maven repository, including a local folder.
You only need to <a href="#publishing_maven:repositories">configure repositories for publishing</a>.
Then, you can run the <code>publish</code> task to publish your plugin to all repositories you have defined (but not the Gradle Plugin Portal).</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    repositories {
        maven {
            name = "localPluginRepository"
            url = uri("../local-plugin-repository")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    repositories {
        maven {
            name = 'localPluginRepository'
            url = file('../local-plugin-repository')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To use the repository in another build, add it to <a href="plugins_intermediate.html#sec:custom_plugin_repositories">the repositories of the <code>pluginManagement {}</code> block</a> in your <code>settings.gradle(.kts)</code> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="publish_to_the_plugin_portal"><a class="anchor" href="#publish_to_the_plugin_portal"></a><a class="link" href="#publish_to_the_plugin_portal">Publish to the Plugin Portal</a></h5>
<div class="paragraph">
<p>Publish the plugin by using the <code>publishPlugin</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew publishPlugins</pre>
</div>
</div>
<div class="paragraph">
<p>You can validate your plugins before publishing using the <code>--validate-only</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew publishPlugins --validate-only</pre>
</div>
</div>
<div class="paragraph">
<p>If you have not configured your <code>gradle.properties</code> for the Gradle Plugin Portal, you can specify them on the command-line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew publishPlugins -Pgradle.publish.key=&lt;key&gt; -Pgradle.publish.secret=&lt;secret&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You will encounter a permission failure if you attempt to publish the example Greeting Plugin with the ID used in this section.
That&#8217;s expected and ensures the portal won&#8217;t be overrun with multiple experimental and duplicate greeting-type plugins.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After approval, your plugin will be available on the Gradle Plugin Portal for others to discover and use.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="consume"><a class="anchor" href="#consume"></a><a class="link" href="#consume">Consume the published plugin</a></h4>
<div class="paragraph">
<p>Once you successfully publish a plugin, it won&#8217;t immediately appear on the Portal.
It also needs to pass an approval process, which is manual and relatively slow for the initial version of your plugin, but is fully automatic for subsequent versions.
For further details, see <a href="https://plugins.gradle.org/docs/publish-plugin-new#approval">here</a>.</p>
</div>
<div class="paragraph">
<p>Once your plugin is approved, you can find instructions for its use at a URL of the form <strong>https://plugins.gradle.org/plugin/&lt;your-plugin-id&gt;</strong>.
For example, the Greeting Plugin example is already on the portal at <a href="https://plugins.gradle.org/plugin/org.example.greeting" class="bare">https://plugins.gradle.org/plugin/org.example.greeting</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="plugins_published_without_gradle_plugin_portal"><a class="anchor" href="#plugins_published_without_gradle_plugin_portal"></a><a class="link" href="#plugins_published_without_gradle_plugin_portal">Plugins published without Gradle Plugin Portal</a></h4>
<div class="paragraph">
<p>If your plugin was published without using the <a href="java_gradle_plugin.html#java_gradle_plugin">Java Gradle Plugin Development Plugin</a>, the publication will be lacking <a href="plugins_intermediate.html#sec:plugin_markers">Plugin Marker Artifact</a>, which is needed for <a href="plugins_intermediate.html#sec:plugins_block">plugins DSL</a> to locate the plugin.
In this case, the recommended way to resolve the plugin in another project is to add a <code>resolutionStrategy</code> section to the <code>pluginManagement {}</code> block of the project&#8217;s settings file, as shown below.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">resolutionStrategy {
    eachPlugin {
        if (requested.id.namespace == "org.example") {
            useModule("org.example:custom-plugin:${requested.version}")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">resolutionStrategy {
    eachPlugin {
        if (requested.id.namespace == 'org.example') {
            useModule("org.example:custom-plugin:${requested.version}")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:reporting_problems"><a class="anchor" href="#sec:reporting_problems"></a><a class="link" href="#sec:reporting_problems">Reporting problems</a></h3>
<div class="paragraph">
<p>Plugins can report problems through Gradle&#8217;s problems-reporting APIs.
The APIs report rich, structured information about problems happening during the build.
This information can be used by different user interfaces such as Gradle&#8217;s console output, Build Scan, or IDEs to communicate problems to the user in the most appropriate way.</p>
</div>
<div class="paragraph">
<p>The following example shows an issue reported from a plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">ProblemReportingPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ProblemReportingPlugin implements Plugin&lt;Project&gt; {

    public static final ProblemGroup PROBLEM_GROUP = ProblemGroup.create("sample-group", "Sample Group");

    private final ProblemReporter problemReporter;

    interface SomeData extends AdditionalData {
        void setName(String name);
        String getName();
    }

    @Inject
    public ProblemReportingPlugin(Problems problems) { // <b class="conum">(1)</b>
        this.problemReporter = problems.getReporter(); // <b class="conum">(2)</b>
    }

    public void apply(Project project) {
        ProblemId problemId = ProblemId.create("adhoc-deprecation", "Plugin 'x' is deprecated", PROBLEM_GROUP);
        this.problemReporter.report(problemId, builder -&gt; builder // <b class="conum">(3)</b>
            .details("The plugin 'x' is deprecated since version 2.5")
            .solution("Please use plugin 'y'")
            .severity(Severity.WARNING)
            .additionalData(SomeData.class, additionalData -&gt; {
                additionalData.setName("Some name"); // <b class="conum">(4)</b>
            })
        );
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>Problem</code> service is injected into the plugin.</p>
</li>
<li>
<p>A problem reporter, is created for the plugin. While the namespace is up to the plugin author, it is recommended that the plugin ID be used.</p>
</li>
<li>
<p>A problem is reported. This problem is recoverable so that the build will continue.</p>
</li>
<li>
<p>some additional data is added.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For a full example, see our <a href="../samples/sample_problems_api_usage.html">end-to-end sample</a>.</p>
</div>
<div class="sect3">
<h4 id="problem_building"><a class="anchor" href="#problem_building"></a><a class="link" href="#problem_building">Problem building</a></h4>
<div class="paragraph">
<p>When reporting a problem, a wide variety of information can be provided.
The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/problems/ProblemSpec.html">ProblemSpec</a> describes all the information that can be provided.</p>
</div>
</div>
<div class="sect3">
<h4 id="reporting_problems"><a class="anchor" href="#reporting_problems"></a><a class="link" href="#reporting_problems">Reporting problems</a></h4>
<div class="paragraph">
<p>When it comes to reporting problems, we support two different modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/problems/ProblemReporter.html#reporting-org.gradle.api.Action-">Reporting</a> a problem is used for reporting problems that are recoverable, and the build should continue.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/problems/ProblemReporter.html#throwing-org.gradle.api.Action-">Throwing</a> a problem is used for reporting problems that are not recoverable, and the build should fail.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details, see the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/problems/ProblemReporter.html">ProblemReporter</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="problem_summarization"><a class="anchor" href="#problem_summarization"></a><a class="link" href="#problem_summarization">Problem summarization</a></h4>
<div class="paragraph">
<p>When reporting issues, Gradle ensures that the reports are concise and free of unnecessary redundancy.
Specifically, it prevents reporting the same problem repeatedly once a certain threshold is reached.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>During the build, the <em>first</em> few instances of a problem are reported as a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/problems/Problem.html">Problem</a>, providing all information available for that problem.</p>
</li>
<li>
<p>At the end of the build, subsequent occurrences of the same problem are grouped and summarized as a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/problems/ProblemSummary.html">ProblemSummary</a>.
This summary is delivered as with a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/problems/ProblemSummariesEvent.html">ProblemSummariesEvent</a>, which provides the total count of occurrences.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="build_failures"><a class="anchor" href="#build_failures"></a><a class="link" href="#build_failures">Build failures</a></h4>
<div class="paragraph">
<p>The standard approach for indicating a build failure is to throw an exception.
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/problems/ProblemReporter.html#throwing(org.gradle.api.Action)">ProblemReporter</a> provides enhanced support for this by allowing exceptions to be thrown with associated problem reports.</p>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">FailingTask.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ProblemId id = ProblemId.create("sample-error", "Sample Error", StandardPlugin.PROBLEM_GROUP);
throw getProblems().getReporter().throwing((new RuntimeException("Message from runtime exception")), id, problemSpec -&gt; {
    problemSpec.contextualLabel("This happened because ProblemReporter.throwing() was called")
        .details("This is a demonstration of how to add\ndetailed information to a build failure")
        .documentedAt("https://example.com/docs")
        .solution("Remove the Problems.throwing() method call from the task action");
});</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This ensures that build failures are clearly linked to the underlying issues and that these problems are properly communicated to various clients.
When a build failure is reported using the Problems API, all clients (Tooling API, CLI, Build Scan, etc.) will have access to the association.</p>
</div>
<div class="sect4">
<h5 id="command_line_interface_2"><a class="anchor" href="#command_line_interface_2"></a><a class="link" href="#command_line_interface_2">Command-line interface</a></h5>
<div class="paragraph">
<p>The CLI build failure output will include detailed information about the problem.
Error messages and descriptions are sourced directly from the problem report.
If the problem report includes a solution or recommended actions, these will be displayed in place of generic resolutions.</p>
</div>
<div class="paragraph">
<p><code>AdditionalData</code> is not included in the CLI output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':sample-project:myFailingTask'.
&gt; Message from runtime exception
    This happened because ProblemReporter.throwing() was called
      This is a demonstration of how to add
      detailed information to a build failure

* Try:
&gt; Remove the Problems.throwing() method call from the task action
&gt; Run with --scan to generate a Build Scan (Powered by Develocity).

BUILD FAILED in 0ms</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tooling_api_clients"><a class="anchor" href="#tooling_api_clients"></a><a class="link" href="#tooling_api_clients">Tooling API clients</a></h5>
<div class="paragraph">
<p>Tooling API clients can access detailed problem reports associated with build failures via the <code>Failure</code> object on the root build operation.
To receive these reports, the clients must register a progress listener for the <code>OperationType.ROOT</code> operation type.
The progress listener callback should then check if the operation result is of type <code>FailureResult</code>, and then it can access the associated problems via <code>Failure.getProblems()</code>.</p>
</div>
<div class="paragraph">
<p>In addition, there&#8217;s a more convenient way to access the failure details.
If clients configure the project connection with <code>LongRunningOperation.withFailureDetails()</code>, the Tooling API implicitly subscribes to the <code>ROOT</code> operation type and provides failure details via the <code>GradleConnectionException.getFailures()</code> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:generated_html_report"><a class="anchor" href="#sec:generated_html_report"></a><a class="link" href="#sec:generated_html_report">Generated HTML report</a></h4>
<div class="paragraph">
<p>The output of the problems generated by the Problems API is also provided as a rich HTML report generated at the end of the build.
This report serves as a central location for users to review problems that occurred during a build.</p>
</div>
<div class="paragraph">
<p>Plugin authors can use the Problems API to log events specific to their plugins, adding to the Gradle-generated ones.</p>
</div>
<div class="paragraph">
<p><code>AdditionalData</code> is not included in the HTML report.</p>
</div>
<div class="paragraph">
<p>The report is not generated if no issues have been reported.
Also, if you do not want to generate this report, you can disable it with the <code>--no-problems-report</code> flag.
The console output provides a link to this report, as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">[Incubating] Problem report is available at: &lt;project-dir&gt;/build/reports/problems/problems-report.html

BUILD SUCCESSFUL in 1s</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rendered report link directs you to a detailed HTML view of the problems:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/problems-report-html.png" alt="problems report html">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="other_topics"><a class="anchor" href="#other_topics"></a><a class="link" href="#other_topics">OTHER TOPICS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="init_scripts"><a class="anchor" href="#init_scripts"></a><a class="link" href="#init_scripts">Initialization Scripts</a></h3>
<div class="paragraph">
<p>Initialization scripts are scripts that run before the build script is executed.
They allow you to customize the build environment or configure settings early in the build.</p>
</div>
<div class="paragraph">
<p>Initialization scripts can be useful for setting up common configurations, such as repositories, plugins, or custom tasks, across multiple projects.</p>
</div>
<div class="sect3">
<h4 id="sec:basic_usage"><a class="anchor" href="#sec:basic_usage"></a><a class="link" href="#sec:basic_usage">Using an init script</a></h4>
<div class="paragraph">
<p>Initialization scripts, also called <em>init scripts</em>, are similar to other scripts in Gradle.
Initialization scripts run before the build starts.</p>
</div>
<div class="paragraph">
<p>They are useful for various purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting up enterprise-wide configurations (e.g., custom plugin locations)</p>
</li>
<li>
<p>Configuring properties based on the environment (e.g., developer&#8217;s machine vs. CI server)</p>
</li>
<li>
<p>Providing user-specific information (e.g., authentication credentials)</p>
</li>
<li>
<p>Defining machine-specific details (e.g., JDK locations)</p>
</li>
<li>
<p>Registering build listeners (e.g., external tools that wish to listen to Gradle events might find this helpful)</p>
</li>
<li>
<p>Registering loggers (e.g., customize how Gradle logs the events that it generates)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One main <a href="#sec:using_buildsrc">limitation of init scripts</a> is that they cannot access classes in the <code>buildSrc</code> project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_an_init_script"><a class="anchor" href="#sec:using_an_init_script"></a><a class="link" href="#sec:using_an_init_script">Invoking an init script</a></h4>
<div class="paragraph">
<p>There are several ways to invoke an init script (in order of priority):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Specify a file on the command line</strong> with the option <code>-I</code> or <code>--init-script</code> followed by the path to the script.</p>
<div class="paragraph">
<p>The command line option can appear more than once, each time adding another init script. The build will fail if any files specified on the command line do not exist.</p>
</div>
</li>
<li>
<p><strong>Put a file called <code>init.gradle(.kts)</code></strong> in the <code><em>$<a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></em>/</code> directory.</p>
</li>
<li>
<p><strong>Put a file called <code>yourfilename.init.gradle(.kts)</code></strong> in the <code><em>$<a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></em>/init.d/</code> directory.</p>
</li>
<li>
<p><strong>Put a file called <code>yourfilename.init.gradle(.kts)</code></strong> in the <code>$<a href="#sec:linux_macos_users_2"><em>GRADLE_HOME</em></a>/init.d/</code> directory. Entries will be evaluated in alphabetic order.</p>
<div class="paragraph">
<p>This lets you package a custom Gradle distribution containing custom build logic and plugins. You can combine this with the <a href="#gradle_wrapper">Gradle wrapper</a> to make custom logic available to all builds in your enterprise.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If more than one init script is found, they will all be executed in the order specified above.</p>
</div>
<div class="paragraph">
<p>Scripts in a given directory are executed in alphabetical order.
For example, a tool can specify an init script on the command line and another in the home directory to define the environment.
Both scripts will run when Gradle is executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:writing_an_init_script"><a class="anchor" href="#sec:writing_an_init_script"></a><a class="link" href="#sec:writing_an_init_script">Writing an init script</a></h4>
<div class="paragraph">
<p>Like a Gradle build script, an init script is a Groovy or Kotlin script.
Each init script has a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.invocation.Gradle.html">Gradle</a> instance associated with it.
Any property reference and method call in the init script will be delegated to this <code>Gradle</code> instance.</p>
</div>
<div class="paragraph">
<p>Each init script implements the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Script.html">Script</a> interface.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When writing init scripts, pay attention to the scope of the reference you are trying to access.
For example, properties loaded from <code>gradle.properties</code> are available on <code>Settings</code> or <code>Project</code> instances but not on the <code>Gradle</code> one.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec:configuring_projects_from_an_init_script"><a class="anchor" href="#sec:configuring_projects_from_an_init_script"></a><a class="link" href="#sec:configuring_projects_from_an_init_script">Configuring projects from an init script</a></h5>
<div class="paragraph">
<p>You can use an init script to configure the projects in the build.
This works similarly to configuring projects in a multi-project build.</p>
</div>
<div class="paragraph">
<p>The following sample shows how to perform extra configuration from an init script <em>before</em> the projects are evaluated:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

tasks.register('showRepos') {
    def repositoryNames = repositories.collect { it.name }
    doLast {
        println "All repos:"
        println repositoryNames
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">allprojects {
    repositories {
        mavenLocal()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

tasks.register("showRepos") {
    val repositoryNames = repositories.map { it.name }
    doLast {
        println("All repos:")
        println(repositoryNames)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">allprojects {
    repositories {
        mavenLocal()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This sample uses this feature to configure an additional repository to be used only for specific environments.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">&gt; gradle --init-script init.gradle.kts -q showRepos
All repos:
[MavenLocal, MavenRepo]</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&gt; gradle --init-script init.gradle -q showRepos
All repos:
[MavenLocal, MavenRepo]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_classpath"><a class="anchor" href="#sec:custom_classpath"></a><a class="link" href="#sec:custom_classpath">Adding external dependencies</a></h4>
<div class="paragraph">
<p>Init scripts can also declare dependencies with the <code>initscript()</code> method, passing in a closure that declares the init script classpath.</p>
</div>
<div class="paragraph">
<p>Declaring external dependencies for an init script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("org.apache.commons:commons-math:2.0")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'org.apache.commons:commons-math:2.0'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The closure passed to the <code>initscript()</code> method configures a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/dsl/ScriptHandler.html">ScriptHandler</a> instance.
You declare the init script classpath by adding dependencies to the <code>classpath</code> configuration.</p>
</div>
<div class="paragraph">
<p>This is the same way you declare, for example, the Java compilation classpath.
You can use any of the dependency types described in <a href="declaring_dependencies.html#one-declaring-dependencies">Declaring Dependencies</a>, except project dependencies.</p>
</div>
<div class="paragraph">
<p>Having declared the init script classpath, you can use the classes in your init script as you would any other classes on the classpath.
The following example adds to the previous example and uses classes from the init script classpath.</p>
</div>
<div class="paragraph">
<p>An init script with external dependencies:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.apache.commons.math.fraction.Fraction

initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("org.apache.commons:commons-math:2.0")
    }
}

println(Fraction.ONE_FIFTH.multiply(2))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("doNothing")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.apache.commons.math.fraction.Fraction

initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'org.apache.commons:commons-math:2.0'
    }
}

println Fraction.ONE_FIFTH.multiply(2)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('doNothing')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">&gt; gradle --init-script init.gradle.kts -q doNothing
2 / 5</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&gt; gradle --init-script init.gradle -q doNothing
2 / 5</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:init_script_plugins"><a class="anchor" href="#sec:init_script_plugins"></a><a class="link" href="#sec:init_script_plugins">Applying plugins</a></h4>
<div class="paragraph">
<p>Plugins can be applied to init scripts like a Gradle build script or a Gradle settings file.</p>
</div>
<div class="paragraph">
<p>Using plugins in init scripts:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">apply&lt;EnterpriseRepositoryPlugin&gt;()

class EnterpriseRepositoryPlugin : Plugin&lt;Gradle&gt; {
    companion object {
        const val ENTERPRISE_REPOSITORY_URL = "https://repo.gradle.org/gradle/repo"
    }

    override fun apply(gradle: Gradle) {
        // ONLY USE ENTERPRISE REPO FOR DEPENDENCIES
        gradle.allprojects {
            repositories {

                // Remove all repositories not pointing to the enterprise repository url
                all {
                    if (this !is MavenArtifactRepository || url.toString() != ENTERPRISE_REPOSITORY_URL) {
                        project.logger.lifecycle("Repository ${(this as? MavenArtifactRepository)?.url ?: name} removed. Only $ENTERPRISE_REPOSITORY_URL is allowed")
                        remove(this)
                    }
                }

                // add the enterprise repository
                add(maven {
                    name = "STANDARD_ENTERPRISE_REPO"
                    url = uri(ENTERPRISE_REPOSITORY_URL)
                })
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories{
    mavenCentral()
}

data class RepositoryData(val name: String, val url: URI)

tasks.register("showRepositories") {
    val repositoryData = repositories.withType&lt;MavenArtifactRepository&gt;().map { RepositoryData(it.name, it.url) }
    doLast {
        repositoryData.forEach {
            println("repository: ${it.name} ('${it.url}')")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">apply plugin: EnterpriseRepositoryPlugin

class EnterpriseRepositoryPlugin implements Plugin&lt;Gradle&gt; {

    private static String ENTERPRISE_REPOSITORY_URL = "https://repo.gradle.org/gradle/repo"

    void apply(Gradle gradle) {
        // ONLY USE ENTERPRISE REPO FOR DEPENDENCIES
        gradle.allprojects { project -&gt;
            project.repositories {

                // Remove all repositories not pointing to the enterprise repository url
                all { ArtifactRepository repo -&gt;
                    if (!(repo instanceof MavenArtifactRepository) ||
                          repo.url.toString() != ENTERPRISE_REPOSITORY_URL) {
                        project.logger.lifecycle "Repository ${repo.url} removed. Only $ENTERPRISE_REPOSITORY_URL is allowed"
                        remove repo
                    }
                }

                // add the enterprise repository
                maven {
                    name = "STANDARD_ENTERPRISE_REPO"
                    url = ENTERPRISE_REPOSITORY_URL
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories{
    mavenCentral()
}

@Immutable
class RepositoryData {
    String name
    URI url
}

tasks.register('showRepositories') {
    def repositoryData = repositories.collect { new RepositoryData(it.name, it.url) }
    doLast {
        repositoryData.each {
            println "repository: ${it.name} ('${it.url}')"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">&gt; gradle --init-script init.gradle.kts -q showRepositories
repository: STANDARD_ENTERPRISE_REPO ('https://repo.gradle.org/gradle/repo')</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&gt; gradle --init-script init.gradle -q showRepositories
repository: STANDARD_ENTERPRISE_REPO ('https://repo.gradle.org/gradle/repo')</code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin in the init script ensures that only a specified repository is used when running the build.</p>
</div>
<div class="paragraph">
<p>When applying plugins within the init script, Gradle instantiates the plugin and calls the plugin instance&#8217;s <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Plugin.html#apply-T-">Plugin.apply(T)</a> method.</p>
</div>
<div class="paragraph">
<p>The <code>gradle</code> object is passed as a parameter, which can be used to configure all aspects of a build. Of course, the applied plugin can be resolved as an external dependency as described in <a href="#sec:custom_classpath">External dependencies for the init script</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dataflow_action"><a class="anchor" href="#dataflow_action"></a><a class="link" href="#dataflow_action">Dataflow Actions</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The dataflow actions support is an <a href="#feature_lifecycle">incubating</a> feature and is subject to change.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A preferred way of executing work in a Gradle build is using a task.
However, some kinds of work do not fit tasks well, such as custom handling of the build failure.</p>
</div>
<div class="paragraph">
<p>What if you want to play a cheerful sound when the build succeeds and a sad one when it fails?
This work piece has to process the task execution result, so it cannot be a task itself.</p>
</div>
<div class="paragraph">
<p>The Dataflow Actions API provides a way to schedule this type of work.
A dataflow action is a parameterized isolated piece of work that becomes eligible for execution as soon as all input parameters become available.</p>
</div>
<div class="sect3">
<h4 id="implementing_a_dataflow_action"><a class="anchor" href="#implementing_a_dataflow_action"></a><a class="link" href="#implementing_a_dataflow_action">Implementing a dataflow action</a></h4>
<div class="paragraph">
<p>The first step is to implement the action itself.
You must create a class implementing the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/flow/FlowAction.html">FlowAction</a> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.gradle.api.flow.FlowAction
import org.gradle.api.flow.FlowParameters

abstract class ReportConsumption : FlowAction&lt;ReportConsumption.Params&gt; {

    interface Params : FlowParameters {

    }

    override fun execute(parameters: Params) {

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>execute</code> method must be implemented because this is where the work happens.
An action implementation is treated as a <a href="#properties_and_providers">custom Gradle type</a> and can use any of the features available to custom Gradle types.
In particular, some Gradle services can be injected into the implementation.</p>
</div>
<div class="paragraph">
<p>A dataflow action may accept parameters.
To provide parameters, you define an abstract class (or interface) to hold the parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The parameters type must implement (or extend) <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/flow/FlowParameters.html">FlowParameters</a>.</p>
</li>
<li>
<p>The parameters type is also a <a href="#properties_and_providers">custom Gradle type</a>.</p>
</li>
<li>
<p>The action implementation gets the parameters as an argument of the <code>execute</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the action requires no parameters, you can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/flow/FlowParameters.None.html">FlowParameters.None</a> as the type of parameter.</p>
</div>
<div class="paragraph">
<p>Here is an example of a dataflow action that takes a shared build service and a file path as parameters:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">SoundPlay.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.gradle.sample.sound;

import org.gradle.api.flow.FlowAction;
import org.gradle.api.flow.FlowParameters;
import org.gradle.api.provider.Property;
import org.gradle.api.services.ServiceReference;
import org.gradle.api.tasks.Input;

import java.io.File;

public abstract class SoundPlay implements FlowAction&lt;SoundPlay.Parameters&gt; {
    interface Parameters extends FlowParameters {
        @ServiceReference // <b class="conum">(1)</b>
        Property&lt;SoundService&gt; getSoundService();

        @Input // <b class="conum">(2)</b>
        Property&lt;File&gt; getMediaFile();
    }

    @Override
    public void execute(Parameters parameters) {
        parameters.getSoundService().get().playSoundFile(parameters.getMediaFile().get());
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Parameters in the parameter type must be annotated. If a parameter is annotated with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/ServiceReference.html"><code>@ServiceReference</code></a>, then a suitable shared build service implementation is automatically assigned to the parameter when the action is created, according to the <a href="#sec:service_references">usual rules</a>.</p>
</li>
<li>
<p>All other parameters must be annotated with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/Input.html"><code>@Input</code></a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="using_lifecycle_event_providers"><a class="anchor" href="#using_lifecycle_event_providers"></a><a class="link" href="#using_lifecycle_event_providers">Using lifecycle event providers</a></h4>
<div class="paragraph">
<p>Besides the usual value providers, Gradle provides dedicated providers for build lifecycle events, like build completion.
These providers are intended for dataflow actions and provide additional ordering guarantees when used as inputs.
The ordering also applies if you derive a provider from the event provider by, for example, calling <code>map</code> or <code>flatMap</code>.
You can obtain these providers from the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/flow/FlowProviders.html">FlowProviders</a> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">flowProviders.buildWorkResult.map {
    [
        buildInvocationId: scopeIdsService.buildInvocationId,
        workspaceId: scopeIdsService.workspaceId,
        userId: scopeIdsService.userId
    ]
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you&#8217;re not using a lifecycle event provider as an input to the dataflow action, then the exact timing when the action is executed is not defined and may change in the next version of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="supplying_the_action_for_execution"><a class="anchor" href="#supplying_the_action_for_execution"></a><a class="link" href="#supplying_the_action_for_execution">Supplying the action for execution</a></h4>
<div class="paragraph">
<p>You should not create <code>FlowAction</code> objects manually.
Instead, you request to execute them in the appropriate scope of <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/flow/FlowScope.html"><code>FlowScope</code></a>.
In doing so, you can configure the parameters for the task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">SoundFeedbackPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.gradle.sample.sound;

import org.gradle.api.Plugin;
import org.gradle.api.flow.FlowProviders;
import org.gradle.api.flow.FlowScope;
import org.gradle.api.initialization.Settings;

import javax.inject.Inject;
import java.io.File;

public abstract class SoundFeedbackPlugin implements Plugin&lt;Settings&gt; {
    @Inject
    protected abstract FlowScope getFlowScope(); // <b class="conum">(1)</b>

    @Inject
    protected abstract FlowProviders getFlowProviders(); // <b class="conum">(1)</b>

    @Override
    public void apply(Settings settings) {
        final File soundsDir = new File(settings.getSettingsDir(), "sounds");
        getFlowScope().always( // <b class="conum">(2)</b>
            SoundPlay.class,  // <b class="conum">(3)</b>
            spec -&gt;  // <b class="conum">(4)</b>
                spec.getParameters().getMediaFile().set(
                    getFlowProviders().getBuildWorkResult().map(result -&gt; // <b class="conum">(5)</b>
                        new File(
                            soundsDir,
                            result.getFailure().isPresent() ? "sad-trombone.mp3" : "tada.mp3"
                        )
                    )
                )
        );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use service injection to obtain <code>FlowScope</code> and <code>FlowProviders</code> instances. They are available for project and settings plugins.</p>
</li>
<li>
<p>Use an appropriate scope to run your actions. As the name suggests, actions in the <code>always</code> scope are executed every time the build runs.</p>
</li>
<li>
<p>Specify the class that implements the action.</p>
</li>
<li>
<p>Use the spec argument to configure the action parameters.</p>
</li>
<li>
<p>A lifecycle event provider can be mapped into something else while preserving the action order.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As a result, when you run the build, and it completes successfully, the action will play the "tada" sound.
If the build fails at configuration or execution time, you&#8217;ll hear "sad-trombone" sound&#8201;&#8212;&#8201;assuming that build configuration proceeds far enough for the action to be registered.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="test_kit"><a class="anchor" href="#test_kit"></a><a class="link" href="#test_kit">Testing Build Logic with TestKit</a></h3>
<div class="paragraph">
<p>The Gradle TestKit (a.k.a. just TestKit) is a library that aids in testing Gradle plugins and build logic generally. At this time, it is focused on <em>functional</em> testing. That is, testing build logic by exercising it as part of a programmatically executed build. Over time, the TestKit will likely expand to facilitate other kinds of tests.</p>
</div>
<div class="sect3">
<h4 id="sec:testkit_usage"><a class="anchor" href="#sec:testkit_usage"></a><a class="link" href="#sec:testkit_usage">Using TestKit</a></h4>
<div class="paragraph">
<p>To use the TestKit, include the following in your plugin&#8217;s build:</p>
</div>
<div id="ex-declaring-the-testkit-dependency" class="exampleblock">
<div class="title">Example 3. <a href="#ex-declaring-the-testkit-dependency">Declaring the TestKit dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation(gradleTestKit())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation gradleTestKit()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>gradleTestKit()</code> encompasses the classes of the TestKit, as well as the <a href="#embedding">Gradle Tooling API client</a>. It does not include a version of <a href="https://junit.org">JUnit</a>, <a href="https://testng.org">TestNG</a>, or any other test execution framework. Such a dependency must be explicitly declared.</p>
</div>
<div id="ex-declaring-the-junit-dependency" class="exampleblock">
<div class="title">Example 4. <a href="#ex-declaring-the-junit-dependency">Declaring the JUnit dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:functional_testing_with_the_gradle_runner"><a class="anchor" href="#sec:functional_testing_with_the_gradle_runner"></a><a class="link" href="#sec:functional_testing_with_the_gradle_runner">Functional testing with the Gradle runner</a></h4>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html">GradleRunner</a> facilitates programmatically executing Gradle builds, and inspecting the result.</p>
</div>
<div class="paragraph">
<p>A contrived build can be created (e.g. programmatically, or from a template) that exercises the "logic under test". The build can then be executed, potentially in a variety of ways (e.g. different combinations of tasks and arguments). The correctness of the logic can then be verified by asserting the following, potentially in combination:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The build&#8217;s output;</p>
</li>
<li>
<p>The build&#8217;s logging (i.e. console output);</p>
</li>
<li>
<p>The set of tasks executed by the build and their results (e.g. FAILED, UP-TO-DATE etc.).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After creating and configuring a runner instance, the build can be executed via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#build--">GradleRunner.build()</a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#buildAndFail--">GradleRunner.buildAndFail()</a> methods depending on the anticipated outcome.</p>
</div>
<div class="paragraph">
<p>The following demonstrates the usage of the Gradle runner in a Java JUnit test:</p>
</div>
<div class="sect4">
<h5 id="example_using_gradlerunner_with_java_and_junit"><a class="anchor" href="#example_using_gradlerunner_with_java_and_junit"></a><a class="link" href="#example_using_gradlerunner_with_java_and_junit">Example: Using GradleRunner with Java and JUnit</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.testkit.runner.BuildResult;
import org.gradle.testkit.runner.GradleRunner;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.io.TempDir;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import static org.gradle.testkit.runner.TaskOutcome.SUCCESS;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

public class BuildLogicFunctionalTest {

    @TempDir File testProjectDir;
    private File settingsFile;
    private File buildFile;

    @BeforeEach
    public void setup() {
        settingsFile = new File(testProjectDir, "settings.gradle");
        buildFile = new File(testProjectDir, "build.gradle");
    }

    @Test
    public void testHelloWorldTask() throws IOException {
        writeFile(settingsFile, "rootProject.name = 'hello-world'");
        String buildFileContent = "task helloWorld {" +
                                  "    doLast {" +
                                  "        println 'Hello world!'" +
                                  "    }" +
                                  "}";
        writeFile(buildFile, buildFileContent);

        BuildResult result = GradleRunner.create()
            .withProjectDir(testProjectDir)
            .withArguments("helloWorld")
            .build();

        assertTrue(result.getOutput().contains("Hello world!"));
        assertEquals(SUCCESS, result.task(":helloWorld").getOutcome());
    }

    private void writeFile(File destination, String content) throws IOException {
        BufferedWriter output = null;
        try {
            output = new BufferedWriter(new FileWriter(destination));
            output.write(content);
        } finally {
            if (output != null) {
                output.close();
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any test execution framework can be used.</p>
</div>
<div class="paragraph">
<p>As Gradle build scripts can also be written in the Groovy programming language, it is often a productive choice to write Gradle functional tests in Groovy. Furthermore, it is recommended to use the (Groovy based) <a href="https://code.google.com/p/spock/">Spock test execution framework</a> as it offers many compelling features over the use of JUnit.</p>
</div>
<div class="paragraph">
<p>The following demonstrates the usage of the Gradle runner in a Groovy Spock test:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_gradlerunner_with_groovy_and_spock"><a class="anchor" href="#example_using_gradlerunner_with_groovy_and_spock"></a><a class="link" href="#example_using_gradlerunner_with_groovy_and_spock">Example: Using GradleRunner with Groovy and Spock</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.gradle.testkit.runner.GradleRunner
import static org.gradle.testkit.runner.TaskOutcome.*
import spock.lang.TempDir
import spock.lang.Specification

class BuildLogicFunctionalTest extends Specification {
    @TempDir File testProjectDir
    File settingsFile
    File buildFile

    def setup() {
        settingsFile = new File(testProjectDir, 'settings.gradle')
        buildFile = new File(testProjectDir, 'build.gradle')
    }

    def "hello world task prints hello world"() {
        given:
        settingsFile &lt;&lt; "rootProject.name = 'hello-world'"
        buildFile &lt;&lt; """
            task helloWorld {
                doLast {
                    println 'Hello world!'
                }
            }
        """

        when:
        def result = GradleRunner.create()
            .withProjectDir(testProjectDir)
            .withArguments('helloWorld')
            .build()

        then:
        result.output.contains('Hello world!')
        result.task(":helloWorld").outcome == SUCCESS
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a common practice to implement any custom build logic (like plugins and task types) that is more complex in nature as external classes in a standalone project. The main driver behind this approach is bundle the compiled code into a JAR file, publish it to a binary repository and reuse it across various projects.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-classpath-injection"><a class="anchor" href="#sub:test-kit-classpath-injection"></a><a class="link" href="#sub:test-kit-classpath-injection">Getting the plugin-under-test into the test build</a></h4>
<div class="paragraph">
<p>The GradleRunner uses the <a href="#embedding">Tooling API</a> to execute builds. An implication of this is that the builds are executed in a separate process (i.e. not the same process executing the tests). Therefore, the test build does not share the same classpath or classloaders as the test process and the code under test is not implicitly available to the test build.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>GradleRunner supports the same range of Gradle versions as the Tooling API.
The supported versions are defined in the <a href="#sec:embedding_compatibility">compatibility matrix</a>.</p>
</div>
<div class="paragraph">
<p>Builds with older Gradle versions <em>may</em> still work but there are no guarantees.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Starting with version 2.13, Gradle provides a conventional mechanism to inject the code under test into the test build.</p>
</div>
<div class="sect4">
<h5 id="sub:test-kit-automatic-classpath-injection"><a class="anchor" href="#sub:test-kit-automatic-classpath-injection"></a><a class="link" href="#sub:test-kit-automatic-classpath-injection">Automatic injection with the Java Gradle Plugin Development plugin</a></h5>
<div class="paragraph">
<p>The <a href="java_gradle_plugin.html#java_gradle_plugin">Java Gradle Plugin development plugin</a> can be used to assist in the development of Gradle plugins.
Starting with Gradle version 2.13, the plugin provides a direct integration with TestKit.
When applied to a project, the plugin automatically adds the <code>gradleTestKit()</code> dependency to the <code>testApi</code> configuration.
Furthermore, it automatically generates the classpath for the code under test and injects it via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath--">GradleRunner.withPluginClasspath()</a> for any <code>GradleRunner</code> instance created by the user.
It&#8217;s important to note that the mechanism currently <em>only</em> works if the plugin under test is applied using the <a href="plugins_intermediate.html#sec:plugins_block">plugins DSL</a>.
If the <a href="#sub:gradle-runner-gradle-version">target Gradle version</a> is prior to 2.8, automatic plugin classpath injection is not performed.</p>
</div>
<div class="paragraph">
<p>The plugin uses the following conventions for applying the TestKit dependency and injecting the classpath:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Source set containing code under test: <code>sourceSets.main</code></p>
</li>
<li>
<p>Source set used for injecting the plugin classpath: <code>sourceSets.test</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any of these conventions can be reconfigured with the help of the class <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/plugin/devel/GradlePluginDevelopmentExtension.html">GradlePluginDevelopmentExtension</a>.</p>
</div>
<div class="paragraph">
<p>The following Groovy-based sample demonstrates how to automatically inject the plugin classpath by using the standard conventions applied by the Java Gradle Plugin Development plugin.</p>
</div>
<div id="ex-using-the-java-gradle-development-plugin-for-generating-the-plugin-metadata" class="exampleblock">
<div class="title">Example 5. <a href="#ex-using-the-java-gradle-development-plugin-for-generating-the-plugin-metadata">Using the Java Gradle Development plugin for generating the plugin metadata</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    groovy
    `java-gradle-plugin`
}

dependencies {
    testImplementation("org.spockframework:spock-core:2.3-groovy-4.0") {
        exclude(group = "org.codehaus.groovy")
    }
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy'
    id 'java-gradle-plugin'
}

dependencies {
    testImplementation('org.spockframework:spock-core:2.3-groovy-4.0') {
        exclude group: 'org.codehaus.groovy'
    }
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_automatically_injecting_the_code_under_test_classes_into_test_builds"><a class="anchor" href="#example_automatically_injecting_the_code_under_test_classes_into_test_builds"></a><a class="link" href="#example_automatically_injecting_the_code_under_test_classes_into_test_builds">Example: Automatically injecting the code under test classes into test builds</a></h5>
<div class="listingblock">
<div class="title">src/test/groovy/org/gradle/sample/BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def "hello world task prints hello world"() {
    given:
    settingsFile &lt;&lt; "rootProject.name = 'hello-world'"
    buildFile &lt;&lt; """
        plugins {
            id 'org.gradle.sample.helloworld'
        }
    """

    when:
    def result = GradleRunner.create()
        .withProjectDir(testProjectDir)
        .withArguments('helloWorld')
        .withPluginClasspath()
        .build()

    then:
    result.output.contains('Hello world!')
    result.task(":helloWorld").outcome == SUCCESS
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following build script demonstrates how to reconfigure the conventions provided by the Java Gradle Plugin Development plugin for a project that uses a custom <code>Test</code> source set.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A new configuration DSL for modeling the below <code>functionalTest</code> suite is available via the incubating <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin.
</td>
</tr>
</table>
</div>
<div id="ex-reconfiguring-the-classpath-generation-conventions-of-the-java-gradle-development-plugin" class="exampleblock">
<div class="title">Example 6. <a href="#ex-reconfiguring-the-classpath-generation-conventions-of-the-java-gradle-development-plugin">Reconfiguring the classpath generation conventions of the Java Gradle Development plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    groovy
    `java-gradle-plugin`
}

val functionalTest = sourceSets.create("functionalTest")
val functionalTestTask = tasks.register&lt;Test&gt;("functionalTest") {
    group = "verification"
    testClassesDirs = functionalTest.output.classesDirs
    classpath = functionalTest.runtimeClasspath
    useJUnitPlatform()
}

tasks.check {
    dependsOn(functionalTestTask)
}

gradlePlugin {
    testSourceSets(functionalTest)
}

dependencies {
    "functionalTestImplementation"("org.spockframework:spock-core:2.3-groovy-4.0") {
        exclude(group = "org.codehaus.groovy")
    }
    "functionalTestRuntimeOnly"("org.junit.platform:junit-platform-launcher")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy'
    id 'java-gradle-plugin'
}

def functionalTest = sourceSets.create('functionalTest')
def functionalTestTask = tasks.register('functionalTest', Test) {
    group = 'verification'
    testClassesDirs = sourceSets.functionalTest.output.classesDirs
    classpath = sourceSets.functionalTest.runtimeClasspath
    useJUnitPlatform()
}

tasks.named("check") {
    dependsOn functionalTestTask
}

gradlePlugin {
    testSourceSets sourceSets.functionalTest
}

dependencies {
    functionalTestImplementation('org.spockframework:spock-core:2.3-groovy-4.0') {
        exclude group: 'org.codehaus.groovy'
    }
    functionalTestRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling_the_build_environment"><a class="anchor" href="#sec:controlling_the_build_environment"></a><a class="link" href="#sec:controlling_the_build_environment">Controlling the build environment</a></h4>
<div class="paragraph">
<p>The runner executes the test builds in an isolated environment by specifying a dedicated "working directory" in a directory inside the JVM&#8217;s temp directory (i.e. the location specified by the <code>java.io.tmpdir</code> system property, typically <code>/tmp</code>). Any configuration in the default Gradle User Home (e.g. <code>~/.gradle/gradle.properties</code>) is not used for test execution. The TestKit does not expose a mechanism for fine grained control of all aspects of the environment (e.g., JDK). Future versions of the TestKit will provide improved configuration options.</p>
</div>
<div class="paragraph">
<p>The TestKit uses dedicated daemon processes that are automatically shut down after test execution.</p>
</div>
<div class="paragraph">
<p>The dedicated working directory is not deleted by the runner after the build.
The TestKit provides two ways to specify a location that is regularly cleaned, such as the project&#8217;s build folder:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>org.gradle.testkit.dir</code> system property;</p>
</li>
<li>
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withTestKitDir-java.io.File-">GradleRunner.withTestKitDir(file testKitDir)</a> method.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sub:gradle-runner-gradle-version"><a class="anchor" href="#sub:gradle-runner-gradle-version"></a><a class="link" href="#sub:gradle-runner-gradle-version">Setting the Gradle version used to test</a></h4>
<div class="paragraph">
<p>The Gradle runner requires a Gradle distribution in order to execute the build. The TestKit does not depend on all of Gradle&#8217;s implementation.</p>
</div>
<div class="paragraph">
<p>By default, the runner will attempt to find a Gradle distribution based on where the <code>GradleRunner</code> class was loaded from. That is, it is expected that the class was loaded from a Gradle distribution, as is the case when using the <code>gradleTestKit()</code> dependency declaration.</p>
</div>
<div class="paragraph">
<p>When using the runner as part of tests <em>being executed by Gradle</em> (e.g. executing the <code>test</code> task of a plugin project), the same distribution used to execute the tests will be used by the runner. When using the runner as part of tests <em>being executed by an IDE</em>, the same distribution of Gradle that was used when importing the project will be used. This means that the plugin will effectively be tested with the same version of Gradle that it is being built with.</p>
</div>
<div class="paragraph">
<p>Alternatively, a different and specific version of Gradle to use can be specified by the any of the following <code>GradleRunner</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleVersion-java.lang.String-">GradleRunner.withGradleVersion(java.lang.String)</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleInstallation-java.io.File-">GradleRunner.withGradleInstallation(java.io.File)</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleDistribution-java.net.URI-">GradleRunner.withGradleDistribution(java.net.URI)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This can potentially be used to test build logic across Gradle versions. The following demonstrates a cross-version compatibility test written as Groovy Spock test:</p>
</div>
<div class="sect4">
<h5 id="example_specifying_a_gradle_version_for_test_execution"><a class="anchor" href="#example_specifying_a_gradle_version_for_test_execution"></a><a class="link" href="#example_specifying_a_gradle_version_for_test_execution">Example: Specifying a Gradle version for test execution</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import org.gradle.testkit.runner.GradleRunner
import static org.gradle.testkit.runner.TaskOutcome.*
import spock.lang.TempDir
import spock.lang.Specification

class BuildLogicFunctionalTest extends Specification {
    @TempDir File testProjectDir
    File settingsFile
    File buildFile

    def setup() {
        settingsFile = new File(testProjectDir, 'settings.gradle')
        buildFile = new File(testProjectDir, 'build.gradle')
    }

    def "can execute hello world task with Gradle version #gradleVersion"() {
        given:
        buildFile &lt;&lt; """
            task helloWorld {
                doLast {
                    logger.quiet 'Hello world!'
                }
            }
        """
        settingsFile &lt;&lt; ""

        when:
        def result = GradleRunner.create()
            .withGradleVersion(gradleVersion)
            .withProjectDir(testProjectDir)
            .withArguments('helloWorld')
            .build()

        then:
        result.output.contains('Hello world!')
        result.task(":helloWorld").outcome == SUCCESS

        where:
        gradleVersion &lt;&lt; ['5.0', '6.0.1']
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:test-kit-compatibility"><a class="anchor" href="#sub:test-kit-compatibility"></a><a class="link" href="#sub:test-kit-compatibility">Feature support when testing with different Gradle versions</a></h5>
<div class="paragraph">
<p>It is possible to use the GradleRunner to execute builds with Gradle 1.0 and later. However, some runner features are not supported on earlier versions. In such cases, the runner will throw an exception when attempting to use the feature.</p>
</div>
<div class="paragraph">
<p>The following table lists the features that are sensitive to the Gradle version being used.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 4. Gradle version compatibility</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Minimum Version</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting executed tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting the executed tasks, using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/BuildResult.html#getTasks--">BuildResult.getTasks()</a> and similar methods.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-classpath-injection">Plugin classpath injection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injecting the code under test via<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath-java.lang.Iterable-">GradleRunner.withPluginClasspath(java.lang.Iterable)</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-debug">Inspecting build output in debug mode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting the build&#8217;s text output when run in debug mode, using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/BuildResult.html#getOutput--">BuildResult.getOutput()</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-automatic-classpath-injection">Automatic plugin classpath injection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injecting the code under test automatically via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath--">GradleRunner.withPluginClasspath()</a> by applying the Java Gradle Plugin Development plugin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting environment variables to be used by the build.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Gradle Tooling API only supports setting environment variables in later versions.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-debug"><a class="anchor" href="#sub:test-kit-debug"></a><a class="link" href="#sub:test-kit-debug">Debugging build logic</a></h4>
<div class="paragraph">
<p>The runner uses the <a href="#embedding">Tooling API</a> to execute builds. An implication of this is that the builds are executed in a separate process (i.e. not the same process executing the tests). Therefore, executing your <em>tests</em> in debug mode does not allow you to debug your build logic as you may expect. Any breakpoints set in your IDE will be not be tripped by the code being exercised by the test build.</p>
</div>
<div class="paragraph">
<p>The TestKit provides two different ways to enable the debug mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting &#8220;org.gradle.testkit.debug&#8221; system property to <code>true</code> for the JVM <em>using</em> the <code>GradleRunner</code> (i.e. not the build being executed with the runner);</p>
</li>
<li>
<p>Calling the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withDebug-boolean-">GradleRunner.withDebug(boolean)</a> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The system property approach can be used when it is desirable to enable debugging support without making an adhoc change to the runner configuration. Most IDEs offer the capability to set JVM system properties for test execution, and such a feature can be used to set this system property.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-build-cache"><a class="anchor" href="#sub:test-kit-build-cache"></a><a class="link" href="#sub:test-kit-build-cache">Testing with the Build Cache</a></h4>
<div class="paragraph">
<p>To enable the <a href="#build_cache">Build Cache</a> in your tests, you can pass the <code>--build-cache</code> argument to <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html">GradleRunner</a> or use one of the other methods described in <a href="#sec:build_cache_enable">Enable the build cache</a>. You can then check for the task outcome <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/TaskOutcome.html#FROM_CACHE">TaskOutcome.FROM_CACHE</a> when your plugin&#8217;s custom task is cached. This outcome is only valid for Gradle 3.5 and newer.</p>
</div>
<div class="sect4">
<h5 id="example_testing_cacheable_tasks"><a class="anchor" href="#example_testing_cacheable_tasks"></a><a class="link" href="#example_testing_cacheable_tasks">Example: Testing cacheable tasks</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def "cacheableTask is loaded from cache"() {
    given:
    buildFile &lt;&lt; """
        plugins {
            id 'org.gradle.sample.helloworld'
        }
    """

    when:
    def result = runner()
        .withArguments( '--build-cache', 'cacheableTask')
        .build()

    then:
    result.task(":cacheableTask").outcome == SUCCESS

    when:
    new File(testProjectDir, 'build').deleteDir()
    result = runner()
        .withArguments( '--build-cache', 'cacheableTask')
        .build()

    then:
    result.task(":cacheableTask").outcome == FROM_CACHE
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that TestKit re-uses a Gradle User Home between tests (see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html#withTestKitDir-java.io.File-">GradleRunner.withTestKitDir(java.io.File)</a>) which contains the default location for the local build cache.
For testing with the build cache, the build cache directory should be cleaned between tests.
The easiest way to accomplish this is to configure the local build cache to use a temporary directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_clean_build_cache_between_tests"><a class="anchor" href="#example_clean_build_cache_between_tests"></a><a class="link" href="#example_clean_build_cache_between_tests">Example: Clean build cache between tests</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@TempDir File testProjectDir
File buildFile
File localBuildCacheDirectory

def setup() {
    localBuildCacheDirectory = new File(testProjectDir, 'local-cache')
    buildFile = new File(testProjectDir,'settings.gradle') &lt;&lt; """
        buildCache {
            local {
                directory = '${localBuildCacheDirectory.toURI()}'
            }
        }
    """
    buildFile = new File(testProjectDir,'build.gradle')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ant"><a class="anchor" href="#ant"></a><a class="link" href="#ant">Using Ant from Gradle</a></h3>
<div class="paragraph">
<p>Gradle provides integration with Ant.</p>
</div>
<div class="paragraph">
<p>Gradle integrates with Ant, allowing you to use individual Ant tasks or entire Ant builds in your Gradle builds.
Using Ant tasks in a Gradle build script is often easier and more powerful than using Ant&#8217;s XML format.
Gradle can also be used as a powerful Ant task scripting tool.</p>
</div>
<div class="paragraph">
<p>Ant can be divided into two layers:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Layer 1: The Ant language</strong>. It provides the syntax for the <code>build.xml</code> file, the handling of the targets, special constructs like macrodefs, and more. In other words, this layer includes everything except the Ant tasks and types. Gradle understands this language and lets you import your Ant <code>build.xml</code> directly into a Gradle project. You can then use the targets of your Ant build as if they were Gradle tasks.</p>
</li>
<li>
<p><strong>Layer 2: The Ant tasks and types</strong>, like <code>javac</code>, <code>copy</code> or <code>jar</code>. For this layer, Gradle provides integration using Groovy and the <code>AntBuilder</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Since build scripts are Kotlin or Groovy scripts, you can execute an Ant build as an external process.
Your build script may contain statements like: <code>"ant clean compile".execute()</code>.<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
<div class="paragraph">
<p>Gradle&#8217;s Ant integration allows you to migrate your build from Ant to Gradle smoothly:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Begin by importing your existing Ant build.</p>
</li>
<li>
<p>Then, transition your dependency declarations from the Ant script to your build file.</p>
</li>
<li>
<p>Finally, move your tasks to your build file or replace them with Gradle&#8217;s plugins.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This migration process can be performed incrementally, and you can maintain a functional Gradle build throughout the transition.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Ant integration is not fully compatible with the <a href="#config_cache">configuration cache</a>.
Using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#getAnt--">Task.ant</a> to run Ant task in the task action may work, but importing the Ant build is not supported.
As a result, the configuration cache is automatically disabled when importing an Ant build.
</td>
</tr>
</table>
</div>
<div id="sec:ant_api" class="paragraph">
<p>The Ant integration is provided by the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/AntBuilder.html">AntBuilder API</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:using_ant_tasks"><a class="anchor" href="#sec:using_ant_tasks"></a><a class="link" href="#sec:using_ant_tasks">Using Ant tasks and types</a></h4>
<div class="paragraph">
<p>Gradle provides a property called <code>ant</code> in your build script.
This is a reference to an <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/AntBuilder.html">AntBuilder</a> instance.</p>
</div>
<div class="paragraph">
<p><code>AntBuilder</code> is used to access Ant tasks, types, and properties from your build script.</p>
</div>
<div class="paragraph">
<p>You execute an Ant task by calling a method on the <code>AntBuilder</code> instance.
You use the task name as the method name:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.mkdir(dir: "$STAGE")
ant.copy(todir: "$STAGE/bin") {
    ant.fileset(dir: 'bin', includes: "**")
}
ant.gzip(destfile:"build/file-${VERSION}.tar.gz", src: "build/file-${VERSION}.tar")</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, you execute the Ant <code>echo</code> task using the <code>ant.echo()</code> method.</p>
</div>
<div class="paragraph">
<p>The attributes of the Ant task are passed as Map parameters to the method.
Below is an example of the <code>echo</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("hello") {
    doLast {
        val greeting = "hello from Ant"
        ant.withGroovyBuilder {
            "echo"("message" to greeting)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('hello') {
    doLast {
        String greeting = 'hello from Ant'
        ant.echo(message: greeting)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :hello
[ant:echo] hello from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can mix Groovy/Kotlin code and the Ant task markup. This can be extremely powerful.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You pass nested text to an Ant task as a parameter of the task method call.
In this example, we pass the message for the <code>echo</code> task as nested text:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("hello") {
    doLast {
        ant.withGroovyBuilder {
            "echo"("message" to "hello from Ant")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('hello') {
    doLast {
        ant.echo('hello from Ant')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :hello
[ant:echo] hello from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You pass nested elements to an Ant task inside a closure.
Nested elements are defined in the same way as tasks by calling a method with the same name as the element we want to define:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("zip") {
    doLast {
        ant.withGroovyBuilder {
            "zip"("destfile" to "archive.zip") {
                "fileset"("dir" to "src") {
                    "include"("name" to "**.xml")
                    "exclude"("name" to "**.java")
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('zip') {
    doLast {
        ant.zip(destfile: 'archive.zip') {
            fileset(dir: 'src') {
                include(name: '**.xml')
                exclude(name: '**.java')
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can access Ant types the same way you access tasks, using the name of the type as the method name.
The method call returns the Ant data type, which you can use directly in your build script.
In the following example, we create an Ant <code>path</code> object, then iterate over the contents of it:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">import org.apache.tools.ant.types.Path

tasks.register("list") {
    doLast {
        val path = ant.withGroovyBuilder {
            "path" {
                "fileset"("dir" to "libs", "includes" to "*.jar")
            }
        } as Path
        path.list().forEach {
            println(it)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('list') {
    doLast {
        def path = ant.path {
            fileset(dir: 'libs', includes: '*.jar')
        }
        path.list().each {
            println it
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_custom_ant_tasks"><a class="anchor" href="#sec:using_custom_ant_tasks"></a><a class="link" href="#sec:using_custom_ant_tasks">Using custom Ant tasks</a></h5>
<div class="paragraph">
<p>To make custom tasks available in your build, use the <code>taskdef</code> (usually easier) or <code>typedef</code> Ant task, just as you would in a <code>build.xml</code> file.
You can then refer to the custom Ant task as you would a built-in Ant task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("check") {
    val checkstyleConfig = file("checkstyle.xml")
    doLast {
        ant.withGroovyBuilder {
            "taskdef"("resource" to "com/puppycrawl/tools/checkstyle/ant/checkstyle-ant-task.properties") {
                "classpath" {
                    "fileset"("dir" to "libs", "includes" to "*.jar")
                }
            }
            "checkstyle"("config" to checkstyleConfig) {
                "fileset"("dir" to "src")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('check') {
    def checkstyleConfig = file('checkstyle.xml')
    doLast {
        ant.taskdef(resource: 'com/puppycrawl/tools/checkstyle/ant/checkstyle-ant-task.properties') {
            classpath {
                fileset(dir: 'libs', includes: '*.jar')
            }
        }
        ant.checkstyle(config: checkstyleConfig) {
            fileset(dir: 'src')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use Gradle&#8217;s dependency management to assemble the classpath for the custom tasks.
To do this, you need to define a custom configuration for the classpath and add some dependencies to it.
This is described in more detail in <a href="declaring_dependencies.html">Declaring Dependencies</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val pmd = configurations.create("pmd")

dependencies {
    pmd("pmd:pmd:4.2.5")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    pmd
}

dependencies {
    pmd("pmd:pmd:4.2.5")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To use the classpath configuration, use the <code>asPath</code> property of the custom configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("check") {
    doLast {
        ant.withGroovyBuilder {
            "taskdef"("name" to "pmd",
                      "classname" to "net.sourceforge.pmd.ant.PMDTask",
                      "classpath" to pmd.asPath)
            "pmd"("shortFilenames" to true,
                  "failonruleviolation" to true,
                  "rulesetfiles" to file("pmd-rules.xml").toURI().toString()) {
                "formatter"("type" to "text", "toConsole" to "true")
                "fileset"("dir" to "src")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('check') {
    doLast {
        ant.taskdef(name: 'pmd',
                    classname: 'net.sourceforge.pmd.ant.PMDTask',
                    classpath: configurations.pmd.asPath)
        ant.pmd(shortFilenames: 'true',
                failonruleviolation: 'true',
                rulesetfiles: file('pmd-rules.xml').toURI().toString()) {
            formatter(type: 'text', toConsole: 'true')
            fileset(dir: 'src')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:import_ant_build"><a class="anchor" href="#sec:import_ant_build"></a><a class="link" href="#sec:import_ant_build">Importing an Ant build</a></h4>
<div class="paragraph">
<p>You can use the <code>ant.importBuild()</code> method to import an Ant build into your Gradle project.</p>
</div>
<div class="paragraph">
<p>When you import an Ant build, each Ant target is treated as a Gradle task.
This means you can manipulate and execute the Ant targets in the same way as Gradle tasks:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.importBuild("build.xml")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.importBuild 'build.xml'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
    &lt;target name="hello"&gt;
        &lt;echo&gt;Hello, from Ant&lt;/echo&gt;
    &lt;/target&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can add a task that depends on an Ant target:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.importBuild("build.xml")

tasks.register("intro") {
    dependsOn("hello")
    doLast {
        println("Hello, from Gradle")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.importBuild 'build.xml'

tasks.register('intro') {
    dependsOn("hello")
    doLast {
        println 'Hello, from Gradle'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle intro

&gt; Task :hello
[ant:echo] Hello, from Ant

&gt; Task :intro
Hello, from Gradle

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Or, you can add behavior to an Ant target:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.importBuild("build.xml")

tasks.named("hello") {
    doLast {
        println("Hello, from Gradle")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.importBuild 'build.xml'

hello {
    doLast {
        println 'Hello, from Gradle'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :hello
[ant:echo] Hello, from Ant
Hello, from Gradle

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible for an Ant target to depend on a Gradle task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.importBuild("build.xml")

tasks.register("intro") {
    doLast {
        println("Hello, from Gradle")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.importBuild 'build.xml'

tasks.register('intro') {
    doLast {
        println 'Hello, from Gradle'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
    &lt;target name="hello" depends="intro"&gt;
        &lt;echo&gt;Hello, from Ant&lt;/echo&gt;
    &lt;/target&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :intro
Hello, from Gradle

&gt; Task :hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes, it may be necessary to "rename" the task generated for an Ant target to avoid a naming collision with existing Gradle tasks.
To do this, use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/AntBuilder.html#importBuild-java.lang.Object-org.gradle.api.Transformer-">AntBuilder.importBuild(java.lang.Object, org.gradle.api.Transformer)</a> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.importBuild("build.xml") { antTargetName -&gt;
    "a-" + antTargetName
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.importBuild('build.xml') { antTargetName -&gt;
    'a-' + antTargetName
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
    &lt;target name="hello"&gt;
        &lt;echo&gt;Hello, from Ant&lt;/echo&gt;
    &lt;/target&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle a-hello

&gt; Task :a-hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While the second argument to this method should be a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Transformer.html">Transformer</a>, when programming in Groovy you can use a closure instead of an anonymous inner class (or similar) due to <a href="http://mrhaki.blogspot.ie/2013/11/groovy-goodness-implicit-closure.html">Groovy&#8217;s support for automatically coercing closures to single-abstract-method types</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:ant_properties"><a class="anchor" href="#sec:ant_properties"></a><a class="link" href="#sec:ant_properties">Using Ant properties and references</a></h4>
<div class="paragraph">
<p>There are several ways to set an Ant property so that the property can be used by Ant tasks.</p>
</div>
<div class="paragraph">
<p>You can set the property directly on the <code>AntBuilder</code> instance.
The Ant properties are also available as a Map, which you can change.</p>
</div>
<div class="paragraph">
<p>You can also use the Ant <code>property</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.setProperty("buildDir", buildDir)
ant.properties.set("buildDir", buildDir)
ant.properties["buildDir"] = buildDir
ant.withGroovyBuilder {
    "property"("name" to "buildDir", "location" to "buildDir")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.buildDir = buildDir
ant.properties.buildDir = buildDir
ant.properties['buildDir'] = buildDir
ant.property(name: 'buildDir', location: buildDir)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Many Ant tasks set properties when they execute.
There are several ways to get the value of these properties.
You can get the property directly from the <code>AntBuilder</code> instance.
The Ant properties are also available as a Map:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="antProp" value="a property defined in an Ant build"/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">println(ant.getProperty("antProp"))
println(ant.properties.get("antProp"))
println(ant.properties["antProp"])</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">println ant.antProp
println ant.properties.antProp
println ant.properties['antProp']</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There are several ways to set an Ant reference:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.withGroovyBuilder { "path"("id" to "classpath", "location" to "libs") }
ant.references.set("classpath", ant.withGroovyBuilder { "path"("location" to "libs") })
ant.references["classpath"] = ant.withGroovyBuilder { "path"("location" to "libs") }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.path(id: 'classpath', location: 'libs')
ant.references.classpath = ant.path(location: 'libs')
ant.references['classpath'] = ant.path(location: 'libs')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;path refid="classpath"/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There are several ways to get an Ant reference:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;path id="antPath" location="libs"/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">println(ant.references.get("antPath"))
println(ant.references["antPath"])</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">println ant.references.antPath
println ant.references['antPath']</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ant_logging"><a class="anchor" href="#sec:ant_logging"></a><a class="link" href="#sec:ant_logging">Using Ant logging</a></h4>
<div class="paragraph">
<p>Gradle maps Ant message priorities to Gradle log levels so that messages logged from Ant appear in the Gradle output.
By default, these are mapped as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ant Message Priority</th>
<th class="tableblock halign-left valign-top">Gradle Log Level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>VERBOSE</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DEBUG</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>DEBUG</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DEBUG</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>INFO</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INFO</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>WARN</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WARN</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>ERROR</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ERROR</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="sec:fine_tuning_ant_logging"><a class="anchor" href="#sec:fine_tuning_ant_logging"></a><a class="link" href="#sec:fine_tuning_ant_logging">Fine-tuning Ant logging</a></h5>
<div class="paragraph">
<p>The default mapping of Ant message priority to the Gradle log level can sometimes be problematic.
For example, no message priority maps directly to the <code>LIFECYCLE</code> log level, which is the default for Gradle.
Many Ant tasks log messages at the <em>INFO</em> priority, which means to expose those messages from Gradle, a build would have to be run with the log level set to <code>INFO</code>, potentially logging much more output than is desired.</p>
</div>
<div class="paragraph">
<p>Conversely, if an Ant task logs messages at too high of a level, suppressing those messages would require the build to be run at a higher log level, such as <code>QUIET.</code>
However, this could result in other desirable outputs being suppressed.</p>
</div>
<div class="paragraph">
<p>To help with this, Gradle allows the user to fine-tune the Ant logging and control the mapping of message priority to the Gradle log level.
This is done by setting the priority that should map to the default Gradle <code>LIFECYCLE</code> log level using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/AntBuilder.html#setLifecycleLogLevel-java.lang.String-">AntBuilder.setLifecycleLogLevel(java.lang.String)</a> method.
When this value is set, any Ant message logged at the configured priority or above will be logged at least at <code>LIFECYCLE</code>.
Any Ant message logged below this priority will be logged at <code>INFO</code> at most.</p>
</div>
<div class="paragraph">
<p>For example, the following changes the mapping such that Ant <em>INFO</em> priority messages are exposed at the <code>LIFECYCLE</code> log level:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">ant.lifecycleLogLevel = AntBuilder.AntMessagePriority.INFO

tasks.register("hello") {
    doLast {
        ant.withGroovyBuilder {
            "echo"("level" to "info", "message" to "hello from info priority!")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ant.lifecycleLogLevel = "INFO"

tasks.register('hello') {
    doLast {
        ant.echo(level: "info", message: "hello from info priority!")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle hello

&gt; Task :hello
[ant:echo] hello from info priority!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, if the <code>lifecycleLogLevel</code> was set to <em>ERROR</em>, Ant messages logged at the <em>WARN</em> priority would no longer be logged at the <code>WARN</code> log level.
They would now be logged at the <code>INFO</code> level and suppressed by default.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:optimizing_build_times"><a class="anchor" href="#part:optimizing_build_times"></a><a class="link" href="#part:optimizing_build_times">OPTIMIZING BUILD PERFORMANCE</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="performance_gradle"><a class="anchor" href="#performance_gradle"></a><a class="link" href="#performance_gradle">Improve the Performance of Gradle Builds</a></h3>
<div class="paragraph">
<p>Build performance is essential to productivity.
The longer a build takes, the more it disrupts your development flow.
Since builds run many times a day, even small delays add up.
The same applies to Continuous Integration (CI).</p>
</div>
<div class="paragraph">
<p>Investing in build speed pays off.
This section explores ways to optimize performance, highlights common pitfalls, and explains how to avoid them.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Recommendation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:update-versions">Update Versions</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:enable_parallel_execution">Enable Parallel Execution</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#enable_daemon">Enable the Daemon</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#enable_build_cache">Enable the Build Cache</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#enable_configuration_cache">Enable the Configuration Cache</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#enable_inc_builds_custom_tasks">Enable Incremental Build for Custom Tasks</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#enable_specific_dev_workflows">Create Builds for specific Developer Workflows</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#increase_heap_size">Increase Heap Size</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#optimize_configuration">Optimize Configuration</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#optimize_dependency_resolution">Optimize Dependency Resolution</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#optimize_java_projects">Optimize Java Projects</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#optimize_android_projects">Optimize Android Projects</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#improve_older_projects">Improve Older Gradle Releases</a></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="0_inspect_your_build"><a class="anchor" href="#0_inspect_your_build"></a><a class="link" href="#0_inspect_your_build">0. Inspect your Build</a></h4>
<div class="paragraph">
<p>Before making any changes, <a href="#inspecting_build_scans">inspect your build</a> with a <a href="https://gradle.com/develocity/product/build-scan/"><strong>Build Scan</strong></a> or <strong>profile report</strong>.
A thorough inspection helps you understand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Total build time</strong></p>
</li>
<li>
<p><strong>Which parts of the build are slow</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This provides a baseline to measure the impact of optimizations.</p>
</div>
<div class="paragraph">
<p>To get the most value from this page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inspect your build.</p>
</li>
<li>
<p>Apply a change.</p>
</li>
<li>
<p>Inspect your build again.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the change improves build times, keep it.
If it doesnt, revert the change and try another approach.</p>
</div>
<div class="paragraph">
<p>For reference, the following Build Scan snapshot is a build of a project created using <code>gradle init</code>.
It is a Java (JDK 21) <code>Application and library project</code> using Kotlin build files:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-1.png" alt="performance 1">
</div>
</div>
<div class="paragraph">
<p>It builds in <strong>21 seconds</strong> using Gradle 8.10.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:update-versions"><a class="anchor" href="#sec:update-versions"></a><a class="link" href="#sec:update-versions">1. Update Versions</a></h4>
<div class="sect4">
<h5 id="update_gradle"><a class="anchor" href="#update_gradle"></a><a class="link" href="#update_gradle">Gradle</a></h5>
<div class="paragraph">
<p>Each Gradle release brings performance improvements.
Using an outdated version means missing out on these gains.
Upgrading is low-risk since Gradle maintains backward compatibility between minor versions.
Staying up to date also makes major version upgrades smoother by providing early deprecation warnings.</p>
</div>
<div class="paragraph">
<p>You can use the <a href="#gradle_wrapper">Gradle Wrapper</a> to update the version of Gradle by running <code>gradle wrapper --gradle-version X.X</code> where <code>X.X</code> is the desired version.</p>
</div>
<div class="paragraph">
<p>When our reference project is updated to use Gradle 8.13, the build (<code>./gradlew clean build</code>) takes <strong>8 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-2.png" alt="performance 2">
</div>
</div>
</div>
<div class="sect4">
<h5 id="java"><a class="anchor" href="#java"></a><a class="link" href="#java">Java</a></h5>
<div class="paragraph">
<p>Gradle runs on the Java Virtual Machine (JVM), and Java updates often enhance performance.
To get the best Gradle performance, use the latest Java version.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Don&#8217;t forget to check out <a href="#compatibility">compatibility guide</a> to make sure your version of Java is compatible with your version of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="plugins"><a class="anchor" href="#plugins"></a><a class="link" href="#plugins">Plugins</a></h5>
<div class="paragraph">
<p>Plugins play a key role in build performance.
Outdated plugins can slow down your build, while newer versions often include optimizations.
This is especially true for the Android, Java, and Kotlin plugins. Keep them up to date for the best performance.</p>
</div>
<div class="paragraph">
<p>Simply look at all the declared plugins in your project and check if a newer version is available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.jlleitschuh.gradle.ktlint") version "12.0.0" // A newer version is available on the Gradle Plugin Portal
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:enable_parallel_execution"><a class="anchor" href="#sec:enable_parallel_execution"></a><a class="link" href="#sec:enable_parallel_execution">2. Enable Parallel Execution</a></h4>
<div class="paragraph">
<p>Most projects consist of multiple subprojects, some of which are independent.
However, by default, Gradle runs only one task at a time.</p>
</div>
<div class="paragraph">
<p>To execute tasks from different subprojects in parallel, use the <code>--parallel</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --parallel</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable parallel execution by default, add this setting to <code>gradle.properties</code> in the <a href="#directory_layout">project root or your Gradle home directory</a>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.parallel=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Parallel builds can significantly improve build times, but the impact depends on your projects structure and inter-subproject dependencies.
If a single subproject dominates execution time or there are many dependencies between subprojects, the benefits will be minimal.
However, most multi-project builds see a noticeable reduction in build time.</p>
</div>
<div class="paragraph">
<p>When the parallel flag is used on our reference project, the build (<code>./gradlew clean build --parallel</code>) time is <strong>7 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-3.png" alt="performance 3">
</div>
</div>
<div class="sect4">
<h5 id="visualize_parallelism_with_build_scan"><a class="anchor" href="#visualize_parallelism_with_build_scan"></a><a class="link" href="#visualize_parallelism_with_build_scan">Visualize Parallelism with Build Scan</a></h5>
<div class="paragraph">
<p>A Build Scan provides a visual timeline of task execution in the <strong>"Timeline"</strong> tab.</p>
</div>
<div class="paragraph">
<p>In the example below, the build initially has long-running tasks at the beginning and end, creating a bottleneck:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/parallel-task-slow.png" alt="parallel task slow">
</div>
<div class="title">Figure 6. Bottleneck in parallel execution</div>
</div>
<div class="paragraph">
<p>By adjusting the build configuration to run these two slow tasks earlier and in parallel, the overall build time is reduced from <strong>8 seconds</strong> to <strong>5 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/parallel-task-fast.png" alt="parallel task fast">
</div>
<div class="title">Figure 7. Optimized parallel execution</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enable_daemon"><a class="anchor" href="#enable_daemon"></a><a class="link" href="#enable_daemon">3. Re-enable the Gradle Daemon</a></h4>
<div class="paragraph">
<p>The Gradle Daemon significantly reduces build times by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Caching project information across builds</p>
</li>
<li>
<p>Running in the background to avoid JVM startup delays</p>
</li>
<li>
<p>Benefiting from continuous JVM runtime optimizations</p>
</li>
<li>
<p>Watching the file system to determine what needs to be rebuilt</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle enables the Daemon by default, but some builds override this setting.
If your build disables it, enabling the Daemon can lead to substantial performance improvements.</p>
</div>
<div class="paragraph">
<p>To enable the Daemon at build time, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --daemon</code></pre>
</div>
</div>
<div class="paragraph">
<p>For older Gradle versions, enable it permanently by adding this to <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.daemon=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>On developer machines, enabling the Daemon improves performance.
On CI machines, long-lived agents benefit, but short-lived ones may not.
Since Gradle 3.0, Daemons automatically shut down under memory pressure, making it safe to keep the Daemon enabled.</p>
</div>
<div class="paragraph">
<p>When the daemon is used on our reference project, the build (<code>./gradlew clean build --daemon</code>) time is <strong>3 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-4.png" alt="performance 4">
</div>
</div>
</div>
<div class="sect3">
<h4 id="enable_build_cache"><a class="anchor" href="#enable_build_cache"></a><a class="link" href="#enable_build_cache">4. Enable the Build Cache</a></h4>
<div class="paragraph">
<p>The Gradle Build Cache optimizes performance by storing task outputs for specific inputs.
If a task runs again with the same inputs, Gradle retrieves the cached output instead of re-executing the task.</p>
</div>
<div class="paragraph">
<p>By default, Gradle does not use the Build Cache.
To enable it at build time, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --build-cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable it permanently, add this to <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.caching=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A local Build Cache to speed up repeated builds on the same machine.</p>
</li>
<li>
<p>A shared Build Cache to accelerate builds across multiple machines.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.com/build-cache/">Develocity provides</a> a shared Cache solution for CI and developer builds.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the build cache flag is used on our reference project, the build (<code>./gradlew clean build --build-cache</code>) time is <strong>5 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-5.png" alt="performance 5">
</div>
</div>
<div class="paragraph">
<p>For more information about the Build Cache, check out the
<a href="#use_cases_cache">Build Cache documentation</a>.</p>
</div>
<div class="sect4">
<h5 id="visualize_the_build_cache_with_build_scan"><a class="anchor" href="#visualize_the_build_cache_with_build_scan"></a><a class="link" href="#visualize_the_build_cache_with_build_scan">Visualize the Build Cache with Build Scan</a></h5>
<div class="paragraph">
<p>A Build Scan helps you analyze <strong>Build Cache effectiveness</strong> through the <strong>"Build Cache"</strong> tab in the <strong>"Performance"</strong> page.
This tab provides key statistics, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of tasks that interacted with a cache</p>
</li>
<li>
<p>Which cache was used</p>
</li>
<li>
<p>Transfer and pack/unpack rates for cached entries</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/cache-performance.png" alt="cache performance">
</div>
<div class="title">Figure 8. Inspecting the performance of the build cache for a build</div>
</div>
<div class="paragraph">
<p>The <strong>"Task Execution"</strong> tab offers insights into task cacheability.
Clicking on a category reveals a timeline highlighting tasks in that category:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/task-execution-cacheable.png" alt="task execution cacheable">
</div>
<div class="title">Figure 9. A task-oriented view of performance</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/timeline-not-cacheable.png" alt="timeline not cacheable">
</div>
<div class="title">Figure 10. Timeline screen with 'not cacheable' tasks only</div>
</div>
<div class="paragraph">
<p>To identify optimization opportunities, sort tasks by duration in the timeline view.
The Build Scan above reveals that <code>:task1</code> and <code>:task3</code> could be improved and made cacheable, while also explaining why Gradle didnt cache them.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enable_configuration_cache"><a class="anchor" href="#enable_configuration_cache"></a><a class="link" href="#enable_configuration_cache">5. Enable the Configuration Cache</a></h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature has the following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Not all <a href="#config_cache:plugins:core">core Gradle plugins</a> and <a href="#config_cache:not_yet_implemented">features</a> are supported. Full support is still in progress.</p>
</li>
<li>
<p>Your build and its plugins may need adjustments to meet the <a href="#config_cache:requirements">requirements</a>.</p>
</li>
<li>
<p>IDE imports and syncs do not use the configuration cache.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration cache speeds up builds by caching the results of the configuration phase.
When build configuration inputs remain unchanged, Gradle can skip this phase entirely.</p>
</div>
<div class="paragraph">
<p>Enabling the configuration cache provides further performance benefits.
When enabled, Gradle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executes all tasks in parallel, even within the same subproject.</p>
</li>
<li>
<p>Caches dependency resolution results to avoid redundant computations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Build configuration inputs include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Init scripts</p>
</li>
<li>
<p>Settings scripts</p>
</li>
<li>
<p>Build scripts</p>
</li>
<li>
<p>System and Gradle properties used during configuration</p>
</li>
<li>
<p>Environment variables used during configuration</p>
</li>
<li>
<p>Configuration files accessed via value suppliers (<code>providers</code>)</p>
</li>
<li>
<p><code>buildSrc</code> inputs, including configuration files and source files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, Gradle does not use the configuration cache.
To enable it at build time, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle &lt;task&gt; --configuration-cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable it permanently, add this setting to the <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the configuration cache flag is used on our reference project, the build (<code>./gradlew clean build --build-cache</code>) time is <strong>4 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-6.png" alt="performance 6">
</div>
</div>
<div class="paragraph">
<p>For more details, see the <a href="#config_cache">Configuration Cache documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="enable_inc_builds_custom_tasks"><a class="anchor" href="#enable_inc_builds_custom_tasks"></a><a class="link" href="#enable_inc_builds_custom_tasks">6. Enable Incremental Build for Custom Tasks</a></h4>
<div class="paragraph">
<p>Incremental build is a Gradle optimization that skips tasks that have already executed with the same inputs.
If a tasks inputs and outputs have not changed since the last execution, Gradle will skip that task.</p>
</div>
<div class="paragraph">
<p>Most built-in Gradle tasks support incremental builds.
To make a custom task compatible, you must specify its inputs and outputs:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("processTemplatesAdHoc") {
    inputs.property("engine", TemplateEngineType.FREEMARKER)
    inputs.files(fileTree("src/templates"))
        .withPropertyName("sourceFiles")
        .withPathSensitivity(PathSensitivity.RELATIVE)
    inputs.property("templateData.name", "docs")
    inputs.property("templateData.variables", mapOf("year" to "2013"))
    outputs.dir(layout.buildDirectory.dir("genOutput2"))
        .withPropertyName("outputDir")

    doLast {
        // Process the templates here
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('processTemplatesAdHoc') {
    inputs.property('engine', TemplateEngineType.FREEMARKER)
    inputs.files(fileTree('src/templates'))
        .withPropertyName('sourceFiles')
        .withPathSensitivity(PathSensitivity.RELATIVE)
    inputs.property('templateData.name', 'docs')
    inputs.property('templateData.variables', [year: '2013'])
    outputs.dir(layout.buildDirectory.dir('genOutput2'))
        .withPropertyName('outputDir')

    doLast {
        // Process the templates here
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more details, see the <a href="incremental_build.html#incremental_build">incremental build documentation</a> and the <a href="writing_tasks_intermediate.html#task_inputs_and_outputs">writing tasks tutorial</a>.</p>
</div>
<div class="paragraph">
<p>When leveraging incremental builds on our reference project, the build (<code>./gradlew clean build build</code>) time is <strong>5 seconds</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/performance-7.png" alt="performance 7">
</div>
</div>
<div class="sect4">
<h5 id="visualize_incremental_builds_with_build_scan_timelines"><a class="anchor" href="#visualize_incremental_builds_with_build_scan_timelines"></a><a class="link" href="#visualize_incremental_builds_with_build_scan_timelines">Visualize Incremental Builds with Build Scan Timelines</a></h5>
<div class="paragraph">
<p>Look at the Build Scan <strong>"Timeline"</strong> view to identify tasks that could benefit from incremental builds.
This helps you understand why tasks execute when you expect Gradle to skip them.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/timeline.png" alt="timeline">
</div>
<div class="title">Figure 11. The timeline view can help with incremental build inspection</div>
</div>
<div class="paragraph">
<p>In the example above, the task was <strong>not up-to-date</strong> because one of its inputs (<strong>"timestamp"</strong>) changed, forcing it to re-run.</p>
</div>
<div class="paragraph">
<p>To optimize your build, <strong>sort tasks by duration</strong> to identify the slowest tasks in your project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enable_specific_dev_workflows"><a class="anchor" href="#enable_specific_dev_workflows"></a><a class="link" href="#enable_specific_dev_workflows">7. Create Builds for Specific Developer Workflows</a></h4>
<div class="paragraph">
<p>The fastest task is one that doesnt run.
By skipping unnecessary tasks, you can significantly improve build performance.</p>
</div>
<div class="paragraph">
<p>If your build includes multiple subprojects, define tasks that build them independently.
This maximizes caching efficiency and prevents changes in one subproject from triggering unnecessary rebuilds in others.
It also helps teams working on different subprojects avoid redundant buildsfor example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Front-end developers</strong> dont need to build back-end subprojects every time they modify the front-end.</p>
</li>
<li>
<p><strong>Documentation writers</strong> dont need to build front-end or back-end code, even if the documentation is in the same project.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Instead, create <strong>developer-specific tasks</strong> while maintaining a single task graph for the entire project.
Each group of users requires a subset of tasksconvert that subset into a Gradle workflow that excludes unnecessary tasks.</p>
</div>
<div class="paragraph">
<p>Gradle provides several features to create efficient workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Assign tasks to appropriate</strong> <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">groups</a>.</p>
</li>
<li>
<p><strong>Create aggregate tasks</strong>tasks with no action that depend on other tasks (e.g., <code>assemble</code>).</p>
</li>
<li>
<p><strong>Defer configuration</strong> using <code>gradle.taskGraph.whenReady()</code> to execute verification only when necessary.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="increase_heap_size"><a class="anchor" href="#increase_heap_size"></a><a class="link" href="#increase_heap_size">8. Increase the Heap Size</a></h4>
<div class="paragraph">
<p>By default, Gradle reserves <strong>512MB</strong> of heap space for your build, which is sufficient for most projects.</p>
</div>
<div class="paragraph">
<p>However, very large builds may require more memory to store Gradle&#8217;s model and caches.
If needed, you can increase the heap size by specifying the following property in the <code>gradle.properties</code> file in your <a href="#directory_layout">project root or your Gradle home directory</a>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.jvmargs=-Xmx2048M</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see the <a href="config_gradle.html#sec:configuring_jvm_memory">JVM Memory Configuration</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="optimize_configuration"><a class="anchor" href="#optimize_configuration"></a><a class="link" href="#optimize_configuration">9. Optimize Configuration</a></h4>
<div class="paragraph">
<p>As described in <a href="build_lifecycle_intermediate.html#build_lifecycle">the build lifecycle chapter</a>, a Gradle build goes through three phases: <strong>initialization, configuration, and execution</strong>.
The <strong>configuration phase</strong> always executes, regardless of which tasks run.
Any expensive operations during this phase slow down every build, including simple commands like <code>gradle help</code> and <code>gradle tasks</code>.</p>
</div>
<div class="paragraph">
<p>The following sections introduce techniques to reduce time spent in the configuration phase.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also <a href="#enable_configuration_cache">enable the configuration cache</a> to minimize the impact of a slow configuration phase. However, even with caching, the configuration phase still runs occasionally. Optimizing it remains crucial.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="avoid_expensive_or_blocking_work"><a class="anchor" href="#avoid_expensive_or_blocking_work"></a><a class="link" href="#avoid_expensive_or_blocking_work">Avoid Expensive or Blocking Work</a></h5>
<div class="paragraph">
<p>Time-consuming work should be avoided in the configuration phase.
However, it can sometimes sneak in unexpectedly.</p>
</div>
<div class="paragraph">
<p>While encrypting data or making remote service calls is obvious when done in a build script, such logic is often hidden inside plugins or custom task classes.
Expensive operations in a plugins <code>apply()</code> method or a task&#8217;s constructor are a red flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class ExpensivePlugin implements Plugin&lt;Project&gt; {
    @Override
    void apply(Project project) {
        //  BAD: Makes an expensive network call at configuration time
        def response = new URL("https://example.com/dependencies.json").text
        def dependencies = new groovy.json.JsonSlurper().parseText(response)

        dependencies.each { dep -&gt;
            project.dependencies.add("implementation", dep)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class OptimizedPlugin implements Plugin&lt;Project&gt; {
    @Override
    void apply(Project project) {
        project.tasks.register("fetchDependencies") {
            doLast {
                //  GOOD: Runs only when the task is executed
                def response = new URL("https://example.com/dependencies.json").text
                def dependencies = new groovy.json.JsonSlurper().parseText(response)

                dependencies.each { dep -&gt;
                    project.dependencies.add("implementation", dep)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="only_apply_plugins_where_theyre_needed"><a class="anchor" href="#only_apply_plugins_where_theyre_needed"></a><a class="link" href="#only_apply_plugins_where_theyre_needed">Only Apply Plugins where they&#8217;re needed</a></h5>
<div class="paragraph">
<p>Each applied plugin or script adds to configuration time, with some plugins having a larger impact than others.
Rather than avoiding plugins altogether, ensure they are applied only where necessary.
For example, using <code>allprojects {}</code> or <code>subprojects {}</code> can apply plugins to all subprojects, even if not all need them.</p>
</div>
<div class="paragraph">
<p>In the example below, the root build script applies <code>script-a.gradle</code> to three subprojects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">subprojects {
    apply from: "$rootDir/script-a.gradle"  //  Applied to all subprojects unnecessarily
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/script-a-application.png" alt="script a application">
</div>
<div class="title">Figure 12. Showing the application of script-a.gradle to the build</div>
</div>
<div class="paragraph">
<p>This script takes <strong>1 second</strong> to run per subproject, delaying the configuration phase by <strong>3 seconds</strong> in total.
To optimize this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If only one subproject requires the script, remove it from the others, reducing the configuration delay by <strong>2 seconds</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">project(":subproject1") {
    apply from: "$rootDir/script-a.gradle"  //  Applied only where needed
}

project(":subproject2") {
    apply from: "$rootDir/script-a.gradle"
}</code></pre>
</div>
</div>
</li>
<li>
<p>If multiplebut not allsubprojects use the script, refactor it into a custom plugin inside <a href="#sec:using_buildsrc"><code>buildSrc</code></a> and apply it only to the relevant subprojects. This reduces configuration time and avoids code duplication.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'com.example.my-custom-plugin' apply false  //  Declare the plugin but don't apply it globally
}

project(":subproject1") {
    apply plugin: 'com.example.my-custom-plugin'  //  Apply only where needed
}

project(":subproject2") {
    apply plugin: 'com.example.my-custom-plugin'
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="statically_compile_tasks_and_plugins"><a class="anchor" href="#statically_compile_tasks_and_plugins"></a><a class="link" href="#statically_compile_tasks_and_plugins">Statically Compile Tasks and Plugins</a></h5>
<div class="paragraph">
<p>Many Gradle plugins and tasks are written in Groovy due to its concise syntax, functional APIs, and powerful extensions.
However, Groovys <strong>dynamic interpretation</strong> makes method calls slower than in Java or Kotlin.</p>
</div>
<div class="paragraph">
<p>You can reduce this cost by using <strong>static Groovy compilation</strong>.
Add the <code>@CompileStatic</code> annotation to Groovy classes where dynamic features are unnecessary.
If a method requires dynamic behavior, use <code>@CompileDynamic</code> on that method.</p>
</div>
<div class="paragraph">
<p>Alternatively, consider writing plugins and tasks in <strong>Java or Kotlin</strong>, which are statically compiled by default.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Gradles Groovy DSL relies on Groovys dynamic features. To use static compilation in plugins, adopt a more Java-like syntax.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example below defines a task that copies files without dynamic features:</p>
</div>
<div class="listingblock">
<div class="title">src/main/groovy/MyPlugin.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">project.tasks.register('copyFiles', Copy) { Task t -&gt;
    t.into(project.layout.buildDirectory.dir('output'))
    t.from(project.configurations.getByName('compile'))
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example uses <code>register()</code> and <code>getByName()</code>, available on all Gradle <strong>domain object containers</strong>, such as tasks, configurations, dependencies, and extensions.
Some containers, like <code>TaskContainer</code>, have specialized methods such as <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.TaskContainer.html#org.gradle.api.tasks.TaskContainer:create(java.lang.String,%20java.lang.Class)">create</a>, which accepts a task type.</p>
</div>
<div class="paragraph">
<p>Using static compilation improves IDE support by enabling:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Faster detection of unrecognized types, properties, and methods</p>
</li>
<li>
<p>More reliable auto-completion for method names</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optimize_dependency_resolution"><a class="anchor" href="#optimize_dependency_resolution"></a><a class="link" href="#optimize_dependency_resolution">10. Optimize dependency resolution</a></h4>
<div class="paragraph">
<p>Dependency resolution simplifies integrating third-party libraries into your projects.
Gradle contacts remote servers to discover and download dependencies.
You can optimize how dependencies are referenced to minimize these remote calls.</p>
</div>
<div class="sect4">
<h5 id="avoid_unnecessary_and_unused_dependencies"><a class="anchor" href="#avoid_unnecessary_and_unused_dependencies"></a><a class="link" href="#avoid_unnecessary_and_unused_dependencies">Avoid Unnecessary and Unused Dependencies</a></h5>
<div class="paragraph">
<p>Managing third-party libraries and their transitive dependencies adds significant maintenance and build time costs.
Unused dependencies often remain after refactors.</p>
</div>
<div class="paragraph">
<p>If you only use a small portion of a library, consider:
- Implementing the required functionality yourself.
- Copying the necessary code (with attribution) if the library is open source.</p>
</div>
</div>
<div class="sect4">
<h5 id="optimize_repository_order"><a class="anchor" href="#optimize_repository_order"></a><a class="link" href="#optimize_repository_order">Optimize Repository Order</a></h5>
<div class="paragraph">
<p>Gradle searches repositories in the order they are declared.
To speed up resolution, list the repository hosting most dependencies first, reducing unnecessary network requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()  //  Declared first, but most dependencies are in JitPack
    maven { url "https://jitpack.io" }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="minimize_repository_count"><a class="anchor" href="#minimize_repository_count"></a><a class="link" href="#minimize_repository_count">Minimize Repository Count</a></h5>
<div class="paragraph">
<p>Limit the number of repositories to the minimum required.</p>
</div>
<div class="paragraph">
<p>If using a custom repository, create a <strong>virtual repository</strong> that aggregates multiple repositories, then add only that repository to your build.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven { url "https://repo.mycompany.com/virtual-repo" } //  Uses an aggregated repository
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="minimize_dynamic_and_snapshot_versions"><a class="anchor" href="#minimize_dynamic_and_snapshot_versions"></a><a class="link" href="#minimize_dynamic_and_snapshot_versions">Minimize Dynamic and Snapshot Versions</a></h5>
<div class="paragraph">
<p>Dynamic (<code>"2.+&#8220;) and snapshot versions (&#8221;-SNAPSHOT"</code>) cause Gradle to check remote repositories frequently.
By default, Gradle caches dynamic versions for 24 hours, but this can be configured with the <code>cacheDynamicVersionsFor</code> and <code>cacheChangingModulesFor</code> properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy {
        cacheDynamicVersionsFor 4, 'hours'
        cacheChangingModulesFor 10, 'minutes'
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a build file or initialization script lowers these values, Gradle queries repositories more often.
When you don&#8217;t need the absolute latest release of a dependency every time you build, consider
removing the custom values for these settings.</p>
</div>
<div class="sect5">
<h6 id="find_dynamic_and_changing_versions_with_build_scan"><a class="anchor" href="#find_dynamic_and_changing_versions_with_build_scan"></a><a class="link" href="#find_dynamic_and_changing_versions_with_build_scan">Find dynamic and changing versions with Build Scan</a></h6>
<div class="paragraph">
<p>To locate dynamic dependencies, use a Build Scan:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/dependency-dynamic-versions.png" alt="dependency dynamic versions">
</div>
<div class="title">Figure 13. Find dependencies with dynamic versions</div>
</div>
<div class="paragraph">
<p>Where possible, replace dynamic versions with fixed versions like <code>"1.2"</code> or <code>"3.0.3.GA"</code> for better caching.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="avoid_dependency_resolution_during_configuration"><a class="anchor" href="#avoid_dependency_resolution_during_configuration"></a><a class="link" href="#avoid_dependency_resolution_during_configuration">Avoid dependency resolution during configuration</a></h5>
<div class="paragraph">
<p>Dependency resolution is an I/O-intensive process.
Gradle caches results, but triggering resolution in the <strong>configuration phase</strong> adds unnecessary overhead to every build.</p>
</div>
<div class="paragraph">
<p>This code forces dependency resolution during configuration, slowing down every build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">task printDeps {
    doFirst {
        configurations.compileClasspath.files.each { println it } //  Deferring Dependency Resolution
    }
    doLast {
        configurations.compileClasspath.files.each { println it } //  Resolving Dependencies During Configuration
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="switch_to_declarative_syntax"><a class="anchor" href="#switch_to_declarative_syntax"></a><a class="link" href="#switch_to_declarative_syntax">Switch to declarative syntax</a></h6>
<div class="paragraph">
<p>Evaluating a configuration file during the <strong>configuration phase</strong> forces Gradle to resolve dependencies too early, increasing build times.
Normally, tasks should resolve dependencies only when they need them during execution.</p>
</div>
<div class="paragraph">
<p>Consider a debugging scenario where you want to print all files in a configuration.
A common mistake is to print them directly in the build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyFiles") {
    println("&gt;&gt; Compilation deps: ${configurations.compileClasspath.get().files.map { it.name }}")
    into(layout.buildDirectory.dir("output"))
    from(configurations.compileClasspath)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyFiles', Copy) {
    println "&gt;&gt; Compilation deps: ${configurations.compileClasspath.files.name}"
    into(layout.buildDirectory.dir('output'))
    from(configurations.compileClasspath)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>files</code> property triggers dependency resolution immediately, even if <code>printDeps</code> is never executed.
Since the configuration phase runs on every build, this slows down <strong>all</strong> builds.</p>
</div>
<div class="paragraph">
<p>By using <code>doFirst()</code>, Gradle defers dependency resolution until the task actually runs, preventing unnecessary work in the configuration phase:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Copy&gt;("copyFiles") {
    into(layout.buildDirectory.dir("output"))
    // Store the configuration into a variable because referencing the project from the task action
    // is not compatible with the configuration cache.
    val compileClasspath: FileCollection = configurations.compileClasspath.get()
    from(compileClasspath)
    doFirst {
        println("&gt;&gt; Compilation deps: ${compileClasspath.files.map { it.name }}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('copyFiles', Copy) {
    into(layout.buildDirectory.dir('output'))
    // Store the configuration into a variable because referencing the project from the task action
    // is not compatible with the configuration cache.
    FileCollection compileClasspath = configurations.compileClasspath
    from(compileClasspath)
    doFirst {
        println "&gt;&gt; Compilation deps: ${compileClasspath.files.name}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>from()</code> method in Gradles <code>Copy</code> task does <strong>not</strong> trigger immediate <a href="dependency_configurations.html#sub:what-are-dependency-configurations">dependency resolution</a> because it references the dependency <strong>configuration</strong>, not the resolved files.
This ensures that dependencies are resolved only when the <code>Copy</code> task executes.</p>
</div>
</div>
<div class="sect5">
<h6 id="visualize_dependency_resolution_with_build_scan"><a class="anchor" href="#visualize_dependency_resolution_with_build_scan"></a><a class="link" href="#visualize_dependency_resolution_with_build_scan">Visualize dependency resolution with Build Scan</a></h6>
<div class="paragraph">
<p>The "Dependency resolution" tab on the performance page of a Build Scan shows dependency
resolution time during the configuration and execution phases:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/bad-dependency-resolution.png" alt="bad dependency resolution">
</div>
<div class="title">Figure 14. Dependency resolution at configuration time</div>
</div>
<div class="paragraph">
<p>A Build Scan provides another means of identifying this issue.
Your build should spend 0 seconds resolving dependencies during <em>"project configuration"</em>.
This example shows the build resolves dependencies too early in the lifecycle.
You can also find a "Settings and suggestions" tab on the "Performance" page.
This shows dependencies resolved during the configuration phase.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="remove_or_improve_custom_dependency_resolution_logic"><a class="anchor" href="#remove_or_improve_custom_dependency_resolution_logic"></a><a class="link" href="#remove_or_improve_custom_dependency_resolution_logic">Remove or improve custom dependency resolution logic</a></h5>
<div class="paragraph">
<p>Gradle allows users to model dependency resolution in a flexible way.
Simple customizations, such as forcing specific versions or substituting dependencies, have minimal impact on resolution times.
However, <strong>complex custom logic</strong>such as downloading and parsing POM files manuallycan significantly slow down dependency resolution.</p>
</div>
<div class="paragraph">
<p>Use <strong>Build Scan</strong> or <strong>profile reports</strong> to ensure custom dependency resolution logic is not causing performance issues.
This logic may exist in your build scripts or as part of a third-party plugin.</p>
</div>
<div class="paragraph">
<p>This example forces a custom dependency version but also introduces expensive logic that slows down resolution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { details -&gt;
        if (details.requested.group == "com.example" &amp;&amp; details.requested.name == "library") {
            def versionInfo = new URL("https://example.com/version-check").text  //  Remote call during resolution
            details.useVersion(versionInfo.trim())  //  Dynamically setting a version based on an HTTP response
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of fetching dependency versions dynamically, define them in a version catalog:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation "com.example:library:${versions.libraryVersion}"
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="remove_slow_or_unexpected_dependency_downloads"><a class="anchor" href="#remove_slow_or_unexpected_dependency_downloads"></a><a class="link" href="#remove_slow_or_unexpected_dependency_downloads">Remove slow or unexpected dependency downloads</a></h5>
<div class="paragraph">
<p>Slow dependency downloads can significantly impact build performance.
Common causes include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Slow internet connections</p>
</li>
<li>
<p>Overloaded or distant repository servers</p>
</li>
<li>
<p>Unexpected downloads caused by <strong>dynamic versions</strong> (<code>2.+</code>) or <strong>snapshot versions</strong> (<code>-SNAPSHOT</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>Performance</strong> tab in a Build Scan includes a <strong>Network Activity</strong> section with:
- <strong>Total time spent downloading dependencies</strong>
- <strong>Download transfer rates</strong>
- <strong>A list of dependencies sorted by download time</strong></p>
</div>
<div class="paragraph">
<p>In the example below, two slow downloads took <strong>20 seconds</strong> and <strong>40 seconds</strong>, impacting the overall build time:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/slow-dependency-downloads.png" alt="slow dependency downloads">
</div>
<div class="title">Figure 15. Identify slow dependency downloads</div>
</div>
<div class="paragraph">
<p>Examine the list of downloaded dependencies for unexpected ones.
For example, a dynamic version (<code>1.+</code>) may be triggering frequent remote lookups.</p>
</div>
<div class="paragraph">
<p>To eliminate unnecessary downloads:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Use a closer or faster repository</strong>
If downloads are slow from <strong>Maven Central</strong>, consider a geographically closer mirror or an internal repository proxy.</p>
</li>
<li>
<p><strong>Switch from dynamic versions to fixed versions</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation "com.example:library:1.+" //  Bad
    implementation "com.example:library:1.2.3" //  Good
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optimize_java_projects"><a class="anchor" href="#optimize_java_projects"></a><a class="link" href="#optimize_java_projects">11. Optimize Java projects</a></h4>
<div class="paragraph">
<p>The following sections apply to projects that use the <code>java</code> plugin or other JVM languages.</p>
</div>
<div class="sect4">
<h5 id="optimize_test_execution"><a class="anchor" href="#optimize_test_execution"></a><a class="link" href="#optimize_test_execution">Optimize test execution</a></h5>
<div class="paragraph">
<p>Tests often account for a significant portion of build time.
These may include both unit and integration tests, with integration tests typically taking longer to run.</p>
</div>
<div class="paragraph">
<p>A <a href="build_scans.html#build_scans">Build Scan</a> can help you identify the slowest tests and prioritize performance improvements accordingly.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/performance/tests-longest.png" alt="tests longest">
</div>
<div class="title">Figure 16. Tests screen, with tests by project, sorted by duration</div>
</div>
<div class="paragraph">
<p>The image above shows the interactive test report from a Build Scan, sorted by test duration.</p>
</div>
<div class="paragraph">
<p>Gradle offers several strategies to speed up test execution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A. Run tests in parallel</p>
</li>
<li>
<p>B. Fork tests into multiple processes</p>
</li>
<li>
<p>C. Disable test reports when not needed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Lets take a closer look at each option.</p>
</div>
<div class="sect5">
<h6 id="a_run_tests_in_parallel"><a class="anchor" href="#a_run_tests_in_parallel"></a><a class="link" href="#a_run_tests_in_parallel">A. Run tests in parallel</a></h6>
<div class="paragraph">
<p>Gradle can run multiple test classes or methods in parallel.
To enable parallel execution, set the <code>maxParallelForks</code> property on your <code>Test</code> tasks.</p>
</div>
<div class="paragraph">
<p>A good default is the number of available CPU cores or slightly fewer:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    maxParallelForks = (Runtime.getRuntime().availableProcessors() / 2).coerceAtLeast(1)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    maxParallelForks = Runtime.runtime.availableProcessors().intdiv(2) ?: 1
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Parallel test execution assumes that tests are isolated.
Avoid shared resources such as file systems, databases, or external services.
Tests that share state or resources may fail intermittently due to race conditions or resource conflicts.</p>
</div>
</div>
<div class="sect5">
<h6 id="b_fork_tests_into_multiple_processes"><a class="anchor" href="#b_fork_tests_into_multiple_processes"></a><a class="link" href="#b_fork_tests_into_multiple_processes">B. Fork tests into multiple processes</a></h6>
<div class="paragraph">
<p>By default, Gradle runs all tests in a single forked JVM process.
This is efficient for small test suites, but large or memory-intensive test suites can suffer from long execution times and GC pauses.</p>
</div>
<div class="paragraph">
<p>You can reduce memory pressure and isolate problematic tests by forking a new JVM after a specified number of tests using the <code>forkEvery</code> setting:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    forkEvery = 100
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    forkEvery = 100
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Forking a JVM is an expensive operation. Setting <code>forkEvery</code> too low can increase test time due to excessive process startup overhead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="c_disable_test_reports"><a class="anchor" href="#c_disable_test_reports"></a><a class="link" href="#c_disable_test_reports">C. Disable test reports</a></h6>
<div class="paragraph">
<p>Gradle generates HTML and JUnit XML test reports by default, even if you don&#8217;t intend to view them.
Report generation adds overhead, particularly in large test suites.</p>
</div>
<div class="paragraph">
<p>You can disable report generation entirely if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You only need to know whether the tests passed.</p>
</li>
<li>
<p>You use a Build Scan, which provide richer test insights.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To disable reports, set <code>reports.html.required</code> and <code>reports.junitXml.required</code> to <code>false</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    reports.html.required = false
    reports.junitXml.required = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    reports.html.required = false
    reports.junitXml.required = false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="conditionally_enable_reports"><a class="anchor" href="#conditionally_enable_reports"></a><a class="link" href="#conditionally_enable_reports">Conditionally enable reports</a></h7>
<div class="paragraph">
<p>If you occasionally need reports without modifying the build file, you can make report generation conditional on a project property.</p>
</div>
<div class="paragraph">
<p>This example disables reports unless the <code>createReports</code> property is present:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    if (!project.hasProperty("createReports")) {
        reports.html.required = false
        reports.junitXml.required = false
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    if (!project.hasProperty("createReports")) {
        reports.html.required = false
        reports.junitXml.required = false
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To generate reports, pass the property via the command line:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock terminal">
<div class="content">
<pre>$ gradle &lt;task&gt; -PcreateReports</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or define the property in the <code>gradle.properties</code> file located in the <a href="#directory_layout">project root</a> or your <a href="#dir:gradle_user_home">Gradle User Home</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">createReports=true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="optimize_the_compiler"><a class="anchor" href="#optimize_the_compiler"></a><a class="link" href="#optimize_the_compiler">Optimize the compiler</a></h5>
<div class="paragraph">
<p>The Java compiler is fast, but in large projects with hundreds or thousands of classes, compilation time can still become significant.</p>
</div>
<div class="paragraph">
<p>Gradle offers several ways to optimize Java compilation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A. Run the compiler in a separate process</p>
</li>
<li>
<p>B. Use <code>implementation</code> visibility for internal dependencies</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="a_run_the_compiler_as_a_separate_process"><a class="anchor" href="#a_run_the_compiler_as_a_separate_process"></a><a class="link" href="#a_run_the_compiler_as_a_separate_process">A. Run the compiler as a separate process</a></h6>
<div class="paragraph">
<p>By default, Gradle runs compilation in the same process as the build logic.
You can offload Java compilation to a separate process using the <code>fork</code> option:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">&lt;task&gt;.options.isFork = true</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">&lt;task&gt;.options.fork = true</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To apply this setting to all <code>JavaCompile</code> tasks, use <code>configureEach</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;JavaCompile&gt;().configureEach {
    options.isFork = true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(JavaCompile).configureEach {
    options.fork = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle reuses the forked process for the duration of the build, so the startup cost is low.
Running compilation in its own JVM helps reduce garbage collection in the main Gradle process, which can speed up the rest of your build  especially when used alongside <a href="#sec:enable_parallel_execution">parallel execution</a>.</p>
</div>
<div class="paragraph">
<p>Forking compilation has little effect on small builds but can help significantly when a single task compiles more than a thousand source files.</p>
</div>
</div>
<div class="sect5">
<h6 id="b_use_implementation_for_internal_dependencies"><a class="anchor" href="#b_use_implementation_for_internal_dependencies"></a><a class="link" href="#b_use_implementation_for_internal_dependencies">B. Use <code>implementation</code> for internal dependencies</a></h6>
<div class="paragraph">
<p>In Gradle 3.4 and later, you can use <code>api</code> for dependencies that should be exposed to downstream projects and <code>implementation</code> for internal dependencies.
This distinction reduces unnecessary recompilation in large multi-project builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Only projects that apply the <a href="#java_library_plugin"><code>java-library</code></a> plugin can use the <code>api</code> and <code>implementation</code> configurations. Projects using only the <code>java</code> plugin cannot declare <code>api</code> dependencies.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an <code>implementation</code> dependency changes, Gradle does <strong>not</strong> recompile downstream consumers  only when <code>api</code> dependencies change.
This helps reduce cascading recompilations:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
   api(project("my-utils"))
   implementation("com.google.guava:guava:21.0")
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
   api project('my-utils')
   implementation 'com.google.guava:guava:21.0'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Switching to <code>implementation</code> for internal-only dependencies is one of the most impactful changes you can make to improve build performance in large, modular codebases.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="optimize_android_projects"><a class="anchor" href="#optimize_android_projects"></a><a class="link" href="#optimize_android_projects">12. Optimize Android Projects</a></h4>
<div class="paragraph">
<p>All the performance strategies described in this guide also apply to Android builds, since Android projects use Gradle under the hood.</p>
</div>
<div class="paragraph">
<p>However, Android introduces its own unique challenges and opportunities for optimization  especially around resource processing, APK creation, and build variants.</p>
</div>
<div class="paragraph">
<p>For additional tips specific to Android, check out the official resources from the Android team:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.android.com/studio/build/optimize-your-build.html">Optimize your build performance (Android Developer Guide)</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=7ll-rkLCtyk">Optimizing Gradle Builds for Android (Google I/O 2017 Talk)</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="improve_older_projects"><a class="anchor" href="#improve_older_projects"></a><a class="link" href="#improve_older_projects">13. Improve the performance of older Gradle releases</a></h4>
<div class="paragraph">
<p>We recommend using the latest Gradle version to benefit from the latest performance improvements, bug fixes, and features. However, we understand that some projects  especially long-lived or legacy codebases  may not be able to upgrade easily.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using an older version of Gradle, consider the following optimizations to improve build performance.</p>
</div>
<div class="sect4">
<h5 id="enable_the_daemon"><a class="anchor" href="#enable_the_daemon"></a><a class="link" href="#enable_the_daemon">Enable the Daemon</a></h5>
<div class="paragraph">
<p>The Gradle Daemon significantly improves build performance by avoiding JVM startup costs between builds.
The Daemon has been enabled by default since Gradle 3.0.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using an older version, consider <a href="#update_gradle">upgrading Gradle</a>.
If upgrading isn&#8217;t an option, you can <a href="#enable_daemon">enable the Daemon manually</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="enable_incremental_compilation"><a class="anchor" href="#enable_incremental_compilation"></a><a class="link" href="#enable_incremental_compilation">Enable Incremental Compilation</a></h5>
<div class="paragraph">
<p>Gradle can analyze class dependencies and recompile only the parts of your code affected by a change.</p>
</div>
<div class="paragraph">
<p>Incremental compilation is enabled by default in Gradle 4.10 and later.
To enable it manually in older versions, add the following configuration to your <code>build.gradle</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;JavaCompile&gt;().configureEach {
    options.isIncremental = true
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(JavaCompile).configureEach {
    options.incremental = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="use_compile_avoidance"><a class="anchor" href="#use_compile_avoidance"></a><a class="link" href="#use_compile_avoidance">Use Compile Avoidance</a></h5>
<div class="paragraph">
<p>Many code changes, such as edits to method bodies, are <em>ABI-compatible</em>  they do not affect a classs public API.
Gradle 3.4 and newer can detect these changes and avoid recompiling downstream projects, significantly reducing build times in large multi-project builds.</p>
</div>
<div class="paragraph">
<p>To benefit from compile avoidance, upgrade to Gradle 3.4 or later.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If your project uses annotation processors, you must explicitly declare them to take full advantage of compile avoidance.
See the <a href="java_plugin.html#sec:java_compile_avoidance">compile avoidance documentation</a> for more details.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build_cache"><a class="anchor" href="#build_cache"></a><a class="link" href="#build_cache">BUILD CACHE</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="build_cache"><a class="anchor" href="#build_cache"></a><a class="link" href="#build_cache">Build Cache</a></h3>
<div class="badge-wrapper">
    <a class="badge" href="https://dpeuniversity.gradle.com/app/courses/ec69d0b8-9171-4969-ac3e-82dea16f87b0/" target="_blank">
        <span class="badge-type button--blue">LEARN</span>
        <span class="badge-text">Incremental Builds and Build Caching with Gradle&nbsp;&nbsp;&nbsp;&gt;</span>
    </a>
</div>
<div class="sect3">
<h4 id="sec:build_cache_intro"><a class="anchor" href="#sec:build_cache_intro"></a><a class="link" href="#sec:build_cache_intro">Overview</a></h4>
<div class="paragraph">
<p>The Gradle <em>build cache</em> is a cache mechanism that aims to save time by reusing outputs produced by other builds.
The build cache works by storing (locally or remotely) build outputs and allowing builds to fetch these outputs from the cache when it is determined that inputs have not changed, avoiding the expensive work of regenerating them.</p>
</div>
<div class="paragraph">
<p>A first feature using the build cache is <em>task output caching</em>.
Essentially, task output caching leverages the same intelligence as <a href="incremental_build.html#incremental_build">up-to-date checks</a> that Gradle uses to avoid work when a previous local build has already produced a set of task outputs.
But instead of being limited to the previous build in the same workspace, task output caching allows Gradle to reuse task outputs from any earlier build in any location on the local machine.
When using a shared build cache for task output caching this even works across developer machines and build agents.</p>
</div>
<div class="paragraph">
<p>Apart from tasks, <a href="#sec:abm-artifact-transforms">artifact transforms</a> can also leverage the build cache and re-use their outputs similarly to task output caching.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
For a hands-on approach to learning how to use the build cache, start with reading through the <a href="#use_cases_cache">use cases for the build cache</a> and the follow up sections.
It covers the different scenarios that caching can improve and has detailed discussions of the different caveats you need to be aware of when enabling caching for a build.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_enable"><a class="anchor" href="#sec:build_cache_enable"></a><a class="link" href="#sec:build_cache_enable">Enable the Build Cache</a></h4>
<div class="paragraph">
<p>By default, the build cache is not enabled. You can enable the build cache in a couple of ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Run with <code>--build-cache</code> on the command-line</dt>
<dd>
<p>Gradle will use the build cache for this build only.</p>
</dd>
<dt class="hdlist1">Put <code>org.gradle.caching=true</code> in your <code>gradle.properties</code></dt>
<dd>
<p>Gradle will try to reuse outputs from previous builds for all builds, unless explicitly disabled with <code>--no-build-cache</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When the build cache is enabled, it will store build outputs in the Gradle User Home.
For configuring this directory or different kinds of build caches see <a href="#sec:build_cache_configure">Configure the Build Cache</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_output_caching"><a class="anchor" href="#sec:task_output_caching"></a><a class="link" href="#sec:task_output_caching">Task Output Caching</a></h4>
<div class="paragraph">
<p>Beyond incremental builds described in <a href="incremental_build.html#incremental_build">up-to-date checks</a>, Gradle can save time by reusing outputs from previous executions of a task by matching inputs to the task.
Task outputs can be reused between builds on one computer or even between builds running on different computers via a build cache.</p>
</div>
<div class="paragraph">
<p>We have focused on the use case where users have an organization-wide remote build cache that is populated regularly by continuous integration builds.
Developers and other continuous integration agents should load cache entries from the remote build cache.
We expect that developers will not be allowed to populate the remote build cache, and all continuous integration builds populate the build cache after running the <code>clean</code> task.</p>
</div>
<div class="paragraph">
<p>For your build to play well with task output caching it must work well with the <a href="incremental_build.html#incremental_build">incremental build</a> feature.
For example, when running your build twice in a row all tasks with outputs should be <code>UP-TO-DATE</code>.
You cannot expect faster builds or correct builds when enabling task output caching when this prerequisite is not met.</p>
</div>
<div class="paragraph">
<p>Task output caching is automatically enabled when you enable the build cache, see <a href="#sec:build_cache_enable">Enable the Build Cache</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_example"><a class="anchor" href="#sec:task_output_caching_example"></a><a class="link" href="#sec:task_output_caching_example">What does it look like</a></h5>
<div class="paragraph">
<p>Let us start with a project using the Java plugin which has a few Java source files. We run the build the first time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle --build-cache compileJava
:compileJava
:processResources
:classes
:jar
:assemble

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>We see the directory used by the local build cache in the output. Apart from that the build was the same as without the build cache.
Let&#8217;s clean and run the build again.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle clean
:clean

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle --build-cache assemble
:compileJava FROM-CACHE
:processResources
:classes
:jar
:assemble

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>Now we see that, instead of executing the <code>:compileJava</code> task, the outputs of the task have been loaded from the build cache.
The other tasks have not been loaded from the build cache since they are not cacheable. This is due to
<code>:classes</code> and <code>:assemble</code> being <a href="#sec:lifecycle_tasks">lifecycle tasks</a> and <code>:processResources</code>
and <code>:jar</code> being Copy-like tasks which are not cacheable since it is generally faster to execute them.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_output_caching_details"><a class="anchor" href="#sec:task_output_caching_details"></a><a class="link" href="#sec:task_output_caching_details">Cacheable tasks</a></h4>
<div class="paragraph">
<p>Since a task describes all of its inputs and outputs, Gradle can compute a <em>build cache key</em> that uniquely defines the task&#8217;s outputs based on its inputs.
That build cache key is used to request previous outputs from a build cache or store new outputs in the build cache.
If the previous build outputs have been already stored in the cache by someone else, e.g. your continuous integration server or other developers, you can avoid executing most tasks locally.</p>
</div>
<div class="paragraph">
<p>The following inputs contribute to the build cache key for a task in the same way that they do for <a href="incremental_build.html#sec:how_does_it_work">up-to-date checks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task type and its classpath</p>
</li>
<li>
<p>The names of the output properties</p>
</li>
<li>
<p>The names and values of properties annotated as described in <a href="incremental_build.html#sec:task_input_output_annotations">the section called "Custom task types"</a></p>
</li>
<li>
<p>The names and values of properties added by the DSL via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskInputs.html">TaskInputs</a></p>
</li>
<li>
<p>The classpath of the Gradle distribution, buildSrc and plugins</p>
</li>
<li>
<p>The content of the build script when it affects execution of the task</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Task types need to opt-in to task output caching using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/CacheableTask.html">@CacheableTask</a> annotation.
Note that <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/CacheableTask.html">@CacheableTask</a> is not inherited by subclasses.
Custom task types are <em>not</em> cacheable by default.</p>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_cacheable_tasks"><a class="anchor" href="#sec:task_output_caching_cacheable_tasks"></a><a class="link" href="#sec:task_output_caching_cacheable_tasks">Built-in cacheable tasks</a></h5>
<div class="paragraph">
<p>Currently, the following built-in Gradle tasks are cacheable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java toolchain:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a></p>
</li>
<li>
<p>Groovy toolchain:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a>,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.javadoc.Groovydoc.html">Groovydoc</a></p>
</li>
<li>
<p>Scala toolchain:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a>,
<code>org.gradle.language.scala.tasks.PlatformScalaCompile</code> (removed),
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaDoc.html">ScalaDoc</a></p>
</li>
<li>
<p>Native toolchain:
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/language/cpp/tasks/CppCompile.html">CppCompile</a>,
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/language/c/tasks/CCompile.html">CCompile</a>,
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/language/swift/tasks/SwiftCompile.html">SwiftCompile</a></p>
</li>
<li>
<p>Testing:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a></p>
</li>
<li>
<p>Code quality tasks:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a>,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.quality.CodeNarc.html">CodeNarc</a>,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.quality.Pmd.html">Pmd</a></p>
</li>
<li>
<p>JaCoCo:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html">JacocoReport</a></p>
</li>
<li>
<p>Other tasks:
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a>,
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/plugin/devel/tasks/ValidatePlugins.html">ValidatePlugins</a>,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.WriteProperties.html">WriteProperties</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All other built-in tasks are currently not cacheable.</p>
</div>
<div class="paragraph">
<p>Some tasks, like <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html">Copy</a> or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>, usually do not make sense to make cacheable because Gradle is only copying files from one location to another.
It also doesn&#8217;t make sense to make tasks cacheable that do not produce outputs or have no task actions.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_cacheable_3rd_party"><a class="anchor" href="#sec:task_output_caching_cacheable_3rd_party"></a><a class="link" href="#sec:task_output_caching_cacheable_3rd_party">Third party plugins</a></h5>
<div class="paragraph">
<p>There are third party plugins that work well with the build cache.
The most prominent examples are the <a href="https://developer.android.com/studio/releases/gradle-plugin.html">Android plugin 3.1+</a> and the <a href="https://blog.gradle.org/kotlin-build-cache-use">Kotlin plugin 1.2.21+</a>.
For other third party plugins, check their documentation to find out whether they support the build cache.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_inputs"><a class="anchor" href="#sec:task_output_caching_inputs"></a><a class="link" href="#sec:task_output_caching_inputs">Declaring task inputs and outputs</a></h5>
<div class="paragraph">
<p>It is very important that a cacheable task has a complete picture of its inputs and outputs, so that the results from one build can be safely re-used somewhere else.</p>
</div>
<div class="paragraph">
<p>Missing task inputs can cause incorrect cache hits, where different results are treated as identical because the same cache key is used by both executions.
Missing task outputs can cause build failures if Gradle does not completely capture all outputs for a given task.
Wrongly declared task inputs can lead to cache misses especially when containing volatile data or absolute paths.
(See <a href="incremental_build.html#sec:task_inputs_outputs">the section called "Task inputs and outputs"</a> on what should be declared as inputs and outputs.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The task path is <em>not</em> an input to the build cache key.
This means that tasks with different task paths can re-use each other&#8217;s outputs as long as Gradle determines that executing them yields the same result.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to ensure that the inputs and outputs are properly declared use integration tests (for example using TestKit) to check that a task produces the same outputs for identical inputs and captures all output files for the task.
We suggest adding tests to ensure that the task inputs are relocatable, i.e. that the task can be loaded from the cache into a different build directory (see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/PathSensitive.html">@PathSensitive</a>).</p>
</div>
<div class="paragraph">
<p>In order to handle volatile inputs for your tasks consider <a href="incremental_build.html#sec:configure_input_normalization">configuring input normalization</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_disabled_by_default"><a class="anchor" href="#sec:task_output_caching_disabled_by_default"></a><a class="link" href="#sec:task_output_caching_disabled_by_default">Marking tasks as non-cacheable by default</a></h5>
<div class="paragraph">
<p>There are certain tasks that don&#8217;t benefit from using the build cache.
One example is a task that only moves data around the file system, like a <code>Copy</code> task.
You can signify that a task is not to be cached by adding the <code>@DisableCachingByDefault</code> annotation to it.
You can also give a human-readable reason for not caching the task by default.
The annotation can be used on its own, or together with <code>@CacheableTask</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This annotation is only for documenting the reason behind not caching the task by default.
Build logic can override this decision via the runtime API (see below).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enable_caching_of_non_cacheable_tasks"><a class="anchor" href="#enable_caching_of_non_cacheable_tasks"></a><a class="link" href="#enable_caching_of_non_cacheable_tasks">Enable caching of non-cacheable tasks</a></h4>
<div class="paragraph">
<p>As we have seen, built-in tasks, or tasks provided by plugins, are cacheable if their class is annotated with the <code>Cacheable</code> annotation.
But what if you want to make cacheable a task whose class is not cacheable?
Let&#8217;s take a concrete example: your build script uses a generic <code>NpmTask</code> task to create a JavaScript bundle by delegating to NPM (and running <code>npm run bundle</code>).
This process is similar to a complex compilation task, but <code>NpmTask</code> is too generic to be cacheable by default: it just takes arguments and runs npm with those arguments.</p>
</div>
<div class="paragraph">
<p>The inputs and outputs of this task are simple to figure out.
The inputs are the directory containing the JavaScript files, and the NPM configuration files.
The output is the bundle file generated by this task.</p>
</div>
<div class="sect4">
<h5 id="using_annotations"><a class="anchor" href="#using_annotations"></a><a class="link" href="#using_annotations">Using annotations</a></h5>
<div class="paragraph">
<p>We create a subclass of the <code>NpmTask</code> and use <a href="incremental_build.html#sec:task_input_output_annotations">annotations to declare the inputs and outputs</a>.</p>
</div>
<div class="paragraph">
<p>When possible, it is better to use delegation instead of creating a subclass.
That is the case for the built in <code>JavaExec</code>, <code>Exec</code>, <code>Copy</code> and <code>Sync</code> tasks, which have a method on <code>Project</code> to do the actual work.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re a modern JavaScript developer, you know that bundling can be quite long, and is worth caching.
To achieve that, we need to tell Gradle that it&#8217;s allowed to cache the output of that task, using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/CacheableTask.html">@CacheableTask</a> annotation.</p>
</div>
<div class="paragraph">
<p>This is sufficient to make the task cacheable on your own machine.
However, input files are identified by default by their absolute path.
So if the cache needs to be shared between several developers or machines using different paths, that won&#8217;t work as expected.
So we also need to set the <a href="#relocatability">path sensitivity</a>.
In this case, the relative path of the input files can be used to identify them.</p>
</div>
<div class="paragraph">
<p>Note that it is possible to override property annotations from the base class by overriding the getter of the base class and annotating that method.</p>
</div>
<div id="ex-custom-cacheable-bundletask" class="exampleblock">
<div class="title">Example 7. <a href="#ex-custom-cacheable-bundletask">Custom cacheable BundleTask</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableTask                                       // <b class="conum">(1)</b>
abstract class BundleTask : NpmTask() {

    @get:Internal                                    // <b class="conum">(2)</b>
    override val args
        get() = super.args


    @get:InputDirectory
    @get:SkipWhenEmpty
    @get:PathSensitive(PathSensitivity.RELATIVE)     // <b class="conum">(3)</b>
    abstract val scripts: DirectoryProperty

    @get:InputFiles
    @get:PathSensitive(PathSensitivity.RELATIVE)     // <b class="conum">(4)</b>
    abstract val configFiles: ConfigurableFileCollection

    @get:OutputFile
    abstract val bundle: RegularFileProperty

    init {
        args.addAll("run", "bundle")
        bundle = projectLayout.buildDirectory.file("bundle.js")
        scripts = projectLayout.projectDirectory.dir("scripts")
        configFiles.from(projectLayout.projectDirectory.file("package.json"))
        configFiles.from(projectLayout.projectDirectory.file("package-lock.json"))
    }
}

tasks.register&lt;BundleTask&gt;("bundle")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableTask                                       // <b class="conum">(1)</b>
abstract class BundleTask extends NpmTask {

    @Override @Internal                              // <b class="conum">(2)</b>
    ListProperty&lt;String&gt; getArgs() {
        super.getArgs()
    }

    @InputDirectory
    @SkipWhenEmpty
    @PathSensitive(PathSensitivity.RELATIVE)         // <b class="conum">(3)</b>
    abstract DirectoryProperty getScripts()

    @InputFiles
    @PathSensitive(PathSensitivity.RELATIVE)         // <b class="conum">(4)</b>
    abstract ConfigurableFileCollection getConfigFiles()

    @OutputFile
    abstract RegularFileProperty getBundle()

    BundleTask() {
        args.addAll("run", "bundle")
        bundle = projectLayout.buildDirectory.file("bundle.js")
        scripts = projectLayout.projectDirectory.dir("scripts")
        configFiles.from(projectLayout.projectDirectory.file("package.json"))
        configFiles.from(projectLayout.projectDirectory.file("package-lock.json"))
    }
}

tasks.register('bundle', BundleTask)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>(1) Add <code>@CacheableTask</code> to enable caching for the task.</p>
</li>
<li>
<p>(2) Override the getter of a property of the base class to change the input annotation to <code>@Internal</code>.</p>
</li>
<li>
<p>(3) (4) Declare the path sensitivity.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="using_the_runtime_api"><a class="anchor" href="#using_the_runtime_api"></a><a class="link" href="#using_the_runtime_api">Using the runtime API</a></h5>
<div class="paragraph">
<p>If for some reason you cannot create a new custom task class, it is also possible to make a task cacheable using the <a href="incremental_build.html#sec:task_input_output_runtime_api">runtime API</a> to declare the inputs and outputs.</p>
</div>
<div class="paragraph">
<p>For enabling caching for the task you need to use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskOutputs.html#cacheIf-org.gradle.api.specs.Spec-">TaskOutputs.cacheIf()</a> method.</p>
</div>
<div class="paragraph">
<p>The declarations via the runtime API have the same effect as the annotations described above.
Note that you cannot override file inputs and outputs via the runtime API.
Input properties can be overridden by specifying the same property name.</p>
</div>
<div id="ex-make-the-bundle-task-cacheable" class="exampleblock">
<div class="title">Example 8. <a href="#ex-make-the-bundle-task-cacheable">Make the bundle task cacheable</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;NpmTask&gt;("bundle") {
    args = listOf("run", "bundle")

    outputs.cacheIf { true }

    inputs.dir(file("scripts"))
        .withPropertyName("scripts")
        .withPathSensitivity(PathSensitivity.RELATIVE)

    inputs.files("package.json", "package-lock.json")
        .withPropertyName("configFiles")
        .withPathSensitivity(PathSensitivity.RELATIVE)

    outputs.file(layout.buildDirectory.file("bundle.js"))
        .withPropertyName("bundle")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('bundle', NpmTask) {
    args = ['run', 'bundle']

    outputs.cacheIf { true }

    inputs.dir(file("scripts"))
        .withPropertyName("scripts")
        .withPathSensitivity(PathSensitivity.RELATIVE)

    inputs.files("package.json", "package-lock.json")
        .withPropertyName("configFiles")
        .withPathSensitivity(PathSensitivity.RELATIVE)

    outputs.file(layout.buildDirectory.file("bundle.js"))
        .withPropertyName("bundle")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_configure"><a class="anchor" href="#sec:build_cache_configure"></a><a class="link" href="#sec:build_cache_configure">Configure the Build Cache</a></h4>
<div class="paragraph">
<p>You can configure the build cache by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:buildCache(org.gradle.api.Action)">Settings.buildCache(org.gradle.api.Action)</a> block in <code>settings.gradle</code>.</p>
</div>
<div class="paragraph">
<p>Gradle supports a <code>local</code> and a <code>remote</code> build cache that can be configured separately.
When both build caches are enabled, Gradle tries to load build outputs from the local build cache first, and then tries the remote build cache if no build outputs are found.
If outputs are found in the remote cache, they are also stored in the local cache, so next time they will be found locally.
Gradle stores ("pushes") build outputs in any build cache that is enabled and has <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/caching/configuration/BuildCache.html#isPush--">BuildCache.isPush()</a> set to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>By default, the local build cache has push enabled, and the remote build cache has push disabled.</p>
</div>
<div class="paragraph">
<p>The local build cache is pre-configured to be a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a> and enabled by default.
The remote build cache can be configured by specifying the type of build cache to connect to (<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.configuration.BuildCacheConfiguration.html#org.gradle.caching.configuration.BuildCacheConfiguration:remote(java.lang.Class)">BuildCacheConfiguration.remote(java.lang.Class)</a>).</p>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_local"><a class="anchor" href="#sec:build_cache_configure_local"></a><a class="link" href="#sec:build_cache_configure_local">Built-in local build cache</a></h5>
<div class="paragraph">
<p>The built-in local build cache, <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a>, uses a directory to store build cache artifacts.
By default, this directory resides in the Gradle User Home, but its location is configurable.</p>
</div>
<div class="paragraph">
<p>For more details on the configuration options refer to the DSL documentation of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a>.
Here is an example of the configuration.</p>
</div>
<div id="ex-configure-the-local-cache" class="exampleblock">
<div class="title">Example 9. <a href="#ex-configure-the-local-cache">Configure the local cache</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildCache {
    local {
        directory = File(rootDir, "build-cache")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildCache {
    local {
        directory = new File(rootDir, 'build-cache')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle will periodically clean-up the local cache directory by removing entries that have not been used recently to conserve disk space.
How often Gradle will perform this clean-up and how long entries will be retained is configurable via an init-script as demonstrated
<a href="#dir:gradle_user_home:configure_cache_cleanup">in this section</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_remote"><a class="anchor" href="#sec:build_cache_configure_remote"></a><a class="link" href="#sec:build_cache_configure_remote">Remote HTTP build cache</a></h5>
<div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.http.HttpBuildCache.html">HttpBuildCache</a> provides the ability read to and write from a remote cache via HTTP.</p>
</div>
<div class="paragraph">
<p>With the following configuration, the local build cache will be used for storing build outputs while the local and the remote build cache will be used for retrieving build outputs.</p>
</div>
<div id="ex-load-from-httpbuildcache" class="exampleblock">
<div class="title">Example 10. <a href="#ex-load-from-httpbuildcache">Load from HttpBuildCache</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildCache {
    remote&lt;HttpBuildCache&gt; {
        url = uri("https://example.com:8123/cache/")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = 'https://example.com:8123/cache/'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When attempting to load an entry, a <code>GET</code> request is made to <code>https://example.com:8123/cache/cache-key</code>.
The response must have a <code>2xx</code> status and the cache entry as the body, or a <code>404 Not Found</code> status if the entry does not exist.</p>
</div>
<div class="paragraph">
<p>When attempting to store an entry, a <code>PUT</code> request is made to <code>https://example.com:8123/cache/cache-key</code>.
Any <code>2xx</code> response status is interpreted as success.
A <code>413 Payload Too Large</code> response may be returned to indicate that the payload is larger than the server will accept, which will not be treated as an error.</p>
</div>
<div class="sect5">
<h6 id="specifying_access_credentials"><a class="anchor" href="#specifying_access_credentials"></a><a class="link" href="#specifying_access_credentials">Specifying access credentials</a></h6>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basic Authentication</a> is supported, with credentials being sent preemptively.</p>
</div>
<div id="ex-specifying-access-credentials" class="exampleblock">
<div class="title">Example 11. <a href="#ex-specifying-access-credentials">Specifying access credentials</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildCache {
    remote&lt;HttpBuildCache&gt; {
        url = uri("https://example.com:8123/cache/")
        credentials {
            username = "build-cache-user"
            password = "some-complicated-password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = 'https://example.com:8123/cache/'
        credentials {
            username = 'build-cache-user'
            password = 'some-complicated-password'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:build_cache_redirects"><a class="anchor" href="#sec:build_cache_redirects"></a><a class="link" href="#sec:build_cache_redirects">Redirects</a></h6>
<div class="paragraph">
<p><code>3xx</code> redirecting responses will be followed automatically.</p>
</div>
<div class="paragraph">
<p>Servers must take care when redirecting <code>PUT</code> requests as only <code>307</code> and <code>308</code> redirect responses will be followed with a <code>PUT</code> request.
All other redirect responses will be followed with a <code>GET</code> request, as per <a href="https://datatracker.ietf.org/doc/html/rfc7231#page-54">RFC 7231</a>,
without the entry payload as the body.</p>
</div>
</div>
<div class="sect5">
<h6 id="sec:build_cache_error_handling"><a class="anchor" href="#sec:build_cache_error_handling"></a><a class="link" href="#sec:build_cache_error_handling">Network error handling</a></h6>
<div class="paragraph">
<p>Requests that fail during request transmission, after having established a TCP connection, will be retried automatically.</p>
</div>
<div class="paragraph">
<p>This prevents temporary problems, such as connection drops, read or write timeouts, and low level network failures such as a connection resets, causing cache operations to fail and disabling the remote cache for the remainder of the build.</p>
</div>
<div class="paragraph">
<p>Requests will be retried up to 3 times.
If the problem persists, the cache operation will fail and the remote cache will be disabled for the remainder of the build.</p>
</div>
</div>
<div class="sect5">
<h6 id="using_ssl"><a class="anchor" href="#using_ssl"></a><a class="link" href="#using_ssl">Using SSL</a></h6>
<div class="paragraph">
<p>By default, use of HTTPS requires the server to present a certificate that is trusted by the build&#8217;s Java runtime.
If your server&#8217;s certificate is not trusted, you can:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the trust store of your Java runtime to allow it to be trusted</p>
</li>
<li>
<p>Change the <a href="#build_environment">build environment</a> to use an alternative trust store for the build runtime</p>
</li>
<li>
<p>Disable the requirement for a trusted certificate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The trust requirement can be disabled by setting <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.http.HttpBuildCache.html#org.gradle.caching.http.HttpBuildCache:allowUntrustedServer">HttpBuildCache.isAllowUntrustedServer()</a> to <code>true</code>.
Enabling this option is a security risk, as it allows any cache server to impersonate the intended server.
It should only be used as a temporary measure or in very tightly controlled network environments.</p>
</div>
<div id="ex-allow-untrusted-cache-server" class="exampleblock">
<div class="title">Example 12. <a href="#ex-allow-untrusted-cache-server">Allow untrusted cache server</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildCache {
    remote&lt;HttpBuildCache&gt; {
        url = uri("https://example.com:8123/cache/")
        isAllowUntrustedServer = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = 'https://example.com:8123/cache/'
        allowUntrustedServer = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:build_cache_expect_continue"><a class="anchor" href="#sec:build_cache_expect_continue"></a><a class="link" href="#sec:build_cache_expect_continue">HTTP expect-continue</a></h6>
<div class="paragraph">
<p>Use of <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.2.3">HTTP Expect-Continue</a> can be enabled.
This causes upload requests to happen in two parts: first a check whether a body would be accepted, then transmission of the body if the server indicates it will accept it.</p>
</div>
<div class="paragraph">
<p>This is useful when uploading to cache servers that routinely redirect or reject upload requests,
as it avoids uploading the cache entry just to have it rejected (e.g. the cache entry is larger than the cache will allow) or redirected.
This additional check incurs extra latency when the server accepts the request, but reduces latency when the request is rejected or redirected.</p>
</div>
<div class="paragraph">
<p>Not all HTTP servers and proxies reliably implement Expect-Continue.
Be sure to check that your cache server does support it before enabling.</p>
</div>
<div class="paragraph">
<p>To enable, set <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.caching.http.HttpBuildCache.html#org.gradle.caching.http.HttpBuildCache:useExpectContinue">HttpBuildCache.isUseExpectContinue()</a> to <code>true</code>.</p>
</div>
<div id="ex-use-expect-continue" class="exampleblock">
<div class="title">Example 13. <a href="#ex-use-expect-continue">Use Expect-Continue</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildCache {
    remote&lt;HttpBuildCache&gt; {
        url = uri("https://example.com:8123/cache/")
        isUseExpectContinue = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = 'https://example.com:8123/cache/'
        useExpectContinue = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_use_cases"><a class="anchor" href="#sec:build_cache_configure_use_cases"></a><a class="link" href="#sec:build_cache_configure_use_cases">Configuration use cases</a></h5>
<div class="paragraph">
<p>The recommended use case for the remote build cache is that your continuous integration server populates it from clean builds while developers only load from it.
The configuration would then look as follows.</p>
</div>
<div id="ex-recommended-setup-for-ci-push-use-case" class="exampleblock">
<div class="title">Example 14. <a href="#ex-recommended-setup-for-ci-push-use-case">Recommended setup for CI push use case</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val isCiServer = System.getenv().containsKey("CI")

buildCache {
    remote&lt;HttpBuildCache&gt; {
        url = uri("https://example.com:8123/cache/")
        isPush = isCiServer
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">boolean isCiServer = System.getenv().containsKey("CI")

buildCache {
    remote(HttpBuildCache) {
        url = 'https://example.com:8123/cache/'
        push = isCiServer
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is also possible to configure the build cache from an <a href="#sec:using_an_init_script">init script</a>, which can be used from the command line, added to your Gradle User Home or be a part of your custom Gradle distribution.</p>
</div>
<div id="ex-init-script-to-configure-the-build-cache" class="exampleblock">
<div class="title">Example 15. <a href="#ex-init-script-to-configure-the-build-cache">Init script to configure the build cache</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">gradle.settingsEvaluated {
    buildCache {
        // vvv Your custom configuration goes here
        remote&lt;HttpBuildCache&gt; {
            url = uri("https://example.com:8123/cache/")
        }
        // ^^^ Your custom configuration goes here
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">gradle.settingsEvaluated { settings -&gt;
    settings.buildCache {
        // vvv Your custom configuration goes here
        remote(HttpBuildCache) {
            url = 'https://example.com:8123/cache/'
        }
        // ^^^ Your custom configuration goes here
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_composite"><a class="anchor" href="#sec:build_cache_composite"></a><a class="link" href="#sec:build_cache_composite">Build cache, composite builds and <code>buildSrc</code></a></h5>
<div class="paragraph">
<p>Gradle&#8217;s <a href="#composite_builds">composite build feature</a> allows including other complete Gradle builds into another.
Such included builds will inherit the build cache configuration from the top level build, regardless of whether the included builds define build cache configuration themselves or not.</p>
</div>
<div class="paragraph">
<p>The build cache configuration present for any included build is effectively ignored, in favour of the top level build&#8217;s configuration.
This also applies to any <code>buildSrc</code> projects of any included builds.</p>
</div>
<div class="paragraph">
<p>The <a href="#sec:using_buildsrc"><code>buildSrc</code> directory</a> is treated as an <a href="#composite_build_intro">included build</a>, and as such it inherits the build cache configuration from the top-level build.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This configuration precedence does not apply to <a href="#included_plugin_builds">plugin builds</a> included through <code>pluginManagement</code> as these are loaded <em>before</em> the cache configuration itself.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_setup_http_backend"><a class="anchor" href="#sec:build_cache_setup_http_backend"></a><a class="link" href="#sec:build_cache_setup_http_backend">How to set up an HTTP build cache backend</a></h4>
<div class="paragraph">
<p>Gradle provides a Docker image for a <a href="https://hub.docker.com/r/gradle/build-cache-node/">build cache node</a>, which can connect with Develocity for centralized management.
The cache node can also be used without a Develocity installation with restricted functionality.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_implement"><a class="anchor" href="#sec:build_cache_implement"></a><a class="link" href="#sec:build_cache_implement">Implement your own Build Cache</a></h4>
<div class="paragraph">
<p>Using a different build cache backend to store build outputs (which is not covered by the built-in support for connecting to an HTTP backend) requires implementing
your own logic for connecting to your custom build cache backend.
To this end, custom build cache types can be registered via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/caching/configuration/BuildCacheConfiguration.html#registerBuildCacheService-java.lang.Class-java.lang.Class-">BuildCacheConfiguration.registerBuildCacheService(java.lang.Class, java.lang.Class)</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://gradle.com/gradle-enterprise-solutions/build-cache/">Develocity</a> includes a high-performance, easy to install and operate, shared build cache backend.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="use_cases_cache"><a class="anchor" href="#use_cases_cache"></a><a class="link" href="#use_cases_cache">Use cases for the build cache</a></h3>
<div class="paragraph">
<p>This section covers the different use cases for Gradles build cache, from local-only development to caching task outputs across large teams.</p>
</div>
<div class="sect3">
<h4 id="speed_up_developer_builds_with_the_local_cache"><a class="anchor" href="#speed_up_developer_builds_with_the_local_cache"></a><a class="link" href="#speed_up_developer_builds_with_the_local_cache">Speed up developer builds with the local cache</a></h4>
<div class="paragraph">
<p>Even when used by a single developer only, the build cache can be very useful.
Gradle&#8217;s <em>incremental build</em> feature helps to avoid work that is already done, but once you re-execute a task, any previous results are forgotten.
When you are switching branches back and forth, the local results get rebuilt over and over again, even if you are building something that has already been built before.
The build cache remembers the earlier build results, and greatly reduces the need to rebuild things when they have already been built locally.
This can also extend to rebuilding different commits, like when running <code>git bisect</code>.</p>
</div>
<div class="paragraph">
<p>The local cache can also be useful when working with a project that has multiple variants, as in the case of Android projects. Each variant has a number of tasks associated with it, and some of those task variant dimensions, despite having different names, can end up producing the same output. With the local cache enabled, reuse between task variants will happen automatically when applicable.</p>
</div>
</div>
<div class="sect3">
<h4 id="share_results_between_ci_builds"><a class="anchor" href="#share_results_between_ci_builds"></a><a class="link" href="#share_results_between_ci_builds">Share results between CI builds</a></h4>
<div class="paragraph">
<p>The build cache can do more than go back-and-forth in time: it can also bridge physical distance between computers, allowing results generated on one machine to be re-used by another.
A typical first step when introducing the build cache within a team is to enable it for builds running as part of <em>continuous integration</em> only. Using a shared HTTP build cache backend (such as <a href="https://gradle.com/build-cache/">the one provided by Develocity</a>) can significantly reduce the work CI agents need to do.
This translates into faster feedback for developers, and less money spent on the CI resources.
Faster builds also mean fewer commits being part of each build, which makes debugging issues more efficient.</p>
</div>
<div class="paragraph">
<p>Beginning with the build cache on CI is a good first step as the environment on CI agents is usually more stable and predictable than developer machines.
This helps to identify any possible issues with the build that may affect cacheability.</p>
</div>
<div class="paragraph">
<p>If you are subject to audit requirements regarding the artifacts you ship to your customers you may need to disable the build cache for certain builds.
Develocity may help you with fulfilling these requirements while still using the build cache for all your builds.
It allows you to easily find out which build produced an artifact coming from the build cache via a Build Scan.</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/from-cache-origin.png" alt="from cache origin">
</div>
</div>
</div>
<div class="sect3">
<h4 id="accelerate_developer_builds_by_reusing_ci_results"><a class="anchor" href="#accelerate_developer_builds_by_reusing_ci_results"></a><a class="link" href="#accelerate_developer_builds_by_reusing_ci_results">Accelerate developer builds by reusing CI results</a></h4>
<div class="paragraph">
<p>When multiple developers work on the same project, they don&#8217;t just need to build their own changes: whenever they pull from version control, they end up having to build each other&#8217;s changes as well.
Whenever a developer is working on something independent of the pulled changes, they can safely reuse outputs already generated on CI.
Say, you&#8217;re working on module "A", and you pull in some changes to module "B" (which does not depend on your module).
If those changes were already built in CI, you can download the task outputs for module "B" from the cache instead of generating them locally.
A typical use case for this is when developers start their day, pull all changes from version control and then run their first build.</p>
</div>
<div class="paragraph">
<p>The changes don&#8217;t need to be completely independent, either; we&#8217;ll take a look at the strategies to reuse results when dependencies are involved in the section about the <a href="#normalization">different forms of normalization</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="combine_remote_results_with_local_caching"><a class="anchor" href="#combine_remote_results_with_local_caching"></a><a class="link" href="#combine_remote_results_with_local_caching">Combine remote results with local caching</a></h4>
<div class="paragraph">
<p>You can utilize both a local and a remote cache for a compound effect.
While loading results from a CI-filled remote cache helps to avoid work needed because of changes by other developers, the local cache can speed up switching branches and doing <code>git bisect</code>.
On CI machines the local cache can act as a mirror of the remote cache, significantly reducing network usage.</p>
</div>
</div>
<div class="sect3">
<h4 id="share_results_between_developers"><a class="anchor" href="#share_results_between_developers"></a><a class="link" href="#share_results_between_developers">Share results between developers</a></h4>
<div class="paragraph">
<p>Allowing developers to upload their results to a shared cache is possible, but not recommended.
Developers can make changes to task inputs or outputs while the task is executing.
They can do this unintentionally and without noticing, for example by making changes in their IDEs while a build is running.
Currently, Gradle has no good way to defend against these changes, and will simply cache whatever is in the output directory once the task is finished.
This again can lead to corrupted results being uploaded to the shared cache.
This recommendation might change when Gradle has added the necessary safeguards against unintentional modification of task inputs and outputs.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to share task output from incremental builds, i.e. non-clean builds, you have to make sure that all cacheable tasks are properly configured and implemented to deal with stale output.
There are for example annotation processors that do not clean up stale files in the corresponding classes/resources directories.
The cache is a great forcing function to fix these problems, which will also make your incremental builds much more reliable.
At the same time, until you have confidence that the incremental build behavior is flawless, only use clean builds to upload content to the cache.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_cache_performance"><a class="anchor" href="#build_cache_performance"></a><a class="link" href="#build_cache_performance">Build cache performance</a></h3>
<div class="badge-wrapper">
    <a class="badge" href="https://dpeuniversity.gradle.com/app/courses/4fcbecbc-7cff-449a-a509-07cf70403f0c/" target="_blank">
        <span class="badge-type button--blue">LEARN</span>
        <span class="badge-text">Maintaining Optimal Gradle Build Cache Performance&nbsp;&nbsp;&nbsp;&gt;</span>
    </a>
</div>
<div class="paragraph">
<p>The sole reason to use any build cache is to make builds faster.
But how much faster can you go when using the cache?
Measuring the impact is both important and complicated, as cache performance is determined by many factors.
Performing measurements of the cache&#8217;s impact can validate the extra effort (work, infrastructure) that is required to start using the cache.
These measurements can later serve as baselines for future improvements, and to watch for signs of regressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Proper configuration and maintenance of a build can improve caching performance in a big way.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="fully_cached_builds"><a class="anchor" href="#fully_cached_builds"></a><a class="link" href="#fully_cached_builds">Fully cached builds</a></h4>
<div class="paragraph">
<p>The most straightforward way to get a feel for what the cache can do for you is to measure the difference between a non-cached build and a <em>fully cached</em> build. This will give you the theoretical limit of how fast builds with the cache can get, if everything you&#8217;re trying to build has already been built. The easiest way to measure this is using the local cache:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clean the cache directory to avoid any hits from previous builds (<code>rm -rf $GRADLE_USER_HOME/caches/build-cache-*</code>)</p>
</li>
<li>
<p>Run the build (e.g. <code>./gradlew --build-cache clean assemble</code>), so that all the results from cacheable tasks get stored in the cache.</p>
</li>
<li>
<p>Run the build again (e.g. <code>./gradlew --build-cache clean assemble</code>); depending on your build, you should see many of the tasks being retrieved from the cache.</p>
</li>
<li>
<p>Compare the execution time for the two builds</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You may encounter a few cached tasks even in the first of the two builds, where no previously cached results should be available.
This can happen if you have tasks in your build that are configured to produce the same results from the same inputs; in such a case once one of these tasks has finished, Gradle will simply reuse its output for the rest of the tasks.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Normally, your <em>fully cached</em> build should be significantly faster than the <code>clean</code> build: this is the theoretical limit of how much time using the build cache can save on your particular build.
You usually don&#8217;t get the achievable performance gains on the first try, see <a href="#finding_problems">finding problems with task output caching</a>.
As your build logic is evolving and changing it is also important to make sure that the cache effectiveness is not regressing.
A Build Scan provides a detailed performance breakdown which show you how effectively your build is using the build cache:</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/performance-task-execution.png" alt="performance task execution">
</div>
</div>
<div class="paragraph">
<p>Fully cached builds occur in situations when developers check out the latest from version control and then build, for example to generate the latest sources they need in their IDE.
The purpose of running most builds though is to process some new changes.
The structure of the software being built (how many modules are there, how independent are its parts etc.), and the nature of the changes themselves ("big refactor in the core of the system" vs. "small change to a unit test" etc.) strongly influence the performance gains delivered by the build cache.
As developers tend to submit different kinds of changes over time, caching performance is expected to vary with each change.
As with any cache, the impact should therefore be measured over time.</p>
</div>
<div class="paragraph">
<p>In a setup where a team uses a shared cache backend, there are two locations worth measuring cache impact at: on CI and on developer machines.</p>
</div>
</div>
<div class="sect3">
<h4 id="cache_impact_on_ci_builds"><a class="anchor" href="#cache_impact_on_ci_builds"></a><a class="link" href="#cache_impact_on_ci_builds">Cache impact on CI builds</a></h4>
<div class="paragraph">
<p>The best way to learn about the impact of caching on CI is to set up the same builds with the cache enabled and disabled, and compare the results over time. If you have a single Gradle build step that you want to enable caching for, it&#8217;s easy to compare the results using your CI system&#8217;s built-in statistical tools.</p>
</div>
<div class="paragraph">
<p>Measuring complex pipelines may require more work or external tools to collect and process measurements.
It&#8217;s important to distinguish those parts of the pipeline that caching has no effect on, for example, the time builds spend waiting in the CI system&#8217;s queue, or time taken by checking out source code from version control.</p>
</div>
<div class="paragraph">
<p>When using Develocity, you can use the <a href="https://docs.gradle.com/enterprise/export-api/">Export API</a> to access the necessary data and run your analytics.
Develocity provides much richer data compared to what can be obtained from CI servers.
For example, you can get insights into the execution of single tasks, how many tasks were retrieved from the cache, how long it took to download from the cache, the properties that were used to calculate the cache key and more.
When using your CI servers built in functions, you can use <a href="https://confluence.jetbrains.com/display/TCD10/Statistic+Charts">statistic charts</a> if you use Teamcity for your CI builds.
Most of time you will end up extracting data from your CI server via the corresponding REST API (see <a href="https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API">Jenkins remote access API</a> and <a href="https://confluence.jetbrains.com/display/TCD10/REST+API">Teamcity REST API</a>).</p>
</div>
<div class="paragraph">
<p>Typically, CI builds above a certain size include parallel sections to utilize multiple agents. With parallel pipelines you can measure the wall-clock time it takes for a set of changes to go from having been pushed to version control to being built, verified and deployed. The build cache&#8217;s effect in this case can be measured in the reduction of the time developers have to wait for feedback from CI.</p>
</div>
<div class="paragraph">
<p>You can also measure the cumulative time your build agents spent building a changeset, which will give you a sense of the amount of work the CI infrastructure has to exert. The cache&#8217;s effect here is less money spent on CI resources, as you don&#8217;t need as many CI agents to maintain the same number of changes built.</p>
</div>
<div class="paragraph">
<p>If you want to look at the measurement for the Gradle build itself you can have a look at the blog post <a href="https://blog.gradle.org/introducing-gradle-build-cache">"Introducing the build cache"</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="measuring_developer_builds"><a class="anchor" href="#measuring_developer_builds"></a><a class="link" href="#measuring_developer_builds">Measuring developer builds</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s build cache can be very useful in reducing CI infrastructure cost and feedback time, but it usually has the biggest impact when developers can reuse cached results in their local builds. This is also the hardest to quantify for a number of reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>developers run different builds</p>
</li>
<li>
<p>developers can have different hardware, or have different settings</p>
</li>
<li>
<p>developers run all kinds of other things on their machines that can slow them down</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When using Develocity you can use the <a href="https://docs.gradle.com/enterprise/export-api/">Export API</a> to extract data about developer builds, too.
You can then create statistics on how many tasks were cached per developer or build.
You can even compare the times it took to execute the task vs loading it from the cache and then estimate the time saved per developer.</p>
</div>
<div class="paragraph">
<p>When using the <a href="https://gradle.com/build-cache">Develocity build cache backend</a> you should pay close attention to the hit rate in the admin UI.
A rise in the hit rate there probably indicates better usage by developers:</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/cache-admin-hit-rate.png" alt="build cache hit rate">
</div>
</div>
</div>
<div class="sect3">
<h4 id="analyzing_performance_in_build_scan"><a class="anchor" href="#analyzing_performance_in_build_scan"></a><a class="link" href="#analyzing_performance_in_build_scan">Analyzing performance in Build Scan</a></h4>
<div class="paragraph">
<p>A Build Scan provides a summary of all cache operations for a build via the <em>"Build cache"</em> section of the <em>"Performance"</em> page.</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/build-cache-performance.png" alt="build cache performance">
</div>
</div>
<div class="paragraph">
<p>This page details which tasks were able to be avoided by cache hits, and which missed.
It also indicates the hits and misses for the local and remote caches individually.
For remote cache operations, the time taken to transfer artifacts to and from the cache is given, along with the transfer rate.
This is particularly important for assessing the impact of network link quality on performance, as transfer times contribute to build time.</p>
</div>
</div>
<div class="sect3">
<h4 id="remote_cache_performance"><a class="anchor" href="#remote_cache_performance"></a><a class="link" href="#remote_cache_performance">Remote cache performance</a></h4>
<div class="paragraph">
<p>Improving the network link between the build and the remote cache can significantly improve build cache performance.
How to do this depends on the remote cache in use and your network environment.</p>
</div>
<div class="paragraph">
<p>The multi-node remote build cache provided by Develocity is a fast and efficient, purpose built, remote build cache.
In particular, if your development team is geographically distributed, its replication features can significantly improve performance by allowing developers to use a cache that they have a good network link to.
See the <a href="https://docs.gradle.com/develocity/helm-admin/current/#replication">"Build Cache Replication" section of the Develocity Admin Manual</a> for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="important_concepts"><a class="anchor" href="#important_concepts"></a><a class="link" href="#important_concepts">Important concepts</a></h3>
<div class="paragraph">
<p>How much of your build gets loaded from the cache depends on many factors.
In this section you will see some of the tools that are essential for well-cached builds.
<a href="https://gradle.com/develocity/product/build-scan">Build Scan</a> is part of that toolchain and will be used throughout this guide.</p>
</div>
<div class="sect3">
<h4 id="build_cache_key"><a class="anchor" href="#build_cache_key"></a><a class="link" href="#build_cache_key">Build cache key</a></h4>
<div class="paragraph">
<p>Artifacts in the build cache are uniquely identified by a <a href="#sec:task_output_caching_details">build cache key</a>.
A build cache key is assigned to each cacheable task when running with the build cache enabled and is used for both loading and storing task outputs to the build cache.
The following inputs contribute to the build cache key for a task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task implementation</p>
</li>
<li>
<p>The task action implementations</p>
</li>
<li>
<p>The names of the output properties</p>
</li>
<li>
<p>The names and values of task inputs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Two tasks can reuse their outputs by using the build cache if their associated build cache keys are the same.</p>
</div>
</div>
<div class="sect3">
<h4 id="concepts_repeatable_task_outputs"><a class="anchor" href="#concepts_repeatable_task_outputs"></a><a class="link" href="#concepts_repeatable_task_outputs">Repeatable task outputs</a></h4>
<div class="paragraph">
<p>Assume that you have a code generator task as part of your build.
When you have a fully up to date build and you clean and re-run the code generator task on the same code base it should generate <em>exactly the same output</em>, so anything that depends on that output will stay up-to-date.</p>
</div>
<div class="paragraph">
<p>It might also be that your code generator adds some extra information to its output that doesn&#8217;t depend on its declared inputs, like a timestamp.
In such a case re-executing the task <em>will</em> result in different code being generated (because the timestamp will be updated).
Tasks that depend on the code generator&#8217;s output will need to be re-executed.</p>
</div>
<div class="paragraph">
<p>When a task is cacheable, then the very nature of task output caching makes sure that the task will have the same outputs for a given set of inputs.
Therefore, cacheable tasks should have repeatable task outputs.
If they don&#8217;t, then the result of executing the task and loading the task from the cache may be different, which can lead to hard-to-diagnose cache misses.</p>
</div>
<div class="paragraph">
<p>In some cases even well-trusted tools can produce non-repeatable outputs, and lead to cascading effects.
One example is Oracle&#8217;s Java compiler, which, <a href="https://bugs.java.com/bugdatabase/view_bug.do?bug_id=8067422">due to a bug</a>, was producing different bytecode depending on the order source files to be compiled were presented to it.
If you were using Oracle JDK 8u31 or earlier to compile code in the <code>buildSrc</code> subproject, this could lead to all of your custom tasks producing occasional cache misses, because of the difference in their classpaths (which include <code>buildSrc</code>).</p>
</div>
<div class="paragraph">
<p>The key here is that cacheable tasks should not use non-repeatable task outputs as an input.</p>
</div>
</div>
<div class="sect3">
<h4 id="stable_task_inputs"><a class="anchor" href="#stable_task_inputs"></a><a class="link" href="#stable_task_inputs">Stable task inputs</a></h4>
<div class="paragraph">
<p>Having a task repeatably produce the same output is not enough if its inputs keep changing all the time.
Such unstable inputs can be supplied directly to the task. Consider a version number that includes a timestamp being added to the jar file&#8217;s manifest:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">version = "3.2-${System.currentTimeMillis()}"

tasks.jar {
    manifest {
        attributes(mapOf("Implementation-Version" to project.version))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">version = "3.2-${System.currentTimeMillis()}"

tasks.named('jar') {
    manifest {
        attributes('Implementation-Version': project.version)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the above example the inputs for the <code>jar</code> task will be different for each build execution since this timestamp will continually change.</p>
</div>
<div class="paragraph">
<p>Another example for unstable inputs is the commit ID from version control.
Maybe your version number is generated via <code>git describe</code> (and you include it in the jar manifest as shown above).
Or maybe you include the commit hash directly in <code>version.properties</code> or a jar manifest attribute.
Either way, the outputs produced by any tasks depending on such data will only be re-usable by builds running against the exact same commit.</p>
</div>
<div class="paragraph">
<p>Another common, but less obvious source of unstable inputs is when a task consumes the output of another task which produces non-repeatable results, such as the example before of a code generator that embeds timestamps in its output.</p>
</div>
<div class="paragraph">
<p>A task can only be loaded from the cache if it has stable task inputs.
Unstable task inputs result in the task having a unique set of inputs for every build, which will always result in a cache miss.</p>
</div>
</div>
<div class="sect3">
<h4 id="normalization"><a class="anchor" href="#normalization"></a><a class="link" href="#normalization">Better reuse via input normalization</a></h4>
<div class="paragraph">
<p>Having stable inputs is crucial for cacheable tasks.
However, achieving byte for byte identical inputs for each task can be challenging.
In some cases sanitizing the output of a task to remove unnecessary information can be a good approach, but this also means that a task&#8217;s output can only be normalized for a single purpose.</p>
</div>
<div class="paragraph">
<p>This is where <a href="incremental_build.html#sec:configure_input_normalization">input normalization</a> comes into play.
Input normalization is used by Gradle to determine if two task inputs are <em>essentially</em> the same.
Gradle uses normalized inputs when doing up-to-date checks and when determining if a cached result can be re-used instead of executing the task.
As input normalization is declared by the task <em>consuming</em> the data as input, different tasks can define different ways to normalize the same data.</p>
</div>
<div class="paragraph">
<p>When it comes to file inputs, Gradle can normalize the path of the files as well as their contents.</p>
</div>
<div class="sect4">
<h5 id="relocatability"><a class="anchor" href="#relocatability"></a><a class="link" href="#relocatability">Path sensitivity and relocatability</a></h5>
<div class="paragraph">
<p>When sharing cached results between computers, it&#8217;s rare that everyone runs the build from the exact same location on their computers.
To allow cached results to be shared even when builds are executed from different root directories, Gradle needs to understand which inputs can be relocated and which cannot.</p>
</div>
<div class="paragraph">
<p>Tasks having files as inputs can declare the parts of a file&#8217;s path what are essential to them: this is called the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/PathSensitive.html"><em>path sensitivity</em></a> of the input.
Task properties declared with <code>ABSOLUTE</code> path sensitivity are considered non-relocatable.
This is the default for properties not declaring path sensitivity, too.</p>
</div>
<div class="paragraph">
<p>For example, the class files produced by the Java compiler are dependent on the file names of the Java source files: renaming the source files with public classes in them would fail the build.
Though moving the files around wouldn&#8217;t have an effect on the result of the compilation, for incremental compilation the <code>JavaCompile</code> task relies on the relative path to find other classes in the same package.
Therefore, the path sensitivity for the sources of the <code>JavaCompile</code> task is <code>RELATIVE</code>.
Because of this only the normalized (relative) paths of the Java source files are considered as inputs to the <code>JavaCompile</code> task.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Java compiler only respects the package declaration in the Java source files, not the relative path of the sources.
As a consequence, path sensitivity for Java sources is <code>NAME_ONLY</code> and not <code>RELATIVE</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="content_normalization"><a class="anchor" href="#content_normalization"></a><a class="link" href="#content_normalization">Content normalization</a></h5>
<div class="sect5">
<h6 id="compile_avoidance"><a class="anchor" href="#compile_avoidance"></a><a class="link" href="#compile_avoidance">Compile avoidance for Java</a></h6>
<div class="paragraph">
<p>When it comes to the dependencies of a <code>JavaCompile</code> task (i.e. its <em>compile classpath),</em> only changes to the Application Binary Interface (ABI) of these dependencies require compilation to be executed.
Gradle has a deep understanding of what a compile classpath is and uses a sophisticated normalization strategy for it.
Task outputs can be re-used as long as the ABI of the classes on the compile classpath stays the same.
This enables Gradle to avoid Java compilation by using incremental builds, or load results from the cache that were produced by different (but ABI-compatible) versions of dependencies.
For more information on compile avoidance see the <a href="java_plugin.html#sec:java_compile_avoidance">corresponding section</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="runtime_classpath"><a class="anchor" href="#runtime_classpath"></a><a class="link" href="#runtime_classpath">Runtime classpath normalization</a></h6>
<div class="paragraph">
<p>Similar to compile avoidance, Gradle also understands the concept of a runtime classpath, and uses tailored input normalization to avoid running e.g. tests.
For runtime classpaths Gradle inspects the contents of jar files and ignores the timestamps and order of the entries in the jar file.
This means that a rebuilt jar file would be considered the same runtime classpath input.
For details on what level of understanding Gradle has for detecting changes to classpaths and what is considered as a classpath see <a href="incremental_build.html#sec:task_input_using_classpath_annotations">this section</a>.</p>
</div>
<div class="sect6">
<h7 id="filter_runtime_classpath"><a class="anchor" href="#filter_runtime_classpath"></a><a class="link" href="#filter_runtime_classpath">Filtering runtime classpaths</a></h7>
<div class="paragraph">
<p>For a runtime classpath it is possible to provide better insights to Gradle which files are essential to the input by <a href="incremental_build.html#sec:configure_input_normalization">configuring input normalization</a>.</p>
</div>
<div class="paragraph">
<p>Given that you want to add a file <code>build-info.properties</code> to all your produced jar files which contains volatile information about the build, e.g. the timestamp when the build started or some ID to identify the CI job that published the artifact.
This file is only used for auditing purposes, and has no effect on the outcome of running tests.
Nonetheless, this file is part of the runtime classpath for the <code>test</code> task. Since the file changes on every build invocation, tests cannot be cached effectively.
To fix this you can ignore <code>build-info.properties</code> on any runtime classpath by adding the following configuration to the build script in the <em>consuming</em> project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">normalization {
    runtimeClasspath {
        ignore("build-info.properties")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">normalization {
    runtimeClasspath {
        ignore 'build-info.properties'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If adding such a file to your jar files is something you do for all of the projects in your build, and you want to filter this file for all consumers, you may wrap the configurations described above in an <code>allprojects {}</code> or <code>subprojects {}</code> block in the root build script.</p>
</div>
<div class="paragraph">
<p>The effect of this configuration would be that changes to <code>build-info.properties</code> would be ignored for both up-to-date checks and task output caching.
All runtime classpath inputs for all tasks in the project where this configuration has been made will be affected.
This will not change the runtime behavior of the <code>test</code> task&#8201;&#8212;&#8201;i.e. any test is still able to load <code>build-info.properties</code>, and the runtime classpath stays the same as before.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="concepts_overlapping_outputs"><a class="anchor" href="#concepts_overlapping_outputs"></a><a class="link" href="#concepts_overlapping_outputs">The case against overlapping outputs</a></h4>
<div class="paragraph">
<p>When two tasks write to the same output directory or output file, it is difficult for Gradle to determine which output belongs to which task.
There are many edge cases, and executing the tasks in parallel cannot be done safely.
For the same reason, Gradle cannot remove <a href="incremental_build.html#sec:stale_task_outputs">stale output files</a> for these tasks.
Tasks that have discrete, non-overlapping outputs can always be handled in a safe fashion by Gradle.
For the aforementioned reasons, task output caching is automatically disabled for tasks whose output directories overlap with another task.</p>
</div>
<div class="paragraph">
<p>A Build Scan shows tasks where caching was disabled due to overlapping outputs in the timeline:</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/overlapping-outputs-timeline.png" alt="overlapping outputs timeline">
</div>
</div>
</div>
<div class="sect3">
<h4 id="reuse_of_outputs_between_different_tasks"><a class="anchor" href="#reuse_of_outputs_between_different_tasks"></a><a class="link" href="#reuse_of_outputs_between_different_tasks">Reuse of outputs between different tasks</a></h4>
<div class="paragraph">
<p>Some builds exhibit a surprising characteristic: even when executed against an empty cache, they produce tasks loaded from cache. How is this possible? Rest assured that this is completely normal.</p>
</div>
<div class="paragraph">
<p>When considering task outputs, Gradle only cares about the inputs to the task: the task type itself, input files and parameters etc., but it doesn&#8217;t care about the task&#8217;s name or which project it can be found in.
Running <code>javac</code> will produce the same output regardless of the name of the <code>JavaCompile</code> task that invoked it.
If your build includes two tasks that share every input, the one executing later will be able to reuse the output produced by the first.</p>
</div>
<div class="paragraph">
<p>Having two tasks in the same build that do the same might sound like a problem to fix, but it is not necessarily something bad.
For example, the Android plugin creates several tasks for each variant of the project; some of those tasks will potentially do the same thing.
These tasks can safely reuse each other&#8217;s outputs.</p>
</div>
<div class="paragraph">
<p>As <a href="#share_results_between_ci_builds">discussed previously</a>, you can use Develocity to diagnose the source build of these unexpected cache-hits.</p>
</div>
</div>
<div class="sect3">
<h4 id="non_cacheable_tasks"><a class="anchor" href="#non_cacheable_tasks"></a><a class="link" href="#non_cacheable_tasks">Non-cacheable tasks</a></h4>
<div class="paragraph">
<p>You&#8217;ve seen quite a bit about cacheable tasks, which implies there are non-cacheable ones, too. If caching task outputs is as awesome as it sounds, why not cache every task?</p>
</div>
<div class="paragraph">
<p>There are tasks that are definitely worth caching: tasks that do complex, repeatable processing and produce moderate amounts of output. Compilation tasks are usually ideal candidates for caching.
At the other end of the spectrum lie I/O-heavy tasks, like <code>Copy</code> and <code>Sync</code>. Moving files around locally typically cannot be sped up by copying them from a cache.
Caching those tasks would even waste good resources by storing all those redundant results in the cache.</p>
</div>
<div class="paragraph">
<p>Most tasks are either obviously worth caching, or obviously not. For those in-between a good rule of thumb is to see if downloading results would be significantly faster than producing them locally.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="caching_java_projects"><a class="anchor" href="#caching_java_projects"></a><a class="link" href="#caching_java_projects">Caching Java projects</a></h3>
<div class="paragraph">
<p>As of Gradle 4.0, the build tool fully supports caching plain Java projects.
Built-in tasks for compiling, testing, documenting and checking the quality of Java code support the build cache out of the box.</p>
</div>
<div class="sect3">
<h4 id="java_compilation"><a class="anchor" href="#java_compilation"></a><a class="link" href="#java_compilation">Java compilation</a></h4>
<div class="paragraph">
<p>Caching Java compilation makes use of Gradle&#8217;s deep understanding of compile classpaths.
The mechanism <a href="#compile_avoidance">avoids recompilation</a> when dependencies change in a way that doesn&#8217;t affect their application binary interfaces (ABI).
Since the cache key is only influenced by the ABI of dependencies (and not by their implementation details like private types and method bodies), task output caching can also reuse compiled classes if they were produced by the same sources and ABI-equivalent dependencies.</p>
</div>
<div class="paragraph">
<p>For example, take a project with two modules: an application depending on a library.
Suppose the latest version is already built by CI and uploaded to the shared cache.
If a developer now modifies a method&#8217;s body in the library, the library will need to be rebuilt on their computer. But they will be able to load the compiled classes for the application from the shared cache. Gradle can do this because the library used to compile the application on CI, and the modified library available locally share the same ABI.</p>
</div>
<div class="sect4">
<h5 id="annotation_processors"><a class="anchor" href="#annotation_processors"></a><a class="link" href="#annotation_processors">Annotation processors</a></h5>
<div class="paragraph">
<p>Compile avoidance works out of the box.
There is one caveat though: when using annotation processors, Gradle uses the annotation processor classpath as an input.
Unlike most compile dependencies, in which only the ABI influences compilation, the <em>implementation</em> of annotation processors must be considered as an input to the compiler. For this reason Gradle will treat annotation processors as a <em>runtime</em> classpath, meaning less <a href="#runtime_classpath">input normalization</a> is taking place there.
If Gradle detects an annotation processor on the compile classpath, the annotation processor classpath defaults to the compile classpath when not explicitly set, which in turn means the entire compile classpath is treated as a runtime classpath input.</p>
</div>
<div class="paragraph">
<p>For the example above this would mean the ABI extracted from the compile classpath would be unchanged, but the annotation processor classpath (because it&#8217;s not treated with compile avoidance) would be different. Ultimately, the developer would end up having to recompile the application.</p>
</div>
<div class="paragraph">
<p>The easiest way to avoid this performance penalty is to not use annotation processors.
However, if you need to use them, make sure you set the annotation processor classpath explicitly to include only the libraries needed for annotation processing.
The <a href="java_plugin.html#sec:java_compile_avoidance">section on Java compile avoidance</a> describes how to do this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Some common Java dependencies (such as Log4j 2.x) come bundled with annotation processors.
If you use these dependencies, but do not leverage the features of the bundled annotation processors, it&#8217;s best to disable annotation processing entirely.
This can be done by setting the annotation processor classpath to an empty set.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unit_test_execution"><a class="anchor" href="#unit_test_execution"></a><a class="link" href="#unit_test_execution">Unit test execution</a></h4>
<div class="paragraph">
<p>The <code>Test</code> task used for test execution for JVM languages employs <a href="#runtime_classpath">runtime classpath normalization</a> for its classpath.
This means that changes to order and timestamps in jars on the test classpath will not cause the task to be out-of-date or change the build cache key.
For achieving <a href="#stable_task_inputs">stable task inputs</a> you can also wield the power of <a href="#filter_runtime_classpath">filtering the runtime classpath</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="integration_test_execution"><a class="anchor" href="#integration_test_execution"></a><a class="link" href="#integration_test_execution">Integration test execution</a></h4>
<div class="paragraph">
<p>Unit tests are easy to cache as they normally have no external dependencies.
For integration tests the situation can be quite different, as they can depend on a variety of inputs outside of the test and production code.
These external factors can be for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>operating system type and version,</p>
</li>
<li>
<p>external tools being installed for the tests,</p>
</li>
<li>
<p>environment variables and Java system properties,</p>
</li>
<li>
<p>other services being up and running,</p>
</li>
<li>
<p>a distribution of the software under test.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You need to be careful to declare these additional inputs for your integration test in order to avoid incorrect cache hits.
For example, declaring the operating system in use by Gradle as an input to a <code>Test</code> task called <code>integTest</code> would work as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.integTest {
    inputs.property("operatingSystem") {
        System.getProperty("os.name")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('integTest') {
    inputs.property("operatingSystem") {
        System.getProperty("os.name")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="archives_as_inputs"><a class="anchor" href="#archives_as_inputs"></a><a class="link" href="#archives_as_inputs">Archives as inputs</a></h5>
<div class="paragraph">
<p>It is common for the integration tests to depend on your packaged application.
If this happens to be a zip or tar archive, then adding it as an input to the integration test task may lead to cache misses.
This is because, as described in <a href="#concepts_repeatable_task_outputs">repeatable task outputs</a>, rebuilding an archive often changes the metadata in the archive.
You can depend on the exploded contents of the archive instead.
See also the section on dealing with <a href="#volatile_outputs">non-repeatable outputs</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="dealing_with_file_paths"><a class="anchor" href="#dealing_with_file_paths"></a><a class="link" href="#dealing_with_file_paths">Dealing with file paths</a></h5>
<div class="paragraph">
<p>You will probably pass some information from the build environment to your integration test tasks by using system properties.
Passing absolute paths will break <a href="#relocatability">relocatability</a> of the integration test task.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Don't do this! Breaks relocatability!
tasks.integTest {
    systemProperty("distribution.location", layout.buildDirectory.dir("dist").get().asFile.absolutePath)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Don't do this! Breaks relocatability!
tasks.named('integTest') {
    systemProperty "distribution.location", layout.buildDirectory.dir('dist').get().asFile.absolutePath
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Instead of adding the absolute path directly as a system property, it is possible to add an
annotated <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/CommandLineArgumentProvider.html">CommandLineArgumentProvider</a> to the <code>integTest</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class DistributionLocationProvider : CommandLineArgumentProvider {  // <b class="conum">(1)</b>
    @get:InputDirectory
    @get:PathSensitive(PathSensitivity.RELATIVE)  // <b class="conum">(2)</b>
    abstract val distribution: DirectoryProperty

    override fun asArguments(): Iterable&lt;String&gt; =
        listOf("-Ddistribution.location=${distribution.get().asFile.absolutePath}")  // <b class="conum">(3)</b>
}

tasks.integTest {
    jvmArgumentProviders.add(
        objects.newInstance&lt;DistributionLocationProvider&gt;().apply {  // <b class="conum">(4)</b>
            distribution = layout.buildDirectory.dir("dist")
        }
    )
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class DistributionLocationProvider implements CommandLineArgumentProvider {  // <b class="conum">(1)</b>
    @InputDirectory
    @PathSensitive(PathSensitivity.RELATIVE)  // <b class="conum">(2)</b>
    abstract DirectoryProperty getDistribution()

    @Override
    Iterable&lt;String&gt; asArguments() {
        ["-Ddistribution.location=${distribution.get().asFile.absolutePath}"]  // <b class="conum">(3)</b>
    }
}

tasks.named('integTest') {
    jvmArgumentProviders.add(
        objects.newInstance(DistributionLocationProvider).tap {  // <b class="conum">(4)</b>
            distribution = layout.buildDirectory.dir('dist')
        }
    )
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Create a class implementing <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/CommandLineArgumentProvider.html"><code>CommandLineArgumentProvider</code></a>.</p>
</li>
<li>
<p>Declare the inputs and outputs with the corresponding path sensitivity.</p>
</li>
<li>
<p><code>asArguments</code> needs to return the JVM arguments passing the desired system properties to the test JVM.</p>
</li>
<li>
<p>Add an instance of the newly created class as JVM argument provider to the integration test task.<sup class="footnote" id="_footnote_managedTypes">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="ignoring_system_properties"><a class="anchor" href="#ignoring_system_properties"></a><a class="link" href="#ignoring_system_properties">Ignoring system properties</a></h5>
<div class="paragraph">
<p>It may be necessary to ignore some system properties as inputs as they do not influence the outcome of the integration tests.
In order to do so, add a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/CommandLineArgumentProvider.html">CommandLineArgumentProvider</a> to the <code>integTest</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class CiEnvironmentProvider : CommandLineArgumentProvider {
    @get:Internal  // <b class="conum">(1)</b>
    abstract val agentNumber: Property&lt;String&gt;

    override fun asArguments(): Iterable&lt;String&gt; =
        listOf("-DagentNumber=${agentNumber.get()}")  // <b class="conum">(2)</b>
}

tasks.integTest {
    jvmArgumentProviders.add(
        objects.newInstance&lt;CiEnvironmentProvider&gt;().apply {  // <b class="conum">(3)</b>
            agentNumber = providers.environmentVariable("AGENT_NUMBER").orElse("1")
        }
    )
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class CiEnvironmentProvider implements CommandLineArgumentProvider {
    @Internal  // <b class="conum">(1)</b>
    abstract Property&lt;String&gt; getAgentNumber()

    @Override
    Iterable&lt;String&gt; asArguments() {
        ["-DagentNumber=${agentNumber.get()}"]  // <b class="conum">(2)</b>
    }
}

tasks.named('integTest') {
    jvmArgumentProviders.add(
        objects.newInstance(CiEnvironmentProvider).tap {  // <b class="conum">(3)</b>
            agentNumber = providers.environmentVariable("AGENT_NUMBER").orElse("1")
        }
    )
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>@Internal</code> means that this property does not influence the output of the integration tests.</p>
</li>
<li>
<p>The system properties for the actual test execution.</p>
</li>
<li>
<p>Add an instance of the newly created class as JVM argument provider to the integration test task.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup></p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="caching_android_projects"><a class="anchor" href="#caching_android_projects"></a><a class="link" href="#caching_android_projects">Caching Android projects</a></h3>
<div class="paragraph">
<p>While it is true that Android uses the Java toolchain as its foundation, there are nevertheless some significant differences from pure Java projects; these differences impact task cacheability.
This is even more true for Android projects that include Kotlin source code (and therefore use the <code>kotlin-android</code> plugin).</p>
</div>
<div class="sect3">
<h4 id="disambiguation"><a class="anchor" href="#disambiguation"></a><a class="link" href="#disambiguation">Disambiguation</a></h4>
<div class="paragraph">
<p>This guide is about Gradles build cache, but you may have also heard about the Android build cache.
These are different things.
The Android cache is internal to certain tasks in the Android plugin, and will eventually be removed in favor of native Gradle support.</p>
</div>
</div>
<div class="sect3">
<h4 id="why_use_the_build_cache"><a class="anchor" href="#why_use_the_build_cache"></a><a class="link" href="#why_use_the_build_cache">Why use the build cache?</a></h4>
<div class="paragraph">
<p>The build cache can <em>significantly</em> improve build performance for Android projects, in many cases by 30-40%.
Many of the compilation and assembly tasks provided by the Android Gradle Plugin are cacheable, and more are made so with each new iteration.</p>
</div>
<div class="sect4">
<h5 id="faster_ci_builds"><a class="anchor" href="#faster_ci_builds"></a><a class="link" href="#faster_ci_builds">Faster CI builds</a></h5>
<div class="paragraph">
<p>CI builds benefit particularly from the build cache.
A typical CI build starts with a <code>clean</code>, which means that pre-existing build outputs are deleted and none of the tasks that make up the build will be <code>UP-TO-DATE</code>.
However, it is likely that many of those tasks will have been run with exactly the same inputs in a prior CI build, populating the build cache; the outputs from those prior runs can safely be reused, resulting in dramatic build performance improvements.</p>
</div>
</div>
<div class="sect4">
<h5 id="reusing_ci_builds_for_local_development"><a class="anchor" href="#reusing_ci_builds_for_local_development"></a><a class="link" href="#reusing_ci_builds_for_local_development">Reusing CI builds for local development</a></h5>
<div class="paragraph">
<p>When you sign into work at the start of your day, its not unusual for your first task to be pulling the main branch and then running a build (Android Studio will probably do the latter, whether you ask it to or not).
Assuming all merges to main are built on CI (a best practice!), you can expect this first local build of the day to enjoy a larger-than-typical benefit with Gradles <em>remote cache</em>.
CI already built this commit&#8201;&#8212;&#8201;why should you re-do that work?</p>
</div>
</div>
<div class="sect4">
<h5 id="switching_branches"><a class="anchor" href="#switching_branches"></a><a class="link" href="#switching_branches">Switching branches</a></h5>
<div class="paragraph">
<p>During local development, it is not uncommon to switch branches several times per day.
This defeats <a href="incremental_build.html#incremental_build">incremental build</a> (i.e., <code>UP-TO-DATE</code> checks), but this issue is mitigated via the use of the local build cache.
You might run a build on Branch A, which will populate the local cache.
You then switch to Branch B to conduct a code review, help a colleague, or address feedback on an open PR.
You then switch back to Branch A to continue your original work.
When you next build, all of the outputs previously built while working on Branch A can be reused from the cache, saving potentially a lot of time.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the_android_gradle_plugin"><a class="anchor" href="#the_android_gradle_plugin"></a><a class="link" href="#the_android_gradle_plugin">The Android Gradle Plugin</a></h4>
<div class="paragraph">
<p>Android Studio users should use the latest Android Gradle Plugin to ensure compatibility and benefit from performance improvements in new releases.</p>
</div>
<div class="paragraph">
<p>The first thing you should always do when working to optimize your build is ensure youre on the latest stable, supported versions of the Android Gradle Plugin and the Gradle Build Tool.
At the time of writing, they are 3.3.0 and 5.0, respectively.
Each new version of these tools includes many performance improvements, not least of which is to the build cache.</p>
</div>
</div>
<div class="sect3">
<h4 id="java_and_kotlin_compilation"><a class="anchor" href="#java_and_kotlin_compilation"></a><a class="link" href="#java_and_kotlin_compilation">Java and Kotlin compilation</a></h4>
<div class="paragraph">
<p>The <a href="#java_compilation">discussion</a> above in "Caching Java projects" is equally relevant here, with the caveat that, for projects that include Kotlin source code, the Kotlin compiler does not currently support <a href="java_plugin.html#sec:java_compile_avoidance">compile avoidance</a> in the way that the Java compiler does.</p>
</div>
</div>
<div class="sect3">
<h4 id="annotation_processors_and_kotlin"><a class="anchor" href="#annotation_processors_and_kotlin"></a><a class="link" href="#annotation_processors_and_kotlin">Annotation processors and Kotlin</a></h4>
<div class="paragraph">
<p>The <a href="#annotation_processors">advice above</a> for pure Java projects also applies to Android projects.
However, if you are using annotation processors (such as Dagger2 or Butterknife) in conjunction with Kotlin and the kotlin-kapt plugin, you should know that before Kotlin 1.3.30 kapt <a href="https://youtrack.jetbrains.com/issue/KT-27675">was not cached by default</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://blog.jetbrains.com/kotlin/2018/01/kotlin-1-2-20-is-out/">You can opt into it</a> (which is recommended) by adding the following to build scripts:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">pluginManager.withPlugin("kotlin-kapt") {
    configure&lt;KaptExtension&gt; { useBuildCache = true }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins.withId("kotlin-kapt") {
    kapt.useBuildCache = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unit_test_execution_2"><a class="anchor" href="#unit_test_execution_2"></a><a class="link" href="#unit_test_execution_2">Unit test execution</a></h4>
<div class="paragraph">
<p>Like unit tests in a pure Java project, the equivalent test task in an Android project (<code>AndroidUnitTest</code>) is also cacheable since Android Gradle Plugin 3.6.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="instrumented_test_execution_i_e_espresso_tests"><a class="anchor" href="#instrumented_test_execution_i_e_espresso_tests"></a><a class="link" href="#instrumented_test_execution_i_e_espresso_tests">Instrumented test execution (i.e., Espresso tests)</a></h4>
<div class="paragraph">
<p>Android instrumented tests (<code>DeviceProviderInstrumentTestTask</code>), often referred to as "Espresso" tests, are also not cacheable.
The Google Android team is also working to make such tests cacheable.
Please see <a href="https://issuetracker.google.com/issues/115873051">this issue</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="lint"><a class="anchor" href="#lint"></a><a class="link" href="#lint">Lint</a></h4>
<div class="paragraph">
<p>Users of Androids <code>Lint</code> task are well aware of the heavy performance penalty they pay for using it, but also know that it is indispensable for finding common issues in Android projects.
Currently, this task is not cacheable.
This task is planned to be cacheable with the release of Android Gradle Plugin 3.5.
This is another reason to always use the latest version of the Android plugin!</p>
</div>
</div>
<div class="sect3">
<h4 id="the_fabric_plugin_and_crashlytics"><a class="anchor" href="#the_fabric_plugin_and_crashlytics"></a><a class="link" href="#the_fabric_plugin_and_crashlytics">The Fabric Plugin and Crashlytics</a></h4>
<div class="paragraph">
<p>The <a href="https://docs.fabric.io/android/fabric/overview.html">Fabric</a> plugin, which is used to integrate the Crashlytics crash-reporting tool (among others), is very popular, yet imposes some hefty performance penalties during the build process.
This is due to the need for each version of your app to have a unique identifier so that it can be identified in the Crashlytics dashboard.
In practice, the default behavior of Crashlytics is to treat "each version" as synonymous with "each build".
This defeats <a href="incremental_build.html#incremental_build">incremental build</a>, because each build will be unique.
It also breaks the cacheability of certain tasks in the build, and for the same reason.
This can be fixed by simply disabling Crashlytics in "debug" builds.
You may find instructions for that in the <a href="https://docs.fabric.io/android/crashlytics/build-tools.html">Crashlytics documentation</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The fix described in the referenced documentation does not work directly if you are using the Kotlin DSL; see below for the workaround.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="kotlin_dsl"><a class="anchor" href="#kotlin_dsl"></a><a class="link" href="#kotlin_dsl">Kotlin DSL</a></h5>
<div class="paragraph">
<p>The fix described in the referenced documentation does not work directly if you are using the Kotlin DSL; this is due to incompatibilities between that Kotlin DSL and the Fabric plugin.
There is a simple workaround for this, based on <a href="#using_a_groovy_script">this advice</a> from the Kotlin DSL primer.</p>
</div>
<div class="paragraph">
<p>Create a file, <code>fabric.gradle</code>, in the module where you apply the <code>io.fabric</code> plugin. This file (known as a script plugin), should have the following contents:</p>
</div>
<div class="listingblock">
<div class="title">fabric.gradle</div>
<div class="content">
<pre>plugins.withId("com.android.application") { // or "com.android.library"
    android.buildTypes.debug.ext.enableCrashlytics = false
}</pre>
</div>
</div>
<div class="paragraph">
<p>And then, in the modules <code>build.gradle.kts</code> file, apply this script plugin:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre>apply(from = "fabric.gradle")</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="debugging_and_diagnosing_build_cache_misses"><a class="anchor" href="#debugging_and_diagnosing_build_cache_misses"></a><a class="link" href="#debugging_and_diagnosing_build_cache_misses">Debugging and diagnosing Build Cache misses</a></h3>
<div class="paragraph">
<p>To make the most of task output caching, it is important that any necessary inputs to your tasks are specified correctly, while at the same time avoiding unneeded inputs.
Failing to specify an input that affects the task&#8217;s outputs can result in incorrect builds, while needlessly specifying inputs that do not affect the task&#8217;s output can cause cache misses.</p>
</div>
<div class="paragraph">
<p>This chapter is about finding out why a cache miss happened.
If you have a cache hit which you didn&#8217;t expect we suggest to declare whatever change you expected to trigger the cache miss as an input to the task.</p>
</div>
<div class="sect3">
<h4 id="finding_problems"><a class="anchor" href="#finding_problems"></a><a class="link" href="#finding_problems">Finding problems with task output caching</a></h4>
<div class="paragraph">
<p>Below we describe a step-by-step process that should help shake out any problems with caching in your build.</p>
</div>
<div class="sect4">
<h5 id="ensure_incremental_build_works"><a class="anchor" href="#ensure_incremental_build_works"></a><a class="link" href="#ensure_incremental_build_works">Ensure incremental build works</a></h5>
<div class="paragraph">
<p>First, make sure your build does the right thing without the cache.
Run a build twice without enabling the Gradle build cache.
The expected outcome is that all actionable tasks that produce file outputs are up-to-date.
You should see something like this on the command-line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew clean --quiet <b class="conum">(1)</b>
$ ./gradlew assemble <b class="conum">(2)</b>

BUILD SUCCESSFUL
4 actionable tasks: 4 executed

$ ./gradlew assemble <b class="conum">(3)</b>

BUILD SUCCESSFUL
4 actionable tasks: 4 up-to-date</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Make sure we start without any leftover results by running <code>clean</code> first.</p>
</li>
<li>
<p>We are assuming your build is represented by running the <code>assemble</code> task in these examples, but you can substitute whatever tasks make sense for your build.</p>
</li>
<li>
<p>Run the build again without running <code>clean</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Tasks that have no outputs or no inputs will always be executed, but that shouldn&#8217;t be a problem.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the methods as described below to <a href="#diagnosing_cache_miss">diagnose</a> and <a href="#common-problems">fix</a> tasks that should be up-to-date but aren&#8217;t.
If you find a task which is out of date, but no cacheable tasks depends on its outcome, then you don&#8217;t have to do anything about it.
The goal is to achieve <a href="#stable_task_inputs">stable task inputs</a> for cacheable tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="in-place_caching_test"><a class="anchor" href="#in-place_caching_test"></a><a class="link" href="#in-place_caching_test">In-place caching with the local cache</a></h5>
<div class="paragraph">
<p>When you are happy with the up-to-date performance then you can repeat the experiment above, but this time with a clean build, and the build cache turned on.
The goal with clean builds and the build cache turned on is to retrieve all cacheable tasks from the cache.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
When running this test make sure that you have no <code>remote</code> cache configured, and storing in the <code>local</code> cache is enabled.
These are the default settings.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This would look something like this on the command-line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ rm -rf ~/.gradle/caches/build-cache-1 <b class="conum">(1)</b>
$ ./gradlew clean --quiet <b class="conum">(2)</b>
$ ./gradlew assemble --build-cache <b class="conum">(3)</b>

BUILD SUCCESSFUL
4 actionable tasks: 4 executed

$ ./gradlew clean --quiet <b class="conum">(4)</b>
$ ./gradlew assemble --build-cache <b class="conum">(5)</b>

BUILD SUCCESSFUL
4 actionable tasks: 1 executed, 3 from cache</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We want to start with an empty local cache.</p>
</li>
<li>
<p>Clean the project to remove any unwanted leftovers from previous builds.</p>
</li>
<li>
<p>Build it once to let it populate the cache.</p>
</li>
<li>
<p>Clean the project again.</p>
</li>
<li>
<p>Build it again: this time everything cacheable should load from the just populated cache.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should see all cacheable tasks loaded from cache, while non-cacheable tasks should be executed.</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/fully-cached-task-execution.png" alt="fully cached task execution">
</div>
</div>
<div class="paragraph">
<p>Again, use the below methods to <a href="#diagnosing_cache_miss">diagnose</a> and <a href="#common-problems">fix</a> cacheability issues.</p>
</div>
</div>
<div class="sect4">
<h5 id="caching_relocation_test"><a class="anchor" href="#caching_relocation_test"></a><a class="link" href="#caching_relocation_test">Testing cache relocatability</a></h5>
<div class="paragraph">
<p>Once everything loads properly while building the same checkout with the local cache enabled, it&#8217;s time to see if there are any <em>relocation problems.</em>
A task is considered <em>relocatable</em> if its output can be reused when the task is executed in a different location.
(More on this in <a href="#relocatability">path sensitivity and relocatability</a>.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Tasks that should be relocatable but aren&#8217;t are usually a result of absolute paths being present among the task&#8217;s inputs.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To discover these problems, first check out the same commit of your project in two different directories on your machine.
For the following example let&#8217;s assume we have a checkout in <code>\~/checkout-1</code> and <code>\~/checkout-2</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Like with the previous test, you should have no <code>remote</code> cache configured, and storing in the <code>local</code> cache should be enabled.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>$ rm -rf ~/.gradle/caches/build-cache-1 <b class="conum">(1)</b>
$ cd ~/checkout-1 <b class="conum">(2)</b>
$ ./gradlew clean --quiet <b class="conum">(3)</b>
$ ./gradlew assemble --build-cache <b class="conum">(4)</b>

BUILD SUCCESSFUL
4 actionable tasks: 4 executed

$ cd ~/checkout-2 <b class="conum">(5)</b>
$ ./gradlew clean --quiet <b class="conum">(6)</b>
$ ./gradlew clean assemble --build-cache <b class="conum">(7)</b>

BUILD SUCCESSFUL
4 actionable tasks: 1 executed, 3 from cache</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Remove all entries in the local cache first.</p>
</li>
<li>
<p>Go to the first checkout directory.</p>
</li>
<li>
<p>Clean the project to remove any unwanted leftovers from previous builds.</p>
</li>
<li>
<p>Run a build to populate the cache.</p>
</li>
<li>
<p>Go to the other checkout directory.</p>
</li>
<li>
<p>Clean the project again.</p>
</li>
<li>
<p>Run a build again.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should see the exact same results as you saw with the previous <a href="#in-place_caching_test">in place caching test</a> step.</p>
</div>
</div>
<div class="sect4">
<h5 id="cross_platform_tests"><a class="anchor" href="#cross_platform_tests"></a><a class="link" href="#cross_platform_tests">Cross-platform tests</a></h5>
<div class="paragraph">
<p>If your build passes the <a href="#caching_relocation_test">relocation test</a>, it is in good shape already.
If your build requires support for multiple platforms, it is best to see if the required tasks get reused between platforms, too.
A typical example of cross-platform builds is when CI runs on Linux VMs, while developers use macOS or Windows, or a different variety or version of Linux.</p>
</div>
<div class="paragraph">
<p>To test cross-platform cache reuse, set up a <code>remote</code> cache (see <a href="#share_results_between_ci_builds">share results between CI builds</a>) and populate it from one platform and consume it from the other.</p>
</div>
</div>
<div class="sect4">
<h5 id="incremental_cache_usage"><a class="anchor" href="#incremental_cache_usage"></a><a class="link" href="#incremental_cache_usage">Incremental cache usage</a></h5>
<div class="paragraph">
<p>After these experiments with fully cached builds, you can go on and try to make typical changes to your project and see if enough tasks are still cached.
If the results are not satisfactory, you can think about restructuring your project to reduce dependencies between different tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="evaluating_cache_performance_over_time"><a class="anchor" href="#evaluating_cache_performance_over_time"></a><a class="link" href="#evaluating_cache_performance_over_time">Evaluating cache performance over time</a></h5>
<div class="paragraph">
<p>Consider recording execution times of your builds, generating graphs, and analyzing the results.
Keep an eye out for certain patterns, like a build recompiling everything even though you expected compilation to be cached.</p>
</div>
<div class="paragraph">
<p>You can also make changes to your code base manually or automatically and check that the expected set of tasks is cached.</p>
</div>
<div class="paragraph">
<p>If you have tasks that are re-executing instead of loading their outputs from the cache, then it may point to a problem in your build.
Techniques for debugging a cache miss are explained in the following section.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="helpful_data_for_diagnosing_a_cache_miss"><a class="anchor" href="#helpful_data_for_diagnosing_a_cache_miss"></a><a class="link" href="#helpful_data_for_diagnosing_a_cache_miss">Helpful data for diagnosing a cache miss</a></h4>
<div class="paragraph">
<p>A cache miss happens when Gradle calculates a build cache key for a task which is different from any existing build cache key in the cache.
Only comparing the build cache key on its own does not give much information, so we need to look at some finer grained data to be able to diagnose the cache miss.
A list of all inputs to the computed build cache key can be found in the <a href="#sec:task_output_caching_details">section on cacheable tasks</a>.</p>
</div>
<div class="paragraph">
<p>From most coarse grained to most fine grained, the items we will use to compare two tasks are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Build cache keys</p>
</li>
<li>
<p>Task and Task action implementations</p>
<div class="ulist">
<ul>
<li>
<p>classloader hash</p>
</li>
<li>
<p>class name</p>
</li>
</ul>
</div>
</li>
<li>
<p>Task output property names</p>
</li>
<li>
<p>Individual task property input hashes</p>
</li>
<li>
<p>Hashes of files which are part of task input properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want information about the build cache key and individual input property hashes, use <a href="#sec:gradle_configuration_properties"><code>-Dorg.gradle.caching.debug=true</code></a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew :compileJava --build-cache -Dorg.gradle.caching.debug=true

.
.
.
Appending implementation to build cache key: org.gradle.api.tasks.compile.JavaCompile_Decorated@470c67ec713775576db4e818e7a4c75d
Appending additional implementation to build cache key: org.gradle.api.tasks.compile.JavaCompile_Decorated@470c67ec713775576db4e818e7a4c75d
Appending input value fingerprint for 'options' to build cache key: e4eaee32137a6a587e57eea660d7f85d
Appending input value fingerprint for 'options.compilerArgs' to build cache key: 8222d82255460164427051d7537fa305
Appending input value fingerprint for 'options.debug' to build cache key: f6d7ed39fe24031e22d54f3fe65b901c
Appending input value fingerprint for 'options.debugOptions' to build cache key: a91a8430ae47b11a17f6318b53f5ce9c
Appending input value fingerprint for 'options.debugOptions.debugLevel' to build cache key: f6bd6b3389b872033d462029172c8612
Appending input value fingerprint for 'options.encoding' to build cache key: f6bd6b3389b872033d462029172c8612
.
.
.
Appending input file fingerprints for 'options.sourcepath' to build cache key: 5fd1e7396e8de4cb5c23dc6aadd7787a - RELATIVE_PATH{EMPTY}
Appending input file fingerprints for 'stableSources' to build cache key: f305ada95aeae858c233f46fc1ec4d01 - RELATIVE_PATH{.../src/main/java=IGNORED / DIR, .../src/main/java/Hello.java='Hello.java' / 9c306ba203d618dfbe1be83354ec211d}
Appending output property name to build cache key: destinationDir
Appending output property name to build cache key: options.annotationProcessorGeneratedSourcesDirectory
Build cache key for task ':compileJava' is 8ebf682168823f662b9be34d27afdf77</pre>
</div>
</div>
<div class="paragraph">
<p>The log shows e.g. which source files constitute the <code>stableSources</code> for the <code>compileJava</code> task.
To find the actual differences between two builds you need to resort to matching up and comparing those hashes yourself.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<a href="https://docs.gradle.com/enterprise/tutorials/task-inputs-comparison/">Develocity</a> already takes care of this for you; it lets you quickly diagnose a cache miss with the Build Scan&#8482; Comparison tool.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="diagnosing_cache_miss"><a class="anchor" href="#diagnosing_cache_miss"></a><a class="link" href="#diagnosing_cache_miss">Diagnosing the reasons for a cache miss</a></h4>
<div class="paragraph">
<p>Having the data from the last section at hand, you should be able to diagnose why the outputs of a certain task were not found in the build cache.
Since you were expecting more tasks to be cached, you should be able to pinpoint a build which would have produced the artifact under question.</p>
</div>
<div class="paragraph">
<p>Before diving into how to find out why one task has not been loaded from the cache we should first look into which task caused the cache misses.
There is a cascade effect which causes dependent tasks to be executed if one of the tasks earlier in the build is not loaded from the cache and has different outputs.
Therefore, you should locate the first cacheable task which was executed and continue investigating from there.
This can be done from the timeline view in a Build Scan&#8482;:</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/first-non-cached-task.png" alt="first non cached task">
</div>
</div>
<div class="paragraph">
<p>At first, you should check if the implementation of the task changed. This would mean checking the class names and classloader hashes
for the task class itself and for each of its actions. If there is a change, this means that the build script, <code>buildSrc</code> or the Gradle version has changed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A change in the output of <code>buildSrc</code> also marks all the logic added by your build as changed.
Especially, custom actions added to cacheable tasks will be marked as changed.
This can be problematic, see <a href="#custom_actions">section about <code>doFirst</code> and <code>doLast</code></a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the implementation is the same, then you need to start comparing inputs between the two builds.
There should be at least one different input hash. If it is a simple value property, then the configuration of the task changed.
This can happen for example by</p>
</div>
<div class="ulist">
<ul>
<li>
<p>changing the build script,</p>
</li>
<li>
<p>conditionally configuring the task differently for CI or the developer builds,</p>
</li>
<li>
<p>depending on a system property or an environment variable for the task configuration,</p>
</li>
<li>
<p>or having an absolute path which is part of the input.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the changed property is a file property, then the reasons can be the same as for the change of a value property.
Most probably though a file on the filesystem changed in a way that Gradle detects a difference for this input.
The most common case will be that the source code was changed by a check in.
It is also possible that a file generated by a task changed, e.g. since it includes a timestamp.
As described in <a href="#java_version_tracking">Java version tracking</a>, the Java version can also influence the output of the Java compiler.
If you did not expect the file to be an input to the task, then it is possible that you should alter the configuration of the task to not include it.
For example, having your integration test configuration including all the unit test classes as a dependency has the effect that all integration tests
are re-executed when a unit test changes.
Another option is that the task tracks absolute paths instead of relative paths and the location of the project directory changed on disk.</p>
</div>
</div>
<div class="sect3">
<h4 id="example_24"><a class="anchor" href="#example_24"></a><a class="link" href="#example_24">Example</a></h4>
<div class="paragraph">
<p>We will walk you through the process of diagnosing a cache miss.
Let&#8217;s say we have build <code>A</code> and build <code>B</code> and we expected all the test tasks for a sub-project <code>sub1</code> to be cached in build <code>B</code> since only a unit test for another sub-project <code>sub2</code> changed.
Instead, all the tests for the sub-project have been executed.
Since we have the cascading effect when we have cache misses, we need to find the task which caused the caching chain to fail.
This can easily be done by filtering for all cacheable tasks which have been executed and then select the first one.
In our case, it turns out that the tests for the sub-project <code>internal-testing</code> were executed even though there was no code change to this project.
This means that the property <code>classpath</code> changed and some file on the runtime classpath actually did change.
Looking deeper into this, we actually see that the inputs for the task <code>processResources</code> changed in that project, too.
Finally, we find this in our build file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val currentVersionInfo = tasks.register&lt;CurrentVersionInfo&gt;("currentVersionInfo") {
    version = project.version as String
    versionInfoFile = layout.buildDirectory.file("generated-resources/currentVersion.properties")
}

sourceSets.main.get().output.dir(currentVersionInfo.map { it.versionInfoFile.get().asFile.parentFile })

abstract class CurrentVersionInfo : DefaultTask() {
    @get:Input
    abstract val version: Property&lt;String&gt;

    @get:OutputFile
    abstract val versionInfoFile: RegularFileProperty

    @TaskAction
    fun writeVersionInfo() {
        val properties = Properties()
        properties.setProperty("latestMilestone", version.get())
        versionInfoFile.get().asFile.outputStream().use { out -&gt;
            properties.store(out, null)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def currentVersionInfo = tasks.register('currentVersionInfo', CurrentVersionInfo) {
    version = project.version
    versionInfoFile = layout.buildDirectory.file('generated-resources/currentVersion.properties')
}

sourceSets.main.output.dir(currentVersionInfo.map { it.versionInfoFile.get().asFile.parentFile })

abstract class CurrentVersionInfo extends DefaultTask {
    @Input
    abstract Property&lt;String&gt; getVersion()

    @OutputFile
    abstract RegularFileProperty getVersionInfoFile()

    @TaskAction
    void writeVersionInfo() {
        def properties = new Properties()
        properties.setProperty('latestMilestone', version.get())
        versionInfoFile.get().asFile.withOutputStream { out -&gt;
            properties.store(out, null)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Since properties files stored by Java&#8217;s <code>Properties.store</code> method contain a timestamp, this will cause a change to the runtime classpath every time the build runs.
In order to solve this problem see <a href="#volatile_outputs">non-repeatable task outputs</a> or use <a href="#normalization">input normalization</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The compile classpath is not affected since compile avoidance ignores non-class files on the classpath.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="common-problems"><a class="anchor" href="#common-problems"></a><a class="link" href="#common-problems">Solving common problems</a></h3>
<div class="paragraph">
<p>Small problems in a build, like forgetting to declare a configuration file as an input to your task, can be easily overlooked.
The configuration file might change infrequently, or only change when some other (correctly tracked) input changes as well.
The worst that could happen is that your task doesn&#8217;t execute when it should.
Developers can always re-run the build with <code>clean</code>, and "fix" their builds for the price of a slow rebuild.
In the end nobody gets blocked in their work, and the incident is chalked up to "Gradle acting up again."</p>
</div>
<div class="paragraph">
<p>With cacheable tasks incorrect results are stored permanently, and can come back to haunt you later; re-running with <code>clean</code> won&#8217;t help in this situation either. When using a shared cache, these problems even cross machine boundaries. In the example above, Gradle might end up loading a result for your task that was produced with a different configuration. Resolving these problems with the build therefore becomes even more important when task output caching is enabled.</p>
</div>
<div class="paragraph">
<p>Other issues with the build won&#8217;t cause it to produce incorrect results, but will lead to unnecessary cache misses.
In this chapter you will learn about some typical problems and ways to avoid them.
Fixing these issues will have the added benefit that your build will stop "acting up," and developers can forget about running builds with <code>clean</code> altogether.</p>
</div>
<div class="sect3">
<h4 id="system_file_encoding"><a class="anchor" href="#system_file_encoding"></a><a class="link" href="#system_file_encoding">System file encoding</a></h4>
<div class="paragraph">
<p>Most Java tools use the system file encoding when no specific encoding is specified.
This means that running the same build on machines with different file encoding can yield different outputs.
Currently Gradle only tracks on a per-task basis that no file encoding has been specified, but it does not track the system encoding of the JVM in use.
This can cause incorrect builds. You should always set the file system encoding to avoid these kind of problems.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Build scripts are compiled with the file encoding of the Gradle daemon.
By default, the daemon uses the system file encoding, too.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Setting the file encoding for the Gradle daemon mitigates both above problems by making sure that the encoding is the same across builds.
You can do so in your <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.jvmargs=-Dfile.encoding=UTF-8</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="environment_variable_tracking"><a class="anchor" href="#environment_variable_tracking"></a><a class="link" href="#environment_variable_tracking">Environment variable tracking</a></h4>
<div class="paragraph">
<p>Gradle does not track changes in environment variables for tasks.
For example for <code>Test</code> tasks it is completely possible that the outcome depends on a few environment variables.
To ensure that only the right artifacts are re-used between builds, you need to add environment variables as inputs to tasks depending on them.</p>
</div>
<div class="paragraph">
<p>Absolute paths are often passed as environment variables, too.
You need to pay attention what you add as an input to the task in this case.
You would need to ensure that the absolute path is the same between machines. Most times it makes sense to track the file or the contents of the directory the absolute path points to.
If the absolute path represents a tool being used it probably makes sense to track the tool version as an input instead.</p>
</div>
<div class="paragraph">
<p>For example, if you are using tools in your <code>Test</code> task called <code>integTest</code> which depend on the contents of the <code>LANG</code> variable you should do this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.integTest {
    inputs.property("langEnvironment") {
        System.getenv("LANG")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('integTest') {
    inputs.property("langEnvironment") {
        System.getenv("LANG")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you add conditional logic to distinguish CI builds from local development builds, you have to ensure that this does not break the loading of task outputs from CI onto developer machines.
For example, the following setup would break caching of <code>Test</code> tasks, since Gradle always detects the differences in custom task actions.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">if ("CI" in System.getenv()) {
    tasks.withType&lt;Test&gt;().configureEach {
        doFirst {
            println("Running test on CI")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">if (System.getenv().containsKey("CI")) {
    tasks.withType(Test).configureEach {
        doFirst {
            println "Running test on CI"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You should always add the action unconditionally:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    doFirst {
        if ("CI" in System.getenv()) {
            println("Running test on CI")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    doFirst {
        if (System.getenv().containsKey("CI")) {
            println "Running test on CI"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This way, the task has the same custom action on CI and on developer builds and its outputs can be re-used if the remaining inputs are the same.</p>
</div>
</div>
<div class="sect3">
<h4 id="line_endings"><a class="anchor" href="#line_endings"></a><a class="link" href="#line_endings">Line endings</a></h4>
<div class="paragraph">
<p>If you are building on different operating systems be aware that some version control systems convert line endings on check-out.
For example, Git on Windows uses <code>autocrlf=true</code> by default which converts all line endings to <code>\r\n</code>.
As a consequence, compilation outputs can&#8217;t be re-used on Windows since the input sources are different.
If sharing the build cache across multiple operating systems is important in your environment, then setting <code>autocrlf=false</code> across your build machines is crucial for optimal build cache usage.</p>
</div>
</div>
<div class="sect3">
<h4 id="symbolic_links"><a class="anchor" href="#symbolic_links"></a><a class="link" href="#symbolic_links">Symbolic links</a></h4>
<div class="paragraph">
<p>When using symbolic links, Gradle does not store the link in the build cache but the actual file contents of the destination of the link.
As a consequence you might have a hard time when trying to reuse outputs which heavily use symbolic links.
There currently is no workaround for this behavior.</p>
</div>
<div class="paragraph">
<p>For operating systems supporting symbolic links, the content of the destination of the symbolic link will be added as an input.
If the operating system does not support symbolic links, the actual symbolic link file is added as an input.
Therefore, tasks which have symbolic links as input files, e.g. <code>Test</code> tasks having symbolic link as part of its runtime classpath, will not be cached between Windows and Linux.
If caching between operating systems is desired, symbolic links should not be checked into version control.</p>
</div>
</div>
<div class="sect3">
<h4 id="java_version_tracking"><a class="anchor" href="#java_version_tracking"></a><a class="link" href="#java_version_tracking">Java version tracking</a></h4>
<div class="paragraph">
<p>Gradle tracks only the major version of Java as an input for compilation and test execution.
Currently, it does <em>not</em> track the vendor nor the minor version.
Still, the vendor and the minor version may influence the bytecode produced by compilation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you&#8217;re using <a href="#toolchains">Java Toolchains</a>, the Java major version, the vendor (if specified) and implementation (if specified) will be tracked automatically as an input for compilation and test execution.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use different JVM vendors for compiling or running Java we strongly suggest that you add the vendor as an input to the corresponding tasks.
This can be achieved by using the <a href="incremental_build.html#sec:task_input_output_runtime_api">runtime API</a> as shown in the following snippet.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;AbstractCompile&gt;().configureEach {
    inputs.property("java.vendor") {
        System.getProperty("java.vendor")
    }
}

tasks.withType&lt;Test&gt;().configureEach {
    inputs.property("java.vendor") {
        System.getProperty("java.vendor")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(AbstractCompile).configureEach {
    inputs.property("java.vendor") {
        System.getProperty("java.vendor")
    }
}

tasks.withType(Test).configureEach {
    inputs.property("java.vendor") {
        System.getProperty("java.vendor")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With respect to tracking the Java minor version there are different competing aspects: developers having cache hits and "perfect" results on CI.
There are basically two situations when you may want to track the minor version of Java: for compilation and for runtime.
In the case of compilation, there can sometimes be differences in the produced bytecode for different minor versions.
However, the bytecode should still result in the same runtime behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="java_plugin.html#sec:java_compile_avoidance">Java compile avoidance</a> will treat this bytecode the same since it extracts the ABI.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Treating the minor number as an input can decrease the likelihood of a cache hit for developer builds.
Depending on how standard development environments are across your team, it&#8217;s common for many different Java minor version to be in use.</p>
</div>
<div class="paragraph">
<p>Even without tracking the Java minor version you may have cache misses for developers due to some locally compiled class files which constitute an input to test execution.
If these outputs made it into the local build cache on this developers machine even a clean will not solve the situation.
Therefore, the choice for tracking the Java minor version is between sometimes or never re-using outputs between different Java minor versions for test execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The compiler infrastructure provided by the JVM used to run Gradle is also used by the Groovy compiler.
Therefore, you can expect differences in the bytecode of compiled Groovy classes for the same reasons as above and the same suggestions apply.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="avoid_changing_inputs_external_to_your_build"><a class="anchor" href="#avoid_changing_inputs_external_to_your_build"></a><a class="link" href="#avoid_changing_inputs_external_to_your_build">Avoid changing inputs external to your build</a></h4>
<div class="paragraph">
<p>If your build is dependent on external dependencies like binary artifacts or dynamic data from a web page you need to make sure that these inputs are consistent throughout your infrastructure.
Any variations across machines will result in cache misses.</p>
</div>
<div class="paragraph">
<p>Never re-release a non-changing binary dependency with the same version number but different contents: if this happens with a plugin dependency, you will never be able to explain why you dont see cache reuse between machines (its because they have different versions of that artifact).</p>
</div>
<div class="paragraph">
<p>Using <code>SNAPSHOT</code>s or other changing dependencies in your build by design violates the <a href="#stable_task_inputs">stable task inputs</a> principle.
To use the build cache effectively, you should depend on fixed dependencies.
You may want to look into <a href="#locking-versions">dependency locking</a> or switch to using <a href="#composite_builds">composite builds</a> instead.</p>
</div>
<div class="paragraph">
<p>The same is true for depending on volatile external resources, for example a list of released versions.
One way of locking the changes would be to check the volatile resource into source control whenever it changes so that the builds only depend on the state in source control and not on the volatile resource itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="suggestions_for_authoring_your_build"><a class="anchor" href="#suggestions_for_authoring_your_build"></a><a class="link" href="#suggestions_for_authoring_your_build">Suggestions for authoring your build</a></h4>
<div class="sect4">
<h5 id="custom_actions"><a class="anchor" href="#custom_actions"></a><a class="link" href="#custom_actions">Review usages of <code>doFirst</code> and <code>doLast</code></a></h5>
<div class="paragraph">
<p>Using <code>doFirst</code> and <code>doLast</code> from a build script on a cacheable task ties you to build script changes since the implementation of the closure comes from the build script.
If possible, you should use separate tasks instead.</p>
</div>
<div class="paragraph">
<p>Modifying input or output properties via the runtime API in <code>doFirst</code> is discouraged since these changes will not be detected for up-to-date checks and the build cache.
Even worse, when the task does not execute, then the configuration of the task is actually different from when it executes.
Instead of using <code>doFirst</code> for modifying the inputs consider using a separate task to configure the task under question - a so called configure task.
E.g., instead of doing</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.jar {
    val runtimeClasspath: FileCollection = configurations.runtimeClasspath.get()
    doFirst {
        manifest {
            val classPath = runtimeClasspath.map { it.name }.joinToString(" ")
            attributes("Class-Path" to classPath)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('jar') {
    FileCollection runtimeClasspath = configurations.runtimeClasspath
    doFirst {
        manifest {
            def classPath = runtimeClasspath.collect { it.name }.join(" ")
            attributes('Class-Path': classPath)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>do</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val configureJar = tasks.register("configureJar") {
    doLast {
        tasks.jar.get().manifest {
            val classPath = configurations.runtimeClasspath.get().map { it.name }.joinToString(" ")
            attributes("Class-Path" to classPath)
        }
    }
}
tasks.jar { dependsOn(configureJar) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def configureJar = tasks.register('configureJar') {
    doLast {
        tasks.jar.manifest {
            def classPath = configurations.runtimeClasspath.collect { it.name }.join(" ")
            attributes('Class-Path': classPath)
        }
    }
}

tasks.named('jar') { dependsOn(configureJar) }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Note that configuring a task from other task is not supported when using the <a href="#config_cache:requirements:task_access">configuration cache</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="logic_based_on_task_outcome"><a class="anchor" href="#logic_based_on_task_outcome"></a><a class="link" href="#logic_based_on_task_outcome">Build logic based on the outcome of a task</a></h5>
<div class="paragraph">
<p>Do not base build logic on whether a task has been <em>executed</em>.
In particular you should not assume that the output of a task can only change if it actually executed.
Actually, loading the outputs from the build cache would also change them.
Instead of relying on custom logic to deal with changes to input or output files you should leverage Gradle&#8217;s built-in support by declaring the correct inputs and outputs for your tasks and leave it to Gradle to decide if the task actions should be executed.
For the very same reason using <code>outputs.upToDateWhen</code> is discouraged and should be replaced by properly declaring the task&#8217;s inputs.</p>
</div>
</div>
<div class="sect4">
<h5 id="overlapping_outputs"><a class="anchor" href="#overlapping_outputs"></a><a class="link" href="#overlapping_outputs">Overlapping outputs</a></h5>
<div class="paragraph">
<p>You already saw that <a href="#concepts_overlapping_outputs">overlapping outputs are a problem for task output caching</a>.
When you add new tasks to your build or re-configure built-in tasks make sure you do not create overlapping outputs for cacheable tasks.
If you must you can add a <code>Sync</code> task which then would sync the merged outputs into the target directory while the original tasks remain cacheable.</p>
</div>
<div class="paragraph">
<p>Develocity will show tasks where caching was disabled for overlapping outputs in the timeline and in the task input comparison:</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="img/build-cache/overlapping-outputs-input-comparison.png" alt="overlapping outputs input comparison">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="achieving_stable_task_inputs"><a class="anchor" href="#achieving_stable_task_inputs"></a><a class="link" href="#achieving_stable_task_inputs">Achieving stable task inputs</a></h4>
<div class="paragraph">
<p>It is crucial to have <a href="#stable_task_inputs">stable task inputs</a> for every cacheable task.
In the following section you will learn about different situations which violate stable task inputs and look at possible solutions.</p>
</div>
<div class="sect4">
<h5 id="volatile_inputs"><a class="anchor" href="#volatile_inputs"></a><a class="link" href="#volatile_inputs">Volatile task inputs</a></h5>
<div class="paragraph">
<p>If you use a volatile input like a timestamp as an input property for a task, then there is nothing Gradle can do to make the task cacheable.
You should really think hard if the volatile data is really essential to the output or if it is only there for e.g. auditing purposes.</p>
</div>
<div class="paragraph">
<p>If the volatile input is essential to the output then you can try to make the task using the volatile input cheaper to execute.
You can do this by splitting the task into two tasks - the first task doing the expensive work which is cacheable and the second task adding the volatile data to the output.
In this way the output stays the same and the build cache can be used to avoid doing the expensive work.
For example, for building a jar file the expensive part - Java compilation - is already a different task while the jar task itself, which is not cacheable, is cheap.</p>
</div>
<div class="paragraph">
<p>If it is not an essential part of the output, then you should not declare it as an input.
As long as the volatile input does not influence the output then there is nothing else to do.
Most times though, the input will be part of the output.</p>
</div>
</div>
<div class="sect4">
<h5 id="volatile_outputs"><a class="anchor" href="#volatile_outputs"></a><a class="link" href="#volatile_outputs">Non-repeatable task outputs</a></h5>
<div class="paragraph">
<p>Having tasks which generate different outputs for the same inputs can pose a challenge for the effective use of task output caching as seen in <a href="#concepts_repeatable_task_outputs">repeatable task outputs</a>.
If the non-repeatable task output is not used by any other task then the effect is very limited.
It basically means that loading the task from the cache might produce a different result than executing the same task locally.
If the only difference between the outputs is a timestamp, then you can either accept the effect of the build cache or decide that the task is not cacheable after all.</p>
</div>
<div class="paragraph">
<p>Non-repeatable task outputs lead to non-stable task inputs as soon as another task depends on the non-repeatable output.
For example, re-creating a jar file from the files with the same contents but different modification times yields a different jar file.
Any other task depending on this jar file as an input file cannot be loaded from the cache when the jar file is rebuilt locally.
This can lead to hard-to-diagnose cache misses when the consuming build is not a clean build or when a cacheable task depends on the output of a non-cacheable task.
For example, when doing incremental builds it is possible that the artifact on disk which is considered up-to-date and the artifact in the build cache are different even though they are essentially the same.
A task depending on this task output would then not be able to load outputs from the build cache since the inputs are not exactly the same.</p>
</div>
<div class="paragraph">
<p>As described in the <a href="#stable_task_inputs">stable task inputs section</a>, you can either make the task outputs repeatable or use input normalization.
You already learned about the possibilities with <a href="#filter_runtime_classpath">configurable input normalization</a>.</p>
</div>
<div class="paragraph">
<p>Tasks that produce archives (<code>tar</code>, <code>zip</code>) are <a href="#sec:reproducible_archives">reproducible</a> by default, starting with Gradle 9.0.0.
For earlier Gradle versions or if you want explicit configuration, you can make archives reproducible configuring a task in the following way:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Zip&gt;("createZip") {
    isPreserveFileTimestamps = false
    isReproducibleFileOrder = true
    dirPermissions { unix("755") }
    filePermissions { unix("644") }
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('createZip', Zip) {
    preserveFileTimestamps = false
    reproducibleFileOrder = true
    dirPermissions { unix("755") }
    filePermissions { unix("644") }
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Another way to make the outputs repeatable is to activate caching for a task with non-repeatable outputs.
If you can make sure that the same build cache is used for all builds then the task will always have the same outputs for the same inputs by design of the build cache.
Going down this road can lead to different problems with cache misses for incremental builds as described above.
Moreover, race conditions between different builds trying to store the same outputs in the build cache in parallel can lead to hard-to-diagnose cache misses.
If possible, you should avoid going down that route.</p>
</div>
</div>
<div class="sect4">
<h5 id="limit_the_effect_of_volatile_data"><a class="anchor" href="#limit_the_effect_of_volatile_data"></a><a class="link" href="#limit_the_effect_of_volatile_data">Limit the effect of volatile data</a></h5>
<div class="paragraph">
<p>If none of the described solutions for dealing with volatile data work for you, you should still be able to limit the effect of volatile data on effective use of the build cache.
This can be done by adding the volatile data later to the outputs as described in the <a href="#volatile_inputs">volatile task inputs section</a>.
Another option would be to move the volatile data so it affects fewer tasks.
For example moving the dependency from the <code>compile</code> to the <code>runtime</code> configuration may already have quite an impact.</p>
</div>
<div class="paragraph">
<p>Sometimes it is also possible to build two artifacts, one containing the volatile data and another one containing a constant representation of the volatile data.
The non-volatile output would be used e.g. for testing while the volatile one would be published to an external repository.
While this conflicts with the Continuous Delivery "build artifacts once" principle it can sometimes be the only option.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom_and_third_party_tasks"><a class="anchor" href="#custom_and_third_party_tasks"></a><a class="link" href="#custom_and_third_party_tasks">Custom and third party tasks</a></h4>
<div class="paragraph">
<p>If your build contains custom or third party tasks, you should take special care that these don&#8217;t influence the effectiveness of the build cache.
Special care should also be taken for code generation tasks which may not have <a href="#concepts_repeatable_task_outputs">repeatable task outputs</a>.
This can happen if the code generator includes e.g. a timestamp in the generated files or depends on the order of the input files.
Other pitfalls can be the use of <code>HashMap</code>s or other data structures without order guarantees in the task&#8217;s code.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Some third party plugins can even influence cacheability of Gradle&#8217;s built-in tasks.
This can happen if they add inputs like absolute paths or volatile data to tasks via the runtime API.
In the worst case this can lead to incorrect builds when the plugins try to depend on the <a href="#logic_based_on_task_outcome">outcome of a task</a> and do not take <code>FROM-CACHE</code> into account.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration_cache"><a class="anchor" href="#configuration_cache"></a><a class="link" href="#configuration_cache">CONFIGURATION CACHE</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="config_cache"><a class="anchor" href="#config_cache"></a><a class="link" href="#config_cache">Configuration Cache</a></h3>
<div class="paragraph">
<p>The Configuration Cache improves build performance by caching the result of the <a href="build_lifecycle_intermediate.html#build_lifecycle">configuration phase</a> and reusing it for subsequent builds.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache-4.png" alt="configuration cache 4">
</div>
</div>
<div class="sect3">
<h4 id="config_cache:intro"><a class="anchor" href="#config_cache:intro"></a><a class="link" href="#config_cache:intro">Configuration Cache Basics</a></h4>
<div class="paragraph">
<p>The <a href="build_lifecycle_intermediate.html#build_lifecycle">Gradle Build Lifecycle</a> consists of three phases: <strong>initialization</strong>, <strong>configuration</strong>, and <strong>execution</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>initialization</strong> phase determines the structure of the build.</p>
</li>
<li>
<p>The <strong>configuration</strong> phase evaluates what work needs to be done.</p>
</li>
<li>
<p>The <strong>execution</strong> phase performs that work.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradles <strong>Build Cache</strong> has long optimized the execution phase by reusing previously built outputs and parallelizing as much work as possible.</p>
</div>
<div class="paragraph">
<p>The <strong>Configuration Cache</strong> builds on this idea of <em>work avoidance</em> and <em>parallelization</em>.
When enabled, the Configuration Cache allows Gradle to skip the configuration phase entirely if nothing that affects the build configuration (such as build scripts) has changed.
Additionally, Gradle applies performance optimizations to task execution.</p>
</div>
<div class="paragraph">
<p>To do this, Gradle does the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Phase</th>
<th class="tableblock halign-left valign-top">Cache</th>
<th class="tableblock halign-left valign-top">Cache Key</th>
<th class="tableblock halign-left valign-top">Work Avoidance</th>
<th class="tableblock halign-left valign-top">Parallelism and Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configuration</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build logic and environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skip project configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs tasks in parallel within the same project, optimizes memory, and more</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Execution</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task inputs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skip task execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs independent tasks in different projects in parallel with <code>--parallel</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Configuration Cache is similar to the <a href="#build_cache">Build Cache</a>, but they store different types of data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Build Cache</strong>: Stores outputs and intermediate files of the build (e.g., task outputs, artifact transform outputs).</p>
</li>
<li>
<p><strong>Configuration Cache</strong>: Stores the build configuration for a particular set of tasks, capturing the output of the configuration phase.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache-2.png" alt="configuration cache 2">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is <em>not enabled by default</em> and has the following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It does not yet support all <a href="#config_cache:plugins:core">Core Gradle Plugins</a> and <a href="#config_cache:not_yet_implemented">features</a>. Full support is in progress.</p>
</li>
<li>
<p>Your build and its plugins may require modifications to meet the <a href="#config_cache:requirements">Configuration Cache requirements</a>.</p>
</li>
<li>
<p><a href="#config_cache:ide">IDE imports and syncs</a> do not yet use the Configuration Cache.</p>
</li>
<li>
<p>Continuous Integration (CI) support is actively evolving.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since Gradle 9.0.0 the Configuration Cache is the <a href="https://blog.gradle.org/road-to-configuration-cache#preferred-mode-of-execution">preferred mode of execution</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:intro:how_does_it_work"><a class="anchor" href="#config_cache:intro:how_does_it_work"></a><a class="link" href="#config_cache:intro:how_does_it_work">Work Avoidance</a></h4>
<div class="paragraph">
<p>When the Configuration Cache is enabled and you run Gradle for a specific set of tasks, such as <code>./gradlew check</code>, Gradle looks for a <strong>Configuration Cache entry</strong>.
If a matching entry is found, Gradle reuses it and skips the configuration phase entirely.
A cache hit is essential for avoiding configuration work.</p>
</div>
<div class="sect4">
<h5 id="configuration_cache_entries"><a class="anchor" href="#configuration_cache_entries"></a><a class="link" href="#configuration_cache_entries">Configuration Cache Entries</a></h5>
<div class="paragraph">
<p>A cache entry contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The set of tasks to run</p>
</li>
<li>
<p>Their configuration details</p>
</li>
<li>
<p>Dependency information</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="first_time_execution"><a class="anchor" href="#first_time_execution"></a><a class="link" href="#first_time_execution">First-Time Execution</a></h5>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache-1.png" alt="configuration cache 1">
</div>
</div>
<div class="paragraph">
<p>The first time you run a set of tasks, there is no cache entry.
Gradle performs the configuration phase as usual:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run init scripts.</p>
</li>
<li>
<p>Run the settings script, applying any requested settings plugins.</p>
</li>
<li>
<p>Configure and build the <code>buildSrc</code> project, if present.</p>
</li>
<li>
<p>Run build scripts, applying any requested project plugins. If plugins come from included builds, Gradle builds them first.</p>
</li>
<li>
<p>Calculate the task graph, executing deferred configuration actions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle then stores a snapshot of the task graph in the Configuration Cache for future use.
After this, Gradle loads the task graph from the cache and proceeds with task execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When it is enabled, Gradle always loads from the configuration cache - even on a cache miss - to ensure that hits and misses are handled consistently.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="subsequent_runs"><a class="anchor" href="#subsequent_runs"></a><a class="link" href="#subsequent_runs">Subsequent Runs</a></h5>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache-3.png" alt="configuration cache 3">
</div>
</div>
<div class="paragraph">
<p>On subsequent executions of the same tasks (e.g., <code>./gradlew check</code> again), Gradle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Skips the configuration phase entirely.</p>
</li>
<li>
<p>Loads the task graph from the Configuration Cache instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To match a saved entry in the cache, Gradle verifies that no build configuration inputs have changed.
If any input has changed, Gradle reruns the configuration phase and stores a new entry in the cache.</p>
</div>
</div>
<div class="sect4">
<h5 id="build_configuration_inputs"><a class="anchor" href="#build_configuration_inputs"></a><a class="link" href="#build_configuration_inputs">Build Configuration Inputs</a></h5>
<div class="paragraph">
<p>The following elements determine whether a Configuration Cache entry is valid:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gradle environment</p>
<div class="ulist">
<ul>
<li>
<p><code>GRADLE_USER_HOME</code></p>
</li>
<li>
<p>Gradle Daemon JVM</p>
</li>
</ul>
</div>
</li>
<li>
<p>Init scripts</p>
</li>
<li>
<p><code>buildSrc</code> and included build logic build contents (build scripts, sources, and intermediate build outputs)</p>
</li>
<li>
<p>Build and Settings scripts, including included scripts (<code>apply from: foo.gradle</code>)</p>
</li>
<li>
<p>Gradle configuration files (Version Catalogs, dependency verification files, dependency lock files, <code>gradle.properties</code> files)</p>
</li>
<li>
<p>Contents of files read at configuration time</p>
</li>
<li>
<p>File system state checked at configuration time (file presence, directory contents, etc.)</p>
</li>
<li>
<p>Custom <code>ValueSource</code> values obtained at configuration time (this also includes built-in providers, like <code>providers.exec</code> and <code>providers.fileContents</code>).</p>
</li>
<li>
<p>System properties used during the configuration phase</p>
</li>
<li>
<p>Environment variables used during the configuration phase</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="serialization"><a class="anchor" href="#serialization"></a><a class="link" href="#serialization">Serialization</a></h5>
<div class="paragraph">
<p>Gradle uses an optimized serialization mechanism to store Configuration Cache entries.
It automatically serializes object graphs containing simple state or supported types.</p>
</div>
<div class="paragraph">
<p>While Configuration Cache serialization doesn&#8217;t rely on Java Serialization, it understands <a href="#config_cache:not_yet_implemented:java_serialization">some of its features</a>.
This can be used to customize serialization behavior, but incurs a performance penalty and should be avoided.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:intro:performance_improvements"><a class="anchor" href="#config_cache:intro:performance_improvements"></a><a class="link" href="#config_cache:intro:performance_improvements">Performance Improvements</a></h4>
<div class="paragraph">
<p>Beyond skipping the configuration phase, the Configuration Cache enhances performance in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Parallel Task Execution</strong>: When parallel execution is enabled, even tasks within the same project can be run in parallel, subject to dependency constraints.</p>
</li>
<li>
<p><strong>Cached Dependency Resolution</strong>: Dependency resolution results are stored and reused.</p>
</li>
</ul>
</div>
<div id="config_cache:in_action" class="imageblock">
<div class="content">
<img src="img/configuration-cache/running-help.gif" alt="running help">
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:ide"><a class="anchor" href="#config_cache:ide"></a><a class="link" href="#config_cache:ide">IDE Support</a></h4>
<div class="paragraph">
<p>If you enable and configure the Configuration Cache in your <code>gradle.properties</code> file, it will be automatically enabled when your IDE delegates builds to Gradle.
No additional setup is required.</p>
</div>
<div class="paragraph">
<p>Because <code>gradle.properties</code> is typically checked into source control,
<a href="userguide/best-practices/best_practices_general.html#use_the_gradle_properties_file">enabling the Configuration Cache this way will apply to your entire team</a>.
If you prefer to enable it only for your local environment, you can configure it directly in your IDE instead.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Syncing a project in an IDE does not benefit from the Configuration Cache. Only running tasks through the IDE will leverage the cache.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="config_cache:ide:intellij"><a class="anchor" href="#config_cache:ide:intellij"></a><a class="link" href="#config_cache:ide:intellij">IntelliJ based IDEs</a></h5>
<div class="paragraph">
<p>In IntelliJ IDEA or Android Studio this can be done in two ways, either globally or per run configuration.</p>
</div>
<div class="paragraph">
<p>To enable it for the whole build, go to <code>Run &gt; Edit configurations&#8230;&#8203;</code>.
This will open the IntelliJ IDEA or Android Studio dialog to configure Run/Debug configurations.
Select <code>Templates &gt; Gradle</code> and add the necessary system properties to the <code>VM options</code> field.</p>
</div>
<div class="paragraph">
<p>For example to enable the Configuration Cache, turning problems into warnings, add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">-Dorg.gradle.configuration-cache=true -Dorg.gradle.configuration-cache.problems=warn</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also choose to only enable it for a given run configuration.
In this case, leave the <code>Templates &gt; Gradle</code> configuration untouched and edit each run configuration as you see fit.</p>
</div>
<div class="paragraph">
<p>Using these methods together, you can enable the Configuration Cache globally while disabling it for certain run configurations, or vice versa.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the <a href="https://github.com/JetBrains/gradle-idea-ext-plugin">gradle-idea-ext-plugin</a> to configure IntelliJ run configurations from your build.</p>
</div>
<div class="paragraph">
<p>This is a good way to enable the Configuration Cache only for the IDE.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:ide:eclipse"><a class="anchor" href="#config_cache:ide:eclipse"></a><a class="link" href="#config_cache:ide:eclipse">Eclipse based IDEs</a></h5>
<div class="paragraph">
<p>In Eclipse-based IDEs, you can enable the Configuration Cache through Buildship, either globally or per run configuration.</p>
</div>
<div class="paragraph">
<p>To enable it globally:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <code>Preferences &gt; Gradle</code>.</p>
</li>
<li>
<p>Add the following JVM arguments:</p>
<div class="ulist">
<ul>
<li>
<p><code>-Dorg.gradle.configuration-cache=true</code></p>
</li>
<li>
<p><code>-Dorg.gradle.configuration-cache.problems=warn</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To enable it for a specific run configuration:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <code>Run Configurations&#8230;&#8203;.</code></p>
</li>
<li>
<p>Select the desired configuration.</p>
</li>
<li>
<p>Navigate to <code>Project Settings</code>, check <code>Override project settings</code>, and add the same system properties as <code>JVM arguments</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Using these methods together, you can enable the Configuration Cache globally while disabling it for certain run configurations, or vice versa.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config_cache:usage"><a class="anchor" href="#config_cache:usage"></a><a class="link" href="#config_cache:usage">Enabling and Configuring the Configuration Cache</a></h3>
<div class="sect3">
<h4 id="config_cache:usage:enable"><a class="anchor" href="#config_cache:usage:enable"></a><a class="link" href="#config_cache:usage:enable">Enabling the Configuration Cache</a></h4>
<div class="paragraph">
<p>By default, Gradle does not use the Configuration Cache.</p>
</div>
<div class="paragraph">
<p>To enable it at build time, use the <code>configuration-cache</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew --configuration-cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable the cache persistently, set the <code>org.gradle.configuration-cache</code> property in <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If enabled in <code>gradle.properties</code>, you can override it and disable the cache at build time using the <code>no-configuration-cache</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew --no-configuration-cache</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:usage:ignore_problems"><a class="anchor" href="#config_cache:usage:ignore_problems"></a><a class="link" href="#config_cache:usage:ignore_problems">Ignoring Configuration Cache Problems</a></h5>
<div class="paragraph">
<p>By default, Gradle fails the build if Configuration Cache problems occur.
However, when gradually updating plugins or build logic to support the Configuration Cache, it can be useful to temporarily turn problems into warnings by enabling <em>warning mode</em>.</p>
</div>
<div class="paragraph">
<p>To change this behavior at build time, use the following flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew --configuration-cache-problems=warn</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This does not guarantee that the build will succeed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, configure it in <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.problems=warn</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Warning mode is a migration and troubleshooting aid and not intended as a persistent way of ignoring incompatibilities.
It will also not prevent new incompatibilities being accidentally added to your build later.</p>
</div>
<div class="paragraph">
<p>Instead, we recommend explicitly marking problematic tasks as <a href="#config_cache:task_opt_out">incompatible</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:usage:max_problems"><a class="anchor" href="#config_cache:usage:max_problems"></a><a class="link" href="#config_cache:usage:max_problems">Allowing a Maximum Number of Problems</a></h5>
<div class="paragraph">
<p>When Configuration Cache problems are treated as warnings, Gradle will fail the build if <code>512</code> problems are found by default.</p>
</div>
<div class="paragraph">
<p>You can adjust this limit by specifying the maximum number of allowed problems on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew -Dorg.gradle.configuration-cache.max-problems=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or configure it in a <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.max-problems=5</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:usage:parallel"><a class="anchor" href="#config_cache:usage:parallel"></a><a class="link" href="#config_cache:usage:parallel">Enabling Parallel Configuration Caching</a></h5>
<div class="paragraph">
<p>By default, Configuration Cache storing and loading are sequential.
Enabling parallel storing and loading can improve performance, but not all builds are compatible with it.</p>
</div>
<div class="paragraph">
<p>To enable parallel configuration caching at build time, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew -Dorg.gradle.configuration-cache.parallel=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or persistently in a <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.parallel=true</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>The parallel configuration caching feature is <em>incubating</em>, and some builds may not work correctly.
A common symptom of incompatibility is <code>ConcurrentModificationException</code> errors during the <a href="build_lifecycle_intermediate.html#sec:configuration">configuration phase</a>.
However, this feature is expected to work well for <a href="#sec:decoupled_projects">decoupled</a> multi-project builds.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:usage:read_only"><a class="anchor" href="#config_cache:usage:read_only"></a><a class="link" href="#config_cache:usage:read_only">Making the Configuration Cache Read-Only</a></h5>
<div class="paragraph">
<p>In some builds, such as CI builds running in ephemeral environments, it may be desirable for Gradle to use the Configuration Cache only when there&#8217;s a cache hit.
If there&#8217;s a miss, caching offers no benefit since the disk state won&#8217;t be preserved across builds.</p>
</div>
<div class="paragraph">
<p>To enable read-only configuration caching at build time, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew -Dorg.gradle.configuration-cache.read-only=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or set it persistently in <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.read-only=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if you enable this persistently, you&#8217;ll need to explicitly disable it via the command line in order for Gradle to ever write to the configuration cache.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>The read-only configuration caching feature is <em>incubating</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:stable"><a class="anchor" href="#config_cache:stable"></a><a class="link" href="#config_cache:stable">Enabling Strict Configuration Cache Mode</a></h4>
<div class="paragraph">
<p>To help teams adopt configuration caching, Gradle provides a strict mode behind a dedicated feature flag.</p>
</div>
<div class="paragraph">
<p>You can enable this feature flag in your build using the following configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">enableFeaturePreview("STABLE_CONFIGURATION_CACHE")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">enableFeaturePreview "STABLE_CONFIGURATION_CACHE"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Enabling the <code>STABLE_CONFIGURATION_CACHE</code> feature flag activates stricter validation and introduces the following behavior:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Undeclared Shared Build Service Usage</dt>
<dd>
<p>If a task uses a <a href="#build_services">shared Build Service</a> without explicitly declaring the requirement using the <code>Task.usesService</code> method, Gradle will emit a deprecation warning.</p>
</dd>
<dt class="hdlist1">Deprecation Enforcement Without Configuration Cache</dt>
<dd>
<p>Even when the Configuration Cache is not enabled, Gradle will warn if the following deprecated features are used:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#config_cache:requirements:build_listeners">Registering build listeners</a></p>
</li>
<li>
<p><a href="#config_cache:requirements:task_extensions">Using task extensions and conventions at execution time</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>We recommend enabling this flag early to detect and resolve potential issues before the stricter behavior becomes the default in a future release.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:usage:invalidate"><a class="anchor" href="#config_cache:usage:invalidate"></a><a class="link" href="#config_cache:usage:invalidate">Invalidating the Configuration Cache</a></h4>
<div class="paragraph">
<p>The Configuration Cache is automatically invalidated when inputs to the configuration phase change.
However, some inputs are not yet tracked, meaning you may need to manually invalidate the cache when untracked inputs change.
This is more likely if you have <a href="#config_cache:usage:ignore_problems">ignored problems</a>.</p>
</div>
<div class="paragraph">
<p>See the <a href="#config_cache:requirements">[config_cache:requirements]</a> and <a href="#config_cache:not_yet_implemented">Not Yet Implemented</a> sections for more details.</p>
</div>
<div class="paragraph">
<p>The Configuration Cache state is stored in a <code>.gradle/configuration-cache</code> directory in the root of your Gradle build.</p>
</div>
<div class="paragraph">
<p>To manually invalidate the cache, delete this directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> rm -rf .gradle/configuration-cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle periodically checks (at most every 24 hours) whether cached entries are still in use.
Entries that have not been used for 7 days are automatically deleted.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:adoption"><a class="anchor" href="#config_cache:adoption"></a><a class="link" href="#config_cache:adoption">Adopting the Configuration Cache</a></h4>
<div class="paragraph">
<p>The following stages outline a recommended path for adopting the Configuration Cache.
These steps apply to both builds and plugins:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#sec:not_using">Not using / Not enabled</a></p>
</li>
<li>
<p><a href="#sec:using_locally">Using locally</a></p>
</li>
<li>
<p><a href="#sec:using_ci">Using on CI / Enable everywhere</a></p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="sec:not_using"><a class="anchor" href="#sec:not_using"></a><a class="link" href="#sec:not_using">1. Not using / Not enabled</a></h5>
<div class="paragraph">
<p>An important prerequisite is to keep your Gradle version and plugins up to date.</p>
</div>
<div class="paragraph">
<p>While following this process, refer to the HTML report and the solutions explained in the <a href="#config_cache:requirements">Requirements</a> page.</p>
</div>
<div class="paragraph">
<p>If any problem is found caching or reusing the configuration, an HTML report is generated to help you diagnose and fix the issues.
The report also shows detected build configuration inputs like system properties, environment variables and value suppliers read during the configuration phase.</p>
</div>
<div class="paragraph">
<p>See the <a href="#config_cache:troubleshooting">Debugging</a> page for more information.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache-5.png" alt="configuration cache 5">
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_locally"><a class="anchor" href="#sec:using_locally"></a><a class="link" href="#sec:using_locally">2. Using locally</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start with <code>help</code></p>
<div class="paragraph">
<p>Always begin by testing your build or plugin with the simplest task: <code>help</code>.
This exercises the minimal configuration phase of your build or plugin.</p>
</div>
</li>
<li>
<p>Progressively target useful tasks</p>
<div class="paragraph">
<p>Avoid running <code>build</code> right away. Instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <code>--dry-run</code> to identify configuration time problems first.</p>
</li>
<li>
<p>When working on a build, focus on your development feedback loop, such as running tests after modifying source code.</p>
</li>
<li>
<p>When working on a plugin, progressively target the contributed or configured tasks.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Explore by turning problems into warnings</p>
<div class="paragraph">
<p>Don&#8217;t stop at the first build failure<a href="#config_cache:usage:ignore_problems">turn problems into warnings</a> to better understand how your build and plugins behave.
If a build fails:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the HTML report to analyze the reported problems.</p>
</li>
<li>
<p>Continue testing more tasks to get a full picture of the issues affecting your build and plugins.</p>
</li>
<li>
<p>Keep in mind that when turning problems into warnings, you may need to <a href="#config_cache:usage:invalidate">manually invalidate the cache</a> in case of unexpected behavior.</p>
</li>
<li>
<p>Mark tasks as incompatible if needed using <code>myTask.notCompatibleWithConfigurationCache("because")</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Step back and fix problems iteratively</p>
<div class="paragraph">
<p>Once you have a clear understanding of the issues, start fixing them iteratively.
Use the HTML report and this documentation to guide your process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Begin with problems reported when <em>storing</em> the Configuration Cache.</p>
</li>
<li>
<p>Once those are fixed, move on to addressing any problems encountered when <em>loading</em> the Configuration Cache.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Report encountered issues</p>
<div class="paragraph">
<p>If you encounter issues with a <a href="#config_cache:not_yet_implemented">Gradle Feature</a> or a <a href="#config_cache:plugins:core">Core Gradle Plugin</a> that is not covered by this documentation, report it to <a href="https://github.com/gradle/gradle/issues/new/choose"><code>gradle/gradle</code></a>.</p>
</div>
<div class="paragraph">
<p>For community Gradle plugins, check if the issue is already listed at <a href="https://github.com/gradle/gradle/issues/13490">gradle/gradle#13490</a> and report it to the plugin&#8217;s issue tracker if necessary.</p>
</div>
<div class="paragraph">
<p>A good bug report should include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A link to this documentation.</p>
</li>
<li>
<p>The plugin version you tested.</p>
</li>
<li>
<p>Any custom plugin configuration, or ideally a reproducer build.</p>
</li>
<li>
<p>A description of what fails (e.g., problems with a specific task).</p>
</li>
<li>
<p>A copy of the build failure output.</p>
</li>
<li>
<p>The self-contained <code>configuration-cache-report.html</code> file.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Test, test, test</p>
<div class="paragraph">
<p>Add tests for your build logic to catch issues early.
See <a href="#config_cache:testing">Testing Your Build Logic</a> for details on testing Configuration Cache compatibility.
This will help during iterations and prevent regressions.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_ci"><a class="anchor" href="#sec:using_ci"></a><a class="link" href="#sec:using_ci">3. Using on CI / Enable everywhere</a></h5>
<div class="paragraph">
<p>Once your developer workflow (e.g., running tests from the IDE) is stable, consider enabling the Configuration Cache for your team:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initially, introduce it as an opt-in feature.</p>
</li>
<li>
<p>If necessary, turn problems into warnings and set a maximum number of allowed problems in your <code>gradle.properties</code> file.</p>
</li>
<li>
<p>Keep the Configuration Cache disabled by default, and encourage team members to opt in by configuring their IDE run settings.</p>
</li>
<li>
<p>When more workflows are stable, reverse this approach:</p>
<div class="ulist">
<ul>
<li>
<p>Enable the Configuration Cache by default.</p>
</li>
<li>
<p>Configure CI to disable it where needed.</p>
</li>
<li>
<p>Communicate any unsupported workflows that require disabling the Configuration Cache.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once everything is stable locally and within your team, consider enabling the Configuration Cache on CI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This ensures your builds stays CC compliant, and developers cant introduce problems accidentally!</p>
</li>
<li>
<p>CC overhead is compensated for by the intra-project task parallelism.</p>
</li>
<li>
<p>Getting cache hits may not be possible initially (this is normal).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you are ready to focus on hit rates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Consider reducing or removing build logic inputs.</p>
</li>
<li>
<p>Track hit rates with Develocity&#8217;s <a href="https://gradle.com/develocity/product/reporting-and-visualization/">Reporting &amp; Visualization Kit</a>.</p>
</li>
<li>
<p>Fix issues with <a href="https://gradle.com/develocity/product/build-scan/">Build Scan</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:adoption:reacting"><a class="anchor" href="#config_cache:adoption:reacting"></a><a class="link" href="#config_cache:adoption:reacting">Reacting to the Configuration Cache in the Build</a></h5>
<div class="paragraph">
<p>Build logic or plugin implementations can detect whether the Configuration Cache is enabled for a given build and adjust behavior accordingly.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeature.html#getActive--">active</a> status of the Configuration Cache is provided in the corresponding <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeatures.html#getConfigurationCache--">build feature</a>.
You can access it by <a href="#service_injection">injecting</a> the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/configuration/BuildFeatures.html"><code>BuildFeatures</code></a> service into your code.</p>
</div>
<div class="paragraph">
<p>This information can be used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure plugin features differently when the Configuration Cache is enabled.</p>
</li>
<li>
<p>Disable an optional feature that is not yet compatible with the Configuration Cache.</p>
</li>
<li>
<p>Provide additional guidance to users, such as informing them of temporary limitations or suggesting adjustments to their setup.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:adoption:changes_in_behavior"><a class="anchor" href="#config_cache:adoption:changes_in_behavior"></a><a class="link" href="#config_cache:adoption:changes_in_behavior">Adopting changes in the Configuration Cache behavior</a></h5>
<div class="paragraph">
<p>Gradle releases continuously enhance the Configuration Cache by detecting more cases where configuration logic interacts with the environment.
These improvements increase cache correctness by preventing false cache hits but also introduce stricter rules that plugins and build logic must follow for optimal caching.</p>
</div>
<div class="paragraph">
<p>Some newly detected configuration inputs may not impact the configured tasks but can still cause cache invalidation.
To minimize unnecessary cache misses, follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identify problematic configuration inputs using the <a href="#config_cache:troubleshooting">Configuration Cache report</a>.</p>
<div class="ulist">
<ul>
<li>
<p>Fix undeclared configuration inputs accessed by project build logic.</p>
</li>
<li>
<p>Report issues caused by third-party plugins to their maintainers and update plugins once they are fixed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use opt-out options for specific cases to temporarily revert to earlier behavior and prevent Gradle from tracking certain inputs.
This can help mitigate performance issues caused by outdated plugins.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to <em>temporarily</em> opt out of configuration input detection in the following cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gradle now tracks file system interactions, including checks such as <code>File.exists()</code> or <code>File.isFile()</code>, as configuration inputs.</p>
<div class="paragraph">
<p>To prevent input tracking from invalidating the cache due to these file system checks, use the <code>org.gradle.configuration-cache.inputs.unsafe.ignore.file-system-checks</code> property in <code>gradle.properties</code>.
List the paths to be ignored, relative to the root project directory, separated by <code>;</code>.
Wildcards (<code>*</code> for segments, <code>**</code> for multiple segments) are supported.
Paths prefixed with <code>~/</code> are relative to the users home directory.
For example:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">org.gradle.configuration-cache.inputs.unsafe.ignore.file-system-checks=\
    ~/.third-party-plugin/*.lock;\
    ../../externalOutputDirectory/**;\
    build/analytics.json</code></pre>
</div>
</div>
</li>
<li>
<p>Prior to Gradle 8.4, some undeclared configuration inputs that were never used during configuration could still be read when the Configuration Cache serialized the task graph.
However, these changes did not invalidate the cache.</p>
<div class="paragraph">
<p>Starting in Gradle 8.4, these undeclared inputs are correctly tracked and now cause cache invalidation.</p>
</div>
<div class="paragraph">
<p>To temporarily revert to the previous behavior, set the Gradle property <code>org.gradle.configuration-cache.inputs.unsafe.ignore.in-serialization</code> to <code>true</code>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>With the evolution of the Configuration Cache, Gradle may impose additional restrictions on build logic.
To make adoption smoother, it is possible to <em>temporarily</em> opt out of these restrictions in specific cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Starting with Gradle 9.0.0, it is an error to use any provider, except a provider of <code>BuildService</code> returned from
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceRegistry.html#registerIfAbsent(java.lang.String,java.lang.Class,org.gradle.api.Action)"><code>BuildServiceRegistry.registerIfAbsent</code></a>
or
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceRegistration.html#getService()"><code>BuildServiceRegistration.getService</code></a>
as an argument for
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/build/event/BuildEventsListenerRegistry.html#onTaskCompletion(org.gradle.api.provider.Provider)"><code>BuildEventsListenerRegistry.onTaskCompletion</code></a>.</p>
<div class="paragraph">
<p>Prior to Gradle 9, unsupported providers were silently discarded and never received events during cache-hit builds.</p>
</div>
<div class="paragraph">
<p>To temporarily revert to the previous behavior, set the Gradle property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.unsafe.ignore.unsupported-build-events-listeners=true</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Use these opt-out options sparingly and only when they do not impact task execution results.
These options are intended as temporary workarounds and will be removed in future Gradle releases.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config_cache_requirements"><a class="anchor" href="#config_cache_requirements"></a><a class="link" href="#config_cache_requirements">Configuration Cache Requirements for your Build Logic</a></h3>
<div id="config_cache:requirements" class="paragraph">
<p>To capture and reload the task graph state using the Configuration Cache, Gradle enforces specific requirements on tasks and build logic.
Any violation of these requirements is reported as a Configuration Cache "problem," which causes the build to fail.</p>
</div>
<div class="paragraph">
<p>In most cases, these requirements expose undeclared inputs, making builds more strict, correct, and reliable.
Using the Configuration Cache is effectively an opt-in to these improvements.</p>
</div>
<div class="paragraph">
<p>The following sections describe each requirement and provide guidance on resolving issues in your build.</p>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:disallowed_types"><a class="anchor" href="#config_cache:requirements:disallowed_types"></a><a class="link" href="#config_cache:requirements:disallowed_types">Certain Types must not be Referenced by Tasks</a></h4>
<div class="paragraph">
<p>Some types must not be referenced by task fields or in task actions (methods annotated <code>@TaskAction</code>, or the <code>doFirst {}</code> and <code>doLast {}</code> DSL blocks).</p>
</div>
<div class="paragraph">
<p>These types fall into the following categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Live JVM state types</p>
</li>
<li>
<p>Gradle model types</p>
</li>
<li>
<p>Dependency management types</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These restrictions exist because these types cannot easily be stored or reconstructed by the Configuration Cache.</p>
</div>
<div class="sect4">
<h5 id="live_jvm_state_types"><a class="anchor" href="#live_jvm_state_types"></a><a class="link" href="#live_jvm_state_types">Live JVM State Types</a></h5>
<div class="paragraph">
<p>Live JVM state types (e.g., <code>ClassLoader</code>, <code>Thread</code>, <code>OutputStream</code>, <code>Socket</code>) are disallowed, as they do not represent task inputs or outputs.</p>
</div>
<div class="paragraph">
<p>The only exceptions are standard streams (<code>System.in</code>, <code>System.out</code>, <code>System.err</code>), which can be used, for example, as parameters for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Exec.html"><code>Exec</code></a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.JavaExec.html"><code>JavaExec</code></a> tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:requirements:gradle_model_types"><a class="anchor" href="#config_cache:requirements:gradle_model_types"></a><a class="link" href="#config_cache:requirements:gradle_model_types">Gradle Model Types</a></h5>
<div class="paragraph">
<p>Gradle model types (e.g., <code>Gradle</code>, <code>Settings</code>, <code>Project</code>, <code>SourceSet</code>, <code>Configuration</code>) are often used to pass task inputs that should instead be explicitly declared.</p>
</div>
<div class="paragraph">
<p>For example, instead of referencing a Project to retrieve <code>project.version</code> at execution time, declare the project version as a <code>Property&lt;String&gt;</code> input.
Similarly, instead of referencing a <code>SourceSet</code> for source files or classpath resolution, declare these as a <code>FileCollection</code> input.</p>
</div>
</div>
<div class="sect4">
<h5 id="dependency_management_types"><a class="anchor" href="#dependency_management_types"></a><a class="link" href="#dependency_management_types">Dependency Management Types</a></h5>
<div class="paragraph">
<p>The same requirement applies to dependency management types with some nuances.</p>
</div>
<div class="paragraph">
<p>Some dependency management types, such as <code>Configuration</code> and <code>SourceDirectorySet</code>, should not be used as task inputs because they contain unnecessary state and are not precise.
Use a less specific type that gives necessary features instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If referencing a <code>Configuration</code> to get resolved files, declare a <code>FileCollection</code> input.</p>
</li>
<li>
<p>If referencing a <code>SourceDirectorySet</code>, declare a <code>FileTree</code> input.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, referencing resolved dependency results is disallowed (e.g., <code>ArtifactResolutionQuery</code>, <code>ResolvedArtifact</code>, <code>ArtifactResult</code>).
Instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a <code>Provider&lt;ResolvedComponentResult&gt;</code> from <code>ResolutionResult.getRootComponent()</code>.</p>
</li>
<li>
<p>Use <code>ArtifactCollection.getResolvedArtifacts()</code>, which returns a <code>Provider&lt;Set&lt;ResolvedArtifactResult&gt;&gt;</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tasks should avoid referencing <em>resolved</em> results and instead rely on lazy specifications to defer dependency resolution until execution time.</p>
</div>
<div class="paragraph">
<p>Some types, such as <code>Publication</code> or <code>Dependency</code>, are not serializable but could be made so in the future.
Gradle may allow them as task inputs if necessary.</p>
</div>
<div class="paragraph">
<p>The following task references a <code>SourceSet</code>, which is not allowed:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SomeTask : DefaultTask() {

    @get:Input lateinit var sourceSet: SourceSet // <b class="conum">(1)</b>

    @TaskAction
    fun action() {
        val classpathFiles = sourceSet.compileClasspath.files
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SomeTask extends DefaultTask {

    @Input SourceSet sourceSet // <b class="conum">(1)</b>

    @TaskAction
    void action() {
        def classpathFiles = sourceSet.compileClasspath.files
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This will be reported as a problem because referencing <code>SourceSet</code> is not allowed</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following is the fixed version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SomeTask : DefaultTask() {

    @get:InputFiles @get:Classpath
    abstract val classpath: ConfigurableFileCollection // <b class="conum">(1)</b>

    @TaskAction
    fun action() {
        val classpathFiles = classpath.files
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SomeTask extends DefaultTask {

    @InputFiles @Classpath
    abstract ConfigurableFileCollection getClasspath() // <b class="conum">(1)</b>

    @TaskAction
    void action() {
        def classpathFiles = classpath.files
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>No more problems reported, the task now uses the supported type <code>ConfigurableFileCollection</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If an ad-hoc task in a script captures a disallowed reference in a <code>doLast {}</code> closure:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("someTask") {
    doLast {
        val classpathFiles = sourceSets.main.get().compileClasspath.files // <b class="conum">(1)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('someTask') {
    doLast {
        def classpathFiles = sourceSets.main.compileClasspath.files // <b class="conum">(1)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This will be reported as a problem because the <code>doLast {}</code> closure is capturing a reference to the <code>SourceSet</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You still need to fulfill the same requirement, that is, do not reference the disallowed type during task execution.</p>
</div>
<div class="paragraph">
<p>This is how the task declaration above can be fixed:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("someTask") {
    val classpath = sourceSets.main.get().compileClasspath // <b class="conum">(1)</b>
    doLast {
        val classpathFiles = classpath.files
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('someTask') {
    def classpath = sourceSets.main.compileClasspath // <b class="conum">(1)</b>
    doLast {
        def classpathFiles = classpath.files
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>No more problems reported, the <code>doLast {}</code> closure now only captures <code>classpath</code> which is of the supported <code>FileCollection</code> type</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sometimes, a disallowed type is indirectly referenced through another type.
For example, a task may reference an allowed type that, in turn, references a disallowed type.
The hierarchical view in the HTML problem report can help you trace such issues and identify the offending reference.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:use_project_during_execution"><a class="anchor" href="#config_cache:requirements:use_project_during_execution"></a><a class="link" href="#config_cache:requirements:use_project_during_execution">Using the <code>Project</code> Object at Execution Time</a></h4>
<div class="paragraph">
<p>Tasks must not use any <code>Project</code> objects during execution.
This includes calling <code>Task.getProject()</code> while a task is running.</p>
</div>
<div class="paragraph">
<p>Some cases can be resolved similarly to those described in <a href="#config_cache:requirements:disallowed_types">disallowed types</a>.</p>
</div>
<div class="paragraph">
<p>Often, equivalent functionality is available on both <code>Project</code> and <code>Task</code>.
For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you need a <code>Logger</code>, use <code>Task.logger</code> instead of <code>Project.logger</code>.</p>
</li>
<li>
<p>For file operations, use <a href="#service_injection">injected services</a> rather than <code>Project</code> methods.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following task incorrectly references the <code>Project</code> object at execution time:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SomeTask : DefaultTask() {
    @TaskAction
    fun action() {
        project.copy { // <b class="conum">(1)</b>
            from("source")
            into("destination")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SomeTask extends DefaultTask {
    @TaskAction
    void action() {
        project.copy { // <b class="conum">(1)</b>
            from 'source'
            into 'destination'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This will be reported as a problem because the task action is using the <code>Project</code> object at execution time</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Fixed version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class SomeTask : DefaultTask() {

    @get:Inject abstract val fs: FileSystemOperations // <b class="conum">(1)</b>

    @TaskAction
    fun action() {
        fs.copy {
            from("source")
            into("destination")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class SomeTask extends DefaultTask {

    @Inject abstract FileSystemOperations getFs() // <b class="conum">(1)</b>

    @TaskAction
    void action() {
        fs.copy {
            from 'source'
            into 'destination'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>No more problem reported, the injected <code>FileSystemOperations</code> service is supported as a replacement for <code>project.copy {}</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the same problem occurs in an ad-hoc task in a script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("someTask") {
    doLast {
        project.copy { // <b class="conum">(1)</b>
            from("source")
            into("destination")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('someTask') {
    doLast {
        project.copy { // <b class="conum">(1)</b>
            from 'source'
            into 'destination'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This will be reported as a problem because the task action is using the <code>Project</code> object at execution time</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Fixed version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">interface Injected {
    @get:Inject val fs: FileSystemOperations // <b class="conum">(1)</b>
}
tasks.register("someTask") {
    val injected = project.objects.newInstance&lt;Injected&gt;() // <b class="conum">(2)</b>
    doLast {
        injected.fs.copy { // <b class="conum">(3)</b>
            from("source")
            into("destination")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">interface Injected {
    @Inject FileSystemOperations getFs() // <b class="conum">(1)</b>
}
tasks.register('someTask') {
    def injected = project.objects.newInstance(Injected) // <b class="conum">(2)</b>
    doLast {
        injected.fs.copy { // <b class="conum">(3)</b>
            from 'source'
            into 'destination'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Services can&#8217;t be injected directly in scripts, we need an extra type to convey the injection point</p>
</li>
<li>
<p>Create an instance of the extra type using <code>project.object</code> outside the task action</p>
</li>
<li>
<p>No more problem reported, the task action references <code>injected</code> that provides the <code>FileSystemOperations</code> service, supported as a replacement for <code>project.copy {}</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Fixing ad-hoc tasks in scripts requires additional effort, making it a good opportunity to refactor them into proper task classes.</p>
</div>
<div class="paragraph">
<p>The table below lists recommended replacements for commonly used <code>Project</code> methods:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instead of:</th>
<th class="tableblock halign-left valign-top">Use:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.rootDir</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.rootDir</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.projectDir</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.projectDir</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.buildDir</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.buildDir</code> has been deprecated. You should use <code>project.layout.buildDirectory</code>.
Use a task input or output property or a script variable to capture the result of using <code>project.layout.buildDirectory</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.name</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.name</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.description</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.description</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.group</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.group</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.version</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.version</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.properties</code>, <code>project.property(name)</code>, <code>project.hasProperty(name)</code>, <code>project.getProperty(name)</code> or <code>project.findProperty(name)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:gradleProperty(java.lang.String)">Value providers for Gradle properties</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.logger</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#getLogger--">Task.logger</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.provider {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:provider(java.util.concurrent.Callable)">ProviderFactory.provider {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.file(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.file(file)</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.uri(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.uri(path)</code> to calculate the actual parameter. Otherwise, <code>File.toURI()</code> or some other JVM API can be used.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.relativePath(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#getProjectDirectory--">ProjectLayout.projectDirectory</a>.<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/Directory.html#file-java.lang.String-">file(path)</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.files(paths)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileCollection--">ObjectFactory.fileCollection()</a>.<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileCollection.html#from-java.lang.Object&#8230;&#8203;-">from(paths)</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.fileTree(paths)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html#fileTree--">ObjectFactory.fileTree()</a>.<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ConfigurableFileTree.html#from-java.lang.Object-">from(dir)</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.zipTree(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ArchiveOperations.html#zipTree-java.lang.Object-">ArchiveOperations.zipTree(path)</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.tarTree(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ArchiveOperations.html#tarTree-java.lang.Object-">ArchiveOperations.tarTree(path)</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.resources</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A task input or output property or a script variable to capture the result of using <code>project.resource</code> to calculate the actual parameter.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.copySpec {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html#copySpec--">FileSystemOperations.copySpec {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.copy {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html#copy-org.gradle.api.Action-">FileSystemOperations.copy {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.sync {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html#sync-org.gradle.api.Action-">FileSystemOperations.sync {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.delete {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileSystemOperations.html#delete-org.gradle.api.Action-">FileSystemOperations.delete {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.mkdir(path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The Kotlin, Groovy or Java API available to your build logic.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.exec {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/ExecOperations.html#exec-org.gradle.api.Action-">ExecOperations.exec {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.javaexec {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/process/ExecOperations.html#javaexec-org.gradle.api.Action-">ExecOperations.javaexec {}</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.ant {}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#getAnt--">Task.ant</a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>project.createAntBuilder()</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#getAnt--">Task.ant</a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:task_access"><a class="anchor" href="#config_cache:requirements:task_access"></a><a class="link" href="#config_cache:requirements:task_access">Accessing a Task Instance from Another Instance</a></h4>
<div class="paragraph">
<p>Tasks must not directly access the state of another task instance.
Instead, they should be connected using <a href="#working_with_task_dependencies_in_lazy_properties">input and output relationships</a>.</p>
</div>
<div class="paragraph">
<p>This requirement ensures that tasks remain isolated and correctly cacheable.
As a result, it is unsupported to write tasks that configure other tasks at execution time.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:shared_objects"><a class="anchor" href="#config_cache:requirements:shared_objects"></a><a class="link" href="#config_cache:requirements:shared_objects">Sharing Mutable Objects</a></h4>
<div class="paragraph">
<p>When storing a task in the Configuration Cache, all objects referenced through the tasks fields are serialized.</p>
</div>
<div class="paragraph">
<p>In most cases, deserialization preserves reference equalityif two fields <code>a</code> and <code>b</code> reference the same instance at configuration time, they will still reference the same instance after deserialization (<code>a == b</code>, or <code>a === b</code> in Groovy/Kotlin syntax).</p>
</div>
<div class="paragraph">
<p>However, for performance reasons, certain classessuch as <code>java.lang.String</code>, <code>java.io.File</code>, and many <code>java.util.Collection</code> implementationsare serialized without preserving reference equality.
After deserialization, fields that referred to these objects may reference different but equal instances.</p>
</div>
<div class="paragraph">
<p>Consider a task that stores a user-defined object and an <code>ArrayList</code> as task fields:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class StateObject {
    // ...we assume there is some mutable state here, and an equals implementation...
}

abstract class StatefulTask : DefaultTask() {
    @get:Internal
    var stateObject: StateObject? = null

    @get:Internal
    var strings: List&lt;String&gt;? = null
}


tasks.register&lt;StatefulTask&gt;("checkEquality") {
    val objectValue = StateObject()
    // ...configure objectValue as needed...
    val stringsValue = arrayListOf("a", "b")

    stateObject = objectValue
    strings = stringsValue

    doLast { // <b class="conum">(1)</b>
        println("POJO reference equality: ${stateObject === objectValue}") // <b class="conum">(2)</b>
        println("Collection reference equality: ${strings === stringsValue}") // <b class="conum">(3)</b>
        println("Collection equality: ${strings == stringsValue}") // <b class="conum">(4)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">class StateObject {
    // ...we assume there is some mutable state here, and an equals implementation...
}

abstract class StatefulTask extends DefaultTask {
    @Internal
    StateObject stateObject

    @Internal
    List&lt;String&gt; strings
}


tasks.register("checkEquality", StatefulTask) {
    def objectValue = new StateObject()
    // ...configure objectValue as needed...
    def stringsValue = ["a", "b"] as ArrayList&lt;String&gt;

    stateObject = objectValue
    strings = stringsValue

    doLast { // <b class="conum">(1)</b>
        println("POJO reference equality: ${stateObject === objectValue}") // <b class="conum">(2)</b>
        println("Collection reference equality: ${strings === stringsValue}") // <b class="conum">(3)</b>
        println("Collection equality: ${strings == stringsValue}") // <b class="conum">(4)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>doLast</code> action captures the references from the enclosing scope. These captured references are also serialized to the Configuration Cache.</p>
</li>
<li>
<p>Compare the reference to an object of user-defined class stored in the task field and the reference captured in the <code>doLast</code> action.</p>
</li>
<li>
<p>Compare the reference to <code>ArrayList</code> instance stored in the task field and the reference captured in the <code>doLast</code> action.</p>
</li>
<li>
<p>Check the equality of stored and captured lists.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Without Configuration Cache, reference equality is preserved in both cases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> ./gradlew --no-configuration-cache checkEquality
&gt; Task :checkEquality
POJO reference equality: true
Collection reference equality: true
Collection equality: true</pre>
</div>
</div>
<div class="paragraph">
<p>With Configuration Cache enabled, only user-defined object references remain identical.
List references are different, although the lists themselves remain equal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> ./gradlew --configuration-cache checkEquality
&gt; Task :checkEquality
POJO reference equality: true
Collection reference equality: false
Collection equality: true</pre>
</div>
</div>
<div class="paragraph">
<p>Best Practices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid sharing mutable objects between configuration and execution phases.</p>
</li>
<li>
<p>If sharing state is necessary, wrap it in a user-defined class.</p>
</li>
<li>
<p>Do not rely on reference equality for standard Java, Groovy, Kotlin, or Gradle-defined types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reference equality is never preserved between taskseach task is an isolated "realm."
To share objects across tasks, use a <a href="#build_services">Build Service</a> to wrap the shared state.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:task_extensions"><a class="anchor" href="#config_cache:requirements:task_extensions"></a><a class="link" href="#config_cache:requirements:task_extensions">Accessing Task Extensions or Conventions</a></h4>
<div class="paragraph">
<p>Tasks must <strong>not</strong> access conventions, extensions, or extra properties at execution time.</p>
</div>
<div class="paragraph">
<p>Instead, any value relevant to task execution should be explicitly modeled as a task property to ensure proper caching and reproducibility.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:build_listeners"><a class="anchor" href="#config_cache:requirements:build_listeners"></a><a class="link" href="#config_cache:requirements:build_listeners">Using Build Listeners</a></h4>
<div class="paragraph">
<p>Plugins and build scripts must <strong>not</strong> register build listeners that are created at configuration time and triggered at execution time.
This includes listeners such as <code>BuildListener</code> or <code>TaskExecutionListener</code>.</p>
</div>
<div class="paragraph">
<p>Recommended Alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <a href="#build_services">Build Services</a> to handle execution-time logic.</p>
</li>
<li>
<p>Register a Build Service to receive <a href="#operation_listener">task execution notifications</a>.</p>
</li>
<li>
<p>Replace <code>buildFinished</code> listeners with <a href="#dataflow_action">dataflow actions</a> to manage build results.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:external_processes"><a class="anchor" href="#config_cache:requirements:external_processes"></a><a class="link" href="#config_cache:requirements:external_processes">Running External Processes</a></h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Plugin and build scripts should avoid running external processes at configuration time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should avoid using these APIs for running processes during configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Java/Kotlin</strong>: <code>ProcessBuilder</code>, <code>Runtime.exec(&#8230;&#8203;)</code>, etc&#8230;&#8203;</p>
</li>
<li>
<p><strong>Groovy</strong>: <code>*.execute()</code>, etc&#8230;&#8203;</p>
</li>
<li>
<p><strong>Gradle</strong>: <code>ExecOperations.exec</code>, <code>ExecOperations.javaexec</code>, etc&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The flexibility of these methods prevent Gradle from determining how the calls impact the build configuration, making it difficult to ensure that the Configuration Cache entry can be safely reused.</p>
</div>
<div class="paragraph">
<p>However, if running processes is required at configuration time, you can use the configuration-cache-compatible APIs detailed below.</p>
</div>
<div class="paragraph">
<p>For simpler cases, when grabbing the output of the process is enough,
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:exec(org.gradle.api.Action)"><code>providers.exec()</code></a> and
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:javaexec(org.gradle.api.Action)"><code>providers.javaexec()</code></a> can be used:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val gitVersion = providers.exec {
    commandLine("git", "--version")
}.standardOutput.asText.get()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def gitVersion = providers.exec {
    commandLine("git", "--version")
}.standardOutput.asText.get()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more complex cases, a custom <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/ValueSource.html"><code>ValueSource</code></a> implementation with injected <code>ExecOperations</code> can be used.
This <code>ExecOperations</code> instance can be used at configuration time without restrictions:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class GitVersionValueSource : ValueSource&lt;String, ValueSourceParameters.None&gt; {
    @get:Inject
    abstract val execOperations: ExecOperations

    override fun obtain(): String {
        val output = ByteArrayOutputStream()
        execOperations.exec {
            commandLine("git", "--version")
            standardOutput = output
        }
        return String(output.toByteArray(), Charset.defaultCharset())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class GitVersionValueSource implements ValueSource&lt;String, ValueSourceParameters.None&gt; {
    @Inject
    abstract ExecOperations getExecOperations()

    String obtain() {
        ByteArrayOutputStream output = new ByteArrayOutputStream()
        execOperations.exec {
            it.commandLine "git", "--version"
            it.standardOutput = output
        }
        return new String(output.toByteArray(), Charset.defaultCharset())
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also use standard Java/Kotlin/Groovy process APIs like <code>java.lang.ProcessBuilder</code> in the <code>ValueSource</code>.</p>
</div>
<div class="paragraph">
<p>The <code>ValueSource</code> implementation can then be used to create a provider with <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:of(java.lang.Class,%20org.gradle.api.Action)"><code>providers.of</code></a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val gitVersionProvider = providers.of(GitVersionValueSource::class) {}
val gitVersion = gitVersionProvider.get()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def gitVersionProvider = providers.of(GitVersionValueSource.class) {}
def gitVersion = gitVersionProvider.get()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In both approaches, if the value of the provider is used at configuration time then it will become a build configuration input.
The external process will be executed for every build to determine if the Configuration Cache is <code>UP-TO-DATE</code>, so it is recommended to only call fast-running processes at configuration time.
If the value changes then the cache is invalidated and the process will be run again during this build as part of the configuration phase.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:reading_sys_props_and_env_vars"><a class="anchor" href="#config_cache:requirements:reading_sys_props_and_env_vars"></a><a class="link" href="#config_cache:requirements:reading_sys_props_and_env_vars">Reading System Properties and Environment Variables</a></h4>
<div class="paragraph">
<p>Plugins and build scripts may read system properties and environment variables directly at configuration time with standard Java, Groovy, or Kotlin APIs or with the value supplier APIs.
Doing so makes such variables or properties a build configuration input.
Therefore, changing their value invalidates the Configuration Cache.</p>
</div>
<div class="paragraph">
<p>The Configuration Cache report includes a list of these build configuration inputs to help track them.</p>
</div>
<div class="paragraph">
<p>In general, you should avoid reading the value of system properties and environment variables at configuration time to avoid cache misses when these values change.
Instead, you can connect the <code>Provider</code> returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:systemProperty(java.lang.String)"><code>providers.systemProperty()</code></a> or
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:environmentVariable(java.lang.String)"><code>providers.environmentVariable()</code></a> to task properties.</p>
</div>
<div class="paragraph">
<p>Some access patterns that potentially enumerate all environment variables or system properties (for example, calling <code>System.getenv().forEach()</code> or using the iterator of its <code>keySet()</code>) are discouraged.
In this case, Gradle cannot find out what properties are actual build configuration inputs, so every available property becomes one.
Even adding a new property will invalidate the cache if this pattern is used.</p>
</div>
<div class="paragraph">
<p>Using a custom predicate to filter environment variables is an example of this discouraged pattern:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val jdkLocations = System.getenv().filterKeys {
    it.startsWith("JDK_")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def jdkLocations = System.getenv().findAll {
    key, _ -&gt; key.startsWith("JDK_")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The logic in the predicate is opaque to the Configuration Cache, so all environment variables are considered inputs.
One way to reduce the number of inputs is to always use methods that query a concrete variable name, such as <code>getenv(String)</code>, or <code>getenv().get()</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val jdkVariables = listOf("JDK_8", "JDK_11", "JDK_17")
val jdkLocations = jdkVariables.filter { v -&gt;
    System.getenv(v) != null
}.associate { v -&gt;
    v to System.getenv(v)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def jdkVariables = ["JDK_8", "JDK_11", "JDK_17"]
def jdkLocations = jdkVariables.findAll { v -&gt;
    System.getenv(v) != null
}.collectEntries { v -&gt;
    [v, System.getenv(v)]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The fixed code above, however, is not exactly equivalent to the original as only an explicit list of variables is supported.
Prefix-based filtering is a common scenario, so there are provider-based APIs to access
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:systemPropertiesPrefixedBy(java.lang.String)">system properties</a> and
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:environmentVariablesPrefixedBy(java.lang.String)">environment variables</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val jdkLocationsProvider = providers.environmentVariablesPrefixedBy("JDK_")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def jdkLocationsProvider = providers.environmentVariablesPrefixedBy("JDK_")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that the Configuration Cache would be invalidated not only when the value of the variable changes or the variable is removed but also
when another variable with the matching prefix is added to the environment.</p>
</div>
<div class="paragraph">
<p>For more complex use cases a custom <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/provider/ValueSource.html"><code>ValueSource</code></a> implementation can be used.
System properties and environment variables referenced in the code of the <code>ValueSource</code> do not become build configuration inputs, so any processing can be applied.
Instead, the value of the <code>ValueSource</code> is recomputed each time the build runs and only if the value changes the Configuration Cache is invalidated.
For example, a <code>ValueSource</code> can be used to get all environment variables with names containing the substring <code>JDK</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class EnvVarsWithSubstringValueSource : ValueSource&lt;Map&lt;String, String&gt;, EnvVarsWithSubstringValueSource.Parameters&gt; {
    interface Parameters : ValueSourceParameters {
        val substring: Property&lt;String&gt;
    }

    override fun obtain(): Map&lt;String, String&gt; {
        return System.getenv().filterKeys { key -&gt;
            key.contains(parameters.substring.get())
        }
    }
}
val jdkLocationsProvider = providers.of(EnvVarsWithSubstringValueSource::class) {
    parameters {
        substring = "JDK"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class EnvVarsWithSubstringValueSource implements ValueSource&lt;Map&lt;String, String&gt;, Parameters&gt; {
    interface Parameters extends ValueSourceParameters {
        Property&lt;String&gt; getSubstring()
    }

    Map&lt;String, String&gt; obtain() {
        return System.getenv().findAll { key, _ -&gt;
            key.contains(parameters.substring.get())
        }
    }
}
def jdkLocationsProvider = providers.of(EnvVarsWithSubstringValueSource.class) {
    parameters {
        substring = "JDK"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:undeclared_file_read"><a class="anchor" href="#config_cache:requirements:undeclared_file_read"></a><a class="link" href="#config_cache:requirements:undeclared_file_read">Undeclared Reading of Files</a></h4>
<div class="paragraph">
<p>Plugins and build scripts should not read files directly using the Java, Groovy or Kotlin APIs at configuration time.
Instead, declare files as potential build configuration inputs using the value supplier APIs.</p>
</div>
<div class="paragraph">
<p>This problem is caused by build logic similar to this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val config = file("some.conf").readText()</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def config = file('some.conf').text</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To fix this problem, read files using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:fileContents(org.gradle.api.file.RegularFile)"><code>providers.fileContents()</code></a> instead:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val config = providers.fileContents(layout.projectDirectory.file("some.conf"))
    .asText</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def config = providers.fileContents(layout.projectDirectory.file('some.conf'))
    .asText</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In general, you should avoid reading files at configuration time, to avoid invalidating Configuration Cache entries when the file content changes.
Instead, you can connect the <code>Provider</code> returned by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.provider.ProviderFactory.html#org.gradle.api.provider.ProviderFactory:fileContents(org.gradle.api.file.RegularFile)"><code>providers.fileContents()</code></a> to task properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:requirements:bytecode_modifications_and_isolation"><a class="anchor" href="#config_cache:requirements:bytecode_modifications_and_isolation"></a><a class="link" href="#config_cache:requirements:bytecode_modifications_and_isolation">Bytecode Modifications and Java Agent</a></h4>
<div class="paragraph">
<p>To detect the configuration inputs, Gradle modifies the bytecode of classes on the build script classpath, like plugins and their dependencies.
Gradle uses a Java agent to modify the bytecode.
Integrity self-checks of some libraries may fail because of the changed bytecode or the agent&#8217;s presence.</p>
</div>
<div class="paragraph">
<p>To work around this, you can use the <a href="#tasks_parallel_worker">Worker API</a> with classloader or process isolation to encapsulate the library code.
The bytecode of the worker&#8217;s classpath is not modified, so the self-checks should pass.
When process isolation is used, the worker action is executed in a separate worker process that doesn&#8217;t have the Gradle Java agent installed.</p>
</div>
<div class="paragraph">
<p>In simple cases, when the libraries also provide command-line entry points (<code>public static void main()</code> method), you can also use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/JavaExec.html"><code>JavaExec</code></a> task to isolate the library.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:secrets"><a class="anchor" href="#config_cache:secrets"></a><a class="link" href="#config_cache:secrets">Handling of Credentials and Secrets</a></h4>
<div class="paragraph">
<p>Currently, the Configuration Cache does not have a built-in mechanism to prevent storing secrets used as inputs.
As a result, secrets may end up in the serialized Configuration Cache entry, which, by default, is stored under <code>.gradle/configuration-cache</code> in your project directory.</p>
</div>
<div class="paragraph">
<p>To mitigate the risk of accidental exposure, Gradle encrypts the Configuration Cache.
When required, Gradle transparently generates a machine-specific secret key, caches it under the
<code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code> directory, and uses it to encrypt data in the project-specific caches.</p>
</div>
<div class="paragraph">
<p>To further enhance security, follow these recommendations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Secure access to Configuration Cache entries.</p>
</li>
<li>
<p>Use <code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a>/gradle.properties</code> to store secrets.
The content of this file is <strong>not</strong> included in the Configuration Cacheonly its fingerprint is.
If storing secrets in this file, ensure access is <strong>properly restricted</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/22618">gradle/gradle#22618</a>.</p>
</div>
<div class="sect4">
<h5 id="config_cache:secrets:configuring_encryption_key"><a class="anchor" href="#config_cache:secrets:configuring_encryption_key"></a><a class="link" href="#config_cache:secrets:configuring_encryption_key">Providing an Encryption Key with the <code>GRADLE_ENCRYPTION_KEY</code> Environment Variable</a></h5>
<div class="paragraph">
<p>By default, Gradle automatically generates and manages the encryption key as a Java keystore, stored under the <code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code> directory.</p>
</div>
<div class="paragraph">
<p>For environments where this behavior is undesirablesuch as when the <code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code> directory is shared across multiple machinesyou can explicitly provide an encryption key using the <code>GRADLE_ENCRYPTION_KEY</code> environment variable.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The same encryption key <strong>must be consistently provided</strong> across multiple Gradle runs; otherwise, Gradle will be unable to reuse existing cached configurations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:secrets:generating_encryption_key"><a class="anchor" href="#config_cache:secrets:generating_encryption_key"></a><a class="link" href="#config_cache:secrets:generating_encryption_key">Generating an Encryption Key compatible with <code>GRADLE_ENCRYPTION_KEY</code></a></h5>
<div class="paragraph">
<p>To encrypt the Configuration Cache using a user-specified encryption key, Gradle requires the <code>GRADLE_ENCRYPTION_KEY</code> environment variable to be set with a valid AES key, encoded as a Base64 string.</p>
</div>
<div class="paragraph">
<p>You can generate a Base64-encoded AES-compatible key using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> openssl rand -base64 16</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command works on Linux and macOS, and on Windows if using a tool like Cygwin.</p>
</div>
<div class="paragraph">
<p>Once generated, set the Base64-encoded key as the value of the <code>GRADLE_ENCRYPTION_KEY</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> export GRADLE_ENCRYPTION_KEY="your-generated-key-here"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config_cache_debugging"><a class="anchor" href="#config_cache_debugging"></a><a class="link" href="#config_cache_debugging">Debugging and Troubleshooting the Configuration Cache</a></h3>
<div class="paragraph">
<p>This section provides general guidelines for resolving issues with the Configuration Cache, whether in your build logic or Gradle plugins.</p>
</div>
<div class="sect3">
<h4 id="config_cache:troubleshooting"><a class="anchor" href="#config_cache:troubleshooting"></a><a class="link" href="#config_cache:troubleshooting">Use the Configuration Report</a></h4>
<div class="paragraph">
<p>When Gradle encounters a problem serializing the necessary state to execute tasks, it generates an HTML report detailing the detected issues.
The console output includes a clickable link to this report, allowing you to investigate the root causes.</p>
</div>
<div class="paragraph">
<p>Consider the following build script, which contains two issues:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("someTask") {
    val destination = System.getProperty("someDestination") // <b class="conum">(1)</b>
    inputs.dir("source")
    outputs.dir(destination)
    doLast {
        project.copy { // <b class="conum">(2)</b>
            from("source")
            into(destination)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('someTask') {
    def destination = System.getProperty('someDestination') // <b class="conum">(1)</b>
    inputs.dir('source')
    outputs.dir(destination)
    doLast {
        project.copy { // <b class="conum">(2)</b>
            from 'source'
            into destination
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><a href="#config_cache:requirements:reading_sys_props_and_env_vars">A system property read at configuration time</a></p>
</li>
<li>
<p><a href="#config_cache:requirements:use_project_during_execution">Using the <code>Project</code> object at execution time</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Running the task fails with the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> ./gradlew --configuration-cache someTask -DsomeDestination=dest
...
Calculating task graph as no cached configuration is available for tasks: someTask
&gt; Task :someTask FAILED

1 problem was found storing the configuration cache.
- Build file 'build.gradle': line 6: invocation of 'Task.project' at execution time is unsupported with the configuration cache.
  See https://docs.gradle.org/0.0.0/userguide/configuration_cache_requirements.html#config_cache:requirements:use_project_during_execution

See the complete report at file:///home/user/gradle/samples/build/reports/configuration-cache/&lt;hash&gt;/configuration-cache-report.html
1 actionable task: 1 executed
Configuration cache entry discarded with 1 problem.

FAILURE: Build failed with an exception.

* Where:
Build file '/home/user/gradle/samples/build.gradle' line: 6

* What went wrong:
Execution failed for task ':someTask'.
&gt; Invocation of 'Task.project' by task ':someTask' at execution time is unsupported with the configuration cache.

* Try:
&gt; Run with --stacktrace option to get the stack trace.
&gt; Run with --info or --debug option to get more log output.
&gt; Run with --scan to generate a Build Scan (Powered by Develocity).
&gt; Get more help at https://help.gradle.org.

BUILD FAILED in 0s
Configuration Cache entry discarded with 1 problem.</pre>
</div>
</div>
<div class="paragraph">
<p>Since a problem was detected, Gradle discards the Configuration Cache entry, preventing reuse in future builds.</p>
</div>
<div class="paragraph">
<p>The linked HTML report provides details about the detected problems:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache/problems-report.png" alt="problems report">
</div>
</div>
<div class="paragraph">
<p>The report presents issues in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Grouped by message</strong>  Quickly identify recurring problem types.</p>
</li>
<li>
<p><strong>Grouped by task</strong>  Identify which tasks are causing problems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Expanding the problem tree helps locate the root cause within the object graph.</p>
</div>
<div class="paragraph">
<p>Additionally, the report lists detected build configuration inputs, such as system properties, environment variables, and value suppliers accessed during configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/configuration-cache/inputs-report.png" alt="inputs report">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Each problem entry in the report includes links to relevant <a href="#config_cache:requirements">Configuration Cache requirements</a> for guidance on resolving the issue, as well as any related <a href="#config_cache:not_yet_implemented">Not Yet Implemented features</a>.</p>
</div>
<div class="paragraph">
<p>When modifying your build or plugin, consider <a href="#config_cache:testing">Testing your Build Logic with TestKit</a> to verify changes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>At this stage, you can either ignore the problems (<a href="#config_cache:usage:ignore_problems">turn them into warnings</a>) to continue exploring Configuration Cache behavior, or fix the issues immediately.</p>
</div>
<div class="paragraph">
<p>To continue using the Configuration Cache while observing problems, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew --configuration-cache --configuration-cache-problems=warn someTask -DsomeDestination=dest
Calculating task graph as no cached configuration is available for tasks: someTask
&gt; Task :someTask

1 problem was found storing the configuration cache.
- Build file 'build.gradle': line 6: invocation of 'Task.project' at execution time is unsupported with the configuration cache.
  See https://docs.gradle.org/0.0.0/userguide/configuration_cache_requirements.html#config_cache:requirements:use_project_during_execution

See the complete report at file:///home/user/gradle/samples/build/reports/configuration-cache/&lt;hash&gt;/configuration-cache-report.html

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry stored with 1 problem.
 ./gradlew --configuration-cache --configuration-cache-problems=warn someTask -DsomeDestination=dest
Reusing configuration cache.
&gt; Task :someTask

1 problem was found reusing the configuration cache.
- Build file 'build.gradle': line 6: invocation of 'Task.project' at execution time is unsupported with the configuration cache.
  See https://docs.gradle.org/0.0.0/userguide/configuration_cache_requirements.html#config_cache:requirements:use_project_during_execution

See the complete report at file:///home/user/gradle/samples/build/reports/configuration-cache/&lt;hash&gt;/configuration-cache-report.html

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry reused with 1 problem.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will successfully store and reuse the Configuration Cache while continuing to report the problem.</p>
</div>
<div class="paragraph">
<p>The report and console logs provide links to guidance on resolving detected issues.</p>
</div>
<div class="paragraph">
<p>Heres a corrected version of the example build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyCopyTask : DefaultTask() { // <b class="conum">(1)</b>

    @get:InputDirectory abstract val source: DirectoryProperty // <b class="conum">(2)</b>

    @get:OutputDirectory abstract val destination: DirectoryProperty // <b class="conum">(2)</b>

    @get:Inject abstract val fs: FileSystemOperations // <b class="conum">(3)</b>

    @TaskAction
    fun action() {
        fs.copy { // <b class="conum">(3)</b>
            from(source)
            into(destination)
        }
    }
}

tasks.register&lt;MyCopyTask&gt;("someTask") {
    val projectDir = layout.projectDirectory
    source = projectDir.dir("source")
    destination = projectDir.dir(System.getProperty("someDestination"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyCopyTask extends DefaultTask { // <b class="conum">(1)</b>

    @InputDirectory abstract DirectoryProperty getSource() // <b class="conum">(2)</b>

    @OutputDirectory abstract DirectoryProperty getDestination() // <b class="conum">(2)</b>

    @Inject abstract FileSystemOperations getFs() // <b class="conum">(3)</b>

    @TaskAction
    void action() {
        fs.copy { // <b class="conum">(3)</b>
            from source
            into destination
        }
    }
}

tasks.register('someTask', MyCopyTask) {
    def projectDir = layout.projectDirectory
    source = projectDir.dir('source')
    destination = projectDir.dir(System.getProperty('someDestination'))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We turned our ad-hoc task into a proper task class,</p>
</li>
<li>
<p>with inputs and outputs declaration,</p>
</li>
<li>
<p>and injected with the <code>FileSystemOperations</code> service, a supported replacement for <a href="#config_cache:requirements:use_project_during_execution"><code>project.copy {}</code></a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After fixing these issues, running the task twice successfully reuses the Configuration Cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> ./gradlew --configuration-cache someTask -DsomeDestination=dest
Calculating task graph as no cached configuration is available for tasks: someTask
&gt; Task :someTask

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry stored.
 ./gradlew --configuration-cache someTask -DsomeDestination=dest
Reusing configuration cache.
&gt; Task :someTask

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry reused.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a build input changes (e.g., a system property value), the Configuration Cache entry becomes invalid, requiring a new configuration phase:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> ./gradlew --configuration-cache someTask -DsomeDestination=another
Calculating task graph as configuration cache cannot be reused because system property 'someDestination' has changed.
&gt; Task :someTask

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry stored.</pre>
</div>
</div>
<div class="paragraph">
<p>The cache entry was invalidated because the system property was read at configuration time, forcing Gradle to re-run configuration when its value changed.</p>
</div>
<div class="paragraph">
<p>A better approach is to use a provider to defer reading the system property until execution time:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;MyCopyTask&gt;("someTask") {
    val projectDir = layout.projectDirectory
    source = projectDir.dir("source")
    destination = projectDir.dir(providers.systemProperty("someDestination")) // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('someTask', MyCopyTask) {
    def projectDir = layout.projectDirectory
    source = projectDir.dir('source')
    destination = projectDir.dir(providers.systemProperty('someDestination')) // <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We wired the system property provider directly, without reading it at configuration time.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, the cache entry remains reusable even when changing the system property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> ./gradlew --configuration-cache someTask -DsomeDestination=dest
Calculating task graph as no cached configuration is available for tasks: someTask
&gt; Task :someTask

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry stored.
 ./gradlew --configuration-cache someTask -DsomeDestination=another
Reusing configuration cache.
&gt; Task :someTask

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed
Configuration Cache entry reused.</pre>
</div>
</div>
<div class="paragraph">
<p>With these fixes in place, this task is fully compatible with the Configuration Cache.</p>
</div>
</div>
<div class="sect3">
<h4 id="enable_warning_mode"><a class="anchor" href="#enable_warning_mode"></a><a class="link" href="#enable_warning_mode">Enable Warning Mode</a></h4>
<div class="paragraph">
<p>To ease migration, you can treat configuration cache problems as warnings instead of failures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew --configuration-cache-problems=warn</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or set it in <code>gradle.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.problems=warn</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>The warning mode is a migration and troubleshooting aid and not intended as a persistent way of ignoring incompatibilities.
It will also not prevent new incompatibilities being accidentally added to your build later.</p>
</div>
<div class="paragraph">
<p>Instead, we recommend explicitly marking problematic tasks as <a href="#config_cache:task_opt_out">incompatible</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, Gradle allows up to 512 warnings before failing the build.
You can lower this limit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew -Dorg.gradle.configuration-cache.max-problems=5</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:task_opt_out"><a class="anchor" href="#config_cache:task_opt_out"></a><a class="link" href="#config_cache:task_opt_out">Declare Incompatible Tasks</a></h4>
<div class="paragraph">
<p>You can explicitly mark a task as incompatible with the Configuration Cache using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#notCompatibleWithConfigurationCache-java.lang.String-"><code>Task.notCompatibleWithConfigurationCache()</code></a> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("resolveAndLockAll") {
    notCompatibleWithConfigurationCache("Filters configurations at execution time")
    doFirst {
        require(gradle.startParameter.isWriteDependencyLocks) { "$path must be run from the command line with the `--write-locks` flag" }
    }
    doLast {
        configurations.filter {
            // Add any custom filtering on the configurations to be resolved
            it.isCanBeResolved
        }.forEach { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('resolveAndLockAll') {
    notCompatibleWithConfigurationCache("Filters configurations at execution time")
    doFirst {
        assert gradle.startParameter.writeDependencyLocks : "$path must be run from the command line with the `--write-locks` flag"
    }
    doLast {
        configurations.findAll {
            // Add any custom filtering on the configurations to be resolved
            it.canBeResolved
        }.each { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a task is marked as incompatible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration Cache problems <strong>in that task</strong> will no longer cause the build to fail.</p>
</li>
<li>
<p>Gradle discards the configuration state at the end of the build if an incompatible task is executed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This mechanism can be useful during migration, allowing you to temporarily opt out tasks that require more extensive changes to become Configuration Cache-compatible.</p>
</div>
<div class="paragraph">
<p>For more details, refer to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Task.html#notCompatibleWithConfigurationCache-java.lang.String-">method</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:integrity_check"><a class="anchor" href="#config_cache:integrity_check"></a><a class="link" href="#config_cache:integrity_check">Use Integrity Checks</a></h4>
<div class="paragraph">
<p>To reduce entry size and improve performance, Gradle performs minimal integrity checks when writing and reading data.
However, this approach can make troubleshooting issues more difficult, especially when dealing with concurrency problems or serialization errors.
An incorrectly stored object may not be detected immediately but could lead to misleading or misattributed errors when reading cached data later.</p>
</div>
<div class="paragraph">
<p>To make debugging easier, Gradle provides an option to enable stricter integrity checks.
This setting helps identify inconsistencies earlier but may slow down cache operations and significantly increase the cache entry size.
To enable stricter integrity checks, add the following line to your <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.gradle.configuration-cache.integrity-check=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, let&#8217;s look at a type that implements a custom serialization protocol incorrectly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class User implements Serializable {
    private transient String name;
    private transient int age;

    private void writeObject(ObjectOutputStream out) throws IOException {
        out.defaultWriteObject();

        out.writeObject(name); // <b class="conum">(1)</b>
        out.writeInt(age);
    }

    private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
        in.defaultReadObject();

        this.name = (String) in.readObject();
        // this.age = in.readInt(); // <b class="conum">(2)</b>
    }
    // ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>writeObject</code> serializes both fields.</p>
</li>
<li>
<p><code>readObject</code> reads only the first field, leaving the remaining data in the stream.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Such a type will cause problems when used as part of a task state, because the configuration cache will try to interpret the remaining unread part of the object as some new value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class GreetTask extends DefaultTask {
    User user = new User("John", 23);

    @TaskAction
    public void greet() {
        System.out.println("Hello, " + user.getName() + "!");
        System.out.println("Have a wonderful " + (user.getAge() + 1) +"th birthday!");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When running without the integrity check, you may encounter cryptic failure messages, possibly accompanied by induced configuration cache problems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle --configuration-cache greet
...
* What went wrong:
Index 4 out of bounds for length 3</pre>
</div>
</div>
<div class="paragraph">
<p>These errors might not immediately point to the root cause, making debugging more challenging.
It might be really hard to connect an invalid index error to a serialization issue, for example.</p>
</div>
<div class="paragraph">
<p>Rerunning the build with the integrity check enabled provides a much more precise diagnostic, helping you pinpoint the source of the issue faster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle --configuration-cache -Dorg.gradle.configuration-cache.integrity-check=true greet
...
FAILURE: Build failed with an exception.

* What went wrong:
Configuration cache state could not be cached: field `user` of task `:greet` of type `GreetTask`: The value cannot be decoded properly with 'JavaObjectSerializationCodec'. It may have been written incorrectly or its data is corrupted.</pre>
</div>
</div>
<div class="paragraph">
<p>You can immediately see the name of the offending task and the field that contains the broken data.</p>
</div>
<div class="paragraph">
<p>Keep in mind that this attribution is best-effort: it should be accurate in most cases, but in rare instances, it may be confused by certain byte patterns.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>The integrity check relies on additional metadata stored within the cache. Therefore, it cannot be used to diagnose entries already corrupted prior to enabling the integrity check.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The current integrity checks primarily focus on identifying serialization protocol issues rather than general data corruption.
Consequently, they are less effective against hardware-related problems, such as bit rot or damaged storage sectors.
Due to these limitations and the performance overhead introduced by integrity checks, we recommend enabling them selectively as a troubleshooting measure rather than leaving them permanently enabled.</p>
</div>
</div>
<div class="sect3">
<h4 id="inspecting_cache_entries"><a class="anchor" href="#inspecting_cache_entries"></a><a class="link" href="#inspecting_cache_entries">Inspecting Cache Entries</a></h4>
<div class="paragraph">
<p>The <a href="https://github.com/gradle/gcc2speedscope"><code>gcc2speedscope</code> tool</a>, developed by Gradle, analyzes the space usage of the Gradle Configuration Cache by converting debug logs into interactive flamegraphs compatible with <a href="https://www.speedscope.app/">speedscope.app</a>.</p>
</div>
<div class="paragraph">
<p>This visualization helps identify large or unnecessary objects within the cache.</p>
</div>
</div>
<div class="sect3">
<h4 id="debugging_the_configuration_phase"><a class="anchor" href="#debugging_the_configuration_phase"></a><a class="link" href="#debugging_the_configuration_phase">Debugging the Configuration Phase</a></h4>
<div class="paragraph">
<p>The <a href="https://github.com/gradle/gradle-trace-converter"><code>gradle-trace-converter</code></a> is a command-line tool developed by Gradle to analyze and convert Build Operation traces into formats like Chrome&#8217;s Perfetto trace and CSV timelines.</p>
</div>
<div class="paragraph">
<p>This visualization depicts the steps taken during Gradle&#8217;s configuration phase.</p>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:testing"><a class="anchor" href="#config_cache:testing"></a><a class="link" href="#config_cache:testing">Test your Build Logic</a></h4>
<div class="paragraph">
<p>Gradle TestKit is a library designed to facilitate testing Gradle plugins and build logic.
For general guidance on using TestKit, refer to the <a href="#test_kit">dedicated chapter</a>.</p>
</div>
<div class="paragraph">
<p>To test your build logic with the Configuration Cache enabled, pass the <code>--configuration-cache</code> argument to <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testkit/runner/GradleRunner.html"><code>GradleRunner</code></a>, or use one of the other methods described in <a href="#config_cache:usage:enable">Enabling the Configuration Cache</a>.</p>
</div>
<div class="paragraph">
<p>To properly test Configuration Cache behavior, tasks must be executed twice:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">src/test/kotlin/org/example/BuildLogicFunctionalTest.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@Test
fun `my task can be loaded from the configuration cache`() {

    buildFile.writeText("""
        plugins {
            id 'org.example.my-plugin'
        }
    """)

    runner()
        .withArguments("--configuration-cache", "myTask")        // <b class="conum">(1)</b>
        .build()

    val result = runner()
        .withArguments("--configuration-cache", "myTask")        // <b class="conum">(2)</b>
        .build()

    require(result.output.contains("Reusing configuration cache.")) // <b class="conum">(3)</b>
    // ... more assertions on your task behavior
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">src/test/groovy/org/example/BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def "my task can be loaded from the configuration cache"() {
    given:
    buildFile &lt;&lt; """
        plugins {
            id 'org.example.my-plugin'
        }
    """

    when:
    runner()
        .withArguments('--configuration-cache', 'myTask')    // <b class="conum">(1)</b>
        .build()

    and:
    def result = runner()
        .withArguments('--configuration-cache', 'myTask')    // <b class="conum">(2)</b>
        .build()

    then:
    result.output.contains('Reusing configuration cache.')      // <b class="conum">(3)</b>
    // ... more assertions on your task behavior
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>First run primes the Configuration Cache.</p>
</li>
<li>
<p>Second run reuses the Configuration Cache.</p>
</li>
<li>
<p>Assert that the Configuration Cache gets reused.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If Gradle encounters problems with the Configuration Cache, it will fail the build and report the issues, causing the test to fail.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>A recommended approach for Gradle plugin authors is to run the entire test suite with the Configuration Cache enabled.
This ensures compatibility with a supported Gradle version.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If your plugin already supports multiple Gradle versions and has version-specific tests, enable Configuration Cache testing starting with the first supported version.</p>
</li>
<li>
<p>If immediate full support is not feasible, consider writing tests that:</p>
<div class="ulist">
<ul>
<li>
<p>Run all plugin-contributed tasks multiple times.</p>
</li>
<li>
<p>Assert expected task states, such as <code>UP_TO_DATE</code> and <code>FROM_CACHE</code> behavior.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config_cache_status"><a class="anchor" href="#config_cache_status"></a><a class="link" href="#config_cache_status">Configuration Cache Status</a></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is <em>not enabled by default</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="config_cache:plugins"><a class="anchor" href="#config_cache:plugins"></a><a class="link" href="#config_cache:plugins">Supported Plugins</a></h4>
<div class="paragraph">
<p>The Configuration Cache introduces new requirements for plugin implementations.
As a result, both Core Gradle plugins and Community Plugins need to be adjusted to ensure compatibility.</p>
</div>
<div class="paragraph">
<p>This section provides details on the current support in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#config_cache:plugins:core">Core Gradle Plugins</a></p>
</li>
<li>
<p><a href="#config_cache:plugins:community">Community Plugins</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="config_cache:plugins:core"><a class="anchor" href="#config_cache:plugins:core"></a><a class="link" href="#config_cache:plugins:core">Core Gradle Plugins</a></h5>
<div class="paragraph">
<p>Most <a href="#plugin_reference">Core Gradle Plugins</a> support configuration caching at this time:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">JVM languages and frameworks</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Native languages</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Packaging and distribution</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13457"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="java_plugin.html#java_plugin">Java</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13458"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#java_library_plugin">Java Library</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13459"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#java_platform_plugin">Java Platform</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13460"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#groovy_plugin">Groovy</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13461"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#scala_plugin">Scala</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13462"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="antlr_plugin.html#antlr_plugin">ANTLR</a></p>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/30806"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="cpp_application_plugin.html#cpp_application_plugin">C++ Application</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/30806"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="cpp_library_plugin.html#cpp_library_plugin">C++ Library</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13514"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="cpp_unit_test_plugin.html#cpp_unit_test_plugin">C++ Unit Test</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13515"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="swift_application_plugin.html#swift_application_plugin">Swift Application</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13487"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="swift_library_plugin.html#swift_library_plugin">Swift Library</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13488"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="xctest_plugin.html#xctest_plugin">XCTest</a></p>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13463"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#application_plugin">Application</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13466"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="war_plugin.html#war_plugin">WAR</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13467"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="ear_plugin.html#ear_plugin">EAR</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/24329"><span class="yellow">*</span></a>
</td>
<td class="hdlist2">
<p><a href="#publishing_maven">Maven Publish</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/24328"><span class="yellow">*</span></a>
</td>
<td class="hdlist2">
<p><a href="#publishing_ivy">Ivy Publish</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13464"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="distribution_plugin.html#distribution_plugin">Distribution</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13465"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="java_library_distribution_plugin.html#java_library_distribution_plugin">Java Library Distribution</a></p>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Code analysis</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">IDE project files generation</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Utility</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13475"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="checkstyle_plugin.html#checkstyle_plugin">Checkstyle</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13478"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="codenarc_plugin.html#codenarc_plugin">CodeNarc</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13477"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="jacoco_plugin.html#jacoco_plugin">JaCoCo</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<span class="green"></span>
</td>
<td class="hdlist2">
<p><a href="jacoco_report_aggregation_plugin.html#jacoco_report_aggregation_plugin">JaCoCo Report Aggregation</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13476"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="pmd_plugin.html#pmd_plugin">PMD</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<span class="green"></span>
</td>
<td class="hdlist2">
<p><a href="test_report_aggregation_plugin.html#test_report_aggregation_plugin">Test Report Aggregation</a></p>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13479"><span class="yellow"></span></a>
</td>
<td class="hdlist2">
<p><a href="eclipse_plugin.html#eclipse_plugin">Eclipse</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13480"><span class="yellow"></span></a>
</td>
<td class="hdlist2">
<p><a href="idea_plugin.html#idea_plugin">IntelliJ IDEA</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13482"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="visual_studio_plugin.html#visual_studio_plugin">Visual Studio</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13483"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="xcode_plugin.html#xcode_plugin">Xcode</a></p>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13455"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="base_plugin.html#base_plugin">Base</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13456"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="build_init_plugin.html#build_init_plugin">Build Init</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13470"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="signing_plugin.html#signing_plugin">Signing</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/24537"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="java_gradle_plugin.html#java_gradle_plugin">Java Plugin Development</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/23029"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#implemention_precompiled_plugins">Groovy DSL Plugin Development</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13472"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="#sec:kotlin-dsl_plugin">Kotlin DSL Plugin Development</a></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/gradle/gradle/issues/13473"><span class="green"></span></a>
</td>
<td class="hdlist2">
<p><a href="project_report_plugin.html#project_report_plugin">Project Report Plugin</a></p>
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<span class="green"></span>
</td>
<td class="hdlist2">
<p>Supported plugin</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<span class="yellow"></span>
</td>
<td class="hdlist2">
<p>Partially supported plugin (tasks always disable configuration caching)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<span class="yellow">*</span>
</td>
<td class="hdlist2">
<p>Partially supported plugin (some features may disable configuration caching)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:plugins:community"><a class="anchor" href="#config_cache:plugins:community"></a><a class="link" href="#config_cache:plugins:community">Community Plugins</a></h5>
<div class="paragraph">
<p>Please refer to issue <a href="https://github.com/gradle/gradle/issues/13490">gradle/gradle#13490</a> to learn about the status of Community Plugins.</p>
</div>
<div class="paragraph">
<p>The two most popular ecosystem plugins are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="green"></span> Android Gradle Plugin</p>
</li>
<li>
<p><span class="green"></span> Kotlin Gradle Plugin</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="config_cache:not_yet_implemented"><a class="anchor" href="#config_cache:not_yet_implemented"></a><a class="link" href="#config_cache:not_yet_implemented">Not Yet Implemented</a></h4>
<div class="paragraph">
<p>Support for configuration caching with certain Gradle features is not yet available. These features will be supported in future Gradle releases.</p>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:sharing"><a class="anchor" href="#config_cache:not_yet_implemented:sharing"></a><a class="link" href="#config_cache:not_yet_implemented:sharing">Sharing the Configuration Cache</a></h5>
<div class="paragraph">
<p>The Configuration Cache is currently stored locally only.
It can be reused by both hot and cold local Gradle daemons, but it cannot be shared between developers or CI machines.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/13510">gradle/gradle#13510</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:source_dependencies"><a class="anchor" href="#config_cache:not_yet_implemented:source_dependencies"></a><a class="link" href="#config_cache:not_yet_implemented:source_dependencies">Source Dependencies</a></h5>
<div class="paragraph">
<p>Support for <a href="https://blog.gradle.org/introducing-source-dependencies">source dependencies</a> is not yet implemented.
When using this feature, the build will not fail, and no problems will be reported, but the Configuration Cache will be automatically disabled.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/13506">gradle/gradle#13506</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:testkit_build_with_java_agent"><a class="anchor" href="#config_cache:not_yet_implemented:testkit_build_with_java_agent"></a><a class="link" href="#config_cache:not_yet_implemented:testkit_build_with_java_agent">Using a Java Agent with Builds run using TestKit</a></h5>
<div class="paragraph">
<p>When running builds using <a href="#test_kit">TestKit</a>, the Configuration Cache can interfere with Java agents, such as the Jacoco agent, that are applied to these builds.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/25979">gradle/gradle#25979</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:fine_grained_tracking_of_gradle_properties"><a class="anchor" href="#config_cache:not_yet_implemented:fine_grained_tracking_of_gradle_properties"></a><a class="link" href="#config_cache:not_yet_implemented:fine_grained_tracking_of_gradle_properties">Fine-grained Tracking of Gradle Properties as Build Configuration Inputs</a></h5>
<div class="paragraph">
<p>Currently, all external sources of Gradle propertiessuch as <code>gradle.properties</code> files (both in project directories and in the <code><a href="#dir:gradle_user_home">GRADLE_USER_HOME</a></code>), environment variables, system properties that set properties, and properties specified via command-line flagsare considered build configuration inputs, regardless of whether they are actually used during configuration.</p>
</div>
<div class="paragraph">
<p>However, these sources are not included in the Configuration Cache report.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/20969">gradle/gradle#20969</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:java_serialization"><a class="anchor" href="#config_cache:not_yet_implemented:java_serialization"></a><a class="link" href="#config_cache:not_yet_implemented:java_serialization">Java Object Serialization</a></h5>
<div class="paragraph">
<p>Gradle allows objects that support the <a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/serialTOC.html">Java Object Serialization</a> protocol to be stored in the Configuration Cache.</p>
</div>
<div class="paragraph">
<p>The implementation is currently limited to serializable classes that
either implement the <code>java.io.Externalizable</code> interface, or implement the <code>java.io.Serializable</code> interface and define one of the following combination of methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>writeObject</code> method combined with a <code>readObject</code> method to control exactly which information to store;</p>
</li>
<li>
<p>a <code>writeObject</code> method with no corresponding <code>readObject</code>; <code>writeObject</code> must eventually call <code>ObjectOutputStream.defaultWriteObject</code>;</p>
</li>
<li>
<p>a <code>readObject</code> method with no corresponding <code>writeObject</code>; <code>readObject</code> must eventually call <code>ObjectInputStream.defaultReadObject</code>;</p>
</li>
<li>
<p>a <code>writeReplace</code> method to allow the class to nominate a replacement to be written;</p>
</li>
<li>
<p>a <code>readResolve</code> method to allow the class to nominate a replacement for the object just read;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following <em>Java Object Serialization</em> features are <strong>not</strong> supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>serialPersistentFields</code> member to explicitly declare which fields are serializable; the member, if present, is ignored; the Configuration Cache considers all but <code>transient</code> fields serializable;</p>
</li>
<li>
<p>the following methods of <code>ObjectOutputStream</code> are not supported and will throw <code>UnsupportedOperationException</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>reset()</code>, <code>writeFields()</code>, <code>putFields()</code>, <code>writeChars(String)</code>, <code>writeBytes(String)</code> and <code>writeUnshared(Any?)</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>the following methods of <code>ObjectInputStream</code> are not supported and will throw <code>UnsupportedOperationException</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>readLine()</code>, <code>readFully(ByteArray)</code>, <code>readFully(ByteArray, Int, Int)</code>, <code>readUnshared()</code>, <code>readFields()</code>, <code>transferTo(OutputStream)</code> and <code>readAllBytes()</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>validations registered via <code>ObjectInputStream.registerValidation</code> are simply ignored;</p>
</li>
<li>
<p>the <code>readObjectNoData</code> method, if present, is never invoked;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/13588">gradle/gradle#13588</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:accessing_top_level_at_execution"><a class="anchor" href="#config_cache:not_yet_implemented:accessing_top_level_at_execution"></a><a class="link" href="#config_cache:not_yet_implemented:accessing_top_level_at_execution">Accessing top-level Methods and Variables of a Build Script at Execution Time</a></h5>
<div class="paragraph">
<p>A common approach to reuse logic and data in a build script is to extract repeating bits into top-level methods and variables.
However, calling such methods at execution time is not currently supported if the Configuration Cache is enabled.</p>
</div>
<div class="paragraph">
<p>For builds scripts written in Groovy, the task fails because the method cannot be found.
The following snippet uses a top-level method in the <code>listFiles</code> task:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def dir = file('data')

def listFiles(File dir) {
    dir.listFiles({ file -&gt; file.isFile() } as FileFilter).name.sort()
}

tasks.register('listFiles') {
    doLast {
        println listFiles(dir)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Running the task with the Configuration Cache enabled produces the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':listFiles'.
&gt; Could not find method listFiles() for arguments [/home/user/gradle/samples/data] on task ':listFiles' of type org.gradle.api.DefaultTask.</pre>
</div>
</div>
<div class="paragraph">
<p>To prevent the task from failing, convert the referenced top-level method to a static method within a class:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def dir = file('data')

class Files {
    static def listFiles(File dir) {
        dir.listFiles({ file -&gt; file.isFile() } as FileFilter).name.sort()
    }
}

tasks.register('listFilesFixed') {
    doLast {
        println Files.listFiles(dir)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Build scripts written in Kotlin cannot store tasks that reference top-level methods or variables at execution time in the Configuration Cache at all.
This limitation exists because the captured script object references cannot be serialized.
The first run of the Kotlin version of the <code>listFiles</code> task fails with the Configuration Cache problem.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val dir = file("data")

fun listFiles(dir: File): List&lt;String&gt; =
    dir.listFiles { file: File -&gt; file.isFile }.map { it.name }.sorted()

tasks.register("listFiles") {
    doLast {
        println(listFiles(dir))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To make the Kotlin version of this task compatible with the Configuration Cache, make the following changes:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">object Files { // <b class="conum">(1)</b>
    fun listFiles(dir: File): List&lt;String&gt; =
        dir.listFiles { file: File -&gt; file.isFile }.map { it.name }.sorted()
}

tasks.register("listFilesFixed") {
    val dir = file("data") // <b class="conum">(2)</b>
    doLast {
        println(Files.listFiles(dir))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Define the method inside an object.</p>
</li>
<li>
<p>Define the variable in a smaller scope.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/22879">gradle/gradle#22879</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:build_services_in_fingerprint"><a class="anchor" href="#config_cache:not_yet_implemented:build_services_in_fingerprint"></a><a class="link" href="#config_cache:not_yet_implemented:build_services_in_fingerprint">Using Build Services to Invalidate the Configuration Cache</a></h5>
<div class="paragraph">
<p>Currently, it is impossible to use a provider of <code>BuildService</code> or provider derived from it with <code>map</code> or <code>flatMap</code> as a parameter for the <code>ValueSource</code>, if the value of the <code>ValueSource</code> is accessed at configuration time.
The same applies when such a <code>ValueSource</code> is obtained in a task that executes as part of the configuration phase, for example tasks of the <code>buildSrc</code> build or included builds contributing plugins.</p>
</div>
<div class="paragraph">
<p>Note that using a <code>@ServiceReference</code> or storing <code>BuildService</code> in an <code>@Internal</code>-annotated property of a task is safe.</p>
</div>
<div class="paragraph">
<p>Generally speaking, this limitation makes it impossible to use a <code>BuildService</code> to invalidate the Configuration Cache.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/24085">gradle/gradle#24085</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="config_cache:not_yet_implemented:more_build_event_listeners"><a class="anchor" href="#config_cache:not_yet_implemented:more_build_event_listeners"></a><a class="link" href="#config_cache:not_yet_implemented:more_build_event_listeners">Using Arbitrary Providers as Build Events Listeners</a></h5>
<div class="paragraph">
<p>The build event listener registration method <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/build/event/BuildEventsListenerRegistry.html#onTaskCompletion(org.gradle.api.provider.Provider)"><code>BuildEventsListenerRegistry.onTaskCompletion</code></a>
accepts arbitrary providers of any <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/events/OperationCompletionListener.html"><code>OperationCompletionListener</code></a> implementations.
However, only providers returned from <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceRegistry.html#registerIfAbsent(java.lang.String,java.lang.Class,org.gradle.api.Action)"><code>BuildServiceRegistry.registerIfAbsent</code></a> or <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/services/BuildServiceRegistration.html#getService()"><code>BuildServiceRegistration.getService</code></a> are currently supported when the Configuration Cache is used.
Starting with Gradle 9, using other kinds of providers (including even <code>registerIfAbsent(&#8230;&#8203;).map { it }</code>) results in a Configuration Cache problem being emitted.
Prior to that, such providers were silently ignored.</p>
</div>
<div class="paragraph">
<p>Check the <a href="#config_cache:adoption:changes_in_behavior">adoption guide</a> to learn how to <em>temporarily</em> suppress these problems if discarded listeners do not affect your
build.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gradle/gradle/issues/33772">gradle/gradle#33772</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:dependency_management"><a class="anchor" href="#part:dependency_management"></a><a class="link" href="#part:dependency_management">DECLARING DEPENDENCIES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="declaring-dependencies-basics"><a class="anchor" href="#declaring-dependencies-basics"></a><a class="link" href="#declaring-dependencies-basics">Declaring Dependencies Basics</a></h3>
<div class="sect3">
<h4 id="sec:dependency-types"><a class="anchor" href="#sec:dependency-types"></a><a class="link" href="#sec:dependency-types">Types of dependencies</a></h4>
<div class="paragraph">
<p>There are three main types of dependencies in Gradle:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Module Dependencies</strong>: Refer to libraries from external repositories.</p>
</li>
<li>
<p><strong>Project Dependencies</strong>: Refer to other projects in the same multi-project build.</p>
</li>
<li>
<p><strong>File Dependencies</strong>: Refer to local files or directories, such as <code>.jar</code> or <code>.aar</code> files.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="sec:module-dependencies"><a class="anchor" href="#sec:module-dependencies"></a><a class="link" href="#sec:module-dependencies">1. Module dependencies</a></h5>
<div class="paragraph">
<p>Module dependencies are the most common dependencies.
They refer to a dependency that is identified by module coordinates (group, name, and version).</p>
</div>
<div class="paragraph">
<p>Module dependencies are declared using the single-string notation, where the group, name, and version are joined into a single string:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    runtimeOnly("org.springframework:spring-aop:2.5")
    runtimeOnly("org.hibernate:hibernate:3.0.5") {
        isTransitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    runtimeOnly("org.springframework:spring-core:2.5")
    runtimeOnly("org.springframework:spring-core:2.5",
                "org.springframework:spring-aop:2.5")
    runtimeOnly("org.hibernate:hibernate:3.0.5") {
        transitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle also supports the multi-string notation, where each coordinate may be declared separately:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    runtimeOnly("org.springframework:spring-core:2.5")
    runtimeOnly("org.hibernate:hibernate:3.0.5") {
        isTransitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    runtimeOnly group: 'org.springframework', name: 'spring-core', version: '2.5'
    runtimeOnly(
        [group: 'org.springframework', name: 'spring-core', version: '2.5'],
        [group: 'org.springframework', name: 'spring-aop', version: '2.5']
    )
    runtimeOnly group: 'org.hibernate', name: 'hibernate', version: '3.0.5', transitive: true
    runtimeOnly(group: 'org.hibernate', name: 'hibernate', version: '3.0.5') {
        transitive = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The multi-string notation for module dependencies has been deprecated and will not be supported starting in Gradle 10. Use the single-string notation instead.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Module dependencies use the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html"><code>ExternalModuleDependency</code></a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html"><code>DependencyHandler</code></a> APIs.
These APIs provide various properties and configuration methods for defining dependencies.</p>
</div>
<div class="paragraph">
<p>For advanced configurations, such as enforcing strict versions, you can also provide a closure when alongside these notations.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:project-dependencies"><a class="anchor" href="#sec:project-dependencies"></a><a class="link" href="#sec:project-dependencies">2. Project dependencies</a></h5>
<div class="paragraph">
<p>Project dependencies allow you to reference other projects within a multi-project Gradle build.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-project-dependencies.png" alt="dependency management project dependencies">
</div>
</div>
<div class="paragraph">
<p>This is useful for organizing large projects into smaller, modular components:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">web-service/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(project(":utils"))
    implementation(project(":api"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">web-service/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation project(':utils')
    implementation project(':api')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle uses the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:project(java.lang.String)"><code>project()</code></a> function to define a project dependency.
This function takes the relative path to the target project within the build.
The path is typically defined using a colon (<code>:</code>) to separate different levels of the project structure.</p>
</div>
<div class="paragraph">
<p>Project dependencies are automatically resolved such that the dependent project is always built before the project that depends on it.</p>
</div>
<div class="sect5">
<h6 id="sec:type-safe-project-accessors"><a class="anchor" href="#sec:type-safe-project-accessors"></a><a class="link" href="#sec:type-safe-project-accessors">Type-safe project dependencies</a></h6>
<div class="paragraph">
<p>Type-safe project accessors are an incubating feature which must be enabled explicitly.
Implementation may change at any time.</p>
</div>
<div class="paragraph">
<p>To add support for type-safe project accessors, add <code>enableFeaturePreview("TYPESAFE_PROJECT_ACCESSORS")</code> this to your <code>settings.gradle(.kts)</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">enableFeaturePreview("TYPESAFE_PROJECT_ACCESSORS")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">enableFeaturePreview 'TYPESAFE_PROJECT_ACCESSORS'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>One downside of using the <code>project(":some:path")</code> notation is the need to remember project paths for dependencies.
Moreover, changing a project path requires manually updating every occurrence, increasing the risk of missing one.</p>
</div>
<div class="paragraph">
<p>Instead, the experimental type-safe project accessors API provides IDE completion, making it easier to declare dependencies:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">web-service/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(projects.utils)
    implementation(projects.api)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">web-service/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation projects.utils
    implementation projects.api
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this API, incorrectly specified projects in Kotlin DSL scripts trigger compilation errors, helping you avoid missed updates.</p>
</div>
<div class="paragraph">
<p>Project accessors are based on project paths.
For instance, the path <code>:commons:utils:some:lib</code> becomes <code>projects.commons.utils.some.lib</code>, while kebab-case (<code>some-lib</code>) and snake-case (<code>some_lib</code>) are converted to camel case: <code>projects.someLib</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:file-dependencies"><a class="anchor" href="#sec:file-dependencies"></a><a class="link" href="#sec:file-dependencies">3. File dependencies</a></h5>
<div class="paragraph">
<p>File dependencies allow you to include external JARs or other files directly into your project by referencing their file paths.
File dependencies also allow you to add a set of files directly to a configuration without using a repository.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
File dependencies are generally discouraged.
Instead, prefer declaring dependencies on an external repository, or if necessary, declaring a maven or ivy repository using a <code>file://</code> URL.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-file-dependencies.png" alt="dependency management file dependencies">
</div>
</div>
<div class="paragraph">
<p>File dependencies are unique because they represent a direct reference to files on the filesystem without any associated <a href="glossary.html#sub:terminology_module_metadata">metadata</a>, such as transitive dependencies, origin, or author information.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("antContrib")
    create("externalLibs")
    create("deploymentTools")
}

dependencies {
    "antContrib"(files("ant/antcontrib.jar"))
    "externalLibs"(files("libs/commons-lang.jar", "libs/log4j.jar"))
    "deploymentTools"(fileTree("tools") { include("*.exe") })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    antContrib
    externalLibs
    deploymentTools
}

dependencies {
    antContrib files('ant/antcontrib.jar')
    externalLibs files('libs/commons-lang.jar', 'libs/log4j.jar')
    deploymentTools(fileTree('tools') { include '*.exe' })
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, each dependency explicitly specifies its location within the file system.
Common methods for referencing these files include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link:<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])"><code>Project.files()</code></a>: Accepts one or more file paths directly.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-"><code>ProjectLayout.files()</code></a>: Accepts one or more file paths directly.</p>
</li>
<li>
<p><a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)"><code>Project.fileTree()</code></a>: Defines a directory and includes or excludes specific file patterns.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The order of files in a <code>FileTree</code> is not guaranteed to be stable, even on the same computer.
As a result, dependency configurations using <code>FileTree</code> may produce resolution results with varying order, which can impact the cacheability of tasks that use these results as inputs.
To ensure more predictable and stable behavior, it is recommended to use the simpler <code>files</code> method where possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can use a <a href="#sec:flat-dir-resolver">flat directory</a> repository to specify the source directory for multiple file dependencies.</p>
</div>
<div class="paragraph">
<p>Ideally, you should use Maven or Ivy repository with a local URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = 'file:///path/to/local/files' // Replace with your actual path
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add files as dependencies, pass a <a href="#sec:file_collections">file collection</a> to the configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    runtimeOnly(files("libs/a.jar", "libs/b.jar"))
    runtimeOnly(fileTree("libs") { include("*.jar") })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    runtimeOnly files('libs/a.jar', 'libs/b.jar')
    runtimeOnly fileTree('libs') { include '*.jar' }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that file dependencies are not included in the published dependency descriptor for your project.
However, they are available in transitive dependencies within the same build, meaning they can be used within the current build but not outside it.</p>
</div>
<div class="paragraph">
<p>You should specify which tasks produce the files for a file dependency.
Otherwise, the necessary tasks might not run when you depend on them transitively from another project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(files(layout.buildDirectory.dir("classes")) {
        builtBy("compile")
    })
}

tasks.register("compile") {
    doLast {
        println("compiling classes")
    }
}

tasks.register("list") {
    val compileClasspath: FileCollection = configurations["compileClasspath"]
    dependsOn(compileClasspath)
    doLast {
        println("classpath = ${compileClasspath.map { file: File -&gt; file.name }}")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation files(layout.buildDirectory.dir('classes')) {
        builtBy 'compile'
    }
}

tasks.register('compile') {
    doLast {
        println 'compiling classes'
    }
}

tasks.register('list') {
    FileCollection compileClasspath = configurations.compileClasspath
    dependsOn compileClasspath
    doLast {
        println "classpath = ${compileClasspath.collect { File file -&gt; file.name }}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q list
compiling classes
classpath = [classes]</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle-distribution-dependencies"><a class="anchor" href="#sec:gradle-distribution-dependencies"></a><a class="link" href="#sec:gradle-distribution-dependencies">Gradle distribution-specific dependencies</a></h4>
<div class="sect4">
<h5 id="sec:api-dependencies"><a class="anchor" href="#sec:api-dependencies"></a><a class="link" href="#sec:api-dependencies">Gradle API dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the API of the current version of Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleApi()">DependencyHandler.gradleApi()</a> method.
This is useful when you are developing custom Gradle tasks or plugins:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(gradleApi())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation gradleApi()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:testkit-dependencies"><a class="anchor" href="#sec:testkit-dependencies"></a><a class="link" href="#sec:testkit-dependencies">Gradle TestKit dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the TestKit API of the current version of Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleTestKit()">DependencyHandler.gradleTestKit()</a> method.
This is useful for writing and executing functional tests for Gradle plugins and build scripts:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation(gradleTestKit())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation gradleTestKit()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:groovy-dependencies"><a class="anchor" href="#sec:groovy-dependencies"></a><a class="link" href="#sec:groovy-dependencies">Local Groovy dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the Groovy that is distributed with Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:localGroovy()">DependencyHandler.localGroovy()</a> method.
This is useful when you are developing custom Gradle tasks or plugins in Groovy:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(localGroovy())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation localGroovy()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:documenting-dependencies"><a class="anchor" href="#sec:documenting-dependencies"></a><a class="link" href="#sec:documenting-dependencies">Documenting dependencies</a></h4>
<div class="paragraph">
<p>When declaring a dependency or a <a href="#dependency-constraints">dependency constraint</a>, you can provide a reason to clarify why the dependency is included.
This helps make your build script and the <a href="#sec:identifying-reason-dependency-selection">dependency insight report</a> easier to interpret:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.ow2.asm:asm:7.1") {
        because("we require a JDK 9 compatible bytecode generator")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation('org.ow2.asm:asm:7.1') {
        because 'we require a JDK 9 compatible bytecode generator'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/DependencyConstraint.html#because(java.lang.String)"><code>because()</code></a> method provides a reason for including the <code>asm</code> library, which helps explain its purpose in the context of the build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q dependencyInsight --dependency asm
org.ow2.asm:asm:7.1
  Variant compile:
    | Attribute Name                 | Provided | Requested    |
    |--------------------------------|----------|--------------|
    | org.gradle.status              | release  |              |
    | org.gradle.category            | library  | library      |
    | org.gradle.libraryelements     | jar      | classes      |
    | org.gradle.usage               | java-api | java-api     |
    | org.gradle.dependency.bundling |          | external     |
    | org.gradle.jvm.environment     |          | standard-jvm |
    | org.gradle.jvm.version         |          | 11           |
   Selection reasons:
      - Was requested: we require a JDK 9 compatible bytecode generator

org.ow2.asm:asm:7.1
\--- compileClasspath

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="viewing-debugging-dependencies"><a class="anchor" href="#viewing-debugging-dependencies"></a><a class="link" href="#viewing-debugging-dependencies">Viewing Dependencies</a></h3>
<div class="paragraph">
<p>Gradle offers tools to navigate the results of dependency management, allowing you to more precisely understand how and why Gradle resolves dependencies.
You can render a full dependency graph, identify the origin of a given dependency, and see why specific versions were selected.
Dependencies can come from build script declarations or transitive relationships.</p>
</div>
<div id="sec:debugging-build-scans" class="paragraph">
<p>To visualize dependencies, you can use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>dependencies</code> task</p>
</li>
<li>
<p>The <code>dependencyInsight</code> task</p>
</li>
<li>
<p>A <a href="https://scans.gradle.com/">Build Scan</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec:listing-dependencies"><a class="anchor" href="#sec:listing-dependencies"></a><a class="link" href="#sec:listing-dependencies">List project dependencies using the <code>dependencies</code> task</a></h4>
<div class="paragraph">
<p>Gradle provides the built-in <code>dependencies</code> task to render a dependency tree from the command line.
By default, the task shows dependencies for all <a href="dependency_configurations.html#sub:what-are-dependency-configurations">configurations</a> within a <a href="#executing_tasks_in_multi_project_builds">single project</a>.
The dependency tree shows the selected version of each dependency and provides information on conflict resolution.</p>
</div>
<div class="paragraph">
<p>The <code>dependencies</code> task is particularly useful for analyzing transitive dependencies.
While your build file lists direct dependencies, the task helps you understand which transitive dependencies are resolved during the build.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew dependencies</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To render the graph of dependencies declared in the <code>buildscript</code> <code>classpath</code> configuration, use the <a href="#sec:listing_project_dependencies"><code>buildEnvironment</code> task</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="understanding_output_annotations"><a class="anchor" href="#understanding_output_annotations"></a><a class="link" href="#understanding_output_annotations">Understanding output annotations</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:dependencies

&gt; Task :app:dependencies

------------------------------------------------------------
Project ':app'
------------------------------------------------------------

annotationProcessor - Annotation processors and their dependencies for source set 'main'.
No dependencies

compileClasspath - Compile classpath for source set 'main'.
\--- com.fasterxml.jackson.core:jackson-databind:2.17.2
     +--- com.fasterxml.jackson.core:jackson-annotations:2.17.2
     |    \--- com.fasterxml.jackson:jackson-bom:2.17.2
     |         +--- com.fasterxml.jackson.core:jackson-annotations:2.17.2 (c)
     |         +--- com.fasterxml.jackson.core:jackson-core:2.17.2 (c)
     |         \--- com.fasterxml.jackson.core:jackson-databind:2.17.2 (c)
     +--- com.fasterxml.jackson.core:jackson-core:2.17.2
     |    \--- com.fasterxml.jackson:jackson-bom:2.17.2 (*)
     \--- com.fasterxml.jackson:jackson-bom:2.17.2 (*)

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>dependencies</code> task marks dependency trees with the following annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(*)</code>: Indicates repeated occurrences of a transitive dependency subtree. Gradle expands transitive dependency subtrees only once per project; repeat occurrences only display the root of the subtree, followed by this annotation.</p>
</li>
<li>
<p><code>(c)</code>: This element is a <a href="#dependency-constraints">dependency constraint</a>, not a dependency. Look for the matching dependency elsewhere in the tree.</p>
</li>
<li>
<p><code>(n)</code>: A dependency or dependency configuration that <a href="#sec:resolvable-consumable-configs">cannot be resolved</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="specifying_a_dependency_configuration"><a class="anchor" href="#specifying_a_dependency_configuration"></a><a class="link" href="#specifying_a_dependency_configuration">Specifying a dependency configuration</a></h5>
<div class="paragraph">
<p>To focus on a specific dependency configuration, use the optional <code>--configuration</code> parameter.</p>
</div>
<div class="paragraph">
<p>Like <a href="#sec:name_abbreviation">project and task names</a>, Gradle allows abbreviated names for dependency configurations.
For example, you can use <code>tRC</code> instead of <code>testRuntimeClasspath</code>, as long as it matches a unique configuration.</p>
</div>
<div class="paragraph">
<p>The following examples display dependencies for the <code>testRuntimeClasspath</code> configuration in a Java project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle -q dependencies --configuration testRuntimeClasspath</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gradle -q dependencies --configuration tRC</code></pre>
</div>
</div>
<div class="paragraph">
<p>To view a list of all configurations in a project, including those provided by plugins, run the <code>resolvableConfigurations</code> report.
For more details, refer to the plugins documentation, such as the Java Plugin <a href="java_plugin.html#sec:java_plugin_and_dependency_management">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="looking_at_an_example"><a class="anchor" href="#looking_at_an_example"></a><a class="link" href="#looking_at_an_example">Looking at an example</a></h5>
<div class="paragraph">
<p>Consider a project that uses the <a href="https://www.eclipse.org/jgit/">JGit library</a> to execute Source Control Management (SCM) operations for a release process.
You can declare dependencies for external tooling with the help of a <a href="dependency_configurations.html#sub:what-are-dependency-configurations">custom dependency configuration</a>.
This avoids polluting other contexts, such as the compilation classpath for your production source code.</p>
</div>
<div class="paragraph">
<p>The following example declares a custom dependency configuration named <code>scm</code> that contains the JGit dependency:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("scm")
}

dependencies {
    "scm"("org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    scm
}

dependencies {
    scm 'org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Use the following command to view a dependency tree for the <code>scm</code> dependency configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q dependencies --configuration scm

------------------------------------------------------------
Root project 'dependencies-report'
------------------------------------------------------------

scm
\--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
     +--- com.jcraft:jsch:0.1.54
     +--- com.googlecode.javaewah:JavaEWAH:1.1.6
     +--- org.apache.httpcomponents:httpclient:4.3.6
     |    +--- org.apache.httpcomponents:httpcore:4.3.3
     |    +--- commons-logging:commons-logging:1.1.3
     |    \--- commons-codec:commons-codec:1.6
     \--- org.slf4j:slf4j-api:1.7.2

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:identifying-reason-dependency-selection"><a class="anchor" href="#sec:identifying-reason-dependency-selection"></a><a class="link" href="#sec:identifying-reason-dependency-selection">Identify the selected version using the <code>dependencyInsight</code> task</a></h4>
<div class="paragraph">
<p>A project may request two different versions of the same dependency either directly or transitively that may result in a <a href="graph_resolution.html#sec:version-conflict">version conflict</a>.</p>
</div>
<div class="paragraph">
<p>The following example introduces a conflict with <code>commons-codec:commons-codec</code>, added both as a direct dependency and a transitive dependency of JGit:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

configurations {
    create("scm")
}

dependencies {
    "scm"("org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r")
    "scm"("commons-codec:commons-codec:1.7")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

configurations {
    scm
}

dependencies {
    scm 'org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r'
    scm 'commons-codec:commons-codec:1.7'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle provides the built-in <code>dependencyInsight</code> task to render a  <em>dependency insight report</em> from the command line.</p>
</div>
<div class="paragraph">
<p>Dependency insights provide information about a single dependency within a single <a href="dependency_configurations.html#sub:what-are-dependency-configurations">configuration</a>.
Given a dependency, you can identify the reason and origin for its version selection.</p>
</div>
<div class="paragraph">
<p><code>dependencyInsight</code> accepts the following parameters:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--dependency &lt;dependency&gt;</code> (mandatory)</dt>
<dd>
<p>The dependency to investigate.
You can supply a complete <code>group:name</code>, or part of it.
If multiple dependencies match, Gradle generates a report covering all matching dependencies.</p>
</dd>
<dt class="hdlist1"><code>--configuration &lt;name&gt;</code> (mandatory)</dt>
<dd>
<p>The dependency configuration which resolves the given dependency.
This parameter is optional for projects that use the <a href="java_plugin.html#java_plugin">Java plugin</a>, since the plugin provides a default value of <code>compileClasspath</code>.</p>
</dd>
<dt class="hdlist1"><code>--single-path</code> (optional)</dt>
<dd>
<p>Render only a single path to the dependency.</p>
</dd>
<dt class="hdlist1"><code>--all-variants</code> (optional)</dt>
<dd>
<p>Render information about all variants, not only the selected variant.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following code snippet demonstrates how to run a dependency insight report for all paths to a dependency named <code>commons-codec</code> within the <code>scm</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle -q dependencyInsight --dependency commons-codec --configuration scm
commons-codec:commons-codec:1.7
  Variant default:
    | Attribute Name    | Provided | Requested |
    |-------------------|----------|-----------|
    | org.gradle.status | release  |           |
   Selection reasons:
      - By conflict resolution: between versions 1.7 and 1.6

commons-codec:commons-codec:1.7
\--- scm

commons-codec:commons-codec:1.6 -&gt; 1.7
\--- org.apache.httpcomponents:httpclient:4.3.6
     \--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
          \--- scm

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
<div class="sect4">
<h5 id="understanding_the_selection_reasons"><a class="anchor" href="#understanding_the_selection_reasons"></a><a class="link" href="#understanding_the_selection_reasons">Understanding the selection reasons</a></h5>
<div class="paragraph">
<p>The "Selection reasons" section of the dependency insight report lists the reasons why a dependency was selected.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Reason</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Absent)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No reason other than a reference, direct or transitive, was present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Was requested : &lt;text&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The dependency appears in the graph, and the inclusion came with a <a href="#sec:documenting-dependencies"><code>because</code> text</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Was requested : didn&#8217;t match versions &lt;versions&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The dependency appears with a <a href="#sec:declaring-dependency-with-dynamic-version">dynamic version</a> which did not include the listed versions.
May be followed by a <code>because</code> text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Was requested : reject version &lt;versions&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The dependency appears with a <a href="#sec:rich-version-constraints">rich version</a> containing one or more <code>reject</code>.
May be followed by a <code>because</code> text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">By conflict resolution : between versions &lt;version&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The dependency appeared multiple times, with different version requests.
This resulted in <a href="graph_resolution.html#sec:version-conflict">conflict resolution</a> to select the most appropriate version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">By constraint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="#sec:adding-constraints-transitive-deps">dependency constraint</a> participated in the version selection.
May be followed by a <code>because</code> text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">By ancestor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There is a <a href="#sec:rich-version-constraints">rich version</a> with a <code>strictly</code> which enforces the version of this dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selected by rule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="#using-resolution-rules">dependency resolution rule</a> overruled the default selection process.
May be followed by a <code>because</code> text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rejection : &lt;version&gt; by rule because &lt;text&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>ComponentSelection.reject</code> <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ComponentSelection.html#org.gradle.api.artifacts.ComponentSelection:reject(java.lang.String)">rejected the given version</a> of the dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rejection: version &lt;version&gt;: &lt;attributes information&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The dependency has a dynamic version and some versions did not match the <a href="variant_aware_resolution.html#sec:variant-aware-matching">requested attributes</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forced</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The build enforces the version of the dependency through an enforced platform or resolution strategy.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If multiple selection reasons exist, the insight report lists all of them.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependencies-build-scans"><a class="anchor" href="#sec:dependencies-build-scans"></a><a class="link" href="#sec:dependencies-build-scans">Get a holistic view using Build Scan</a></h4>
<div class="paragraph">
<p>The dependency tree in a <a href="https://scans.gradle.com/">Build Scan</a> shows information about conflicts.</p>
</div>
<div class="paragraph">
<p>A <a href="build_scans.html#build_scans">Build Scan was created</a> for the <code>commons-codec</code> example above and a URL was provided with the results.</p>
</div>
<div class="paragraph">
<p>Head over to the <code>Dependencies</code> tab and navigate to your desired dependency.
Select the <code>Required By</code> tab to see the selection reason and origin of the dependency:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependency-insight-report-build-scan.png" alt="dependency management dependency insight report build scan">
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:resolving-unsafe-configuration-resolution-errors"><a class="anchor" href="#sub:resolving-unsafe-configuration-resolution-errors"></a><a class="link" href="#sub:resolving-unsafe-configuration-resolution-errors">Resolving unsafe configuration resolution errors</a></h4>
<div class="paragraph">
<p>Resolving a configuration can have side effects on Gradle&#8217;s project model, so Gradle needs manage access to each project&#8217;s configurations.
There are a number of ways a configuration might be resolved unsafely.
Gradle will produce a deprecation warning for each unsafe access.
Each of these are bad practices and can cause strange and indeterminate errors.</p>
</div>
<div class="paragraph">
<p>If your build has an unsafe access deprecation warning, it needs to be fixed.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A task from one project directly resolves a configuration in another project in the task&#8217;s action.</p>
</li>
<li>
<p>A task specifies a configuration from another project as an input file collection.</p>
</li>
<li>
<p>A build script for one project resolves a configuration in another project during evaluation.</p>
</li>
<li>
<p>Project configurations are resolved in the settings file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, this issue can be resolved by creating a cross-project dependency on the other project.
See the how-to guide for <a href="how_to_share_outputs_between_projects.html#variant-aware-sharing">sharing outputs between projects</a> for more information.</p>
</div>
<div class="paragraph">
<p>If you find a use case that can&#8217;t be resolved using these techniques, please let us know by filing a <a href="https://github.com/gradle/gradle/issues">GitHub Issue</a> adhering to our issue guidelines.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="declaring-versions-ranges"><a class="anchor" href="#declaring-versions-ranges"></a><a class="link" href="#declaring-versions-ranges">Declaring Versions and Ranges</a></h3>
<div class="paragraph">
<p>You can specify dependencies with exact versions or version ranges to define which versions your project can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.springframework:spring-core:5.3.8")
    implementation("org.springframework:spring-core:5.3.+")
    implementation("org.springframework:spring-core:latest.release")
    implementation("org.springframework:spring-core:[5.2.0, 5.3.8]")
    implementation("org.springframework:spring-core:[5.2.0,)")
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="sec:single-version-declarations"><a class="anchor" href="#sec:single-version-declarations"></a><a class="link" href="#sec:single-version-declarations">Understanding version declaration</a></h4>
<div class="paragraph">
<p>Gradle supports various ways to declare <strong>versions and ranges</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exact version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3</code>, <code>1.3.0-beta3</code>, <code>1.0-20150201.131010-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A specific version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven-style range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[1.0,)</code>, <code>[1.1, 2.0)</code>, <code>(1.2, 1.5]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[</code> <code>]</code> indicates inclusive bounds; <code>(</code> <code>)</code> indicates exclusive bounds. See <a href="#sec:maven-style-range">below to learn more</a>.</p>
<p class="tableblock">When the upper or lower bound is missing, the range has no upper or lower bound.</p>
<p class="tableblock">An upper bound exclude acts as a prefix exclude.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Prefix</em> version range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.+</code>, <code>1.3.+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only versions exactly matching the portion before the <code>+</code> are included.</p>
<p class="tableblock">Declaring a version as <code>+</code>, without any prefix, will include any version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest-status</code> version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest.integration</code>, <code>latest.release</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Matches the highest version with the specified status. See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadata.html#getStatus--">ComponentMetadata.getStatus()</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven <code>SNAPSHOT</code> version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.0-SNAPSHOT</code>, <code>1.4.9-beta1-SNAPSHOT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a snapshot version.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="sec:maven-style-range"><a class="anchor" href="#sec:maven-style-range"></a><a class="link" href="#sec:maven-style-range">Maven-style range</a></h5>
<div class="paragraph">
<p>There are a number of options to indicate bounds in the Maven-style:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[</code> and <code>]</code> indicate an inclusive bound &#8594; <code>[1.1, 2.0]</code></p>
</li>
<li>
<p><code>(</code> and <code>)</code> indicate an exclusive bound &#8594; <code>(1.1, 2.0)</code> or <code>(1.2, 1.5]</code> or <code>[1.1, 2.0)</code></p>
</li>
<li>
<p><code>]</code> can be used instead of <code>(</code> for an exclusive lower bound &#8594; <code>]1.2, 1.5]</code> instead of <code>(1.2, 1.5]</code></p>
</li>
<li>
<p><code>[</code> can be used instead of <code>)</code> for exclusive upper bound &#8594; <code>[1.1, 2.0[</code> instead of <code>[1.1, 2.0)</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:version-ordering"><a class="anchor" href="#sec:version-ordering"></a><a class="link" href="#sec:version-ordering">Understanding version ordering</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.springframework:spring-core:1.1") // This is a newer version than 1.a
    implementation("org.springframework:spring-core:1.a") // This is a older version than 1.1
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Version ordering is used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine if a particular <strong>version is included in a range</strong>.</p>
</li>
<li>
<p>Determine which <strong>version is newest</strong> when performing conflict resolution (using
<a href="graph_resolution.html#sec:base-version-comparison">"base versions"</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Versions are ordered based on the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Splitting Versions into Parts:</strong></p>
<div class="ulist">
<ul>
<li>
<p>Versions are divided into parts using the characters <code>[. - _ +]</code>.</p>
</li>
<li>
<p>Parts containing both digits and letters are split further, e.g., <code>1a1</code> becomes <code>1.a.1</code>.</p>
</li>
<li>
<p>Only the parts are compared, not the separators, so <code>1.a.1</code>, <code>1-a+1</code>, <code>1.a-1</code>, and <code>1a1</code> are equivalent. (Note: There are <a href="graph_resolution.html#sec:base-version-comparison">exceptions</a> during conflict resolution).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Comparing Equivalent Parts:</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Numeric vs. Numeric:</strong> Higher numeric value is considered higher: <code>1.1 &lt; 1.2</code>.</p>
</li>
<li>
<p><strong>Numeric vs. Non-numeric:</strong> Numeric parts are higher than non-numeric parts: <code>1.a &lt; 1.1</code>.</p>
</li>
<li>
<p><strong>Non-numeric vs. Non-numeric:</strong> Parts are compared alphabetically and case-sensitively: <code>1.A &lt; 1.B &lt; 1.a &lt; 1.b</code>.</p>
</li>
<li>
<p><strong>Extra Numeric Part:</strong> A version with an additional numeric part is higher, even if it&#8217;s zero: <code>1.1 &lt; 1.1.0</code>.</p>
</li>
<li>
<p><strong>Extra Non-numeric Part:</strong> A version with an extra non-numeric part is lower: <code>1.1.a &lt; 1.1</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Special Non-numeric Parts:</strong></p>
<div class="ulist">
<ul>
<li>
<p><code>dev</code> is <strong>lower</strong> than any other non-numeric part: <code>1.0-dev &lt; 1.0-ALPHA &lt; 1.0-alpha &lt; 1.0-rc</code>.</p>
</li>
<li>
<p><code>rc</code>, <code>snapshot</code>, <code>final</code>, <code>ga</code>, <code>release</code>, and <code>sp</code> are <strong>higher</strong> than any other string part, in this order: <code>1.0-zeta &lt; 1.0-rc &lt; 1.0-snapshot &lt; 1.0-final &lt; 1.0-ga &lt; 1.0-release &lt; 1.0-sp</code>.</p>
</li>
<li>
<p>These special values are <strong>not case-sensitive</strong> and their ordering does not depend on the separator used: <code>1.0-RC-1</code> == <code>1.0.rc.1</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:rich-version-constraints"><a class="anchor" href="#sec:rich-version-constraints"></a><a class="link" href="#sec:rich-version-constraints">Declaring rich versions</a></h4>
<div class="paragraph">
<p>When you declare a version using the shorthand notation, then the version is considered a <a href="#sec:required-version">required version</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.slf4j:slf4j-api:1.7.15")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('org.slf4j:slf4j-api:1.7.15')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This means the minimum version will be <code>1.7.15</code> and it can be optimistically upgraded by the engine.</p>
</div>
<div class="paragraph">
<p>To enforce a <a href="#sec:strict-version">strict version</a> and ensure that only the specified version of a dependency is used, rejecting any other versions even if they would normally be compatible:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.slf4j:slf4j-api") {
        version {
            strictly("[1.7, 1.8[")
            prefer("1.7.25")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('org.slf4j:slf4j-api') {
        version {
            strictly '[1.7, 1.8['
            prefer '1.7.25'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle supports a model for <strong>rich version</strong> declarations, allowing you to combine different levels of version specificity.</p>
</div>
<div class="paragraph">
<p>The key terms, listed from strongest to weakest, are:</p>
</div>
<div id="sec:strict-version" class="dlist">
<dl>
<dt class="hdlist1"><code>strictly</code> or <code>!!</code></dt>
<dd>
<p>This is the strongest version declaration.
Any version not matching this notation will be excluded.
If used on a declared dependency, <code>strictly</code> can downgrade a version.
For transitive dependencies, if no acceptable version is found, dependency resolution will fail.</p>
<div class="paragraph">
<p>Dynamic versions are supported.</p>
</div>
<div class="paragraph">
<p>When defined, it overrides any previous <code>require</code> declaration and clears any previous <code>reject</code> already declared on that dependency.</p>
</div>
</dd>
</dl>
</div>
<div id="sec:required-version" class="dlist">
<dl>
<dt class="hdlist1"><code>require</code></dt>
<dd>
<p>This ensures that the selected version cannot be lower than what <code>require</code> accepts, but it can be higher through conflict resolution, even if the higher version has an exclusive upper bound.
This is the default behavior for a direct dependency.</p>
<div class="paragraph">
<p>Dynamic versions are supported.</p>
</div>
<div class="paragraph">
<p>When defined, it overrides any previous <code>strictly</code> declaration and clears any previous <code>reject</code> already declared on that dependency.</p>
</div>
</dd>
</dl>
</div>
<div id="sec:preferred-version" class="dlist">
<dl>
<dt class="hdlist1"><code>prefer</code></dt>
<dd>
<p>This is the softest version declaration.
It applies only if there is no stronger non-dynamic version specified.</p>
<div class="paragraph">
<p>This term does not support dynamic versions and can complement <code>strictly</code> or <code>require</code>.</p>
</div>
<div class="paragraph">
<p>When defined, it overrides any previous <code>prefer</code> declaration and clears any previous <code>reject</code> already declared on that dependency.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Additionally, there is a term outside the hierarchy:</p>
</div>
<div id="sec:rejected-version" class="dlist">
<dl>
<dt class="hdlist1"><code>reject</code></dt>
<dd>
<p>This term specifies versions that are not accepted for the module, causing dependency resolution to fail if a rejected version is selected.</p>
<div class="paragraph">
<p>Dynamic versions are supported.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Rich version declaration is accessed through the <code>version</code> DSL method on a dependency or constraint declaration, which gives you access to <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/MutableVersionConstraint.html">MutableVersionConstraint</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.slf4j:slf4j-api") {
        version {
            strictly("[1.7, 1.8[")
            prefer("1.7.25")
        }
    }

    constraints {
        add("implementation", "org.springframework:spring-core") {
            version {
                require("4.2.9.RELEASE")
                reject("4.3.16.RELEASE")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('org.slf4j:slf4j-api') {
        version {
            strictly '[1.7, 1.8['
            prefer '1.7.25'
        }
    }

    constraints {
        implementation('org.springframework:spring-core') {
            version {
                require '4.2.9.RELEASE'
                reject '4.3.16.RELEASE'
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To enforce <a href="#sec:strict-version">strict versions</a>, you can also use the <code>!!</code> notation:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // short-hand notation with !!
    implementation("org.slf4j:slf4j-api:1.7.15!!")
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly("1.7.15")
        }
    }

    // or...
    implementation("org.slf4j:slf4j-api:[1.7, 1.8[!!1.7.25")
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly("[1.7, 1.8[")
           prefer("1.7.25")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // short-hand notation with !!
    implementation('org.slf4j:slf4j-api:1.7.15!!')
    // is equivalent to
    implementation("org.slf4j:slf4j-api") {
        version {
           strictly '1.7.15'
        }
    }

    // or...
    implementation('org.slf4j:slf4j-api:[1.7, 1.8[!!1.7.25')
    // is equivalent to
    implementation('org.slf4j:slf4j-api') {
        version {
           strictly '[1.7, 1.8['
           prefer '1.7.25'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The notation <code>[1.7, 1.8[!!1.7.25</code> above is equivalent to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>strictly <code>[1.7, 1.8[</code></p>
</li>
<li>
<p>prefer <code>1.7.25</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means that the engine <strong>must</strong> select a version between <code>1.7</code> (included) and <code>1.8</code> (excluded).
If no other component in the graph needs a different version, it should <em>prefer</em> <code>1.7.25</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A strict version cannot be upgraded and overrides any transitive dependency versions, therefore using ranges with strict versions is recommended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following table illustrates several use cases:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Which version(s) of this dependency are acceptable?</th>
<th class="tableblock halign-left valign-top"><code>strictly</code></th>
<th class="tableblock halign-left valign-top"><code>require</code></th>
<th class="tableblock halign-left valign-top"><code>prefer</code></th>
<th class="tableblock halign-left valign-top"><code>rejects</code></th>
<th class="tableblock halign-left valign-top">Selection result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with version <code>1.5</code>; believe all future versions should work.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version starting from <code>1.5</code>, equivalent to <code>org:foo:1.5</code>. An upgrade to <code>2.4</code> is accepted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with <code>1.5</code>, soft constraint upgrades according to semantic versioning.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code>, <code>1.5</code> if nobody else cares. An upgrade to <code>2.4</code> is accepted.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested with <code>1.5</code>, but follows semantic versioning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code> (exclusive), <code>1.5</code> if nobody else cares.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same as above, with <code>1.4</code> known broken.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.0, 2.0[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any version between <code>1.0</code> and <code>2.0</code> (exclusive) except for <code>1.4</code>, <code>1.5</code> if nobody else cares.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No opinion, works with <code>1.5</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code> if no other opinion, any otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No opinion, prefer the latest release.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest.release</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest release at build time.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On the edge, latest release, no downgrade.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>latest.release</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest release at build time.<br>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No other version than 1.5.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5, or failure if another <code>strict</code> or higher <code>require</code> constraint disagrees.<br>
Overwrites versions from transitive dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.5</code> or a patch version of it exclusively.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[1.5,1.6[</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latest <code>1.5.x</code> patch release, or failure if another <code>strict</code> or higher <code>require</code> constraint disagrees.<br>
Overwrites versions from transitive dependencies.<br>
</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Lines annotated with a lock () indicate situations where leveraging <a href="#locking-versions">dependency locking</a> is recommended.
NOTE: When using dependency locking, publishing  <a href="#publishing_maven:resolved_dependencies">resolved versions</a> is always recommended.</p>
</div>
<div class="paragraph">
<p>Using <code>strictly</code> in a library requires careful consideration, as it affects downstream consumers.
However, when used correctly, it helps consumers understand which combinations of libraries may be incompatible in their context.
For more details, refer to the section on <a href="#sec:enforcing-dependency-version">overriding dependency versions</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Rich version information is preserved in the Gradle Module Metadata format.
However, converting this information to Ivy or Maven metadata formats is lossy.
The highest level of version declaration<code>strictly</code> or <code>require</code> over <code>prefer</code>will be published, and any <code>reject</code> will be ignored.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:endorsing-strict-versions"><a class="anchor" href="#sec:endorsing-strict-versions"></a><a class="link" href="#sec:endorsing-strict-versions">Endorsing strict versions</a></h4>
<div id="sec:enforcing-dependency-version" class="paragraph">
<p>Gradle resolves any dependency version conflicts by selecting the greatest version found in the dependency graph.
Some projects might need to divert from the default behavior and enforce an earlier version of a dependency e.g. if the source code of the project depends on an older API of a dependency than some of the external libraries.</p>
</div>
<div class="paragraph">
<p>In general, forcing dependencies is done to downgrade a dependency.
There are common use cases for downgrading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A bug was discovered in the latest release.</p>
</li>
<li>
<p>Your code depends on an older version that is not binary compatible with the newer one.</p>
</li>
<li>
<p>Your code does not use the parts of the library that require a newer version.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Forcing a version of a dependency requires careful consideration, as changing the version of a transitive dependency might lead to runtime errors if external libraries expect a different version. It is often better to upgrade your source code to be compatible with newer versions if possible.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s say a project uses the <a href="https://hc.apache.org/httpcomponents-client-ga/"><code>HttpClient</code> library</a> for performing HTTP calls.
<code>HttpClient</code> pulls in <a href="https://commons.apache.org/proper/commons-codec/"><code>Commons Codec</code></a> as transitive dependency with version <code>1.10</code>.
However, the production source code of the project requires an API from <code>Commons Codec</code> <code>1.9</code> which is no longer available in <code>1.10</code>.
The dependency version can be enforced by declaring it as <code>strict</code> it in the build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.apache.httpcomponents:httpclient:4.5.4")
    implementation("commons-codec:commons-codec") {
        version {
            strictly("1.9")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.4'
    implementation('commons-codec:commons-codec') {
        version {
            strictly '1.9'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:strict-version-consequences"><a class="anchor" href="#sec:strict-version-consequences"></a><a class="link" href="#sec:strict-version-consequences">Consequences of using strict versions</a></h5>
<div class="paragraph">
<p>Using a strict version must be carefully considered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>For Library Authors</strong>: Strict versions effectively act like forced versions. They take precedence over transitive dependencies and override any other strict versions found transitively. This could lead to build failures if the consumer project requires a different version.</p>
</li>
<li>
<p><strong>For Consumers</strong>: Strict versions are considered globally during resolution. If a strict version conflicts with a consumer&#8217;s version requirement, it will trigger a resolution error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if project <code>B</code> <code>strictly</code> depends on <code>C:1.0</code>, but consumer project A requires <code>C:1.1</code>, a resolution error will occur.</p>
</div>
<div class="paragraph">
<p>To avoid this, it is recommended to use version ranges and a preferred version within those ranges.</p>
</div>
<div class="paragraph">
<p>For example, <code>B</code> might say, instead of <code>strictly 1.0</code>, that it <em>strictly depends</em> on the <code>[1.0, 2.0[</code> range, but <em>prefers</em> <code>1.0</code>.
Then if a consumer chooses <code>1.1</code> (or any other version in the range), the build will <em>no longer fail</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-without-version"><a class="anchor" href="#sec:declaring-without-version"></a><a class="link" href="#sec:declaring-without-version">Declaring without version</a></h4>
<div class="paragraph">
<p>For larger projects, it&#8217;s advisable to declare <strong>dependencies without versions</strong> and manage versions using <a href="#sec:sharing-dep-versions-between-projects">platforms</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.springframework:spring-web")
}

dependencies {
    constraints {
        implementation("org.springframework:spring-web:5.0.2.RELEASE")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.springframework:spring-web'
}

dependencies {
    constraints {
        implementation 'org.springframework:spring-web:5.0.2.RELEASE'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This approach centralizes version management, including transitive dependencies.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:dynamic-versions-and-changing-modules"><a class="anchor" href="#sec:dynamic-versions-and-changing-modules"></a><a class="link" href="#sec:dynamic-versions-and-changing-modules">Declaring dynamic versions</a></h4>
<div class="paragraph">
<p>There are many situations where you might need to use the latest version of a specific module dependency or the latest within a range of versions.
This is often necessary during development or when creating a library that needs to be compatible with various dependency versions.
Projects might adopt a more aggressive approach to consuming dependencies by always integrating the latest version to access cutting-edge features.</p>
</div>
<div id="sec:declaring-dependency-with-dynamic-version" class="paragraph">
<p>You can easily manage these ever-changing dependencies by using a <strong>dynamic version</strong>.
A dynamic version can be either a version range (e.g., <code>2.+</code>) or a placeholder for the latest available version (e.g., <code>latest.integration</code>):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.springframework:spring-web:5.+")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework:spring-web:5.+'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using dynamic versions and changing modules can lead to unreproducible builds.
As new versions of a module are published, its API may become incompatible with your source code.
Therefore, use this feature with caution.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
For reproducible builds, its crucial to use <a href="#locking-versions">dependency locking</a> when declaring dependencies with dynamic versions. Without this, the module you request may change even for the same version, which is known as a <a href="#sec:declaring-dependency-with-changing-version">changing version</a>.
For example, a Maven <code>SNAPSHOT</code> module always points to the latest artifact published, making it a "changing module."
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-dependency-with-changing-version"><a class="anchor" href="#sec:declaring-dependency-with-changing-version"></a><a class="link" href="#sec:declaring-dependency-with-changing-version">Declaring changing versions</a></h4>
<div class="paragraph">
<p>A team may implement a series of features before releasing a new version of the application or library. A common strategy to allow consumers to integrate an unfinished version of their artifacts early is to release a module with a <strong>changing version</strong>.
A <strong>changing version</strong> indicates that the feature set is still under active development and hasn&#8217;t released a stable version for general availability yet.</p>
</div>
<div class="paragraph">
<p>In Maven repositories, changing versions are commonly referred to as <a href="https://maven.apache.org/guides/getting-started/index.html#what-is-a-snapshot-version">snapshot versions</a>.
Snapshot versions contain the suffix <code>-SNAPSHOT</code>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how to declare a snapshot version on the Spring dependency:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
    maven {
        url = uri("https://repo.spring.io/snapshot/")
    }
}

dependencies {
    implementation("org.springframework:spring-web:5.0.3.BUILD-SNAPSHOT")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
    maven {
        url = 'https://repo.spring.io/snapshot/'
    }
}

dependencies {
    implementation 'org.springframework:spring-web:5.0.3.BUILD-SNAPSHOT'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle is flexible enough to treat any version as a changing version.
All you need to do is to set the property <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html#setChanging-boolean-">ExternalModuleDependency.setChanging(boolean)</a> to <code>true</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:versioning_file_dependencies"><a class="anchor" href="#sec:versioning_file_dependencies"></a><a class="link" href="#sec:versioning_file_dependencies">Versioning file dependencies</a></h4>
<div class="paragraph">
<p>It is recommended to clearly express the intention and specify a concrete version when using <a href="#sec:file-dependencies">file dependencies</a>.</p>
</div>
<div class="paragraph">
<p>File dependencies are not considered by Gradle&#8217;s <a href="graph_resolution.html#sec:how-gradle-downloads-deps">version conflict resolution</a>.
Therefore, assigning a version to the file name is crucial to indicate the distinct set of changes included in each release.</p>
</div>
<div class="paragraph">
<p>For example, using <code>commons-beanutils-1.3.jar</code> allows tracking changes in the library through its release notes.</p>
</div>
<div class="paragraph">
<p>By following this practice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Project dependencies become easier to maintain and organize.</p>
</li>
<li>
<p>Potential API incompatibilities are easier to identify through the assigned version.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency-constraints"><a class="anchor" href="#dependency-constraints"></a><a class="link" href="#dependency-constraints">Declaring Dependency Constraints</a></h3>
<div class="paragraph">
<p><strong>Dependency constraints</strong> function similarly to <a href="#declaring-dependencies-basics">dependencies</a>, with the key distinction that they do not introduce a dependency themselves.
Instead, <em>constraints define version requirements</em> that influence the resolution process when a dependency is brought into the project by other means.</p>
</div>
<div class="paragraph">
<p>Although constraints are not <a href="#sec:strict-version">strict versions</a> by default, you can specify a strict version constraint if needed.
Once the dependency is included, the version specified by the constraint participates in conflict resolution just as if it were declared as a direct dependency.</p>
</div>
<div class="paragraph">
<p>When developing a single-project library, <strong>constraints</strong> can be directly declared alongside direct dependencies.
However, when developing multi-project libraries and applications, dependencies are best declared centrally in a <a href="#sec:sharing-dep-versions-between-projects">platform</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}

dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api("commons-httpclient:commons-httpclient:3.1")
        api("org.apache.commons:commons-lang3:3.8.1")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-platform'
}

dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api 'commons-httpclient:commons-httpclient:3.1'
        api 'org.apache.commons:commons-lang3:3.8.1'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In general, dependencies are categorized as either <strong>direct</strong> or <strong>transitive</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Direct dependencies</strong> are those explicitly specified within a component&#8217;s build or metadata.</p>
</li>
<li>
<p><strong>Transitive dependencies</strong> are not directly specified; they are pulled in automatically as dependencies of the direct dependencies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A component may require both direct and transitive dependencies to compile or run.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring-constraints-dependencies"><a class="anchor" href="#sec:declaring-constraints-dependencies"></a><a class="link" href="#sec:declaring-constraints-dependencies">Declaring constraints alongside direct dependencies</a></h4>
<div class="paragraph">
<p><strong>Dependency constraints</strong> allow you to define the version or version range for a specific dependency, <em>whenever that dependency is encountered during resolution</em>.</p>
</div>
<div class="paragraph">
<p>This is the preferred method for managing the version of a component across multiple configurations or projects.</p>
</div>
<div class="paragraph">
<p>When Gradle resolves a module version, it considers all relevant factors, including <a href="#sec:rich-version-constraints">rich versions</a>, transitive dependencies, and dependency constraints for that module.
The highest version that meets all the conditions is selected.
If no such version exists, Gradle will fail with an error, detailing the conflicting declarations.</p>
</div>
<div class="paragraph">
<p>In such cases, you can adjust your dependency declarations, dependency constraints, or make necessary changes to transitive dependencies.</p>
</div>
<div class="paragraph">
<p>Like dependency declarations, dependency constraints are <a href="dependency_configurations.html#sub:what-are-dependency-configurations">scoped by configurations</a>, allowing you to selectively apply them to specific parts of a build.</p>
</div>
<div class="paragraph">
<p>The <code>constraints{}</code> block is used within the <code>dependencies{}</code> block to declare these constraints:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}

dependencies {
    constraints {
        api("commons-httpclient:commons-httpclient:3.1")
        runtime("org.postgresql:postgresql:42.2.5")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-platform'
}

dependencies {
    constraints {
        api 'commons-httpclient:commons-httpclient:3.1'
        runtime 'org.postgresql:postgresql:42.2.5'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>api("commons-httpclient:commons-httpclient:3.1")</code>:</p>
<div class="ulist">
<ul>
<li>
<p>This line creates a constraint on the <code>api</code> configuration, asserting that if <code>commons-httpclient</code> is ever resolved by a resolvable configuration that extends the <code>api</code> configuration, its version must be <code>3.1</code> or higher.</p>
</li>
<li>
<p>If a transitive dependency (a dependency of a dependency) or another module in the project pulls in a different version of <code>commons-httpclient</code>, Gradle enforce the dependency to resolve to at least version <code>3.1</code>.</p>
</li>
<li>
<p>This constraint ensures that the library <code>commons-httpclient</code> will be at least version <code>3.1</code> across all configuration that extend the <code>api</code> configuration.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>runtime("org.postgresql:postgresql:42.2.5")</code>:</p>
<div class="ulist">
<ul>
<li>
<p>Similarly, this line applies a constraint on the <code>runtime</code> configuration, enforcing that <code>org.postgresql:postgresql</code> must resolve to at least version <code>42.2.5</code>.</p>
</li>
<li>
<p>Even if other dependencies or modules within the project try to bring in a different version of <code>postgresql</code>, Gradle will choose the higher of <code>42.2.5</code> and the other declared versions.</p>
</li>
<li>
<p>This ensures that any runtime dependencies on <code>postgresql</code> will resolve to at least version <code>42.2.5</code> across all resolvable configurations that extend the <code>runtime</code> configuration.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding-constraints-transitive-deps"><a class="anchor" href="#sec:adding-constraints-transitive-deps"></a><a class="link" href="#sec:adding-constraints-transitive-deps">Adding constraints on transitive dependencies</a></h4>
<div class="paragraph">
<p>Issues with dependency management often arise from transitive dependencies.
Developers sometimes mistakenly address these issues by adding direct dependencies instead of handling them properly with constraints.</p>
</div>
<div class="paragraph">
<p><strong>Dependency constraints</strong> allow you to control the selection of transitive dependencies.</p>
</div>
<div class="paragraph">
<p>In the following example, the version constraint for <code>commons-codec:1.11</code> applies only when <code>commons-codec</code> is brought in as a transitive dependency since it is not directly declared as a dependency in the project.
If <code>commons-codec</code> is not pulled in transitively, the constraint has no effect:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.apache.httpcomponents:httpclient")
    constraints {
        implementation("org.apache.httpcomponents:httpclient:4.5.3") {
            because("previous versions have a bug impacting this application")
        }
        implementation("commons-codec:commons-codec:1.11") {
            because("version 1.9 pulled from httpclient has bugs affecting this application")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.apache.httpcomponents:httpclient'
    constraints {
        implementation('org.apache.httpcomponents:httpclient:4.5.3') {
            because 'previous versions have a bug impacting this application'
        }
        implementation('commons-codec:commons-codec:1.11') {
            because 'version 1.9 pulled from httpclient has bugs affecting this application'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Dependency constraints can also define <a href="#sec:rich-version-constraints">rich version</a> constraints and support <a href="#sec:strict-version">strict versions</a>, allowing you to enforce a specific version even if it conflicts with a transitive dependency&#8217;s version (e.g., if a downgrade is necessary).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Dependency constraints are only published when using <a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a>. This means they are fully supported only when both publishing and consuming modules with Gradle. If modules are consumed with Maven or Ivy, the constraints may not be preserved.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency constraints are transitive.
If <code>library A</code> depends on <code>library B</code>, and <code>library B</code> declares a constraint on <code>module C</code>, that constraint will affect the version of <code>module C</code> that <code>library A</code> depends on.</p>
</div>
<div class="paragraph">
<p>For example, if <code>library A</code> depends on <code>module C version 2</code>, but <code>library B</code> declares a constraint on <code>module C version 3</code>, <code>library A</code> will resolve <code>version 3 of module C</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="declaring-dependency-configurations"><a class="anchor" href="#declaring-dependency-configurations"></a><a class="link" href="#declaring-dependency-configurations">Declaring Dependency Configurations</a></h3>
<div id="sec:what-are-dependency-configurations" class="paragraph">
<p>In Gradle, dependencies are associated with specific scopes, such as compile-time or runtime.
These scopes are represented by configurations, each identified by a unique name.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-configurations.png" alt="dependency management configurations">
</div>
</div>
<div class="paragraph">
<p>Gradle plugins often add pre-defined <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.Configuration.html">configurations</a> to your project.</p>
</div>
<div class="paragraph">
<p>For example, when applied, the Java plugin adds configurations to your project for source code compilation (<code>implementation</code>), test execution (<code>testImplementation</code>), and more (<code>api</code>, <code>compileOnly</code>, <code>runtimeOnly</code>, etc.):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}
dependencies {
    implementation("org.hibernate:hibernate-core:3.6.7.Final")
    testImplementation("junit:junit:4.+")
    api("com.google.guava:guava:23.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}
dependencies {
    implementation 'org.hibernate:hibernate-core:3.6.7.Final'
    testImplementation 'junit:junit:4.+'
    api 'com.google.guava:guava:23.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This example highlights dependencies declared on the <code>implementation</code>, <code>testImplementation</code>, and <code>api</code> configuration for a Java project.
See the <a href="java_plugin.html#sec:java_plugin_and_dependency_management">Java plugin documentation</a> for details.</p>
</div>
<div class="sect3">
<h4 id="sec:resolvable-consumable-configs"><a class="anchor" href="#sec:resolvable-consumable-configs"></a><a class="link" href="#sec:resolvable-consumable-configs">Resolvable and consumable configurations</a></h4>
<div class="paragraph">
<p>Configurations aren&#8217;t used just for declaring dependencies, they serve various roles in dependency management:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Declaring Dependencies Role</strong>: Configurations that define a set of dependencies.</p>
</li>
<li>
<p><strong>Consumer Role</strong>: Configurations that are used to resolve dependencies into artifacts.</p>
</li>
<li>
<p><strong>Producer Role</strong>: Configurations that expose artifacts for consumption by other projects.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="1_configurations_for_declaring_dependencies_i_e_declarable_configuration"><a class="anchor" href="#1_configurations_for_declaring_dependencies_i_e_declarable_configuration"></a><a class="link" href="#1_configurations_for_declaring_dependencies_i_e_declarable_configuration">1. Configurations for declaring dependencies (i.e, declarable configuration)</a></h5>
<div class="paragraph">
<p>To declare dependencies in your project, you can use or create <strong>declarable configurations</strong>.
These configurations help organize and categorize dependencies for different parts of the project.</p>
</div>
<div class="paragraph">
<p>For example, to express a dependency on another project, you would use a <strong>declarable configurations</strong> like <code>implementation</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // add a project dependency to the implementation configuration
    implementation(project(":lib"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // add a project dependency to the implementation configuration
    implementation project(":lib")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Configurations used for declaring dependencies</strong> define and manage the specific libraries or projects your code requires for tasks such as compilation or testing.</p>
</div>
</div>
<div class="sect4">
<h5 id="2_configurations_for_consumers_i_e_resolvable_configuration"><a class="anchor" href="#2_configurations_for_consumers_i_e_resolvable_configuration"></a><a class="link" href="#2_configurations_for_consumers_i_e_resolvable_configuration">2. Configurations for consumers (i.e, resolvable configuration)</a></h5>
<div class="paragraph">
<p>To control how dependencies are resolved and used within your project, you can use or create <strong>resolvable configurations</strong>.
These configurations define classpaths and other sets of artifacts that your project needs during different stages, like compilation or runtime.</p>
</div>
<div class="paragraph">
<p>For example, the <code>implementation</code> configuration declares the dependencies, while <code>compileClasspath</code> and <code>runtimeClasspath</code> are <strong>resolvable configurations</strong> designed for specific purposes.
When resolved, they represent the classpaths needed for compilation and runtime, respectively:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    // declare a resolvable configuration that is going to resolve the compile classpath of the application
    resolvable("compileClasspath") {
        //isCanBeConsumed = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    // declare a resolvable configuration that is going to resolve the compile classpath of the application
    resolvable("compileClasspath") {
        //canBeConsumed = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Resolvable configurations</strong> are those that can be resolved to produce a set of files or artifacts.
These configurations are used to define the classpath for different stages of a build process, such as compilation or runtime.</p>
</div>
</div>
<div class="sect4">
<h5 id="3_configurations_for_producers_i_e_consumable_configuration"><a class="anchor" href="#3_configurations_for_producers_i_e_consumable_configuration"></a><a class="link" href="#3_configurations_for_producers_i_e_consumable_configuration">3. Configurations for producers (i.e., consumable configuration)</a></h5>
<div class="paragraph">
<p><strong>Consumable configurations</strong> are used to expose artifacts to other projects.
These configurations define what parts of your project can be consumed by others, like APIs or runtime dependencies, but are not meant to be resolved directly within your project.</p>
</div>
<div class="paragraph">
<p>For example, the <code>exposedApi</code> configuration is a <strong>consumable configuration</strong> that exposes the API of a component to consumers:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    // a consumable configuration meant for consumers that need the API of this component
    consumable("exposedApi") {
        //isCanBeResolved = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    // a consumable configuration meant for consumers that need the API of this component
    consumable("exposedApi") {
        //canBeResolved = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A library typically provides consumable configurations like <code>apiElements</code> (for compilation) and <code>runtimeElements</code> (for runtime dependencies).
These configurations expose the necessary artifacts for other projects to consume, without being resolvable within the current project.
The <code>canBeDeclared</code>, <code>isCanBeConsumed</code> and <code>isCanBeResolved</code> flags help distinguish the roles of these configurations.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuration-flags-roles"><a class="anchor" href="#sec:configuration-flags-roles"></a><a class="link" href="#sec:configuration-flags-roles">Configuration flags and roles</a></h4>
<div class="paragraph">
<p>Configurations have three key flags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>canBeResolved</code>:</strong> Indicates that this configuration is intended for resolving a set of dependencies into a dependency graph. A resolvable configuration should not be declarable or consumable.</p>
</li>
<li>
<p><strong><code>canBeConsumed</code>:</strong> Indicates that this configuration is intended for exposing artifacts outside this project. A consumable configuration should not be declarable or resolvable.</p>
</li>
<li>
<p><strong><code>canBeDeclared</code>:</strong> Indicates that this configuration is intended for declaring dependencies. A declarable configuration should not be resolvable or consumable.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Configurations should only have one of these flags enabled.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In short, a configuration&#8217;s role is determined by the <code>canBeResolved</code>, <code>canBeConsumed</code>, or <code>canBeDeclared</code> flag:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration role</th>
<th class="tableblock halign-left valign-top">Can be resolved</th>
<th class="tableblock halign-left valign-top">Can be consumed</th>
<th class="tableblock halign-left valign-top">Can be declared</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolve for certain usage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposed to consumers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legacy, don&#8217;t use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For backwards compatibility, the flags have a default value of <code>true</code>, but as a plugin author, you should always determine the right values for those flags, or you might accidentally introduce resolution errors.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how to manually declare the core Java configurations (normally provided by the <a href="java_plugin.html#java_plugin">Java plugin</a>) in Gradle:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// declare a "configuration" named "implementation"
val implementation by configurations.creating {
    isCanBeConsumed = false
    isCanBeResolved = false
}

dependencies {
    // add a project dependency to the implementation configuration
    implementation(project(":lib"))
}

configurations {
    // declare a resolvable configuration that is going to resolve the compile classpath of the application
    resolvable("compileClasspath") {
        //isCanBeConsumed = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
    // declare a resolvable configuration that is going to resolve the runtime classpath of the application
    resolvable("runtimeClasspath") {
        //isCanBeConsumed = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
}

configurations {
    // a consumable configuration meant for consumers that need the API of this component
    consumable("exposedApi") {
        //isCanBeResolved = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
    // a consumable configuration meant for consumers that need the implementation of this component
    consumable("exposedRuntime") {
        //isCanBeResolved = false
        //isCanBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// declare a "configuration" named "implementation"
configurations {
    // declare a "configuration" named "implementation"
    implementation {
        canBeConsumed = false
        canBeResolved = false
    }
}

dependencies {
    // add a project dependency to the implementation configuration
    implementation project(":lib")
}

configurations {
    // declare a resolvable configuration that is going to resolve the compile classpath of the application
    resolvable("compileClasspath") {
        //canBeConsumed = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
    // declare a resolvable configuration that is going to resolve the runtime classpath of the application
    resolvable("runtimeClasspath") {
        //canBeConsumed = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
}

configurations {
    // a consumable configuration meant for consumers that need the API of this component
    consumable("exposedApi") {
        //canBeResolved = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
    // a consumable configuration meant for consumers that need the implementation of this component
    consumable("exposedRuntime") {
        //canBeResolved = false
        //canBeDeclared = false
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following configurations are created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>implementation</code>: Used for declaring project dependencies but neither consumed nor resolved.</p>
</li>
<li>
<p><code>compileClasspath</code> + <code>runtimeClasspath</code>: Resolvable configurations that collect compile-time and runtime dependencies from <code>implementation</code>.</p>
</li>
<li>
<p><code>exposedApi</code> + <code>exposedRuntime</code>: Consumable configurations that expose artifacts (API and runtime) to other projects, but arent meant for internal resolution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This setup mimics the behavior of the <code>implementation</code>, <code>compileClasspath</code>, <code>runtimeClasspath</code>, <code>apiElements</code>, and <code>runtimeElements</code> configurations in the <a href="java_plugin.html#java_plugin">Java plugin</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:deprecated-configurations"><a class="anchor" href="#sec:deprecated-configurations"></a><a class="link" href="#sec:deprecated-configurations">Deprecated configurations</a></h4>
<div class="paragraph">
<p>In the past, some configurations did not define which role they were intended to be used for.</p>
</div>
<div class="paragraph">
<p>A deprecation warning is emitted when a configuration is used in a way that was not intended.
To fix the deprecation, you will need to stop using the configuration in the deprecated role.
The exact changes required depend on how the configuration is used and if there are alternative configurations that should be used instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:defining-custom-configurations"><a class="anchor" href="#sec:defining-custom-configurations"></a><a class="link" href="#sec:defining-custom-configurations">Creating custom configurations</a></h4>
<div class="paragraph">
<p>You can define custom configurations to declare separate scopes of dependencies for specific purposes.</p>
</div>
<div class="paragraph">
<p>Suppose you want to generate Javadocs with AsciiDoc formatting embedded within your Java source code comments.
By setting up the <code>asciidoclet</code> configuration, you enable Gradle to use Asciidoclet, allowing your Javadoc task to produce HTML documentation with enhanced formatting options:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val asciidoclet by configurations.creating

dependencies {
    asciidoclet("org.asciidoctor:asciidoclet:1.+")
}

tasks.register("configureJavadoc") {
    doLast {
        tasks.javadoc {
            options.doclet = "org.asciidoctor.Asciidoclet"
            options.docletpath = asciidoclet.files.toList()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    asciidoclet
}

dependencies {
    asciidoclet 'org.asciidoctor:asciidoclet:1.+'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can manage custom configurations using the <code>configurations</code> block.
Configurations must have names and can extend each other.
For more details, refer to the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ConfigurationContainer.html"><code>ConfigurationContainer</code></a> API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Configurations are intended to be used for a single role: declaring dependencies, performing resolution, or defining consumable variants.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are three main use cases for creating custom configurations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>API/Implementation Separation:</strong> Create custom configurations to separate API dependencies (exposed to consumers) from implementation dependencies (used internally during compilation or runtime).</p>
<div class="ulist">
<ul>
<li>
<p>You might create an <code>api</code> configuration for libraries that consumers will depend on, and an <code>implementation</code> configuration for libraries that are only needed internally. The <code>api</code> configuration is typically consumed by downstream projects, while <code>implementation</code> dependencies are hidden from consumers but used internally.</p>
</li>
<li>
<p>This separation ensures that your project maintains clean boundaries between its public API and strictly internal mechanisms.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Resolvable Configuration Creation</strong>: Create a custom resolvable configuration to resolve specific sets of dependencies, like classpaths, at various build stages.</p>
<div class="ulist">
<ul>
<li>
<p>You might create a <code>compileClasspath</code> configuration that resolves only the dependencies needed to compile your project. Similarly, you could create a <code>runtimeClasspath</code> configuration to resolve the dependencies needed to run the project at runtime.</p>
</li>
<li>
<p>This allows fine-grained control over which dependencies are available during different build phases, such as compilation or testing.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Consumable Configuration from Dependency Configuration</strong>: Create a custom consumable configuration to expose artifacts or dependencies for other projects to consume, typically when your project produces artifacts like JARs.</p>
<div class="ulist">
<ul>
<li>
<p>You might create an <code>exposedApi</code> configuration to expose the API dependencies of your project for consumption by other projects. Similarly, a <code>runtimeElements</code> configuration could be created to expose the runtime dependencies or artifacts that other projects need.</p>
</li>
<li>
<p>Consumable configurations ensure that only the necessary artifacts or dependencies are exposed to consumers.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="configuration_api_incubating_methods"><a class="anchor" href="#configuration_api_incubating_methods"></a><a class="link" href="#configuration_api_incubating_methods">Configuration API incubating methods</a></h5>
<div class="paragraph">
<p>Several incubating factory methods<code>resolvable()</code>, <code>consumable()</code>, and <code>dependencyScope()</code>within the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ConfigurationContainer.html"><code>ConfigurationContainer</code></a> API can be used to simplify the creation of configurations with specific roles.</p>
</div>
<div class="paragraph">
<p>These methods help build authors document the purpose of a configuration and avoid manually setting various configuration flags, streamlining the process and ensuring consistency:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>resolvable()</code></strong>: Creates a configuration intended for resolving dependencies. This means the configuration can be used to resolve dependencies but not consumed by other projects.</p>
</li>
<li>
<p><strong><code>consumable()</code></strong>: Creates a configuration meant to be consumed by other projects but not used to resolve dependencies itself.</p>
</li>
<li>
<p><strong><code>dependencyScope()</code></strong>: Creates a configuration that establishes a dependency scope, setting up the necessary properties to act both as a consumer and provider, depending on the use case.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:config-inheritance-composition"><a class="anchor" href="#sec:config-inheritance-composition"></a><a class="link" href="#sec:config-inheritance-composition">Configuration inheritance</a></h4>
<div class="paragraph">
<p>Configurations can inherit from other configurations, creating an inheritance hierarchy.</p>
</div>
<div class="paragraph">
<p>Configurations form an inheritance hierarchy using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:extendsFrom)"><code>Configuration.extendsFrom(Configuration&#8230;&#8203;)</code></a> method.
A configuration can extend any other configuration other than a <a href="https://docs.gradle.org/9.1.0/kotlin-dsl/gradle/org.gradle.api.artifacts/-configuration-container/detached-configuration.html">detached configuration</a>, regardless of how it is defined in the build script or plugin.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Avoid extending consumable or resolvable configurations with configurations that are not consumable or resolvable, respectively.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, in a project that already uses JUnit for testing, you can define a dedicated configuration named <code>smokeTest</code> to run smoke tests.
Each smoke test performs an HTTP request to verify a web service endpoint.
To reuse the existing test framework dependencies, the <code>smokeTest</code> configuration should extend from <code>testImplementation</code>.
This allows smoke tests to leverage the same dependencies as unit tests without duplication.
The configuration can be declared in <code>build.gradle(.kts)</code> as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val smokeTest by configurations.creating {
    extendsFrom(configurations.testImplementation.get())
}

dependencies {
    testImplementation("junit:junit:4.13")
    smokeTest("org.apache.httpcomponents:httpclient:4.5.5")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    smokeTest.extendsFrom testImplementation
}

dependencies {
    testImplementation 'junit:junit:4.13'
    smokeTest 'org.apache.httpcomponents:httpclient:4.5.5'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This setup enables the <code>smokeTest</code> source set to inherit JUnit and any other testing dependencies, making it easier to define and execute smoke tests while keeping them separate from unit tests.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Configurations can only extend configurations within the same project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When extending a configuration, the new configuration inherits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dependencies</p>
</li>
<li>
<p>dependency constraints</p>
</li>
<li>
<p>exclude rules</p>
</li>
<li>
<p>artifacts</p>
</li>
<li>
<p>capabilities</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The extension does <strong>not</strong> include attributes. It also does <strong>not</strong> extend consumable/resolvable/declarable status.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency-resolution"><a class="anchor" href="#sec:dependency-resolution"></a><a class="link" href="#sec:dependency-resolution">Dependency resolution</a></h4>
<div class="paragraph">
<p>The entrypoint to all dependency resolution APIs is a <em>resolvable</em> <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/Configuration.html">Configuration</a>.
The Java plugins primarily use the <code>compileClasspath</code>, and <code>runtimeClasspath</code> configurations to resolve jars for compilation and runtime respectively.</p>
</div>
<div class="paragraph">
<p>A resolvable configuration is intended for initiating dependency resolution.
The dependencies to be resolved are declared on <em>dependency scope</em> configurations.
The Java plugins use the <code>api</code>, <code>implementation</code>, and <code>runtimeOnly</code> dependency scope configurations, among others, as a source of dependencies to be resolved by the resolvable configurations.</p>
</div>
<div class="paragraph">
<p>Consider the following example that demonstrates how to declare a set of configurations intended for resolution:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This example uses incubating APIs.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val implementation = configurations.dependencyScope("implementation")
val runtimeClasspath = configurations.resolvable("runtimeClasspath") {
    extendsFrom(implementation.get())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    dependencyScope("implementation")
    resolvable("runtimeClasspath") {
        extendsFrom(implementation)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Dependencies can be declared on the <code>implementation</code> configuration using the dependencies block. See the <a href="declaring_dependencies.html#one-declaring-dependencies">Declaring Dependencies</a> chapter for more information on the types of dependencies that can be declared, and the various options for customizing dependency declarations.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.google.guava:guava:33.2.1-jre")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation("com.google.guava:guava:33.2.1-jre")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now that we&#8217;ve created a <em>dependency scope</em> configuration for declaring dependencies, and a <em>resolvable</em> configuration for resolving those dependencies, we can use Gradle&#8217;s <a href="dependency_resolution.html#dependency-resolution-basics">dependency resolution APIs</a> to access the results of resolution.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:unsafe-configuration-resolution-errors"><a class="anchor" href="#sub:unsafe-configuration-resolution-errors"></a><a class="link" href="#sub:unsafe-configuration-resolution-errors">Unsafe configuration resolution errors</a></h4>
<div class="paragraph">
<p>Resolving a configuration can have side effects on Gradle&#8217;s project model.
As a result, Gradle must manage access to each project&#8217;s configurations.</p>
</div>
<div class="paragraph">
<p>There are a number of ways a configuration might be resolved unsafely.
For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A task from one project directly resolves a configuration in another project in the task&#8217;s action.</p>
</li>
<li>
<p>A task specifies a configuration from another project as an input file collection.</p>
</li>
<li>
<p>A build script for one project resolves a configuration in another project during evaluation.</p>
</li>
<li>
<p>Project configurations are resolved in the settings file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle produces a deprecation warning for each unsafe access.</p>
</div>
<div class="paragraph">
<p>Unsafe access can cause indeterminate errors.
You should <a href="#sec:command_line_warnings">fix unsafe access warnings</a> in your build.</p>
</div>
<div class="paragraph">
<p>In most cases, you can resolve unsafe accesses by creating a <a href="variant_aware_resolution.html#sec:variant-aware-matching">proper cross-project dependency</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub:gradle_distribution_dependencies"><a class="anchor" href="#sub:gradle_distribution_dependencies"></a><a class="link" href="#sub:gradle_distribution_dependencies">Gradle distribution-specific dependencies</a></h3>
<div class="paragraph">
<p>Gradle provides special dependency notations for projects that build Gradle plugins or tools that integrate with Gradle.</p>
</div>
<div class="paragraph">
<p>Using these dependencies ensures compatibility with Gradles internal APIs while keeping plugin and build logic development streamlined.</p>
</div>
<div class="sect3">
<h4 id="sub:api_dependencies"><a class="anchor" href="#sub:api_dependencies"></a><a class="link" href="#sub:api_dependencies">Gradle API dependency</a></h4>
<div class="paragraph">
<p>You can declare a dependency on the API of the current version of Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleApi()"><code>DependencyHandler.gradleApi()</code></a> method.
This is useful when you are developing custom Gradle tasks or plugins:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(gradleApi())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation gradleApi()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:testkit_dependencies"><a class="anchor" href="#sub:testkit_dependencies"></a><a class="link" href="#sub:testkit_dependencies">Gradle TestKit dependency</a></h4>
<div class="paragraph">
<p>You can declare a dependency on the <code>TestKit</code> API of the current version of Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleTestKit()"><code>DependencyHandler.gradleTestKit()</code></a> method.
This is useful for writing and executing functional tests for Gradle plugins and build scripts:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation(gradleTestKit())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation gradleTestKit()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="#test_kit">TestKit chapter</a> explains the use of <code>TestKit</code> by example.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:groovy_dependencies"><a class="anchor" href="#sub:groovy_dependencies"></a><a class="link" href="#sub:groovy_dependencies">Local Groovy dependency</a></h4>
<div class="paragraph">
<p>You can declare a dependency on the Groovy that is distributed with Gradle by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:localGroovy()"><code>DependencyHandler.localGroovy()</code></a> method.
This is useful when you are developing custom Gradle tasks or plugins in Groovy:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(localGroovy())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation localGroovy()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="verifying-dependencies"><a class="anchor" href="#verifying-dependencies"></a><a class="link" href="#verifying-dependencies">Verifying dependencies</a></h3>
<div class="paragraph">
<p>Working with external dependencies and plugins published on third-party repositories puts your build at risk.
In particular, you need to be aware of what binaries are brought in transitively and if they are legit.
To mitigate the security risks and avoid integrating compromised dependencies in your project, Gradle supports <em>dependency verification</em>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Dependency verification is, by nature, an inconvenient feature to use.
It means that whenever you&#8217;re going to update a dependency, builds are likely to fail.
It means that merging branches are going to be harder because each branch can have different dependencies.
It means that you will be tempted to switch it off.</p>
</div>
<div class="paragraph">
<p>So why should you bother?</p>
</div>
<div class="paragraph">
<p>Dependency verification is about <strong>trust</strong> in what you get and what you ship.</p>
</div>
<div class="paragraph">
<p>Without dependency verification it&#8217;s easy for an attacker to compromise your supply chain.
There are many real world examples of tools compromised by adding a malicious dependency.
Dependency verification is meant to protect yourself from those attacks, by forcing you to ensure that the artifacts you include in your build are the ones that you expect.
It is not meant, however, to prevent you from including <em>vulnerable</em> dependencies.</p>
</div>
<div class="paragraph">
<p>Finding the right balance between security and convenience is hard but Gradle will try to let you choose the "right level" for you.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Dependency verification consists of two different and complementary operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>checksum verification</em>, which allows asserting the integrity of a dependency</p>
</li>
<li>
<p><em>signature verification</em>, which allows asserting the provenance of a dependency</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle supports both checksum and signature verification out of the box but performs no dependency verification by default.
This section will guide you into configuring dependency verification properly for your needs.</p>
</div>
<div class="paragraph">
<p>This feature can be used for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>detecting compromised dependencies</p>
</li>
<li>
<p>detecting compromised plugins</p>
</li>
<li>
<p>detecting tampered dependencies in the local dependency caches</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sub:enabling-verification"><a class="anchor" href="#sub:enabling-verification"></a><a class="link" href="#sub:enabling-verification">Enabling dependency verification</a></h4>
<div class="sect4">
<h5 id="sub:verification-metadata"><a class="anchor" href="#sub:verification-metadata"></a><a class="link" href="#sub:verification-metadata">The verification metadata file</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Currently the only source of dependency verification metadata is this XML configuration file.
Future versions of Gradle may include other sources (for example via external services).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency verification is automatically enabled once the configuration file for dependency verification is discovered.
This configuration file is located at <code>$PROJECT_ROOT/gradle/verification-metadata.xml</code>.
This file minimally consists of the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
    &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Doing so, Gradle will verify all artifacts using <a href="#sec:checksum-verification">checksums</a>, but will not verify <a href="#sec:signature-verification">signatures</a>.
Gradle will verify any artifact downloaded using its dependency management engine, which includes, but is not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>artifact files (e.g jar files, zips, &#8230;&#8203;) used during a build</p>
</li>
<li>
<p>metadata artifacts (POM files, Ivy descriptors, Gradle Module Metadata)</p>
</li>
<li>
<p>plugins (both project and settings plugins)</p>
</li>
<li>
<p>artifacts resolved using the advanced dependency resolution APIs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle will <em>not</em> verify changing dependencies (in particular <code>SNAPSHOT</code> dependencies) nor locally produced artifacts (typically jars produced during the build itself) as by nature their checksums and signatures would always change.</p>
</div>
<div class="paragraph">
<p>With such a minimal configuration file, a project using <em>any</em> external dependency or plugin would immediately start failing because it doesn&#8217;t contain any checksum to verify.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification-scope"><a class="anchor" href="#sec:verification-scope"></a><a class="link" href="#sec:verification-scope">Scope of the dependency verification</a></h5>
<div class="paragraph">
<p>A dependency verification configuration is <em>global</em>: a single file is used to configure verification of the whole build.
In particular, the same file is used for both the (sub)projects and <code>buildSrc</code>.</p>
</div>
<div class="paragraph">
<p>If an included build is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the configuration file of the <em>current</em> build is used for verification</p>
</li>
<li>
<p>so if the included build itself uses verification, its configuration is ignored in favor of the current one</p>
</li>
<li>
<p>which means that including a build works similarly to upgrading a dependency: it may require you to update your current verification metadata</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An easy way to get started is therefore to generate the minimal configuration for an existing build.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification-console-output"><a class="anchor" href="#sec:verification-console-output"></a><a class="link" href="#sec:verification-console-output">Configuring the console output</a></h5>
<div class="paragraph">
<p>By default, if dependency verification fails, Gradle will generate a small summary about the verification failure as well as an HTML report containing the full information about the failures.
If your environment prevents you from reading this HTML report file (for example if you run a build on CI and that it&#8217;s not easy to fetch the remote artifacts), Gradle provides a way to opt-in a verbose console report.
For this, you need to add this Gradle property to your <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.dependency.verification.console=verbose</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:bootstrapping-verification"><a class="anchor" href="#sec:bootstrapping-verification"></a><a class="link" href="#sec:bootstrapping-verification">Bootstrapping dependency verification</a></h5>
<div class="paragraph">
<p>It&#8217;s worth mentioning that while Gradle can generate a dependency verification file for you, you should always check whatever Gradle generated for you because your build may <em>already</em> contain compromised dependencies without you knowing about it.
Please refer to the appropriate <a href="#sec:checksum-verification">checksum verification</a> or <a href="#sec:signature-verification">signature verification</a> section for more information.</p>
</div>
<div class="paragraph">
<p>If you plan on using <a href="#sec:signature-verification">signature verification</a>, please also read the <a href="#sec:bootstrapping-signature-verification">corresponding section</a> of the docs.</p>
</div>
<div class="paragraph">
<p>Bootstrapping can either be used to create a file from the beginning, or also to <em>update</em> an existing file with new information.
Therefore, it&#8217;s recommended to always use the same parameters once you started bootstrapping.</p>
</div>
<div class="paragraph">
<p>The dependency verification file can be generated with the following CLI instructions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle --write-verification-metadata sha256 help</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>write-verification-metadata</code> flag requires the list of <a href="#sec:checksum-verification">checksums</a> that you want to generate or <code>pgp</code> for <a href="#sec:signature-verification">signatures</a>.</p>
</div>
<div class="paragraph">
<p>Executing this command line will cause Gradle to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>resolve all <a href="#sec:resolvable-consumable-configs">resolvable configurations</a>, which includes:</p>
<div class="ulist">
<ul>
<li>
<p>configurations from the root project</p>
</li>
<li>
<p>configurations from all subprojects</p>
</li>
<li>
<p>configurations from <code>buildSrc</code></p>
</li>
<li>
<p>included builds configurations</p>
</li>
<li>
<p>configurations used by plugins</p>
</li>
</ul>
</div>
</li>
<li>
<p>download all artifacts discovered during resolution</p>
</li>
<li>
<p>compute the requested checksums and possibly verify signatures depending on what you asked</p>
</li>
<li>
<p>At the end of the build, generate the configuration file which will contain the inferred <em>verification metadata</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, the <code>verification-metadata.xml</code> file will be used in subsequent builds to verify dependencies.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>There are dependencies that Gradle <em>cannot</em> discover this way.
In particular, you will notice that the CLI above uses the <code>help</code> task.
If you don&#8217;t specify any task, Gradle will automatically run the default task and generate a configuration file at the end of the build too.</p>
</div>
<div class="paragraph">
<p>The difference is that Gradle <em>may</em> discover more dependencies and artifacts depending on the tasks you execute.
As a matter of fact, Gradle cannot automatically discover <em>detached configurations</em>, which are basically dependency graphs resolved as an internal implementation detail of the execution of a task: they are not, in particular, declared as an input of the task because they effectively depend on the configuration of the task at execution time.</p>
</div>
<div class="paragraph">
<p>A good way to start is just to use the simplest task, <code>help</code>, which will discover as much as possible, and if subsequent builds fail with a verification error, you can re-execute generation with the appropriate tasks to "discover" more dependencies.</p>
</div>
<div class="paragraph">
<p>Gradle won&#8217;t verify either checksums or signatures of plugins which use their own HTTP clients.
Only plugins which use the infrastructure provided by Gradle for performing requests will see their requests verified.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification-update"><a class="anchor" href="#sec:verification-update"></a><a class="link" href="#sec:verification-update">Using generation for incremental updates</a></h5>
<div class="paragraph">
<p>The verification file generated by Gradle has a strict ordering for all its content.
It also uses the information from the existing state to limit changes to the strict minimum.</p>
</div>
<div class="paragraph">
<p>This means that generation is actually a convenient tool for <em>updating</em> a verification file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checksum entries generated by Gradle will have a clear <code>origin</code> that starts with "Generated by Gradle", which is a good indicator that an entry needs to be reviewed,</p>
</li>
<li>
<p>Entries added by hand will immediately be accounted for, and appear at the right location after writing the file,</p>
</li>
<li>
<p>The header comments of the file will be preserved, i.e. comments before the root XML node.
This allows you to have a license header or instructions on which tasks and which parameters to use for generating that file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the above benefits, it is really easy to account for new dependencies or dependency versions by simply generating the file again and reviewing the changes.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification-dry-mode"><a class="anchor" href="#sec:verification-dry-mode"></a><a class="link" href="#sec:verification-dry-mode">Using dry mode</a></h5>
<div class="paragraph">
<p>By default, bootstrapping is incremental, which means that if you run it multiple times, information is <em>added</em> to the file and in particular you can rely on your VCS to check the diffs.
There are situations where you would just want to <em>see</em> what the generated verification metadata file would look like without actually changing the existing one or overwriting it.</p>
</div>
<div class="paragraph">
<p>For this purpose, you can just add <code>--dry-run</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle --write-verification-metadata sha256 help --dry-run</pre>
</div>
</div>
<div class="paragraph">
<p>Then instead of generating the <code>verification-metadata.xml</code> file, a <em>new file</em> will be generated, called <code>verification-metadata.dryrun.xml</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because <code>--dry-run</code> doesn&#8217;t execute tasks, this would be much faster, but it will miss any resolution happening at task execution time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:disabling-metadata-verification"><a class="anchor" href="#sec:disabling-metadata-verification"></a><a class="link" href="#sec:disabling-metadata-verification">Disabling metadata verification</a></h5>
<div class="paragraph">
<p>By default, Gradle will not only verify artifacts (jars, &#8230;&#8203;) but also the metadata associated with those artifacts (typically POM files).
Verifying this ensures the maximum level of security: metadata files typically tell what transitive dependencies will be included, so a compromised metadata file may cause the introduction of undesired dependencies in the graph.
However, because all artifacts are verified, such artifacts would in general easily be discovered by you, because they would cause a checksum verification failure (checksums would be <em>missing</em> from verification metadata).
Because metadata verification can significantly increase the size of your configuration file, you may therefore want to disable verification of metadata.
If you understand the risks of doing so, set the <code>&lt;verify-metadata&gt;</code> flag to <code>false</code> in the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;false&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
    &lt;/configuration&gt;
    &lt;!-- the rest of this file doesn't need to declare anything about metadata files --&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:checksum-verification"><a class="anchor" href="#sec:checksum-verification"></a><a class="link" href="#sec:checksum-verification">Verifying dependency checksums</a></h4>
<div class="paragraph">
<p>Checksum verification allows you to ensure the integrity of an artifact.
This is the simplest thing that Gradle can do for you to make sure that the artifacts you use are un-tampered.</p>
</div>
<div class="paragraph">
<p>Gradle supports MD5, SHA1, SHA-256 and SHA-512 checksums.
However, only SHA-256 and SHA-512 checksums are considered secure nowadays.</p>
</div>
<div class="sect4">
<h5 id="adding_the_checksum_for_an_artifact"><a class="anchor" href="#adding_the_checksum_for_an_artifact"></a><a class="link" href="#adding_the_checksum_for_an_artifact">Adding the checksum for an artifact</a></h5>
<div class="paragraph">
<p>External components are identified by GAV coordinates, then each of the artifacts by their file names.
To declare the checksums of an artifact, you need to add the corresponding section in the verification metadata file.
For example, to declare the checksum for <a href="https://pdfbox.apache.org">Apache PDFBox</a>.
The GAV coordinates are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>group <code>org.apache.pdfbox</code></p>
</li>
<li>
<p>name <code>pdfbox</code></p>
</li>
<li>
<p>version <code>2.0.17</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using this dependency will trigger the download of 2 different files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pdfbox-2.0.17.jar</code> which is the main artifact</p>
</li>
<li>
<p><code>pdfbox-2.0.17.pom</code> which is the metadata file associated with this artifact</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, you need to declare the checksums for both of them (unless you <a href="#sec:disabling-metadata-verification">disabled metadata verification</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;false&lt;/verify-signatures&gt;
   &lt;/configuration&gt;
   &lt;components&gt;
      &lt;component group="org.apache.pdfbox" name="pdfbox" version="2.0.17"&gt;
         &lt;artifact name="pdfbox-2.0.17.jar"&gt;
            &lt;sha512 value="7e11e54a21c395d461e59552e88b0de0ebaf1bf9d9bcacadf17b240d9bbc29bf6beb8e36896c186fe405d287f5d517b02c89381aa0fcc5e0aa5814e44f0ab331" origin="PDFBox Official site (https://pdfbox.apache.org/download.cgi)"/&gt;
         &lt;/artifact&gt;
         &lt;artifact name="pdfbox-2.0.17.pom"&gt;
            &lt;sha512 value="82de436b38faf6121d8d2e71dda06e79296fc0f7bc7aba0766728c8d306fd1b0684b5379c18808ca724bf91707277eba81eb4fe19518e99e8f2a56459b79742f" origin="Generated by Gradle"/&gt;
         &lt;/artifact&gt;
      &lt;/component&gt;
   &lt;/components&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="where_to_get_checksums_from"><a class="anchor" href="#where_to_get_checksums_from"></a><a class="link" href="#where_to_get_checksums_from">Where to get checksums from?</a></h5>
<div class="paragraph">
<p>In general, checksums are published alongside artifacts on public repositories.
However, if a dependency is compromised in a repository, it&#8217;s likely its checksum will be too, so it&#8217;s a good practice to get the checksum from a different place, usually the website of the library itself.</p>
</div>
<div class="paragraph">
<p>In fact, it&#8217;s a good security practice to publish the checksums of artifacts on a <em>different server</em> than the server where the artifacts themselves are hosted: it&#8217;s harder to compromise a library both on the repository <em>and</em> the official website.</p>
</div>
<div class="paragraph">
<p>In the example above, the checksum was published on the website for the JAR, but not the POM file.
This is why it&#8217;s usually easier to <a href="#sec:bootstrapping-verification">let Gradle generate the checksums</a> and verify by reviewing the generated file carefully.</p>
</div>
<div class="paragraph">
<p>In this example, not only could we check that the checksum was correct, but we could also find it on the official website, which is why we changed the value of the of <code>origin</code> attribute on the <code>sha512</code> element from <code>Generated by Gradle</code> to <code>PDFBox Official site</code>.
Changing the <code>origin</code> gives users a sense of how trustworthy your build it.</p>
</div>
<div class="paragraph">
<p>Interestingly, using <code>pdfbox</code> will require <em>much more</em> than those 2 artifacts, because it will also bring in transitive dependencies.
If the dependency verification file only included the checksums for the main artifacts you used, the build would fail with an error like this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.
    - On artifact commons-logging-1.2.pom (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.</pre>
</div>
</div>
<div class="paragraph">
<p>What this indicates is that your build requires <code>commons-logging</code> when executing <code>compileJava</code>, however the verification file doesn&#8217;t contain enough information for Gradle to verify the integrity of the dependencies, meaning you need to add the required information to the verification metadata file.</p>
</div>
<div class="paragraph">
<p>See <a href="#sec:troubleshooting-verification">troubleshooting dependency verification</a> for more insights on what to do in this situation.</p>
</div>
</div>
<div class="sect4">
<h5 id="what_checksums_are_verified"><a class="anchor" href="#what_checksums_are_verified"></a><a class="link" href="#what_checksums_are_verified">What checksums are verified?</a></h5>
<div class="paragraph">
<p>If a dependency verification metadata file declares more than one checksum for a dependency, Gradle will verify <em>all of them</em> and fail if <em>any of them fails</em>.
For example, the following configuration would check both the <code>md5</code> and <code>sha1</code> checksums:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;component group="org.apache.pdfbox" name="pdfbox" version="2.0.17"&gt;
   &lt;artifact name="pdfbox-2.0.17.jar"&gt;
      &lt;md5 value="c713a8e252d0add65e9282b151adf6b4" origin="official site"/&gt;
      &lt;sha1 value="b5c8dff799bd967c70ccae75e6972327ae640d35" origin="official site" reason="Additional check for this artifact"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are multiple reasons why you&#8217;d like to do so:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>an official site doesn&#8217;t publish <em>secure</em> checksums (SHA-256, SHA-512) but publishes multiple insecure ones (MD5, SHA1).
While it&#8217;s easy to fake a MD5 checksum and hard but possible to fake a SHA1 checksum, it&#8217;s harder to fake both of them for the same artifact.</p>
</li>
<li>
<p>you might want to add generated checksums to the list above</p>
</li>
<li>
<p>when <em>updating</em> dependency verification file with more secure checksums, you don&#8217;t want to accidentally erase checksums</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:signature-verification"><a class="anchor" href="#sec:signature-verification"></a><a class="link" href="#sec:signature-verification">Verifying dependency signatures</a></h4>
<div class="paragraph">
<p>In addition to <a href="#sec:checksum-verification">checksums</a>, Gradle supports verification of signatures.
Signatures are used to assess the <em>provenance</em> of a dependency (it tells who signed the artifacts, which usually corresponds to who produced it).</p>
</div>
<div class="paragraph">
<p>As enabling signature verification usually means a higher level of security, you might want to replace checksum verification with signature verification.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Signatures <em>can</em> also be used to assess the integrity of a dependency similarly to checksums.
Signatures are signatures of the <em>hash</em> of artifacts, not artifacts themselves.
This means that if the signature is done on an <em>unsafe hash</em> (even SHA1), then you&#8217;re not correctly assessing the <em>integrity</em> of a file.
For this reason, if you care about both, you need to add both signatures <em>and</em> checksums to your verification metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle only supports verification of signatures published on remote repositories as ASCII-armored PGP files</p>
</li>
<li>
<p>Not all artifacts are published with signatures</p>
</li>
<li>
<p>A good signature doesn&#8217;t mean that the signatory was legit</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, signature verification will often be used alongside checksum verification.</p>
</div>
<div class="openblock">
<div class="title">About expired keys</div>
<div class="content">
<div class="paragraph">
<p>It&#8217;s very common to find artifacts which are signed with an expired key.
This is not a problem for <em>verification</em>: key expiry is mostly used to avoid signing with a stolen key.
If an artifact was signed before expiry, it&#8217;s still valid.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="enabling_signature_verification"><a class="anchor" href="#enabling_signature_verification"></a><a class="link" href="#enabling_signature_verification">Enabling signature verification</a></h5>
<div class="paragraph">
<p>Because verifying signatures is more expensive (both I/O and CPU wise) and harder to check manually, it&#8217;s not enabled by default.</p>
</div>
<div class="paragraph">
<p>Enabling it requires you to change the configuration option in the <code>verification-metadata.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:understanding-signature-verification"><a class="anchor" href="#sec:understanding-signature-verification"></a><a class="link" href="#sec:understanding-signature-verification">Understanding signature verification</a></h4>
<div class="paragraph">
<p>Once signature verification is enabled, for each artifact, Gradle will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>try to download the corresponding <code>.asc</code> file</p>
</li>
<li>
<p>if it&#8217;s present</p>
<div class="ulist">
<ul>
<li>
<p>automatically download the keys required to perform verification of the signature</p>
</li>
<li>
<p>verify the artifact using the downloaded public keys</p>
</li>
<li>
<p>if signature verification passes, perform additional requested checksum verification</p>
</li>
</ul>
</div>
</li>
<li>
<p>if it&#8217;s absent, fallback to checksum verification</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>That is to say that Gradle&#8217;s verification mechanism is much stronger if signature verification is enabled than just with checksum verification.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if an artifact is signed with multiple keys, all of them must pass validation or the build will fail</p>
</li>
<li>
<p>if an artifact passes verification, any additional checksum configured for the artifact <em>will also be checked</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, it&#8217;s not because an artifact passes signature verification that you can trust it: you need to <em>trust the keys</em>.</p>
</div>
<div class="paragraph">
<p>In practice, it means you need to list the keys that you trust for each artifact, which is done by adding a <code>pgp</code> entry instead of a <code>sha1</code> for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
   &lt;artifact name="javaparser-core-3.6.11.jar"&gt;
      &lt;pgp value="8756c4f765c9ac3cb6b85d62379ce192d401ab61"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>For the <code>pgp</code> and <code>trusted-key</code> elements, Gradle <em>requires</em> full fingerprint IDs (e.g. <code>b801e2f8ef035068ec1139cc29579f18fa8fd93b</code> instead of a long ID <code>29579f18fa8fd93b</code>).
This minimizes the chance of a <a href="https://en.wikipedia.org/wiki/Collision_attack">collision attack</a>.</p>
</div>
<div class="paragraph">
<p>At the time, <a href="https://www.rfc-editor.org/rfc/rfc4880#section-12.2">V4 key fingerprints</a> are of 160-bit (40 characters) length. We accept longer keys to be future-proof in case a longer key fingerprint is introduced.</p>
</div>
<div class="paragraph">
<p>In <code>ignore-key</code> elements, either fingerprints or long (64-bit) IDs can be used. A shorter ID can only result in a bigger range of exclusion, therefore, it&#8217;s safe to use.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This effectively means that you trust <code>com.github.javaparser:javaparser-core:3.6.11</code> if it&#8217;s signed with the key <code>8756c4f765c9ac3cb6b85d62379ce192d401ab61</code>.</p>
</div>
<div class="paragraph">
<p>Without this, the build would fail with this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '8756c4f765c9ac3cb6b85d62379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) and passed verification but the key isn't in your trusted keys list.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The key IDs that Gradle shows in error messages are the key IDs found in the signature file it tries to verify.
It doesn&#8217;t mean that it&#8217;s necessarily the keys that you should trust.
In particular, if the signature is correct but done by a malicious entity, Gradle wouldn&#8217;t tell you.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec:trusting-keys-globally"><a class="anchor" href="#sec:trusting-keys-globally"></a><a class="link" href="#sec:trusting-keys-globally">Trusting keys globally</a></h5>
<div class="paragraph">
<p>Signature verification has the advantage that it can make the configuration of dependency verification easier by not having to explicitly list all artifacts like for checksum verification only.
In fact, it&#8217;s common that the same key can be used to sign several artifacts.
If this is the case, you can move the trusted key from the artifact level to the global configuration block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;trusted-keys&gt;
         &lt;trusted-key id="8756c4f765c9ac3cb6b85d62379ce192d401ab61" group="com.github.javaparser"/&gt;
      &lt;/trusted-keys&gt;
   &lt;/configuration&gt;
   &lt;components/&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration above means that for any artifact belonging to the group <code>com.github.javaparser</code>, we trust it if it&#8217;s signed with the <code>8756c4f765c9ac3cb6b85d62379ce192d401ab61</code> fingerprint.</p>
</div>
<div class="paragraph">
<p>The <code>trusted-key</code> element works similarly to the <a href="#sec:trusting-artifacts">trusted-artifact</a> element:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code>, the group of the artifact to trust</p>
</li>
<li>
<p><code>name</code>, the name of the artifact to trust</p>
</li>
<li>
<p><code>version</code>, the version of the artifact to trust</p>
</li>
<li>
<p><code>file</code>, the name of the artifact <em>file</em> to trust</p>
</li>
<li>
<p><code>regex</code>, a boolean saying if the <code>group</code>, <code>name</code>, <code>version</code> and <code>file</code> attributes need to be interpreted as regular expressions (defaults to <code>false</code>)</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You should be careful when trusting a key globally.</p>
</div>
<div class="paragraph">
<p>Try to limit it to the appropriate groups or artifacts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a valid key may have been used to sign artifact <code>A</code> which you trust</p>
</li>
<li>
<p>later on, the key is stolen and used to sign artifact <code>B</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It means you can trust the key <code>A</code> for the first artifact, probably only up to the released version before the key was stolen, but not for <code>B</code>.</p>
</div>
<div class="paragraph">
<p>Remember that anybody can put an arbitrary name when generating a PGP key, so never trust the key solely based on the key name.
Verify if the key is listed at the official site.
For example, Apache projects typically provide a KEYS.txt file that you can trust.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:ignoring-keys"><a class="anchor" href="#sec:ignoring-keys"></a><a class="link" href="#sec:ignoring-keys">Specifying key servers and ignoring keys</a></h5>
<div class="paragraph">
<p>Gradle will automatically download the public keys required to verify a signature.
For this it uses a list of well known and trusted key servers (the list may change between Gradle versions, please refer to the implementation to figure out what servers are used by default).</p>
</div>
<div class="paragraph">
<p>You can explicitly set the list of key servers that you want to use by adding them to the configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;key-servers&gt;
         &lt;key-server uri="hkp://my-key-server.org"/&gt;
         &lt;key-server uri="https://my-other-key-server.org"/&gt;
      &lt;/key-servers&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Despite this, it&#8217;s possible that a key is not available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>because it wasn&#8217;t published to a public key server</p>
</li>
<li>
<p>because it was lost</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, you can ignore a key in the configuration block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;ignored-keys&gt;
         &lt;ignored-key id="abcdef1234567890" reason="Key is not available in any key server"/&gt;
      &lt;/ignored-keys&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As soon as a key is ignored, it will not be used for verification, even if the signature file mentions it.
However, if the signature cannot be verified with at least one other key, Gradle will mandate that you provide a checksum.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If Gradle cannot download a key while bootstrapping, it will mark it as ignored.
If you can find the key but Gradle does not, you can <a href="#sec:add-manual-keyring">manually add it</a> to the keyring file.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:local-keyring"><a class="anchor" href="#sec:local-keyring"></a><a class="link" href="#sec:local-keyring">Exporting keys for faster verification</a></h5>
<div class="paragraph">
<p>Gradle automatically downloads the required keys but this operation can be quite slow and requires everyone to download the keys.
To avoid this, Gradle offers the ability to use a local keyring file containing the required public keys.
Note that only public key packets and a single userId per key are stored and used.
All other information (user attributes, signatures, etc.) is stripped from downloaded or exported keys.</p>
</div>
<div class="paragraph">
<p>Gradle supports 2 different file formats for keyrings: a binary format (<code>.gpg</code> file) and a plain text format (<code>.keys</code>), also known as ASCII-armored format.</p>
</div>
<div class="paragraph">
<p>There are pros and cons for each of the formats: the binary format is more compact and can be updated directly via GPG commands, but is completely opaque (binary).
On the opposite, the ASCII-armored format is human-readable, can be easily updated by hand and makes it easier to do code reviews thanks to readable diffs.</p>
</div>
<div class="paragraph">
<p>You can configure which file type would be used by adding the <code>keyring-format</code> configuration option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;verify-metadata&gt;true&lt;/verify-metadata&gt;
      &lt;verify-signatures&gt;true&lt;/verify-signatures&gt;
      &lt;keyring-format&gt;armored&lt;/keyring-format&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Available options for keyring format are <code>armored</code> and <code>binary</code>.</p>
</div>
<div class="paragraph">
<p>Without <code>keyring-format</code>, if the <code>gradle/verification-keyring.gpg</code> or <code>gradle/verification-keyring.keys</code> file is present, Gradle will search for keys there in priority.
The plain text file will be ignored if there&#8217;s already a <code>.gpg</code> file (the binary version takes precedence).</p>
</div>
<div class="paragraph">
<p>You can <em>ask Gradle to export all keys it used for verification of this build to the keyring</em> during bootstrapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --write-verification-metadata pgp,sha256 --export-keys</pre>
</div>
</div>
<div class="paragraph">
<p>Unless <code>keyring-format</code> is specified, this command will generate <strong>both</strong> the binary version and the ASCII-armored file.
Use this option to choose the preferred format.
You should only pick one for your project.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good idea to commit this file to VCS (as long as you trust your VCS).
If you use git and use the binary version, make sure to make it treat this file as binary, by adding this to your <code>.gitattributes</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*.gpg           binary</pre>
</div>
</div>
<div class="paragraph">
<p>You can also ask Gradle to export all trusted keys without updating the verification metadata file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --export-keys</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This command will not report verification errors, only export keys.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:bootstrapping-signature-verification"><a class="anchor" href="#sec:bootstrapping-signature-verification"></a><a class="link" href="#sec:bootstrapping-signature-verification">Bootstrapping and signature verification</a></h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Signature verification bootstrapping takes an <em>optimistic point of view</em> that signature verification is <em>enough</em>.
Therefore, if you also care about <em>integrity</em>, you <strong>must</strong> first bootstrap using checksum verification, <em>then</em> with signature verification.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similarly to bootstrapping for checksums, Gradle provides a convenience for bootstrapping a configuration file with signature verification enabled.
For this, just add the <code>pgp</code> option to the list of verifications to generate.
However, because there might be verification failures, missing keys or missing signature files, you <strong>must</strong> provide a fallback checksum verification algorithm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --write-verification-metadata pgp,sha256</pre>
</div>
</div>
<div class="paragraph">
<p>this means that Gradle will verify the signatures and fallback to SHA-256 checksums when there&#8217;s a problem.</p>
</div>
<div class="paragraph">
<p>When bootstrapping, Gradle performs <em>optimistic verification</em> and therefore assumes a sane build environment.
It will therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>automatically add the trusted keys as soon as verification passes</p>
</li>
<li>
<p>automatically add ignored keys for keys which couldn&#8217;t be downloaded from public key servers.
See <a href="#sec:add-manual-keyring">here</a> how to manually add keys if needed</p>
</li>
<li>
<p>automatically generate checksums for artifacts without signatures or ignored keys</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If, for some reason, verification fails during the generation, Gradle will automatically generate an ignored key entry but warn you that you must absolutely check what happens.</p>
</div>
<div class="paragraph">
<p>This situation is common as explained for <a href="#sec:trusting-several-checksums">this section</a>: a typical case is when the POM file for a dependency differs from one repository to the other (often in a non-meaningful way).</p>
</div>
<div class="paragraph">
<p>In addition, Gradle will try to group keys automatically and generate the <code>trusted-keys</code> block which reduced the configuration file size as much as possible.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:local-keyring-only"><a class="anchor" href="#sec:local-keyring-only"></a><a class="link" href="#sec:local-keyring-only">Forcing use of local keyrings only</a></h4>
<div class="paragraph">
<p>The local keyring files (<code>.gpg</code> or <code>.keys</code>) can be used to avoid reaching out to key servers whenever a key is required to verify an artifact.
However, it may be that the local keyring doesn&#8217;t contain a key, in which case Gradle would use the key servers to fetch the missing key.
If the local keyring file isn&#8217;t regularly updated, using <a href="#sec:local-keyring">key export</a>, then it may be that your CI builds, for example, would reach out to key servers too often (especially if you use disposable containers for builds).</p>
</div>
<div class="paragraph">
<p>To avoid this, Gradle offers the ability to disallow use of key servers altogether: only the local keyring file would be used, and if a key is missing from this file, the build will fail.</p>
</div>
<div class="paragraph">
<p>To enable this mode, you need to disable key servers in the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;key-servers enabled="false"/&gt;
      ...
   &lt;/configuration&gt;
   ...
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are asking Gradle to <a href="#sec:bootstrapping-verification">generate a verification metadata file</a> and that an existing verification metadata file sets <code>enabled</code> to <code>false</code>, then this flag will be ignored, so that potentially missing keys are downloaded.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling-verification"><a class="anchor" href="#sec:disabling-verification"></a><a class="link" href="#sec:disabling-verification">Disabling verification or making it lenient</a></h4>
<div class="paragraph">
<p>Dependency verification can be expensive, or sometimes verification could get in the way of day to day development (because of frequent dependency upgrades, for example).</p>
</div>
<div class="paragraph">
<p>Alternatively, you might want to enable verification on CI servers but not on local machines.</p>
</div>
<div class="paragraph">
<p>Gradle actually provides 3 different verification modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>strict</code>, which is the default.
Verification fails <em>as early as possible</em>, in order to avoid the use of compromised dependencies during the build.</p>
</li>
<li>
<p><code>lenient</code>, which will run the build even if there are verification failures.
The verification errors will be displayed during the build without causing a build failure.</p>
</li>
<li>
<p><code>off</code> when verification is totally ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All those modes can be activated on the CLI using the <code>--dependency-verification</code> flag, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew --dependency-verification lenient build</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can set the <code>org.gradle.dependency.verification</code> system property, either on the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew -Dorg.gradle.dependency.verification=lenient build</pre>
</div>
</div>
<div class="paragraph">
<p>or in a <code>gradle.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.dependency.verification=lenient</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:disabling-specific-verification"><a class="anchor" href="#sub:disabling-specific-verification"></a><a class="link" href="#sub:disabling-specific-verification">Disabling dependency verification for some configurations only</a></h4>
<div class="paragraph">
<p>In order to provide the strongest security level possible, dependency verification is enabled globally.
This will ensure, for example, that you trust all the plugins you use.
However, the plugins themselves may need to resolve additional dependencies that it doesn&#8217;t make sense to ask the user to accept.
For this purpose, Gradle provides an API which allows <em>disabling dependency verification on some specific configurations</em>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Disabling dependency verification, if you care about security, is not a good idea.
This API mostly exist for cases where it doesn&#8217;t make sense to check dependencies.
However, in order to be on the safe side, Gradle will systematically print a warning whenever verification has been disabled for a specific configuration.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an example, a plugin may want to check if there are <em>newer</em> versions of a library available and list those versions.
It doesn&#8217;t make sense, in this context, to ask the user to put the checksums of the POM files of the newer releases because by definition, they don&#8217;t know about them.
So the plugin might need to run its code <em>independently of the dependency verification configuration</em>.</p>
</div>
<div class="paragraph">
<p>To do this, you need to call the <code>ResolutionStrategy#disableDependencyVerification</code> method:</p>
</div>
<div id="ex-disabling-dependency-verification" class="exampleblock">
<div class="title">Example 16. <a href="#ex-disabling-dependency-verification">Disabling dependency verification</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    "myPluginClasspath" {
        resolutionStrategy {
            disableDependencyVerification()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    myPluginClasspath {
        resolutionStrategy {
            disableDependencyVerification()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to disable verification on detached configurations like in the following example:</p>
</div>
<div id="ex-disabling-dependency-verification" class="exampleblock">
<div class="title">Example 17. <a href="#ex-disabling-dependency-verification">Disabling dependency verification</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("checkDetachedDependencies") {
    val detachedConf: FileCollection = configurations.detachedConfiguration(dependencies.create("org.apache.commons:commons-lang3:3.3.1")).apply {
        resolutionStrategy.disableDependencyVerification()
    }
    doLast {
        println(detachedConf.files)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("checkDetachedDependencies") {
    def detachedConf = configurations.detachedConfiguration(dependencies.create("org.apache.commons:commons-lang3:3.3.1"))
    detachedConf.resolutionStrategy.disableDependencyVerification()
    doLast {
        println(detachedConf.files)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:trusting-artifacts"><a class="anchor" href="#sec:trusting-artifacts"></a><a class="link" href="#sec:trusting-artifacts">Trusting some particular artifacts</a></h4>
<div class="paragraph">
<p>You might want to trust some artifacts more than others.
For example, it&#8217;s legitimate to think that artifacts produced in your company and found in your internal repository only are safe, but you want to check every external component.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is a typical <em>company policy</em>.
In practice, <strong>nothing</strong> prevents your internal repository from being compromised, so it&#8217;s a good idea to check your internal artifacts too!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For this purpose, Gradle offers a way to automatically trust some artifacts.
You can trust all artifacts in a group by adding this to your configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;trusted-artifacts&gt;
         &lt;trust group="com.mycompany" reason="We trust mycompany artifacts"/&gt;
      &lt;/trusted-artifacts&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means that all components which group is <code>com.mycompany</code> will automatically be trusted.
Trusted means that Gradle will not perform any verification whatsoever.</p>
</div>
<div class="paragraph">
<p>The <code>trust</code> element accepts those attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code>, the group of the artifact to trust</p>
</li>
<li>
<p><code>name</code>, the name of the artifact to trust</p>
</li>
<li>
<p><code>version</code>, the version of the artifact to trust</p>
</li>
<li>
<p><code>file</code>, the name of the artifact <em>file</em> to trust</p>
</li>
<li>
<p><code>regex</code>, a boolean saying if the <code>group</code>, <code>name</code>, <code>version</code> and <code>file</code> attributes need to be interpreted as regular expressions (defaults to <code>false</code>)</p>
</li>
<li>
<p><code>reason</code>, an optional reason, why matched artifacts are trusted</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the example above it means that the trusted artifacts would be artifacts in <code>com.mycompany</code> but not <code>com.mycompany.other</code>.
To trust all artifacts in <code>com.mycompany</code> and all subgroups, you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;verification-metadata xmlns="https://schema.gradle.org/dependency-verification"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="https://schema.gradle.org/dependency-verification https://schema.gradle.org/dependency-verification/dependency-verification-1.3.xsd"&gt;
   &lt;configuration&gt;
      &lt;trusted-artifacts&gt;
         &lt;trust group="^com[.]mycompany($|([.].*))" regex="true" reason="We trust all mycompany artifacts"/&gt;
      &lt;/trusted-artifacts&gt;
   &lt;/configuration&gt;
&lt;/verification-metadata&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:trusting-several-checksums"><a class="anchor" href="#sec:trusting-several-checksums"></a><a class="link" href="#sec:trusting-several-checksums">Trusting multiple checksums for an artifact</a></h4>
<div class="paragraph">
<p>It&#8217;s quite common to have <em>different checksums for the same artifact</em> in the wild.
How is that possible?
Despite progress, it&#8217;s often the case that developers publish, for example, to Maven Central and another repository separately, using different builds.
In general, this is not a problem but sometimes it means that the metadata files would be different (different timestamps, additional whitespaces, &#8230;&#8203;).
Add to this that your build may use several repositories or repository mirrors and it makes it quite likely that a single build can "see" different metadata files for the same component!
In general, it&#8217;s not malicious (but you <strong>must</strong> verify that the artifact is actually correct), so Gradle lets you declare the additional artifact checksums.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">      &lt;component group="org.apache" name="apache" version="13"&gt;
         &lt;artifact name="apache-13.pom"&gt;
            &lt;sha256 value="2fafa38abefe1b40283016f506ba9e844bfcf18713497284264166a5dbf4b95e"&gt;
               &lt;also-trust value="ff513db0361fd41237bef4784968bc15aae478d4ec0a9496f811072ccaf3841d"/&gt;
            &lt;/sha256&gt;
         &lt;/artifact&gt;
      &lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can have as many <code>also-trust</code> entries as needed, but in general you shouldn&#8217;t have more than 2.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping-javadocs"><a class="anchor" href="#sec:skipping-javadocs"></a><a class="link" href="#sec:skipping-javadocs">Skipping Javadocs and sources</a></h4>
<div class="paragraph">
<p>By default Gradle will verify <em>all</em> downloaded artifacts, which includes Javadocs and sources.
In general this is not a problem but you might face an issue with IDEs which automatically try to download them during import: if you didn&#8217;t set the checksums for those too, importing would fail.</p>
</div>
<div class="paragraph">
<p>To avoid this, you can configure Gradle to trust automatically all javadocs/sources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trusted-artifacts&gt;
   &lt;trust file=".*-javadoc[.]jar" regex="true"/&gt;
   &lt;trust file=".*-sources[.]jar" regex="true"/&gt;
&lt;/trusted-artifacts&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:add-manual-keyring"><a class="anchor" href="#sec:add-manual-keyring"></a><a class="link" href="#sec:add-manual-keyring">Adding keys manually to the keyring</a></h4>
<div class="sect4">
<h5 id="sec:add-ascii-keyring"><a class="anchor" href="#sec:add-ascii-keyring"></a><a class="link" href="#sec:add-ascii-keyring">Adding keys to the ASCII-armored keyring</a></h5>
<div class="paragraph">
<p>The added key must be ASCII-armored formatted and can be simply added at the end of the file.
If you already downloaded the key in the right format, you can simply append it to the file.</p>
</div>
<div class="paragraph">
<p>Or you can amend an existing KEYS file by issuing the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gpg --no-default-keyring --keyring /tmp/keyring.gpg --recv-keys 8756c4f765c9ac3cb6b85d62379ce192d401ab61

gpg: keybox '/tmp/keyring.gpg' created
gpg: key 379CE192D401AB61: public key "Bintray (by JFrog) &lt;****&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1

# Write its ASCII-armored version
$ gpg --keyring /tmp/keyring.gpg --export --armor 8756c4f765c9ac3cb6b85d62379ce192d401ab61 &gt;&gt; gradle/verification-keyring.keys</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once done, make sure to run <a href="#sec:verification-update">the generation command again</a> so that the key is processed by Gradle.
This will do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a standard header to the key</p>
</li>
<li>
<p>Rewrite the key using Gradle&#8217;s own format, which trims the key to the bare minimum</p>
</li>
<li>
<p>Move the key to its sorted location, keeping the file reproducible</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:add-binary-keyring"><a class="anchor" href="#sec:add-binary-keyring"></a><a class="link" href="#sec:add-binary-keyring">Adding keys to the binary keyring</a></h5>
<div class="paragraph">
<p>You can add keys to the binary version using GPG, for example issuing the following commands (syntax may depend on the tool you use):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gpg --no-default-keyring --keyring gradle/verification-keyring.gpg --recv-keys 8756c4f765c9ac3cb6b85d62379ce192d401ab61

gpg: keybox 'gradle/verification-keyring.gpg' created
gpg: key 379CE192D401AB61: public key "Bintray (by JFrog) &lt;****&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1

$ gpg --no-default-keyring --keyring gradle/verification-keyring.gpg --recv-keys 6f538074ccebf35f28af9b066a0975f8b1127b83

gpg: key 0729A0AFF8999A87: public key "Kotlin Release &lt;****&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting-verification"><a class="anchor" href="#sec:troubleshooting-verification"></a><a class="link" href="#sec:troubleshooting-verification">Dealing with a verification failure</a></h4>
<div id="sec:dealing-verification-failure" class="paragraph">
<p>Dependency verification can fail in different ways, this section explains how you should deal with the various cases.</p>
</div>
<div class="sect4">
<h5 id="missing_verification_metadata"><a class="anchor" href="#missing_verification_metadata"></a><a class="link" href="#missing_verification_metadata">Missing verification metadata</a></h5>
<div class="paragraph">
<p>The simplest failure you can have is when verification metadata is missing from the dependency verification file.
This is the case for example if you use <a href="#sec:checksum-verification">checksum verification</a>, then you update a dependency and new versions of the dependency (and potentially its transitive dependencies) are brought in.</p>
</div>
<div class="paragraph">
<p>Gradle will tell you what metadata is missing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': checksum is missing from verification metadata.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the missing module group is <code>commons-logging</code>, it&#8217;s artifact name is <code>commons-logging</code> and its version is <code>1.2</code>.
The corresponding artifact is <code>commons-logging-1.2.jar</code> so you need to add the following entry to the verification file:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;component group="commons-logging" name="commons-logging" version="1.2"&gt;
   &lt;artifact name="commons-logging-1.2.jar"&gt;
      &lt;sha256 value="daddea1ea0be0f56978ab3006b8ac92834afeefbd9b7e4e6316fca57df0fa636" origin="official distribution"/&gt;
   &lt;/artifact&gt;
&lt;/component&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can ask Gradle to generate the missing information by using the <a href="#sec:bootstrapping-verification">bootstrapping mechanism</a>: existing information in the metadata file will be preserved, Gradle will only add the missing verification metadata.</p>
</div>
</div>
<div class="sect4">
<h5 id="incorrect_checksums"><a class="anchor" href="#incorrect_checksums"></a><a class="link" href="#incorrect_checksums">Incorrect checksums</a></h5>
<div class="paragraph">
<p>A more problematic issue is when the actual checksum verification fails:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution failed for task ':compileJava'.
&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact commons-logging-1.2.jar (commons-logging:commons-logging:1.2) in repository 'MavenRepo': expected a 'sha256' checksum of '91f7a33096ea69bac2cbaf6d01feb934cac002c48d8c8cfa9c240b40f1ec21df' but was 'daddea1ea0be0f56978ab3006b8ac92834afeefbd9b7e4e6316fca57df0fa636'</pre>
</div>
</div>
<div class="paragraph">
<p>This time, Gradle tells you what dependency is at fault, what was the expected checksum (the one you declared in the verification metadata file) and the one which was actually computed during verification.</p>
</div>
<div class="paragraph">
<p>Such a failure indicates that a <strong>dependency may have been compromised</strong>.
At this stage, you <strong>must</strong> perform manual verification and check what happens.
Several things can happen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a dependency was tampered in the local dependency cache of Gradle.
This is usually harmless: erase the file from the cache and Gradle would redownload the dependency.</p>
</li>
<li>
<p>a dependency is available in multiple sources with slightly different binaries (additional whitespace, &#8230;&#8203;)</p>
<div class="ulist">
<ul>
<li>
<p>please inform the maintainers of the library that they have such an issue</p>
</li>
<li>
<p>you can use <a href="#sec:trusting-several-checksums"><code>also-trust</code></a> to accept the additional checksums</p>
</li>
</ul>
</div>
</li>
<li>
<p>the dependency was compromised</p>
<div class="ulist">
<ul>
<li>
<p>immediately inform the maintainers of the library</p>
</li>
<li>
<p>notify the repository maintainers of the compromised library</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that a variation of a compromised library is often <em>name squatting</em>, when a hacker would use GAV coordinates which <em>look legit</em> but are actually different by one character, or <em>repository shadowing</em>, when a dependency with the official GAV coordinates is published in a malicious repository which comes first in your build.</p>
</div>
</div>
<div class="sect4">
<h5 id="untrusted_signatures"><a class="anchor" href="#untrusted_signatures"></a><a class="link" href="#untrusted_signatures">Untrusted signatures</a></h5>
<div class="paragraph">
<p>If you have signature verification enabled, Gradle will perform verification of the signatures but will not trust them automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) and passed verification but the key isn't in your trusted keys list.</pre>
</div>
</div>
<div class="paragraph">
<p>In this case it means you need to check yourself if the key that was used for verification (and therefore the signature) can be trusted, in which case refer to <a href="#sec:understanding-signature-verification">this section of the documentation</a> to figure out how to declare trusted keys.</p>
</div>
</div>
<div class="sect4">
<h5 id="failed_signature_verification"><a class="anchor" href="#failed_signature_verification"></a><a class="link" href="#failed_signature_verification">Failed signature verification</a></h5>
<div class="paragraph">
<p>If Gradle fails to verify a signature, you will need to take action and verify artifacts manually because this <strong>may indicate a compromised dependency</strong>.</p>
</div>
<div class="paragraph">
<p>If such a thing happens, Gradle will fail with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact javaparser-core-3.6.11.jar (com.github.javaparser:javaparser-core:3.6.11) in repository 'MavenRepo': Artifact was signed with key '379ce192d401ab61' (Bintray (by JFrog) &lt;****&gt;) but signature didn't match</pre>
</div>
</div>
<div class="paragraph">
<p>There are several options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>signature was wrong in the first place, which happens frequently with <a href="#sec:trusting-several-checksums">dependencies published on different repositories</a>.</p>
</li>
<li>
<p>the signature is correct but the artifact has been compromised (either in the local dependency cache or remotely)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The right approach here is to go to the official site of the dependency and see if they publish signatures for their artifacts.
If they do, verify that the signature that Gradle downloaded matches the one published.</p>
</div>
<div class="paragraph">
<p>If you have <a href="#sec:manual-checking-dependency">checked that the dependency is <em>not</em> compromised</a> and that it&#8217;s "only" the signature which is wrong, you should declare an <em>artifact level key exclusion</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">   &lt;components&gt;
       &lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
          &lt;artifact name="javaparser-core-3.6.11.pom"&gt;
             &lt;ignored-keys&gt;
                &lt;ignored-key id="379ce192d401ab61" reason="internal repo has corrupted POM"/&gt;
             &lt;/ignored-keys&gt;
          &lt;/artifact&gt;
       &lt;/component&gt;
   &lt;/components&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if you only do so, Gradle will still fail because all keys for this artifact will be ignored and you didn&#8217;t provide a checksum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">   &lt;components&gt;
       &lt;component group="com.github.javaparser" name="javaparser-core" version="3.6.11"&gt;
          &lt;artifact name="javaparser-core-3.6.11.pom"&gt;
             &lt;ignored-keys&gt;
                &lt;ignored-key id="379ce192d401ab61" reason="internal repo has corrupted POM"/&gt;
             &lt;/ignored-keys&gt;
             &lt;sha256 value="a2023504cfd611332177f96358b6f6db26e43d96e8ef4cff59b0f5a2bee3c1e1"/&gt;
          &lt;/artifact&gt;
       &lt;/component&gt;
   &lt;/components&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:manual-checking-dependency"><a class="anchor" href="#sec:manual-checking-dependency"></a><a class="link" href="#sec:manual-checking-dependency">Manual verification of a dependency</a></h5>
<div class="paragraph">
<p>You will likely face a dependency verification failure (either checksum verification or signature verification) and will need to figure out if the dependency has been compromised or not.</p>
</div>
<div class="paragraph">
<p>In this section we give <em>an example</em> how you can manually check if a dependency was compromised.</p>
</div>
<div class="paragraph">
<p>For this we will take this example failure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
- On artifact j2objc-annotations-1.1.jar (com.google.j2objc:j2objc-annotations:1.1) in repository 'MyCompany Mirror': Artifact was signed with key '29579f18fa8fd93b' but signature didn't match</pre>
</div>
</div>
<div class="paragraph">
<p>This error message gives us the GAV coordinates of the problematic dependency, as well as an indication of where the dependency was fetched from.
Here, the dependency comes from <code>MyCompany Mirror</code>, which is a repository declared in our build.</p>
</div>
<div class="paragraph">
<p>The first thing to do is therefore to download the artifact and its signature manually from the mirror:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar --output j2objc-annotations-1.1.jar
$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar.asc --output j2objc-annotations-1.1.jar.asc</pre>
</div>
</div>
<div class="paragraph">
<p>Then we can use the key information provided in the error message to import the key locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --recv-keys B801E2F8EF035068EC1139CC29579F18FA8FD93B</pre>
</div>
</div>
<div class="paragraph">
<p>And perform verification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --verify j2objc-annotations-1.1.jar.asc
gpg: assuming signed data in 'j2objc-annotations-1.1.jar'
gpg: Signature made Thu 19 Jan 2017 12:06:51 AM CET
gpg:                using RSA key 29579F18FA8FD93B
gpg: BAD signature from "Tom Ball &lt;****&gt;" [unknown]</pre>
</div>
</div>
<div class="paragraph">
<p>What this tells us is that the problem is <em>not</em> on the local machine: the repository <em>already contains a bad signature</em>.</p>
</div>
<div class="paragraph">
<p>The next step is to do the same by downloading what is actually on Maven Central:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1.1/j2objc-annotations-1.1.jar  --output central-j2objc-annotations-1.1.jar
$ curl https://my-company-mirror.com/repo/com/google/j2objc/j2objc-annotations/1/1/j2objc-annotations-1.1.jar.asc  --output central-j2objc-annotations-1.1.jar.asc</pre>
</div>
</div>
<div class="paragraph">
<p>And we can now check the signature again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gpg --verify central-j2objc-annotations-1.1.jar.asc

gpg: assuming signed data in 'central-j2objc-annotations-1.1.jar'
gpg: Signature made Thu 19 Jan 2017 12:06:51 AM CET
gpg:                using RSA key 29579F18FA8FD93B
gpg: Good signature from "Tom Ball &lt;****&gt;" [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: B801 E2F8 EF03 5068 EC11  39CC 2957 9F18 FA8F D93B</pre>
</div>
</div>
<div class="paragraph">
<p>This indicates that the dependency is <em>valid</em> on Maven Central.
At this stage, we already know that the problem lives in the mirror, it <em>may</em> have been compromised, but we need to verify.</p>
</div>
<div class="paragraph">
<p>A good idea is to compare the 2 artifacts, which you can do with a tool like <a href="https://try.diffoscope.org/">diffoscope</a>.</p>
</div>
<div class="paragraph">
<p>We then figure out that the intent wasn&#8217;t malicious but that somehow a build has been overwritten with a newer version (the version in Central is newer than the one in our repository).</p>
</div>
<div class="paragraph">
<p>In this case, you can decide to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ignore the signature for this artifact and trust the different possible checksums (both for the old artifact and the new version)</p>
</li>
<li>
<p>or cleanup your mirror so that it contains the same version as in Maven Central</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s worth noting that if you choose to delete the version from your repository, you will <em>also</em> need to remove it from the local Gradle cache.</p>
</div>
<div class="paragraph">
<p>This is facilitated by the fact the error message tells you were the file is located:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Dependency verification failed for configuration ':compileClasspath':
    - On artifact j2objc-annotations-1.1.jar (com.google.j2objc:j2objc-annotations:1.1) in repository 'MyCompany Mirror': Artifact was signed with key '29579f18fa8fd93b' but signature didn't match

  This can indicate that a dependency has been compromised. Please carefully verify the signatures and checksums.

  For your information here are the path to the files which failed verification:
    - $&lt;&lt;directory_layout.adoc#dir:gradle_user_home,GRADLE_USER_HOME&gt;&gt;/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1/976d8d30bebc251db406f2bdb3eb01962b5685b3/j2objc-annotations-1.1.jar (signature: GRADLE_USER_HOME/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1/82e922e14f57d522de465fd144ec26eb7da44501/j2objc-annotations-1.1.jar.asc)

  GRADLE_USER_HOME = /home/jiraya/.gradle</pre>
</div>
</div>
<div class="paragraph">
<p>You can safely delete the artifact file as Gradle would automatically re-download it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rm -rf ~/.gradle/caches/modules-2/files-2.1/com.google.j2objc/j2objc-annotations/1.1</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:verification-metadata-hygiene"><a class="anchor" href="#sec:verification-metadata-hygiene"></a><a class="link" href="#sec:verification-metadata-hygiene">Cleaning up the verification file</a></h4>
<div class="paragraph">
<p>If you do nothing, the dependency verification metadata will grow over time as you add new dependencies or change versions: Gradle will not automatically remove <em>unused</em> entries from this file.
The reason is that there&#8217;s no way for Gradle to know upfront if a dependency will effectively be used during the build or not.</p>
</div>
<div class="paragraph">
<p>As a consequence, adding dependencies or changing dependency version can easily lead to more entries in the file, while leaving unnecessary entries out there.</p>
</div>
<div class="paragraph">
<p>One option to cleanup the file is to move the existing <code>verification-metadata.xml</code> file to a different location and call Gradle with the <a href="#sec:verification-dry-mode"><code>--dry-run</code> mode</a>: while not perfect (it will not notice dependencies only resolved at configuration time), it generates <em>a new file</em> that you can compare with the existing one.</p>
</div>
<div class="paragraph">
<p>We need to move the existing file because both the bootstrapping mode and the dry-run mode are incremental: they copy information from the existing metadata verification file (in particular, trusted keys).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:refreshing-missing-keys"><a class="anchor" href="#sec:refreshing-missing-keys"></a><a class="link" href="#sec:refreshing-missing-keys">Refreshing missing keys</a></h4>
<div class="paragraph">
<p>Gradle caches missing keys for 24 hours, meaning it will not attempt to re-download the missing keys for 24 hours after failing.</p>
</div>
<div class="paragraph">
<p>If you want to retry immediately, you can run with the <code>--refresh-keys</code> CLI flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./gradlew build --refresh-keys</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#sec:add-manual-keyring">here</a> how to manually add keys if Gradle keeps failing to download them.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="declaring_repositories"><a class="anchor" href="#declaring_repositories"></a><a class="link" href="#declaring_repositories">DECLARING REPOSITORIES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="declaring-repositories-basics"><a class="anchor" href="#declaring-repositories-basics"></a><a class="link" href="#declaring-repositories-basics">Declaring Repositories Basics</a></h3>
<div class="paragraph">
<p>Gradle can resolve local or external dependencies from one or many repositories based on Maven, Ivy or flat directory formats.</p>
</div>
<div class="paragraph">
<p>Repositories intended for use in a single project are declared in your <code>build.gradle(.kts)</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
    maven {
        url = uri("https://repo.spring.io/snapshot/")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
    maven {
        url = 'https://repo.spring.io/snapshot/'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To centralize repository declarations in your <code>settings.gradle(.kts)</code> file, head over to <a href="#centralized-repository-declaration">Centralizing Repository Declarations</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring-public-repository"><a class="anchor" href="#sec:declaring-public-repository"></a><a class="link" href="#sec:declaring-public-repository">Declaring a publicly-available repository</a></h4>
<div class="paragraph">
<p>Organizations building software may want to leverage public binary repositories to download and consume publicly available dependencies.
Popular public repositories include <a href="#sec:maven-central">Maven Central</a> and the <a href="#sec:maven-google">Google Android</a> repository.</p>
</div>
<div class="paragraph">
<p>Gradle provides built-in shorthand notations for these widely-used repositories.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-shortcut-repositories.png" alt="dependency management shortcut repositories">
</div>
</div>
<div class="paragraph">
<p>Under the covers, Gradle resolves dependencies from the respective URL of the public repository defined by the shorthand notation.
All shorthand notations are available via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can <a href="#sec:declaring-custom-repository">explicitly specify the URL of the repository</a> for more fine-grained control.</p>
</div>
<div class="sect4">
<h5 id="sec:maven-central"><a class="anchor" href="#sec:maven-central"></a><a class="link" href="#sec:maven-central">Maven Central repository</a></h5>
<div class="paragraph">
<p>Maven Central is a popular repository hosting open source libraries for consumption by Java projects.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://repo.maven.apache.org/maven2/">Maven Central repository</a> for your build add this to your script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:maven-google"><a class="anchor" href="#sec:maven-google"></a><a class="link" href="#sec:maven-google">Google Maven repository</a></h5>
<div class="paragraph">
<p>The Google repository hosts Android-specific artifacts including the Android SDK. For usage examples, see the <a href="https://developer.android.com/studio/build/dependencies.html#google-maven">relevant Android documentation</a>.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://maven.google.com/">Google Maven repository</a> add this to your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    google()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    google()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-custom-repository"><a class="anchor" href="#sec:declaring-custom-repository"></a><a class="link" href="#sec:declaring-custom-repository">Declaring a custom repository by URL</a></h4>
<div class="paragraph">
<p>Most enterprise projects set up a binary repository available only within an intranet.
In-house repositories enable teams to publish internal binaries, setup user management and security measures, and ensure uptime and availability.</p>
</div>
<div class="paragraph">
<p>Specifying a custom URL is also helpful if you want to declare publicly-available repository that Gradle does not provide a shorthand for.</p>
</div>
<div class="paragraph">
<p>Repositories with custom URLs can be specified as Maven or Ivy repositories by calling the corresponding methods available on the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/maven2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle supports additional <a href="#supported-transport-protocols">protocols</a> beyond <code>http</code> and <code>https</code>, such as <code>file</code>, <code>sftp</code>, and <code>s3</code> for custom URLs.</p>
</div>
<div class="paragraph">
<p>For full coverage, see the section on <a href="#repository-types">supported repository types</a>.</p>
</div>
<div class="paragraph">
<p>You can also <a href="#sec:defining-custom-pattern-layout-for-an-ivy-repository">define your own repository layout</a> by using <code>ivy { }</code> repositories, as they are very flexible in terms of how modules are organised in a repository:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-local-repositories"><a class="anchor" href="#sec:declaring-local-repositories"></a><a class="link" href="#sec:declaring-local-repositories">Declaring a local repository</a></h4>
<div class="paragraph">
<p>You can declare local repositories using the <code>mavenLocal()</code> or <code>flatDir</code> methods inside the repositories block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenLocal()  // Uses the local Maven repository (~/.m2/repository)
    maven {
        url = uri("/path/to/local/repo")  // Replace with your actual local repo path
    }
    flatDir {
        dirs 'libs'  // Assumes JARs are in the 'libs' directory
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Maven or Ivy can be declared as local repositories by specifying a local filesystem path. Unlike a flat directory repository, they adhere to a structured format and include metadata.</p>
</div>
<div class="paragraph">
<p>When such a repository is configured, Gradle completely bypasses its dependency cache for it, as there is no guarantee that the content will remain unchanged between executions. This limitation can negatively impact performance.</p>
</div>
<div class="paragraph">
<p>Additionally, using local Maven or Ivy repositories makes build reproducibility much harder to achieve.
Therefore, their use should be restricted to prototyping rather than production builds.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-multiple-repositories"><a class="anchor" href="#sec:declaring-multiple-repositories"></a><a class="link" href="#sec:declaring-multiple-repositories">Declaring multiple repositories</a></h4>
<div class="paragraph">
<p>You can define more than one repository for resolving dependencies.
Declaring multiple repositories is helpful if some dependencies are only available in one repository but not the other.</p>
</div>
<div class="paragraph">
<p>You can mix any type of repository described in the <a href="#repository-types">reference section</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
    maven {
        url = uri("https://repo.spring.io/release")
    }
    maven {
        url = uri("https://repository.jboss.org/maven2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
    maven {
        url = "https://repo.spring.io/release"
    }
    maven {
        url = "https://repository.jboss.org/maven2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The order of repository declaration determines the order that Gradle will search for dependencies during resolution.
If Gradle finds a dependency&#8217;s metadata in a particular repository, it will attempt to download all the artifacts for that module from <em>the same repository</em>.</p>
</div>
<div class="paragraph">
<p>You can learn more about the inner workings of <a href="graph_resolution.html#sec:how-gradle-downloads-deps">dependency downloads</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:plugin-repos"><a class="anchor" href="#sec:plugin-repos"></a><a class="link" href="#sec:plugin-repos">Declaring plugin repositories</a></h4>
<div id="sec:plugin-vs-build-repos" class="paragraph">
<p>Gradle uses a different set of repositories for resolving Gradle plugins and resolving project dependencies:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Plugin dependencies:</strong> When resolving plugins for build scripts, Gradle uses a distinct set of repositories to locate and load the required plugins.</p>
</li>
<li>
<p><strong>Project dependencies:</strong> When resolving project dependencies, Gradle only uses the repositories declared in the build script and ignores the plugin repositories.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>By default, Gradle uses the <a href="http://plugins.gradle.org">Gradle Plugin Portal</a> to search for plugins:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">pluginManagement {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">pluginManagement {
    repositories {
        mavenCentral()
        gradlePluginPortal()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, some plugins may be hosted in other repositories (public or private).
To include these plugins, you need to specify additional repositories in your build script so Gradle knows where to search.</p>
</div>
<div class="paragraph">
<p>Since declaring repositories depends on how the plugin is applied, refer to the <a href="plugins_intermediate.html#sec:custom_plugin_repositories">Custom Plugin Repositories</a> for more details on configuring repositories for plugins from different sources.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="centralized-repository-declaration"><a class="anchor" href="#centralized-repository-declaration"></a><a class="link" href="#centralized-repository-declaration">Centralizing Repository Declarations</a></h3>
<div class="paragraph">
<p>Instead of declaring repositories in every subproject of your build or via an <code>allprojects</code> block, Gradle provides a way to declare them centrally for all projects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Central declaration of repositories is an incubating feature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can declare repositories that will be used by convention in every subproject in the <code>settings.gradle(.kts)</code> file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositories {
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositories {
        mavenCentral()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>dependencyResolutionManagement</code> repositories block accepts the same notations as in a project, including Maven or Ivy repositories, with or without credentials.</p>
</div>
<div class="sect3">
<h4 id="sec:repositories-mode"><a class="anchor" href="#sec:repositories-mode"></a><a class="link" href="#sec:repositories-mode">Repositories mode</a></h4>
<div class="paragraph">
<p>By default, repositories declared in a projects <code>build.gradle(.kts)</code> file will override those declared in <code>settings.gradle(.kts)</code>.
However, you can control this behavior using the <code>repositoriesMode</code> setting:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.PREFER_PROJECT
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.PREFER_PROJECT
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:available-modes"><a class="anchor" href="#sec:available-modes"></a><a class="link" href="#sec:available-modes">Available modes</a></h4>
<div class="paragraph">
<p>There are three modes for dependency resolution management:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default?</th>
<th class="tableblock halign-left valign-top">Use-Case</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PREFER_PROJECT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repositories declared in a project override those declared in <code>settings.gradle(.kts)</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Useful when teams need to use different repositories specific to their subprojects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PREFER_SETTINGS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repositories declared in <code>settings.gradle(.kts)</code> override those declared in a project.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Useful for enforcing the use of approved repositories across large teams.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FAIL_ON_PROJECT_REPOS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring a repository in a project triggers a build error.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strictly enforces the use of repositories declared in <code>settings.gradle(.kts)</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can change the behavior to prefer the repositories in <code>settings.gradle(.kts)</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.PREFER_SETTINGS
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.PREFER_SETTINGS
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="sec:fail-build-on-project-repositories" class="paragraph">
<p>Gradle will warn you if a project or plugin declares a repository when using this mode.</p>
</div>
<div class="paragraph">
<p>To enforce that <strong>only</strong> repositories declared in <code>settings.gradle(.kts)</code> are used, you can configure Gradle to fail the build when a project plugin is declared:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.FAIL_ON_PROJECT_REPOS
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.FAIL_ON_PROJECT_REPOS
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="repository-types"><a class="anchor" href="#repository-types"></a><a class="link" href="#repository-types">Repository Types</a></h3>
<div class="paragraph">
<p>Gradle supports various sources for resolving dependencies, accommodating different metadata formats and connectivity methods.
You can resolve dependencies from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:maven-repo">Maven-compatible artifact repositories</a> (e.g., Maven Central)</p>
</li>
<li>
<p><a href="#sec:ivy-repositories">Ivy-compatible artifact repositories</a> (including custom layouts)</p>
</li>
<li>
<p><a href="#sec:flat-dir-resolver">Local (flat) directories</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec:maven-repo"><a class="anchor" href="#sec:maven-repo"></a><a class="link" href="#sec:maven-repo">Maven repositories</a></h4>
<div class="paragraph">
<p>Many organizations host dependencies in Maven repositories.
Gradle can declare Maven repositories by specifying their URL:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/maven2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:custom-maven-repo"><a class="anchor" href="#sec:custom-maven-repo"></a><a class="link" href="#sec:custom-maven-repo">Composite Maven repository</a></h5>
<div class="paragraph">
<p>Sometimes, POMs are published in one location, and JARs in another.
You can define such a repository as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        // Look for POMs and artifacts, such as JARs, here
        url = uri("http://repo2.mycompany.com/maven2")
        // Look for artifacts here if not found at the above location
        artifactUrls("http://repo.mycompany.com/jars")
        artifactUrls("http://repo.mycompany.com/jars2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        // Look for POMs and artifacts, such as JARs, here
        url = "http://repo2.mycompany.com/maven2"
        // Look for artifacts here if not found at the above location
        artifactUrls "http://repo.mycompany.com/jars"
        artifactUrls "http://repo.mycompany.com/jars2"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle will first look for POMs and artifacts at the base URL, and if the artifact is not found, it will check the additional <code>artifactUrls</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="strict_limitation_to_declared_repositories"><a class="anchor" href="#strict_limitation_to_declared_repositories"></a><a class="link" href="#strict_limitation_to_declared_repositories">Strict limitation for Maven repositories</a></h5>
<div class="paragraph">
<p>Maven POM metadata can specify additional repositories, but Gradle ignores them.
Instead, Gradle strictly uses only the repositories declared in the build script.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This serves as both a reproducibility safeguard and a security measure.
Without this restriction, an updated dependency version could unexpectedly introduce artifacts from unverified sources into your build.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:accessing_secured_maven_repositories"><a class="anchor" href="#sec:accessing_secured_maven_repositories"></a><a class="link" href="#sec:accessing_secured_maven_repositories">Authenticated Maven repository</a></h5>
<div class="paragraph">
<p>You can specify credentials for Maven repositories that require authentication.
See <a href="#supported-transport-protocols">Supported Repository Protocols</a> for authentication options.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:maven-local"><a class="anchor" href="#sec:maven-local"></a><a class="link" href="#sec:maven-local">Local Maven repository</a></h5>
<div class="paragraph">
<p>Gradle can consume dependencies from a local Maven repository, that is repositories on the local file system:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri(layout.buildDirectory.dir("repo"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = uri(layout.buildDirectory.dir("repo"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle can consume dependencies from the <a href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html">local Maven repository</a>.
This is useful for teams that want to test their setup locally before publishing their plugin.</p>
</div>
<div class="paragraph">
<p>You should ensure that using the local Maven repository is necessary before adding <code>mavenLocal()</code> to your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenLocal()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenLocal()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle manages its own <a href="#sec:dependency-cache">cache</a> and doesn&#8217;t need to declare the local Maven repository even if you resolve dependencies from a remote Maven repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle uses the same logic as Maven to identify the location of your local Maven cache.
If a <code>settings.xml</code> file is defined in the users home directory (<code>~/.m2/settings.xml</code>), this location takes precedence over <code><em>M2_HOME</em>/conf</code>
Otherwise, Gradle defaults to <code>~/.m2/repository</code>.</p>
</div>
<div class="sect5">
<h6 id="sec:case-for-maven-local"><a class="anchor" href="#sec:case-for-maven-local"></a><a class="link" href="#sec:case-for-maven-local">The case against <code>mavenLocal()</code></a></h6>
<div class="paragraph">
<p>As a general rule, you should avoid adding <code>mavenLocal()</code> as a repository in your Gradle builds.
There are several issues with relying on it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Not a true repository, just a cache</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Maven treats <code>mavenLocal()</code> as a cache, not a reliable repository.</p>
</li>
<li>
<p>It may contain incomplete modulesfor example, missing sources or Javadoc filesleading to issues in Gradle when resolving dependencies.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Trust and security issues</strong></p>
<div class="ulist">
<ul>
<li>
<p>Gradle does <strong>not</strong> trust local repositories because artifacts origins cannot be verified.</p>
</li>
<li>
<p>Dependencies can be easily overwritten, creating risks for <strong>security, correctness, and reproducibility</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Performance degradation</strong></p>
<div class="ulist">
<ul>
<li>
<p>Since metadata and artifacts can change at any time (see item 2), Gradle <strong>disables caching</strong> for local repositories.</p>
</li>
<li>
<p>This results in <strong>slower builds</strong>especially when <code>mavenLocal()</code> is declared <strong>before remote repositories</strong>, as Gradle checks it first.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Despite its drawbacks, there are rare cases where <code>mavenLocal()</code> can be useful:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Interoperability with Maven</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Example: If <strong>Project A (Maven)</strong> and <strong>Project B (Gradle)</strong> share artifacts during development, <code>mavenLocal()</code> can act as a temporary bridge.</p>
</li>
<li>
<p>Prefer an internal repository instead, but if thats not feasible, limit <code>mavenLocal()</code> to local builds only.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Interoperability with Gradle (Multi-Repo Development)</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Example: If you need to validate that <strong>Project As changes work with Project B</strong>, <code>mavenLocal()</code> might be used.</p>
</li>
<li>
<p>Prefer composite builds for better dependency resolution.</p>
</li>
<li>
<p>Only use <code>mavenLocal()</code> as a last resort.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To mitigate risks, consider restricting <code>mavenLocal()</code> to specific dependencies using a repository filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenLocal {
        content {
            includeGroup("com.example.myproject") // Only allow this group from mavenLocal
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures that <code>mavenLocal()</code> is only used for expected dependencies and avoids unexpected resolution issues.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ivy-repositories"><a class="anchor" href="#sec:ivy-repositories"></a><a class="link" href="#sec:ivy-repositories">Ivy repositories</a></h4>
<div class="paragraph">
<p>Many organizations host dependencies in Ivy repositories.</p>
</div>
<div class="sect4">
<h5 id="sec:defining-an-ivy-repository-with-a-standard-layout"><a class="anchor" href="#sec:defining-an-ivy-repository-with-a-standard-layout"></a><a class="link" href="#sec:defining-an-ivy-repository-with-a-standard-layout">Standard layout Ivy repository</a></h5>
<div class="paragraph">
<p>To declare an Ivy repository with the standard layout, simply specify the URL:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining-a-named-layout-for-an-ivy-repository"><a class="anchor" href="#sec:defining-a-named-layout-for-an-ivy-repository"></a><a class="link" href="#sec:defining-a-named-layout-for-an-ivy-repository">Named layout Ivy repository</a></h5>
<div class="paragraph">
<p>You can specify that your repository follows the Ivy default layout:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        layout("maven")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
        layout "maven"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Valid named layout values are <code>gradle</code> (default), <code>maven</code>, and <code>ivy</code>.
Refer to <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html#org.gradle.api.artifacts.repositories.IvyArtifactRepository:layout(java.lang.String)">IvyArtifactRepository.layout(java.lang.String)</a> in the API documentation for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining-custom-pattern-layout-for-an-ivy-repository"><a class="anchor" href="#sec:defining-custom-pattern-layout-for-an-ivy-repository"></a><a class="link" href="#sec:defining-custom-pattern-layout-for-an-ivy-repository">Custom pattern layout Ivy repository</a></h5>
<div class="paragraph">
<p>To define an Ivy repository with a non-standard layout, you can set up a pattern layout:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("[module]/[revision]/[type]/[artifact].[ext]")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "[module]/[revision]/[type]/[artifact].[ext]"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For an Ivy repository that fetches Ivy files and artifacts from different locations, define separate patterns:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("3rd-party-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            artifact("company-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            ivy("ivy-files/[organisation]/[module]/[revision]/ivy.xml")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "3rd-party-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            artifact "company-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            ivy "ivy-files/[organisation]/[module]/[revision]/ivy.xml"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Optionally, you can enable Maven-style layout for the 'organisation' part, with forward slashes replacing dots:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        patternLayout {
            artifact("[organisation]/[module]/[revision]/[artifact]-[revision].[ext]")
            setM2compatible(true)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
        patternLayout {
            artifact "[organisation]/[module]/[revision]/[artifact]-[revision].[ext]"
            m2compatible = true
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:accessing-secured-ivy-repositories"><a class="anchor" href="#sec:accessing-secured-ivy-repositories"></a><a class="link" href="#sec:accessing-secured-ivy-repositories">Authenticated Ivy repository</a></h5>
<div class="paragraph">
<p>You can specify credentials for Ivy repositories that require authentication.
See <a href="#supported-transport-protocols">Supported Repository Protocols</a> for authentication options.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:ivy-local"><a class="anchor" href="#sec:ivy-local"></a><a class="link" href="#sec:ivy-local">Local Ivy repository</a></h5>
<div class="paragraph">
<p>Gradle can consume dependencies from a local Ivy repository, that is repositories on the local file system:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        // URL can refer to a local directory
        url = uri("../local-repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        // URL can refer to a local directory
        url = file("../local-repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:flat-dir-resolver"><a class="anchor" href="#sec:flat-dir-resolver"></a><a class="link" href="#sec:flat-dir-resolver">Flat directory repository</a></h4>
<div class="paragraph">
<p>Some projects store dependencies on a shared drive or within the projects source code rather than using a binary repository.
To use a flat filesystem directory as a repository, you can configure it like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    flatDir {
        dirs("lib")
    }
    flatDir {
        dirs("lib1", "lib2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    flatDir {
        dirs 'lib'
    }
    flatDir {
        dirs 'lib1', 'lib2'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This configuration adds repositories that search specified directories for dependencies.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Flat directory repositories are discouraged, as they do not support metadata formats like Ivy XML or Maven POM files.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In general, binary dependencies should be sourced from an external repository, but if storing dependencies externally is not an option, prefer declaring a Maven or Ivy repository using a local file URL instead.</p>
</div>
<div class="paragraph">
<p>When resolving dependencies from a flat dir repo, Gradle dynamically generates adhoc dependency metadata based on the presence of artifacts.
Gradle prefers modules with real metadata over those generated by flat directory repositories.
For this reason, flat directories cannot override artifacts with real metadata from other declared repositories.</p>
</div>
<div class="paragraph">
<p>For instance, if Gradle finds <code>jmxri-1.2.1.jar</code> in a flat directory and <code>jmxri-1.2.1.pom</code> in another repository, it will use the metadata from the latter.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="metadata-formats"><a class="anchor" href="#metadata-formats"></a><a class="link" href="#metadata-formats">Metadata Formats</a></h3>
<div class="paragraph">
<p>Dependency metadata refers to the information associated with a dependency that describes its characteristics, relationships, and requirements.</p>
</div>
<div class="paragraph">
<p>This metadata includes details such as:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Identity</strong>: Module dependencies are uniquely identified by their group, name, and version (GAV) coordinates.</p>
</li>
<li>
<p><strong>Dependencies</strong>: A list of other binaries that this dependency requires, including their versions.</p>
</li>
<li>
<p><strong>Variants</strong>: Different forms of the component (e.g., compile, runtime, apiElements, runtimeElements) that can be consumed in different contexts.</p>
</li>
<li>
<p><strong>Artifacts</strong>: The actual files (like JARs, ZIPs, etc.) produced by the component, which may include compiled code, resources, or documentation.</p>
</li>
<li>
<p><strong>Capabilities</strong>: Describes the functionality or features that a module provides or consumes, helping to avoid conflicts when different modules provide the same capability.</p>
</li>
<li>
<p><strong>Attributes</strong>: Key-value pairs used to differentiate between variants (e.g. <code>org.gradle.jvm.version:8</code>).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Depending on the repository type, dependency metadata are stored in different formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Gradle:</strong> Gradle Module Metadata (<code>.module</code>) files</p>
</li>
<li>
<p><strong>Maven:</strong> Maven POM (<code>pom.xml</code>) files</p>
</li>
<li>
<p><strong>Ivy:</strong> Ivy Descriptor (<code>ivy.xml</code>) files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some repositories may contain multiple types of metadata for a single component.
When Gradle publishes to a Maven repository, it publishes both a Gradle Module Metadata (GMM) files and a Maven POM file.</p>
</div>
<div class="paragraph">
<p>This metadata plays a crucial role in dependency resolution, by allowing the dependencies of binary artifacts to be tracked alongside the artifact itself.
By reading dependency metadata, Gradle is able to determine which versions of other artifacts a given dependency requires.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
In Maven, a module can have <strong>one and only one artifact</strong>. In Gradle and Ivy, a module can have <strong>multiple artifacts</strong>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:supported-metadata-formats"><a class="anchor" href="#sec:supported-metadata-formats"></a><a class="link" href="#sec:supported-metadata-formats">Supported metadata formats</a></h4>
<div class="paragraph">
<p>External module dependencies require module metadata so that Gradle can determine the transitive dependencies of a module.
Gradle supports various metadata formats to achieve this.</p>
</div>
<div class="sect4">
<h5 id="sec:supported-md-gradle"><a class="anchor" href="#sec:supported-md-gradle"></a><a class="link" href="#sec:supported-md-gradle">Gradle Module Metadata (GMM) files</a></h5>
<div class="paragraph">
<p>Gradle Module Metadata is specifically designed to support all features of Gradle&#8217;s dependency management model, making it the preferred format.</p>
</div>
<div class="paragraph">
<p>You can find the <a href="https://github.com/gradle/gradle/blob/master/platforms/documentation/docs/src/docs/design/gradle-module-metadata-latest-specification.md">specification here</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "formatVersion": "1.1",
  "component": {
    "group": "com.example",
    "module": "my-library",
    "version": "1.0"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:supported-md-pom"><a class="anchor" href="#sec:supported-md-pom"></a><a class="link" href="#sec:supported-md-pom">POM files</a></h5>
<div class="paragraph">
<p>Gradle natively supports <a href="https://maven.apache.org/pom.html">Maven POM files</a>.
By default, Gradle will first look for a POM file.
However, if the file contains a special marker, Gradle will use <a href="#sec:supported-md-gradle">Gradle Module Metadata</a> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.example&lt;/groupId&gt;
  &lt;artifactId&gt;my-library&lt;/artifactId&gt;
  &lt;version&gt;1.0&lt;/version&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:supported-md-ivy"><a class="anchor" href="#sec:supported-md-ivy"></a><a class="link" href="#sec:supported-md-ivy">Ivy files</a></h5>
<div class="paragraph">
<p>Gradle also supports <a href="http://ant.apache.org/ivy/">Ivy descriptor files</a>.
Gradle will first look for an <code>ivy.xml</code> file, but if this file contains a special marker, it will use <a href="#sec:supported-md-gradle">Gradle Module Metadata</a> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;ivy-module version="2.0"&gt;
  &lt;info organisation="com.example" module="my-library" revision="1.0"/&gt;
  &lt;dependencies&gt;
    &lt;dependency org="org.example" name="dependency" rev="1.2"/&gt;
  &lt;/dependencies&gt;
&lt;/ivy-module&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:supported-metadata-sources"><a class="anchor" href="#sec:supported-metadata-sources"></a><a class="link" href="#sec:supported-metadata-sources">Supported metadata sources</a></h4>
<div class="paragraph">
<p>When searching for a component in a repository, Gradle checks for supported metadata file formats by default:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle first looks for <code>.module</code> (Gradle module metadata) files.</p>
</li>
<li>
<p>In a Maven repository, Gradle then looks for <code>.pom</code> files.</p>
</li>
<li>
<p>In an Ivy repository, it checks for <code>ivy.xml</code> files.</p>
</li>
<li>
<p>In a flat directory repository, it looks directly for <code>.jar</code> files without expecting any metadata.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you define a custom repository, you can configure how Gradle searches for metadata.
For instance, you can set up a Maven repository will optionally resolve JARs that don&#8217;t have associated POM files.
This is done by configuring metadata sources for the repository:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/repo")
        metadataSources {
            mavenPom()
            artifact()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/repo"
        metadataSources {
            mavenPom()
            artifact()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can specify multiple metadata sources, and Gradle will search through them in a predefined order.
The following metadata sources are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Order</th>
<th class="tableblock halign-left valign-top">Maven</th>
<th class="tableblock halign-left valign-top">Ivy / flat dir</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradleMetadata()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Gradle <code>.module</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1st</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mavenPom()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Maven <code>.pom</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ivyDescriptor()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for <code>ivy.xml</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>artifact()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look directly for artifact without associated metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3rd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default, Gradle will require that a dependency has associated metadata.</p>
</div>
<div class="paragraph">
<p>To relax this requirement and allow Gradle to resolve artifacts without associated metadata, specify the <code>artifact</code> metadata source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">mavenCentral {
    metadataSources {
        mavenPom()
        artifact()
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example instructs Gradle to first look for component metadata from a POM file, and if not present, to derive metadata from the artifact itself.</p>
</div>
<div class="paragraph">
<p>For example, if you declare a module dependency, Gradle looks for a module metadata file (<code>.module</code>, <code>.pom</code>, or <code>ivy.xml</code>) in the repositories.
If such a module metadata file exists, it is parsed, and the artifacts of this module (e.g., <code>hibernate-3.0.5.jar</code>) as well as its dependencies (e.g., <code>cglib</code>) are downloaded.
If no such module metadata file exists, you need to configure metadata sources definitions to look for an artifact file called <code>hibernate-3.0.5.jar</code> directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url "https://repo.example.com/maven"
        metadataSources {
            mavenPom()   // Look for a POM file
            artifact()   // If no metadata is found, look for JARs directly
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When parsing metadata files (Ivy or Maven), Gradle checks for a marker that indicates the presence of a matching Gradle Module Metadata file.
If found, Gradle will prefer the Gradle metadata.</p>
</div>
<div class="paragraph">
<p>To disable this behavior, use the <code>ignoreGradleMetadataRedirection()</code> option:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/repo")
        metadataSources {
            mavenPom()
            artifact()
            ignoreGradleMetadataRedirection()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/repo"
        metadataSources {
            mavenPom()
            artifact()
            ignoreGradleMetadataRedirection()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="supported-transport-protocols"><a class="anchor" href="#supported-transport-protocols"></a><a class="link" href="#supported-transport-protocols">Supported Protocols</a></h3>
<div class="paragraph">
<p>Gradle supports a variety of transport protocols for Maven and Ivy repositories.</p>
</div>
<div class="sect3">
<h4 id="sec:supported-protocols"><a class="anchor" href="#sec:supported-protocols"></a><a class="link" href="#sec:supported-protocols">Supported transport protocols</a></h4>
<div class="paragraph">
<p>These protocols determine how Gradle communicates with the repositories to resolve dependencies.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 62.5%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Credential types</th>
<th class="tableblock halign-left valign-top">Link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication-schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>https</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication-schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sftp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:authentication-schemes">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>s3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">access key/secret key/session token or Environment variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:s3-repositories">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gcs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/identity/protocols/application-default-credentials">default application credentials</a> sourced from well known files, Environment variables etc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:gcs-repositories">Documentation</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Usernames and passwords should never be stored in plain text in your build files. Instead, store credentials in a local <code>gradle.properties</code> file, or provide the credentials via environment variables.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The transport protocol is specified as part of the repository URL.</p>
</div>
<div class="paragraph">
<p>Below are examples of how to declare repositories using various protocols:</p>
</div>
<div id="ex-declaring-http-based-maven-and-ivy-repositories" class="exampleblock">
<div class="title">Example 18. <a href="#ex-declaring-http-based-maven-and-ivy-repositories">Declaring HTTP-based Maven and Ivy Repositories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
    }

    ivy {
        url = uri("http://repo.mycompany.com/repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/maven2"
    }

    ivy {
        url = "http://repo.mycompany.com/repo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="ex-declaring-an-sftp-protocol-for-a-repository" class="exampleblock">
<div class="title">Example 19. <a href="#ex-declaring-an-sftp-protocol-for-a-repository">Declaring an SFTP Protocol for a Repository</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("sftp://repo.mycompany.com:22/maven2")
        credentials {
            username = "user"
            password = "password"
        }
    }

    ivy {
        url = uri("sftp://repo.mycompany.com:22/repo")
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "sftp://repo.mycompany.com:22/maven2"
        credentials {
            username = "user"
            password = "password"
        }
    }

    ivy {
        url = "sftp://repo.mycompany.com:22/repo"
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="ex-declaring-an-s3-backed-maven-and-ivy-repository" class="exampleblock">
<div class="title">Example 20. <a href="#ex-declaring-an-s3-backed-maven-and-ivy-repository">Declaring an S3-Backed Maven and Ivy Repository</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("s3://myCompanyBucket/maven2")
        credentials(AwsCredentials::class) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }

    ivy {
        url = uri("s3://myCompanyBucket/ivyrepo")
        credentials(AwsCredentials::class) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "s3://myCompanyBucket/maven2"
        credentials(AwsCredentials) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }

    ivy {
        url = "s3://myCompanyBucket/ivyrepo"
        credentials(AwsCredentials) {
            accessKey = "someKey"
            secretKey = "someSecret"
            // optional
            sessionToken = "someSTSToken"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="ex-declaring-an-s3-backed-maven-and-ivy-repository-using-iam" class="exampleblock">
<div class="title">Example 21. <a href="#ex-declaring-an-s3-backed-maven-and-ivy-repository-using-iam">Declaring an S3-Backed Maven and Ivy Repository Using IAM</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("s3://myCompanyBucket/maven2")
        authentication {
            create&lt;AwsImAuthentication&gt;("awsIm") // load from EC2 role or env var
        }
    }

    ivy {
        url = uri("s3://myCompanyBucket/ivyrepo")
        authentication {
            create&lt;AwsImAuthentication&gt;("awsIm")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "s3://myCompanyBucket/maven2"
        authentication {
           awsIm(AwsImAuthentication) // load from EC2 role or env var
        }
    }

    ivy {
        url = "s3://myCompanyBucket/ivyrepo"
        authentication {
           awsIm(AwsImAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="ex-declaring-a-gcs-backed-maven-and-ivy-repository" class="exampleblock">
<div class="title">Example 22. <a href="#ex-declaring-a-gcs-backed-maven-and-ivy-repository">Declaring a GCS-Backed Maven and Ivy Repository</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("gcs://myCompanyBucket/maven2")
    }

    ivy {
        url = uri("gcs://myCompanyBucket/ivyrepo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "gcs://myCompanyBucket/maven2"
    }

    ivy {
        url = "gcs://myCompanyBucket/ivyrepo"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configure-auth-schemes"><a class="anchor" href="#sec:configure-auth-schemes"></a><a class="link" href="#sec:configure-auth-schemes">Configuring authentication schemes</a></h4>
<div class="sect4">
<h5 id="sec:authentication-schemes"><a class="anchor" href="#sec:authentication-schemes"></a><a class="link" href="#sec:authentication-schemes">HTTP(S) authentication schemes configuration</a></h5>
<div class="paragraph">
<p>When configuring a repository that uses HTTP or HTTPS transport protocols, several authentication schemes are available.
By default, Gradle attempts to use all schemes supported by the <a href="http://hc.apache.org/httpcomponents-client-ga/">Apache HttpClient library</a>.
However, you may want to explicitly specify which authentication schemes should be used when interacting with a remote server.
When explicitly declared, only those specified schemes will be used.</p>
</div>
<div class="sect5">
<h6 id="basic_authentication"><a class="anchor" href="#basic_authentication"></a><a class="link" href="#basic_authentication">Basic authentication</a></h6>
<div class="paragraph">
<p>You can specify credentials for Maven repositories secured by basic authentication using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/credentials/PasswordCredentials.html">PasswordCredentials</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/maven2"
        credentials {
            username = "user"
            password = "password"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="digest_authentication"><a class="anchor" href="#digest_authentication"></a><a class="link" href="#digest_authentication">Digest Authentication</a></h6>
<div class="paragraph">
<p>To configure a repository to use only <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/DigestAuthentication.html">DigestAuthentication</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            create&lt;DigestAuthentication&gt;("digest")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = 'https://repo.mycompany.com/maven2'
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            digest(DigestAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="supported_authentication_schemes"><a class="anchor" href="#supported_authentication_schemes"></a><a class="link" href="#supported_authentication_schemes">Supported Authentication Schemes</a></h6>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a></dt>
<dd>
<p>Basic access authentication over HTTP. Credentials are sent preemptively.</p>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/DigestAuthentication.html">DigestAuthentication</a></dt>
<dd>
<p>Digest access authentication over HTTP.</p>
</dd>
<dt class="hdlist1"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/HttpHeaderAuthentication.html">HttpHeaderAuthentication</a></dt>
<dd>
<p>Authentication based on a custom HTTP header, such as private tokens or OAuth tokens.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:preemptive-authentication"><a class="anchor" href="#sec:preemptive-authentication"></a><a class="link" href="#sec:preemptive-authentication">Using preemptive authentication</a></h5>
<div class="paragraph">
<p>By default, Gradle submits credentials only when a server responds with an authentication challenge (HTTP 401).
However, some servers might respond with a different code (e.g., GitHub returns a 404) that could cause dependency resolution to fail.
In such cases, you can configure Gradle to send credentials preemptively by explicitly using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a> scheme:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            create&lt;BasicAuthentication&gt;("basic")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = 'https://repo.mycompany.com/maven2'
        credentials {
            username = "user"
            password = "password"
        }
        authentication {
            basic(BasicAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:http-header-auth"><a class="anchor" href="#sec:http-header-auth"></a><a class="link" href="#sec:http-header-auth">Using HTTP header authentication</a></h5>
<div class="paragraph">
<p>For Maven repositories that require token-based, OAuth2, or other HTTP header-based authentication, you can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/credentials/HttpHeaderCredentials.html">HttpHeaderCredentials</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/authentication/http/HttpHeaderAuthentication.html">HttpHeaderAuthentication</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/maven2")
        credentials(HttpHeaderCredentials::class) {
            name = "Private-Token"
            value = "TOKEN"
        }
        authentication {
            create&lt;HttpHeaderAuthentication&gt;("header")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/maven2"
        credentials(HttpHeaderCredentials) {
            name = "Private-Token"
            value = "TOKEN"
        }
        authentication {
            header(HttpHeaderAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:s3-repositories"><a class="anchor" href="#sec:s3-repositories"></a><a class="link" href="#sec:s3-repositories">AWS S3 repositories configuration</a></h5>
<div class="paragraph">
<p>When configuring a repository that uses AWS S3, several options and settings are available.</p>
</div>
<div class="sect5">
<h6 id="sec:s3-configuration-properties"><a class="anchor" href="#sec:s3-configuration-properties"></a><a class="link" href="#sec:s3-configuration-properties">S3 configuration properties</a></h6>
<div class="paragraph">
<p>The following system properties can be used to configure interactions with S3 repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.s3.endpoint</code></dt>
<dd>
<p>Overrides the AWS S3 endpoint when using a non-AWS, S3 API-compatible storage service.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.s3.maxErrorRetry</code></dt>
<dd>
<p>Specifies the maximum number of retry attempts when the S3 server responds with an HTTP 5xx status code. The default value is 3 if not specified.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="sec:s3-url-formats"><a class="anchor" href="#sec:s3-url-formats"></a><a class="link" href="#sec:s3-url-formats">S3 URL formats</a></h6>
<div class="paragraph">
<p>S3 URLs must use the 'virtual-hosted-style' format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">s3://&lt;bucketName&gt;[.&lt;regionSpecificEndpoint&gt;]/&lt;s3Key&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example</strong>: <code>s3://myBucket.s3.eu-central-1.amazonaws.com/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code>: The AWS S3 bucket name.</p>
</li>
<li>
<p><code>s3.eu-central-1.amazonaws.com</code>: The optional region-specific endpoint.</p>
</li>
<li>
<p><code>/maven/release</code>: The AWS S3 key (a unique identifier for an object within a bucket).</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="sec:s3-proxy-settings"><a class="anchor" href="#sec:s3-proxy-settings"></a><a class="link" href="#sec:s3-proxy-settings">S3 proxy settings</a></h6>
<div class="paragraph">
<p>A proxy for S3 can be configured using the following system properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For HTTPS:</p>
<div class="ulist">
<ul>
<li>
<p><code>https.proxyHost</code></p>
</li>
<li>
<p><code>https.proxyPort</code></p>
</li>
<li>
<p><code>https.proxyUser</code></p>
</li>
<li>
<p><code>https.proxyPassword</code></p>
</li>
<li>
<p><code>http.nonProxyHosts</code> (NOTE: this is not a typo.)
*For HTTP (if org.gradle.s3.endpoint is set with an HTTP URI):</p>
</li>
<li>
<p><code>http.proxyHost</code></p>
</li>
<li>
<p><code>http.proxyPort</code></p>
</li>
<li>
<p><code>http.proxyUser</code></p>
</li>
<li>
<p><code>http.proxyPassword</code></p>
</li>
<li>
<p><code>http.nonProxyHosts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="sec:s3-v4-signatures"><a class="anchor" href="#sec:s3-v4-signatures"></a><a class="link" href="#sec:s3-v4-signatures">S3 V4 Signatures (AWS4-HMAC-SHA256)</a></h6>
<div class="paragraph">
<p>Some S3 regions (e.g., <code>eu-central-1</code> in Frankfurt) require that all HTTP requests are signed using AWSs signature version 4.
It is recommended to specify S3 URLs containing the region-specific endpoint when using buckets that require V4 signatures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">s3://somebucket.s3.eu-central-1.amazonaws.com/maven/release</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the region-specific endpoint is not specified for buckets requiring V4 Signatures, Gradle defaults to the <code>us-east-1</code> region and will issue a warning:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Attempting to re-send the request to .... with AWS V4 authentication. To avoid this warning in the future, use region-specific endpoint to access buckets located in regions that require V4 signing.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Failing to specify the region-specific endpoint for such buckets results in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Increased network traffic</strong>: Three round-trips to AWS per file upload/download instead of one.</p>
</li>
<li>
<p><strong>Slower builds</strong>: Due to increased network latency.</p>
</li>
<li>
<p><strong>Higher transmission failure rates</strong>: Due to additional network overhead.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="sec:s3-cross-account"><a class="anchor" href="#sec:s3-cross-account"></a><a class="link" href="#sec:s3-cross-account">S3 Cross Account Access</a></h6>
<div class="paragraph">
<p>In organizations with multiple AWS accounts (e.g., one per team), the bucket owner may differ from the artifact publisher or consumers.
To ensure consumers can access the artifacts, the bucket owner must grant the appropriate access.
Gradle automatically applies the <code>bucket-owner-full-control</code> <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl">Canned ACL</a> to uploaded objects.
Ensure the publisher has the required IAM permissions (<code>PutObjectAcl</code> and <code>PutObjectVersionAcl</code> if bucket versioning is enabled), either directly or through an assumed IAM Role. For more details, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-access-control.html">AWS S3 Access Permissions</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:gcs-repositories"><a class="anchor" href="#sec:gcs-repositories"></a><a class="link" href="#sec:gcs-repositories">Google Cloud Storage repositories configuration</a></h5>
<div class="paragraph">
<p>When configuring a repository that uses Google Cloud Storage (GCS), several configuration options and settings are available.</p>
</div>
<div class="sect5">
<h6 id="sec:gcs-configuration-properties"><a class="anchor" href="#sec:gcs-configuration-properties"></a><a class="link" href="#sec:gcs-configuration-properties">GCS configuration properties</a></h6>
<div class="paragraph">
<p>You can use the following system properties to configure interactions with <a href="https://cloud.google.com/storage/">GCS</a> repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.gcs.endpoint</code></dt>
<dd>
<p>Overrides the Google Cloud Storage endpoint, useful when working with a storage service compatible with the GCS API but not hosted on Google Cloud Platform.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.gcs.servicePath</code></dt>
<dd>
<p>Specifies the root service path from which the GCS client builds requests, with a default value of <code>/</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="sec:gcs-url-formats"><a class="anchor" href="#sec:gcs-url-formats"></a><a class="link" href="#sec:gcs-url-formats">GCS URL formats</a></h6>
<div class="paragraph">
<p>GCS URLs use a 'virtual-hosted-style' format and must adhere to the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">gcs://&lt;bucketName&gt;/&lt;objectKey&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;bucketName&gt;</code>: The name of the Google Cloud Storage bucket.</p>
</li>
<li>
<p><code>&lt;objectKey&gt;</code>: The unique identifier for an object within a bucket.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong>: <code>gcs://myBucket/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code>: The bucket name.</p>
</li>
<li>
<p><code>/maven/release</code>: The GCS object key.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:handling-credentials"><a class="anchor" href="#sec:handling-credentials"></a><a class="link" href="#sec:handling-credentials">Handling credentials</a></h4>
<div class="paragraph">
<p>Repository credentials should never be hardcoded in your build script but kept external.
Gradle provides an <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/repositories/AuthenticationSupported.html#credentials-java.lang.Class-">API in artifact repositories</a> that allows you to declare the type of credentials required, with their values being looked up from <a href="#sec:gradle_configuration_properties">Gradle properties</a> during the build.</p>
</div>
<div class="paragraph">
<p>For example, consider the following repository configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        name = "mySecureRepository"
        credentials(PasswordCredentials::class)
        // url = uri(&lt;&lt;some repository url&gt;&gt;)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        name = 'mySecureRepository'
        credentials(PasswordCredentials)
        // url = uri(&lt;&lt;some repository url&gt;&gt;)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the username and password are automatically looked up from properties named <code>mySecureRepositoryUsername</code> and <code>mySecureRepositoryPassword</code>.</p>
</div>
<div class="sect4">
<h5 id="configuration_property_prefix"><a class="anchor" href="#configuration_property_prefix"></a><a class="link" href="#configuration_property_prefix">Configuration property prefix</a></h5>
<div class="paragraph">
<p>The configuration property prefix, known as the <strong>identity</strong>, is derived from the repository name.
Credentials can be provided through any of the supported Gradle property mechanisms: <code>gradle.properties</code> file, command-line arguments, environment variables, or a combination of these.</p>
</div>
</div>
<div class="sect4">
<h5 id="conditional_credential_requirement"><a class="anchor" href="#conditional_credential_requirement"></a><a class="link" href="#conditional_credential_requirement">Conditional credential requirement</a></h5>
<div class="paragraph">
<p>Credentials are only required when the build process needs them. For example, if a project is configured to publish artifacts to a secured repository, but the publishing task isn&#8217;t invoked, Gradle wont require the credentials.
However, if a task requiring credentials is part of the build process, Gradle will check for their presence before running any tasks to prevent build failures due to missing credentials.</p>
</div>
</div>
<div class="sect4">
<h5 id="supported_credential_types"><a class="anchor" href="#supported_credential_types"></a><a class="link" href="#supported_credential_types">Supported credential types</a></h5>
<div class="paragraph">
<p>Lookup is only supported for the credential types listed in the table below:</p>
</div>
<table id="credentials_lookup_properties" class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Argument</th>
<th class="tableblock halign-left valign-top">Base property name</th>
<th class="tableblock halign-left valign-top">Required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/credentials/PasswordCredentials.html">PasswordCredentials</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><code><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/credentials/AwsCredentials.html">AwsCredentials</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>accessKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AccessKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>secretKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SecretKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessionToken</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SessionToken</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/credentials/HttpHeaderCredentials.html">HttpHeaderCredentials</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthHeaderName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthHeaderValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="repository-content-filtering"><a class="anchor" href="#repository-content-filtering"></a><a class="link" href="#repository-content-filtering">Filtering Repository Content</a></h3>
<div class="paragraph">
<p>Gradle exposes an API to declare what a repository may or may not contain.
There are different use cases for it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Performance</strong> when you know a dependency will never be found in a specific repository</p>
</li>
<li>
<p><strong>Security</strong> by avoiding leaking what dependencies are used in a private project</p>
</li>
<li>
<p><strong>Reliability</strong> when some repositories contain invalid or incorrect metadata or artifacts</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s even more important when considering that the declared order of repositories matter.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring-repository-filter"><a class="anchor" href="#sec:declaring-repository-filter"></a><a class="link" href="#sec:declaring-repository-filter">Declaring a repository filter</a></h4>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/maven2")
        content {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup("my.company")
        }
    }
    mavenCentral {
        content {
            // this repository contains everything BUT artifacts with group starting with "my.company"
            excludeGroupByRegex("my\\.company.*")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "https://repo.mycompany.com/maven2"
        content {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup "my.company"
        }
    }
    mavenCentral {
        content {
            // this repository contains everything BUT artifacts with group starting with "my.company"
            excludeGroupByRegex "my\\.company.*"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, repositories include everything and exclude nothing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you declare an include, then it excludes everything <em>but</em> what is included.</p>
</li>
<li>
<p>If you declare an exclude, then it includes everything <em>but</em> what is excluded.</p>
</li>
<li>
<p>If you declare both includes and excludes, then it includes only what is explicitly included and not excluded.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to filter either by explicit <em>group</em>, <em>module</em> or <em>version</em>, either strictly or using regular expressions.
When using a strict version, it is possible to use a version range, using <a href="#sec:single-version-declarations">the format supported</a> by Gradle.
In addition, there are filtering options by resolution context: configuration name or even configuration attributes.
See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/repositories/RepositoryContentDescriptor.html">RepositoryContentDescriptor</a> for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-content-repositories"><a class="anchor" href="#sec:declaring-content-repositories"></a><a class="link" href="#sec:declaring-content-repositories">Declaring content exclusively found in one repository</a></h4>
<div class="paragraph">
<p>Filters declared using the <a href="#sec:declaring-repository-filter">repository-level content filter</a> are not exclusive.
This means that declaring that a repository <em>includes</em> an artifact doesn&#8217;t mean that the other repositories can&#8217;t have it either: you must declare what every repository contains in extension.</p>
</div>
<div class="paragraph">
<p>Alternatively, Gradle provides an API which lets you declare that a repository <em>exclusively includes</em> an artifact.
If you do so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an artifact declared in a repository <em>can&#8217;t</em> be found in any other</p>
</li>
<li>
<p>exclusive repository content must be declared in extension (just like for <a href="#sec:declaring-repository-filter">repository-level content</a>)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Using exclusive repository content filters is a <a href="#use_content_filtering">Gradle Best Practice</a>.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    // This repository will _not_ be searched for artifacts in my.company
    // despite being declared first
    mavenCentral()
    exclusiveContent {
        forRepository {
            maven {
                url = uri("https://repo.mycompany.com/maven2")
            }
        }
        filter {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup("my.company")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    // This repository will _not_ be searched for artifacts in my.company
    // despite being declared first
    mavenCentral()
    exclusiveContent {
        forRepository {
            maven {
                url = "https://repo.mycompany.com/maven2"
            }
        }
        filter {
            // this repository *only* contains artifacts with group "my.company"
            includeGroup "my.company"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is possible to filter either by explicit <em>group</em>, <em>module</em> or <em>version</em>, either strictly or using regular expressions.
See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/repositories/InclusiveRepositoryContentDescriptor.html">InclusiveRepositoryContentDescriptor</a> for details.</p>
</div>
<div class="paragraph">
<p>When setting up exclusive content filters be sure to also consider what repository will contain the transitives dependencies your build will resolve.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you leverage exclusive content filtering in the <a href="plugins_intermediate.html#sec:custom_plugin_repositories"><code>pluginManagement</code> section of the <code>settings.gradle(.kts)</code></a>, it becomes illegal to add more repositories through the project <code>buildscript.repositories</code>.
In that case, the build configuration will fail.</p>
</div>
<div class="paragraph">
<p>Your options are either to declare all repositories in settings or to use non-exclusive content filtering.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="maven_repository_filtering"><a class="anchor" href="#maven_repository_filtering"></a><a class="link" href="#maven_repository_filtering">Maven repository filtering</a></h5>
<div class="paragraph">
<p>For <a href="#sec:maven-repo">Maven repositories</a>, it&#8217;s often the case that a repository would either contain releases or snapshots.
Gradle lets you declare what kind of artifacts are found in a repository using this DSL:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("https://repo.mycompany.com/releases")
        mavenContent {
            releasesOnly()
        }
    }
    maven {
        url = uri("https://repo.mycompany.com/snapshots")
        mavenContent {
            snapshotsOnly()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "https://repo.mycompany.com/releases"
        mavenContent {
            releasesOnly()
        }
    }
    maven {
        url = "https://repo.mycompany.com/snapshots"
        mavenContent {
            snapshotsOnly()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ivy_dynamic_resolve_mode"><a class="anchor" href="#sec:ivy_dynamic_resolve_mode"></a><a class="link" href="#sec:ivy_dynamic_resolve_mode">Enabling Ivy dynamic resolve mode</a></h4>
<div class="paragraph">
<p>Normally, in an Ivy repository, dependencies are specified using the <code>rev</code> (revision) attribute in <code>ivy.xml</code>.
However, dynamic resolve mode allows Gradle to prefer the <code>revConstraint</code> attribute over <code>rev</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>revConstraint</code> is present in <code>ivy.xml</code>, Gradle will use it instead of <code>rev</code>.</p>
</li>
<li>
<p>If <code>revConstraint</code> is <strong>not</strong> present, Gradle falls back to <code>rev</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This provides more flexibility in dependency resolution, particularly when working with Ivy repositories that define constraints on acceptable versions.</p>
</div>
<div class="paragraph">
<p>You need to explicitly enable dynamic resolve mode when declaring an Ivy repository:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Can enable dynamic resolve mode when you define the repository
repositories {
    ivy {
        url = uri("http://repo.mycompany.com/repo")
        resolve.isDynamicMode = true
    }
}

// Can use a rule instead to enable (or disable) dynamic resolve mode for all repositories
repositories.withType&lt;IvyArtifactRepository&gt; {
    resolve.isDynamicMode = true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Can enable dynamic resolve mode when you define the repository
repositories {
    ivy {
        url = "http://repo.mycompany.com/repo"
        resolve.dynamicMode = true
    }
}

// Can use a rule instead to enable (or disable) dynamic resolve mode for all repositories
repositories.withType(IvyArtifactRepository) {
    resolve.dynamicMode = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Dynamic resolve mode is only available for Gradle&#8217;s Ivy repositories. It is not available for Maven repositories, or custom Ivy <code>DependencyResolver</code> implementations.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="centralizing_dependencies"><a class="anchor" href="#centralizing_dependencies"></a><a class="link" href="#centralizing_dependencies">CENTRALIZING DEPENDENCIES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="platforms"><a class="anchor" href="#platforms"></a><a class="link" href="#platforms">Platforms</a></h3>
<div class="paragraph">
<p>Platforms are used to ensure that all dependencies in a project align with a consistent set of versions.</p>
</div>
<div id="sec:sharing-dep-versions-between-projects" class="paragraph">
<p>Platforms help you manage and enforce version consistency across different modules or libraries, especially when you are working with a set of related dependencies that need to be kept in sync.</p>
</div>
<div class="sect3">
<h4 id="sec:using-platform-to-control-transitive-deps"><a class="anchor" href="#sec:using-platform-to-control-transitive-deps"></a><a class="link" href="#sec:using-platform-to-control-transitive-deps">Using a platform</a></h4>
<div class="paragraph">
<p>A platform is a specialized software component used to control transitive dependency versions.
Typically, it consists of <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a> that either recommend or enforce specific versions.
Platforms are particularly useful when you need to share consistent dependency versions across multiple projects.</p>
</div>
<div class="paragraph">
<p>In a typical setup you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A Platform Project</strong>: Which defines constraints for dependencies used across different subprojects.</p>
</li>
<li>
<p><strong>A Number of Subprojects</strong>: Which depend on the platform and declare dependencies without specifying versions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#java_platform_plugin"><code>java-platform plugin</code></a> supports creating platforms in the Java ecosystem.
Platforms are also commonly published as Maven BOMs (Bill of Materials), which Gradle natively supports.</p>
</div>
<div class="paragraph">
<p>To use a platform, declare a dependency with the <code>platform</code> keyword:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // get recommended versions from the platform project
    api(platform(project(":platform")))
    // no version required
    api("commons-httpclient:commons-httpclient")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // get recommended versions from the platform project
    api platform(project(':platform'))
    // no version required
    api 'commons-httpclient:commons-httpclient'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This notation automatically performs several actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sets the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Category.html"><code>org.gradle.category</code> attribute</a> to platform, ensuring Gradle selects the platform component.</p>
</li>
<li>
<p>Enables the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ModuleDependency.html#endorseStrictVersions--"><code>endorseStrictVersions</code></a> behavior by default, enforcing strict versions defined in the platform.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <a href="#sec:strict-version">strict version</a> enforcement isn&#8217;t needed, you can disable it using the <code>doNotEndorseStrictVersions</code> method.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating_a_platform"><a class="anchor" href="#creating_a_platform"></a><a class="link" href="#creating_a_platform">Creating a platform</a></h4>
<div class="paragraph">
<p>In Java projects, the <code>java-platform</code> plugin combined with <a href="#dependency-constraints">dependency constraints</a> can be used to create a platform:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}

dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api("commons-httpclient:commons-httpclient:3.1")
        api("org.apache.commons:commons-lang3:3.8.1")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-platform'
}

dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api 'commons-httpclient:commons-httpclient:3.1'
        api 'org.apache.commons:commons-lang3:3.8.1'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This defines a custom platform with specific versions of <code>commons-httpclient</code> and <code>commons-lang3</code> that can be applied in other projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:bom-import"><a class="anchor" href="#sec:bom-import"></a><a class="link" href="#sec:bom-import">Importing a platform</a></h4>
<div class="paragraph">
<p>Gradle supports importing <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Bill_of_Materials_.28BOM.29_POMs">BOMs</a>, which are POM files containing <code>&lt;dependencyManagement&gt;</code> sections that manage dependency versions.</p>
</div>
<div class="paragraph">
<p>In order to qualify as a BOM, a <code>.pom</code> file needs to have pom set.
This means that the POM file should explicitly specify &lt;packaging&gt;pom&lt;/packaging&gt; in its metadata.</p>
</div>
<div class="paragraph">
<p>Gradle treats all entries in the block of a BOM similar to <a href="#sec:adding-constraints-transitive-deps">Adding Constraints On Dependencies</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:regular-platform"><a class="anchor" href="#sec:regular-platform"></a><a class="link" href="#sec:regular-platform">Regular Platform</a></h5>
<div class="paragraph">
<p>To import a BOM, declare a dependency on it using the <code>platform</code> dependency modifier method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // import a BOM
    implementation(platform("org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE"))
    // define dependencies without versions
    implementation("com.google.code.gson:gson")
    implementation("dom4j:dom4j")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // import a BOM
    implementation platform('org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE')
    // define dependencies without versions
    implementation 'com.google.code.gson:gson'
    implementation 'dom4j:dom4j'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the Spring Boot BOM provides the versions for <code>gson</code> and <code>dom4j</code>, so no explicit versions are needed.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:enforced-platform"><a class="anchor" href="#sec:enforced-platform"></a><a class="link" href="#sec:enforced-platform">Enforced Platform</a></h5>
<div class="paragraph">
<p>The <code>enforcedPlatform</code> keyword can be used to override any versions found in the dependency graph, but should be used with caution as it is effectively transitive and exports forced versions to all consumers of your project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // import a BOM. The versions used in this file will override any other version found in the graph
    implementation(enforcedPlatform("org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE"))

    // define dependencies without versions
    implementation("com.google.code.gson:gson")
    implementation("dom4j:dom4j")

    // this version will be overridden by the one found in the BOM
    implementation("org.codehaus.groovy:groovy:1.8.6")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // import a BOM. The versions used in this file will override any other version found in the graph
    implementation enforcedPlatform('org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE')

    // define dependencies without versions
    implementation 'com.google.code.gson:gson'
    implementation 'dom4j:dom4j'

    // this version will be overridden by the one found in the BOM
    implementation 'org.codehaus.groovy:groovy:1.8.6'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When using <code>enforcedPlatform</code>, exercise caution if your software component is intended for consumption by others.
This declaration is transitive and affects the dependency graph of your consumers.
If they disagree with any enforced versions, they&#8217;ll need to use <code>exclude</code>.
Instead, if your reusable component strongly favors specific third-party dependency versions, consider using a <a href="#sec:strict-version">rich version</a> declaration with <code>strictly</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="version-catalog"><a class="anchor" href="#version-catalog"></a><a class="link" href="#version-catalog">Version Catalogs</a></h3>
<div class="paragraph">
<p>A version catalog is a selected list of dependencies that can be referenced in build scripts, simplifying dependency management.</p>
</div>
<p>
  <div style="position:relative;padding-top:56.25%;">
    <iframe src="https://www.youtube-nocookie.com/embed/dZmlSsRdctE?si=2u96T8ieHzOu4_48&rel=0" frameborder="0" allowfullscreen
      style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
  </div>
</p>
<div class="paragraph">
<p>Instead of specifying dependencies directly using string notation, you can pick them from a version catalog:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(libs.groovy.core)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation(libs.groovy.core)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>libs</code> represents the catalog, and <code>groovy</code> is a dependency available in it.</p>
</div>
<div class="paragraph">
<p>Where the version catalog defining <code>libs.groovy.core</code> is a <code>libs.versions.toml</code> file in the <code>gradle</code> directory:</p>
</div>
<div class="listingblock">
<div class="title">gradle/libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[libraries]
groovy-core = { group = "org.codehaus.groovy", name = "groovy", version = "3.0.5" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Version catalogs offer several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Type-Safe Accessors</strong>: Gradle generates type-safe accessors for each catalog, enabling autocompletion in IDEs.</p>
</li>
<li>
<p><strong>Centralized Version Management</strong>: Each catalog is visible to all projects in a build.</p>
</li>
<li>
<p><strong>Dependency Bundles</strong>: Catalogs can group commonly used dependencies into <a href="#sec:dependency-bundles">bundles</a>.</p>
</li>
<li>
<p><strong>Version Separation</strong>: Catalogs can separate dependency coordinates from version information, allowing shared version declarations.</p>
</li>
<li>
<p><strong>Conflict Resolution</strong>: Like regular dependency notation, version catalogs declare requested <a href="#sec:common-version-numbers">versions</a> but do not enforce them during <a href="#dependency-constraints">conflict resolution</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While version catalogs define versions, they don&#8217;t influence the dependency resolution process.
Gradle may still select different versions due to dependency graph conflicts or constraints applied through platforms or dependency management APIs.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Versions declared in a catalog are typically not enforced, meaning the actual version used in the build may differ based on dependency resolution.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:accessing-catalog"><a class="anchor" href="#sec:accessing-catalog"></a><a class="link" href="#sec:accessing-catalog">Accessing a catalog</a></h4>
<div class="paragraph">
<p>To access items in a version catalog defined in the standard <code>libs.versions.toml</code> file located in the <code>gradle</code> directory, you use the <code>libs</code> object in your build scripts.
For example, to reference a library, you can use <code>libs.&lt;alias&gt;</code>, and for a plugin, you can use <code>libs.plugins.&lt;alias&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Declaring dependencies using a version catalog:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(libs.groovy.core)
    implementation(libs.groovy.json)
    implementation(libs.groovy.nio)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation libs.groovy.core
    implementation libs.groovy.json
    implementation libs.groovy.nio
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Is the same as:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.codehaus.groovy:groovy:3.0.5")
    implementation("org.codehaus.groovy:groovy-json:3.0.5")
    implementation("org.codehaus.groovy:groovy-nio:3.0.5")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.codehaus.groovy:groovy:3.0.5'
    implementation 'org.codehaus.groovy:groovy-json:3.0.5'
    implementation 'org.codehaus.groovy:groovy-nio:3.0.5'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="sec:type-unsafe-access-to-catalog" class="paragraph">
<p>Accessors map directly to the aliases and versions defined in the TOML file, offering type-safe access to dependencies and plugins.
This enables IDEs to provide autocompletion, highlight typos, and identify missing dependencies as errors.</p>
</div>
<div class="sect4">
<h5 id="sec:mapping-aliases-to-accessors"><a class="anchor" href="#sec:mapping-aliases-to-accessors"></a><a class="link" href="#sec:mapping-aliases-to-accessors">Aliases and type-safe accessors</a></h5>
<div class="paragraph">
<p>Aliases in a version catalog consist of identifiers separated by a dash (<code>-</code>), underscore (<code>_</code>), or dot (<code>.</code>).
Type-safe accessors are generated for each alias, normalized to dot notation:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Example aliases</th>
<th class="tableblock halign-left valign-top">Generated accessors</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>guava</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libs.guava</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovy-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libs.groovy.core</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>androidx.awesome.lib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libs.androidx.awesome.lib</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:version-catalog-declaration"><a class="anchor" href="#sec:version-catalog-declaration"></a><a class="link" href="#sec:version-catalog-declaration">Creating a catalog</a></h4>
<div id="sub:conventional-dependencies-toml" class="paragraph">
<p>Version catalogs are conventionally declared using a <code>libs.versions.toml</code> file located in the <code>gradle</code> subdirectory of the root build:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle/libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
groovy = "3.0.5"
checkstyle = "8.37"

[libraries]
groovy-core = { module = "org.codehaus.groovy:groovy", version.ref = "groovy" }
groovy-json = { module = "org.codehaus.groovy:groovy-json", version.ref = "groovy" }
groovy-nio = { module = "org.codehaus.groovy:groovy-nio", version.ref = "groovy" }
commons-lang3 = { group = "org.apache.commons", name = "commons-lang3", version = { strictly = "[3.8, 4.0[", prefer="3.9" } }

[bundles]
groovy = ["groovy-core", "groovy-json", "groovy-nio"]

[plugins]
versions = { id = "com.github.ben-manes.versions", version = "0.45.0" }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec::toml-dependencies-format"><a class="anchor" href="#sec::toml-dependencies-format"></a><a class="link" href="#sec::toml-dependencies-format">The TOML catalog format</a></h5>
<div class="paragraph">
<p>The <a href="https://toml.io/">TOML</a> file has four sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[versions]</code>  Declares version identifiers.</p>
</li>
<li>
<p><code>[libraries]</code>  Maps aliases to GAV coordinates.</p>
</li>
<li>
<p><code>[bundles]</code>  Defines dependency bundles.</p>
</li>
<li>
<p><code>[plugins]</code>  Declares plugin versions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The TOML file format is very lenient and lets you write "dotted" properties as shortcuts to full object declarations.</p>
</div>
<div class="sect5">
<h6 id="sec:common-version-numbers"><a class="anchor" href="#sec:common-version-numbers"></a><a class="link" href="#sec:common-version-numbers">Versions</a></h6>
<div class="paragraph">
<p>Versions can be declared either as a single string, in which case they are interpreted as a <em>required</em> version, or as a <a href="#sec:rich-version-constraints">rich version</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
other-lib = "5.5.0" # Required version
my-lib = { strictly = "[1.0, 2.0[", prefer = "1.2" } # Rich version</code></pre>
</div>
</div>
<div class="paragraph">
<p>Supported members of a version declaration are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>require</code>: the <a href="#sec:required-version">required version</a></p>
</li>
<li>
<p><code>strictly</code>: the <a href="#sec:strict-version">strict version</a></p>
</li>
<li>
<p><code>prefer</code>: the <a href="#sec:preferred-version">preferred version</a></p>
</li>
<li>
<p><code>reject</code>: the list of <a href="#sec:rejected-version">rejected versions</a></p>
</li>
<li>
<p><code>rejectAll</code>: a boolean to reject all <a href="#sec:rejected-version">versions</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="libraries"><a class="anchor" href="#libraries"></a><a class="link" href="#libraries">Libraries</a></h6>
<div class="paragraph">
<p>Each library is mapped to a GAV coordinate: group, artifact, version.
They can be declared as a simple string, in which case they are interpreted coordinates, or separate group and name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
common = "1.4"

[libraries]
my-lib = "com.mycompany:mylib:1.4"
my-lib-no-version.module = "com.mycompany:mylib"
my-other-lib = { module = "com.mycompany:other", version = "1.4" }
my-other-lib2 = { group = "com.mycompany", name = "alternate", version = "1.4" }
mylib-full-format = { group = "com.mycompany", name = "alternate", version = { require = "1.4" } }

[plugins]
short-notation = "some.plugin.id:1.4"
long-notation = { id = "some.plugin.id", version = "1.4" }
reference-notation = { id = "some.plugin.id", version.ref = "common" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also define strict or preferred versions using <code>strictly</code> or <code>prefer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[libraries]
commons-lang3 = { group = "org.apache.commons", name = "commons-lang3", version = { strictly = "[3.8, 4.0[", prefer = "3.9" } }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case you want to reference a version declared in the <code>[versions]</code> section, use the <code>version.ref</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
some = "1.4"

[libraries]
my-lib = { group = "com.mycompany", name="mylib", version.ref="some" }</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:dependency-bundles"><a class="anchor" href="#sec:dependency-bundles"></a><a class="link" href="#sec:dependency-bundles">Bundles</a></h6>
<div class="paragraph">
<p>Bundles group multiple library aliases, so they can be referenced together in the build script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
groovy = "3.0.9"

[libraries]
groovy-core = { group = "org.codehaus.groovy", name = "groovy", version.ref = "groovy" }
groovy-json = { group = "org.codehaus.groovy", name = "groovy-json", version.ref = "groovy" }
groovy-nio = { group = "org.codehaus.groovy", name = "groovy-nio", version.ref = "groovy" }

[bundles]
groovy = ["groovy-core", "groovy-json", "groovy-nio"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is useful for pulling in several related dependencies with a single alias:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(libs.bundles.groovy)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation libs.bundles.groovy
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:plugins-ver"><a class="anchor" href="#sec:plugins-ver"></a><a class="link" href="#sec:plugins-ver">Plugins</a></h6>
<div class="paragraph">
<p>This section defines the plugins and their versions by mapping plugin IDs to version numbers.
Just like libraries, you can define plugin versions using aliases from the <code>[versions]</code> section or directly specify the version.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[plugins]
versions = { id = "com.github.ben-manes.versions", version = "0.45.0" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which can be accessed in any project of the build using the <code>plugins {}</code> block.
To refer to a plugin from the catalog, use the <code>alias()</code> function:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
    checkstyle
    alias(libs.plugins.versions)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'checkstyle'
    // Use the plugin `versions` as declared in the `libs` version catalog
    alias(libs.plugins.versions)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
You cannot use a plugin declared in a version catalog in your settings file or settings plugin.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="avoiding_subgroup_accessors"><a class="anchor" href="#avoiding_subgroup_accessors"></a><a class="link" href="#avoiding_subgroup_accessors">Avoiding subgroup accessors</a></h5>
<div class="paragraph">
<p>To avoid generating subgroup accessors, use camelCase notation:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Aliases</th>
<th class="tableblock halign-left valign-top">Accessors</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovyCore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libs.groovyCore</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovyJson-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>libs.groovyJson.core</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="reserved_keywords"><a class="anchor" href="#reserved_keywords"></a><a class="link" href="#reserved_keywords">Reserved keywords</a></h5>
<div class="paragraph">
<p>Certain keywords, like <code>extensions</code>, <code>class</code>, and <code>convention</code>, are reserved and cannot be used as aliases.
Additionally, <code>bundles</code>, <code>versions</code>, and <code>plugins</code> cannot be the first subgroup in a dependency alias.</p>
</div>
<div class="paragraph">
<p>For example, the alias <code>versions-dependency</code> is not valid, but <code>versionsDependency</code> or <code>dependency-versions</code> are valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:version-catalog-plugin"><a class="anchor" href="#sec:version-catalog-plugin"></a><a class="link" href="#sec:version-catalog-plugin">Publishing a catalog</a></h4>
<div class="paragraph">
<p>In most cases, the <code>gradle/libs.versions.toml</code> will be checked into a repository and available for consumption.</p>
</div>
<div class="paragraph">
<p>However, this doesn&#8217;t always solve the problem of sharing a catalog in an organization or for external consumers.
Another option to share a catalog is to write a settings plugin, publish it on the Gradle plugin portal or an internal repository, and let the consumers apply the plugin on their settings file.</p>
</div>
<div class="paragraph">
<p>Alternatively, Gradle offers a <em>version catalog</em> plugin, which has the ability to declare and publish a catalog.</p>
</div>
<div class="paragraph">
<p>To do this, you need to apply the <code>version-catalog</code> plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `version-catalog`
    `maven-publish`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'version-catalog'
    id 'maven-publish'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This plugin will then expose the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/plugins/catalog/CatalogPluginExtension.html">catalog extension</a> that you can use to declare a catalog:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">catalog {
    // declare the aliases, bundles and versions in this block
    versionCatalog {
        library("my-lib", "com.mycompany:mylib:1.2")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">catalog {
    // declare the aliases, bundles and versions in this block
    versionCatalog {
        library('my-lib', 'com.mycompany:mylib:1.2')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The catalog must be created programmatically, see <a href="#sec:programmatic-catalog-versions">Programming catalogs</a> for details.</p>
</div>
<div class="paragraph">
<p>Such a catalog can then be published by applying either the <code>maven-publish</code> or <code>ivy-publish</code> plugin and configuring the publication to use the <code>versionCatalog</code> component:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("maven") {
            from(components["versionCatalog"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            from components.versionCatalog
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When publishing such a project, a <code>libs.versions.toml</code> file will automatically be generated (and uploaded), which can then be <a href="#sec:importing-published-catalog">consumed from other Gradle builds</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:importing-published-catalog"><a class="anchor" href="#sec:importing-published-catalog"></a><a class="link" href="#sec:importing-published-catalog">Importing a published catalog</a></h4>
<div class="paragraph">
<p>A catalog produced by the <a href="#sec:version-catalog-plugin">Version Catalog Plugin</a> can be imported via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/resolve/DependencyResolutionManagement.html#getVersionCatalogs()">Settings API</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            from("com.mycompany:catalog:1.0")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        libs {
            from("com.mycompany:catalog:1.0")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:importing-catalog-from-file"><a class="anchor" href="#sec:importing-catalog-from-file"></a><a class="link" href="#sec:importing-catalog-from-file">Importing a catalog from a file</a></h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Gradle automatically imports a catalog in the <code>gradle</code> directory named <code>libs.versions.toml</code>.
</td>
</tr>
</table>
</div>
<div id="sec:sharing-catalogs" class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/dsl/VersionCatalogBuilder.html">version catalog builder API</a> allows importing a catalog from an external file, enabling reuse across different parts of a build, such as sharing the main build&#8217;s catalog with <code>buildSrc</code>.</p>
</div>
<div class="paragraph">
<p>For example, you can include a catalog in the <code>buildSrc/settings.gradle(.kts)</code> file as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            from(files("../gradle/libs.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        libs {
            from(files("../gradle/libs.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/dsl/VersionCatalogBuilder.html#from-java.lang.Object-">VersionCatalogBuilder.from(Object dependencyNotation)</a> method accepts only a single file, meaning that notations like <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a> must refer to one file.
Otherwise, the build will fail.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Remember that you don&#8217;t need to import the version catalog named <code>libs.versions.toml</code> if it resides in your <code>gradle</code> folder. It will be imported automatically.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, if you need to import version catalogs from multiple files, it&#8217;s recommended to use a code-based approach instead of relying on TOML files.
This approach allows for the declaration of multiple catalogs from different files:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        // declares an additional catalog, named 'testLibs', from the 'test-libs.versions.toml' file
        create("testLibs") {
            from(files("gradle/test-libs.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        // declares an additional catalog, named 'testLibs', from the 'test-libs.versions.toml' file
        testLibs {
            from(files('gradle/test-libs.versions.toml'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:multiple-catalogs"><a class="anchor" href="#sec:multiple-catalogs"></a><a class="link" href="#sec:multiple-catalogs">Importing multiple catalogs</a></h4>
<div class="paragraph">
<p>You can declare multiple catalogs to organize dependencies better by using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/Settings.html#dependencyResolutionManagement(org.gradle.api.Action)">Settings API</a>:</p>
</div>
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            from(files("gradle/libs.versions.toml"))
        }
        create("tools") {
            from(files("gradle/tools.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(libs.someDependency)
    implementation(tools.someTool)
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To minimize the risk of naming conflicts, each catalog generates an extension applied to all projects, so it&#8217;s advisable to choose a unique name. One effective approach is to select a name that ends with <code>Libs</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:changing-catalog-name"><a class="anchor" href="#sec:changing-catalog-name"></a><a class="link" href="#sec:changing-catalog-name">Changing the catalog name</a></h4>
<div class="paragraph">
<p>By default, the <code>libs.versions.toml</code> file is used as input for the <code>libs</code> catalog.
However, you can rename the default catalog if an extension with the same name already exists:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    defaultLibrariesExtensionName = "projectLibs"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    defaultLibrariesExtensionName = 'projectLibs'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:overwriting-catalog-versions"><a class="anchor" href="#sec:overwriting-catalog-versions"></a><a class="link" href="#sec:overwriting-catalog-versions">Overwriting catalog versions</a></h4>
<div class="paragraph">
<p>You can overwrite versions when importing a catalog:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("amendedLibs") {
            from("com.mycompany:catalog:1.0")
            // overwrite the "groovy" version declared in the imported catalog
            version("groovy", "3.0.6")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        amendedLibs {
            from("com.mycompany:catalog:1.0")
            // overwrite the "groovy" version declared in the imported catalog
            version("groovy", "3.0.6")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the examples above, any dependency referencing the <code>groovy</code> version will automatically be updated to use <code>3.0.6</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Overwriting a version only affects what is imported and used when declaring dependencies.
The actual resolved dependency version may differ due to conflict resolution.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:programmatic-catalog-versions"><a class="anchor" href="#sec:programmatic-catalog-versions"></a><a class="link" href="#sec:programmatic-catalog-versions">Programming catalogs</a></h4>
<div class="paragraph">
<p>Version catalogs can be declared programmatically in the <code>settings.gradle(.kts)</code> file.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            version("groovy", "3.0.5")
            version("checkstyle", "8.37")
            library("groovy-core", "org.codehaus.groovy", "groovy").versionRef("groovy")
            library("groovy-json", "org.codehaus.groovy", "groovy-json").versionRef("groovy")
            library("groovy-nio", "org.codehaus.groovy", "groovy-nio").versionRef("groovy")
            library("commons-lang3", "org.apache.commons", "commons-lang3").version {
                strictly("[3.8, 4.0[")
                prefer("3.9")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        libs {
            version('groovy', '3.0.5')
            version('checkstyle', '8.37')
            library('groovy-core', 'org.codehaus.groovy', 'groovy').versionRef('groovy')
            library('groovy-json', 'org.codehaus.groovy', 'groovy-json').versionRef('groovy')
            library('groovy-nio', 'org.codehaus.groovy', 'groovy-nio').versionRef('groovy')
            library('commons-lang3', 'org.apache.commons', 'commons-lang3').version {
                strictly '[3.8, 4.0['
                prefer '3.9'
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Don&#8217;t use <code>libs</code> for your programmatic version catalog name if you have the default <code>libs.versions.toml</code> in your project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Creating a version catalog programmatically uses the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/Settings.html">Settings API</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            version("groovy", "3.0.5")
            version("checkstyle", "8.37")
            library("groovy-core", "org.codehaus.groovy", "groovy").versionRef("groovy")
            library("groovy-json", "org.codehaus.groovy", "groovy-json").versionRef("groovy")
            library("groovy-nio", "org.codehaus.groovy", "groovy-nio").versionRef("groovy")
            library("commons-lang3", "org.apache.commons", "commons-lang3").version {
                strictly("[3.8, 4.0[")
                prefer("3.9")
            }
            bundle("groovy", listOf("groovy-core", "groovy-json", "groovy-nio"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    versionCatalogs {
        libs {
            version('groovy', '3.0.5')
            version('checkstyle', '8.37')
            library('groovy-core', 'org.codehaus.groovy', 'groovy').versionRef('groovy')
            library('groovy-json', 'org.codehaus.groovy', 'groovy-json').versionRef('groovy')
            library('groovy-nio', 'org.codehaus.groovy', 'groovy-nio').versionRef('groovy')
            library('commons-lang3', 'org.apache.commons', 'commons-lang3').version {
                strictly '[3.8, 4.0['
                prefer '3.9'
            }
            bundle('groovy', ['groovy-core', 'groovy-json', 'groovy-nio'])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:buildsrc-version-catalog"><a class="anchor" href="#sec:buildsrc-version-catalog"></a><a class="link" href="#sec:buildsrc-version-catalog">Using a catalog in <code>buildSrc</code></a></h4>
<div class="paragraph">
<p>Version catalogs provide a centralized way to manage dependencies in a  project.
However, <strong><code>buildSrc</code> does not automatically inherit the version catalog from the main project</strong>, so additional configuration is required.</p>
</div>
<div class="paragraph">
<p>To access a version catalog inside <code>buildSrc</code>, you need to explicitly import it in <code>buildSrc/settings.gradle(.kts)</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Add the version catalog to buildSrc using dependencyResolutionManagement
dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            from(files("../gradle/libs.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Add the version catalog to buildSrc using dependencyResolutionManagement
dependencyResolutionManagement {
    versionCatalogs {
        create("libs") {
            from(files("../gradle/libs.versions.toml"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the version catalog is imported, dependencies can be referenced using a few tricks:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
    alias(libs.plugins.versions) // Access version catalog in buildSrc build file for plugin
}

repositories {
    gradlePluginPortal()
}

dependencies {
    // Access version catalog in buildSrc build file for dependencies
    implementation(plugin(libs.plugins.jacocolog)) // Plugin dependency
    implementation(libs.groovy.core) // Regular library from version catalog
    implementation("org.apache.commons:commons-lang3:3.9") // Direct dependency
}

// Helper function that transforms a Gradle Plugin alias from a
// Version Catalog into a valid dependency notation for buildSrc
fun DependencyHandlerScope.plugin(plugin: Provider&lt;PluginDependency&gt;) =
    plugin.map { "${it.pluginId}:${it.pluginId}.gradle.plugin:${it.version}" }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy-gradle-plugin'
    alias(libs.plugins.versions) // Access version catalog in buildSrc for plugin
}

repositories {
    gradlePluginPortal()
}

def catalogs = project.extensions.getByType(VersionCatalogsExtension)
def libs = catalogs.named("libs")

dependencies {
    // Access version catalog in buildSrc for dependencies
    implementation plugin(libs.findPlugin("jacocolog").get()) // Plugin dependency
    implementation libs.findLibrary("groovy-core").get() // Regular library from version catalog
    implementation "org.apache.commons:commons-lang3:3.9" // Direct dependency
}

// Helper function that transforms a Gradle Plugin alias from a
// Version Catalog into a valid dependency notation for buildSrc
def plugin(Provider&lt;PluginDependency&gt; plugin) {
    return plugin.map { it.pluginId + ":" + it.pluginId + ".gradle.plugin:" + it.version }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In <strong>precompiled script plugins</strong> inside <code>buildSrc</code>, the version catalog can be accessed using <code>extensions.getByType(VersionCatalogsExtension)</code> as demonstrated in the dependencies block of this convention plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/java-commons-convention.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")

    //alias(libs.plugins.jacocolog) // Unfortunately it is not possible the version catalog in buildSrc code for plugins

    // Remember that unlike regular Gradle projects, convention plugins in buildSrc do not automatically resolve
    // external plugins. We must declare them as dependencies in buildSrc/build.gradle.kts.
    id("org.barfuin.gradle.jacocolog") // Apply the plugin manually as a workaround with the external plugin
                                       // version from the version catalog specified in implementation dependency
                                       // artifact in build file
}

repositories {
    mavenCentral()
}

// Access the version catalog
val libs = extensions.getByType(VersionCatalogsExtension::class.java).named("libs")
//val libs = the&lt;VersionCatalogsExtension&gt;().named("libs")

dependencies {
    // Access version catalog in buildSrc code for dependencies
    implementation(libs.findLibrary("guava").get()) // Regular library from version catalog
    testImplementation(platform("org.junit:junit-bom:5.9.1")) // Platform dependency
    testImplementation("org.junit.jupiter:junit-jupiter") // Direct dependency
}

tasks.test {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/java-commons-convention.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'

    // alias(libs.plugins.jacocolog) - Unfortunately, it is not possible to use the version catalog for plugins in buildSrc

    // Unlike regular Gradle projects, convention plugins in buildSrc do not automatically resolve
    // external plugins. We must declare them as dependencies in buildSrc/build.gradle.
    id 'org.barfuin.gradle.jacocolog' // Apply the plugin manually as a workaround
    // The external plugin version comes from the implementation dependency
    // artifact in the build file
}

repositories {
    mavenCentral()
}

// Access the version catalog
def libs = project.extensions.getByType(VersionCatalogsExtension).named("libs")

dependencies {
    // Access version catalog in buildSrc for dependencies
    implementation libs.findLibrary("guava").get() // Regular library from version catalog
    testImplementation platform("org.junit:junit-bom:5.9.1") // Platform dependency
    testImplementation "org.junit.jupiter:junit-jupiter" // Direct dependency
}

tasks.withType(Test).configureEach {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, the plugins block in the <strong>precompiled script plugin</strong> cannot access the version catalog.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="platforms-vs-catalog"><a class="anchor" href="#platforms-vs-catalog"></a><a class="link" href="#platforms-vs-catalog">Using Catalogs with Platforms</a></h3>
<div class="paragraph">
<p>Both platforms and version catalogs help manage dependency versions in a project, but they serve different purposes and have different effects on dependency resolution:</p>
</div>
<div class="sect3">
<h4 id="sec:version-catalogs"><a class="anchor" href="#sec:version-catalogs"></a><a class="link" href="#sec:version-catalogs">Version Catalogs</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> A version catalog centralizes and standardizes dependency coordinates (group, name, version) and provides type-safe accessors in the build script, making dependencies easier to manage.</p>
</li>
<li>
<p><strong>Effect on Dependency Graph:</strong> Version catalogs <strong>do not</strong> directly affect dependency resolution. The versions defined in the catalog must be explicitly referenced in a <code>dependencies</code> block, and once referenced, they behave the same as any locally declared dependency. Additionally, the catalog&#8217;s contents are <strong>transparent to downstream consumers</strong>, meaning that consumers cannot identify whether a dependency was declared locally or sourced from a catalog.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[libraries]
mylib = { group = "com.example", name = "mylib", version = "1.0.0" }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:platforms"><a class="anchor" href="#sec:platforms"></a><a class="link" href="#sec:platforms">Platforms</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Purpose:</strong> A platform is a module in the dependency graph that enforces or aligns versions of dependencies (including transitive dependencies). It influences dependency resolution and ensures version consistency across different modules.</p>
</li>
<li>
<p><strong>Effect on Dependency Graph:</strong> Platforms <strong>apply</strong> or <strong>enforce</strong> versions to dependencies that are declarated locally without versions.  These versions in a platform are propagated through the dependency graph, affecting transitive dependencies and downstream consumers. They are a formal part of the dependency graph and can dictate the version chosen during resolution.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}

dependencies {
    constraints {
        api("com.example:mylib:2.0.0")
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:catalog-platform"><a class="anchor" href="#sec:catalog-platform"></a><a class="link" href="#sec:catalog-platform">Using a catalog with a platform</a></h4>
<div class="paragraph">
<p>Even if a version catalog defines a version for a dependency, Gradle might pick a different version during resolution if another component (e.g., a platform or a transitive dependency) suggests a different version (unless <a href="#sec:enforced-platform"><code>enforcedPlatform</code></a> is used).</p>
</div>
<div class="paragraph">
<p>For example, a version catalog may define <code>mylib</code> as version <code>1.0.0</code>, but if a platform enforces <code>2.0.0</code>, Gradle will select version <code>2.0.0</code>.</p>
</div>
<div class="paragraph">
<p>To ensure consistent version alignment, a good approach is to use a version catalog to define dependency versions alongside a platform to enforce them.</p>
</div>
<div class="paragraph">
<p>Version Catalog:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">gradle/libs.versions.toml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[versions]
junit-jupiter = "5.10.3"

[libraries]
guava = { module = "com.google.guava:guava"}
junit-jupiter = { module = "org.junit.jupiter:junit-jupiter", version.ref = "junit-jupiter" }
junit-jupiter-launcher = { module = "org.junit.platform:junit-platform-launcher" }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Platform:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">platform/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}

javaPlatform {
    allowDependencies()
}

dependencies {
    constraints {
        api("org.junit.jupiter:junit-jupiter:5.11.1") // Enforcing specific version
        api("com.google.guava:guava:[33.1.0-jre,)") // Enforcing version range
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">platform/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-platform'
}

javaPlatform {
    allowDependencies()
}

dependencies {
    constraints {
        api 'org.junit.jupiter:junit-jupiter:5.11.1' // Enforcing specific version
        api 'com.google.guava:guava:[33.1.0-jre,)' // Enforcing version range
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Consumer:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // Platform
    implementation(platform(project(":platform")))
    // Catalog
    testImplementation(libs.junit.jupiter)
    testRuntimeOnly(libs.junit.jupiter.launcher)
    implementation(libs.guava)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // Platform
    implementation platform(project(":platform"))
    // Catalog
    testImplementation libs.junit.jupiter
    testRuntimeOnly libs.junit.jupiter.launcher
    implementation libs.guava
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Best Practices for using both a catalog and a platform:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use version catalogs</strong> for defining and sharing dependency coordinates across projects. They make dependency declarations consistent and easier to manage but do not guarantee version alignment.</p>
</li>
<li>
<p><strong>Use platforms</strong> when you need to influence or enforce version alignment across modules. Platforms ensure that dependencies resolve to the desired version, particularly in large or multi-module projects.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing_dependencies"><a class="anchor" href="#managing_dependencies"></a><a class="link" href="#managing_dependencies">MANAGING DEPENDENCIES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="locking-versions"><a class="anchor" href="#locking-versions"></a><a class="link" href="#locking-versions">Locking Versions</a></h3>
<div class="paragraph">
<p>Using <a href="#sec:declaring-dependency-with-dynamic-version">dynamic dependency versions</a> (e.g., <code>1.+</code> or <code>[1.0,2.0)</code>) can cause builds to break unexpectedly because the exact version of a dependency that gets resolved can change over time:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // Depend on the latest 5.x release of Spring available in the searched repositories
    implementation("org.springframework:spring-web:5.+")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // Depend on the latest 5.x release of Spring available in the searched repositories
    implementation 'org.springframework:spring-web:5.+'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To ensure <a href="https://reproducible-builds.org/">reproducible builds</a>, it&#8217;s necessary to <strong>lock versions</strong> of dependencies and their transitive dependencies.
This guarantees that a build with the same inputs will always resolve to the same module versions, a process known as <strong>dependency locking</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Dependency locking</strong> is a process where Gradle saves the resolved versions of dependencies to a lock file, ensuring that subsequent builds use the same dependency versions.
This lock state is stored in a file and helps to prevent unexpected changes in the dependency graph.</p>
</div>
<div class="paragraph">
<p>Dependency locking offers several key advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Avoiding Cascading Failures</strong>: Teams managing multiple repositories no longer need to rely on <code>-SNAPSHOT</code> or changing dependencies, which can lead to unexpected failures if a dependency introduces a bug or incompatibility.</p>
</li>
<li>
<p><strong>Dynamic Version Flexibility with Stability</strong>: Teams that use the latest versions of dependencies can rely on dynamic versions during development and testing phases, locking them only for releases.</p>
</li>
<li>
<p><strong>Publishing Resolved Versions</strong>: By combining dependency locking with the practice of <a href="#publishing_maven:resolved_dependencies">publishing resolved versions</a>, dynamic versions are replaced with the actual resolved versions at the time of publication.</p>
</li>
<li>
<p><strong>Optimizing Build Cache Usage</strong>: Since dynamic or changing dependencies violate the principle of <a href="#stable_task_inputs">stable task inputs</a>, locking dependencies ensures that tasks have consistent inputs.</p>
</li>
<li>
<p><strong>Enhanced Development Workflow</strong>: Developers can lock dependencies locally for stability while working on a feature or debugging an issue, while CI environments can test the latest <code>SNAPSHOT</code> or nightly versions to provide early feedback on integration issues. This allows teams to balance stability and early feedback during development.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec:dependency-locking"><a class="anchor" href="#sec:dependency-locking"></a><a class="link" href="#sec:dependency-locking">Activate locking for specific configurations</a></h4>
<div id="dependency-locking" class="paragraph">
<p>Locking is enabled per <a href="dependency_configurations.html#sub:what-are-dependency-configurations">dependency configuration</a>.</p>
</div>
<div class="paragraph">
<p>Once enabled, you must create an initial lock state, causing Gradle to verify that resolution results do not change.
This ensures that if the selected dependencies differ from the locked ones (due to newer versions being available), the build will fail, preventing unexpected version changes.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency locking is effective with <a href="#sec:declaring-dependency-with-dynamic-version">dynamic versions</a>, but it <strong>should not be used</strong> with <a href="#sec:declaring-dependency-with-changing-version">changing versions</a> (e.g., <code>-SNAPSHOT</code>), where the coordinates remain the same, but the content may change.</p>
</div>
<div class="paragraph">
<p>Using dependency locking with changing versions indicates a misunderstanding of these features and can lead to unpredictable results.</p>
</div>
<div class="paragraph">
<p>Gradle will emit a warning when persisting the lock state if changing dependencies are present in the resolution result.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Locking of a configuration happens through the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> API:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Only configurations that can be resolved will have lock state attached to them.
Applying locking on non resolvable-configurations is a no-op.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:activate-locking-for-all"><a class="anchor" href="#sec:activate-locking-for-all"></a><a class="link" href="#sec:activate-locking-for-all">Activate locking for all configurations</a></h4>
<div class="paragraph">
<p>The following locks all configurations:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyLocking {
    lockAllConfigurations()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyLocking {
    lockAllConfigurations()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The above will lock all <em>project</em> configurations, but not the <em>buildscript</em> ones.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:disable-locking"><a class="anchor" href="#sec:disable-locking"></a><a class="link" href="#sec:disable-locking">Disable locking for specific configurations</a></h4>
<div class="paragraph">
<p>You can also disable locking on a specific configuration.</p>
</div>
<div class="paragraph">
<p>This can be useful if a plugin configured locking on all configurations, but you happen to add one that should not be locked:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.compileClasspath {
    resolutionStrategy.deactivateDependencyLocking()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.deactivateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:activate-locking-build-script"><a class="anchor" href="#sec:activate-locking-build-script"></a><a class="link" href="#sec:activate-locking-build-script">Activate locking for a buildscript classpath configuration</a></h4>
<div class="paragraph">
<p>If you apply plugins to your build, you may want to leverage dependency locking there as well.</p>
</div>
<div class="paragraph">
<p>To lock the <a href="plugins_intermediate.html#sec:applying_plugins_buildscript"><code>classpath</code> configuration</a> used for script plugins:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">buildscript {
    configurations.classpath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildscript {
    configurations.classpath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:generate-locks"><a class="anchor" href="#sec:generate-locks"></a><a class="link" href="#sec:generate-locks">Generating and updating dependency locks</a></h4>
<div class="paragraph">
<p>To generate or update the lock state, add the <code>--write-locks</code> argument while invoking whatever tasks that would trigger the locked configurations to be resolved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew dependencies --write-locks</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create or update the lock state for each resolved configuration during that build execution.
If a lock state already exists, it will be overwritten.</p>
</div>
<div class="listingblock">
<div class="title">gradle.lockfile</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"># This is a Gradle generated file for dependency locking.
# Manual edits can break the build and are not advised.
# This file is expected to be part of source control.
com.google.code.findbugs:jsr305:3.0.2=classpath
com.google.errorprone:error_prone_annotations:2.3.2=classpath
com.google.gradle:osdetector-gradle-plugin:1.7.1=classpath
com.google.guava:failureaccess:1.0.1=classpath
com.google.guava:guava:28.1-jre=classpath
com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava=classpath
com.google.j2objc:j2objc-annotations:1.3=classpath
empty=</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle won&#8217;t write the lock state to disk if the build fails, preventing the persistence of potentially invalid states.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec:lock-all-configurations-in-one-build-execution"><a class="anchor" href="#sec:lock-all-configurations-in-one-build-execution"></a><a class="link" href="#sec:lock-all-configurations-in-one-build-execution">Lock all configurations in a single build execution</a></h5>
<div id="lock_all_configurations_in_one_build_execution" class="paragraph">
<p>When working with multiple configurations, you may want to lock them all at once in a single build execution.
You have two options for this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Run <code>gradle dependencies --write-locks</code>:</strong></p>
<div class="ulist">
<ul>
<li>
<p>This command will lock all resolvable configurations that have locking enabled.</p>
</li>
<li>
<p>In a multi-project setup, note that <code>dependencies</code> is executed only on one project, typically the root project.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Declare a Custom Task to Resolve All Configurations:</strong></p>
<div class="ulist">
<ul>
<li>
<p>This approach is particularly useful if you need more control over which configurations are locked.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This custom task resolves all configurations, locking them in the process:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("resolveAndLockAll") {
    notCompatibleWithConfigurationCache("Filters configurations at execution time")
    doFirst {
        require(gradle.startParameter.isWriteDependencyLocks) { "$path must be run from the command line with the `--write-locks` flag" }
    }
    doLast {
        configurations.filter {
            // Add any custom filtering on the configurations to be resolved
            it.isCanBeResolved
        }.forEach { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('resolveAndLockAll') {
    notCompatibleWithConfigurationCache("Filters configurations at execution time")
    doFirst {
        assert gradle.startParameter.writeDependencyLocks : "$path must be run from the command line with the `--write-locks` flag"
    }
    doLast {
        configurations.findAll {
            // Add any custom filtering on the configurations to be resolved
            it.canBeResolved
        }.each { it.resolve() }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By filtering and resolving specific configurations, you ensure that only the relevant ones are locked, tailoring the locking process to your project&#8217;s needs.
This is especially useful in environments like native builds, where not all configurations can be resolved on a single platform.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="understanding_the_locking_mechanism_during_dependency_resolution"><a class="anchor" href="#understanding_the_locking_mechanism_during_dependency_resolution"></a><a class="link" href="#understanding_the_locking_mechanism_during_dependency_resolution">Understanding the locking mechanism during dependency resolution</a></h4>
<div class="paragraph">
<p>When using dependency locking, Gradle enforces the locked versions as if they were declared with <code>strictly()</code>.</p>
</div>
<div class="paragraph">
<p>This means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the declared version is <strong>lower</strong> than the locked version (e.g., declared <code>1.0.0</code>, locked <code>1.2.0</code>), Gradle will silently upgrade to the locked version.</p>
</li>
<li>
<p>If the declared version is <strong>higher</strong> than the locked version (e.g., declared <code>1.2.0</code>, locked <code>1.0.0</code>), Gradle will <strong>fail resolution</strong>, because the lockfile enforces <code>1.0.0</code> strictly.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This can be surprising if you assume the declared version takes precedence.
To resolve this, update the lockfile with <code>--write-locks</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:lock-state"><a class="anchor" href="#sec:lock-state"></a><a class="link" href="#sec:lock-state">Understanding lock state location and format</a></h4>
<div class="paragraph">
<p>A lockfile is a critical component that records the exact versions of dependencies used in a project, allowing for verification during builds to ensure consistent results across different environments and over time.
It helps identify discrepancies in dependencies when a project is built on different machines or at different times.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Lockfiles should be checked in to source control.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="location_of_lock_files"><a class="anchor" href="#location_of_lock_files"></a><a class="link" href="#location_of_lock_files">Location of lock files</a></h5>
<div class="ulist">
<ul>
<li>
<p>The lock state is preserved in a file named <code>gradle.lockfile</code>, located at the root of each project or subproject directory.</p>
</li>
<li>
<p>The exception is the lockfile for the <a href="plugins_intermediate.html#sec:applying_plugins_buildscript">buildscript itself</a>, which is named <code>buildscript-gradle.lockfile</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="structure_of_lock_files"><a class="anchor" href="#structure_of_lock_files"></a><a class="link" href="#structure_of_lock_files">Structure of lock files</a></h5>
<div class="paragraph">
<p>Consider the following dependency declaration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    runtimeClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    annotationProcessor {
        resolutionStrategy.activateDependencyLocking()
    }
}

dependencies {
    implementation("org.springframework:spring-beans:[5.0,6.0)")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    runtimeClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
    annotationProcessor {
        resolutionStrategy.activateDependencyLocking()
    }
}

dependencies {
    implementation 'org.springframework:spring-beans:[5.0,6.0)'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With the above configuration, the generated <code>gradle.lockfile</code> will look like this:</p>
</div>
<div class="listingblock">
<div class="title">gradle.lockfile</div>
<div class="content">
<pre># This is a Gradle generated file for dependency locking.
# Manual edits can break the build and are not advised.
# This file is expected to be part of source control.
org.springframework:spring-beans:5.0.5.RELEASE=compileClasspath, runtimeClasspath
org.springframework:spring-core:5.0.5.RELEASE=compileClasspath, runtimeClasspath
org.springframework:spring-jcl:5.0.5.RELEASE=compileClasspath, runtimeClasspath
empty=annotationProcessor</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Each line</strong> represents a single dependency in the <code>group:artifact:version</code> format.</p>
</li>
<li>
<p><strong>Configurations:</strong> After the version, the configurations that include the dependency are listed.</p>
</li>
<li>
<p><strong>Ordering:</strong> Dependencies and configurations are listed alphabetically to make version control diffs easier to manage.</p>
</li>
<li>
<p><strong>Empty Configurations:</strong> The last line lists configurations that are empty, meaning they contain no dependencies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This <strong>lockfile should be included in source control</strong> to ensure that all team members and environments use the exact same dependency versions.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:migrate-single-lockfile"><a class="anchor" href="#sec:migrate-single-lockfile"></a><a class="link" href="#sec:migrate-single-lockfile">Migrating your legacy lockfile</a></h4>
<div id="migrate_single_lockfile" class="paragraph">
<p>If your project uses the legacy lock file format of a file per locked configuration, follow these instructions to migrate to the new format:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow the documentation for <a href="#sec:lock-all-configurations-in-one-build-execution">writing</a> or <a href="#sec:selectively-updating-lock-state-entries">updating</a> dependency lock state.</p>
</li>
<li>
<p>Upon writing the single lock file per project, Gradle will also delete all lock files per configuration for which the state was transferred.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Migration can be done one configuration at a time. Gradle will keep sourcing the lock state from the per configuration files as long as there is no information for that configuration in the single lock file.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring-the-per-project-lock-file-name-and-location"><a class="anchor" href="#sec:configuring-the-per-project-lock-file-name-and-location"></a><a class="link" href="#sec:configuring-the-per-project-lock-file-name-and-location">Configuring the lock file name and location</a></h4>
<div id="configuring_the_per_project_lock_file_name_and_location" class="paragraph">
<p>When using a single lock file per project, you can configure its name and location.</p>
</div>
<div class="paragraph">
<p>This capability allows you to specify a file name based on project properties, enabling a single project to store different lock states for different execution contexts.</p>
</div>
<div class="paragraph">
<p>For example, in the JVM ecosystem, the Scala version is often included in artifact coordinates:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val scalaVersion = "2.12"
dependencyLocking {
    lockFile = file("$projectDir/locking/gradle-${scalaVersion}.lockfile")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def scalaVersion = "2.12"
dependencyLocking {
    lockFile = file("$projectDir/locking/gradle-${scalaVersion}.lockfile")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:run-build-lock-state"><a class="anchor" href="#sec:run-build-lock-state"></a><a class="link" href="#sec:run-build-lock-state">Running a build with lock state present</a></h4>
<div class="paragraph">
<p>The moment a build needs to resolve a configuration that has locking enabled, and it finds a matching lock state,
it will use it to verify that the given configuration still resolves the same versions.</p>
</div>
<div class="paragraph">
<p>A successful build indicates that the same dependencies are used by your build as stored in the lock state, regardless if new versions matching the dynamic selector are available in any of the repositories your build uses.</p>
</div>
<div class="paragraph">
<p>The complete validation is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Existing entries in the lock state must be matched in the build</p>
<div class="ulist">
<ul>
<li>
<p>A version mismatch or missing resolved module causes a build failure</p>
</li>
</ul>
</div>
</li>
<li>
<p>Resolution result must not contain extra dependencies compared to the lock state</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:fine-tuning-dependency-locking-behaviour-with-lock-mode"><a class="anchor" href="#sec:fine-tuning-dependency-locking-behaviour-with-lock-mode"></a><a class="link" href="#sec:fine-tuning-dependency-locking-behaviour-with-lock-mode">Fine-tuning dependency locking behaviour with lock mode</a></h5>
<div id="fine_tuning_dependency_locking_behaviour_with_lock_mode" class="paragraph">
<p>While the default lock mode behaves as described above, two other modes are available:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Strict mode</dt>
<dd>
<p>In this mode, in addition to the validations above, dependency locking will fail if a configuration marked as <em>locked</em> does not have lock state associated with it.</p>
</dd>
<dt class="hdlist1">Lenient mode</dt>
<dd>
<p>In this mode, dependency locking will still pin dynamic versions but otherwise changes to the dependency resolution are no longer errors.
Other changes include:</p>
<div class="ulist">
<ul>
<li>
<p>Adding or removing dependencies, even if they are strictly versioned, without causing a build failure.</p>
</li>
<li>
<p>Allowing transitive dependencies to shift, as long as dynamic versions are still pinned.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This mode offers flexibility for situations where you might want to explore or test new dependencies or changes in versions without breaking the build, making it useful for testing nightly or snapshot builds.</p>
</div>
<div class="paragraph">
<p>The lock mode can be controlled from the <code>dependencyLocking</code> block as shown below:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyLocking {
    lockMode = LockMode.STRICT
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyLocking {
    lockMode = LockMode.STRICT
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:selectively-updating-lock-state-entries"><a class="anchor" href="#sec:selectively-updating-lock-state-entries"></a><a class="link" href="#sec:selectively-updating-lock-state-entries">Updating lock state entries selectively</a></h4>
<div id="selectively_updating_lock_state_entries" class="paragraph">
<p>In order to update only specific modules of a configuration, you can use the <code>--update-locks</code> command line flag.
It takes a comma (<code>,</code>) separated list of module notations.
In this mode, the existing lock state is still used as input to resolution, filtering out the modules targeted by the update:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew dependencies --update-locks org.apache.commons:commons-lang3,org.slf4j:slf4j-api</pre>
</div>
</div>
<div class="paragraph">
<p>Wildcards, indicated with <code>*</code>, can be used in the group or module name.
They can be the only character or appear at the end of the group or module respectively.
The following wildcard notation examples are valid:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.apache.commons:*</code>: will let all modules belonging to group <code>org.apache.commons</code> update</p>
</li>
<li>
<p><code>*:guava</code>: will let all modules named <code>guava</code>, whatever their group, update</p>
</li>
<li>
<p><code>org.springframework.spring*:spring*</code>: will let all modules having their group starting with <code>org.springframework.spring</code> and name starting with <code>spring</code> update</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The resolution may cause other module versions to update, as dictated by the Gradle resolution rules.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling-locking"><a class="anchor" href="#sec:disabling-locking"></a><a class="link" href="#sec:disabling-locking">Disabling dependency locking</a></h4>
<div class="paragraph">
<p>To disable dependency locking for a configuration:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Remove Locking Configuration:</strong>
Ensure that the configuration you no longer want to lock is not configured with dependency locking. This means removing or commenting out any <code>activateDependencyLocking()</code> calls for that configuration.</p>
</li>
<li>
<p><strong>Update Lock State:</strong>
The next time you update and save the lock state (using the <code>--write-locks</code> option), Gradle will automatically clean up any stale lock state associated with the configurations that are no longer locked.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle must resolve a configuration that is no longer marked as locked to detect and drop the associated lock state. Without resolving the configuration, Gradle cannot identify which lock state should be cleaned up.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:ignoring-specific-dependencies-lock-state"><a class="anchor" href="#sec:ignoring-specific-dependencies-lock-state"></a><a class="link" href="#sec:ignoring-specific-dependencies-lock-state">Ignoring specific dependencies from the lock state</a></h4>
<div id="ignoring_dependencies" class="paragraph">
<p>In some scenarios, you may want to use dependency locking for other reasons than build reproducibility.</p>
</div>
<div class="paragraph">
<p>As a build author, you might want certain dependencies to update more frequently than others.
For example, internal dependencies within an organization might always use the latest version, while third-party dependencies follow a different update cycle.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
This approach can compromise reproducibility. Consider using <a href="#sec:fine-tuning-dependency-locking-behaviour-with-lock-mode">different lock modes</a> or <a href="#sec:configuring-the-per-project-lock-file-name-and-location">separate lock files</a> for specific cases.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can configure dependencies to be ignored in the <code>dependencyLocking</code> project extension:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyLocking {
    ignoredDependencies.add("com.example:*")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyLocking {
    ignoredDependencies.add('com.example:*')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The notation <code>&lt;group&gt;:&lt;name&gt;</code> is used to specify dependencies, where <code>*</code> acts as a trailing wildcard. Note that <code>*:*</code> is not accepted, as it effectively disables locking.
See <a href="#sec:selectively-updating-lock-state-entries">the description</a> on updating lock files for more details.</p>
</div>
<div class="paragraph">
<p>Ignoring dependencies will have the following effects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ignored dependencies apply across all locked configurations, and the setting is project scoped.</p>
</li>
<li>
<p>Ignoring a dependency does not exclude its transitive dependencies from the lock state.</p>
</li>
<li>
<p>No validation ensures that an ignored dependency is present in any configuration resolution.</p>
</li>
<li>
<p>If the dependency is present in lock state, loading it will filter out the dependency.</p>
</li>
<li>
<p>If the dependency is present in the resolution result, it will be ignored when validating the resolution against the lock state.</p>
</li>
<li>
<p>When the lock state is updated and persisted, any ignored dependency will be omitted from the written lock state.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:locking-limitations"><a class="anchor" href="#sec:locking-limitations"></a><a class="link" href="#sec:locking-limitations">Understanding locking limitations</a></h4>
<div id="locking_limitations" class="ulist">
<ul>
<li>
<p>Dependency locking does not currently apply to source dependencies.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-resolution-rules"><a class="anchor" href="#using-resolution-rules"></a><a class="link" href="#using-resolution-rules">Using Resolution Rules</a></h3>
<div class="paragraph">
<p>Gradle provides several mechanisms to directly influence the behavior of the dependency resolution engine.</p>
</div>
<div class="paragraph">
<p>Unlike <a href="#dependency-constraints">dependency constraints</a> or <a href="#component-metadata-rules">component metadata rules</a>, which serve as inputs to the resolution process, these mechanisms allow you to inject rules directly into the resolution engine.
Because of their direct impact, they can be considered brute-force solutions that may mask underlying issues, such as the introduction of new dependencies.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It&#8217;s generally advisable to resort to <strong>resolution rules</strong> only when other approaches are insufficient.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re developing a <a href="declaring_dependencies.html#sub:producers-vs-consumers-basics">library</a>, it&#8217;s best to use <a href="#dependency-constraints">dependency constraints</a>, as they are shared with your consumers.</p>
</div>
<div class="paragraph">
<p>Here are the key resolution strategies in Gradle:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Strategy</th>
<th class="tableblock halign-left valign-top">Info</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:forcing-dep-versions">1</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forcing Dependency Versions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Force a specific version of a dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:module-replacement">2</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Module Replacement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Substitute one module for another with an explanation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:dependency-substitution-rules">3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency Substitution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Substitute dependencies dynamically.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:component-selection-rules">4</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component Selection Rules</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control which versions of a module are allowed. Reject specific versions that are known to be broken or undesirable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:configuration-defaults">5</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting Default Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatically add dependencies to a configuration when no dependencies are explicitly declared.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:exclude-trans-deps">6</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Excluding Transitive Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude transitive dependencies that you dont want to be included in the dependency graph.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:conflict-resolution-strategy">7</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Force Failed Resolution Strategies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Force builds to fail when certain conditions occur during resolution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:disabling-resolution-transitive-dependencies">8</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabling Transitive Dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies are transitive by default, but you can disable this behavior for individual dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:dependency-resolve-rules">9</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency Resolve Rules and Other Conditionals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transform or filter dependencies directly as they are resolved and other corner case scenarios.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="sec:forcing-dep-versions"><a class="anchor" href="#sec:forcing-dep-versions"></a><a class="link" href="#sec:forcing-dep-versions">1. Forcing Dependency Versions</a></h4>
<div class="paragraph">
<p>You can enforce a specific version of a dependency, regardless of what versions might be requested or resolved by other parts of the build script.</p>
</div>
<div class="paragraph">
<p>This is useful for ensuring consistency and avoiding conflicts due to different versions of the same dependency being used.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    "compileClasspath" {
        resolutionStrategy.force("commons-codec:commons-codec:1.9")
    }
}

dependencies {
    implementation("org.apache.httpcomponents:httpclient:4.5.4")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.force 'commons-codec:commons-codec:1.9'
    }
}

dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.4'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Forcing a specific version of a dependency should be a conscious and deliberate decision. It can lead to conflicts or unexpected behavior, especially when transitive dependencies rely on different versions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:module-replacement"><a class="anchor" href="#sec:module-replacement"></a><a class="link" href="#sec:module-replacement">2. Module Replacement</a></h4>
<div class="paragraph">
<p>While it&#8217;s generally better to manage module conflicts using <a href="#capabilities">capabilities</a>, there are scenariosespecially when working with older versions of Gradle-that require a different approach.
In these cases, <strong>module replacement rules</strong> offer a solution by allowing you to specify that a legacy library has been replaced by a newer one.</p>
</div>
<div class="paragraph">
<p><strong>Module replacement rules</strong> allow you to declare that a legacy library has been replaced by a newer one.
For instance, the migration from <code>google-collections</code> to <code>guava</code> involved renaming the module from <code>com.google.collections:google-collections</code> to <code>com.google.guava:guava</code>.
Such changes impact conflict resolution because Gradle doesn&#8217;t treat them as version conflicts due to different module coordinates.</p>
</div>
<div class="paragraph">
<p>Consider a scenario where both libraries appear in the dependency graph.
Your project depends on <code>guava</code>, but a transitive dependency pulls in <code>google-collections</code>.
This can cause runtime errors since Gradle wont automatically resolve this as a conflict.
Common solutions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declaring an exclusion rule to avoid <code>google-collections</code>.</p>
</li>
<li>
<p>Avoiding dependencies that pull in legacy libraries.</p>
</li>
<li>
<p>Upgrading dependencies that no longer use <code>google-collections</code>.</p>
</li>
<li>
<p>Downgrading to <code>google-collections</code> (not recommended).</p>
</li>
<li>
<p>Assigning capabilities so <code>google-collections</code> and <code>guava</code> are mutually exclusive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods can be insufficient for large-scale projects.
By declaring module replacements, you can address this issue globally across projects, allowing organizations to handle such conflicts holistically.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    modules {
        module("com.google.collections:google-collections") {
            replacedBy("com.google.guava:guava", "google-collections is now part of Guava")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    modules {
        module("com.google.collections:google-collections") {
            replacedBy("com.google.guava:guava", "google-collections is now part of Guava")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once declared, Gradle treats any version of <code>guava</code> as superior to <code>google-collections</code> during conflict resolution, ensuring only <code>guava</code> appears in the classpath.
However, if <code>google-collections</code> is the only module present, it won&#8217;t be automatically replaced unless theres a conflict.</p>
</div>
<div class="paragraph">
<p>For more examples, refer to the DSL reference for <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/ComponentMetadataHandler.html">ComponentMetadataHandler</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle does not currently support replacing a module with multiple modules, but multiple modules can be replaced by a single module.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency-substitution-rules"><a class="anchor" href="#sec:dependency-substitution-rules"></a><a class="link" href="#sec:dependency-substitution-rules">3. Dependency Substitution</a></h4>
<div class="paragraph">
<p><strong>Dependency substitution rules</strong> allow for replacing project and module dependencies with specified alternatives, making them interchangeable.
While similar to dependency resolve rules, they offer more flexibility by enabling substitution between project and module dependencies.</p>
</div>
<div class="paragraph">
<p>However, adding a <strong>dependency substitution rule</strong> affects the timing of configuration resolution.
Instead of resolving on first use, the configuration is resolved during task graph construction, which can cause issues if the configuration is modified later or depends on modules published during task execution.</p>
</div>
<div class="paragraph">
<p>Explanation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A configuration can serve as input to a task and include project dependencies when resolved.</p>
</li>
<li>
<p>If a project dependency is an input to a task (via a configuration), then tasks to build those artifacts are added as dependencies.</p>
</li>
<li>
<p>To determine project dependencies that are inputs to a task, Gradle must resolve the configuration inputs.</p>
</li>
<li>
<p>Because the Gradle task graph is fixed once task execution has commenced, Gradle needs to perform this resolution prior to executing any tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Without substitution rules, Gradle assumes that external module dependencies dont reference project dependencies, simplifying dependency traversal.
With substitution rules, this assumption no longer holds, so Gradle must fully resolve the configuration to determine project dependencies.</p>
</div>
<div class="sect4">
<h5 id="sec:module-to-project-substitution"><a class="anchor" href="#sec:module-to-project-substitution"></a><a class="link" href="#sec:module-to-project-substitution">Substituting an external module dependency with a project dependency</a></h5>
<div class="paragraph">
<p>Dependency substitution can be used to replace an external module with a locally developed project, which is helpful when testing a patched or unreleased version of a module.</p>
</div>
<div class="paragraph">
<p>The external module can be replaced whether a version is specified:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(module("org.utils:api"))
            .using(project(":api")).because("we work with the unreleased development version")
        substitute(module("org.utils:util:2.5")).using(project(":util"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute module("org.utils:api") using project(":api") because "we work with the unreleased development version"
        substitute module("org.utils:util:2.5") using project(":util")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Substituted projects must be part of the multi-project build (included via <code>settings.gradle</code>).</p>
</li>
<li>
<p>The substitution replaces the module dependency with the project dependency and sets up task dependencies, but doesn&#8217;t automatically include the project in the build.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:project-to-module-substitution"><a class="anchor" href="#sec:project-to-module-substitution"></a><a class="link" href="#sec:project-to-module-substitution">Substituting a project dependency with a module replacement</a></h5>
<div class="paragraph">
<p>You can also use substitution rules to replace a project dependency with an external module in a multi-project build.</p>
</div>
<div class="paragraph">
<p>This technique can accelerate development by allowing certain dependencies to be downloaded from a repository instead of being built locally:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(project(":api"))
            .using(module("org.utils:api:1.3")).because("we use a stable version of org.utils:api")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute project(":api") using module("org.utils:api:1.3") because "we use a stable version of org.utils:api"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The substituted module must include a version.</p>
</li>
<li>
<p>Even after substitution, the project remains part of the multi-project build, but tasks to build it won&#8217;t be executed when resolving the configuration.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:conditional-dependency-substitution"><a class="anchor" href="#sec:conditional-dependency-substitution"></a><a class="link" href="#sec:conditional-dependency-substitution">Conditionally substituting a dependency</a></h5>
<div class="paragraph">
<p>You can conditionally substitute a module dependency with a local project in a multi-project build using dependency substitution rules.</p>
</div>
<div class="paragraph">
<p>This is particularly useful when you want to use a locally developed version of a dependency if it exists, otherwise fall back to the external module:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution.all {
        requested.let {
            if (it is ModuleComponentSelector &amp;&amp; it.group == "org.example") {
                val targetProject = findProject(":${it.module}")
                if (targetProject != null) {
                    useTarget(targetProject)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution.all { DependencySubstitution dependency -&gt;
        if (dependency.requested instanceof ModuleComponentSelector &amp;&amp; dependency.requested.group == "org.example") {
            def targetProject = findProject(":${dependency.requested.module}")
            if (targetProject != null) {
                dependency.useTarget targetProject
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The substitution only occurs if a local project matching the dependency name is found.</p>
</li>
<li>
<p>The local project must already be included in the multi-project build (via <code>settings.gradle</code>).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:variant-aware-substitutions"><a class="anchor" href="#sec:variant-aware-substitutions"></a><a class="link" href="#sec:variant-aware-substitutions">Substituting a dependency with another variant</a></h5>
<div class="paragraph">
<p>You can substitute a dependency with another <a href="variant_aware_resolution.html#sec:understanding-variant-selection">variant</a>, such as switching between a platform dependency and a regular library dependency.</p>
</div>
<div class="paragraph">
<p>This is useful when your build process needs to change the type of dependency based on specific conditions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        all {
            if (requested is ModuleComponentSelector &amp;&amp; requested.group == "org.example" &amp;&amp; requested.version == "1.0") {
                useTarget(module("org.example:library:1.0")).because("Switching from platform to library variant")
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The substitution is based on the requested dependency&#8217;s attributes (like group and version).</p>
</li>
<li>
<p>This approach allows you to switch from a platform component to a library or vice versa.</p>
</li>
<li>
<p>It uses Gradle&#8217;s variant-aware engine to ensure the correct variant is selected based on the configuration and consumer attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This flexibility is often required when working with complex dependency graphs where different component types (platforms, libraries) need to be swapped dynamically.</p>
</div>
<div class="sect5">
<h6 id="sec:substitution-with-attributes"><a class="anchor" href="#sec:substitution-with-attributes"></a><a class="link" href="#sec:substitution-with-attributes">Substituting a dependency with attributes</a></h6>
<div class="paragraph">
<p>Substituting a dependency based on attributes allows you to override the default selection of a component by targeting specific attributes (like platform vs. regular library).</p>
</div>
<div class="paragraph">
<p>This technique is useful for managing platform and library dependencies in complex builds, particularly when you want to consume a regular library but the platform dependency was incorrectly declared:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // This is a platform dependency but you want the library
    implementation(platform("com.google.guava:guava:28.2-jre"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // This is a platform dependency but you want the library
    implementation platform('com.google.guava:guava:28.2-jre')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the substitution rule targets the platform version of <code>com.google.guava:guava</code> and replaces it with the regular library version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(platform(module("com.google.guava:guava:28.2-jre")))
            .using(module("com.google.guava:guava:28.2-jre"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(platform(module('com.google.guava:guava:28.2-jre'))).
            using module('com.google.guava:guava:28.2-jre')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Without the <code>platform</code> keyword, the substitution would not specifically target the platform dependency.</p>
</div>
<div class="paragraph">
<p>The following rule performs the same substitution but uses the more granular <strong>variant</strong> notation, allowing for customization of the dependency&#8217;s attributes:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(variant(module("com.google.guava:guava:28.2-jre")) {
            attributes {
                attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.REGULAR_PLATFORM))
            }
        }).using(module("com.google.guava:guava:28.2-jre"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute variant(module('com.google.guava:guava:28.2-jre')) {
            attributes {
                attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.REGULAR_PLATFORM))
            }
        } using module('com.google.guava:guava:28.2-jre')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By using attribute-based substitution, you can precisely control which dependencies are replaced, ensuring Gradle resolves the correct versions and variants in your build.</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/DependencySubstitutions.html#variant-org.gradle.api.artifacts.component.ComponentSelector-org.gradle.api.Action-">DependencySubstitutions API</a> for a complete reference.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
In <a href="#composite_build_intro">composite builds</a>, the rule that you have to match the exact requested dependency attributes is not applied.
When using composites, Gradle will automatically match the requested attributes.
In other words, it is implicit that if you include another build, you are substituting <em>all variants</em> of the substituted module with an equivalent variant in the included build.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="sec:substitution-with-capabilities"><a class="anchor" href="#sec:substitution-with-capabilities"></a><a class="link" href="#sec:substitution-with-capabilities">Substituting a dependency with a dependency with capabilities</a></h6>
<div class="paragraph">
<p>You can substitute a dependency with a different variant that includes specific <strong>capabilities</strong>.
Capabilities allow you to specify that a particular variant of a dependency offers a set of related features or functionality, such as <a href="#sec:java_test_fixtures">test fixtures</a>.</p>
</div>
<div class="paragraph">
<p>This example substitutes a regular dependency with its <a href="#sec:java_test_fixtures">test fixtures</a> using a capability:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.testCompileClasspath {
    resolutionStrategy.dependencySubstitution {
        substitute(module("com.acme:lib:1.0")).using(variant(module("com.acme:lib:1.0")) {
            capabilities {
                requireCapability("com.acme:lib-test-fixtures")
            }
        })
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.testCompileClasspath {
    resolutionStrategy.dependencySubstitution {
        substitute(module('com.acme:lib:1.0'))
            .using variant(module('com.acme:lib:1.0')) {
            capabilities {
                requireCapability('com.acme:lib-test-fixtures')
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Here, we substitute the regular <code>com.acme:lib:1.0</code> dependency with its <code>lib-test-fixtures</code> variant.
The <code>requireCapability</code> function specifies that the new variant must have the <code>com.acme:lib-test-fixtures</code> capability, ensuring the right version of the dependency is selected for testing purposes.</p>
</div>
<div class="paragraph">
<p>Capabilities within the substitution rule are used to precisely match dependencies, and Gradle only substitutes dependencies that match the required capabilities.</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/DependencySubstitutions.html#variant-org.gradle.api.artifacts.component.ComponentSelector-org.gradle.api.Action-">DependencySubstitutions API</a> for a complete reference of the variant substitution API.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:substitution-with-classifier"><a class="anchor" href="#sec:substitution-with-classifier"></a><a class="link" href="#sec:substitution-with-classifier">Substituting a dependency with a classifier or artifact</a></h5>
<div class="paragraph">
<p>You can substitute dependencies that have a classifier with ones that don&#8217;t or vice versa. Classifiers are often used to represent different versions of the same artifact, such as platform-specific builds or dependencies with different APIs.
Although Gradle discourages the use of classifiers, it provides a way to handle substitutions for cases where classifiers are still in use.</p>
</div>
<div class="paragraph">
<p>Consider the following setup:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.google.guava:guava:28.2-jre")
    implementation("co.paralleluniverse:quasar-core:0.8.0")
    implementation(project(":lib"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'com.google.guava:guava:28.2-jre'
    implementation 'co.paralleluniverse:quasar-core:0.8.0'
    implementation project(':lib')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example above, the first level dependency on <code>quasar</code> makes us think that Gradle would resolve <code>quasar-core-0.8.0.jar</code> but it&#8217;s not the case.</p>
</div>
<div class="paragraph">
<p>The build fails with this message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Execution failed for task ':consumer:resolve'.
&gt; Could not resolve all files for configuration ':consumer:runtimeClasspath'.
   &gt; Could not find quasar-core-0.8.0-jdk8.jar (co.paralleluniverse:quasar-core:0.8.0).
     Searched in the following locations:
         https://repo.maven.apache.org/maven2/co/paralleluniverse/quasar-core/0.8.0/quasar-core-0.8.0-jdk8.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s because there&#8217;s a dependency on another project, <code>lib</code>, which itself depends on a different version of <code>quasar-core</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("co.paralleluniverse:quasar-core:0.7.10:jdk8")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation "co.paralleluniverse:quasar-core:0.7.10:jdk8"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The consumer depends on <code>quasar-core:0.8.0</code> without a classifier.</p>
</li>
<li>
<p>The lib project depends on <code>quasar-core:0.7.10</code> with the <code>jdk8</code> classifier.</p>
</li>
<li>
<p>Gradle&#8217;s conflict resolution selects the higher version (<code>0.8.0</code>), but <code>quasar-core:0.8.0</code> doesn&#8217;t have the <code>jdk8</code> classifier, leading to a resolution error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To resolve this conflict, you can instruct Gradle to ignore classifiers when resolving <code>quasar-core</code> dependencies:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute(module("co.paralleluniverse:quasar-core"))
            .using(module("co.paralleluniverse:quasar-core:0.8.0"))
            .withoutClassifier()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute module('co.paralleluniverse:quasar-core') using module('co.paralleluniverse:quasar-core:0.8.0') withoutClassifier()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This rule effectively replaces any dependency on <code>quasar-core</code> found in the graph with a dependency without classifier.</p>
</div>
<div class="paragraph">
<p>If you need to substitute with a specific classifier or artifact, you can specify the classifier or artifact details in the substitution rule.</p>
</div>
<div class="paragraph">
<p>For more detailed information, refer to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Artifact selection via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/DependencySubstitutions.Substitution.html">Substitution DSL</a></p>
</li>
<li>
<p>Artifact selection via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/DependencySubstitution.html#artifactSelection-org.gradle.api.Action-">DependencySubstitution API</a></p>
</li>
<li>
<p>Artifact selection via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ResolutionStrategy.html#dependencySubstitution-org.gradle.api.Action-">ResolutionStrategy API</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:component-selection-rules"><a class="anchor" href="#sec:component-selection-rules"></a><a class="link" href="#sec:component-selection-rules">4. Component Selection Rules</a></h4>
<div class="paragraph">
<p>Component selection rules may influence which component instance should be selected when multiple versions are available that match a version selector.
Rules are applied against every available version and allow the version to be explicitly rejected.</p>
</div>
<div class="paragraph">
<p>This allows Gradle to ignore any component instance that does not satisfy conditions set by the rule.
Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a dynamic version like <code>1.+</code> certain versions may be explicitly rejected from selection.</p>
</li>
<li>
<p>For a static version like <code>1.4</code> an instance may be rejected based on extra component metadata such as the Ivy branch attribute, allowing an instance from a subsequent repository to be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rules are configured via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ComponentSelectionRules.html">ComponentSelectionRules</a> object.
Each rule configured will be called with a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> object as an argument that contains information about the candidate version being considered.
Calling <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ComponentSelection.html#org.gradle.api.artifacts.ComponentSelection:reject(java.lang.String)">ComponentSelection.reject(java.lang.String)</a> causes the given candidate version to be explicitly rejected, in which case the candidate will not be considered for the selector.</p>
</div>
<div class="paragraph">
<p>The following example shows a rule that disallows a particular version of a module but allows the dynamic version to choose the next best candidate:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    implementation {
        resolutionStrategy {
            componentSelection {
                // Accept the highest version matching the requested version that isn't '1.5'
                all {
                    if (candidate.group == "org.sample" &amp;&amp; candidate.module == "api" &amp;&amp; candidate.version == "1.5") {
                        reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}

dependencies {
    implementation("org.sample:api:1.+")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    implementation {
        resolutionStrategy {
            componentSelection {
                // Accept the highest version matching the requested version that isn't '1.5'
                all { ComponentSelection selection -&gt;
                    if (selection.candidate.group == 'org.sample' &amp;&amp; selection.candidate.module == 'api' &amp;&amp; selection.candidate.version == '1.5') {
                        selection.reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}

dependencies {
    implementation 'org.sample:api:1.+'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that version selection is applied starting with the highest version first.
The version selected will be the first version found that all component selection rules accept.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
A version is considered accepted if no rule explicitly rejects it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similarly, rules can be targeted at specific modules.
Modules must be specified in the form of <code>group:module</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("targetConfig") {
        resolutionStrategy {
            componentSelection {
                withModule("org.sample:api") {
                    if (candidate.version == "1.5") {
                        reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    targetConfig {
        resolutionStrategy {
            componentSelection {
                withModule("org.sample:api") { ComponentSelection selection -&gt;
                    if (selection.candidate.version == "1.5") {
                        selection.reject("version 1.5 is broken for 'org.sample:api'")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Component selection rules can also consider component metadata when selecting a version.
Possible additional metadata that can be considered are <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadata.html">ComponentMetadata</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a>.</p>
</div>
<div class="paragraph">
<p>Note that this extra information may not always be available and thus should be checked for <code>null</code> values:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("metadataRulesConfig") {
        resolutionStrategy {
            componentSelection {
                // Reject any versions with a status of 'experimental'
                all {
                    if (candidate.group == "org.sample" &amp;&amp; metadata?.status == "experimental") {
                        reject("don't use experimental candidates from 'org.sample'")
                    }
                }
                // Accept the highest version with either a "release" branch or a status of 'milestone'
                withModule("org.sample:api") {
                    if (getDescriptor(IvyModuleDescriptor::class)?.branch != "release" &amp;&amp; metadata?.status != "milestone") {
                        reject("'org.sample:api' must have testing branch or milestone status")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    metadataRulesConfig {
        resolutionStrategy {
            componentSelection {
                // Reject any versions with a status of 'experimental'
                all { ComponentSelection selection -&gt;
                    if (selection.candidate.group == 'org.sample' &amp;&amp; selection.metadata?.status == 'experimental') {
                        selection.reject("don't use experimental candidates from 'org.sample'")
                    }
                }
                // Accept the highest version with either a "release" branch or a status of 'milestone'
                withModule('org.sample:api') { ComponentSelection selection -&gt;
                    if (selection.getDescriptor(IvyModuleDescriptor)?.branch != "release" &amp;&amp; selection.metadata?.status != 'milestone') {
                        selection.reject("'org.sample:api' must be a release branch or have milestone status")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> argument is <em>always</em> required as a parameter when declaring a component selection rule.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuration-defaults"><a class="anchor" href="#sec:configuration-defaults"></a><a class="link" href="#sec:configuration-defaults">5. Default Dependencies</a></h4>
<div class="paragraph">
<p>You can set default dependencies for a configuration to ensure that a default version is used when no explicit dependencies are specified.</p>
</div>
<div class="paragraph">
<p>This is useful for plugins that rely on versioned tools and want to provide a default if the user doesn&#8217;t specify a version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("pluginTool") {
        defaultDependencies {
            add(project.dependencies.create("org.gradle:my-util:1.0"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    pluginTool {
        defaultDependencies { dependencies -&gt;
            dependencies.add(project.dependencies.create("org.gradle:my-util:1.0"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>pluginTool</code> configuration will use <code>org.gradle:my-util:1.0</code> as a default dependency unless another version is specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:exclude-trans-deps"><a class="anchor" href="#sec:exclude-trans-deps"></a><a class="link" href="#sec:exclude-trans-deps">6. Excluding Transitive Dependencies</a></h4>
<div class="paragraph">
<p>To completely exclude a transitive dependency for a particular configuration, use the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:exclude(java.util.Map)"><code>Configuration.exclude(Map)</code></a> method.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Excluding a transitive dependency should be a conscious and deliberate choice. Removing a dependency that other libraries rely on can lead to runtime errors or unexpected behavior. If you choose to exclude something, make sure your code doesn&#8217;t rely on itideally backed by comprehensive test coverage to catch potential issues early.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This approach will automatically exclude the specified transitive dependency from all dependencies declared within the configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    "implementation" {
        exclude(group = "commons-collections", module = "commons-collections")
    }
}

dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4")
    implementation("com.opencsv:opencsv:4.6")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    implementation {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
}

dependencies {
    implementation 'commons-beanutils:commons-beanutils:1.9.4'
    implementation 'com.opencsv:opencsv:4.6'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>commons-collections</code> dependency will be excluded from the <code>implementation</code> configuration, regardless of whether it is a direct or transitive dependency.</p>
</div>
<div class="paragraph">
<p>Below is a simplified usage of the <code>commons-beanutils</code> library, where we only call <code>PropertyUtils.setSimpleProperty()</code> on a POJO (Plain Old Java Object):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/Main.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.apache.commons.beanutils.PropertyUtils;

public class Main {
    public static void main(String[] args) throws Exception {
        Object person = new Person();
        PropertyUtils.setSimpleProperty(person, "name", "Bart Simpson");
        PropertyUtils.setSimpleProperty(person, "age", 38);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This specific usage doesn&#8217;t require <code>commons-collections</code>, which we&#8217;ve verified with test coverage.
By excluding it, we effectively express that we&#8217;re only using a subset of <code>commons-beanutils</code>.
However, this can be risky.
If our code were more dynamic or invoked error-handling code paths, we might encounter runtime issues.</p>
</div>
<div class="paragraph">
<p>For example, if we tried to set a property that doesn&#8217;t exist, the library may throw a <code>NoClassDefFoundError</code> for a missing class from <code>commons-collections</code> rather than a clear exception, because that path depends on the excluded library.</p>
</div>
<div class="paragraph">
<p>Gradle handles exclusions differently than Mavenit evaluates the entire dependency graph.
An exclusion is only applied if all paths to a dependency agree on it.</p>
</div>
<div class="paragraph">
<p>For example, if another dependency (like <code>opencsv</code>) also brings in <code>commons-beanutils</code> (but without an exclusion), the transitive <code>commons-collections</code> will still appear:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4") {
        exclude(group = "commons-collections", module = "commons-collections")
    }
    implementation("com.opencsv:opencsv:4.6") // depends on 'commons-beanutils' without exclude and brings back 'commons-collections'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('commons-beanutils:commons-beanutils:1.9.4') {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
    implementation 'com.opencsv:opencsv:4.6' // depends on 'commons-beanutils' without exclude and brings back 'commons-collections'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To fully exclude <code>commons-collections</code>, you must also exclude it from <code>opencsv</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("commons-beanutils:commons-beanutils:1.9.4") {
        exclude(group = "commons-collections", module = "commons-collections")
    }
    implementation("com.opencsv:opencsv:4.6") {
        exclude(group = "commons-collections", module = "commons-collections")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('commons-beanutils:commons-beanutils:1.9.4') {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
    implementation('com.opencsv:opencsv:4.6') {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using excludes should be a conscious and well-tested decision.
If the excluded dependency is needed in any code path, your build may fail at runtime.</p>
</div>
<div class="paragraph">
<p>Historically, excludes have also been used as a workaround for limitations in other build systems, but there are better alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Use <a href="#dependency-constraints">dependency constraints</a></strong> to update or override versions instead of excluding undesired ones.</p>
</li>
<li>
<p><strong>Use <a href="#component-metadata-rules">component metadata rules</a></strong> to remove an unnecessary dependencylike a compile-time dependency that&#8217;s erroneously added to the metadata of the library. This tells Gradle to ignore the dependency entirely (i.e., the metadata is wrong). Note that these rules are not published, so if you&#8217;re creating a library others will use, an explicit <code>exclude</code> may be more appropriate.</p>
</li>
<li>
<p><strong>Use <a href="#capabilities">capabilities</a></strong> to resolve mutually exclusive dependency conflicts. Some libraries can&#8217;t coexist because they provide the same capabilitysuch as <code>log4j</code> and <code>log4j-over-slf4j</code>, or <code>com.google.collections</code> and <code>guava</code>. If Gradle isn&#8217;t aware of the conflict, declare the overlapping capability using a component metadata rule. If you&#8217;re developing a library, avoid enforcing a specific choicelet the consumers decide which implementation to use.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:conflict-resolution-strategy"><a class="anchor" href="#sec:conflict-resolution-strategy"></a><a class="link" href="#sec:conflict-resolution-strategy">7. Force Failed Resolution Strategies</a></h4>
<div class="paragraph">
<p>Version conflicts can be forced to fail using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>failOnNonReproducibleResolution()</code></p>
</li>
<li>
<p><code>failOnDynamicVersions()</code></p>
</li>
<li>
<p><code>failOnChangingVersions()</code></p>
</li>
<li>
<p><code>failOnVersionConflict()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This will fail the build when conflicting versions of the same dependency are found:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy {
        failOnVersionConflict()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy {
        failOnVersionConflict()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling-resolution-transitive-dependencies"><a class="anchor" href="#sec:disabling-resolution-transitive-dependencies"></a><a class="link" href="#sec:disabling-resolution-transitive-dependencies">8. Disabling Transitive Dependencies</a></h4>
<div class="paragraph">
<p>By default, Gradle resolves all transitive dependencies for a given module.</p>
</div>
<div class="paragraph">
<p>However, there are situations where you may want to disable this behavior, such as when you need more control over dependencies or when the dependency metadata is incorrect.</p>
</div>
<div class="paragraph">
<p>You can tell Gradle to disable transitive dependency management for a dependency by setting <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ModuleDependency.html#setTransitive-boolean-">ModuleDependency.setTransitive(boolean)</a> to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>In the following example, transitive dependency resolution is disabled for the <code>guava</code> dependency:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.google.guava:guava:23.0") {
        isTransitive = false
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation('com.google.guava:guava:23.0') {
        transitive = false
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This ensures only the main artifact for <code>guava</code> is resolved, and none of its transitive dependencies will be included.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Disabling transitive dependency resolution will likely require you to declare the necessary runtime dependencies in your build script which otherwise would have been resolved automatically. Not doing so might lead to runtime classpath issues.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to disable transitive resolution globally across all dependencies, you can set this behavior at the configuration level:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    isTransitive = false
}

dependencies {
    implementation("com.google.guava:guava:23.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    transitive = false
}
dependencies {
    implementation 'com.google.guava:guava:23.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This disables transitive resolution for all dependencies in the project.
Be aware that this may require you to manually declare any transitive dependencies that are required at runtime.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/Configuration.html#setTransitive-boolean-">Configuration.setTransitive(boolean)</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency-resolve-rules"><a class="anchor" href="#sec:dependency-resolve-rules"></a><a class="link" href="#sec:dependency-resolve-rules">9. Dependency Resolve Rules and Other Conditionals</a></h4>
<div class="paragraph">
<p>Dependency resolve rules are executed for each dependency as it&#8217;s being resolved, providing a powerful API to modify a dependency&#8217;s attributessuch as group, name, or versionbefore the resolution is finalized.</p>
</div>
<div class="paragraph">
<p>This allows for advanced control over dependency resolution, enabling you to substitute one module for another during the resolution process.</p>
</div>
<div class="paragraph">
<p>This feature is particularly useful for implementing advanced dependency management patterns.
With <strong>dependency resolve rules</strong>, you can redirect dependencies to specific versions or even different modules entirely, allowing you to enforce consistent versions across a project or override problematic dependencies:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy {
        eachDependency {
            if (requested.group == "com.example" &amp;&amp; requested.name == "old-library") {
                useTarget("com.example:new-library:1.0.0")
                because("Our license only allows use of version 1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy {
        eachDependency {
            if (requested.group == "com.example" &amp;&amp; requested.name == "old-library") {
                useTarget("com.example:new-library:1.0.0")
                because("Our license only allows use of version 1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, if a dependency on <code>com.example:old-library</code> is requested, it will be substituted with <code>com.example:new-library:1.0.0</code> during resolution.</p>
</div>
<div class="paragraph">
<p>For more advanced usage and additional examples, refer to the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> class in the API documentation.</p>
</div>
<div class="sect4">
<h5 id="sec:custom-versioning-scheme"><a class="anchor" href="#sec:custom-versioning-scheme"></a><a class="link" href="#sec:custom-versioning-scheme">Implementing a custom versioning scheme</a></h5>
<div class="paragraph">
<p>In some corporate environments, module versions in Gradle builds are maintained and audited externally.
<strong>Dependency resolve rules</strong> offer an effective way to implement this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Developers declare dependencies in the build script using the modules group and name, but specify a placeholder version like <code>default</code>.</p>
</li>
<li>
<p>A dependency resolve rule then resolves the <code>default</code> version to an approved version, which is retrieved from a corporate catalog of sanctioned modules.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This approach ensures that only approved versions are used, while allowing developers to work with a simplified and consistent versioning scheme.</p>
</div>
<div class="paragraph">
<p>The rule implementation can be encapsulated in a corporate plugin, making it easy to apply across all projects within the organization:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.eachDependency {
        if (requested.version == "default") {
            val version = findDefaultVersionInCatalog(requested.group, requested.name)
            useVersion(version.version)
            because(version.because)
        }
    }
}

data class DefaultVersion(val version: String, val because: String)

fun findDefaultVersionInCatalog(group: String, name: String): DefaultVersion {
    //some custom logic that resolves the default version into a specific version
    return DefaultVersion(version = "1.0", because = "tested by QA")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        if (details.requested.version == 'default') {
            def version = findDefaultVersionInCatalog(details.requested.group, details.requested.name)
            details.useVersion version.version
            details.because version.because
        }
    }
}

def findDefaultVersionInCatalog(String group, String name) {
    //some custom logic that resolves the default version into a specific version
    [version: "1.0", because: 'tested by QA']
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this setup, whenever a developer specifies <code>default</code> as the version, the resolve rule replaces it with the approved version from the corporate catalog.</p>
</div>
<div class="paragraph">
<p>This strategy ensures compliance with corporate policies while providing flexibility and ease of use for developers.
Encapsulating this logic in a plugin also ensures consistency across multiple projects.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:denying-version"><a class="anchor" href="#sec:denying-version"></a><a class="link" href="#sec:denying-version">Replacing unwanted dependency versions</a></h5>
<div class="paragraph">
<p><strong>Dependency resolve rules</strong> offer a powerful mechanism for blocking specific versions of a dependency and substituting them with an alternative.</p>
</div>
<div class="paragraph">
<p>This is particularly useful when a specific version is known to be problematicsuch as a version that introduces bugs or relies on a library that isnt available in public repositories.
By defining a resolve rule, you can automatically replace a problematic version with a stable one.</p>
</div>
<div class="paragraph">
<p>Consider a scenario where version <code>1.2</code> of a library is broken, but version <code>1.2.1</code> contains important fixes and should always be used instead.
With a resolve rule, you can enforce this substitution: "anytime version <code>1.2</code> is requested, it will be replaced with <code>1.2.1</code>.
Unlike forcing a version, this rule only affects the specific version <code>1.2</code>, leaving other versions unaffected:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.eachDependency {
        if (requested.group == "org.software" &amp;&amp; requested.name == "some-library" &amp;&amp; requested.version == "1.2") {
            useVersion("1.2.1")
            because("fixes critical bug in 1.2")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        if (details.requested.group == 'org.software' &amp;&amp; details.requested.name == 'some-library' &amp;&amp; details.requested.version == '1.2') {
            details.useVersion '1.2.1'
            details.because 'fixes critical bug in 1.2'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If version <code>1.3</code> is also present in the dependency graph, then even with this rule, Gradles default conflict resolution strategy would select <code>1.3</code> as the latest version.</p>
</div>
<div class="paragraph">
<p><strong>Difference from Rich Version Constraints:</strong> Using <a href="#sec:rich-version-constraints">rich version</a> constraints, you can reject certain versions outright, causing the build to fail or select a non-rejected version if a dynamic dependency is used. In contrast, a dependency resolve rule like the one shown here manipulates the version being requested, replacing it with a known good version when a rejected one is found. This approach is a <strong>solution</strong> for handling rejected versions, while rich version constraints are about expressing the intent to avoid certain versions.</p>
</div>
</div>
<div class="sect4">
<h5 id="lazily_influencing_resolved_dependencies"><a class="anchor" href="#lazily_influencing_resolved_dependencies"></a><a class="link" href="#lazily_influencing_resolved_dependencies">Lazily influencing resolved dependencies</a></h5>
<div class="paragraph">
<p>Plugins can lazily influence dependencies by adding them conditionally or setting preferred versions when no version is specified by the user.</p>
</div>
<div class="paragraph">
<p>Below are two examples illustrating these use cases.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how to add a dependency to a configuration based on some condition, evaluated lazily:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    implementation {
        dependencies.addLater(project.provider {
            val dependencyNotation = conditionalLogic()
            if (dependencyNotation != null) {
                project.dependencies.create(dependencyNotation)
            } else {
                null
            }
        })
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    implementation {
        dependencies.addLater(project.provider {
            def dependencyNotation = conditionalLogic()
            if (dependencyNotation != null) {
                return project.dependencies.create(dependencyNotation)
            } else {
                return null
            }
        })
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, <code>addLater</code> is used to defer the evaluation of the dependency, allowing it to be added only when certain conditions are met.</p>
</div>
<div class="paragraph">
<p>In this example, the build script sets a preferred version of a dependency, which will be used if no version is explicitly specified:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org:foo")

    // Can indiscriminately be added by build logic
    constraints {
        implementation("org:foo:1.0") {
            version {
                // Applied to org:foo if no other version is specified
                prefer("1.0")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation("org:foo")

    // Can indiscriminately be added by build logic
    constraints {
        implementation("org:foo:1.0") {
            version {
                // Applied to org:foo if no other version is specified
                prefer("1.0")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This ensures that <code>org:foo</code> uses version <code>1.0</code> unless the user specifies another version.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-metadata-rules"><a class="anchor" href="#component-metadata-rules"></a><a class="link" href="#component-metadata-rules">Modifying Dependency Metadata</a></h3>
<div class="paragraph">
<p>Each component pulled from a repository includes metadata, such as its group, name, version, and the various variants it provides along with their artifacts and dependencies.</p>
</div>
<div class="paragraph">
<p>Occasionally, this metadata might be incomplete or incorrect.</p>
</div>
<div class="paragraph">
<p>Gradle offers an API to address this issue, allowing you to write <strong>component metadata rules</strong> directly within the build script.
These rules are applied after a module&#8217;s metadata is downloaded, but before it&#8217;s used in dependency resolution.</p>
</div>
<div class="sect3">
<h4 id="sec:writing-metadata-rule"><a class="anchor" href="#sec:writing-metadata-rule"></a><a class="link" href="#sec:writing-metadata-rule">Writing a component metadata rule</a></h4>
<div class="paragraph">
<p>Component metadata rules are applied within the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.ComponentMetadataHandler.html"><code>components</code></a> section of the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html"><code>dependencies</code></a> block in a build script or in the settings script.</p>
</div>
<div class="paragraph">
<p>These rules can be defined in two ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Inline as an Action:</strong> Directly within the <code>components</code> section.</p>
</li>
<li>
<p><strong>As a Separate Class:</strong> Implementing the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadataRule.html"><code>ComponentMetadataRule</code></a> interface.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>While inline actions are convenient for quick experimentation, it&#8217;s generally recommended to define rules as separate classes.</p>
</div>
<div class="paragraph">
<p>Rules written as isolated classes can be annotated with <code>@CacheableRule</code>, allowing their results to be cached and avoiding re-execution each time dependencies are resolved.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A rule should always be cacheable to avoid major impacts on build performance and ensure faster build times.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class TargetJvmVersionRule @Inject constructor(val jvmVersion: Int) : ComponentMetadataRule {
    @get:Inject abstract val objects: ObjectFactory

    override fun execute(context: ComponentMetadataContext) {
        context.details.withVariant("compile") {
            attributes {
                attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, jvmVersion)
                attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_API))
            }
        }
    }
}
dependencies {
    components {
        withModule&lt;TargetJvmVersionRule&gt;("commons-io:commons-io") {
            params(7)
        }
        withModule&lt;TargetJvmVersionRule&gt;("commons-collections:commons-collections") {
            params(8)
        }
    }
    implementation("commons-io:commons-io:2.6")
    implementation("commons-collections:commons-collections:3.2.2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class TargetJvmVersionRule implements ComponentMetadataRule {
    final Integer jvmVersion
    @Inject TargetJvmVersionRule(Integer jvmVersion) {
        this.jvmVersion = jvmVersion
    }

    @Inject abstract ObjectFactory getObjects()

    void execute(ComponentMetadataContext context) {
        context.details.withVariant("compile") {
            attributes {
                attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, jvmVersion)
                attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_API))
            }
        }
    }
}
dependencies {
    components {
        withModule("commons-io:commons-io", TargetJvmVersionRule) {
            params(7)
        }
        withModule("commons-collections:commons-collections", TargetJvmVersionRule) {
            params(8)
        }
    }
    implementation("commons-io:commons-io:2.6")
    implementation("commons-collections:commons-collections:3.2.2")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>TargetJvmVersionRule</code> class implements <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadataRule.html"><code>ComponentMetadataRule</code></a> and is further configured using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/ActionConfiguration.html"><code>ActionConfiguration</code></a>.</p>
</div>
<div class="paragraph">
<p>Gradle enforces isolation of instances of <code>ComponentMetadataRule</code>, requiring that all parameters must be <code>Serializable</code> or recognized Gradle types.</p>
</div>
<div class="paragraph">
<p>Additionally, services like <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/model/ObjectFactory.html"><code>ObjectFactory</code></a> can be injected into your rule&#8217;s constructor using <code>@Inject</code>.</p>
</div>
<div class="paragraph">
<p>A component metadata rule can be applied to all modules using <code>all(rule)</code> or to a specific module using <code>withModule(groupAndName, rule)</code>.
Typically, a rule is tailored to enrich the metadata of a specific module, so the <code>withModule</code> API is preferred.</p>
</div>
<div class="sect4">
<h5 id="sec:rules-in-settings"><a class="anchor" href="#sec:rules-in-settings"></a><a class="link" href="#sec:rules-in-settings">Declaring rules in a central place</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Declaring component metadata rules in settings is an incubating feature
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Component metadata rules can be declared in the <code>settings.gradle(.kts)</code> file for the entire build, rather than in each subproject individually.
Rules declared in settings are applied to all projects by default unless overridden by project-specific rules.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    components {
        withModule&lt;GuavaRule&gt;("com.google.guava:guava")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    components {
        withModule("com.google.guava:guava", GuavaRule)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By default, project-specific rules take precedence over settings rules.
However, this behavior can be adjusted:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    rulesMode = RulesMode.PREFER_SETTINGS
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    rulesMode = RulesMode.PREFER_SETTINGS
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If this method is called and that a project or plugin declares rules, a warning will be issued.
You can make this a failure instead by using this alternative:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    rulesMode = RulesMode.FAIL_ON_PROJECT_RULES
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    rulesMode = RulesMode.FAIL_ON_PROJECT_RULES
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The default behavior is equivalent to calling this method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencyResolutionManagement {
    rulesMode = RulesMode.PREFER_PROJECT
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyResolutionManagement {
    rulesMode = RulesMode.PREFER_PROJECT
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:component-metadata-rules-details"><a class="anchor" href="#sec:component-metadata-rules-details"></a><a class="link" href="#sec:component-metadata-rules-details">Which parts of metadata can be modified?</a></h4>
<div class="paragraph">
<p>The Component Metadata Rules API focuses on the features supported by Gradle Module Metadata and the dependencies API.
The key difference between using metadata rules and defining dependencies/artifacts in a build script is that component metadata rules operate directly on <a href="variant_aware_resolution.html#sec:understanding-variant-selection">variants</a>, whereas build scripts often affect multiple variants at once (e.g., an <code>api</code> dependency is applied to both <code>api</code> and <code>runtime</code> variants of a Java library).</p>
</div>
<div class="paragraph">
<p>Variants can be modified through the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>allVariants</code></strong>: Modify all variants of a component.</p>
</li>
<li>
<p><strong><code>withVariant(name)</code></strong>: Modify a specific variant identified by its name.</p>
</li>
<li>
<p><strong><code>addVariant(name)</code> or <code>addVariant(name, base)</code></strong>: Add a new variant from scratch or copy details from an existing variant (<code>base</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following variant details can be modified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Attributes</strong>: Use the <code>attributes {}</code> block to adjust <a href="variant_aware_resolution.html#sec:abm-configuration-attributes">attributes</a> that identify the variant.</p>
</li>
<li>
<p><strong>Capabilities</strong>: Use the <code>withCapabilities {}</code> block to define the <a href="#sec:declaring-component-capabilities">capabilities</a> the variant provides.</p>
</li>
<li>
<p><strong>Dependencies</strong>: Use the <code>withDependencies {}</code> block to manage the variants dependencies, including <a href="#sec:rich-version-constraints">rich version</a> constraints.</p>
</li>
<li>
<p><strong>Dependency Constraints</strong>: Use the <code>withDependencyConstraints {}</code> block to define the variants <a href="#sec:adding-constraints-transitive-deps">dependency constraints</a>, including rich versions.</p>
</li>
<li>
<p><strong>Published Files</strong>: Use the <code>withFiles {}</code> block to specify the location of the files that make up the variants content.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, several component-level properties can be changed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Component Attributes</strong>: The only <a href="#sec:custom-status-scheme">meaningful attribute</a> here is <code>org.gradle.status</code>.</p>
</li>
<li>
<p><strong>Status Scheme</strong>: Influence how the <code>org.gradle.status</code> attribute is interpreted during version selection.</p>
</li>
<li>
<p><strong>BelongsTo Property</strong>: Used for <a href="#sec:declaring-capabilities-external-modules">version alignment</a> via virtual platforms.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The format of a module&#8217;s metadata affects how it maps to the variant-centric representation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Gradle Module Metadata</strong>: The data structure is similar to the modules <code>.module</code> file.</p>
</li>
<li>
<p><strong>POM Metadata</strong>: For modules published with <code>.pom</code> metadata, fixed variants are derived as explained in the <a href="#sec:maven-mapping-to-variants">"Mapping POM Files to Variants"</a>, section.</p>
</li>
<li>
<p><strong>Ivy Metadata</strong>: If a module was published with an <code>ivy.xml</code> file, Ivy configurations can be accessed in place of variants. Their dependencies, constraints, and files can be modified. You can also use <code>addVariant(name, baseVariantOrConfiguration)</code> to derive variants from Ivy configurations, such as defining <a href="#sec:ivy-mapping-to-variants"><code>compile</code> and <code>runtime</code> variants for the Java library plugin</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before using component metadata rules to adjust a modules metadata, determine whether the module was published with <strong>Gradle Module Metadata</strong> (<code>.module</code> file) or <strong>traditional metadata</strong> (<code>.pom</code> or <code>ivy.xml</code>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Modules with Gradle Module Metadata</strong>: These typically have complete metadata, but issues can still occur. Only apply component metadata rules if you&#8217;ve clearly identified a problem with the metadata. For dependency resolution issues, first consider using <a href="#sec:rich-version-constraints">dependency constraints with rich versions</a>. If you&#8217;re developing a library, note that dependency constraints are published as part of your own librarys metadata, making it easier to share the solution with consumers. In contrast, component metadata rules apply only within your own build.</p>
</li>
<li>
<p><strong>Modules with Traditional Metadata</strong> (<code>.pom</code> or <code>ivy.xml</code>): These are more likely to have incomplete metadata since features like variants and dependency constraints arent supported in these formats. Such modules might have variants or constraints that were omitted or incorrectly defined as dependencies. In the following sections, we explore examples of OSS modules with incomplete metadata and the rules to add missing information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a rule of thumb, you should contemplate if the rule you are writing also works out of context of your build.
That is, does the rule still produce a correct and useful result if applied in any other build that uses the module(s) it affects?</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:fixing-dependency-details"><a class="anchor" href="#sec:fixing-dependency-details"></a><a class="link" href="#sec:fixing-dependency-details">Fixing incorrect dependency details</a></h4>
<div class="paragraph">
<p>Consider the Jaxen XPath Engine (version <code>1.1.3</code>) published on Maven Central.
Its <code>pom</code> file declares several unnecessary dependencies in the <code>compile</code> scope, which were later removed in version <code>1.1.4</code>.
If you need to work with version <code>1.1.3</code>, you can fix the metadata using the following rule:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class JaxenDependenciesRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.allVariants {
            withDependencies {
                removeAll { it.group in listOf("dom4j", "jdom", "xerces",  "maven-plugins", "xml-apis", "xom") }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class JaxenDependenciesRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.allVariants {
            withDependencies {
                removeAll { it.group in ["dom4j", "jdom", "xerces",  "maven-plugins", "xml-apis", "xom"] }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the <code>withDependencies</code> block, you have access to the full list of dependencies and can use Java collection methods to inspect and modify that list. You can also add dependencies using the <code>add(notation, configureAction)</code> method.
Similarly, you can inspect and modify dependency constraints within the <code>withDependencyConstraints</code> block.</p>
</div>
<div class="paragraph">
<p>In Jaxen version <code>1.1.4</code>, the <code>dom4j</code>, <code>jdom</code>, and <code>xerces</code> dependencies are still present but marked as <strong>optional</strong>.
Optional dependencies are not processed automatically by Gradle or Maven, as they indicate <a href="how_to_create_feature_variants_of_a_library.html#feature_variants">feature variants</a> that require additional dependencies.
However, the <code>pom</code> file lacks information about these features and their corresponding dependencies.
This can be represented in Gradle Module Metadata through variants and <a href="#sec:declaring-component-capabilities">capabilities</a>, which we can add via a component metadata rule.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class JaxenCapabilitiesRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.addVariant("runtime-dom4j", "runtime") {
            withCapabilities {
                removeCapability("jaxen", "jaxen")
                addCapability("jaxen", "jaxen-dom4j", context.details.id.version)
            }
            withDependencies {
                add("dom4j:dom4j:1.6.1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class JaxenCapabilitiesRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.addVariant("runtime-dom4j", "runtime") {
            withCapabilities {
                removeCapability("jaxen", "jaxen")
                addCapability("jaxen", "jaxen-dom4j", context.details.id.version)
            }
            withDependencies {
                add("dom4j:dom4j:1.6.1")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, we create a new variant called <code>runtime-dom4j</code> using the <code>addVariant(name, baseVariant)</code> method.
This variant represents an optional feature, defined by the capability <code>jaxen-dom4j</code>.
We then add the required dependency <code>dom4j:dom4j:1.6.1</code> to this feature.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    components {
        withModule&lt;JaxenDependenciesRule&gt;("jaxen:jaxen")
        withModule&lt;JaxenCapabilitiesRule&gt;("jaxen:jaxen")
    }
    implementation("jaxen:jaxen:1.1.3")
    runtimeOnly("jaxen:jaxen:1.1.3") {
        capabilities {
            requireCapability("jaxen:jaxen-dom4j")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    components {
        withModule("jaxen:jaxen", JaxenDependenciesRule)
        withModule("jaxen:jaxen", JaxenCapabilitiesRule)
    }
    implementation("jaxen:jaxen:1.1.3")
    runtimeOnly("jaxen:jaxen:1.1.3") {
        capabilities {
            requireCapability("jaxen:jaxen-dom4j")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By applying these rules, Gradle uses the enriched metadata to correctly resolve the optional dependencies when the <code>jaxen-dom4j</code> feature is required.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:publish-variants-explicit-jars"><a class="anchor" href="#sec:publish-variants-explicit-jars"></a><a class="link" href="#sec:publish-variants-explicit-jars">Making variants published as classified jars explicit</a></h4>
<div class="paragraph">
<p>In modern builds, variants are often published as separate artifacts, each represented by its own jar file.
For example, libraries may provide distinct jars for different Java versions, ensuring that the correct version is used at runtime or compile time based on the environment.</p>
</div>
<div class="paragraph">
<p>For instance, version <code>0.7.9</code> of the asynchronous programming library Quasar, published on <a href="https://repo1.maven.org/maven2/co/paralleluniverse/quasar-core/0.7.9">Maven Central</a>, includes both <code>quasar-core-0.7.9.jar</code> and <code>quasar-core-0.7.9-jdk8.jar</code>.
Publishing jars with a classifier, such as <code>jdk8</code>, is common practice in Maven repositories.
However, neither Maven nor Gradle metadata provides information about these classified jars.
As a result, there is no clear way to determine their existence or any differences, such as dependencies, between the variants.</p>
</div>
<div class="paragraph">
<p>In Gradle Module Metadata, variant information would be present.
For the already published Quasar library, we can add this information using the following rule:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class QuasarRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        listOf("compile", "runtime").forEach { base -&gt;
            context.details.addVariant("jdk8${base.capitalize()}", base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
                }
                withFiles {
                    removeAllFiles()
                    addFile("${context.details.id.name}-${context.details.id.version}-jdk8.jar")
                }
            }
            context.details.withVariant(base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 7)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class QuasarRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        ["compile", "runtime"].each { base -&gt;
            context.details.addVariant("jdk8${base.capitalize()}", base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
                }
                withFiles {
                    removeAllFiles()
                    addFile("${context.details.id.name}-${context.details.id.version}-jdk8.jar")
                }
            }
            context.details.withVariant(base) {
                attributes {
                    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 7)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, the <code>jdk8</code> classifier clearly indicates the target Java version, which corresponds to a known attribute in the Java ecosystem.
Since we need both compile and runtime variants for Java 8, we create two new variants using the existing compile and runtime variants as a base.
This ensures that all other Java ecosystem attributes are set correctly, and dependencies are carried over.</p>
</div>
<div class="paragraph">
<p>We assign the <code>TARGET_JVM_VERSION_ATTRIBUTE</code> to <code>8</code> for both new variants, remove any existing files with <code>removeAllFiles()</code>, and then add the <code>jdk8</code> jar using <code>addFile()</code>. Removing the files is necessary because the reference to the main jar <code>quasar-core-0.7.9.jar</code> is copied from the base variant.</p>
</div>
<div class="paragraph">
<p>Finally, we enrich the existing compile and runtime variants with the information that they target Java 7 using <code>attribute(TARGET_JVM_VERSION_ATTRIBUTE, 7)</code>.</p>
</div>
<div class="paragraph">
<p>With these changes, you can now request Java 8 versions for all dependencies on the compile classpath, and Gradle will automatically select the best-fitting variant. In the case of Quasar, this will be the <code>jdk8Compile</code> variant, which exposes the <code>quasar-core-0.7.9-jdk8.jar</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations["compileClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}
dependencies {
    components {
        withModule&lt;QuasarRule&gt;("co.paralleluniverse:quasar-core")
    }
    implementation("co.paralleluniverse:quasar-core:0.7.9")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.compileClasspath.attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 8)
}
dependencies {
    components {
        withModule("co.paralleluniverse:quasar-core", QuasarRule)
    }
    implementation("co.paralleluniverse:quasar-core:0.7.9")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this configuration, Gradle will select the Java 8 variant of Quasar for the compile classpath.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:encoded-variants-explicit"><a class="anchor" href="#sec:encoded-variants-explicit"></a><a class="link" href="#sec:encoded-variants-explicit">Making variants encoded in versions explicit</a></h4>
<div class="paragraph">
<p>Another solution to publish multiple alternatives for the same library is the usage of a versioning pattern as done by the popular Guava library.
Here, each new version is published twice by appending the classifier to the version instead of the jar artifact.
In the case of Guava 28 for example, we can find a <em>28.0-jre</em> (Java 8) and <em>28.0-android</em> (Java 6) version on <a href="https://repo1.maven.org/maven2/com/google/guava/guava">Maven central</a>.
The advantage of using this pattern when working only with pom metadata is that both variants are discoverable through the version.
The disadvantage is that there is no information as to what the different version suffixes mean semantically.
So in the case of conflict, Gradle would just pick the highest version when comparing the version strings.</p>
</div>
<div class="paragraph">
<p>Turning this into proper variants is a bit more tricky, as Gradle first selects a version of a module and then selects the best fitting variant.
So the concept that variants are encoded as versions is not supported directly.
However, since both variants are always published together we can assume that the files are physically located in the same repository.
And since they are published with Maven repository conventions, we know the location of each file if we know module name and version.
We can write the following rule:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class GuavaRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val variantVersion = context.details.id.version
        val version = variantVersion.substring(0, variantVersion.indexOf("-"))
        listOf("compile", "runtime").forEach { base -&gt;
            mapOf(6 to "android", 8 to "jre").forEach { (targetJvmVersion, jarName) -&gt;
                context.details.addVariant("jdk$targetJvmVersion${base.capitalize()}", base) {
                    attributes {
                        attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, targetJvmVersion)
                    }
                    withFiles {
                        removeAllFiles()
                        addFile("guava-$version-$jarName.jar", "../$version-$jarName/guava-$version-$jarName.jar")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class GuavaRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def variantVersion = context.details.id.version
        def version = variantVersion.substring(0, variantVersion.indexOf("-"))
        ["compile", "runtime"].each { base -&gt;
            [6: "android", 8: "jre"].each { targetJvmVersion, jarName -&gt;
                context.details.addVariant("jdk$targetJvmVersion${base.capitalize()}", base) {
                    attributes {
                        attributes.attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, targetJvmVersion)
                    }
                    withFiles {
                        removeAllFiles()
                        addFile("guava-$version-${jarName}.jar", "../$version-$jarName/guava-$version-${jarName}.jar")
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Similar to the previous example, we add runtime and compile variants for both Java versions.
In the <code>withFiles</code> block however, we now also specify a relative path for the corresponding jar file which allows Gradle to find the file no matter if it has selected a <em>-jre</em> or <em>-android</em> version.
The path is always relative to the location of the metadata (in this case <code>pom</code>) file of the selection module version.
So with this rules, both Guava 28 "versions" carry both the <em>jdk6</em> and <em>jdk8</em> variants.
So it does not matter to which one Gradle resolves.
The variant, and with it the correct jar file, is determined based on the requested <code>TARGET_JVM_VERSION_ATTRIBUTE</code> value.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations["compileClasspath"].attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 6)
}
dependencies {
    components {
        withModule&lt;GuavaRule&gt;("com.google.guava:guava")
    }
    // '23.3-android' and '23.3-jre' are now the same as both offer both variants
    implementation("com.google.guava:guava:23.3+")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.compileClasspath.attributes {
    attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 6)
}
dependencies {
    components {
        withModule("com.google.guava:guava", GuavaRule)
    }
    // '23.3-android' and '23.3-jre' are now the same as both offer both variants
    implementation("com.google.guava:guava:23.3+")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding-variants-jars"><a class="anchor" href="#sec:adding-variants-jars"></a><a class="link" href="#sec:adding-variants-jars">Adding variants for native jars</a></h4>
<div class="paragraph">
<p>Jars with classifiers are also used to separate parts of a library for which multiple alternatives exists, for example native code, from the main artifact.
This is for example done by the Lightweight Java Game Library (LWGJ), which publishes several platform specific jars to <a href="https://repo1.maven.org/maven2/org/lwjgl/lwjgl/3.2.3">Maven central</a> from which always one is needed, in addition to the main jar, at runtime.
It is not possible to convey this information in pom metadata as there is no concept of putting multiple artifacts in relation through the metadata.
In Gradle Module Metadata, each variant can have arbitrary many files and we can leverage that by writing the following rule:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class LwjglRule: ComponentMetadataRule {
    data class NativeVariant(val os: String, val arch: String, val classifier: String)

    private val nativeVariants = listOf(
        NativeVariant(OperatingSystemFamily.LINUX,   "arm32",  "natives-linux-arm32"),
        NativeVariant(OperatingSystemFamily.LINUX,   "arm64",  "natives-linux-arm64"),
        NativeVariant(OperatingSystemFamily.WINDOWS, "x86",    "natives-windows-x86"),
        NativeVariant(OperatingSystemFamily.WINDOWS, "x86-64", "natives-windows"),
        NativeVariant(OperatingSystemFamily.MACOS,   "x86-64", "natives-macos")
    )

    @get:Inject abstract val objects: ObjectFactory

    override fun execute(context: ComponentMetadataContext) {
        context.details.withVariant("runtime") {
            attributes {
                attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named("none"))
                attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named("none"))
            }
        }
        nativeVariants.forEach { variantDefinition -&gt;
            context.details.addVariant("${variantDefinition.classifier}-runtime", "runtime") {
                attributes {
                    attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(variantDefinition.os))
                    attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named(variantDefinition.arch))
                }
                withFiles {
                    addFile("${context.details.id.name}-${context.details.id.version}-${variantDefinition.classifier}.jar")
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class LwjglRule implements ComponentMetadataRule { //val os: String, val arch: String, val classifier: String)
    private def nativeVariants = [
        [os: OperatingSystemFamily.LINUX,   arch: "arm32",  classifier: "natives-linux-arm32"],
        [os: OperatingSystemFamily.LINUX,   arch: "arm64",  classifier: "natives-linux-arm64"],
        [os: OperatingSystemFamily.WINDOWS, arch: "x86",    classifier: "natives-windows-x86"],
        [os: OperatingSystemFamily.WINDOWS, arch: "x86-64", classifier: "natives-windows"],
        [os: OperatingSystemFamily.MACOS,   arch: "x86-64", classifier: "natives-macos"]
    ]

    @Inject abstract ObjectFactory getObjects()

    void execute(ComponentMetadataContext context) {
        context.details.withVariant("runtime") {
            attributes {
                attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, "none"))
                attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named(MachineArchitecture, "none"))
            }
        }
        nativeVariants.each { variantDefinition -&gt;
            context.details.addVariant("${variantDefinition.classifier}-runtime", "runtime") {
                attributes {
                    attributes.attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, variantDefinition.os))
                    attributes.attribute(MachineArchitecture.ARCHITECTURE_ATTRIBUTE, objects.named(MachineArchitecture, variantDefinition.arch))
                }
                withFiles {
                    addFile("${context.details.id.name}-${context.details.id.version}-${variantDefinition.classifier}.jar")
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This rule is quite similar to the Quasar library example above.
Only this time we have five different runtime variants we add and nothing we need to change for the compile variant.
The runtime variants are all based on the existing <em>runtime</em> variant and we do not change any existing information.
All Java ecosystem attributes, the dependencies and the main jar file stay part of each of the runtime variants.
We only set the additional attributes <code>OPERATING_SYSTEM_ATTRIBUTE</code> and <code>ARCHITECTURE_ATTRIBUTE</code> which are defined as part of Gradle&#8217;s <a href="building_cpp_projects.html#building_cpp_projects">native support</a>.
And we add the corresponding native jar file so that each runtime variant now carries two files: the main jar and the native jar.</p>
</div>
<div class="paragraph">
<p>In the build script, we can now request a specific variant and Gradle will fail with a selection error if more information is needed to make a decision.</p>
</div>
<div class="paragraph">
<p>Gradle is able to understand the common case where a single attribute is missing that would have removed the ambiguity.
In this case, rather than listing information about all attributes on all available variants, Gradle helpfully lists only possible values for that attribute along with the variants each value would select.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations["runtimeClasspath"].attributes {
    attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named("windows"))
}
dependencies {
    components {
        withModule&lt;LwjglRule&gt;("org.lwjgl:lwjgl")
    }
    implementation("org.lwjgl:lwjgl:3.2.3")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations["runtimeClasspath"].attributes {
    attribute(OperatingSystemFamily.OPERATING_SYSTEM_ATTRIBUTE, objects.named(OperatingSystemFamily, "windows"))
}
dependencies {
    components {
        withModule("org.lwjgl:lwjgl", LwjglRule)
    }
    implementation("org.lwjgl:lwjgl:3.2.3")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle fails to select a variant because a machine architecture needs to be chosen:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">failRuntimeClasspathResolve.out</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-out hljs" data-lang="out">&gt; Could not resolve all files for configuration ':runtimeClasspath'.
   &gt; Could not resolve org.lwjgl:lwjgl:3.2.3.
     Required by:
         root project 'component-metadata-rules'
      &gt; The consumer was configured to find a library for use during runtime, compatible with Java 11, packaged as a jar, preferably optimized for standard JVMs, and its dependencies declared externally, as well as attribute 'org.gradle.native.operatingSystem' with value 'windows'. There are several available matching variants of org.lwjgl:lwjgl:3.2.3
        The only attribute distinguishing these variants is 'org.gradle.native.architecture'. Add this attribute to the consumer's configuration to resolve the ambiguity:
          - Value: 'x86-64' selects variant: 'natives-windows-runtime'
          - Value: 'x86' selects variant: 'natives-windows-x86-runtime'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:making-library-flavors"><a class="anchor" href="#sec:making-library-flavors"></a><a class="link" href="#sec:making-library-flavors">Making different flavors of a library available through capabilities</a></h4>
<div class="paragraph">
<p>Because it is difficult to model <a href="how_to_create_feature_variants_of_a_library.html#feature_variants">optional feature variants</a> as separate jars with pom metadata, libraries sometimes comprise different jars with different feature sets.
That is, instead of composing your flavor of the library from different feature variants, you select one of the pre-composed variants (offering everything in one jar).
One such library is the well-known dependency injection framework Guice, published on <a href="https://repo1.maven.org/maven2/com/google/inject/guice/4.2.2">Maven central</a>, which offers a complete flavor (the main jar) and a reduced variant without aspect-oriented programming support (<code>guice-4.2.2-no_aop.jar</code>).
That second variant with a classifier is not mentioned in the pom metadata.
With the following rule, we create compile and runtime variants based on that file and make it selectable through a capability named <code>com.google.inject:guice-no_aop</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class GuiceRule: ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        listOf("compile", "runtime").forEach { base -&gt;
            context.details.addVariant("noAop${base.capitalize()}", base) {
                withCapabilities {
                    addCapability("com.google.inject", "guice-no_aop", context.details.id.version)
                }
                withFiles {
                    removeAllFiles()
                    addFile("guice-${context.details.id.version}-no_aop.jar")
                }
                withDependencies {
                    removeAll { it.group == "aopalliance" }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class GuiceRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        ["compile", "runtime"].each { base -&gt;
            context.details.addVariant("noAop${base.capitalize()}", base) {
                withCapabilities {
                    addCapability("com.google.inject", "guice-no_aop", context.details.id.version)
                }
                withFiles {
                    removeAllFiles()
                    addFile("guice-${context.details.id.version}-no_aop.jar")
                }
                withDependencies {
                    removeAll { it.group == "aopalliance" }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The new variants also have the dependency on the standardized aop interfaces library <code>aopalliance:aopalliance</code> removed, as this is clearly not needed by these variants.
Again, this is information that cannot be expressed in pom metadata.
We can now select a <code>guice-no_aop</code> variant and will get the correct jar file <strong>and</strong> the correct dependencies.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    components {
        withModule&lt;GuiceRule&gt;("com.google.inject:guice")
    }
    implementation("com.google.inject:guice:4.2.2") {
        capabilities { requireCapability("com.google.inject:guice-no_aop") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    components {
        withModule("com.google.inject:guice", GuiceRule)
    }
    implementation("com.google.inject:guice:4.2.2") {
        capabilities { requireCapability("com.google.inject:guice-no_aop") }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding-missing-capabilities"><a class="anchor" href="#sec:adding-missing-capabilities"></a><a class="link" href="#sec:adding-missing-capabilities">Adding missing capabilities to detect conflicts</a></h4>
<div class="paragraph">
<p>Another usage of capabilities is to express that two different modules, for example <code>log4j</code> and <code>log4j-over-slf4j</code>, provide alternative implementations of the same thing.
By declaring that both provide the same capability, Gradle only accepts one of them in a dependency graph.
This example, and how it can be tackled with a component metadata rule, is described in detail in the  <a href="#sec:declaring-capabilities-external-modules">feature modelling</a> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:making-ivy-modules-variant-aware"><a class="anchor" href="#sec:making-ivy-modules-variant-aware"></a><a class="link" href="#sec:making-ivy-modules-variant-aware">Making Ivy modules variant-aware</a></h4>
<div class="paragraph">
<p>Modules published using Ivy do not have variants available by default.</p>
</div>
<div class="paragraph">
<p>However, <em>Ivy configurations</em> can be mapped to variants as the <code>addVariant(name, baseVariantOrConfiguration)</code> accepts any Ivy configuration that was published as base.
This can be used, for example, to define runtime and compile variants.
An example of a corresponding rule can be found <a href="#sec:ivy-mapping-to-variants">here</a>.
Ivy details of Ivy configurations (e.g. dependencies and files) can also be modified using the <code>withVariant(configurationName)</code> API.
However, modifying attributes or capabilities on Ivy configurations has no effect.</p>
</div>
<div class="paragraph">
<p>For very Ivy specific use cases, the component metadata rules API also offers access to other details only found in Ivy metadata.
These are available through the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a> interface and can be accessed using <code>getDescriptor(IvyModuleDescriptor)</code> on the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class IvyComponentRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val descriptor = context.getDescriptor(IvyModuleDescriptor::class)
        if (descriptor != null &amp;&amp; descriptor.branch == "testing") {
            context.details.status = "rc"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class IvyComponentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def descriptor = context.getDescriptor(IvyModuleDescriptor)
        if (descriptor != null &amp;&amp; descriptor.branch == "testing") {
            context.details.status = "rc"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:filter-maven-metadata"><a class="anchor" href="#sec:filter-maven-metadata"></a><a class="link" href="#sec:filter-maven-metadata">Filter using Maven metadata</a></h4>
<div class="paragraph">
<p>For Maven specific use cases, the component metadata rules API also offers access to other details only found in POM metadata.
These are available through the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/maven/PomModuleDescriptor.html">PomModuleDescriptor</a> interface and can be accessed using <code>getDescriptor(PomModuleDescriptor)</code> on the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class MavenComponentRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        val descriptor = context.getDescriptor(PomModuleDescriptor::class)
        if (descriptor != null &amp;&amp; descriptor.packaging == "war") {
            // ...
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class MavenComponentRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        def descriptor = context.getDescriptor(PomModuleDescriptor)
        if (descriptor != null &amp;&amp; descriptor.packaging == "war") {
            // ...
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:modifying-metadata"><a class="anchor" href="#sec:modifying-metadata"></a><a class="link" href="#sec:modifying-metadata">Modifying metadata on the component level for alignment</a></h4>
<div class="paragraph">
<p>While all the examples above made modifications to variants of a component, there is also a limited set of modifications that can be done to the metadata of the component itself.
This information can influence the <a href="graph_resolution.html#sec:conflict-resolution">version selection</a> process for a module during dependency resolution, which is performed <em>before</em> one or multiple variants of a component are selected.</p>
</div>
<div class="paragraph">
<p>The first API available on the component is <code>belongsTo()</code> to create virtual platforms for aligning versions of multiple modules without Gradle Module Metadata.
It is explained in detail in the section on <a href="how_to_align_dependency_versions.html#sec:align-versions-unpublished">aligning versions of modules not published with Gradle</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom-status-scheme"><a class="anchor" href="#sec:custom-status-scheme"></a><a class="link" href="#sec:custom-status-scheme">Modifying metadata on the component level for version selection based on status</a></h4>
<div class="paragraph">
<p>Gradle and Gradle Module Metadata also allow attributes to be set on the whole component instead of a single variant.
Each of these attributes carries special semantics as they influence version selection which is done <em>before</em> variant selection.
While variant selection can handle <a href="#sec:declaring-attributes">any custom attribute</a>, version selection only considers attributes for which specific semantics are implemented.
At the moment, the only attribute with meaning here is <code>org.gradle.status</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>org.gradle.status</code> module attribute indicates the lifecycle status or maturity level of a module or library:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong><code>integration</code></strong>: This indicates that the module is under active development and may not be stable.</p>
</li>
<li>
<p><strong><code>milestone</code></strong>: A module with this status is more mature than one marked as <code>integration</code>.</p>
</li>
<li>
<p><strong><code>release</code></strong>: This status signifies that the module is stable and officially released.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>It is therefore recommended to only modify this attribute, if any, on the component level.
A dedicated API <code>setStatus(value)</code> is available for this.
To modify another attribute for all variants of a component <code>withAllVariants { attributes {} }</code> should be utilised instead.</p>
</div>
<div class="paragraph">
<p>A module&#8217;s status is taken into consideration when a <a href="#sec:single-version-declarations"><em>latest</em> version selector</a> is resolved.
Specifically, <code>latest.someStatus</code> will resolve to the highest module version that has status <code>someStatus</code> or a more mature status.
For example, <code>latest.integration</code> will select the highest module version regardless of its status (because <code>integration</code> is the least mature status as explained below), whereas <code>latest.release</code> will select the highest module version with status <code>release</code>.</p>
</div>
<div class="paragraph">
<p>The interpretation of the status can be influenced by changing a module&#8217;s <em>status scheme</em> through the <code>setStatusScheme(valueList)</code> API.
This concept models the different levels of maturity that a module transitions through over time with different publications.
The default status scheme, ordered from least to most mature status, is <code>integration</code>, <code>milestone</code>, <code>release</code>.
The <code>org.gradle.status</code> attribute must be set, to one of the values in the component&#8217;s status scheme.
Thus each component always has a status which is determined from the metadata as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata: the value that was published for the <code>org.gradle.status</code> attribute on the component</p>
</li>
<li>
<p>Ivy metadata: <code>status</code> defined in the ivy.xml, defaults to <code>integration</code> if missing</p>
</li>
<li>
<p>Pom metadata: <code>integration</code> for modules with a SNAPSHOT version, <code>release</code> for all others</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example demonstrates <code>latest</code> selectors based on a custom status scheme declared in a component metadata rule that applies to all modules:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableRule
abstract class CustomStatusRule : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) {
        context.details.statusScheme = listOf("nightly", "milestone", "rc", "release")
        if (context.details.status == "integration") {
            context.details.status = "nightly"
        }
    }
}

dependencies {
    components {
        all&lt;CustomStatusRule&gt;()
    }
    implementation("org.apache.commons:commons-lang3:latest.rc")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableRule
abstract class CustomStatusRule implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.statusScheme = ["nightly", "milestone", "rc", "release"]
        if (context.details.status == "integration") {
            context.details.status = "nightly"
        }
    }
}

dependencies {
    components {
        all(CustomStatusRule)
    }
    implementation("org.apache.commons:commons-lang3:latest.rc")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Compared to the default scheme, the rule inserts a new status <code>rc</code> and replaces <code>integration</code> with <code>nightly</code>.
Existing modules with the status <code>integration</code> are mapped to <code>nightly</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency-caching"><a class="anchor" href="#dependency-caching"></a><a class="link" href="#dependency-caching">Dependency Caching</a></h3>
<div class="paragraph">
<p>Gradle contains a highly sophisticated dependency caching mechanism, which seeks to minimise the number of remote requests made in dependency resolution, while striving to guarantee that the results of dependency resolution are correct and reproducible.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Local Cache</strong>: Gradle caches dependencies locally to avoid repeated downloads.
The cache is located in the <code>.gradle</code> directory under the user&#8217;s home folder (e.g., <code>~/.gradle/caches/modules-2</code>).
When a dependency is requested, Gradle first checks this local cache before attempting to fetch it from remote repositories.</p>
</li>
<li>
<p><strong>Changing Dependencies</strong>: By default, Gradle treats dependencies marked as "changing" (e.g., SNAPSHOT or dynamic dependencies) differently and refreshes them more frequently.
The caching times for these dependencies can be altered programmatically.</p>
</li>
<li>
<p><strong>Offline Mode</strong>: Gradle can run in <strong>offline mode</strong>, using only the cached dependencies without trying to download anything from remote repositories.
You can enable offline mode with the <code>--offline</code> flag, ensuring that your build only uses cached artifacts.</p>
</li>
<li>
<p><strong>Refreshing Dependencies</strong>: To force Gradle to update its dependencies, use the <code>--refresh-dependencies</code> flag.
This option instructs Gradle to bypass the cache and check for updated artifacts in remote repositories.
Gradle downloads them, but only if it detects a change, using hashes to avoid unnecessary downloads.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="sec:dependency-cache"><a class="anchor" href="#sec:dependency-cache"></a><a class="link" href="#sec:dependency-cache">1. The dependency cache</a></h4>
<div class="paragraph">
<p>The Gradle dependency cache consists of two storage types located under <code>$<a href="#dir:gradle_user_home">GRADLE_USER_HOME</a>/caches</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A file-based store of downloaded artifacts, including binaries like jars as well as raw downloaded meta-data like POM files and Ivy files.
Artifacts are stored under a checksum, so name clashes will not cause issues.</p>
</li>
<li>
<p>A binary store of resolved module metadata, including the results of resolving dynamic versions, module descriptors, and artifacts.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="sec:cache-metadata"><a class="anchor" href="#sec:cache-metadata"></a><a class="link" href="#sec:cache-metadata">Separate metadata cache</a></h5>
<div class="paragraph">
<p>Gradle keeps a record of various aspects of dependency resolution in binary format in the metadata cache.</p>
</div>
<div class="paragraph">
<p>The information stored in the metadata cache includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result of resolving a dynamic version (e.g. <code>1.+</code>) to a concrete version (e.g. <code>1.2</code>).</p>
</li>
<li>
<p>The resolved module metadata for a particular module, including module artifacts and module dependencies.</p>
</li>
<li>
<p>The resolved artifact metadata for a particular artifact, including a pointer to the downloaded artifact file.</p>
</li>
<li>
<p>The <em>absence</em> of a particular module or artifact in a particular repository, eliminating repeated attempts to access a resource that does not exist.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every entry in the metadata cache includes a record of the repository that provided the information as well as a timestamp that can be used for cache expiry.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:cache-repository-independence"><a class="anchor" href="#sec:cache-repository-independence"></a><a class="link" href="#sec:cache-repository-independence">Repository caches are independent</a></h5>
<div class="paragraph">
<p>As described above, for each repository there is a separate metadata cache.
A repository is identified by its URL, type and layout.</p>
</div>
<div class="paragraph">
<p>If a module or artifact has not been previously resolved from <em>this repository</em>, Gradle will attempt to resolve the module against the repository.
This will always involve a remote lookup on the repository, however in many cases <a href="#sec:cache-artifact-reuse">no download will be required</a>.</p>
</div>
<div class="paragraph">
<p>Dependency resolution will fail if required artifacts arent available in the repository from which they were originally resolved.
Once resolved from a specific repository, artifacts become "sticky," meaning Gradle will avoid resolving them from other repositories to prevent unexpected or potentially unsafe changes in artifact sources.
This ensures consistency across environments, but it may also lead to failures if repositories differ between machines.</p>
</div>
<div class="paragraph">
<p>Repository independence allows builds to be isolated from each other.
This is a key feature to create builds that are reliable and reproducible in any environment.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:cache-artifact-reuse"><a class="anchor" href="#sec:cache-artifact-reuse"></a><a class="link" href="#sec:cache-artifact-reuse">Artifact reuse</a></h5>
<div class="paragraph">
<p>Before downloading an artifact, Gradle attempts to retrieve the artifact&#8217;s checksum by downloading an associated <code>.sha512</code>, <code>.sha256</code>, <code>.sha1</code>, or <code>.md5</code> file (attempting each in order).</p>
</div>
<div class="paragraph">
<p>If the checksum is available, Gradle skips the download if an artifact with the same ID and checksum already exists.
However, if the checksum cannot be retrieved from the remote server, Gradle proceeds to download the artifact but will ignore it if it matches an existing one.</p>
</div>
<div class="paragraph">
<p>Gradle also tries to reuse artifacts from the local Maven repository.
If an artifact previously downloaded by Maven is a match, Gradle will use it, provided it can be verified against the checksum from the remote server.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:cache-checksum-storage"><a class="anchor" href="#sec:cache-checksum-storage"></a><a class="link" href="#sec:cache-checksum-storage">Checksum based storage</a></h5>
<div class="paragraph">
<p>It is possible for different repositories to provide a different binary artifact in response to the same artifact identifier.</p>
</div>
<div class="paragraph">
<p>This is often the case with Maven SNAPSHOT artifacts, but can also be true for any artifact which is republished without changing its identifier.
By caching artifacts based on their checksum, Gradle is able to maintain multiple versions of the same artifact.
This means that when resolving against one repository Gradle will never overwrite the cached artifact file from a different repository.
This is done without requiring a separate artifact file store per repository.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:cache-locking"><a class="anchor" href="#sec:cache-locking"></a><a class="link" href="#sec:cache-locking">Cache locking</a></h5>
<div class="paragraph">
<p>The Gradle dependency cache uses file-based locking to ensure that it can safely be used by multiple Gradle processes concurrently.
The lock is held whenever the binary metadata store is being read or written, but is released for slow operations such as downloading remote artifacts.</p>
</div>
<div class="paragraph">
<p>This concurrent access is only supported if the different Gradle processes can communicate together. This is usually <em>not the case</em> for containerized builds.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:cache-cleanup"><a class="anchor" href="#sec:cache-cleanup"></a><a class="link" href="#sec:cache-cleanup">Cache cleanup</a></h5>
<div class="paragraph">
<p>Gradle tracks which artifacts in the dependency cache are accessed.
Based on this information, the cache is periodically scanned (no more than once every 24 hours) to identify artifacts that haven&#8217;t been used in over 30 days.
These obsolete artifacts are then deleted to prevent the cache from growing indefinitely.</p>
</div>
<div class="paragraph">
<p>You can learn more about cache cleanup in <a href="#dir:gradle_user_home:cache_cleanup">Gradle-managed Directories</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:changing-dependencies"><a class="anchor" href="#sec:changing-dependencies"></a><a class="link" href="#sec:changing-dependencies">2. Changing dependencies</a></h4>
<div class="paragraph">
<p>Gradle treats dependencies marked as "changing" (such as SNAPSHOT dependencies) differently from regular dependencies, refreshing them more frequently to ensure that you are always using the latest version.</p>
</div>
<div class="paragraph">
<p>To declare a dependency as changing, you can set the <code>changing = true</code> attribute in your dependency declaration.
This is useful for dependencies expected to change frequently without a new version number:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation("com.example:some-library:1.0-SNAPSHOT") // Automatically gets treated as changing
    implementation("com.example:my-library:1.0") {  // Must be explicitly set as changing
        changing = true
    }
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="sec:controlling-dynamic-version-caching"><a class="anchor" href="#sec:controlling-dynamic-version-caching"></a><a class="link" href="#sec:controlling-dynamic-version-caching">Caching changing dependencies</a></h5>
<div class="paragraph">
<p>By default, Gradle caches these dependencies (including dynamic versions and changing modules) for 24 hours, meaning it does not contact remote repositories for new versions during this time.</p>
</div>
<div class="paragraph">
<p>To have Gradle check for newer versions more frequently or with every build, you can adjust the caching threshold or time-to-live (TTL) settings accordingly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Using a short TTL threshold for dynamic or changing versions may result in longer build times due to increased remote repository accesses.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can fine-tune certain aspects of caching programmatically using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ResolutionStrategy.html">ResolutionStrategy</a> for a configuration.
The programmatic approach is useful if you want to change the settings permanently.</p>
</div>
<div class="paragraph">
<p>To change how long Gradle will cache the resolved version for a dynamic version, use:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.cacheDynamicVersionsFor(10, "minutes")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.cacheDynamicVersionsFor 10, 'minutes'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To change how long Gradle will cache the metadata and artifacts for a changing module, use:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.cacheChangingModulesFor(4, "hours")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.cacheChangingModulesFor 4, 'hours'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling-dependency-caching-command-line"><a class="anchor" href="#sec:controlling-dependency-caching-command-line"></a><a class="link" href="#sec:controlling-dependency-caching-command-line">3. Using offline mode</a></h4>
<div class="paragraph">
<p>The <code>--offline</code> command-line switch instructs Gradle to use dependency modules from the cache, regardless of whether they are due to be checked again.
When running with <code>offline</code>, Gradle will not attempt to access the network for dependency resolution.
If the required modules are not in the dependency cache, the build will fail.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:refreshing-dependencies"><a class="anchor" href="#sec:refreshing-dependencies"></a><a class="link" href="#sec:refreshing-dependencies">4. Force-refreshing dependencies</a></h4>
<div class="paragraph">
<p>You can control the behavior of dependency caching for a distinct build invocation from the command line.
Command line options help make a selective, ad-hoc choice for a single build execution.</p>
</div>
<div class="paragraph">
<p>At times, the Gradle Dependency Cache can become out of sync with the actual state of the configured repositories.
Perhaps a repository was initially misconfigured, or maybe a "non-changing" module was published incorrectly.
To refresh all dependencies in the dependency cache, use the <code>--refresh-dependencies</code> option on the command line.</p>
</div>
<div class="paragraph">
<p>The <code>--refresh-dependencies</code> option tells Gradle to ignore all cached entries for resolved modules and artifacts.
A fresh resolve will be performed against all configured repositories, with dynamic versions recalculated, modules refreshed, and artifacts downloaded.
However, where possible Gradle will check if the previously downloaded artifacts are valid before downloading again.
This is done by comparing published checksum values in the repository with the checksum values for existing downloaded artifacts.</p>
</div>
<div class="paragraph">
<p>Refreshing dependencies will cause Gradle to invalidate its listing caches.
However:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it will perform HTTP HEAD requests on metadata files but <em>will not re-download them</em> if they are identical</p>
</li>
<li>
<p>it will perform HTTP HEAD requests on artifact files but <em>will not re-download them</em> if they are identical</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, refreshing dependencies <em>only</em> has an impact if you actually use dynamic dependencies <em>or</em> that you have changing dependencies that you were not aware of (in which case it is your responsibility to declare them correctly to Gradle as changing dependencies).</p>
</div>
<div class="paragraph">
<p>It&#8217;s a common misconception to think that using <code>--refresh-dependencies</code> will force the download of dependencies.
This is <strong>not</strong> the case: Gradle will only perform what is strictly required to refresh the dynamic dependencies.
This <em>may</em> involve downloading new listings, metadata files, or even artifacts, but the impact is minimal if nothing changed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:ephemeral-ci-cache"><a class="anchor" href="#sec:ephemeral-ci-cache"></a><a class="link" href="#sec:ephemeral-ci-cache">Dealing with ephemeral builds</a></h4>
<div class="paragraph">
<p>It&#8217;s a common practice to run builds in ephemeral containers.
A container is typically spawned to only execute a single build before it is destroyed.
This can become a practical problem when a build depends on a lot of dependencies which each container has to re-download.
To help with this scenario, Gradle provides a couple of options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:cache-copy">copying the dependency cache</a> into each container</p>
</li>
<li>
<p><a href="#sec:shared-readonly-cache">sharing a read-only dependency cache</a> between multiple containers</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:cache-copy"><a class="anchor" href="#sec:cache-copy"></a><a class="link" href="#sec:cache-copy">Copying and reusing the cache</a></h5>
<div class="paragraph">
<p>The dependency cache, both the file and metadata parts, are fully encoded using relative paths.
This means that it is perfectly possible to copy a cache around and see Gradle benefit from it.</p>
</div>
<div class="paragraph">
<p>The path that can be copied is <code>$GRADLE_USER_HOME/caches/modules-&lt;version&gt;</code>.
The only constraint is placing it using the same structure at the destination, where the value of <code>GRADLE_USER_HOME</code> can be different.</p>
</div>
<div class="paragraph">
<p>Do not copy the <code>*.lock</code> or <code>gc.properties</code> files if they exist.</p>
</div>
<div class="paragraph">
<p>Note that creating the cache and consuming it should be done using compatible Gradle version, as shown in the table below.
Otherwise, the build might still require some interactions with remote repositories to complete missing information, which might be available in a different version.
If multiple incompatible Gradle versions are in play, all should be used when seeding the cache.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module cache version</th>
<th class="tableblock halign-left valign-top">File cache version</th>
<th class="tableblock halign-left valign-top">Metadata cache version</th>
<th class="tableblock halign-left valign-top">Gradle version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.95</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 6.1 to Gradle 6.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.96</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 6.4 to Gradle 6.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.97</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 6.8 to Gradle 7.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.99</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 7.5 to Gradle 7.6.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.101</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 7.6.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.105</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 8.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.106</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 8.2 to Gradle 8.10.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modules-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>files-2.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata-2.107</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle 8.11 and above</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sec:shared-readonly-cache"><a class="anchor" href="#sec:shared-readonly-cache"></a><a class="link" href="#sec:shared-readonly-cache">Sharing the dependency cache with other Gradle instances</a></h5>
<div class="paragraph">
<p>Instead of <a href="#sec:cache-copy">copying the dependency cache into each container</a>, it&#8217;s possible to mount a shared, read-only directory that will act as a dependency cache for all containers.
This cache, unlike the classical dependency cache, is accessed without locking, making it possible for multiple builds to read from the cache concurrently. It&#8217;s important that the read-only cache
is not written to when other builds may be reading from it.</p>
</div>
<div class="paragraph">
<p>When using the shared read-only cache, Gradle looks for dependencies (artifacts or metadata) in both the writable cache in the local Gradle User Home directory and the shared read-only cache.
If a dependency is present in the read-only cache, it will not be downloaded.
If a dependency is missing from the read-only cache, it will be downloaded and added to the writable cache.
In practice, this means that the writable cache will only contain dependencies that are unavailable in the read-only cache.</p>
</div>
<div class="paragraph">
<p>The read-only cache should be sourced from a Gradle dependency cache that already contains some of the required dependencies.
The cache can be incomplete; however, an empty shared cache will only add overhead.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The shared read-only dependency cache is an incubating feature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first step in using a shared dependency cache is to create one by copying of an existing <em>local</em> cache.
For this you need to follow the <a href="#sec:cache-copy">instructions above</a>.</p>
</div>
<div class="paragraph">
<p>Then set the <code>GRADLE_RO_DEP_CACHE</code> environment variable to point to the directory containing the cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$GRADLE_RO_DEP_CACHE
   |-- modules-2 : the read-only dependency cache, should be mounted with read-only privileges

$GRADLE_HOME
   |-- caches
         |-- modules-2 : the container specific dependency cache, should be writable
         |-- ...
   |-- ...</pre>
</div>
</div>
<div class="paragraph">
<p>In a CI environment, it&#8217;s a good idea to have one build which "seeds" a Gradle dependency cache, which is then <em>copied</em> to a different directory or distributed, for example, as a Docker volume.
This directory can then be used as the read-only cache for other builds.
You shouldn&#8217;t use an existing Gradle installation cache as the read-only cache, because this directory may contain locks and may be modified by the seeding build.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="controlling_dependency_resolution"><a class="anchor" href="#controlling_dependency_resolution"></a><a class="link" href="#controlling_dependency_resolution">CONTROLLING DEPENDENCY RESOLUTION</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="resolution_consistency"><a class="anchor" href="#resolution_consistency"></a><a class="link" href="#resolution_consistency">Dependency Resolution Consistency</a></h3>
<div class="paragraph">
<p>In a typical Gradle project, multiple configurations exist, such as <code>compileClasspath</code> and <code>runtimeClasspath</code>.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.codehaus.groovy:groovy:3.0.1")
    runtimeOnly("io.vertx:vertx-lang-groovy:3.9.4")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.codehaus.groovy:groovy:3.0.1'
    runtimeOnly 'io.vertx:vertx-lang-groovy:3.9.4'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>These configurations are resolved independently, which can lead to situations where the same dependency appears in different versions across configurations.</p>
</div>
<div class="paragraph">
<p>For instance, a library used during compilation (<code>compileClasspath</code>) might resolve to version 1.0, while at runtime (<code>runtimeClasspath</code>), due to additional transitive dependencies, it might resolve to version 1.1.
This discrepancy can cause unexpected behavior or runtime errors.</p>
</div>
<div class="paragraph">
<p>To address this, Gradle allows you to enforce consistent resolution of dependencies across configurations.
By declaring that certain configurations should resolve dependencies consistently with others, you ensure that shared dependencies have the same version in both configurations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Dependency resolution consistency is an incubating feature.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="implementing_consistent_resolution"><a class="anchor" href="#implementing_consistent_resolution"></a><a class="link" href="#implementing_consistent_resolution">Implementing Consistent Resolution</a></h4>
<div class="paragraph">
<p>For example, to ensure that the <code>runtimeClasspath</code> is consistent with the <code>compileClasspath</code>, you can configure your <code>build.gradle(.kts)</code> as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    runtimeClasspath.get().shouldResolveConsistentlyWith(compileClasspath.get())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    runtimeClasspath.shouldResolveConsistentlyWith(compileClasspath)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This setup directs Gradle to align the versions of dependencies in the <code>runtimeClasspath</code> with those resolved in the <code>compileClasspath</code>.
If a version conflict arises that cannot be reconciled, Gradle will fail the build, prompting you to address the inconsistency.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_consistency"><a class="anchor" href="#sec:java_consistency"></a><a class="link" href="#sec:java_consistency">Automatic Configuration in the Java Ecosystem</a></h4>
<div class="paragraph">
<p>For Java projects, Gradle provides a convenient method to enforce this consistency across all source sets:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    consistentResolution {
        useCompileClasspathVersions()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    consistentResolution {
        useCompileClasspathVersions()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This configuration ensures that all runtime classpaths are consistent with their corresponding compile classpaths, promoting reliable and predictable builds.</p>
</div>
<div class="paragraph">
<p>By implementing dependency resolution consistency, you can prevent subtle bugs and maintain uniformity in your project&#8217;s dependency versions across different classpaths.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resolving-specific-artifacts"><a class="anchor" href="#resolving-specific-artifacts"></a><a class="link" href="#resolving-specific-artifacts">Resolving Specific Artifacts</a></h3>
<div class="paragraph">
<p>When resolving a module from a Maven or Ivy repository, Gradle looks for metadata (e.g., <code>.module</code>, <code>pom.xml</code>, <code>ivy.xml</code>) and a default artifact file (typically a JAR).
If neither is found, the resolution fails.</p>
</div>
<div class="paragraph">
<p>In some cases, you may want to override this behavior and request only a specific artifact from a module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The module provides only a non-standard artifact (e.g., a ZIP file) with no metadata.</p>
</li>
<li>
<p>The module publishes multiple artifacts, and you only want one of them.</p>
</li>
<li>
<p>You want to avoid resolving transitive dependencies declared in metadata.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle supports this use case with <strong>artifact-only notation</strong>, where you append an <code>@&lt;extension&gt;</code> to the dependency coordinates.
This instructs Gradle to resolve only the artifact with that file extension and skip metadata-based resolution entirely.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>@&lt;extension&gt;</code> <strong>only</strong> works for module dependencies.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, suppose you&#8217;re building a web application and want to fetch a JavaScript library directly from a repository rather than checking it into version control.
The <a href="https://developers.google.com/speed/libraries/">Google Hosted Libraries</a> platform distributes many open-source JavaScript libraries this way.</p>
</div>
<div class="paragraph">
<p>To download the <code>.js</code> artifact directly, use the <code>@js</code> syntax:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = 'https://ajax.googleapis.com/ajax/libs'
        patternLayout {
            artifact '[organization]/[revision]/[module].[ext]'
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    js
}

dependencies {
    js 'jquery:jquery:3.2.1@js'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("https://ajax.googleapis.com/ajax/libs")
        patternLayout {
            artifact("[organization]/[revision]/[module].[ext]")
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    create("js")
}

dependencies {
    "js"("jquery:jquery:3.2.1@js")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Some modules publish multiple "flavors" of the same artifactfor example, compiled classes, source code, or Javadocs.
In JavaScript, a library may publish both an uncompressed and a minified version.
These variants are often distinguished using a <strong>classifier</strong>, a common concept in Maven and Ivy.</p>
</div>
<div class="paragraph">
<p>To request an artifact with a specific classifier, include it in the dependency notation.
The following example resolves the minified version of a JQuery library using the classifier <code>min</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        url = 'https://ajax.googleapis.com/ajax/libs'
        patternLayout {
            artifact '[organization]/[revision]/[module](.[classifier]).[ext]'
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    js
}

dependencies {
    js 'jquery:jquery:3.2.1:min@js'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        url = uri("https://ajax.googleapis.com/ajax/libs")
        patternLayout {
            artifact("[organization]/[revision]/[module](.[classifier]).[ext]")
        }
        metadataSources {
            artifact()
        }
    }
}

configurations {
    create("js")
}

dependencies {
    "js"("jquery:jquery:3.2.1:min@js")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using <code>@extension</code> bypasses metadata-based resolution.
Gradle will not attempt to download or interpret module metadata (e.g., <code>.module</code>, <code>pom.xml</code>, <code>ivy.xml</code>), and will treat the coordinates as a direct request for a single artifact.
As a result, variant-aware resolution, capabilities, and transitive dependencies are all bypassed.
If no metadata is available and the requested artifact cannot be found, the build may fail.
In such cases, you may need to provide module metadata using <a href="#component-metadata-rules">component metadata rules</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="capabilities"><a class="anchor" href="#capabilities"></a><a class="link" href="#capabilities">Capabilities</a></h3>
<div class="paragraph">
<p>In a dependency graph, it&#8217;s common for multiple implementations of the same API to be accidentally included, especially with libraries like logging frameworks where different bindings are selected by various transitive dependencies.</p>
</div>
<div id="sec:handling-mutually-exclusive-deps" class="paragraph">
<p>Since these implementations typically reside at different group, artifact, and version (GAV) coordinates, build tools often can&#8217;t detect the conflict.</p>
</div>
<div class="paragraph">
<p>To address this, Gradle introduces the concept of <strong>capability</strong>.</p>
</div>
<div class="sect3">
<h4 id="sec:capabilities"><a class="anchor" href="#sec:capabilities"></a><a class="link" href="#sec:capabilities">Understanding capabilities</a></h4>
<div class="paragraph">
<p>A capability is essentially a way to declare that different components (dependencies) offer the same functionality.</p>
</div>
<div class="paragraph">
<p>Its <strong>illegal</strong> for Gradle to include more than one component providing the same capability in a single dependency graph.
If Gradle detects two components providing the same capability (e.g., different bindings for a logging framework), it will fail the build with an error, indicating the conflicting modules.
This ensures that conflicting implementations are resolved, avoiding issues on the classpath.</p>
</div>
<div class="paragraph">
<p>For instance, suppose you have dependencies on two different libraries for database connection pooling:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.zaxxer:HikariCP:4.0.3")  // A popular connection pool
    implementation("org.apache.commons:commons-dbcp2:2.8.0")  // Another connection pool
}

configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability("database:connection-pool") {
        select("com.zaxxer:HikariCP")
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, both <code>HikariCP</code> and <code>commons-dbcp2</code> provide the same functionality (connection pooling).
Gradle will fail if both are on the classpath.</p>
</div>
<div class="paragraph">
<p>Since only one should be used, Gradles resolution strategy allows you to <strong>select</strong> <code>HikariCP</code>, resolving the conflict.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-capabilities-coordinates"><a class="anchor" href="#sec:declaring-capabilities-coordinates"></a><a class="link" href="#sec:declaring-capabilities-coordinates">Understanding capability coordinates</a></h4>
<div class="paragraph">
<p>A <strong>capability</strong> is identified by a <code>(group, module, version)</code> triplet.</p>
</div>
<div class="paragraph">
<p>Every component defines an implicit capability based on its GAV coordinates: group, artifact, and version.</p>
</div>
<div class="paragraph">
<p>For instance, the <code>org.apache.commons:commons-lang3:3.8</code> module has an implicit capability with the group <code>org.apache.commons</code>, name <code>commons-lang3</code>, and version <code>3.8</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.apache.commons:commons-lang3:3.8")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s important to note that capabilities are <strong>versioned</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-component-capabilities"><a class="anchor" href="#sec:declaring-component-capabilities"></a><a class="link" href="#sec:declaring-component-capabilities">Declaring component capabilities</a></h4>
<div class="paragraph">
<p>To detect conflicts early, it&#8217;s useful to declare <strong>component capabilities</strong> through rules, allowing conflicts to be caught during the build instead of at runtime.</p>
</div>
<div class="paragraph">
<p>One common scenario is when a component is relocated to different coordinates in a newer release.</p>
</div>
<div class="paragraph">
<p>For example, the ASM library was published under <code>asm:asm</code> until version <code>3.3.1</code>, and then relocated to <code>org.ow2.asm:asm</code> starting with version <code>4.0.</code>
Including both versions on the classpath is illegal because they provide the same feature, under different coordinates.</p>
</div>
<div class="paragraph">
<p>Since each component has an implicit capability based on its GAV coordinates, we can address this conflict by using a rule that declares the <code>asm:asm</code> module as providing the <code>org.ow2.asm:asm</code> capability:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class AsmCapability : ComponentMetadataRule {
    override
    fun execute(context: ComponentMetadataContext) = context.details.run {
        if (id.group == "asm" &amp;&amp; id.name == "asm") {
            allVariants {
                withCapabilities {
                    // Declare that ASM provides the org.ow2.asm:asm capability, but with an older version
                    addCapability("org.ow2.asm", "asm", id.version)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CompileStatic
class AsmCapability implements ComponentMetadataRule {
    void execute(ComponentMetadataContext context) {
        context.details.with {
            if (id.group == "asm" &amp;&amp; id.name == "asm") {
                allVariants {
                    it.withCapabilities {
                        // Declare that ASM provides the org.ow2.asm:asm capability, but with an older version
                        it.addCapability("org.ow2.asm", "asm", id.version)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this rule in place, the build will fail if both <code>asm:asm</code> ( &lt; = <code>3.3.1</code>) and <code>org.ow2.asm:asm</code> (<code>4.0+</code>) are present in the dependency graph.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle wont resolve the conflict automatically, but this helps you realize that the problem exists. Its recommended to package such rules into plugins for use in builds, allowing users to decide which version to use or to fix the classpath conflict.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-capabilities-external-modules"><a class="anchor" href="#sec:declaring-capabilities-external-modules"></a><a class="link" href="#sec:declaring-capabilities-external-modules">Declaring capabilities for external modules</a></h4>
<div class="paragraph">
<p>Gradle allows you to declare capabilities not only for components you build but also for external components that dont define them.</p>
</div>
<div class="paragraph">
<p>For example, consider the following dependencies in your build file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // This dependency will bring log4:log4j transitively
    implementation("org.apache.zookeeper:zookeeper:3.4.9")

    // We use log4j over slf4j
    implementation("org.slf4j:log4j-over-slf4j:1.7.10")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // This dependency will bring log4:log4j transitively
    implementation 'org.apache.zookeeper:zookeeper:3.4.9'

    // We use log4j over slf4j
    implementation 'org.slf4j:log4j-over-slf4j:1.7.10'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As it stands, it&#8217;s not obvious that this setup results in two logging frameworks on the classpath.
Specifically, <code>zookeeper</code> brings in <code>log4j</code>, but we want to use <code>log4j-over-slf4j</code>.</p>
</div>
<div class="paragraph">
<p>To proactively detect this conflict, we can define a rule stating that both frameworks provide the same capability:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // Activate the "LoggingCapability" rule
    components.all(LoggingCapability::class.java)
}

class LoggingCapability : ComponentMetadataRule {
    val loggingModules = setOf("log4j", "log4j-over-slf4j")

    override
    fun execute(context: ComponentMetadataContext) = context.details.run {
        if (loggingModules.contains(id.name)) {
            allVariants {
                withCapabilities {
                    // Declare that both log4j and log4j-over-slf4j provide the same capability
                    addCapability("log4j", "log4j", id.version)
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // Activate the "LoggingCapability" rule
    components.all(LoggingCapability)
}

@CompileStatic
class LoggingCapability implements ComponentMetadataRule {
    final static Set&lt;String&gt; LOGGING_MODULES = ["log4j", "log4j-over-slf4j"] as Set&lt;String&gt;

    void execute(ComponentMetadataContext context) {
        context.details.with {
            if (LOGGING_MODULES.contains(id.name)) {
                allVariants {
                    it.withCapabilities {
                        // Declare that both log4j and log4j-over-slf4j provide the same capability
                        it.addCapability("log4j", "log4j", id.version)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This ensures that Gradle detects the conflict and fails with a clear error message:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">dependencyReport.out</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-out hljs" data-lang="out">log4j:log4j:1.2.16 FAILED
   Failures:
      - Could not resolve log4j:log4j:1.2.16.
          - Module 'log4j:log4j' has been rejected:
               Cannot select module with conflict on capability 'log4j:log4j:1.2.16' also provided by ['org.slf4j:log4j-over-slf4j:1.7.10' (compile)]

log4j:log4j:1.2.16 FAILED
\--- org.apache.zookeeper:zookeeper:3.4.9
     \--- compileClasspath

org.slf4j:log4j-over-slf4j:1.7.10 FAILED
   Failures:
      - Could not resolve org.slf4j:log4j-over-slf4j:1.7.10.
          - Module 'org.slf4j:log4j-over-slf4j' has been rejected:
               Cannot select module with conflict on capability 'log4j:log4j:1.7.10' also provided by ['log4j:log4j:1.2.16' (compile)]

org.slf4j:log4j-over-slf4j:1.7.10 FAILED
\--- compileClasspath</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-additional-capabilities-for-a-local-component"><a class="anchor" href="#sec:declaring-additional-capabilities-for-a-local-component"></a><a class="link" href="#sec:declaring-additional-capabilities-for-a-local-component">Declaring capabilities for a local component</a></h4>
<div class="paragraph">
<p>Every component has an <em>implicit capability</em> matching its GAV coordinates.
However, you can also declare additional explicit capabilities, which is useful when a library published under different GAV coordinates serves as an <em>alternate implementation</em> of the same API:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    apiElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
    runtimeElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    apiElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
    runtimeElements {
        outgoing {
            capability("com.acme:my-library:1.0")
            capability("com.other:module:1.1")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Capabilities must be attached to <em>outgoing configurations</em>, which are <a href="#sec:resolvable-consumable-configs">consumable configurations</a> of a component.</p>
</div>
<div class="paragraph">
<p>In this example, we declare two capabilities:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>com.acme:my-library:1.0</code> - the <em>implicit capability</em> of the library.</p>
</li>
<li>
<p><code>com.other:module:1.1</code> -  an additional capability assigned to this library.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It&#8217;s important to declare the implicit capability explicitly because once you define any <em>explicit</em> capability, <em>all</em> capabilities must be declared, including the <em>implicit</em> one.</p>
</div>
<div class="paragraph">
<p>The second capability can either be specific to this library or match a capability provided by an external component.
If <code>com.other:module</code> appears elsewhere in the dependency graph, the build will fail, and consumers <a href="#sec:selecting-between-candidates">must choose which module to use</a>.</p>
</div>
<div class="paragraph">
<p>Capabilities are published in Gradle Module Metadata but have no equivalent in POM or Ivy metadata files.
As a result, when publishing such a component, Gradle warns that this feature is only supported for Gradle consumers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Maven publication 'maven' contains dependencies that cannot be represented in a published pom file.
  - Declares capability com.acme:my-library:1.0
  - Declares capability com.other:module:1.1</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:selecting-between-candidates"><a class="anchor" href="#sec:selecting-between-candidates"></a><a class="link" href="#sec:selecting-between-candidates">Selecting between candidates</a></h4>
<div class="paragraph">
<p>At some point, a dependency graph is going to include either <em>incompatible modules</em>, or modules which are <em>mutually exclusive</em>.</p>
</div>
<div class="paragraph">
<p>For example, you may have different logger implementations, and you need to choose one binding.
<a href="#capabilities">Capabilities</a> help <em>understand</em> the conflict, then Gradle provides you with tools to solve the conflicts.</p>
</div>
<div class="sect4">
<h5 id="sec:selecting-preferred-capability-provider"><a class="anchor" href="#sec:selecting-preferred-capability-provider"></a><a class="link" href="#sec:selecting-preferred-capability-provider">Selecting between different capability candidates</a></h5>
<div class="paragraph">
<p>In the relocation example above, Gradle was able to tell you that you have two versions of the same API on classpath: an "old" module and a "relocated" one.
We can solve the conflict by automatically choosing the component which has the highest capability version:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability("org.ow2.asm:asm") {
        selectHighestVersion()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability('org.ow2.asm:asm') {
        selectHighestVersion()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, choosing the highest capability version conflict resolution is not always suitable.</p>
</div>
<div class="paragraph">
<p>For a logging framework, for example, it doesn&#8217;t matter what version of the logging frameworks we use.
In this case, we explicitly select <code>slf4j</code> as the preferred option:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability("log4j:log4j") {
        val toBeSelected = candidates.firstOrNull { it.id.let { id -&gt; id is ModuleComponentIdentifier &amp;&amp; id.module == "log4j-over-slf4j" } }
        if (toBeSelected != null) {
            select(toBeSelected)
        }
        because("use slf4j in place of log4j")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.all {
    resolutionStrategy.capabilitiesResolution.withCapability("log4j:log4j") {
        def toBeSelected = candidates.find { it.id instanceof ModuleComponentIdentifier &amp;&amp; it.id.module == 'log4j-over-slf4j' }
        if (toBeSelected != null) {
            select(toBeSelected)
        }
        because 'use slf4j in place of log4j'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This approach works also well if you have multiple <code>slf4j</code> bindings on the classpath; bindings are basically different logger implementations, and you need only one.
However, the selected implementation may depend on the configuration being resolved.</p>
</div>
<div class="paragraph">
<p>For instance, in testing environments, the lightweight <code>slf4j-simple</code> logging implementation might be sufficient, while in production, a more robust solution like <code>logback</code> may be preferable.</p>
</div>
<div class="paragraph">
<p>Resolution can only be made in favor of a module that is found in the dependency graph.
The <code>select</code> method accepts only a module from the current set of candidates.
If the desired module is not part of the conflict, you can choose not to resolve that particular conflict, effectively leaving it unresolved.
Another conflict in the graph may have the module you want to select.</p>
</div>
<div class="paragraph">
<p>If no resolution is provided for all conflicts on a given capability, the build will fail because the module chosen for resolution was not found in the graph.
Additionally, calling <code>select(null)</code> will result in an error and should be avoided.</p>
</div>
<div class="paragraph">
<p>For more information, refer to the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ResolutionStrategy.html#capabilitiesResolution">capabilities resolution API</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="variant-attributes"><a class="anchor" href="#variant-attributes"></a><a class="link" href="#variant-attributes">Variants and Attributes</a></h3>
<div class="paragraph">
<p><strong>Variants</strong> represent different versions or aspects of a component, like <code>api</code> vs <code>implementation</code>.
<strong>Attributes</strong> define which variant is selected based on the consumer&#8217;s requirements.</p>
</div>
<div class="paragraph">
<p>For example, a library may have an <code>api</code> and an <code>implementation</code> variant.
Here, the consumer wants an external <code>implementation</code> variant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    implementation {
        attributes {
            attribute(Bundling.BUNDLING_ATTRIBUTE, objects.named(Bundling.EXTERNAL))
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, a build might have <code>debug</code> and <code>release</code> variants.
This selects the <code>debug</code> variant based on the attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    compileClasspath {
        attributes {
            attribute(TargetConfiguration.TARGET_ATTRIBUTE, objects.named("debug"))
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Attributes</strong> help Gradle match the right <strong>variant</strong> by comparing the requested attributes with what&#8217;s available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">attribute(TargetConfiguration.TARGET_ATTRIBUTE, objects.named("debug"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>This sets the <code>TargetConfiguration.TARGET_ATTRIBUTE</code> to <code>"debug"</code>, meaning Gradle will attempt to resolve dependencies that have a "debug" variant, instead of other available variants (like "release").</p>
</div>
<div class="sect3">
<h4 id="sec:standard-attributes"><a class="anchor" href="#sec:standard-attributes"></a><a class="link" href="#sec:standard-attributes">Standard attributes defined by Gradle</a></h4>
<div class="paragraph">
<p>As a user of Gradle, attributes are often hidden as implementation details.
But it might be useful to understand the <em>standard attributes</em> defined by Gradle and its core plugins.</p>
</div>
<div class="paragraph">
<p>As a plugin author, these attributes, and the way they are defined, can serve as a basis for <a href="#sec:declaring-attributes">building your own set of attributes</a> in your ecosystem plugin.</p>
</div>
<div class="sect4">
<h5 id="ecosystem_independent_standard_attributes"><a class="anchor" href="#ecosystem_independent_standard_attributes"></a><a class="link" href="#ecosystem_independent_standard_attributes">Ecosystem-independent standard attributes</a></h5>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Usage.html#USAGE_ATTRIBUTE"><code>org.gradle.usage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates main purpose of variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Usage</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Usage.html">Usage</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. <code>java-runtime</code> can be used in place of <code>java-api</code> but not the opposite)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Category.html#CATEGORY_ATTRIBUTE"><code>org.gradle.category</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the category of this software component</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Category</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Category.html">Category</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. <code>library</code> is default on the JVM, no compatibility otherwise)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/LibraryElements.html#LIBRARY_ELEMENTS_ATTRIBUTE"><code>org.gradle.libraryelements</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the contents of a <code>org.gradle.category=library</code> variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LibraryElements</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/LibraryElements.html">LibraryElements</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics(e.g. in the JVM world, <code>jar</code> is the default and is compatible with <code>classes</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/DocsType.html#DOCS_TYPE_ATTRIBUTE"><code>org.gradle.docstype</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the contents of a <code>org.gradle.category=documentation</code> variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DocsType</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/DocsType.html">DocsType</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default, no compatibility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Bundling.html#BUNDLING_ATTRIBUTE"><code>org.gradle.dependency.bundling</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates how dependencies of a variant are accessed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bundling</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/Bundling.html">Bundling</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following ecosystem semantics (e.g. in the JVM world, <code>embedded</code> is compatible with <code>external</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/VerificationType.html#VERIFICATION_TYPE_ATTRIBUTE"><code>org.gradle.verificationtype</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates what kind of verification task produced this output.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VerificationType</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/VerificationType.html">VerificationType</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default, no compatibility</p></td>
</tr>
</tbody>
</table>
<div id="sec:verification-category" class="paragraph">
<p>When the <code>Category</code> attribute is present with the incubating value <code>org.gradle.category=verification</code> on a variant, that variant is considered to be a verification-time only variant.</p>
</div>
<div class="paragraph">
<p>These variants are meant to contain only the results of running verification tasks, such as test results or code coverage reports.
They are <strong>not publishable</strong>, and will produce an error if added to a component which is published.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component level attribute, derived</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on <a href="#sec:custom-status-scheme">a status scheme</a>, with a default one existing based on the source repository.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Based on the scheme in use</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sec:jvm-default-attributes"><a class="anchor" href="#sec:jvm-default-attributes"></a><a class="link" href="#sec:jvm-default-attributes">JVM ecosystem specific attributes</a></h5>
<div class="paragraph">
<p>In addition to the ecosystem independent attributes defined above, the JVM ecosystem adds the following attribute:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/java/TargetJvmVersion.html#TARGET_JVM_VERSION_ATTRIBUTE"><code>org.gradle.jvm.version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the JVM version compatibility.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer using the version after the <code>1.</code> for Java 1.4 and before, the major version for Java 5 and beyond.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to the JVM version used by Gradle, lower is compatible with higher, prefers highest compatible.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/java/TargetJvmEnvironment.html#TARGET_JVM_ENVIRONMENT_ATTRIBUTE"><code>org.gradle.jvm.environment</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that a variant is optimized for a certain JVM environment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common values are <code>standard-jvm</code> and <code>android</code>. Other values are allowed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The attribute is used to prefer one variant over another if multiple are available, but in general all values are compatible. The default is <code>standard-jvm</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/TestSuiteName.html#TEST_SUITE_NAME_ATTRIBUTE"><code>org.gradle.testsuite.name</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/testing/base/TestSuite.html">TestSuite</a> that produced this output.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is the name of the Suite.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No default, no compatibility</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The JVM ecosystem also contains a number of compatibility and disambiguation rules over the different attributes.
The reader willing to know more can take a look at the code for <code>org.gradle.api.internal.artifacts.JavaEcosystemSupport</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="native_ecosystem_specific_attributes"><a class="anchor" href="#native_ecosystem_specific_attributes"></a><a class="link" href="#native_ecosystem_specific_attributes">Native ecosystem specific attributes</a></h5>
<div class="paragraph">
<p>In addition to the ecosystem independent attributes defined above, the native ecosystem adds the following attributes:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/language/cpp/CppBinary.html#DEBUGGABLE_ATTRIBUTE"><code>org.gradle.native.debuggable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates if the binary was built with debugging symbols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/language/cpp/CppBinary.html#OPTIMIZED_ATTRIBUTE"><code>org.gradle.native.optimized</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates if the binary was built with optimization flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/nativeplatform/MachineArchitecture.html#ARCHITECTURE_ATTRIBUTE"><code>org.gradle.native.architecture</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the target architecture of the binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MachineArchitecture</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/nativeplatform/MachineArchitecture.html">MachineArchitecture</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/nativeplatform/OperatingSystemFamily.html#OPERATING_SYSTEM_ATTRIBUTE"><code>org.gradle.native.operatingSystem</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the target operating system of the binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OperatingSystemFamily</code> values built from constants defined in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/nativeplatform/OperatingSystemFamily.html">OperatingSystemFamily</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sec:gradle-plugins-default-attributes"><a class="anchor" href="#sec:gradle-plugins-default-attributes"></a><a class="link" href="#sec:gradle-plugins-default-attributes">Gradle plugin ecosystem specific attributes</a></h5>
<div class="paragraph">
<p>For Gradle plugin development, the following attribute is supported since Gradle 7.0.
A Gradle plugin variant can specify compatibility with a Gradle API version through this attribute.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Values</th>
<th class="tableblock halign-left valign-top">compatibility and disambiguation rules</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/plugin/GradlePluginApiVersion.html#GRADLE_PLUGIN_API_VERSION_ATTRIBUTE"><code>org.gradle.plugin.api&#8209;version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the Gradle API version compatibility.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid Gradle version strings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to the currently running Gradle, lower is compatible with higher, prefers highest compatible.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:using-standard-attribute"><a class="anchor" href="#sec:using-standard-attribute"></a><a class="link" href="#sec:using-standard-attribute">Using a standard attribute</a></h4>
<div class="paragraph">
<p>For this example, lets assume you are creating a library with different variants for different JVM versions.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
}

configurations {
    named("apiElements") {
        attributes {
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 17)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

configurations {
    apiElements {
        attributes {
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 17)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the consumer project (that uses the library), you can specify the JVM version attribute when declaring dependencies.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("application")
}

dependencies {
    implementation(project(":lib")) {
        attributes {
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 17)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
}

dependencies {
    implementation(project(':lib')) {
        attributes {
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, 17)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By defining and using the JVM version attribute, you ensure that your library and its consumers are compatible with the specified JVM version.
Essentially, this ensures that Gradle resolves to the variant that matches the desired JVM version.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:view-debug-attributes"><a class="anchor" href="#sec:view-debug-attributes"></a><a class="link" href="#sec:view-debug-attributes">Viewing and debugging attributes</a></h4>
<div class="paragraph">
<p>The <code>dependencyInsight</code> task is useful for inspecting specific dependencies and their attributes, including how they are resolved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew dependencyInsight --configuration compileClasspath --dependency com.example:your-library

&gt; Task :dependencyInsight

com.example:your-library:1.0 (compileClasspath)
   variant "apiElements" [
      org.gradle.api.attributes.Attribute: org.gradle.api.attributes.Usage = [java-api]
      org.gradle.api.attributes.Attribute: org.gradle.api.attributes.Usage = [java-runtime]
      org.gradle.api.attributes.Attribute: org.gradle.api.attributes.JavaLanguageVersion = [1.8]
   ]
   variant "runtimeElements" [
      org.gradle.api.attributes.Attribute: org.gradle.api.attributes.Usage = [java-runtime]
      org.gradle.api.attributes.Attribute: org.gradle.api.attributes.JavaLanguageVersion = [1.8]
   ]

   Selection reasons:
      - By constraint from configuration ':compileClasspath'
      - Declared in build.gradle.kts

   Resolved to:
      com.example:your-library:1.0 (runtime)

   Additional Information:
      - Dependency declared in the 'implementation' configuration
      - No matching variants found for the requested attributes in the 'compileClasspath' configuration</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring-attributes"><a class="anchor" href="#sec:declaring-attributes"></a><a class="link" href="#sec:declaring-attributes">Declaring custom attributes</a></h4>
<div class="paragraph">
<p>When extending Gradle with <strong>custom attributes</strong>, its important to consider their long-term impact, especially if you plan to publish libraries.
Custom attributes allow you to integrate <strong>variant-aware dependency management</strong> in your plugin, but libraries using these attributes must also ensure consumers can interpret them correctly.
This is typically done by applying the corresponding plugin, which defines compatibility and disambiguation rules.</p>
</div>
<div class="paragraph">
<p>If your plugin is publicly available and libraries are published to public repositories, introducing new attributes becomes a significant responsibility.
Published attributes must remain supported or have a <a href="#sec:abm-compatibility-rules">compatibility layer</a> in future versions of the plugin to ensure backward compatibility.</p>
</div>
<div class="paragraph">
<p>Heres an example of declaring and using custom attributes in a Gradle plugin:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Define a custom attribute
val myAttribute = Attribute.of("com.example.my-attribute", String::class.java)

configurations {
    create("myConfig") {
        // Set custom attribute
        attributes {
            attribute(myAttribute, "special-value")
        }
    }
}

dependencies {
    // Apply the custom attribute to a dependency
    add("myConfig","com.google.guava:guava:31.1-jre") {
        attributes {
            attribute(myAttribute, "special-value")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Define a custom attribute
def myAttribute = Attribute.of("com.example.my-attribute", String)

// Create a custom configuration
configurations {
    create("myConfig") {
        // Set custom attribute
        attributes {
            attribute(myAttribute, "special-value")
        }
    }
}

dependencies {
    // Apply the custom attribute to a dependency
    add("myConfig", "com.google.guava:guava:31.1-jre") {
        attributes {
            attribute(myAttribute, "special-value")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example:
- A custom attribute <code>my-attribute</code> is defined.
- The attribute is set on a custom configuration (<code>myConfig</code>).
- When adding a dependency, the custom attribute is applied to match the configuration.</p>
</div>
<div class="paragraph">
<p>If publishing a library with this attribute, ensure that consumers apply the plugin that understands and handles <code>my-attribute</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating-attributes"><a class="anchor" href="#sec:creating-attributes"></a><a class="link" href="#sec:creating-attributes">Creating attributes in a build script or plugin</a></h4>
<div class="paragraph">
<p>Attributes are <em>typed</em>.
An attribute can be created via the <code>Attribute&lt;T&gt;.of</code> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// An attribute of type `String`
val myAttribute = Attribute.of("my.attribute.name", String::class.java)
// An attribute of type `Usage`
val myUsage = Attribute.of("my.usage.attribute", Usage::class.java)</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// An attribute of type `String`
def myAttribute = Attribute.of("my.attribute.name", String)
// An attribute of type `Usage`
def myUsage = Attribute.of("my.usage.attribute", Usage)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Attribute types support most Java primitive classes; such as <code>String</code> and <code>Integer</code>.
Or anything extending <code>org.gradle.api.Named</code>.</p>
</div>
<div class="paragraph">
<p>Attributes should always be declared in the <em>attribute schema</em> found on the <code>dependencies</code> handler:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies.attributesSchema {
    // registers this attribute to the attributes schema
    attribute(myAttribute)
    attribute(myUsage)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies.attributesSchema {
    // registers this attribute to the attributes schema
    attribute(myAttribute)
    attribute(myUsage)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Registering an attribute with the schema is required in order to use Compatibility and Disambiguation rules that can resolve ambiguity between multiple selectable variants during <a href="#sec:attribute-matching">Attribute Matching</a>.</p>
</div>
<div class="paragraph">
<p>Each configuration has a container of attributes.  Attributes can be configured to set values:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("myConfiguration") {
        attributes {
            attribute(myAttribute, "my-value")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    myConfiguration {
        attributes {
            attribute(myAttribute, 'my-value')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For attributes which type extends <code>Named</code>, the value of the attribute <strong>must</strong> be created via the <em>object factory</em>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    "myConfiguration" {
        attributes {
            attribute(myUsage, project.objects.named(Usage::class.java, "my-value"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    myConfiguration {
        attributes {
            attribute(myUsage, project.objects.named(Usage, 'my-value'))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:attribute-matching"><a class="anchor" href="#sec:attribute-matching"></a><a class="link" href="#sec:attribute-matching">Dealing with attribute matching</a></h4>
<div class="paragraph">
<p>In Gradle, <strong>attribute matching</strong> and <strong>attribute disambiguation</strong> are key mechanisms for resolving dependencies with varying attributes.</p>
</div>
<div class="paragraph">
<p><strong>Attribute matching</strong> allows Gradle to select compatible dependency variants based on predefined rules, even if an exact match isn&#8217;t available.
<strong>Attribute disambiguation</strong>, on the other hand, helps Gradle choose the most suitable variant when multiple compatible options exist.</p>
</div>
<div class="sect4">
<h5 id="sec:abm-compatibility-rules"><a class="anchor" href="#sec:abm-compatibility-rules"></a><a class="link" href="#sec:abm-compatibility-rules">Attribute compatibility rules</a></h5>
<div class="paragraph">
<p>Attributes let the engine select <em>compatible variants</em>.
There are cases where a producer may not have <em>exactly</em> what the consumer requests but has a variant that can be used.</p>
</div>
<div class="paragraph">
<p>This example defines and registers a custom compatibility rule to ensure that dependencies are selected based on their compatibility with specific Java versions:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// Define the compatibility rule class
class TargetJvmVersionCompatibilityRule : AttributeCompatibilityRule&lt;Int&gt; {
    // Implement the execute method which will check compatibility
    override fun execute(details: CompatibilityCheckDetails&lt;Int&gt;) {
        // Switch case to check the consumer value for supported Java versions
        when (details.consumerValue) {
            8, 11 -&gt; details.compatible()  // Compatible with Java 8 and 11
            else -&gt; details.incompatible()
        }
    }
}

// Register the compatibility rule within the dependencies block
dependencies {
    attributesSchema {
        // Add the compatibility rule for the TargetJvmVersion attribute
        attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE) {
            // Add the defined compatibility rule to this attribute
            compatibilityRules.add(TargetJvmVersionCompatibilityRule::class.java)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// Define the compatibility rule
class TargetJvmVersionCompatibilityRule implements AttributeCompatibilityRule&lt;Integer&gt; {
    @Override
    void execute(CompatibilityCheckDetails&lt;Integer&gt; details) {
        switch (details.consumerValue) {
            case 8:
            case 11:
                details.compatible()  // Compatible with Java 8 and 11
                break
            default:
                details.incompatible("Unsupported Java version: ${details.consumerValue}")
        }
    }
}

// Register a compatibility rule
dependencies {
    attributesSchema {
        attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE) {
            compatibilityRules.add(TargetJvmVersionCompatibilityRule)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle provides <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributeCompatibilityRule.html">attribute compatibility rules</a> that can be defined for each attribute.
The role of a compatibility rule is to explain which attribute values are <em>compatible</em> based on what the consumer asked for.</p>
</div>
<div class="paragraph">
<p>Attribute compatibility rules have to be registered via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributesSchema.html">attributes schema</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:abm-disambiguation-rules"><a class="anchor" href="#sec:abm-disambiguation-rules"></a><a class="link" href="#sec:abm-disambiguation-rules">Attribute disambiguation rules</a></h5>
<div class="paragraph">
<p>When multiple variants of a dependency are compatible with the consumer&#8217;s requested attributes, Gradle needs to decide which variant to select.
This process of determining the "best" candidate among compatible options is called <strong>attribute disambiguation</strong>.</p>
</div>
<div class="paragraph">
<p>In Gradle, different variants might satisfy the consumer&#8217;s request, but not all are equal.
For example, you might have several versions of a library that are compatible with a Java version requested by the consumer.
Disambiguation helps Gradle choose the most appropriate one based on additional criteria.</p>
</div>
<div class="paragraph">
<p>You can define disambiguation rules to guide Gradle in selecting the most suitable variant when multiple candidates are found.
This is done by implementing an <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributeDisambiguationRule.html">AttributeDisambiguationRule</a> and registering it via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributesSchema.html">attributes schema</a> within the <code>dependencies</code> block:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    attributesSchema {
        attribute(Usage.USAGE_ATTRIBUTE) {  // <b class="conum">(1)</b>
            disambiguationRules.add(CustomDisambiguationRule::class.java)  // <b class="conum">(2)</b>
        }
    }
}

abstract class CustomDisambiguationRule @Inject constructor(
    private val objects: ObjectFactory
) : AttributeDisambiguationRule&lt;Usage&gt; {
    override fun execute(details: MultipleCandidatesDetails&lt;Usage&gt;) {
        // Prefer the JAVA_API usage over others (e.g., JAVA_RUNTIME) when multiple candidates exist
        details.closestMatch(objects.named(Usage::class.java, Usage.JAVA_API))  // <b class="conum">(3)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    attributesSchema {
        attribute(Usage.USAGE_ATTRIBUTE) {  // <b class="conum">(1)</b>
            disambiguationRules.add(CustomDisambiguationRule)  // <b class="conum">(2)</b>
        }
    }
}

abstract class CustomDisambiguationRule implements AttributeDisambiguationRule&lt;Usage&gt; {
    private final ObjectFactory objects

    @Inject
    CustomDisambiguationRule(ObjectFactory objects) {
        this.objects = objects
    }

    @Override
    void execute(MultipleCandidatesDetails&lt;Usage&gt; details) {
        // Prefer the JAVA_API usage over others (e.g., JAVA_RUNTIME) when multiple candidates exist
        details.closestMatch(objects.named(Usage, Usage.JAVA_API))  // <b class="conum">(3)</b>
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Attribute Selection</strong>: Specify the attribute to disambiguate (e.g., <code>Usage.USAGE_ATTRIBUTE</code>, a built-in Gradle attribute).</p>
</li>
<li>
<p><strong>Rule Registration</strong>: Register the custom disambiguation rule using <code>disambiguationRules.add()</code> within the <code>attributesSchema</code> block of <code>dependencies</code>.</p>
</li>
<li>
<p><strong>Custom Logic</strong>: Implement the <code>AttributeDisambiguationRule</code> interface in a separate class. The <code>execute</code> method defines how Gradle selects among candidates. In this example, it prefers the <code>JAVA_API</code> usage.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Attribute disambiguation rules must be registered via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributeMatchingStrategy.html">attribute matching strategy</a>, which is accessed through the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/attributes/AttributesSchema.html">attributes schema</a> in the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/DependencyHandler.html">DependencyHandler</a>.
This ensures the rules apply globally to dependency resolution.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:mapping-maven-ivy-to-variants"><a class="anchor" href="#sec:mapping-maven-ivy-to-variants"></a><a class="link" href="#sec:mapping-maven-ivy-to-variants">Mapping from Maven/Ivy to Gradle variants</a></h4>
<div class="paragraph">
<p>Neither Maven nor Ivy have the concept of <em>variants</em>, which are only natively supported by Gradle Module Metadata.
Gradle can still work with Maven and Ivy by using different variant derivation strategies.</p>
</div>
<div class="openblock">
<div class="title">Relationship with Gradle Module Metadata</div>
<div class="content">
<div class="paragraph">
<p>Gradle Module Metadata is a metadata format for modules published on Maven, Ivy and other kinds of repositories.
It is similar to the <code>pom.xml</code> or <code>ivy.xml</code> metadata file, but this format contains details about variants.</p>
</div>
<div class="paragraph">
<p>See the {metadata-file-spec}[Gradle Module Metadata specification] for more information.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:maven-mapping-to-variants"><a class="anchor" href="#sec:maven-mapping-to-variants"></a><a class="link" href="#sec:maven-mapping-to-variants">Mapping of Maven POM metadata to variants</a></h5>
<div class="paragraph">
<p>Modules published to a Maven repository are automatically converted into variant-aware modules when resolved by Gradle.</p>
</div>
<div class="paragraph">
<p>There is no way for Gradle to know which kind of <em>component</em> was published:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a BOM that represents a Gradle platform</p>
</li>
<li>
<p>a BOM used as a super-POM</p>
</li>
<li>
<p>a POM that is both a platform <em>and</em> a library</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default strategy used by Java projects in Gradle is to derive 8 different variants:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>two "library" variants (attribute <code>org.gradle.category</code> = <code>library</code>)</p>
<div class="ulist">
<ul>
<li>
<p>the <code>compile</code> variant maps the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> dependencies.
This variant is equivalent to the <code>apiElements</code> variant of the <a href="#java_library_plugin">Java Library plugin</a>.
All dependencies of this scope are considered <em>API dependencies</em>.</p>
</li>
<li>
<p>the <code>runtime</code> variant maps both the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> and <code>&lt;scope&gt;runtime&lt;/scope&gt;</code> dependencies.
This variant is equivalent to the <code>runtimeElements</code> variant of the <a href="#java_library_plugin">Java Library plugin</a>.
All dependencies of those scopes are considered <em>runtime dependencies</em>.</p>
<div class="ulist">
<ul>
<li>
<p>in both cases, the <code>&lt;dependencyManagement&gt;</code> dependencies are <em>not converted to constraints</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>a "sources" variant that represents the sources jar for the component</p>
</li>
<li>
<p>a "javadoc" variant that represents the javadoc jar for the component</p>
</li>
<li>
<p>four "platform" variants derived from the <code>&lt;dependencyManagement&gt;</code> block (attribute <code>org.gradle.category</code> = <code>platform</code>):</p>
<div class="ulist">
<ul>
<li>
<p>the <code>platform-compile</code> variant maps the  <code>&lt;scope&gt;compile&lt;/scope&gt;</code> dependency management dependencies as <em>dependency constraints</em>.</p>
</li>
<li>
<p>the <code>platform-runtime</code> variant maps both the <code>&lt;scope&gt;compile&lt;/scope&gt;</code> and <code>&lt;scope&gt;runtime&lt;/scope&gt;</code> dependency management dependencies as <em>dependency constraints</em>.</p>
</li>
<li>
<p>the <code>enforced-platform-compile</code> is similar to <code>platform-compile</code> but all the constraints are <em>forced</em></p>
</li>
<li>
<p>the <code>enforced-platform-runtime</code> is similar to <code>platform-runtime</code> but all the constraints are <em>forced</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can understand more about the use of platform and enforced platforms variants by looking at the <a href="#sec:bom-import">importing BOMs</a> section of the manual.
By default, whenever you declare a dependency on a Maven module, Gradle is going to look for the <code>library</code> variants.
However, using the <code>platform</code> or <code>enforcedPlatform</code> keyword, Gradle is now looking for one of the "platform" variants, which allows you to import the constraints from the POM files, instead of the dependencies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ivy-mapping-to-variants"><a class="anchor" href="#sec:ivy-mapping-to-variants"></a><a class="link" href="#sec:ivy-mapping-to-variants">Mapping of Ivy files to variants</a></h4>
<div class="paragraph">
<p>Gradle has no built-in derivation strategy implemented for Ivy files.
Ivy is a flexible format that allows you to publish arbitrary files and can be heavily customized.</p>
</div>
<div class="paragraph">
<p>If you want to implement a derivation strategy for <em>compile</em> and <em>runtime</em> variants for Ivy, you can do so with <a href="#component-metadata-rules"><em>component</em> metadata rule</a>.
The <em>component</em> metadata rules API allows you to <a href="#sec:component-metadata-rules-details">access Ivy configurations</a> and create variants based on them.
If you know that all the Ivy modules your are consuming have been published with Gradle without further customizations of the <code>ivy.xml</code> file, you can add the following rule to your build:</p>
</div>
<div id="ex-deriving-compile-and-runtime-variants-for-ivy-metadata" class="exampleblock">
<div class="title">Example 23. <a href="#ex-deriving-compile-and-runtime-variants-for-ivy-metadata">Deriving compile and runtime variants for Ivy metadata</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class IvyVariantDerivationRule @Inject internal constructor(objectFactory: ObjectFactory) : ComponentMetadataRule {
    private val jarLibraryElements: LibraryElements
    private val libraryCategory: Category
    private val javaRuntimeUsage: Usage
    private val javaApiUsage: Usage

    init {
        jarLibraryElements = objectFactory.named(LibraryElements.JAR)
        libraryCategory = objectFactory.named(Category.LIBRARY)
        javaRuntimeUsage = objectFactory.named(Usage.JAVA_RUNTIME)
        javaApiUsage = objectFactory.named(Usage.JAVA_API)
    }

    override fun execute(context: ComponentMetadataContext) {
        // This filters out any non Ivy module
        if(context.getDescriptor(IvyModuleDescriptor::class) == null) {
            return
        }

        context.details.addVariant("runtimeElements", "default") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, jarLibraryElements)
                attribute(Category.CATEGORY_ATTRIBUTE, libraryCategory)
                attribute(Usage.USAGE_ATTRIBUTE, javaRuntimeUsage)
            }
        }
        context.details.addVariant("apiElements", "compile") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, jarLibraryElements)
                attribute(Category.CATEGORY_ATTRIBUTE, libraryCategory)
                attribute(Usage.USAGE_ATTRIBUTE, javaApiUsage)
            }
        }
    }
}

dependencies {
    components { all&lt;IvyVariantDerivationRule&gt;() }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class IvyVariantDerivationRule implements ComponentMetadataRule {
    final LibraryElements jarLibraryElements
    final Category libraryCategory
    final Usage javaRuntimeUsage
    final Usage javaApiUsage

    @Inject
    IvyVariantDerivationRule(ObjectFactory objectFactory) {
        jarLibraryElements = objectFactory.named(LibraryElements, LibraryElements.JAR)
        libraryCategory = objectFactory.named(Category, Category.LIBRARY)
        javaRuntimeUsage = objectFactory.named(Usage, Usage.JAVA_RUNTIME)
        javaApiUsage = objectFactory.named(Usage, Usage.JAVA_API)
    }

    void execute(ComponentMetadataContext context) {
        // This filters out any non Ivy module
        if(context.getDescriptor(IvyModuleDescriptor) == null) {
            return
        }

        context.details.addVariant("runtimeElements", "default") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, jarLibraryElements)
                attribute(Category.CATEGORY_ATTRIBUTE, libraryCategory)
                attribute(Usage.USAGE_ATTRIBUTE, javaRuntimeUsage)
            }
        }
        context.details.addVariant("apiElements", "compile") {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, jarLibraryElements)
                attribute(Category.CATEGORY_ATTRIBUTE, libraryCategory)
                attribute(Usage.USAGE_ATTRIBUTE, javaApiUsage)
            }
        }
    }
}

dependencies {
    components { all(IvyVariantDerivationRule) }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The rule creates an <code>apiElements</code> variant based on the <code>compile</code> configuration and a <code>runtimeElements</code> variant based on the <code>default</code> configuration of each ivy module.
For each variant, it sets the corresponding <a href="variant_aware_resolution.html#sec:variant-aware-matching">Java ecosystem attributes</a>.
Dependencies and artifacts of the variants are taken from the underlying configurations.
If not all consumed Ivy modules follow this pattern, the rule can be adjusted or only applied to a selected set of modules.</p>
</div>
<div class="paragraph">
<p>For all Ivy modules without variants, Gradle has a fallback selection method. Gradle does <em>not</em> perform variant aware resolution and instead selects either the <code>default</code> configuration or an explicitly named configuration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="artifact-views"><a class="anchor" href="#artifact-views"></a><a class="link" href="#artifact-views">Artifact Views</a></h3>
<div class="paragraph">
<p>In some cases, it is desirable to customize the artifact resolution process.
The <code>ArtifactView</code> API is the primary mechanism for influencing artifact selection in Gradle.</p>
</div>
<div class="paragraph">
<p>An <code>ArtifactView</code> operates on top of the resolved graph but allows you to apply <em>different attributes</em>.
It lets you retrieve artifacts that match a new set of criteria, even if they were not part of the original graph resolution.</p>
</div>
<div class="paragraph">
<p>An <code>ArtifactView</code> can:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Select Alternative Variants</strong> such as sources or javadoc, for an entire resolution: Normally, an artifact must match both the graph&#8217;s attributes and the <code>ArtifactView</code> attributes. With <code>withVariantReselection</code>, you can select artifacts from any available variants within a component.</p>
</li>
<li>
<p><strong>Perform Lenient Artifact Selection</strong> and resolution: Using <code>ArtifactView</code> with <code>lenient=true</code> allows you to ignore missing dependencies and other errors.</p>
</li>
<li>
<p><strong>Filter Selected Artifacts</strong>: Using <code>ArtifactView</code> with <code>componentFilter</code> lets you exclude specific components from the selected artifacts.</p>
</li>
<li>
<p><strong>Trigger Transforms</strong>: Trigger an <code>ArtifactTransform</code> to change an artifact from one type to another.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>ArtifactView</code> can produce results as both a <code>FileCollection</code> and an <code>ArtifactCollection</code>.
The examples below only demonstrate using a <code>FileCollection</code> as the output.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="1_performing_variant_reselection"><a class="anchor" href="#1_performing_variant_reselection"></a><a class="link" href="#1_performing_variant_reselection">1. Performing variant reselection</a></h4>
<div class="paragraph">
<p>Standard artifact selection can only select between variants of the component selected by the result of graph selection.
However, in some cases, it may be desirable to select artifacts from a variant <em>parallel</em> to the graph node being selected.</p>
</div>
<div class="paragraph">
<p>Consider the example component structure below, describing a typical local Java library with sources and javadoc:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">variant 'apiElements'
    artifact set 'jar'
    artifact set 'classes'
    artifact set 'resources'
variant 'runtimeElements'
    artifact set 'jar'
    artifact set 'classes'
    artifact set 'resources'
variant 'javadocElements'
    artifact set 'jar'
variant 'sourcesElements'
    artifact set 'jar'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolving a Java runtime classpath will select the <code>runtimeElements</code> variant from the above example component.
During standard artifact selection, Gradle will select solely from the artifact sets under <code>runtimeElements</code>.</p>
</div>
<div class="paragraph">
<p>However, it is common to want to select all sources or all javadoc for every node in the graph.
Consider the following example which selects all sources for a given runtime classpath:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This example uses incubating APIs.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;ResolveFiles&gt;("resolveSources") {
    files.from(configurations.runtimeClasspath.map {
        it.incoming.artifactView {
            withVariantReselection()
            attributes {
                attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME));
                attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.DOCUMENTATION));
                attribute(Bundling.BUNDLING_ATTRIBUTE, objects.named(Bundling.EXTERNAL));
                attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named(DocsType.SOURCES));
            }
        }.files
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("resolveSources", ResolveFiles) {
    files.from(configurations.runtimeClasspath.incoming.artifactView {
        withVariantReselection()
        attributes {
            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME));
            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.DOCUMENTATION));
            attribute(Bundling.BUNDLING_ATTRIBUTE, objects.named(Bundling, Bundling.EXTERNAL));
            attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named(DocsType, DocsType.SOURCES));
        }
    }.files)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the <code>ArtifactView.withVariantReselection()</code> API, Gradle will optionally perform graph variant selection again <em>before</em> performing artifact selection on the new selected variant.
When Gradle selects artifacts for the <code>runtimeElements</code> node, it will use the attributes specified on the <code>ArtifactView</code> to reselect the graph variant, thus selecting the <code>sourcesElements</code> variant instead.
Then, traditional artifact selection will be performed on the <code>sourcesElements</code> variant to select the <code>jar</code> artifact set.</p>
</div>
<div class="paragraph">
<p>As a result, the sources jar is resolved for each node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>junit-platform-commons-1.11.0-sources.jar
junit-jupiter-api-5.11.0-sources.jar
opentest4j-1.3.0-sources.jar</pre>
</div>
</div>
<div class="paragraph">
<p>When this API is used, the attributes used for variant reselection are specified solely by the <code>ArtifactView.getAttributes()</code> method.
The graph resolution attributes specified on the configuration are completely ignored during variant reselection.</p>
</div>
</div>
<div class="sect3">
<h4 id="2_performing_lenient_artifact_selection_and_resolution"><a class="anchor" href="#2_performing_lenient_artifact_selection_and_resolution"></a><a class="link" href="#2_performing_lenient_artifact_selection_and_resolution">2. Performing lenient artifact selection and resolution</a></h4>
<div class="paragraph">
<p>The <code>ArtifactView</code> API can also be used to perform lenient artifact resolution.
This allows artifact resolution to be performed on a graph that contains failures&#8201;&#8212;&#8201;for example when a requested module was not found, the requested module version did not exist, or a conflict was not resolved.
Furthermore, lenient artifact resolution can be used to resolve artifacts when the graph was successfully resolved, but the corresponding artifacts could not be downloaded.</p>
</div>
<div class="paragraph">
<p>Consider the following example, where some dependencies may not exist:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("does:not:exist")
    implementation("org.junit.jupiter:junit-jupiter-api:5.11.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation("does:not:exist")
    implementation("org.junit.jupiter:junit-jupiter-api:5.11.0")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Lenient resolution is performed by using the <code>ArtifactView.lenient()</code> method:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;ResolveFiles&gt;("resolveLenient") {
    files.from(configurations.runtimeClasspath.map {
        it.incoming.artifactView {
            isLenient = true
        }.files
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("resolveLenient", ResolveFiles) {
    files.from(configurations.runtimeClasspath.incoming.artifactView {
        lenient = true
    }.files)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We can see that the task succeeds with the failing artifact omitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :resolveLenient
junit-platform-commons-1.11.0.jar
junit-jupiter-api-5.11.0.jar
opentest4j-1.3.0.jar

BUILD SUCCESSFUL in 0s</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="3_filtering_selected_artifacts"><a class="anchor" href="#3_filtering_selected_artifacts"></a><a class="link" href="#3_filtering_selected_artifacts">3. Filtering selected artifacts</a></h4>
<div class="paragraph">
<p>The <code>ArtifactView</code> API can be used to filter specific artifacts from the resulting <code>FileCollection</code> or <code>ArtifactCollection</code>.</p>
</div>
<div class="paragraph">
<p><code>ArtifactViews</code> allow results to be filtered on a per-component basis.
Using the <code>ArtifactView.componentFilter(Action)</code> method, artifacts from the selected variant can be filtered from the resolved result.
The action is passed the <code>ComponentIdentifier</code> of the component that owns the variant that artifacts are being selected for.</p>
</div>
<div class="paragraph">
<p>Consider the following example, where we have one project dependency and one external dependency:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(project(":other"))
    implementation("org.junit.jupiter:junit-jupiter-api:5.11.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation(project(":other"))
    implementation("org.junit.jupiter:junit-jupiter-api:5.11.0")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the <code>componentFilter</code> method, we can specify filters that select only artifacts of a certain type:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;ResolveFiles&gt;("resolveProjects") {
    files.from(configurations.runtimeClasspath.map {
        it.incoming.artifactView {
            componentFilter {
                it is ProjectComponentIdentifier
            }
        }.files
    })
}
tasks.register&lt;ResolveFiles&gt;("resolveModules") {
    files.from(configurations.runtimeClasspath.map {
        it.incoming.artifactView {
            componentFilter {
                it is ModuleComponentIdentifier
            }
        }.files
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("resolveProjects", ResolveFiles) {
    files.from(configurations.runtimeClasspath.incoming.artifactView {
        componentFilter {
            it instanceof ProjectComponentIdentifier
        }
    }.files)
}
tasks.register("resolveModules", ResolveFiles) {
    files.from(configurations.runtimeClasspath.incoming.artifactView {
        componentFilter {
            it instanceof ModuleComponentIdentifier
        }
    }.files)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice how we resolve project dependencies and module dependencies separately:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Task :resolveProjects
other.jar

&gt; Task :resolveModules
junit-platform-commons-1.11.0.jar
junit-jupiter-api-5.11.0.jar
opentest4j-1.3.0.jar</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="4_triggering_artifact_transforms"><a class="anchor" href="#4_triggering_artifact_transforms"></a><a class="link" href="#4_triggering_artifact_transforms">4. Triggering artifact transforms</a></h4>
<div class="paragraph">
<p>An <code>ArtifactView</code> can be used to trigger artifact selection using <em>attributes</em> different from those used to resolve the graph.</p>
</div>
<div class="paragraph">
<p>For each node in the graph, artifact selection is performed for that node.
Most commonly, this API is used to request attributes that are not present on the selected artifact.
When Gradle cannot find a matching set of artifacts from the node in question, it will attempt to satisfy the request by transforming the available artifact using the artifact transforms registered on the project.</p>
</div>
<div class="paragraph">
<p>Below, we use the unzip example from the <a href="#sec:implementing-artifact-transforms">artifact transforms</a> chapter to demonstrate how to use the <code>ArtifactView</code> API to request attributes that trigger a transform:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;ResolveFiles&gt;("resolveTransformedFiles") {
    files.from(configurations.runtimeClasspath.map {
        it.incoming.artifactView {
            attributes {
                attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements.CLASSES_AND_RESOURCES))
                attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.DIRECTORY_TYPE)
            }
        }.files
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register("resolveTransformedFiles", ResolveFiles) {
    files.from(configurations.runtimeClasspath.incoming.artifactView {
        attributes {
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, LibraryElements.CLASSES_AND_RESOURCES))
            attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.DIRECTORY_TYPE)
        }
    }.files)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Gradle performs artifact selection using the graph resolution attributes specified on the configuration, concatenated with the attributes specified in the <code>attributes</code> block of the <code>ArtifactView</code>.</p>
</div>
<div class="paragraph">
<p>The task output shows that the artifacts have been transformed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>junit-platform-commons-1.11.0.jar-unzipped
junit-jupiter-api-5.11.0.jar-unzipped
opentest4j-1.3.0.jar-unzipped</pre>
</div>
</div>
<div class="paragraph">
<p>The transform code (<code>ArtifactTransform</code>) used uncompress the JAR file (from <code>ZIP</code> to <code>UNZIP</code>) can be seen in the next chapter.</p>
</div>
<div class="paragraph text-right">
<p><strong>Next Step:</strong> <a href="#artifact-transforms">Learn about Artifact Transforms</a> &gt;&gt;</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="artifact-transforms"><a class="anchor" href="#artifact-transforms"></a><a class="link" href="#artifact-transforms">Artifact Transforms</a></h3>
<div class="paragraph">
<p>What if you want to make changes to the files contained in one of your dependencies before you use it?</p>
</div>
<div class="paragraph">
<p>For example, you might want to unzip a compressed file, adjust the contents of a JAR, or delete unnecessary files from a dependency that contains multiple files prior to using the result in a task.</p>
</div>
<div class="paragraph">
<p>Gradle has a built-in feature for this called <strong>Artifact Transforms</strong>.
With Artifact Transforms, you can modify, add to, remove from the set files (or artifacts) - like JAR files - contained in a dependency.
This is done as the last step when resolving artifacts, before tasks or tools like the IDE can consume the artifacts.</p>
</div>
<div class="sect3">
<h4 id="sec:artifact-transforms-overview"><a class="anchor" href="#sec:artifact-transforms-overview"></a><a class="link" href="#sec:artifact-transforms-overview">Artifact Transforms Overview</a></h4>
<div class="paragraph">
<p>Each component exposes a set of <a href="#sec:resolvable-consumable-configs"><strong>variants</strong></a>, where each variant is identified by a set of <a href="variant_aware_resolution.html#sec:abm-configuration-attributes"><strong>attributes</strong></a> (i.e., key-value pairs such as <code>debug=true</code>).</p>
</div>
<div class="paragraph">
<p>When Gradle resolves a configuration, it looks at each dependency, resolves it to a component, and selects the corresponding variant from that component that matches the requested attributes.
The variant contains one or more artifacts, which represent the concrete outputs produced by a component (such as JAR files, resources, or native binaries).
However, a consumer may need artifacts in a format that doesn&#8217;t directly match any available variant.
Rather than requiring producers to explicitly publish every possible variant, Gradle provides a powerful mechanism to dynamically adapt artifacts to the required form.</p>
</div>
<div class="paragraph">
<p><strong>Artifact Transforms</strong> are a mechanism for converting one type of artifact into another during the build process.
They provide the consumer an efficient and flexible mechanism for transforming the artifacts of a given producer to the required format without needing the producer to expose variants in that format.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/artifact-transform-2.png" alt="artifact transform 2">
</div>
</div>
<div class="paragraph">
<p>Artifact Transforms are a lot like tasks.
They are units of work with some inputs and outputs.
Mechanisms like <code>UP-TO-DATE</code> and caching work for transforms as well.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/artifact-transform-1.png" alt="artifact transform 1">
</div>
</div>
<div class="paragraph">
<p>The primary difference between tasks and transforms is how they are scheduled and put into the chain of actions Gradle executes when a build configures and runs.
At a high level, transforms always run before tasks because they are executed during dependency resolution.
Transforms modify artifacts BEFORE they become an input to a task.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a brief overview of how to create and use Artifact Transforms:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/artifact-transform-3.png" alt="artifact transform 3">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Implement a Transform</strong>: You define an artifact transform by creating a class that implements the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformAction.html"><code>TransformAction</code></a> interface.
This class specifies how the input artifact should be transformed into the output artifact.</p>
</li>
<li>
<p><strong>Declare request Attributes</strong>: Attributes (key-value pairs used to describe different variants of a component) like <code>org.gradle.usage=java-api</code> and <code>org.gradle.usage=java-runtime</code> are used to specify the desired artifact format or type.</p>
</li>
<li>
<p><strong>Register a Transform</strong>: You register the transform by using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/DependencyHandler.html#registerTransform(java.lang.Class,org.gradle.api.Action)"><code>registerTransform()</code></a> method of the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#dependencies(groovy.lang.Closure)"><code>dependencies</code></a> block.
This method tells Gradle that a transform can be used to modify the artifacts of any variant that possesses the given "from" attributes.
It also tells Gradle what new set of "to" attributes will describe the format or type of the resulting artifacts.</p>
</li>
<li>
<p><strong>Use the Transform</strong>: When a resolution requires an artifact that isn&#8217;t already present in the selected component (because none of the actual artifact possess compatible attributes to the requested attributes), Gradle doesn&#8217;t just give up!
Instead, Gradle first <strong>automatically</strong> searches all registered transforms to see if it can construct a chain of transformations that will ultimately produce a match.
If Gradle finds such a chain, it then runs each transform in sequence, and delivers the transformed artifacts as a result.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="1_implement_a_transform"><a class="anchor" href="#1_implement_a_transform"></a><a class="link" href="#1_implement_a_transform">1. Implement a Transform</a></h5>
<div class="paragraph">
<p>A transform is typically written as an abstract class that implements the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformAction.html"><code>TransformAction</code></a> interface.
It can optionally have parameters defined in a separate interface.</p>
</div>
<div class="paragraph">
<p>Each transform has exactly one input artifact.
It must be annotated with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/InputArtifact.html"><code>@InputArtifact</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Then, you implement the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformAction.html#transform(org.gradle.api.artifacts.transform.TransformOutputs)"><code>transform(TransformOutputs)</code></a> method from the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformAction.html"><code>TransformAction</code></a> interface.
This method&#8217;s implementation defines what the transform should do when triggered.
The method has a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformOutputs.html"><code>TransformOutputs</code></a> parameter that you use to tell Gradle what artifacts the transform produces.</p>
</div>
<div class="paragraph">
<p>Here, <code>MyTransform</code> is the custom transform action that converts a <code>jar</code> artifact to a <code>transformed-jar</code> artifact:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class MyTransform : TransformAction&lt;TransformParameters.None&gt; {
    @get:InputArtifact
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override fun transform(outputs: TransformOutputs) {
        val inputFile = inputArtifact.get().asFile
        val outputFile = outputs.file(inputFile.name.replace(".jar", "-transformed.jar"))
        // Perform transformation logic here
        inputFile.copyTo(outputFile, overwrite = true)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class MyTransform implements TransformAction&lt;TransformParameters.None&gt; {
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def inputFile = inputArtifact.get().asFile
        def outputFile = outputs.file(inputFile.name.replace(".jar", "-transformed.jar"))
        // Perform transformation logic here
        inputFile.withInputStream { input -&gt;
            outputFile.withOutputStream { output -&gt;
                output &lt;&lt; input
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="2_declare_request_attributes"><a class="anchor" href="#2_declare_request_attributes"></a><a class="link" href="#2_declare_request_attributes">2. Declare request Attributes</a></h5>
<div class="paragraph">
<p>Attributes specify the required properties of a dependency.</p>
</div>
<div class="paragraph">
<p>Here we specify that we need the <code>transformed-jar</code> format for the <code>runtimeClasspath</code> configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations.named("runtimeClasspath") {
    attributes {
        attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "transformed-jar")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations.named("runtimeClasspath") {
    attributes {
        attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "transformed-jar")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="3_register_a_transform"><a class="anchor" href="#3_register_a_transform"></a><a class="link" href="#3_register_a_transform">3. Register a Transform</a></h5>
<div class="paragraph">
<p>A transform must be registered using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/dsl/DependencyHandler.html#registerTransform(java.lang.Class,org.gradle.api.Action)"><code>dependencies.registerTransform()</code></a> method.</p>
</div>
<div class="paragraph">
<p>Here, our transform is registered with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/Project.html#dependencies(groovy.lang.Closure)"><code>dependencies</code></a> block:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    registerTransform(MyTransform::class) {
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "jar")
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "transformed-jar")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    registerTransform(MyTransform) {
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "jar")
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "transformed-jar")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>"To" attributes are used to describe the format or type of the artifacts that this transform can use as an input, and "from" attributes to describe the format or type of the artifacts that it produces as an output.</p>
</div>
</div>
<div class="sect4">
<h5 id="4_use_the_transform"><a class="anchor" href="#4_use_the_transform"></a><a class="link" href="#4_use_the_transform">4. Use the Transform</a></h5>
<div class="paragraph">
<p>During a build, Gradle <strong>automatically</strong> runs registered transforms to satisfy a resolution request if a match is not directly available.</p>
</div>
<div class="paragraph">
<p>Since no variants exist supplying artifacts of requested format (as none contain the <code>artifactType</code> attribute with a value of <code>"transformed-jar"</code>), Gradle attempts to construct a chain of transformations that will supply an artifact matching the requested attributes.</p>
</div>
<div class="paragraph">
<p>Gradle&#8217;s search finds <code>MyTransform</code>, which is registered as producing the requested format, so it will automatically be run.
Running this transform action modifies the artifacts of an existing source variant to produce new artifacts that are delivered to the consumer, in the requested format.</p>
</div>
<div class="paragraph">
<p>Gradle produces a "virtual artifact set" of the component as part of this process.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:abm-artifact-transforms"><a class="anchor" href="#sec:abm-artifact-transforms"></a><a class="link" href="#sec:abm-artifact-transforms">Understanding Artifact Transforms</a></h4>
<div class="paragraph">
<p>Dependencies can have different <a href="#sec:resolvable-consumable-configs"><strong>variants</strong></a>, essentially different versions or forms of the same dependency.
These variants can each provide a different artifact set, meant to satisfy different use cases, such as compiling code, browsing documentation or running applications.</p>
</div>
<div class="paragraph">
<p>Each variant is identified by a set of <a href="variant_aware_resolution.html#sec:abm-configuration-attributes"><strong>attributes</strong></a>.
Attributes are key-value pairs that describe specific characteristics of the variant.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/artifact-transform-4.png" alt="artifact transform 4">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s use the following example where an external Maven dependency has two variants:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Maven Dependencies</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variant</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.usage=java-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for compiling against the dependency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.usage=java-runtime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for running an application that uses the dependency.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>And a project dependency has even more variants:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Project Dependencies</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variant</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.usage=java-api</code>
<code>org.gradle.libraryelements=classes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents classes directories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.gradle.usage=java-api</code>
<code>org.gradle.libraryelements=jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents a packaged JAR file, containing classes and resources.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The variants of a dependency may differ in their transitive dependencies or in the set of artifacts they contain, or both.</p>
</div>
<div class="paragraph">
<p>For example, the <code>java-api</code> and <code>java-runtime</code> variants of the Maven dependency only differ in their transitive dependencies, and both use the same artifact  the JAR file.
For the project dependency, the <code>java-api,classes</code> and the <code>java-api,jars</code> variants have the same transitive dependencies but different artifacts  the <code>classes</code> directories and the <code>JAR</code> files respectively.</p>
</div>
<div class="paragraph">
<p>When Gradle resolves a configuration, it uses the attributes defined to select the appropriate variant of each dependency.
The attributes that Gradle uses to determine which variant to select are called the <strong>requested attributes</strong>.</p>
</div>
<div class="paragraph">
<p>For example, if a configuration requests <code>org.gradle.usage=java-api</code> and <code>org.gradle.libraryelements=classes</code>, Gradle will select the variant of each dependency that matches these attributes (in this case, classes directories intended for use as an API during compilation).
Matches do not have to exact, as some attribute values can be identified to Gradle as <strong>compatible</strong> with other values and used interchangeably during
<a href="#sec:abm-compatibility-rules"><strong>matching</strong></a>.</p>
</div>
<div class="paragraph">
<p>Sometimes, a dependency might not have a variant with attributes that match the requested attributes.
In such cases, Gradle can transform one variant&#8217;s artifacts into another "virtual artifact set" by modifying its artifacts without changing its transitive dependencies.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Gradle will not attempt to select or run Artifact Transforms when a variant of the dependency matching the requested attributes already exists.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, if the requested variant is <code>java-api,classes</code>, but the dependency only has <code>java-api,jar</code>, Gradle can potentially transform the <code>JAR</code> file into a <code>classes</code> directory by unzipping it using an Artifact Transform that is registered with these attributes.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Gradle applies transformations to artifacts, not variants.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="executing_artifact_transforms"><a class="anchor" href="#executing_artifact_transforms"></a><a class="link" href="#executing_artifact_transforms">Executing Artifact Transforms</a></h4>
<div class="paragraph">
<p>Gradle automatically selects Artifact Transforms as needed to satisfy resolution requests.</p>
</div>
<div class="paragraph">
<p>To run an Artifact Transform, you can configure a custom <a href="#artifact-views">Artifact View</a> to request an artifact set that is not exposed by any variant of the target component.</p>
</div>
<div class="paragraph">
<p>When resolving the <code>ArtifactView</code> Gradle will search for appropriate Artifact Transforms based on the requested attributes in the view.
Gradle will run these transformations on the original artifacts found in a variant of the target component to produce a result compatible with the attributes in the view.</p>
</div>
<div class="paragraph">
<p>In the example below, the <code>TestTransform</code> class defines a transformation that is registered to process artifacts of type "jar" into artifacts of type "stub":</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// The TestTransform class implements TransformAction,
// transforming input JAR files into text files with specific content
abstract class TestTransform : TransformAction&lt;TransformParameters.None&gt; {
    @get:InputArtifact
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override fun transform(outputs: TransformOutputs) {
        val outputFile = outputs.file("transformed-stub.txt")
        outputFile.writeText("Transformed from ${inputArtifact.get().asFile.name}")
    }
}

// The transform is registered to convert artifacts from the type "jar" to "stub"
dependencies {
    registerTransform(TestTransform::class.java) {
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "jar")
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "stub")
    }
}

dependencies {
    runtimeOnly("com.github.javafaker:javafaker:1.0.2")
}

// The testArtifact task queries and prints the attributes of resolved artifacts,
// showing the type conversion in action.
tasks.register("testArtifact") {
    val resolvedArtifacts = configurations.runtimeClasspath.get().incoming.artifactView {
        attributes {
            attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "stub")
        }
    }.artifacts
    inputs.files(resolvedArtifacts.artifactFiles)

    doLast {
        resolvedArtifacts.resolvedArtifacts.get().forEach {
            println("Resolved artifact variant:")
            println("- ${it.variant}")
            println("Resolved artifact attributes:")
            println("- ${it.variant.attributes}")
            println("Resolved artifact type:")
            println("- ${it.variant.attributes.getAttribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE)}")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// The TestTransform class implements TransformAction,
// transforming input JAR files into text files with specific content
abstract class TestTransform implements TransformAction&lt;TransformParameters.None&gt; {
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def outputFile = outputs.file("transformed-stub.txt")
        outputFile.text = "Transformed from ${getInputArtifact().get().asFile.name}"
    }
}

// The transform is registered to convert artifacts from the type "jar" to "stub"
dependencies {
    registerTransform(TestTransform) {
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "jar")
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "stub")
    }
}

dependencies {
    runtimeOnly("com.github.javafaker:javafaker:1.0.2")
}

// The testArtifact task queries and prints the attributes of resolved artifacts,
// showing the type conversion in action.
tasks.register("testArtifact") {
    def resolvedArtifacts = configurations.runtimeClasspath.incoming.artifactView {
        attributes {
            attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, "stub")
        }
    }.artifacts
    inputs.files(resolvedArtifacts.artifactFiles)

    doLast {
        resolvedArtifacts.resolvedArtifacts.get().each {
            println "Resolved artifact variant:"
            println "- ${it.variant}"
            println "Resolved artifact attributes:"
            println "- ${it.variant.attributes}"
            println "Resolved artifact type:"
            println "- ${it.variant.attributes.getAttribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE)}"
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>testArtifact</code> task resolves artifacts of type "stub" using the <code>runtimeClasspath</code> configuration.
This is achieved by creating an <code>ArtifactView</code> that filters for artifacts with <code>ARTIFACT_TYPE_ATTRIBUTE = "stub"</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:artifact-transform-chains"><a class="anchor" href="#sec:artifact-transform-chains"></a><a class="link" href="#sec:artifact-transform-chains">Understanding Artifact Transforms Chains</a></h4>
<div class="paragraph">
<p>When Gradle resolves a configuration and a variant in the graph does not have an artifact set with the requested attributes, it attempts to find a chain of one or more Artifact Transforms that can be run sequentially to create the desired artifact set.
This process is called <strong>Artifact Transform selection</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/artifact-transform-5.png" alt="artifact transform 5">
</div>
</div>
<div class="sect4">
<h5 id="the_artifact_transform_selection_process"><a class="anchor" href="#the_artifact_transform_selection_process"></a><a class="link" href="#the_artifact_transform_selection_process">The Artifact Transform Selection Process:</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Start with requested Attributes</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Gradle starts with the attributes specified on the configuration being resolved, appends any attributes specified on an <code>ArtifactView</code>, and finally appends any attributes declared directly on the dependency.</p>
</li>
<li>
<p>It considers all registered transforms that modify these attributes.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Find a path to existing Variants</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Gradle works backwards, trying to find a path from the requested attributes to an existing variant.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, if the <code>minified</code> attribute has values <code>true</code> and <code>false</code>, and a transform can change <code>minified=false</code> to <code>minified=true</code>, Gradle will use this transform if only <code>minified=false</code> variants are available but <code>minified=true</code> is requested.</p>
</div>
<div class="paragraph">
<p>Gradle selects a chain of transforms using the following process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is only one possible chain that produces the requested attributes, it is selected.</p>
</li>
<li>
<p>If there are multiple such chains, then only the shortest chains are considered.</p>
</li>
<li>
<p>If there are still multiple chains remaining that are equally suitable but produce different results, the selection fails, and an error is reported.</p>
</li>
<li>
<p>If all the remaining chains produce the same set of resulting attributes, Gradle arbitrarily selects one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How can multiple chains produce different suitable results?
Transforms can alter multiple attributes at a time.
A suitable result of a transformation chain is one possessing attributes compatible with the requested attributes.
But a result may contain other attributes as well, that were not requested, and are irrelevant to the result.</p>
</div>
<div class="paragraph">
<p>For example: if attributes <code>A=a</code> and <code>B=b</code> are requested, and variant <code>V1</code> contains attributes <code>A=a</code>, <code>B=b</code>, and <code>C=c</code>, and variant <code>V2</code> contains attributes <code>A=a</code>, <code>B=b</code>, and <code>D=d</code>, then since all the values of <code>A</code> and <code>B</code> are identical (or compatible) either <code>V1</code> or <code>V2</code> would satisfy the request.</p>
</div>
</div>
<div class="sect4">
<h5 id="a_full_example"><a class="anchor" href="#a_full_example"></a><a class="link" href="#a_full_example">A Full Example</a></h5>
<div class="paragraph">
<p>Let&#8217;s continue exploring the <code>minified</code> example begun above: a configuration requests <code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=true</code>.
The dependencies are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>External <code>guava</code> dependency with variants:</p>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=false</code></p>
</li>
<li>
<p><code>org.gradle.usage=java-api, org.gradle.libraryelements=jar, minified=false</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Project <code>producer</code> dependency with variants:</p>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=false</code></p>
</li>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=classes, minified=false</code></p>
</li>
<li>
<p><code>org.gradle.usage=java-api, org.gradle.libraryelements=jar, minified=false</code></p>
</li>
<li>
<p><code>org.gradle.usage=java-api, org.gradle.libraryelements=classes, minified=false</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle uses the <code>minify</code> transform to convert <code>minified=false</code> variants to <code>minified=true</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>guava</code>, Gradle converts</p>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=false</code> to</p>
</li>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=true</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For <code>producer</code>, Gradle converts</p>
<div class="ulist">
<ul>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=false</code> to</p>
</li>
<li>
<p><code>org.gradle.usage=java-runtime, org.gradle.libraryelements=jar, minified=true</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then, during execution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle downloads the <code>guava</code> JAR and runs the transform to minify it.</p>
</li>
<li>
<p>Gradle executes the <code>producer:jar</code> task to produce the JAR and then runs the transform to minify it.</p>
</li>
<li>
<p>These tasks and transforms are executed in parallel where possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To set up the <code>minified</code> attribute so that the above works you must add the attribute to all JAR variants being produced, and also add it to all resolvable configurations being requested.
You should also register the attribute in the attributes schema.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val artifactType = Attribute.of("artifactType", String::class.java)
val minified = Attribute.of("minified", Boolean::class.javaObjectType)
dependencies {
    attributesSchema {
        attribute(minified)                      // <b class="conum">(1)</b>
    }
    artifactTypes.getByName("jar") {
        attributes.attribute(minified, false)    // <b class="conum">(2)</b>
    }
}

configurations.runtimeClasspath.configure {
    attributes {
        attribute(minified, true)                // <b class="conum">(3)</b>
    }
}

dependencies {
    registerTransform(Minify::class) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")
    }
}

dependencies {                                 // <b class="conum">(4)</b>
    implementation("com.google.guava:guava:27.1-jre")
    implementation(project(":producer"))
}

tasks.register&lt;Copy&gt;("resolveRuntimeClasspath") { // <b class="conum">(5)</b>
    from(configurations.runtimeClasspath)
    into(layout.buildDirectory.dir("runtimeClasspath"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def artifactType = Attribute.of('artifactType', String)
def minified = Attribute.of('minified', Boolean)
dependencies {
    attributesSchema {
        attribute(minified)                      // <b class="conum">(1)</b>
    }
    artifactTypes.getByName("jar") {
        attributes.attribute(minified, false)    // <b class="conum">(2)</b>
    }
}

configurations.runtimeClasspath {
    attributes {
        attribute(minified, true)                // <b class="conum">(3)</b>
    }
}

dependencies {
    registerTransform(Minify) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")
    }
}
dependencies {                                 // <b class="conum">(4)</b>
    implementation('com.google.guava:guava:27.1-jre')
    implementation(project(':producer'))
}

tasks.register("resolveRuntimeClasspath", Copy) {// <b class="conum">(5)</b>
    from(configurations.runtimeClasspath)
    into(layout.buildDirectory.dir("runtimeClasspath"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Add the attribute to the schema</p>
</li>
<li>
<p>All JAR files are not minified</p>
</li>
<li>
<p>Request that the runtime classpath is minified</p>
</li>
<li>
<p>Add the dependencies which will be transformed</p>
</li>
<li>
<p>Add task that requires the transformed artifacts</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can now see what happens when we run the <code>resolveRuntimeClasspath</code> task, which resolves the <code>runtimeClasspath</code> configuration.
Gradle transforms the project dependency before the <code>resolveRuntimeClasspath</code> task starts.
Gradle transforms the binary dependencies when it executes the <code>resolveRuntimeClasspath</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle resolveRuntimeClasspath
&gt; Task :producer:compileJava
&gt; Task :producer:processResources NO-SOURCE
&gt; Task :producer:classes
&gt; Task :producer:jar

&gt; Transform producer.jar (project :producer) with Minify
Nothing to minify - using producer.jar unchanged

&gt; Task :resolveRuntimeClasspath
Minifying guava-27.1-jre.jar
Nothing to minify - using listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar unchanged
Nothing to minify - using jsr305-3.0.2.jar unchanged
Nothing to minify - using checker-qual-2.5.2.jar unchanged
Nothing to minify - using error_prone_annotations-2.2.0.jar unchanged
Nothing to minify - using j2objc-annotations-1.1.jar unchanged
Nothing to minify - using animal-sniffer-annotations-1.17.jar unchanged
Nothing to minify - using failureaccess-1.0.1.jar unchanged

BUILD SUCCESSFUL in 0s
3 actionable tasks: 3 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:implementing-artifact-transforms"><a class="anchor" href="#sec:implementing-artifact-transforms"></a><a class="link" href="#sec:implementing-artifact-transforms">Implementing Artifact Transforms</a></h4>
<div class="paragraph">
<p>Similar to task types, an artifact transform consists of an action and some optional parameters.
The major difference from custom task types is that the action and the parameters are implemented as two separate classes.</p>
</div>
<div class="sect4">
<h5 id="artifact_transforms_without_parameters"><a class="anchor" href="#artifact_transforms_without_parameters"></a><a class="link" href="#artifact_transforms_without_parameters">Artifact Transforms without Parameters</a></h5>
<div class="paragraph">
<p>An artifact transform action is provided by a class implementing <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.transform.TransformAction.html">TransformAction</a>.
Such a class implements the <code>transform()</code> method, which converts the input artifacts into zero, one, or multiple output artifacts.</p>
</div>
<div class="paragraph">
<p>Most Artifact Transforms are one-to-one, so the <code>transform</code> method will be used to transform each input artifact contained in the from variant into exactly one output artifact.</p>
</div>
<div class="paragraph">
<p>The implementation of the artifact transform action needs to register each output artifact by calling
<a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.transform.TransformOutputs.html#org.gradle.api.artifacts.transform.TransformOutputs:dir(java.lang.Object)">TransformOutputs.dir()</a> or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.transform.TransformOutputs.html#org.gradle.api.artifacts.transform.TransformOutputs:file(java.lang.Object)">TransformOutputs.file()</a>.</p>
</div>
<div class="paragraph">
<p>You can supply two types of paths to the <code>dir</code> or <code>file</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An absolute path to the input artifact or within the input artifact (for an input directory).</p>
</li>
<li>
<p>A relative path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle uses the absolute path as the location of the output artifact.
For example, if the input artifact is an exploded WAR, the transform action can call <code>TransformOutputs.file()</code> for all JAR files in the <code>WEB-INF/lib</code> directory.
The output of the transform would then be the library JARs of the web application.</p>
</div>
<div class="paragraph">
<p>For a relative path, the <code>dir()</code> or <code>file()</code> method returns a workspace to the transform action.
The transform action needs to create the transformed artifact(s) at the location of the provided workspace.</p>
</div>
<div class="paragraph">
<p>The output artifact(s) replace the input artifact(s) in the transformed variant in the order they were registered.
For example, if the selected input variant contains the artifacts <code>lib1.jar</code>, <code>lib2.jar</code>, <code>lib3.jar</code>, and the transform action registers a minified output artifact <code>&lt;artifact-name&gt;-min.jar</code> for each input artifact, then the transformed configuration will consist of the artifacts <code>lib1-min.jar</code>, <code>lib2-min.jar</code>, and <code>lib3-min.jar</code>.</p>
</div>
<div class="paragraph">
<p>Here is the implementation of an <code>Unzip</code> transform, which unzips a JAR file into a <code>classes</code> directory.
The <code>Unzip</code> transform does not require any parameters:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Unzip : TransformAction&lt;TransformParameters.None&gt; {          // <b class="conum">(1)</b>
    @get:InputArtifact                                                      // <b class="conum">(2)</b>
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val input = inputArtifact.get().asFile
        val unzipDir = outputs.dir(input.name + "-unzipped")                // <b class="conum">(3)</b>
        unzipTo(input, unzipDir)                                            // <b class="conum">(4)</b>
    }

    private fun unzipTo(zipFile: File, unzipDir: File) {
        // implementation...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Unzip implements TransformAction&lt;TransformParameters.None&gt; { // <b class="conum">(1)</b>
    @InputArtifact                                                          // <b class="conum">(2)</b>
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def input = inputArtifact.get().asFile
        def unzipDir = outputs.dir(input.name + "-unzipped")                // <b class="conum">(3)</b>
        unzipTo(input, unzipDir)                                            // <b class="conum">(4)</b>
    }

    private static void unzipTo(File zipFile, File unzipDir) {
        // implementation...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use <code>TransformParameters.None</code> if the transform does not use parameters</p>
</li>
<li>
<p>Inject the input artifact</p>
</li>
<li>
<p>Request an output location for the unzipped files</p>
</li>
<li>
<p>Do the actual work of the transform</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note how the implementation uses <code>@InputArtifact</code> to inject an artifact to transform into the action class, so that it can be accessed within the <code>transform</code> method.
This method requests a directory for the unzipped classes by using <code>TransformOutputs.dir()</code> and then unzips the JAR file into this directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="artifact_transforms_with_parameters"><a class="anchor" href="#artifact_transforms_with_parameters"></a><a class="link" href="#artifact_transforms_with_parameters">Artifact Transforms with Parameters</a></h5>
<div class="paragraph">
<p>An artifact transform may require parameters, such as a <code>String</code> for filtering or a file collection used to support the transformation of the input artifact.
To pass these parameters to the transform action, you must define a new type with the desired parameters.
This type must implement the marker interface <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/TransformParameters.html">TransformParameters</a>.</p>
</div>
<div class="paragraph">
<p>The parameters must be represented using <a href="#managed_properties">managed properties</a> and the parameter type must be a <a href="#managed_types">managed type</a>.
You can use an interface or abstract class to declare the getters, and Gradle will generate the implementation.
All getters need to have proper input annotations, as described in the <a href="incremental_build.html#table:incremental_build_annotations">incremental build annotations</a> table.</p>
</div>
<div class="paragraph">
<p>Here is the implementation of a <code>Minify</code> transform that makes JARs smaller by only keeping certain classes in them.
The <code>Minify</code> transform requires knowledge of the classes to keep within each JAR, which is provided as an <code>Map</code> property within its parameters:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class Minify : TransformAction&lt;Minify.Parameters&gt; {   // <b class="conum">(1)</b>
    interface Parameters : TransformParameters {               // <b class="conum">(2)</b>
        @get:Input
        var keepClassesByArtifact: Map&lt;String, Set&lt;String&gt;&gt;

    }

    @get:PathSensitive(PathSensitivity.NAME_ONLY)
    @get:InputArtifact
    abstract val inputArtifact: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val fileName = inputArtifact.get().asFile.name
        for (entry in parameters.keepClassesByArtifact) {      // <b class="conum">(3)</b>
            if (fileName.startsWith(entry.key)) {
                val nameWithoutExtension = fileName.substring(0, fileName.length - 4)
                minify(inputArtifact.get().asFile, entry.value, outputs.file("${nameWithoutExtension}-min.jar"))
                return
            }
        }
        println("Nothing to minify - using ${fileName} unchanged")
        outputs.file(inputArtifact)                            // <b class="conum">(4)</b>
    }

    private fun minify(artifact: File, keepClasses: Set&lt;String&gt;, jarFile: File) {
        println("Minifying ${artifact.name}")
        // Implementation ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class Minify implements TransformAction&lt;Parameters&gt; { // <b class="conum">(1)</b>
    interface Parameters extends TransformParameters {         // <b class="conum">(2)</b>
        @Input
        Map&lt;String, Set&lt;String&gt;&gt; getKeepClassesByArtifact()
        void setKeepClassesByArtifact(Map&lt;String, Set&lt;String&gt;&gt; keepClasses)
    }

    @PathSensitive(PathSensitivity.NAME_ONLY)
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInputArtifact()

    @Override
    void transform(TransformOutputs outputs) {
        def fileName = inputArtifact.get().asFile.name
        for (entry in parameters.keepClassesByArtifact) {      // <b class="conum">(3)</b>
            if (fileName.startsWith(entry.key)) {
                def nameWithoutExtension = fileName.substring(0, fileName.length() - 4)
                minify(inputArtifact.get().asFile, entry.value, outputs.file("${nameWithoutExtension}-min.jar"))
                return
            }
        }
        println "Nothing to minify - using ${fileName} unchanged"
        outputs.file(inputArtifact)                            // <b class="conum">(4)</b>
    }

    private void minify(File artifact, Set&lt;String&gt; keepClasses, File jarFile) {
        println "Minifying ${artifact.name}"
        // Implementation ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Declare the parameter type</p>
</li>
<li>
<p>Interface for the transform parameters</p>
</li>
<li>
<p>Use the parameters</p>
</li>
<li>
<p>Use the unchanged input artifact when no minification is required</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Observe how you can obtain the parameters by <code>TransformAction.getParameters()</code> in the <code>transform()</code> method.
The implementation of the <code>transform()</code> method requests a location for the minified JAR by using <code>TransformOutputs.file()</code> and then creates the minified JAR at this location.</p>
</div>
<div class="paragraph">
<p>Remember that the input artifact is a dependency, which may have its own dependencies.
Suppose your artifact transform needs access to those transitive dependencies.
In that case, it can declare an abstract getter returning a <code>FileCollection</code> and annotate it with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/InputArtifactDependencies.html">@InputArtifactDependencies</a>.
When your transform runs, Gradle will inject the transitive dependencies into the <code>FileCollection</code> property by implementing the getter.</p>
</div>
<div class="paragraph">
<p>Note that using input artifact dependencies in a transform has performance implications; only inject them when needed.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:caching-transforms"><a class="anchor" href="#sec:caching-transforms"></a><a class="link" href="#sec:caching-transforms">Artifact Transforms with Caching</a></h5>
<div class="paragraph">
<p>Artifact Transforms can make use of the <a href="#build_cache">build cache</a> to store their outputs and avoid rerunning their transform actions when the result is known.</p>
</div>
<div class="paragraph">
<p>To enable the build cache to store the results of an artifact transform, add the <code>@<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/CacheableTransform.html">CacheableTransform</a></code> annotation on the action class.</p>
</div>
<div class="paragraph">
<p>For cacheable transforms, you must annotate its <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/InputArtifact.html">@InputArtifact</a> property  and any property marked with <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/transform/InputArtifactDependencies.html">@InputArtifactDependencies</a>  with normalization annotations such as <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/PathSensitive.html">@PathSensitive</a>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates a more complex transform that relocates specific classes within a JAR to a different package.
This process involves rewriting the bytecode of both the relocated classes and any classes that reference them (class relocation):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@CacheableTransform                                                          // <b class="conum">(1)</b>
abstract class ClassRelocator : TransformAction&lt;ClassRelocator.Parameters&gt; {
    interface Parameters : TransformParameters {                             // <b class="conum">(2)</b>
        @get:CompileClasspath                                                // <b class="conum">(3)</b>
        val externalClasspath: ConfigurableFileCollection
        @get:Input
        val excludedPackage: Property&lt;String&gt;
    }

    @get:Classpath                                                           // <b class="conum">(4)</b>
    @get:InputArtifact
    abstract val primaryInput: Provider&lt;FileSystemLocation&gt;

    @get:CompileClasspath
    @get:InputArtifactDependencies                                           // <b class="conum">(5)</b>
    abstract val dependencies: FileCollection

    override
    fun transform(outputs: TransformOutputs) {
        val primaryInputFile = primaryInput.get().asFile
        if (parameters.externalClasspath.contains(primaryInputFile)) {       // <b class="conum">(6)</b>
            outputs.file(primaryInput)
        } else {
            val baseName = primaryInputFile.name.substring(0, primaryInputFile.name.length - 4)
            relocateJar(outputs.file("$baseName-relocated.jar"))
        }
    }

    private fun relocateJar(output: File) {
        // implementation...
        val relocatedPackages = (dependencies.flatMap { it.readPackages() } + primaryInput.get().asFile.readPackages()).toSet()
        val nonRelocatedPackages = parameters.externalClasspath.flatMap { it.readPackages() }
        val relocations = (relocatedPackages - nonRelocatedPackages).map { packageName -&gt;
            val toPackage = "relocated.$packageName"
            println("$packageName -&gt; $toPackage")
            Relocation(packageName, toPackage)
        }
        JarRelocator(primaryInput.get().asFile, output, relocations).run()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">@CacheableTransform                                                          // <b class="conum">(1)</b>
abstract class ClassRelocator implements TransformAction&lt;Parameters&gt; {
    interface Parameters extends TransformParameters {                       // <b class="conum">(2)</b>
        @CompileClasspath                                                    // <b class="conum">(3)</b>
        ConfigurableFileCollection getExternalClasspath()
        @Input
        Property&lt;String&gt; getExcludedPackage()
    }

    @Classpath                                                               // <b class="conum">(4)</b>
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getPrimaryInput()

    @CompileClasspath
    @InputArtifactDependencies                                               // <b class="conum">(5)</b>
    abstract FileCollection getDependencies()

    @Override
    void transform(TransformOutputs outputs) {
        def primaryInputFile = primaryInput.get().asFile
        if (parameters.externalClasspath.contains(primaryInput)) {           // <b class="conum">(6)</b>
            outputs.file(primaryInput)
        } else {
            def baseName = primaryInputFile.name.substring(0, primaryInputFile.name.length - 4)
            relocateJar(outputs.file("$baseName-relocated.jar"))
        }
    }

    private relocateJar(File output) {
        // implementation...
        def relocatedPackages = (dependencies.collectMany { readPackages(it) } + readPackages(primaryInput.get().asFile)) as Set
        def nonRelocatedPackages = parameters.externalClasspath.collectMany { readPackages(it) }
        def relocations = (relocatedPackages - nonRelocatedPackages).collect { packageName -&gt;
            def toPackage = "relocated.$packageName"
            println("$packageName -&gt; $toPackage")
            new Relocation(packageName, toPackage)
        }
        new JarRelocator(primaryInput.get().asFile, output, relocations).run()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Declare the transform cacheable</p>
</li>
<li>
<p>Interface for the transform parameters</p>
</li>
<li>
<p>Declare input type for each parameter</p>
</li>
<li>
<p>Declare a normalization for the input artifact</p>
</li>
<li>
<p>Inject the input artifact dependencies</p>
</li>
<li>
<p>Use the parameters</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note the classes to be relocated are determined by examining the packages of the input artifact and its dependencies.
Additionally, the transform ensures that packages contained in JAR files on an external classpath are not relocated.</p>
</div>
</div>
<div class="sect4">
<h5 id="incremental_artifact_transforms"><a class="anchor" href="#incremental_artifact_transforms"></a><a class="link" href="#incremental_artifact_transforms">Incremental Artifact Transforms</a></h5>
<div class="paragraph">
<p>Similar to <a href="#incremental_tasks">incremental tasks</a>, Artifact Transforms can avoid some work by only processing files that have changed since the last execution.
This is done by using the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html">InputChanges</a> interface.</p>
</div>
<div class="paragraph">
<p>For Artifact Transforms, only the input artifact is an incremental input; therefore, the transform can only query for changes there.
To use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html">InputChanges</a> in the transform action, inject it into the action.</p>
</div>
<div class="paragraph">
<p>For more information on how to use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.work.InputChanges.html">InputChanges</a>, see the corresponding documentation for <a href="#incremental_tasks">incremental tasks</a>.</p>
</div>
<div class="paragraph">
<p>Here is an example of an incremental transform that counts the lines of code in Java source files:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class CountLoc : TransformAction&lt;TransformParameters.None&gt; {

    @get:Inject                                                         // <b class="conum">(1)</b>
    abstract val inputChanges: InputChanges

    @get:PathSensitive(PathSensitivity.RELATIVE)
    @get:InputArtifact
    abstract val input: Provider&lt;FileSystemLocation&gt;

    override
    fun transform(outputs: TransformOutputs) {
        val outputDir = outputs.dir("${input.get().asFile.name}.loc")
        println("Running transform on ${input.get().asFile.name}, incremental: ${inputChanges.isIncremental}")
        inputChanges.getFileChanges(input).forEach { change -&gt;          // <b class="conum">(2)</b>
            val changedFile = change.file
            if (change.fileType != FileType.FILE) {
                return@forEach
            }
            val outputLocation = outputDir.resolve("${change.normalizedPath}.loc")
            when (change.changeType) {
                ChangeType.ADDED, ChangeType.MODIFIED -&gt; {

                    println("Processing file ${changedFile.name}")
                    outputLocation.parentFile.mkdirs()

                    outputLocation.writeText(changedFile.readLines().size.toString())
                }
                ChangeType.REMOVED -&gt; {
                    println("Removing leftover output file ${outputLocation.name}")
                    outputLocation.delete()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class CountLoc implements TransformAction&lt;TransformParameters.None&gt; {

    @Inject                                                             // <b class="conum">(1)</b>
    abstract InputChanges getInputChanges()

    @PathSensitive(PathSensitivity.RELATIVE)
    @InputArtifact
    abstract Provider&lt;FileSystemLocation&gt; getInput()

    @Override
    void transform(TransformOutputs outputs) {
        def outputDir = outputs.dir("${input.get().asFile.name}.loc")
        println("Running transform on ${input.get().asFile.name}, incremental: ${inputChanges.incremental}")
        inputChanges.getFileChanges(input).forEach { change -&gt;          // <b class="conum">(2)</b>
            def changedFile = change.file
            if (change.fileType != FileType.FILE) {
                return
            }
            def outputLocation = new File(outputDir, "${change.normalizedPath}.loc")
            switch (change.changeType) {
                case ADDED:
                case MODIFIED:
                    println("Processing file ${changedFile.name}")
                    outputLocation.parentFile.mkdirs()

                    outputLocation.text = changedFile.readLines().size()

                case REMOVED:
                    println("Removing leftover output file ${outputLocation.name}")
                    outputLocation.delete()

            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Inject <code>InputChanges</code></p>
</li>
<li>
<p>Query for changes in the input artifact</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This transform will only run on source files that have changed since the last run, as otherwise the line count would not need to be recalculated.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:registering-artifact-transforms"><a class="anchor" href="#sec:registering-artifact-transforms"></a><a class="link" href="#sec:registering-artifact-transforms">Registering Artifact Transforms</a></h4>
<div class="paragraph">
<p>You need to register the artifact transform actions, providing parameters if necessary so that they can be selected when resolving dependencies.</p>
</div>
<div class="paragraph">
<p>To register an artifact transform, you must use <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:registerTransform(java.lang.Class,%20org.gradle.api.Action)">registerTransform()</a> within the <code>dependencies {}</code> block.</p>
</div>
<div class="paragraph">
<p>There are a few points to consider when using <code>registerTransform()</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>At least one <code>from</code> and <code>to</code> attributes are required.</p>
</li>
<li>
<p>Each <code>to</code> attribute must have a corresponding <code>from</code> attribute.</p>
</li>
<li>
<p>Additional <code>from</code> attributes can be included which do <em>not</em> have corresponding <code>to</code> attributes.</p>
</li>
<li>
<p>The transform action itself can have configuration options. You can configure them with the <code>parameters {}</code> block.</p>
</li>
<li>
<p>You must register the transform on the project that has the configuration that will be resolved.</p>
</li>
<li>
<p>You can supply any type implementing <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.transform.TransformAction.html">TransformAction</a> to the <code>registerTransform()</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, imagine you want to unpack some dependencies and put the unpacked directories and files on the classpath.
You can do so by registering an artifact transform action of type <code>Unzip</code>, as shown here:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    registerTransform(Unzip::class.java) {
        from.attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named&lt;LibraryElements&gt;(LibraryElements.JAR))
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.JAR_TYPE)
        to.attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named&lt;LibraryElements&gt;(LibraryElements.CLASSES_AND_RESOURCES))
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.DIRECTORY_TYPE)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    registerTransform(Unzip) {
        from.attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, LibraryElements.JAR))
        from.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.JAR_TYPE)
        to.attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements, LibraryElements.CLASSES_AND_RESOURCES))
        to.attribute(ArtifactTypeDefinition.ARTIFACT_TYPE_ATTRIBUTE, ArtifactTypeDefinition.DIRECTORY_TYPE)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Another example is that you want to minify JARs by only keeping some <code>class</code> files from them.
Note the use of the <code>parameters {}</code> block to provide the classes to keep in the minified JARs to the <code>Minify</code> transform:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val artifactType = Attribute.of("artifactType", String::class.java)
val minified = Attribute.of("minified", Boolean::class.javaObjectType)
val keepPatterns = mapOf(
    "guava" to setOf(
        "com.google.common.base.Optional",
        "com.google.common.base.AbstractIterator"
    )
)


dependencies {
    registerTransform(Minify::class) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")

        parameters {
            keepClassesByArtifact = keepPatterns
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def artifactType = Attribute.of('artifactType', String)
def minified = Attribute.of('minified', Boolean)
def keepPatterns = [
    "guava": [
        "com.google.common.base.Optional",
        "com.google.common.base.AbstractIterator"
    ] as Set
]


dependencies {
    registerTransform(Minify) {
        from.attribute(minified, false).attribute(artifactType, "jar")
        to.attribute(minified, true).attribute(artifactType, "jar")

        parameters {
            keepClassesByArtifact = keepPatterns
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:executing-artifact-transforms"><a class="anchor" href="#sec:executing-artifact-transforms"></a><a class="link" href="#sec:executing-artifact-transforms">Executing Artifact Transforms</a></h4>
<div class="paragraph">
<p>On the command line, Gradle runs tasks; not Artifact Transforms: <code>./gradlew build.</code>
So how and when does it run transforms?</p>
</div>
<div class="paragraph">
<p>There are two ways Gradle executes a transform:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Artifact Transforms execution for <em>project dependencies</em> can be discovered ahead of task execution and therefore can be scheduled before the task execution.</p>
</li>
<li>
<p>Artifact Transforms execution for <em>external module dependencies</em> cannot be discovered ahead of task execution and, therefore are scheduled inside the task execution.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In well-declared builds, project dependencies can be fully discovered during task configuration ahead of task execution scheduling.
If the project dependency is badly declared (e.g., missing a task input), the transform execution will happen inside the task.</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to remember that Artifact Transforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>will only ever be run if no matching variants exist to satisfy a request</p>
</li>
<li>
<p>can be run in parallel</p>
</li>
<li>
<p>will not be rerun if possible (if multiple resolution requests require the same transform to be executed on the same artifacts, and the transform is cacheable, the transform will only be run once and the results fetched from the cache on each subsequent request)</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>`TransformAction`s are only instantiated and run if input artifacts exist.
If there are no artifacts present in an input variant to a transform, that transform will be skipped.
This can happen in the middle of a chain of actions, resulting in all subsequent transforms being skipped.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:debugging-artifact-transforms"><a class="anchor" href="#sec:debugging-artifact-transforms"></a><a class="link" href="#sec:debugging-artifact-transforms">Debugging Artifact Transforms</a></h4>
<div class="paragraph">
<p>You can use the <code>artifactTransforms</code> task to inspect the artifact transforms registered in your build.
This task makes it easier to debug unexpected transform behavior, understand which transforms are applied, and see how artifacts flow through your build.</p>
</div>
<div class="paragraph">
<p>To generate the report, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ./gradlew artifactTransforms</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will produce output listing all registered transforms, including details such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The input and output artifact types for each transform</p>
</li>
<li>
<p>Attributes required for the transform to apply</p>
</li>
<li>
<p>Implementation details of custom transforms</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This report is especially helpful if you encounter issues with artifact selection or resolution errors related to transforms.</p>
</div>
<div class="paragraph">
<p>Its important to note that the <code>artifactTransforms</code> task operates on a single project.
If you run it on a subproject, it will report the transforms registered only in that specific project.</p>
</div>
<div class="paragraph">
<p>For example, to view the artifact transforms in the <code>app</code> subproject, you would run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew :app:artifactTransforms

&gt; Task :app:artifactTransforms

--------------------------------------------------
CopyTransform
--------------------------------------------------
Type: dagger.hilt.android.plugin.transform.CopyTransform
Cacheable: No
From Attributes:
    - artifactType = android-classes
To Attributes:
    - artifactType = jar-for-dagger

--------------------------------------------------
CopyTransform
--------------------------------------------------
Type: dagger.hilt.android.plugin.transform.CopyTransform
Cacheable: No
From Attributes:
    - artifactType = directory
To Attributes:
    - artifactType = jar-for-dagger

--------------------------------------------------
AggregatedPackagesTransform
--------------------------------------------------
Type: dagger.hilt.android.plugin.transform.AggregatedPackagesTransform
Cacheable: Yes
From Attributes:
    - artifactType = jar-for-dagger
To Attributes:
    - artifactType = aggregated-jar-for-hilt

Some artifact transforms are not cacheable.  This can have negative performance impacts.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the task only inspects the current project, running it on the root project, where no transforms are registered, will produce empty output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ ./gradlew artifactTransforms

&gt; Task :artifactTransforms

There are no transforms registered in root project 'gradle'.</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="publishing_libraries"><a class="anchor" href="#publishing_libraries"></a><a class="link" href="#publishing_libraries">PUBLISHING LIBRARIES</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="publishing_components"><a class="anchor" href="#publishing_components"></a><a class="link" href="#publishing_components">Publishing a project as module</a></h3>
<div id="publishing_overview" class="paragraph">
<p>The vast majority of software projects build something that aims to be consumed in some way.
It could be a library that other software projects use or it could be an application for end users.
<em>Publishing</em> is the process by which the thing being built is made available to consumers.</p>
</div>
<div class="paragraph">
<p>In Gradle, that process looks like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define <a href="#publishing_overview:what">what</a> to publish</p>
</li>
<li>
<p>Define <a href="#publishing_overview:where">where</a> to publish it to</p>
</li>
<li>
<p><a href="#publishing_overview:how">Do</a> the publishing</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each of the these steps is dependent on the type of repository to which you want to publish artifacts.
The two most common types are Maven-compatible and Ivy-compatible repositories, or Maven and Ivy repositories for short.</p>
</div>
<div class="paragraph">
<p>As of Gradle 6.0, the <a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a> will always be published alongside the Ivy XML or Maven POM metadata file.</p>
</div>
<div class="paragraph">
<p>Gradle makes it easy to publish to these types of repository by providing some prepackaged infrastructure in the form of the <a href="#publishing_maven">Maven Publish Plugin</a> and the <a href="#publishing_ivy">Ivy Publish Plugin</a>.
These plugins allow you to configure what to publish and perform the publishing with a minimum of effort.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/publishing-process.png" alt="publishing process">
</div>
<div class="title">Figure 17. The publishing process</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at those steps in more detail:</p>
</div>
<div id="publishing_overview:what" class="dlist">
<dl>
<dt class="hdlist1">What to publish</dt>
<dd>
<p>Gradle needs to know what files and information to publish so that consumers can use your project.
This is typically a combination of <a href="glossary.html#sub:terminology_artifact">artifacts</a> and metadata that Gradle calls a <a href="glossary.html#sub:terminology_publication">publication</a>.
Exactly what a publication contains depends on the type of repository it&#8217;s being published to.</p>
<div class="paragraph">
<p>For example, a publication destined for a Maven repository includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One or more artifacts  typically built by the project,</p>
</li>
<li>
<p>The Gradle Module Metadata file which will describe the variants of the published component,</p>
</li>
<li>
<p>The Maven POM file will identify the primary artifact and its dependencies.
The primary artifact is typically the project&#8217;s production JAR and secondary artifacts might consist of "-sources" and "-javadoc" JARs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, Gradle will publish checksums for all of the above, and <a href="#publishing_maven:signing">signatures</a> when configured to do so.
From Gradle 6.0 onwards, this includes <code>SHA256</code> and <code>SHA512</code> checksums.</p>
</div>
</dd>
</dl>
</div>
<div id="publishing_overview:where" class="dlist">
<dl>
<dt class="hdlist1">Where to publish</dt>
<dd>
<p>Gradle needs to know where to publish artifacts so that consumers can get hold of them. This is done via <a href="glossary.html#sub:terminology_repository">repositories</a>, which store and make available all sorts of artifact.
Gradle also needs to interact with the repository, which is why you must provide the type of the repository and its location.</p>
</dd>
</dl>
</div>
<div id="publishing_overview:how" class="dlist">
<dl>
<dt class="hdlist1">How to publish</dt>
<dd>
<p>Gradle automatically generates publishing tasks for all possible combinations of publication and repository, allowing you to publish any artifact to any repository. If you&#8217;re publishing to a Maven repository, the tasks are of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a>, while for Ivy repositories the tasks are of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>What follows is a practical example that demonstrates the entire publishing process.</p>
</div>
<div class="sect3">
<h4 id="sec:basic_publishing"><a class="anchor" href="#sec:basic_publishing"></a><a class="link" href="#sec:basic_publishing">Setting up basic publishing</a></h4>
<div class="paragraph">
<p>The first step in publishing, irrespective of your project type, is to apply the appropriate publishing plugin. As mentioned in the introduction, Gradle supports both Maven and Ivy repositories via the following plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#publishing_maven">Maven Publish Plugin</a></p>
</li>
<li>
<p><a href="#publishing_ivy">Ivy Publish Plugin</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These provide the specific publication and repository classes needed to configure publishing for the corresponding repository type. Since Maven repositories are the most commonly used ones, they will be the basis for this example and for the other samples in the chapter. Don&#8217;t worry, we will explain how to adjust individual samples for Ivy repositories.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume we&#8217;re working with a simple Java library project, so only the following plugins are applied:</p>
</div>
<div id="ex-applying-the-necessary-plugins" class="exampleblock">
<div class="title">Example 24. <a href="#ex-applying-the-necessary-plugins">Applying the necessary plugins</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
    `maven-publish`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'maven-publish'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the appropriate plugin has been applied, you can configure the publications and repositories. For this example, we want to publish the project&#8217;s production JAR file the one produced by the <code>jar</code> task  to a custom Maven repository. We do that with the following <code>publishing {}</code> block, which is backed by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>:</p>
</div>
<div id="ex-configuring-a-java-library-for-publishing" class="exampleblock">
<div class="title">Example 25. <a href="#ex-configuring-a-java-library-for-publishing">Configuring a Java library for publishing</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">group = "org.example"
version = "1.0"

publishing {
    publications {
        create&lt;MavenPublication&gt;("myLibrary") {
            from(components["java"])
        }
    }

    repositories {
        maven {
            name = "myRepo"
            url = uri(layout.buildDirectory.dir("repo"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">group = 'org.example'
version = '1.0'

publishing {
    publications {
        myLibrary(MavenPublication) {
            from components.java
        }
    }

    repositories {
        maven {
            name = 'myRepo'
            url = layout.buildDirectory.dir("repo")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This defines a publication called "myLibrary" that can be published to a Maven repositoryby virtue of its type: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>.
This publication consists of just the production JAR artifact and its metadata, which combined are represented by the <code>java</code> <a href="glossary.html#sub:terminology_component">component</a> of the project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Components are the standard way of defining a publication. They are provided by plugins, usually of the language or platform variety. For example, the Java Plugin defines the <code>components.java</code> <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/component/SoftwareComponent.html">SoftwareComponent</a>, while the War Plugin defines <code>components.web</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example also defines a file-based Maven repository with the name "myRepo". Such a file-based repository is convenient for a sample, but real-world builds typically work with HTTPS-based repository servers, such as Maven Central or an internal company server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You may define one, and only one, repository without a name. This translates to an implicit name of "Maven" for Maven repositories and "Ivy" for Ivy repositories. All other repository definitions must be given an explicit name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In combination with the project&#8217;s <code>group</code> and <code>version</code>, the publication and repository definitions provide everything that Gradle needs to publish the project&#8217;s production JAR. Gradle will then create a dedicated <code>publishMyLibraryPublicationToMyRepoRepository</code> task that does just that. Its name is based on the template <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>. See the appropriate publishing plugin&#8217;s documentation for more details on the nature of this task and any other tasks that may be available to you.</p>
</div>
<div class="paragraph">
<p>You can either execute the individual publishing tasks directly, or you can execute <code>publish</code>, which will run all the available publishing tasks. In this example, <code>publish</code> will just run <code>publishMyLibraryPublicationToMavenRepository</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Basic publishing to an Ivy repository is very similar: you simply use the Ivy Publish Plugin, replace  <code>MavenPublication</code> with <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>, and use <code>ivy</code> instead of <code>maven</code> in the repository definition.</p>
</div>
<div class="paragraph">
<p>There are differences between the two types of repository, particularly around the extra metadata that each support for example, Maven repositories require a POM file while Ivy ones have their own metadata format  so see the plugin chapters for comprehensive information on how to configure both publications and repositories for whichever repository type you&#8217;re working with.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s everything for the basic use case. However, many projects need more control over what gets published, so we look at several common scenarios in the following sections.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:suppressing_validation_errors"><a class="anchor" href="#sec:suppressing_validation_errors"></a><a class="link" href="#sec:suppressing_validation_errors">Suppressing validation errors</a></h4>
<div class="paragraph">
<p>Gradle performs validation of generated module metadata.
In some cases, validation can fail, indicating that you most likely have an error to fix, but you may have done something intentionally.
If this is the case, Gradle will indicate the name of the validation error you can disable on the <code>GenerateModuleMetadata</code> tasks:</p>
</div>
<div id="ex-disabling-some-validation-errors" class="exampleblock">
<div class="title">Example 26. <a href="#ex-disabling-some-validation-errors">Disabling some validation errors</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;GenerateModuleMetadata&gt; {
    // The value 'enforced-platform' is provided in the validation
    // error message you got
    suppressedValidationErrors.add("enforced-platform")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(GenerateModuleMetadata).configureEach {
    // The value 'enforced-platform' is provided in the validation
    // error message you got
    suppressedValidationErrors.add('enforced-platform')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:understanding-gradle-module-md"><a class="anchor" href="#sec:understanding-gradle-module-md"></a><a class="link" href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a></h3>
<div class="paragraph">
<p>Gradle Module Metadata is a format used to serialize the Gradle component model.
It is similar to <a href="https://maven.apache.org/pom.html">Apache Maven's POM file</a> or <a href="https://ant.apache.org/ivy/">Apache Ivy ivy.xml</a> files.
The goal of metadata files is to provide <em>to consumers</em> a reasonable model of what is published on a repository.</p>
</div>
<div class="paragraph">
<p>Gradle Module Metadata is a unique format aimed at improving dependency resolution by making it multi-platform and variant-aware.</p>
</div>
<div class="paragraph">
<p>In particular, Gradle Module Metadata supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:rich-version-constraints">rich version constraints</a></p>
</li>
<li>
<p><a href="#sec:adding-constraints-transitive-deps">dependency constraints</a></p>
</li>
<li>
<p><a href="#sec:declaring-component-capabilities">component capabilities</a></p>
</li>
<li>
<p><a href="variant_aware_resolution.html#sec:understanding-variant-selection">variant-aware resolution</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Publication of Gradle Module Metadata will enable better dependency management for your consumers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>early discovery of problems by detecting <a href="#sec:declaring-component-capabilities">incompatible modules</a></p>
</li>
<li>
<p>consistent selection of <a href="#sec:jvm-default-attributes">platform-specific dependencies</a></p>
</li>
<li>
<p>native <a href="how_to_align_dependency_versions.html#sec:native_alignment">dependency version alignment</a></p>
</li>
<li>
<p>automatically getting dependencies for specific <a href="how_to_create_feature_variants_of_a_library.html#feature_variants">features of your library</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle Module Metadata is automatically published when using the <a href="#publishing_maven">Maven Publish plugin</a> or the <a href="#publishing_ivy">Ivy Publish plugin</a>.</p>
</div>
<div class="paragraph">
<p>The specification for Gradle Module Metadata can be found <a href="https://github.com/gradle/gradle/blob/master/platforms/documentation/docs/src/docs/design/gradle-module-metadata-latest-specification.md">here</a>.</p>
</div>
<div class="sect3">
<h4 id="sub:mapping-with-other-formats"><a class="anchor" href="#sub:mapping-with-other-formats"></a><a class="link" href="#sub:mapping-with-other-formats">Mapping with other formats</a></h4>
<div class="paragraph">
<p>Gradle Module Metadata is automatically published on Maven or Ivy repositories.
However, it doesn&#8217;t replace the <em>pom.xml</em> or <em>ivy.xml</em> files: it is published alongside those files.
This is done to maximize compatibility with third-party build tools.</p>
</div>
<div class="paragraph">
<p>Gradle does its best to map Gradle-specific concepts to Maven or Ivy.
When a build file uses features that can only be represented in Gradle Module Metadata, Gradle will warn you at publication time.
The table below summarizes how some Gradle specific features are mapped to Maven and Ivy:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Mapping of Gradle specific concepts to Maven and Ivy</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Gradle</th>
<th class="tableblock halign-left valign-top">Maven</th>
<th class="tableblock halign-left valign-top">Ivy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:adding-constraints-transitive-deps">dependency constraints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;dependencyManagement&gt;</code> dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gradle dependency constraints are <em>transitive</em>, while Maven&#8217;s dependency management block <em>isn&#8217;t</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:rich-version-constraints">rich version constraints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publishes the <em>requires</em> version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published the <em>requires</em> version</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:declaring-component-capabilities">component capabilities</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component capabilities are unique to Gradle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="how_to_create_feature_variants_of_a_library.html#feature_variants">Feature variants</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant artifacts are uploaded, dependencies are published as <em>optional</em> dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant artifacts are uploaded, dependencies are not published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feature variants are a good replacement for optional dependencies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sec:publishing-custom-components">Custom component types</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifacts are uploaded, dependencies are those described by the mapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifacts are uploaded, dependencies are ignored</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom component types are probably not consumable from Maven or Ivy in any case. They usually exist in the context of a custom ecosystem.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="disabling_metadata_compatibility_publication_warnings"><a class="anchor" href="#disabling_metadata_compatibility_publication_warnings"></a><a class="link" href="#disabling_metadata_compatibility_publication_warnings">Disabling metadata compatibility publication warnings</a></h5>
<div class="paragraph">
<p>If you want to suppress warnings, you can use the following APIs to do so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Maven, see the <code>suppress*</code> methods in <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:suppressAllPomMetadataWarnings()">MavenPublication</a></p>
</li>
<li>
<p>For Ivy, see the <code>suppress*</code> methods in <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:suppressAllIvyMetadataWarnings()">IvyPublication</a></p>
</li>
</ul>
</div>
<div id="ex-disabling-publication-warnings" class="exampleblock">
<div class="title">Example 27. <a href="#ex-disabling-publication-warnings">Disabling publication warnings</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publications {
    register&lt;MavenPublication&gt;("maven") {
        from(components["java"])
        suppressPomMetadataWarningsFor("runtimeElements")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publications {
    maven(MavenPublication) {
        from components.java
        suppressPomMetadataWarningsFor('runtimeElements')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:interactions-other-build-tools"><a class="anchor" href="#sub:interactions-other-build-tools"></a><a class="link" href="#sub:interactions-other-build-tools">Interactions with other build tools</a></h4>
<div class="paragraph">
<p>Because Gradle Module Metadata is not widely spread and because it aims at <a href="#sub:mapping-with-other-formats">maximizing compatibility with other tools</a>, Gradle does a couple of things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata is systematically published alongside the normal descriptor for a given repository (Maven or Ivy)</p>
</li>
<li>
<p>the <code>pom.xml</code> or <code>ivy.xml</code> file will contain a <em>marker comment</em> which tells Gradle that Gradle Module Metadata exists for this module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The goal of the marker is <em>not</em> for other tools to parse module metadata: it&#8217;s for Gradle users only.
It explains to Gradle that a <em>better</em> module metadata file exists and that it should use it instead.
It doesn&#8217;t mean that consumption from Maven or Ivy would be broken either, only that it works in <a href="#sub:mapping-with-other-formats">degraded mode</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This must be seen as a <em>performance optimization</em>: instead of having to do 2 network requests, one to get Gradle Module Metadata, then one to get the POM/Ivy file in case of a miss, Gradle will first look at the file which is most likely to be present, then only perform a 2nd request if the module was actually published with Gradle Module Metadata.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you know that the modules you depend on are always published with Gradle Module Metadata, you can optimize the network calls by configuring the metadata sources for a repository:</p>
</div>
<div id="ex-resolving-gradle-module-metadata-only" class="exampleblock">
<div class="title">Example 28. <a href="#ex-resolving-gradle-module-metadata-only">Resolving Gradle Module Metadata only</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven {
        url = uri("http://repo.mycompany.com/repo")
        metadataSources {
            gradleMetadata()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven {
        url = "http://repo.mycompany.com/repo"
        metadataSources {
            gradleMetadata()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:gmm-validation"><a class="anchor" href="#sub:gmm-validation"></a><a class="link" href="#sub:gmm-validation">Gradle Module Metadata validation</a></h4>
<div class="paragraph">
<p>Gradle Module Metadata is validated before being published.</p>
</div>
<div class="paragraph">
<p>The following rules are enforced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Variant names must be unique,</p>
</li>
<li>
<p>Each variant must have at least <a href="#variant-attributes">one attribute</a>,</p>
</li>
<li>
<p>Two variants cannot have the <a href="variant_aware_resolution.html#sec:understanding-variant-selection">exact same attributes and capabilities</a>,</p>
</li>
<li>
<p>If there are dependencies, at least one, across all variants, must carry <a href="#sec:rich-version-constraints">version information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These rules ensure the quality of the metadata produced, and help confirm that consumption will not be problematic.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:gmm-reproducible"><a class="anchor" href="#sub:gmm-reproducible"></a><a class="link" href="#sub:gmm-reproducible">Gradle Module Metadata reproducibility</a></h4>
<div class="paragraph">
<p>The task generating the module metadata files is currently never marked <code>UP-TO-DATE</code> by Gradle due to the way it is implemented.
However, if neither build inputs nor build scripts changed, the task result is effectively up-to-date: it always produces the same output.</p>
</div>
<div class="paragraph">
<p>If users desire to have a unique <code>module</code> file per build invocation, it is possible to link an identifier in the produced metadata to the build that created it.
Users can choose to enable this unique identifier in their <code>publication</code>:</p>
</div>
<div id="ex-configuring-the-build-identifier-of-a-publication" class="exampleblock">
<div class="title">Example 29. <a href="#ex-configuring-the-build-identifier-of-a-publication">Configuring the build identifier of a publication</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("myLibrary") {
            from(components["java"])
            withBuildIdentifier()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        myLibrary(MavenPublication) {
            from components.java
            withBuildIdentifier()
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With the changes above, the generated Gradle Module Metadata file will always be different, forcing downstream tasks to consider it out-of-date.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:disabling-gmm-publication"><a class="anchor" href="#sub:disabling-gmm-publication"></a><a class="link" href="#sub:disabling-gmm-publication">Disabling Gradle Module Metadata publication</a></h4>
<div class="paragraph">
<p>There are situations where you might want to disable publication of Gradle Module Metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the repository you are uploading to rejects the metadata file (unknown format)</p>
</li>
<li>
<p>you are using Maven or Ivy specific concepts which are not properly mapped to Gradle Module Metadata</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, disabling the publication of Gradle Module Metadata is done simply by disabling the task which generates the metadata file:</p>
</div>
<div id="ex-disabling-publication-of-gradle-module-metadata" class="exampleblock">
<div class="title">Example 30. <a href="#ex-disabling-publication-of-gradle-module-metadata">Disabling publication of Gradle Module Metadata</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;GenerateModuleMetadata&gt; {
    enabled = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(GenerateModuleMetadata) {
    enabled = false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_maven:signing"><a class="anchor" href="#publishing_maven:signing"></a><a class="link" href="#publishing_maven:signing">Signing artifacts</a></h3>
<div class="paragraph">
<p>The <a href="signing_plugin.html#signing_plugin">Signing Plugin</a> can be used to sign all artifacts and metadata files that make up a publication, including Maven POM files and Ivy module descriptors. In order to use it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply the Signing Plugin</p>
</li>
<li>
<p>Configure the <a href="signing_plugin.html#sec:signatory_credentials">signatory credentials</a>  follow the link to see how</p>
</li>
<li>
<p>Specify the publications you want signed</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here&#8217;s an example that configures the plugin to sign the <code>mavenJava</code> publication:</p>
</div>
<div id="ex-signing-a-publication" class="exampleblock">
<div class="title">Example 31. <a href="#ex-signing-a-publication">Signing a publication</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">signing {
    sign(publishing.publications["mavenJava"])
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">signing {
    sign publishing.publications.mavenJava
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will create a <code>Sign</code> task for each publication you specify and wire all <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks to depend on it. Thus, publishing any publication will automatically create and publish the signatures for its artifacts and metadata, as you can see from this output:</p>
</div>
<div class="sect3">
<h4 id="example_sign_and_publish_a_project"><a class="anchor" href="#example_sign_and_publish_a_project"></a><a class="link" href="#example_sign_and_publish_a_project">Example: Sign and publish a project</a></h4>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :javadoc
&gt; Task :javadocJar
&gt; Task :sourcesJar
&gt; Task :generateMetadataFileForMavenJavaPublication
&gt; Task :generatePomFileForMavenJavaPublication
&gt; Task :signMavenJavaPublication
&gt; Task :publishMavenJavaPublicationToMavenRepository
&gt; Task :publish

BUILD SUCCESSFUL in 0s
10 actionable tasks: 10 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing_publishing"><a class="anchor" href="#customizing_publishing"></a><a class="link" href="#customizing_publishing">Customizing publishing</a></h3>
<div class="sect3">
<h4 id="sec:adding-variants-to-existing-components"><a class="anchor" href="#sec:adding-variants-to-existing-components"></a><a class="link" href="#sec:adding-variants-to-existing-components">Modifying and adding variants to existing components for publishing</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s publication model is based on the notion of <em>components</em>, which are defined by plugins.
For example, the Java Library plugin defines a <code>java</code> component which corresponds to a library, but the Java Platform plugin defines another kind of component, named <code>javaPlatform</code>, which is effectively a different kind of software component (a <em>platform</em>).</p>
</div>
<div class="paragraph">
<p>Sometimes we want to add <em>more variants</em> to or modify <em>existing variants</em> of an existing component.
For example, if you <a href="variant_aware_resolution.html#sec:variant-aware-matching">added a variant of a Java library for a different platform</a>, you may just want to declare this additional variant on the <code>java</code> component itself.
In general, declaring additional variants is often the best solution to publish <em>additional artifacts</em>.</p>
</div>
<div class="paragraph">
<p>To perform such additions or modifications, the <code>AdhocComponentWithVariants</code> interface declares two methods called <code>addVariantsFromConfiguration</code> and <code>withVariantsFromConfiguration</code> which accept two parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#sec:resolvable-consumable-configs">outgoing configuration</a> that is used as a variant source</p>
</li>
<li>
<p>a customization action which allows you to <em>filter</em> which variants are going to be published</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To utilise these methods, you must make sure that the <code>SoftwareComponent</code> you work with is itself an <code>AdhocComponentWithVariants</code>, which is the case for the components created by the Java plugins (Java, Java Library, Java Platform).
Adding a variant is then very simple:</p>
</div>
<div id="ex-adding-a-variant-to-an-existing-software-component" class="exampleblock">
<div class="title">Example 32. <a href="#ex-adding-a-variant-to-an-existing-software-component">Adding a variant to an existing software component</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val javaComponent = components.findByName("java") as AdhocComponentWithVariants
javaComponent.addVariantsFromConfiguration(outgoing) {
    // dependencies for this variant are considered runtime dependencies
    mapToMavenScope("runtime")
    // and also optional dependencies, because we don't want them to leak
    mapToOptional()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">AdhocComponentWithVariants javaComponent = (AdhocComponentWithVariants) project.components.findByName("java")
javaComponent.addVariantsFromConfiguration(outgoing) {
    // dependencies for this variant are considered runtime dependencies
    it.mapToMavenScope("runtime")
    // and also optional dependencies, because we don't want them to leak
    it.mapToOptional()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In other cases, you might want to modify a variant that was added by one of the Java plugins already.
For example, if you activate publishing of Javadoc and sources, these become additional variants of the <code>java</code> component.
If you only want to publish one of them, e.g. only Javadoc but no sources, you can modify the <code>sources</code> variant to not being published:</p>
</div>
<div id="ex-publish-a-java-library-with-javadoc-but-without-sources" class="exampleblock">
<div class="title">Example 33. <a href="#ex-publish-a-java-library-with-javadoc-but-without-sources">Publish a java library with Javadoc but without sources</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    withJavadocJar()
    withSourcesJar()
}

val javaComponent = components["java"] as AdhocComponentWithVariants
javaComponent.withVariantsFromConfiguration(configurations["sourcesElements"]) {
    skip()
}

publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            from(components["java"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    withJavadocJar()
    withSourcesJar()
}

components.java.withVariantsFromConfiguration(configurations.sourcesElements) {
    skip()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing-custom-components"><a class="anchor" href="#sec:publishing-custom-components"></a><a class="link" href="#sec:publishing-custom-components">Creating and publishing custom components</a></h4>
<div class="paragraph">
<p>In the <a href="#sec:adding-variants-to-existing-components">previous example</a>, we have demonstrated how to extend or modify an existing component, like the components provided by the Java plugins.
But Gradle also allows you to build a custom component (not a Java Library, not a Java Platform, not something supported natively by Gradle).</p>
</div>
<div class="paragraph">
<p>To create a custom component, you first need to create an empty <em>adhoc</em> component.
At the moment, this is only possible via a plugin because you need to get a handle on the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/component/SoftwareComponentFactory.html">SoftwareComponentFactory</a> :</p>
</div>
<div id="ex-injecting-the-software-component-factory" class="exampleblock">
<div class="title">Example 34. <a href="#ex-injecting-the-software-component-factory">Injecting the software component factory</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class InstrumentedJarsPlugin @Inject constructor(
    private val softwareComponentFactory: SoftwareComponentFactory) : Plugin&lt;Project&gt; {</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">private final SoftwareComponentFactory softwareComponentFactory

@Inject
InstrumentedJarsPlugin(SoftwareComponentFactory softwareComponentFactory) {
    this.softwareComponentFactory = softwareComponentFactory
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Declaring <em>what</em> a custom component publishes is still done via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/component/AdhocComponentWithVariants.html">AdhocComponentWithVariants</a> API.
For a custom component, the first step is to create custom outgoing variants, following the instructions in <a href="variant_aware_resolution.html#sec:understanding-variant-selection">this chapter</a>.
At this stage, what you should have is variants which can be used in cross-project dependencies, but that we are now going to publish to external repositories.</p>
</div>
<div id="ex-creating-a-custom-adhoc-component" class="exampleblock">
<div class="title">Example 35. <a href="#ex-creating-a-custom-adhoc-component">Creating a custom, adhoc component</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.kt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// create an adhoc component
val adhocComponent = softwareComponentFactory.adhoc("myAdhocComponent")
// add it to the list of components that this project declares
components.add(adhocComponent)
// and register a variant for publication
adhocComponent.addVariantsFromConfiguration(outgoing) {
    mapToMavenScope("runtime")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">InstrumentedJarsPlugin.groovy</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// create an adhoc component
def adhocComponent = softwareComponentFactory.adhoc("myAdhocComponent")
// add it to the list of components that this project declares
project.components.add(adhocComponent)
// and register a variant for publication
adhocComponent.addVariantsFromConfiguration(outgoing) {
    it.mapToMavenScope("runtime")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>First we use the factory to create a new adhoc component.
Then we add a variant through the <code>addVariantsFromConfiguration</code> method, which is described in more detail in the <a href="#sec:adding-variants-to-existing-components">previous section</a>.</p>
</div>
<div class="paragraph">
<p>In simple cases, there&#8217;s a one-to-one mapping between a <code>Configuration</code> and a variant, in which case you can publish all variants issued from a single <code>Configuration</code> because they are effectively the same thing.
However, there are cases where a <code>Configuration</code> is associated with additional <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/ConfigurationPublications.html">configuration publications</a> that we also call <em>secondary variants</em>.
Such configurations make sense in a multi-project build, but not when publishing externally.
This is for example the case when between projects you share a <em>directory of files</em>, but there&#8217;s no way you can publish a <em>directory</em> directly on a Maven repository (only packaged things like jars or zips).
Look at the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/component/ConfigurationVariantDetails.html">ConfigurationVariantDetails</a> class for details about how to skip publication of a particular variant.
If <code>addVariantsFromConfiguration</code> has already been called for a configuration, further modification of the resulting variants can be performed using <code>withVariantsFromConfiguration</code>.</p>
</div>
<div class="paragraph">
<p>When publishing an adhoc component like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle Module Metadata will <em>exactly</em> represent the published variants. In particular, all outgoing variants will inherit dependencies, artifacts and attributes of the published configuration.</p>
</li>
<li>
<p>Maven and Ivy metadata files will be generated, but you need to declare how the dependencies are mapped to Maven scopes via the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/component/ConfigurationVariantDetails.html">ConfigurationVariantDetails</a> class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In practice, it means that components created this way can be consumed by Gradle the same way as if they were "local components".</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_custom_artifacts_to_maven"><a class="anchor" href="#sec:publishing_custom_artifacts_to_maven"></a><a class="link" href="#sec:publishing_custom_artifacts_to_maven">Adding custom artifacts to a publication</a></h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Instead of thinking in terms of artifacts, you should embrace the variant aware model of Gradle.
It is expected that a single module may need multiple artifacts.
However this rarely stops there, if the additional artifacts represent an <a href="how_to_create_feature_variants_of_a_library.html#feature_variants">optional feature</a>, they might also have different dependencies and more.</p>
</div>
<div class="paragraph">
<p>Gradle, via <em>Gradle Module Metadata</em>, supports the publication of <em>additional variants</em> which make those artifacts known to the dependency resolution engine.
Please refer to the <a href="variant_aware_resolution.html#sec:understanding-variant-selection">variant-aware sharing</a> section of the documentation to see how to declare such variants and <a href="#sec:publishing-custom-components">check out how to publish custom components</a>.</p>
</div>
<div class="paragraph">
<p>If you attach extra artifacts to a publication directly, they are published "out of context".
That means, they are not referenced in the metadata at all and can then only be addressed directly through a classifier on a dependency.
In contrast to Gradle Module Metadata, Maven pom metadata will not contain information on additional artifacts regardless of whether they are added through a variant or directly, as variants cannot be represented in the pom format.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The following section describes how you publish artifacts directly if you are sure that metadata, for example Gradle or POM metadata, is irrelevant for your use case.
For example, if your project doesn&#8217;t need to be consumed by other projects and the only thing required as result of the publishing are the artifacts themselves.</p>
</div>
<div class="paragraph">
<p>In general, there are two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a publication only with artifacts</p>
</li>
<li>
<p>Add artifacts to a publication based on a component with metadata (not recommended, instead <a href="#sec:adding-variants-to-existing-components">adjust a component</a> or use a <a href="#sec:publishing-custom-components">adhoc component publication</a> which will both also produce metadata fitting your artifacts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a publication based on artifacts, start by defining a custom artifact and attaching it to a Gradle <a href="glossary.html#sub:terminology_configuration">configuration</a> of your choice.
The following sample defines an RPM artifact that is produced by an <code>rpm</code> task (not shown) and attaches that artifact to the <code>conf</code> configuration:</p>
</div>
<div id="ex-defining-a-custom-artifact-for-a-configuration" class="exampleblock">
<div class="title">Example 36. <a href="#ex-defining-a-custom-artifact-for-a-configuration">Defining a custom artifact for a configuration</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    create("conf")
}
val rpmFile = layout.buildDirectory.file("rpms/my-package.rpm")
val rpmArtifact = artifacts.add("conf", rpmFile.get().asFile) {
    type = "rpm"
    builtBy("rpm")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    conf
}
def rpmFile = layout.buildDirectory.file('rpms/my-package.rpm')
def rpmArtifact = artifacts.add('conf', rpmFile.get().asFile) {
    type = 'rpm'
    builtBy 'rpm'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>artifacts.add()</code> method from <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.dsl.ArtifactHandler.html">ArtifactHandler</a>  returns an artifact object of type <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/artifacts/PublishArtifact.html">PublishArtifact</a> that can then be used in defining a publication, as shown in the following sample:</p>
</div>
<div id="ex-attaching-a-custom-publishartifact-to-a-publication" class="exampleblock">
<div class="title">Example 37. <a href="#ex-attaching-a-custom-publishartifact-to-a-publication">Attaching a custom PublishArtifact to a publication</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("maven") {
            artifact(rpmArtifact)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            artifact rpmArtifact
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>artifact()</code> method accepts <em>publish artifacts</em> as argument  like <code>rpmArtifact</code> in the sample  as well as any type of argument accepted by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a>, such as a <code>File</code> instance, a string file path or a archive task.</p>
</li>
<li>
<p>Publishing plugins support different artifact configuration properties, so always check the plugin documentation for more details. The <code>classifier</code> and <code>extension</code> properties are supported by both the <a href="#publishing_maven">Maven Publish Plugin</a> and the <a href="#publishing_ivy">Ivy Publish Plugin</a>.</p>
</li>
<li>
<p>Custom artifacts need to be distinct within a publication, typically via a unique combination of <code>classifier</code> and <code>extension</code>. See the documentation for the plugin you&#8217;re using for the precise requirements.</p>
</li>
<li>
<p>If you use <code>artifact()</code> with an archive task, Gradle automatically populates the artifact&#8217;s metadata with the <code>classifier</code> and <code>extension</code> properties from that task.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can publish the RPM.</p>
</div>
<div class="paragraph">
<p>If you really want to add an artifact to a publication based on a component, instead of <a href="#sec:adding-variants-to-existing-components">adjusting the component</a> itself, you can combine the <code>from components.someComponent</code> and <code>artifact someArtifact</code> notations.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_maven:conditional_publishing"><a class="anchor" href="#sec:publishing_maven:conditional_publishing"></a><a class="link" href="#sec:publishing_maven:conditional_publishing">Restricting publications to specific repositories</a></h4>
<div class="paragraph">
<p>When you have defined multiple publications or repositories, you often want to control which publications are published to which repositories. For instance, consider the following sample that defines two publications one that consists of just a binary and another that contains the binary and associated sources and two repositories  one for internal use and one for external consumers:</p>
</div>
<div id="ex-adding-multiple-publications-and-repositories" class="exampleblock">
<div class="title">Example 38. <a href="#ex-adding-multiple-publications-and-repositories">Adding multiple publications and repositories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("binary") {
            from(components["java"])
        }
        create&lt;MavenPublication&gt;("binaryAndSources") {
            from(components["java"])
            artifact(tasks["sourcesJar"])
        }
    }
    repositories {
        // change URLs to point to your repos, e.g. http://my.org/repo
        maven {
            name = "external"
            url = uri(layout.buildDirectory.dir("repos/external"))
        }
        maven {
            name = "internal"
            url = uri(layout.buildDirectory.dir("repos/internal"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        binary(MavenPublication) {
            from components.java
        }
        binaryAndSources(MavenPublication) {
            from components.java
            artifact sourcesJar
        }
    }
    repositories {
        // change URLs to point to your repos, e.g. http://my.org/repo
        maven {
            name = 'external'
            url = layout.buildDirectory.dir('repos/external')
        }
        maven {
            name = 'internal'
            url = layout.buildDirectory.dir('repos/internal')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The publishing plugins will create tasks that allow you to publish either of the publications to either repository. They also attach those tasks to the <code>publish</code> aggregate task. But let&#8217;s say you want to restrict the binary-only publication to the external repository and the binary-with-sources publication to the internal one. To do that, you need to make the publishing <em>conditional</em>.</p>
</div>
<div class="paragraph">
<p>Gradle allows you to skip any task you want based on a condition via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:onlyIf(java.lang.String,org.gradle.api.specs.Spec)">Task.onlyIf(String, org.gradle.api.specs.Spec)</a> method. The following sample demonstrates how to implement the constraints we just mentioned:</p>
</div>
<div id="ex-configuring-which-artifacts-should-be-published-to-which-repositories" class="exampleblock">
<div class="title">Example 39. <a href="#ex-configuring-which-artifacts-should-be-published-to-which-repositories">Configuring which artifacts should be published to which repositories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;PublishToMavenRepository&gt;().configureEach {
    val predicate = provider {
        (repository == publishing.repositories["external"] &amp;&amp;
            publication == publishing.publications["binary"]) ||
        (repository == publishing.repositories["internal"] &amp;&amp;
            publication == publishing.publications["binaryAndSources"])
    }
    onlyIf("publishing binary to the external repository, or binary and sources to the internal one") {
        predicate.get()
    }
}
tasks.withType&lt;PublishToMavenLocal&gt;().configureEach {
    val predicate = provider {
        publication == publishing.publications["binaryAndSources"]
    }
    onlyIf("publishing binary and sources") {
        predicate.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(PublishToMavenRepository) {
    def predicate = provider {
        (repository == publishing.repositories.external &amp;&amp;
            publication == publishing.publications.binary) ||
        (repository == publishing.repositories.internal &amp;&amp;
            publication == publishing.publications.binaryAndSources)
    }
    onlyIf("publishing binary to the external repository, or binary and sources to the internal one") {
        predicate.get()
    }
}
tasks.withType(PublishToMavenLocal) {
    def predicate = provider {
        publication == publishing.publications.binaryAndSources
    }
    onlyIf("publishing binary and sources") {
        predicate.get()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :generateMetadataFileForBinaryAndSourcesPublication
&gt; Task :generatePomFileForBinaryAndSourcesPublication
&gt; Task :sourcesJar
&gt; Task :publishBinaryAndSourcesPublicationToExternalRepository SKIPPED
&gt; Task :publishBinaryAndSourcesPublicationToInternalRepository
&gt; Task :generateMetadataFileForBinaryPublication
&gt; Task :generatePomFileForBinaryPublication
&gt; Task :publishBinaryPublicationToExternalRepository
&gt; Task :publishBinaryPublicationToInternalRepository SKIPPED
&gt; Task :publish

BUILD SUCCESSFUL in 0s
10 actionable tasks: 10 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You may also want to define your own aggregate tasks to help with your workflow. For example, imagine that you have several publications that should be published to the external repository. It could be very useful to publish all of them in one go without publishing the internal ones.</p>
</div>
<div class="paragraph">
<p>The following sample demonstrates how you can do this by defining an aggregate task <code>publishToExternalRepository</code> that depends on all the relevant publish tasks:</p>
</div>
<div id="ex-defining-your-own-shorthand-tasks-for-publishing" class="exampleblock">
<div class="title">Example 40. <a href="#ex-defining-your-own-shorthand-tasks-for-publishing">Defining your own shorthand tasks for publishing</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("publishToExternalRepository") {
    group = "publishing"
    description = "Publishes all Maven publications to the external Maven repository."
    dependsOn(tasks.withType&lt;PublishToMavenRepository&gt;().matching {
        it.repository == publishing.repositories["external"]
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('publishToExternalRepository') {
    group = 'publishing'
    description = 'Publishes all Maven publications to the external Maven repository.'
    dependsOn tasks.withType(PublishToMavenRepository).matching {
        it.repository == publishing.repositories.external
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This particular sample automatically handles the introduction or removal of the relevant publishing tasks by using <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> with the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a> task type. You can do the same with <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a> if you&#8217;re publishing to Ivy-compatible repositories.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_publishing_tasks"><a class="anchor" href="#sec:configuring_publishing_tasks"></a><a class="link" href="#sec:configuring_publishing_tasks">Configuring publishing tasks</a></h4>
<div class="paragraph">
<p>The publishing plugins create their non-aggregate tasks after the project has been evaluated, which means you cannot directly reference them from your build script. If you would like to configure any of these tasks, you should use deferred task configuration. This can be done in a number of ways via the project&#8217;s <code>tasks</code> collection.</p>
</div>
<div class="paragraph">
<p>For example, imagine you want to change where the <code>generatePomFileFor<em>PubName</em>Publication</code> tasks write their POM files. You can do this by using the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> method, as demonstrated by this sample:</p>
</div>
<div id="ex-configuring-a-dynamically-named-task-created-by-the-publishing-plugins" class="exampleblock">
<div class="title">Example 41. <a href="#ex-configuring-a-dynamically-named-task-created-by-the-publishing-plugins">Configuring a dynamically named task created by the publishing plugins</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;GenerateMavenPom&gt;().configureEach {
    val matcher = Regex("""generatePomFileFor(\w+)Publication""").matchEntire(name)
    val publicationName = matcher?.let { it.groupValues[1] }
    destination = layout.buildDirectory.file("poms/${publicationName}-pom.xml").get().asFile
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(GenerateMavenPom).all {
    def matcher = name =~ /generatePomFileFor(\w+)Publication/
    def publicationName = matcher[0][1]
    destination = layout.buildDirectory.file("poms/${publicationName}-pom.xml").get().asFile
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The above sample uses a regular expression to extract the name of the publication from the name of the task. This is so that there is no conflict between the file paths of all the POM files that might be generated. If you only have one publication, then you don&#8217;t have to worry about such conflicts since there will only be one POM file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_maven"><a class="anchor" href="#publishing_maven"></a><a class="link" href="#publishing_maven">The Maven Publish Plugin</a></h3>
<div class="paragraph">
<p>The Maven Publish Plugin provides the ability to publish build artifacts to an <a href="https://maven.apache.org/">Apache Maven</a> repository.
A module published to a Maven repository can be consumed by Maven, Gradle (see <a href="declaring_dependencies.html#one-declaring-dependencies">Declaring Dependencies</a>) and other tools that understand the Maven repository format.
You can learn about the fundamentals of publishing in <a href="#publishing_overview">Publishing Overview</a>.</p>
</div>
<div class="sect3">
<h4 id="publishing_maven:usage"><a class="anchor" href="#publishing_maven:usage"></a><a class="link" href="#publishing_maven:usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Maven Publish Plugin, include the following in your build script:</p>
</div>
<div id="ex-applying-the-maven-publish-plugin" class="exampleblock">
<div class="title">Example 42. <a href="#ex-applying-the-maven-publish-plugin">Applying the Maven Publish Plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `maven-publish`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'maven-publish'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Maven Publish Plugin uses an extension on the project named <code>publishing</code> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>. This extension provides a container of named publications and a container of named repositories. The Maven Publish Plugin works with <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a> publications and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a> repositories.</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:tasks"><a class="anchor" href="#publishing_maven:tasks"></a><a class="link" href="#publishing_maven:tasks">Tasks</a></h4>
<div id="publishing_maven:generate-pom" class="dlist">
<dl>
<dt class="hdlist1"><code>generatePomFileFor<em>PubName</em>Publication</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.tasks.GenerateMavenPom.html">GenerateMavenPom</a></dt>
<dd>
<p>Creates a POM file for the publication named <em>PubName</em>, populating the known metadata such as project name, project version, and the dependencies. The default location for the POM file is <em>build/publications/$pubName/pom-default.xml</em>.</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a></dt>
<dd>
<p>Publishes the <em>PubName</em> publication to the repository named <em>RepoName</em>. If you have a repository definition without an explicit name, <em>RepoName</em> will be "Maven".</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationToMavenLocal</code>  <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/publish/maven/tasks/PublishToMavenLocal.html">PublishToMavenLocal</a></dt>
<dd>
<p>Copies the <em>PubName</em> publication to the local Maven cache typically <em>&lt;home directory of the current user&gt;/.m2/repository</em> along with the publication&#8217;s POM file and other metadata.</p>
</dd>
<dt class="hdlist1"><code>publish</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks</p>
<div class="paragraph">
<p>An aggregate task that publishes all defined publications to all defined repositories. It does <em>not</em> include copying publications to the local Maven cache.</p>
</div>
</dd>
<dt class="hdlist1"><code>publishToMavenLocal</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationToMavenLocal</code> tasks</p>
<div class="paragraph">
<p>Copies all defined publications to the local Maven cache, including their metadata (POM files, etc.).</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:publications"><a class="anchor" href="#publishing_maven:publications"></a><a class="link" href="#publishing_maven:publications">Publications</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="glossary.html#sub:terminology_publication">publications</a> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>. To learn how to define and use publications, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>There are four main things you can configure in a Maven publication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="glossary.html#sub:terminology_component">component</a> via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:from(org.gradle.api.component.SoftwareComponent)">MavenPublication.from(org.gradle.api.component.SoftwareComponent)</a>.</p>
</li>
<li>
<p><a href="#sec:publishing_custom_artifacts_to_maven">Custom artifacts</a> via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:artifact(java.lang.Object)">MavenPublication.artifact(java.lang.Object)</a> method. See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenArtifact.html">MavenArtifact</a> for the available configuration options for custom Maven artifacts.</p>
</li>
<li>
<p>Standard metadata like <code>artifactId</code>, <code>groupId</code> and <code>version</code>.</p>
</li>
<li>
<p>Other contents of the POM file via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:pom(org.gradle.api.Action)">MavenPublication.pom(org.gradle.api.Action)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see all of these in action in the <a href="#publishing_maven:complete_example">complete publishing example</a>. The API documentation for <code>MavenPublication</code> has additional code samples.</p>
</div>
<div class="sect4">
<h5 id="sec:identity_values_in_the_generated_pom"><a class="anchor" href="#sec:identity_values_in_the_generated_pom"></a><a class="link" href="#sec:identity_values_in_the_generated_pom">Identity values in the generated POM</a></h5>
<div class="paragraph">
<p>The attributes of the generated POM file will contain identity values derived from the following project properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>groupId</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">Project.getGroup()</a></p>
</li>
<li>
<p><code>artifactId</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:name">Project.getName()</a></p>
</li>
<li>
<p><code>version</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:version">Project.getVersion()</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Overriding the default identity values is easy: simply specify the <code>groupId</code>, <code>artifactId</code> or <code>version</code> attributes when configuring the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>.</p>
</div>
<div id="ex-customizing-the-publication-identity" class="exampleblock">
<div class="title">Example 43. <a href="#ex-customizing-the-publication-identity">Customizing the publication identity</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("maven") {
            groupId = "org.gradle.sample"
            artifactId = "library"
            version = "1.1"

            from(components["java"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            groupId = 'org.gradle.sample'
            artifactId = 'library'
            version = '1.1'

            from components.java
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Certain repositories will not be able to handle all supported characters. For example, the <code>:</code> character cannot be used as an identifier when publishing to a filesystem-backed repository on Windows.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Maven restricts <code>groupId</code> and <code>artifactId</code> to a limited character set (<code>[A-Za-z0-9_\\-.]+</code>) and Gradle enforces this restriction. For <code>version</code> (as well as the artifact <code>extension</code> and <code>classifier</code> properties), Gradle will handle any valid Unicode character.</p>
</div>
<div class="paragraph">
<p>The only Unicode values that are explicitly prohibited are <code>\</code>, <code>/</code> and any ISO control character. Supplied values are validated early in publication.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:modifying_the_generated_pom"><a class="anchor" href="#sec:modifying_the_generated_pom"></a><a class="link" href="#sec:modifying_the_generated_pom">Customizing the generated POM</a></h5>
<div class="paragraph">
<p>The generated POM file can be customized before publishing. For example, when publishing a library to Maven Central you will need to set certain metadata. The Maven Publish Plugin provides a DSL for that purpose. Please see <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPom.html">MavenPom</a> in the DSL Reference for the complete documentation of available properties and methods. The following sample shows how to use the most common ones:</p>
</div>
<div id="ex-customizing-the-pom-file" class="exampleblock">
<div class="title">Example 44. <a href="#ex-customizing-the-pom-file">Customizing the POM file</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            pom {
                name = "My Library"
                description = "A concise description of my library"
                url = "http://www.example.com/library"
                properties = mapOf(
                    "myProp" to "value",
                    "prop.with.dots" to "anotherValue"
                )
                licenses {
                    license {
                        name = "The Apache License, Version 2.0"
                        url = "http://www.apache.org/licenses/LICENSE-2.0.txt"
                    }
                }
                developers {
                    developer {
                        id = "johnd"
                        name = "John Doe"
                        email = "john.doe@example.com"
                    }
                }
                scm {
                    connection = "scm:git:git://example.com/my-library.git"
                    developerConnection = "scm:git:ssh://example.com/my-library.git"
                    url = "http://example.com/my-library/"
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        mavenJava(MavenPublication) {
            pom {
                name = 'My Library'
                description = 'A concise description of my library'
                url = 'http://www.example.com/library'
                properties = [
                    myProp: "value",
                    "prop.with.dots": "anotherValue"
                ]
                licenses {
                    license {
                        name = 'The Apache License, Version 2.0'
                        url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
                    }
                }
                developers {
                    developer {
                        id = 'johnd'
                        name = 'John Doe'
                        email = 'john.doe@example.com'
                    }
                }
                scm {
                    connection = 'scm:git:git://example.com/my-library.git'
                    developerConnection = 'scm:git:ssh://example.com/my-library.git'
                    url = 'http://example.com/my-library/'
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="publishing_maven:resolved_dependencies"><a class="anchor" href="#publishing_maven:resolved_dependencies"></a><a class="link" href="#publishing_maven:resolved_dependencies">Customizing dependencies versions</a></h5>
<div class="paragraph">
<p>Two strategies are supported for publishing dependencies:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Declared versions (default)</dt>
<dd>
<p>This strategy publishes the versions that are defined by the build script author with the dependency declarations in the <code>dependencies</code> block.
Any other kind of processing, for example through <a href="#using-resolution-rules">a rule changing the resolved version</a>, will not be taken into account for the publication.</p>
</dd>
<dt class="hdlist1">Resolved versions</dt>
<dd>
<p>This strategy publishes the versions that were resolved during the build, possibly by applying resolution rules and automatic conflict resolution.
This has the advantage that the published versions correspond to the ones the published artifact was tested against.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Example use cases for resolved versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A project uses dynamic versions for dependencies but prefers exposing the resolved version for a given release to its consumers.</p>
</li>
<li>
<p>In combination with <a href="#locking-versions">dependency locking</a>, you want to publish the locked versions.</p>
</li>
<li>
<p>A project leverages the rich versions constraints of Gradle, which have a lossy conversion to Maven.
Instead of relying on the conversion, it publishes the resolved versions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is done by using the <code>versionMapping</code> DSL method which allows to configure the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/publish/VersionMappingStrategy.html">VersionMappingStrategy</a>:</p>
</div>
<div id="ex-using-resolved-versions" class="exampleblock">
<div class="title">Example 45. <a href="#ex-using-resolved-versions">Using resolved versions</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            versionMapping {
                usage("java-api") {
                    fromResolutionOf("runtimeClasspath")
                }
                usage("java-runtime") {
                    fromResolutionResult()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        mavenJava(MavenPublication) {
            versionMapping {
                usage('java-api') {
                    fromResolutionOf('runtimeClasspath')
                }
                usage('java-runtime') {
                    fromResolutionResult()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example above, Gradle will use the versions resolved on the <code>runtimeClasspath</code> for dependencies declared in <code>api</code>, which are mapped to the <code>compile</code> scope of Maven.
Gradle will also use the versions resolved on the <code>runtimeClasspath</code> for dependencies declared in <code>implementation</code>, which are mapped to the <code>runtime</code> scope of Maven.
<code>fromResolutionResult()</code> indicates that Gradle should use the default classpath of a variant and <code>runtimeClasspath</code> is the default classpath of <code>java-runtime</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:repositories"><a class="anchor" href="#publishing_maven:repositories"></a><a class="link" href="#publishing_maven:repositories">Repositories</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="glossary.html#sub:terminology_repository">repositories</a> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a>. To learn how to define and use repositories for publishing, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of defining a publishing repository:</p>
</div>
<div id="ex-declaring-repositories-to-publish-to" class="exampleblock">
<div class="title">Example 46. <a href="#ex-declaring-repositories-to-publish-to">Declaring repositories to publish to</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    repositories {
        maven {
            // change to point to your repo, e.g. http://my.org/repo
            url = uri(layout.buildDirectory.dir("repo"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    repositories {
        maven {
            // change to point to your repo, e.g. http://my.org/repo
            url = layout.buildDirectory.dir('repo')
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The two main things you will want to configure are the repository&#8217;s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL (required)</p>
</li>
<li>
<p>Name (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define multiple repositories as long as they have unique names within the build script. You may also declare one (and only one) repository without a name. That repository will take on an implicit name of "Maven".</p>
</div>
<div class="paragraph">
<p>You can also configure any authentication details that are required to connect to the repository. See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a> for more details.</p>
</div>
<div class="sect4">
<h5 id="supported_maven_repositories"><a class="anchor" href="#supported_maven_repositories"></a><a class="link" href="#supported_maven_repositories">Supported Repositories</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s <code>maven-publish</code> plugin is compatible with the <a href="https://maven.apache.org/plugins/maven-deploy-plugin/">Maven Deploy Plugin</a> and supports publishing to any repository that adheres to the same standards and protocols.
This includes a wide range of Maven-compatible repositories, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Local repositories</strong> (e.g. <code>~/.m2/repository</code>)</p>
</li>
<li>
<p><strong>Custom remote Maven repositories</strong></p>
</li>
<li>
<p><strong>Repository managers</strong> like <strong>Sonatype Nexus</strong> and <strong>JFrog Artifactory</strong></p>
</li>
<li>
<p><strong>GitHub Packages</strong></p>
</li>
<li>
<p><strong>Internal corporate Maven repositories</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="maven_central"><a class="anchor" href="#maven_central"></a><a class="link" href="#maven_central">Publishing to Maven Central</a></h5>
<div class="paragraph">
<p>The service commonly known as <strong>Maven Central</strong> and hosted at <a href="https://central.sonatype.com/">central.sonatype.com</a> is a widely used repository for distributing Java and Kotlin libraries.</p>
</div>
<div class="paragraph">
<p>As of <strong>June 30, 2025</strong>, <a href="https://cookbook.gradle.org/integrations/maven-central/publishing/#breaking-changes-in-maven-central-on-june-2025">Maven Central no longer supports the legacy deployment protocol</a> used by the <a href="https://maven.apache.org/plugins/maven-deploy-plugin/">Maven Deploy Plugin</a>.
This change also marks the deprecation of the OSSRH (OSS Repository Hosting) service.</p>
</div>
<div class="paragraph">
<p>Going forward, publishing to Maven Central <strong>requires a dedicated plugin</strong>.
Several options are available.
For guidance and recommendations, see the <a href="https://cookbook.gradle.org/integrations/maven-central/publishing/">Publishing to Maven Central</a> page in the Gradle Cookbook.</p>
</div>
</div>
<div class="sect4">
<h5 id="publishing_maven:snapshot_and_release_repositories"><a class="anchor" href="#publishing_maven:snapshot_and_release_repositories"></a><a class="link" href="#publishing_maven:snapshot_and_release_repositories">Snapshot and release repositories</a></h5>
<div class="paragraph">
<p>It is a common practice to publish snapshots and releases to different Maven repositories. A simple way to accomplish this is to configure the repository URL based on the project version. The following sample uses one URL for versions that end with "SNAPSHOT" and a different URL for the rest:</p>
</div>
<div id="ex-configuring-repository-url-based-on-project-version" class="exampleblock">
<div class="title">Example 47. <a href="#ex-configuring-repository-url-based-on-project-version">Configuring repository URL based on project version</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    repositories {
        maven {
            val releasesRepoUrl = layout.buildDirectory.dir("repos/releases")
            val snapshotsRepoUrl = layout.buildDirectory.dir("repos/snapshots")
            url = uri(if (version.toString().endsWith("SNAPSHOT")) snapshotsRepoUrl else releasesRepoUrl)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    repositories {
        maven {
            def releasesRepoUrl = layout.buildDirectory.dir('repos/releases')
            def snapshotsRepoUrl = layout.buildDirectory.dir('repos/snapshots')
            url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can use a <a href="#build_environment">project or system property</a> to decide which repository to publish to. The following example uses the release repository if the project property <code>release</code> is set, such as when a user runs <code>gradle -Prelease publish</code>:</p>
</div>
<div id="ex-configuring-repository-url-based-on-project-property" class="exampleblock">
<div class="title">Example 48. <a href="#ex-configuring-repository-url-based-on-project-property">Configuring repository URL based on project property</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    repositories {
        maven {
            val releasesRepoUrl = layout.buildDirectory.dir("repos/releases")
            val snapshotsRepoUrl = layout.buildDirectory.dir("repos/snapshots")
            url = uri(if (project.hasProperty("release")) releasesRepoUrl else snapshotsRepoUrl)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    repositories {
        maven {
            def releasesRepoUrl = layout.buildDirectory.dir('repos/releases')
            def snapshotsRepoUrl = layout.buildDirectory.dir('repos/snapshots')
            url = project.hasProperty('release') ? releasesRepoUrl : snapshotsRepoUrl
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:install"><a class="anchor" href="#publishing_maven:install"></a><a class="link" href="#publishing_maven:install">Publishing to Maven Local</a></h4>
<div class="paragraph">
<p>For integration with a local Maven installation, it is sometimes useful to publish the module into the Maven local repository (typically at <em>&lt;home directory of the current user&gt;/.m2/repository</em>), along with its POM file and other metadata. In Maven parlance, this is referred to as 'installing' the module.</p>
</div>
<div class="paragraph">
<p>The Maven Publish Plugin makes this easy to do by automatically creating a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/publish/maven/tasks/PublishToMavenLocal.html">PublishToMavenLocal</a> task for each <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a> in the <code>publishing.publications</code> container. The task name follows the pattern of <code>publish<em>PubName</em>PublicationToMavenLocal</code>. Each of these tasks is wired into the <code>publishToMavenLocal</code> aggregate task. You do not need to have <code>mavenLocal()</code> in your <code>publishing.repositories</code> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing_to_maven_central"><a class="anchor" href="#publishing_to_maven_central"></a><a class="link" href="#publishing_to_maven_central">Publishing to Maven Central</a></h4>
<p>
  <div style="position:relative;padding-top:56.25%;">
    <iframe src="https://www.youtube-nocookie.com/embed/nd2ULXyBaV8?si=yymYVoqGawuYx6Hh&rel=0" frameborder="0" allowfullscreen
      style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
  </div>
</p>
</div>
<div class="sect3">
<h4 id="publishing_maven:relocation"><a class="anchor" href="#publishing_maven:relocation"></a><a class="link" href="#publishing_maven:relocation">Publishing Maven relocation information</a></h4>
<div class="paragraph">
<p>When a project changes the <code>groupId</code> or <code>artifactId</code> (the <em>coordinates</em>) of an artifact it publishes, it is important to let users know where the new artifact can be found. Maven can help with that through the <em>relocation</em> feature. The way this works is that a project publishes an additional artifact under the old coordinates consisting only of a minimal <em>relocation POM</em>; that POM file specifies where the new artifact can be found. Maven repository browsers and build tools can then inform the user that the coordinates of an artifact have changed.</p>
</div>
<div class="paragraph">
<p>For this, a project adds an additional <code>MavenPublication</code> specifying a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.maven.MavenPomRelocation.html">MavenPomRelocation</a>:</p>
</div>
<div id="ex-specifying-a-relocation-pom" class="exampleblock">
<div class="title">Example 49. <a href="#ex-specifying-a-relocation-pom">Specifying a relocation POM</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        // ... artifact publications

        // Specify relocation POM
        create&lt;MavenPublication&gt;("relocation") {
            pom {
                // Old artifact coordinates
                groupId = "com.example"
                artifactId = "lib"
                version = "2.0.0"

                distributionManagement {
                    relocation {
                        // New artifact coordinates
                        groupId = "com.new-example"
                        artifactId = "lib"
                        version = "2.0.0"
                        message = "groupId has been changed"
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        // ... artifact publications

        // Specify relocation POM
        relocation(MavenPublication) {
            pom {
                // Old artifact coordinates
                groupId = "com.example"
                artifactId = "lib"
                version = "2.0.0"

                distributionManagement {
                    relocation {
                        // New artifact coordinates
                        groupId = "com.new-example"
                        artifactId = "lib"
                        version = "2.0.0"
                        message = "groupId has been changed"
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Only the property which has changed needs to be specified under <code>relocation</code>, that is <code>artifactId</code> and / or <code>groupId</code>. All other properties are optional.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Specifying the <code>version</code> can be useful when the new artifact has a different version, for example because version numbering has started at 1.0.0 again.</p>
</div>
<div class="paragraph">
<p>A custom <code>message</code> allows explaining why the artifact coordinates have changed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The relocation POM should be created for what would be the next version of the old artifact. For example when the artifact coordinates of <code>com.example:lib:1.0.0</code> are changed and the artifact with the new coordinates continues version numbering and is published as <code>com.new-example:lib:2.0.0</code>, then the relocation POM should specify a relocation from <code>com.example:lib:2.0.0</code> to <code>com.new-example:lib:2.0.0</code>.</p>
</div>
<div class="paragraph">
<p>A relocation POM only has to be published once, the build file configuration for it should be removed again once it has been published.</p>
</div>
<div class="paragraph">
<p>Note that a relocation POM is not suitable for all situations; when an artifact has been split into two or more separate artifacts then a relocation POM might not be helpful.</p>
</div>
<div class="sect4">
<h5 id="publishing_maven:retroactive_relocation"><a class="anchor" href="#publishing_maven:retroactive_relocation"></a><a class="link" href="#publishing_maven:retroactive_relocation">Retroactively publishing relocation information</a></h5>
<div class="paragraph">
<p>It is possible to publish relocation information retroactively after the coordinates of an artifact have changed in the past, and no relocation information was published back then.</p>
</div>
<div class="paragraph">
<p>The same recommendations as described above apply. To ease migration for users, it is important to pay attention to the <code>version</code> specified in the relocation POM. The relocation POM should allow the user to move to the new artifact in one step, and then allow them to update to the latest version in a separate step. For example when for the coordinates of <code>com.new-example:lib:5.0.0</code> were changed in version 2.0.0, then ideally the relocation POM should be published for the old coordinates <code>com.example:lib:2.0.0</code> relocating to <code>com.new-example:lib:2.0.0</code>. The user can then switch from <code>com.example:lib</code> to <code>com.new-example</code> and then separately update from version 2.0.0 to 5.0.0, handling breaking changes (if any) step by step.</p>
</div>
<div class="paragraph">
<p>When relocation information is published retroactively, it is not necessary to wait for next regular release of the project, it can be published in the meantime. As mentioned above, the relocation information should then be removed again from the build file once the relocation POM has been published.</p>
</div>
</div>
<div class="sect4">
<h5 id="publishing_maven:relocation_duplicate_dependencies"><a class="anchor" href="#publishing_maven:relocation_duplicate_dependencies"></a><a class="link" href="#publishing_maven:relocation_duplicate_dependencies">Avoiding duplicate dependencies</a></h5>
<div class="paragraph">
<p>When only the coordinates of the artifact have changed, but package names of the classes inside the artifact have remained the same, dependency conflicts can occur. A project might (transitively) depend on the old artifact but at the same time also have a dependency on the new artifact which both contain the same classes, potentially with incompatible changes.</p>
</div>
<div class="paragraph">
<p>To detect such conflicting duplicate dependencies, <a href="#sec:declaring-component-capabilities">capabilities</a> can be published as part of the <a href="#sec:understanding-gradle-module-md">Gradle Module Metadata</a>.  For an example using a <a href="#java_library_plugin">Java Library</a> project, see <a href="#sec:declaring-component-capabilities">declaring additional capabilities for a local component</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="publishing_maven:relocation_dry_run"><a class="anchor" href="#publishing_maven:relocation_dry_run"></a><a class="link" href="#publishing_maven:relocation_dry_run">Performing a dry run</a></h5>
<div class="paragraph">
<p>To verify that relocation information works as expected before publishing it to a remote repository, it can first be <a href="#publishing_maven:install">published to the local Maven repository</a>. Then a local test Gradle or Maven project can be created which has the relocation artifact as dependency.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:complete_example"><a class="anchor" href="#publishing_maven:complete_example"></a><a class="link" href="#publishing_maven:complete_example">Complete example</a></h4>
<div class="paragraph">
<p>The following example demonstrates how to sign and publish a Java library including sources, Javadoc, and a customized POM:</p>
</div>
<div id="ex-publishing-a-java-library" class="exampleblock">
<div class="title">Example 50. <a href="#ex-publishing-a-java-library">Publishing a Java library</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
    `maven-publish`
    signing
}

group = "com.example"
version = "1.0"

java {
    withJavadocJar()
    withSourcesJar()
}

publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            artifactId = "my-library"
            from(components["java"])
            versionMapping {
                usage("java-api") {
                    fromResolutionOf("runtimeClasspath")
                }
                usage("java-runtime") {
                    fromResolutionResult()
                }
            }
            pom {
                name = "My Library"
                description = "A concise description of my library"
                url = "http://www.example.com/library"
                properties = mapOf(
                    "myProp" to "value",
                    "prop.with.dots" to "anotherValue"
                )
                licenses {
                    license {
                        name = "The Apache License, Version 2.0"
                        url = "http://www.apache.org/licenses/LICENSE-2.0.txt"
                    }
                }
                developers {
                    developer {
                        id = "johnd"
                        name = "John Doe"
                        email = "john.doe@example.com"
                    }
                }
                scm {
                    connection = "scm:git:git://example.com/my-library.git"
                    developerConnection = "scm:git:ssh://example.com/my-library.git"
                    url = "http://example.com/my-library/"
                }
            }
        }
    }
    repositories {
        maven {
            // change URLs to point to your repos, e.g. http://my.org/repo
            val releasesRepoUrl = uri(layout.buildDirectory.dir("repos/releases"))
            val snapshotsRepoUrl = uri(layout.buildDirectory.dir("repos/snapshots"))
            url = if (version.toString().endsWith("SNAPSHOT")) snapshotsRepoUrl else releasesRepoUrl
        }
    }
}

signing {
    sign(publishing.publications["mavenJava"])
}

tasks.javadoc {
    if (JavaVersion.current().isJava9Compatible) {
        (options as StandardJavadocDocletOptions).addBooleanOption("html5", true)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'maven-publish'
    id 'signing'
}

group = 'com.example'
version = '1.0'

java {
    withJavadocJar()
    withSourcesJar()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            artifactId = 'my-library'
            from components.java
            versionMapping {
                usage('java-api') {
                    fromResolutionOf('runtimeClasspath')
                }
                usage('java-runtime') {
                    fromResolutionResult()
                }
            }
            pom {
                name = 'My Library'
                description = 'A concise description of my library'
                url = 'http://www.example.com/library'
                properties = [
                    myProp: "value",
                    "prop.with.dots": "anotherValue"
                ]
                licenses {
                    license {
                        name = 'The Apache License, Version 2.0'
                        url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
                    }
                }
                developers {
                    developer {
                        id = 'johnd'
                        name = 'John Doe'
                        email = 'john.doe@example.com'
                    }
                }
                scm {
                    connection = 'scm:git:git://example.com/my-library.git'
                    developerConnection = 'scm:git:ssh://example.com/my-library.git'
                    url = 'http://example.com/my-library/'
                }
            }
        }
    }
    repositories {
        maven {
            // change URLs to point to your repos, e.g. http://my.org/repo
            def releasesRepoUrl = layout.buildDirectory.dir('repos/releases')
            def snapshotsRepoUrl = layout.buildDirectory.dir('repos/snapshots')
            url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
        }
    }
}

signing {
    sign publishing.publications.mavenJava
}


javadoc {
    if(JavaVersion.current().isJava9Compatible()) {
        options.addBooleanOption('html5', true)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The result is that the following artifacts will be published:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The POM: <code>my-library-1.0.pom</code></p>
</li>
<li>
<p>The primary JAR artifact for the Java component: <code>my-library-1.0.jar</code></p>
</li>
<li>
<p>The sources JAR artifact that has been explicitly configured: <code>my-library-1.0-sources.jar</code></p>
</li>
<li>
<p>The Javadoc JAR artifact that has been explicitly configured: <code>my-library-1.0-javadoc.jar</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="signing_plugin.html#signing_plugin">Signing Plugin</a> is used to generate a signature file for each artifact. In addition, checksum files will be generated for all artifacts and signature files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
publishToMavenLocal` does not create checksum files in <code>$USER_HOME/.m2/repository</code>.
If you want to verify that the checksum files are created correctly, or use them for later publishing, consider configuring a <a href="#sec:maven-repo">custom Maven repository</a> with a <code>file://</code> URL and using that as the publishing target instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:deferred_configuration"><a class="anchor" href="#publishing_maven:deferred_configuration"></a><a class="link" href="#publishing_maven:deferred_configuration">Removal of deferred configuration behavior</a></h4>
<div class="paragraph">
<p>Prior to Gradle 5.0, the <code>publishing {}</code> block was (by default) implicitly treated as if all the logic inside it was executed after the project is evaluated.
This behavior caused quite a bit of confusion and was deprecated in Gradle 4.8, because it was the only block that behaved that way.</p>
</div>
<div class="paragraph">
<p>You may have some logic inside your publishing block or in a plugin that is depending on the deferred configuration behavior.
For instance, the following logic assumes that the subprojects will be evaluated when the artifactId is set:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">subprojects {
    publishing {
        publications {
            create&lt;MavenPublication&gt;("mavenJava") {
                from(components["java"])
                artifactId = tasks.jar.get().archiveBaseName.get()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">subprojects {
    publishing {
        publications {
            mavenJava(MavenPublication) {
                from components.java
                artifactId = jar.archiveBaseName
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This kind of logic must now be wrapped in an <code>afterEvaluate {}</code> block.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">subprojects {
    publishing {
        publications {
            create&lt;MavenPublication&gt;("mavenJava") {
                from(components["java"])
                afterEvaluate {
                    artifactId = tasks.jar.get().archiveBaseName.get()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">subprojects {
    publishing {
        publications {
            mavenJava(MavenPublication) {
                from components.java
                afterEvaluate {
                    artifactId = jar.archiveBaseName
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_ivy"><a class="anchor" href="#publishing_ivy"></a><a class="link" href="#publishing_ivy">The Ivy Publish Plugin</a></h3>
<div class="paragraph">
<p>The Ivy Publish Plugin provides the ability to publish build artifacts in the <a href="http://ant.apache.org/ivy/">Apache Ivy</a> format, usually to a repository for consumption by other builds or projects. What is published is one or more artifacts created by the build, and an Ivy <em>module descriptor</em> (normally <code>ivy.xml</code>) that describes the artifacts and the dependencies of the artifacts, if any.</p>
</div>
<div class="paragraph">
<p>A published Ivy module can be consumed by Gradle (see <a href="declaring_dependencies.html#one-declaring-dependencies">Declaring Dependencies</a>) and other tools that understand the Ivy format. You can learn about the fundamentals of publishing in <a href="#publishing_overview">Publishing Overview</a>.</p>
</div>
<div class="sect3">
<h4 id="publishing_ivy:usage"><a class="anchor" href="#publishing_ivy:usage"></a><a class="link" href="#publishing_ivy:usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Ivy Publish Plugin, include the following in your build script:</p>
</div>
<div id="ex-applying-the-ivy-publish-plugin" class="exampleblock">
<div class="title">Example 51. <a href="#ex-applying-the-ivy-publish-plugin">Applying the Ivy Publish Plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `ivy-publish`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'ivy-publish'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Ivy Publish Plugin uses an extension on the project named <code>publishing</code> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>. This extension provides a container of named publications and a container of named repositories. The Ivy Publish Plugin works with <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a> publications and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a> repositories.</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:tasks"><a class="anchor" href="#publishing_ivy:tasks"></a><a class="link" href="#publishing_ivy:tasks">Tasks</a></h4>
<div id="publishing_ivy:descriptor" class="dlist">
<dl>
<dt class="hdlist1"><code>generateDescriptorFileFor<em>PubName</em>Publication</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.tasks.GenerateIvyDescriptor.html">GenerateIvyDescriptor</a></dt>
<dd>
<p>Creates an Ivy descriptor file for the publication named <em>PubName</em>, populating the known metadata such as project name, project version, and the dependencies. The default location for the descriptor file is <em>build/publications/$pubName/ivy.xml</em>.</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a></dt>
<dd>
<p>Publishes the <em>PubName</em> publication to the repository named <em>RepoName</em>. If you have a repository definition without an explicit name, <em>RepoName</em> will be "Ivy".</p>
</dd>
<dt class="hdlist1"><code>publish</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks</p>
<div class="paragraph">
<p>An aggregate task that publishes all defined publications to all defined repositories.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:publications"><a class="anchor" href="#publishing_ivy:publications"></a><a class="link" href="#publishing_ivy:publications">Publications</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="glossary.html#sub:terminology_publication">publications</a> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>. To learn how to define and use publications, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>There are four main things you can configure in an Ivy publication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="glossary.html#sub:terminology_component">component</a> via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:from(org.gradle.api.component.SoftwareComponent)">IvyPublication.from(org.gradle.api.component.SoftwareComponent)</a>.</p>
</li>
<li>
<p><a href="#sec:publishing_custom_artifacts_to_maven">Custom artifacts</a> via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:artifact(java.lang.Object)">IvyPublication.artifact(java.lang.Object)</a> method. See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyArtifact.html">IvyArtifact</a> for the available configuration options for custom Ivy artifacts.</p>
</li>
<li>
<p>Standard metadata like <code>module</code>, <code>organisation</code> and <code>revision</code>.</p>
</li>
<li>
<p>Other contents of the module descriptor via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:descriptor(org.gradle.api.Action)">IvyPublication.descriptor(org.gradle.api.Action)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see all of these in action in the <a href="#publishing_ivy:example">complete publishing example</a>. The API documentation for <code>IvyPublication</code> has additional code samples.</p>
</div>
<div class="sect4">
<h5 id="sec:identity_values_for_the_published_project"><a class="anchor" href="#sec:identity_values_for_the_published_project"></a><a class="link" href="#sec:identity_values_for_the_published_project">Identity values for the published project</a></h5>
<div class="paragraph">
<p>The generated Ivy module descriptor file contains an <code>&lt;info&gt;</code> element that identifies the module. The default identity values are derived from the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>organisation</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">Project.getGroup()</a></p>
</li>
<li>
<p><code>module</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:name">Project.getName()</a></p>
</li>
<li>
<p><code>revision</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:version">Project.getVersion()</a></p>
</li>
<li>
<p><code>status</code> - <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:status">Project.getStatus()</a></p>
</li>
<li>
<p><code>branch</code> - (not set)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Overriding the default identity values is easy: simply specify the <code>organisation</code>, <code>module</code> or <code>revision</code> properties when configuring the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>. <code>status</code> and <code>branch</code> can be set via the <code>descriptor</code> property  see <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html">IvyModuleDescriptorSpec</a>.</p>
</div>
<div class="paragraph">
<p>The <code>descriptor</code> property can also be used to add additional custom elements as children of the <code>&lt;info&gt;</code> element, like so:</p>
</div>
<div id="ex-customizing-the-publication-identity" class="exampleblock">
<div class="title">Example 52. <a href="#ex-customizing-the-publication-identity">customizing the publication identity</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;IvyPublication&gt;("ivy") {
            organisation = "org.gradle.sample"
            module = "project1-sample"
            revision = "1.1"
            descriptor.status = "milestone"
            descriptor.branch = "testing"
            descriptor.extraInfo("http://my.namespace", "myElement", "Some value")

            from(components["java"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        ivy(IvyPublication) {
            organisation = 'org.gradle.sample'
            module = 'project1-sample'
            revision = '1.1'
            descriptor.status = 'milestone'
            descriptor.branch = 'testing'
            descriptor.extraInfo 'http://my.namespace', 'myElement', 'Some value'

            from components.java
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Certain repositories are not able to handle all supported characters. For example, the <code>:</code> character cannot be used as an identifier when publishing to a filesystem-backed repository on Windows.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle will handle any valid Unicode character for <code>organisation</code>, <code>module</code> and <code>revision</code> (as well as the artifact&#8217;s <code>name</code>, <code>extension</code> and <code>classifier</code>). The only values that are explicitly prohibited are <code>\</code>, <code>/</code> and any ISO control character. The supplied values are validated early during publication.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:modifying_the_generated_module_descriptor"><a class="anchor" href="#sec:modifying_the_generated_module_descriptor"></a><a class="link" href="#sec:modifying_the_generated_module_descriptor">Customizing the generated module descriptor</a></h5>
<div class="paragraph">
<p>At times, the module descriptor file generated from the project information will need to be tweaked before publishing. The Ivy Publish Plugin provides a DSL for that purpose. Please see <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html">IvyModuleDescriptorSpec</a> in the DSL Reference for the complete documentation of available properties and methods.</p>
</div>
<div class="paragraph">
<p>The following sample shows how to use the most common aspects of the DSL:</p>
</div>
<div id="ex-customizing-the-module-descriptor-file" class="exampleblock">
<div class="title">Example 53. <a href="#ex-customizing-the-module-descriptor-file">Customizing the module descriptor file</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publications {
    create&lt;IvyPublication&gt;("ivyCustom") {
        descriptor {
            license {
                name = "The Apache License, Version 2.0"
                url = "http://www.apache.org/licenses/LICENSE-2.0.txt"
            }
            author {
                name = "Jane Doe"
                url = "http://example.com/users/jane"
            }
            description {
                text = "A concise description of my library"
                homepage = "http://www.example.com/library"
            }
        }
        versionMapping {
            usage("java-api") {
                fromResolutionOf("runtimeClasspath")
            }
            usage("java-runtime") {
                fromResolutionResult()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publications {
    ivyCustom(IvyPublication) {
        descriptor {
            license {
                name = 'The Apache License, Version 2.0'
                url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
            }
            author {
                name = 'Jane Doe'
                url = 'http://example.com/users/jane'
            }
            description {
                text = 'A concise description of my library'
                homepage = 'http://www.example.com/library'
            }
        }
        versionMapping {
            usage('java-api') {
                fromResolutionOf('runtimeClasspath')
            }
            usage('java-runtime') {
                fromResolutionResult()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example we are simply adding a 'description' element to the generated Ivy dependency descriptor, but this hook allows you to modify any aspect of the generated descriptor. For example, you could replace the version range for a dependency with the actual version used to produce the build.</p>
</div>
<div class="paragraph">
<p>You can also add arbitrary XML to the descriptor file via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html#org.gradle.api.publish.ivy.IvyModuleDescriptorSpec:withXml(org.gradle.api.Action)">IvyModuleDescriptorSpec.withXml(org.gradle.api.Action)</a>, but you cannot use it to modify any part of the module identifier (organisation, module, revision).</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
It is possible to modify the descriptor in such a way that it is no longer a valid Ivy module descriptor, so care must be taken when using this feature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="publishing_ivy:resolved_dependencies"><a class="anchor" href="#publishing_ivy:resolved_dependencies"></a><a class="link" href="#publishing_ivy:resolved_dependencies">Customizing dependencies versions</a></h5>
<div class="paragraph">
<p>Two strategies are supported for publishing dependencies:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Declared versions (default)</dt>
<dd>
<p>This strategy publishes the versions that are defined by the build script author with the dependency declarations in the <code>dependencies</code> block.
Any other kind of processing, for example through <a href="#using-resolution-rules">a rule changing the resolved version</a>, will not be taken into account for the publication.</p>
</dd>
<dt class="hdlist1">Resolved versions</dt>
<dd>
<p>This strategy publishes the versions that were resolved during the build, possibly by applying resolution rules and automatic conflict resolution.
This has the advantage that the published versions correspond to the ones the published artifact was tested against.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Example use cases for resolved versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A project uses dynamic versions for dependencies but prefers exposing the resolved version for a given release to its consumers.</p>
</li>
<li>
<p>In combination with <a href="#locking-versions">dependency locking</a>, you want to publish the locked versions.</p>
</li>
<li>
<p>A project leverages the rich versions constraints of Gradle, which have a lossy conversion to Ivy.
Instead of relying on the conversion, it publishes the resolved versions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is done by using the <code>versionMapping</code> DSL method which allows to configure the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/publish/VersionMappingStrategy.html">VersionMappingStrategy</a>:</p>
</div>
<div id="ex-using-resolved-versions" class="exampleblock">
<div class="title">Example 54. <a href="#ex-using-resolved-versions">Using resolved versions</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publications {
    create&lt;IvyPublication&gt;("ivyCustom") {
        versionMapping {
            usage("java-api") {
                fromResolutionOf("runtimeClasspath")
            }
            usage("java-runtime") {
                fromResolutionResult()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publications {
    ivyCustom(IvyPublication) {
        versionMapping {
            usage('java-api') {
                fromResolutionOf('runtimeClasspath')
            }
            usage('java-runtime') {
                fromResolutionResult()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the example above, Gradle will use the versions resolved on the <code>runtimeClasspath</code> for dependencies declared in <code>api</code>, which are mapped to the <code>compile</code> configuration of Ivy.
Gradle will also use the versions resolved on the <code>runtimeClasspath</code> for dependencies declared in <code>implementation</code>, which are mapped to the <code>runtime</code> configuration of Ivy.
<code>fromResolutionResult()</code> indicates that Gradle should use the default classpath of a variant and <code>runtimeClasspath</code> is the default classpath of <code>java-runtime</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:repositories"><a class="anchor" href="#publishing_ivy:repositories"></a><a class="link" href="#publishing_ivy:repositories">Repositories</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="glossary.html#sub:terminology_repository">repositories</a> of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a>. To learn how to define and use repositories for publishing, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of defining a publishing repository:</p>
</div>
<div id="ex-declaring-repositories-to-publish-to" class="exampleblock">
<div class="title">Example 55. <a href="#ex-declaring-repositories-to-publish-to">Declaring repositories to publish to</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    repositories {
        ivy {
            // change to point to your repo, e.g. http://my.org/repo
            url = uri(layout.buildDirectory.dir("repo"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    repositories {
        ivy {
            // change to point to your repo, e.g. http://my.org/repo
            url = layout.buildDirectory.dir("repo")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The two main things you will want to configure are the repository&#8217;s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL (required)</p>
</li>
<li>
<p>Name (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define multiple repositories as long as they have unique names within the build script. You may also declare one (and only one) repository without a name. That repository will take on an implicit name of "Ivy".</p>
</div>
<div class="paragraph">
<p>You can also configure any authentication details that are required to connect to the repository. See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a> for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:example"><a class="anchor" href="#publishing_ivy:example"></a><a class="link" href="#publishing_ivy:example">Complete example</a></h4>
<div class="paragraph">
<p>The following example demonstrates publishing with a multi-project build.
Each project publishes a Java component configured to also build and publish Javadoc and source code artifacts.
The descriptor file is customized to include the project description for each project.</p>
</div>
<div id="ex-publishing-a-java-module" class="exampleblock">
<div class="title">Example 56. <a href="#ex-publishing-a-java-module">Publishing a Java module</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">rootProject.name = "ivy-publish-java"
include("project1", "project2")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `kotlin-dsl`
}

repositories {
    gradlePluginPortal()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/myproject.publishing-conventions.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java-library")
    id("ivy-publish")
}

version = "1.0"
group = "org.gradle.sample"

repositories {
    mavenCentral()
}

java {
    withJavadocJar()
    withSourcesJar()
}

publishing {
    repositories {
        ivy {
            // change to point to your repo, e.g. http://my.org/repo
            url = uri(rootProject.layout.buildDirectory.dir("repo"))
        }
    }
    publications {
        create&lt;IvyPublication&gt;("ivy") {
            from(components["java"])
            descriptor.description {
                text = providers.provider({ description })
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">project1/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("myproject.publishing-conventions")
}

description = "The first project"

dependencies {
    implementation("junit:junit:4.13")
    implementation(project(":project2"))
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">project2/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("myproject.publishing-conventions")
}

description = "The second project"

dependencies {
    implementation("commons-collections:commons-collections:3.2.2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rootProject.name = 'ivy-publish-java'
include 'project1', 'project2'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy-gradle-plugin'
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/myproject.publishing-conventions.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
    id 'ivy-publish'
}

version = '1.0'
group = 'org.gradle.sample'

repositories {
    mavenCentral()
}

java {
    withJavadocJar()
    withSourcesJar()
}

publishing {
    repositories {
        ivy {
            // change to point to your repo, e.g. http://my.org/repo
            url = rootProject.layout.buildDirectory.dir('repo')
        }
    }
    publications {
        ivy(IvyPublication) {
            from components.java
            descriptor.description {
                text = providers.provider({ description })
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">project1/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'myproject.publishing-conventions'
}

description = 'The first project'

dependencies {
    implementation 'junit:junit:4.13'
    implementation project(':project2')
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">project2/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'myproject.publishing-conventions'
}

description = 'The second project'

dependencies {
    implementation 'commons-collections:commons-collections:3.2.2'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The result is that the following artifacts will be published for each project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Gradle Module Metadata file: <code>project1-1.0.module</code>.</p>
</li>
<li>
<p>The Ivy module metadata file: <code>ivy-1.0.xml</code>.</p>
</li>
<li>
<p>The primary JAR artifact for the Java component: <code>project1-1.0.jar</code>.</p>
</li>
<li>
<p>The Javadoc and sources JAR artifacts of the Java component (because we configured <code>withJavadocJar()</code> and <code>withSourcesJar()</code>): <code>project1-1.0-javadoc.jar</code>, <code>project1-1.0-source.jar</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:jvm_projects"><a class="anchor" href="#part:jvm_projects"></a><a class="link" href="#part:jvm_projects">JVM BUILDS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="building_java_projects"><a class="anchor" href="#building_java_projects"></a><a class="link" href="#building_java_projects">Building Java &amp; JVM projects</a></h3>
<div class="paragraph">
<p>Gradle uses a convention-over-configuration approach to building JVM-based projects that borrows several conventions from Apache Maven. In particular, it uses the same default directory structure for source files and resources, and it works with Maven-compatible repositories.</p>
</div>
<div class="paragraph">
<p>We will look at Java projects in detail in this chapter, but most of the topics apply to other supported JVM languages as well, such as <a href="https://kotlinlang.org/docs/reference/using-gradle.html#targeting-the-jvm">Kotlin</a>, <a href="#groovy_plugin">Groovy</a> and <a href="#scala_plugin">Scala</a>.
If you don&#8217;t have much experience with building JVM-based projects with Gradle, take a look at the <a href="../samples/index.html#java">Java samples</a> for step-by-step instructions on how to build various types of basic Java projects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The example in this section use the Java Library Plugin.
However the described features are shared by all JVM plugins.
Specifics of the different plugins are available in their dedicated documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
There are a number of hands-on samples that you can explore for <a href="../samples/index.html#java">Java</a>, <a href="../samples/index.html#groovy">Groovy</a>, <a href="../samples/index.html#scala">Scala</a> and <a href="../samples/index.html#kotlin">Kotlin</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="introduction_2"><a class="anchor" href="#introduction_2"></a><a class="link" href="#introduction_2">Introduction</a></h4>
<div class="paragraph">
<p>The simplest build script for a Java project applies the <a href="#java_library_plugin">Java Library Plugin</a> and optionally sets the project version and selects the <a href="#toolchains">Java toolchain</a> to use:</p>
</div>
<div id="ex-applying-the-java-library-plugin" class="exampleblock">
<div class="title">Example 57. <a href="#ex-applying-the-java-library-plugin">Applying the Java Library Plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

version = "1.2.1"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

version = '1.2.1'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By applying the Java Library Plugin, you get a whole host of features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>compileJava</code> task that compiles all the Java source files under <em>src/main/java</em></p>
</li>
<li>
<p>A <code>compileTestJava</code> task for source files under <em>src/test/java</em></p>
</li>
<li>
<p>A <code>test</code> task that runs the tests from <em>src/test/java</em></p>
</li>
<li>
<p>A <code>jar</code> task that packages the <code>main</code> compiled classes and resources from <em>src/main/resources</em> into a single JAR named <em>&lt;project&gt;-&lt;version&gt;.jar</em></p>
</li>
<li>
<p>A <code>javadoc</code> task that generates Javadoc for the <code>main</code> classes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This isn&#8217;t sufficient to build any non-trivial Java project  at the very least, you&#8217;ll probably have some file dependencies. But it means that your build script only needs the information that is specific to <em>your</em> project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Although the properties in the example are optional, we recommend that you specify them in your projects.
Configuring the toolchain protects against problems with the project being built with different Java versions.
The version string is important for tracking the progression of the project.
The project version is also used in archive names by default.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Java Library Plugin also integrates the above tasks into the standard <a href="base_plugin.html#sec:base_tasks">Base Plugin lifecycle tasks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jar</code> is attached to <code>assemble</code></p>
</li>
<li>
<p><code>test</code> is attached to <code>check</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rest of the chapter explains the different avenues for customizing the build to your requirements. You will also see later how to adjust the build for libraries, applications, web apps and enterprise apps.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_source_sets"><a class="anchor" href="#sec:java_source_sets"></a><a class="link" href="#sec:java_source_sets">Declaring your source files via source sets</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s Java support was the first to introduce a new concept for building source-based projects: <em>source sets</em>. The main idea is that source files and resources are often logically grouped by type, such as application code, unit tests and integration tests. Each logical group typically has its own sets of file dependencies, classpaths, and more. Significantly, the files that form a source set <em>don&#8217;t have to be located in the same directory</em>!</p>
</div>
<div class="paragraph">
<p>Source sets are a powerful concept that tie together several aspects of compilation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the source files and where they&#8217;re located</p>
</li>
<li>
<p>the compilation classpath, including any required dependencies (via Gradle <a href="glossary.html#sub:terminology_configuration">configurations</a>)</p>
</li>
<li>
<p>where the compiled class files are placed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see how these relate to one another in this diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-sourcesets-compilation.png" alt="java sourcesets compilation">
</div>
<div class="title">Figure 18. Source sets and Java compilation</div>
</div>
<div class="paragraph">
<p>The shaded boxes represent properties of the source set itself.
On top of that, the Java Library Plugin automatically creates a compilation task for every source set you or a plugin defines  named <code>compile<em>SourceSet</em>Java</code>  and several <a href="java_plugin.html#java_source_set_configurations">dependency configurations</a>.</p>
</div>
<div class="openblock">
<div class="title">The <code>main</code> source set</div>
<div class="content">
<div class="paragraph">
<p>Most language plugins, Java included, automatically create a source set called <code>main</code>, which is used for the project&#8217;s production code. This source set is special in that its name is not included in the names of the configurations and tasks, hence why you have just a <code>compileJava</code> task and <code>compileOnly</code> and <code>implementation</code> configurations rather than <code>compileMainJava</code>, <code>mainCompileOnly</code> and <code>mainImplementation</code> respectively.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Java projects typically include resources other than source files, such as properties files, that may need processing  for example by replacing tokens within the files  and packaging within the final JAR.
The Java Library Plugin handles this by automatically creating a dedicated task for each defined source set called <code>process<em>SourceSet</em>Resources</code> (or <code>processResources</code> for the <code>main</code> source set).
The following diagram shows how the source set fits in with this task:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-sourcesets-process-resources.png" alt="java sourcesets process resources">
</div>
<div class="title">Figure 19. Processing non-source files for a source set</div>
</div>
<div class="paragraph">
<p>As before, the shaded boxes represent properties of the source set, which in this case comprises the locations of the resource files and where they are copied to.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>main</code> source set, the Java Library Plugin defines a <code>test</code> source set that represents the project&#8217;s tests.
This source set is used by the <code>test</code> task, which runs the tests.
You can learn more about this task and related topics in the <a href="#java_testing">Java testing</a> chapter.</p>
</div>
<div class="paragraph">
<p>Projects typically use this source set for unit tests, but you can also use it for integration, acceptance and other types of test if you wish.
The alternative approach is to <a href="#sec:custom_java_source_sets">define a new source set</a> for each of your other test types, which is typically done for one or both of the following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You want to keep the tests separate from one another for aesthetics and manageability</p>
</li>
<li>
<p>The different test types require different compilation or runtime classpaths or some other difference in setup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see an example of this approach in the Java testing chapter, which shows you <a href="#sec:configuring_java_integration_tests">how to set up integration tests</a> in a project.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll learn more about source sets and the features they provide in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:custom_java_source_set_paths">Customizing file and directory locations</a></p>
</li>
<li>
<p><a href="#sec:configuring_java_integration_tests">Configuring Java integration tests</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:implicit_sourceset_configurations"><a class="anchor" href="#sec:implicit_sourceset_configurations"></a><a class="link" href="#sec:implicit_sourceset_configurations">Source set configurations</a></h5>
<div class="paragraph">
<p>When a source set is created, it also creates a number of configurations as described above.
Build logic should <strong>not</strong> attempt to create or access these configurations until they are first created by the source set.</p>
</div>
<div class="paragraph">
<p>When creating a source set, if one of these automatically created configurations already exists, and its role is different than the role that the source set would have assigned, the build will fail.</p>
</div>
<div class="paragraph">
<p>The build below demonstrates this behavior.</p>
</div>
<div id="ex-configurations-created-prior-to-their-associated-source-sets" class="exampleblock">
<div class="title">Example 58. <a href="#ex-configurations-created-prior-to-their-associated-source-sets">Configurations created prior to their associated source sets</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">configurations {
    val myCodeCompileClasspath: Configuration by creating
}

sourceSets {
    val myCode: SourceSet by creating
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    myCodeCompileClasspath
}

sourceSets {
    myCode
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, the build will fail.</p>
</div>
<div class="paragraph">
<p>Following two simple best practices will avoid this problem:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Don&#8217;t create configurations with names that will be used by source sets, such as names ending in <code>Api</code>, <code>Implementation</code>, <code>ApiElements</code>, <code>CompileOnly</code>, <code>CompileOnlyApi</code>, <code>RuntimeOnly</code>, <code>RuntimeClasspath</code> or <code>RuntimeElements</code>.
(This list is not exhaustive.)</p>
</li>
<li>
<p>Create any custom source sets prior to any custom configurations.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remember that any time you reference a configuration within the <code>configurations</code> container - with or without supplying an initialization action - Gradle will create the configuration.
Sometimes when using the Groovy DSL this creation is not obvious, as in the example below, where <code>myCustomConfiguration</code> is created prior to the call to <code>extendsFrom</code>.</p>
</div>
<div id="ex-custom-configuration-creation-in-groovy" class="exampleblock">
<div class="title">Example 59. <a href="#ex-custom-configuration-creation-in-groovy">Custom Configuration creation in Groovy</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    myCustomConfiguration.extendsFrom(implementation)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_dependency_management_overview"><a class="anchor" href="#sec:java_dependency_management_overview"></a><a class="link" href="#sec:java_dependency_management_overview">Managing your dependencies</a></h4>
<div class="paragraph">
<p>The vast majority of Java projects rely on libraries, so managing a project&#8217;s dependencies is an important part of building a Java project.
Dependency management is a big topic, so we will focus on the basics for Java projects here.
If you&#8217;d like to dive into the detail, check out the <a href="getting_started_dep_man.html#dependency-management-in-gradle">introduction to dependency management</a>.</p>
</div>
<div class="paragraph">
<p>Specifying the dependencies for your Java project requires just three pieces of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which dependency you need, such as a name and version</p>
</li>
<li>
<p>What it&#8217;s needed for, e.g. compilation or running</p>
</li>
<li>
<p>Where to look for it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two are specified in a <code>dependencies {}</code> block and the third in a <code>repositories {}</code> block. For example, to tell Gradle that your project requires version 3.6.7 of <a href="http://hibernate.org/">Hibernate</a> Core to compile and run your production code, and that you want to download the library from the Maven Central repository, you can use the following fragment:</p>
</div>
<div id="ex-declaring-dependencies" class="exampleblock">
<div class="title">Example 60. <a href="#ex-declaring-dependencies">Declaring dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.hibernate:hibernate-core:3.6.7.Final")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.hibernate:hibernate-core:3.6.7.Final'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Gradle terminology for the three elements is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Repository</em> (ex: <code>mavenCentral()</code>)  where to look for the modules you declare as dependencies</p>
</li>
<li>
<p><em>Configuration</em> (ex: <code>implementation</code>)  a named collection of dependencies, grouped together for a specific goal such as compiling or running a module a more flexible form of Maven scopes</p>
</li>
<li>
<p><em>Module coordinate</em> (ex: <code>org.hibernate:hibernate-core-3.6.7.Final</code>)  the ID of the dependency, usually in the form '<em>&lt;group&gt;</em>:<em>&lt;module&gt;</em>:<em>&lt;version&gt;</em>' (or '<em>&lt;groupId&gt;</em>:<em>&lt;artifactId&gt;</em>:<em>&lt;version&gt;</em>' in Maven terminology)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find a more comprehensive glossary of dependency management terms <a href="glossary.html#dependency_management_terminology">here</a>.</p>
</div>
<div class="paragraph">
<p>As far as configurations go, the main ones of interest are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>compileOnly</code> for dependencies that are necessary to compile your production code but shouldn&#8217;t be part of the runtime classpath</p>
</li>
<li>
<p><code>implementation</code> (supersedes <code>compile</code>) used for compilation and runtime</p>
</li>
<li>
<p><code>runtimeOnly</code> (supersedes <code>runtime</code>)  only used at runtime, not for compilation</p>
</li>
<li>
<p><code>testCompileOnly</code>  same as <code>compileOnly</code> except it&#8217;s for the tests</p>
</li>
<li>
<p><code>testImplementation</code> test equivalent of <code>implementation</code></p>
</li>
<li>
<p><code>testRuntimeOnly</code> test equivalent of <code>runtimeOnly</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can learn more about these and how they relate to one another in the <a href="java_plugin.html#sec:java_plugin_and_dependency_management">plugin reference chapter</a>.</p>
</div>
<div class="paragraph">
<p>Be aware that the <a href="#java_library_plugin">Java Library Plugin</a> offers two additional configurations  <code>api</code> and <code>compileOnlyApi</code>  for dependencies that are required for compiling both the module and any modules that depend on it.</p>
</div>
<div class="openblock">
<div class="title">Why no <code>compile</code> configuration?</div>
<div class="content">
<div class="paragraph">
<p>The Java Library Plugin has historically used the <code>compile</code> configuration for dependencies that are required to both compile and run a project&#8217;s production code.
It is now deprecated, and will issue warnings when used, because it doesn&#8217;t distinguish between dependencies that impact the public API of a Java library project and those that don&#8217;t.
You can learn more about the importance of this distinction in <a href="#sec:building_java_libraries">Building Java libraries</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>We have only scratched the surface here, so we recommend that you read the dedicated dependency management chapters once you&#8217;re comfortable with the basics of building Java projects with Gradle. Some common scenarios that require further reading include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defining a custom <a href="#sec:maven-repo">Maven-</a> or <a href="#sec:ivy-repositories">Ivy-compatible</a> repository</p>
</li>
<li>
<p>Using dependencies from a <a href="#sec:flat-dir-resolver">local filesystem directory</a></p>
</li>
<li>
<p>Declaring dependencies with <a href="#sec:declaring-dependency-with-changing-version">changing</a> (e.g. SNAPSHOT) and <a href="#sec:declaring-dependency-with-dynamic-version">dynamic</a> (range) versions</p>
</li>
<li>
<p>Declaring a sibling <a href="#sec:project-dependencies">project as a dependency</a></p>
</li>
<li>
<p><a href="#dependency-constraints">Controlling transitive dependencies and their versions</a></p>
</li>
<li>
<p>Testing your fixes to a 3rd-party dependency via <a href="#composite_builds">composite builds</a> (a better alternative to publishing to and consuming from <a href="#sec:maven-local">Maven Local</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You&#8217;ll discover that Gradle has a rich API for working with dependencies one that takes time to master, but is straightforward to use for common scenarios.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:compile"><a class="anchor" href="#sec:compile"></a><a class="link" href="#sec:compile">Compiling your code</a></h4>
<div class="paragraph">
<p>Compiling both your production and test code can be trivially easy if you follow the conventions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Put your production source code under the <em>src/main/java</em> directory</p>
</li>
<li>
<p>Put your test source code under <em>src/test/java</em></p>
</li>
<li>
<p>Declare your production compile dependencies in the <code>compileOnly</code> or <code>implementation</code> configurations (see previous section)</p>
</li>
<li>
<p>Declare your test compile dependencies in the <code>testCompileOnly</code> or <code>testImplementation</code> configurations</p>
</li>
<li>
<p>Run the <code>compileJava</code> task for the production code and <code>compileTestJava</code> for the tests</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Other JVM language plugins, such as the one for <a href="#groovy_plugin">Groovy</a>, follow the same pattern of conventions. We recommend that you follow these conventions wherever possible, but you don&#8217;t have to. There are several options for customization, as you&#8217;ll see next.</p>
</div>
<div class="sect4">
<h5 id="sec:custom_java_source_set_paths"><a class="anchor" href="#sec:custom_java_source_set_paths"></a><a class="link" href="#sec:custom_java_source_set_paths">Customizing file and directory locations</a></h5>
<div class="paragraph">
<p>Imagine you have a legacy project that uses an <em>src</em> directory for the production code and <em>test</em> for the test code. The conventional directory structure won&#8217;t work, so you need to tell Gradle where to find the source files. You do that via source set configuration.</p>
</div>
<div class="paragraph">
<p>Each source set defines where its source code resides, along with the resources and the output directory for the class files. You can override the convention values by using the following syntax:</p>
</div>
<div id="ex-declaring-custom-source-directories" class="exampleblock">
<div class="title">Example 61. <a href="#ex-declaring-custom-source-directories">Declaring custom source directories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    main {
        java {
            setSrcDirs(listOf("src"))
        }
    }

    test {
        java {
            setSrcDirs(listOf("test"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sourceSets {
    main {
         java {
            srcDirs = ['src']
         }
    }

    test {
        java {
            srcDirs = ['test']
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now Gradle will only search directly in <em>src</em> and <em>test</em> for the respective source code. What if you don&#8217;t want to override the convention, but simply want to <em>add</em> an extra source directory, perhaps one that contains some third-party source code you want to keep separate? The syntax is similar:</p>
</div>
<div id="ex-declaring-custom-source-directories-additively" class="exampleblock">
<div class="title">Example 62. <a href="#ex-declaring-custom-source-directories-additively">Declaring custom source directories additively</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    main {
        java {
            srcDir("thirdParty/src/main/java")
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sourceSets {
    main {
        java {
            srcDir 'thirdParty/src/main/java'
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Crucially, we&#8217;re using the <em>method</em> <code>srcDir()</code> here to append a directory path, whereas setting the <code>srcDirs</code> property replaces any existing values. This is a common convention in Gradle: setting a property replaces values, while the corresponding method appends values.</p>
</div>
<div class="paragraph">
<p>You can see all the properties and methods available on source sets in the DSL reference for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.SourceSet.html">SourceSet</a> and <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a>. Note that <code>srcDirs</code> and <code>srcDir()</code> are both on <code>SourceDirectorySet</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="changing_compiler_options"><a class="anchor" href="#changing_compiler_options"></a><a class="link" href="#changing_compiler_options">Changing compiler options</a></h5>
<div class="paragraph">
<p>Most of the compiler options are accessible through the corresponding task, such as <code>compileJava</code> and <code>compileTestJava</code>. These tasks are of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>, so read the task reference for an up-to-date and comprehensive list of the options.</p>
</div>
<div class="paragraph">
<p>For example, if you want to use a separate JVM process for the compiler and prevent compilation failures from failing the build, you can use this configuration:</p>
</div>
<div id="ex-setting-java-compiler-options" class="exampleblock">
<div class="title">Example 63. <a href="#ex-setting-java-compiler-options">Setting Java compiler options</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.compileJava {
    options.isIncremental = true
    options.isFork = true
    options.isFailOnError = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">compileJava {
    options.incremental = true
    options.fork = true
    options.failOnError = false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s also how you can change the verbosity of the compiler, disable debug output in the byte code and configure where the compiler can find annotation processors.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_cross_compilation"><a class="anchor" href="#sec:java_cross_compilation"></a><a class="link" href="#sec:java_cross_compilation">Targeting a specific Java version</a></h5>
<div class="paragraph">
<p>By default, Gradle will compile Java code to the language level of the JVM running Gradle.
If you need to target a specific version of Java when compiling, Gradle provides multiple options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using <a href="#toolchains">Java toolchains</a> is a preferred way to target a language version.<br>
A toolchain uniformly handles compilation, execution and Javadoc generation, and it can be configured on the project level.</p>
</li>
<li>
<p>Using <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.CompileOptions.html#org.gradle.api.tasks.compile.CompileOptions:release"><code>release</code></a> property is possible starting from Java 10.<br>
Selecting a Java release makes sure that compilation is done with the configured language level and against the JDK APIs from that Java version.</p>
</li>
<li>
<p>Using <code>sourceCompatibility</code> and <code>targetCompatibility</code> properties.<br>
Although not generally advised, these options were historically used to configure the Java version during compilation.</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="sec:compiling_with_toolchain"><a class="anchor" href="#sec:compiling_with_toolchain"></a><a class="link" href="#sec:compiling_with_toolchain">Using toolchains</a></h6>
<div class="paragraph">
<p>When Java code is compiled using a specific toolchain, the actual compilation is carried out by a compiler of the specified Java version.
The compiler provides access to the language features and JDK APIs for the requested Java language version.</p>
</div>
<div class="paragraph">
<p>In the simplest case, the toolchain can be configured for a project using the <code>java</code> extension.
This way, not only compilation benefits from it, but also other tasks such as <code>test</code> and <code>javadoc</code> will also consistently use the same toolchain.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can learn more about this in the <a href="#toolchains">Java toolchains</a> guide.</p>
</div>
</div>
<div class="sect5">
<h6 id="sec:compiling_with_release"><a class="anchor" href="#sec:compiling_with_release"></a><a class="link" href="#sec:compiling_with_release">Using Java release version</a></h6>
<div class="paragraph">
<p>Setting the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.CompileOptions.html#org.gradle.api.tasks.compile.CompileOptions:release">release</a> flag ensures the specified language level is used regardless of which compiler actually performs the compilation.
To use this feature, the compiler must support the requested release version.
It is possible to specify an earlier release version while compiling with a more recent <a href="#sec:compiling_with_toolchain">toolchain</a>.</p>
</div>
<div class="paragraph">
<p>Gradle supports using the release flag from Java 10.
It can be configured on the compilation task as follows.</p>
</div>
<div id="ex-setting-java-release-flag" class="exampleblock">
<div class="title">Example 64. <a href="#ex-setting-java-release-flag">Setting Java release flag</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.compileJava {
    options.release = 7
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">compileJava {
    options.release = 7
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The release flag provides guarantees similar to toolchains.
It validates that the Java sources are not using language features introduced in later Java versions, and also that the code does not access APIs from more recent JDKs.
The bytecode produced by the compiler also corresponds to the requested Java version, meaning that the compiled code cannot be executed on older JVMs.</p>
</div>
<div class="paragraph">
<p>The <code>release</code> option of the Java compiler was introduced in Java 9.
However, using this option with Gradle is only possible starting with Java 10, due to a <a href="https://bugs.openjdk.org/browse/JDK-8139607">bug in Java 9</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="using_java_compatibility_options"><a class="anchor" href="#using_java_compatibility_options"></a><a class="link" href="#using_java_compatibility_options">Using Java compatibility options</a></h6>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Using compatibility properties can lead to runtime failures when executing compiled code due to weaker guarantees they provide.
Instead, consider using <a href="#sec:compiling_with_toolchain">toolchains</a> or the <a href="#sec:compiling_with_release">release</a> flag.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>sourceCompatibility</code> and <code>targetCompatibility</code> options correspond to the Java compiler options <code>-source</code> and <code>-target</code>.
They are considered a legacy mechanism for targeting a specific Java version.
However, these options do not protect against the use of APIs introduced in later Java versions.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>sourceCompatibility</code></dt>
<dd>
<p>Defines the language version of Java used in your source files.</p>
</dd>
<dt class="hdlist1"><code>targetCompatibility</code></dt>
<dd>
<p>Defines the minimum JVM version your code should run on, i.e. it determines the version of the bytecode generated by the compiler.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These options can be set per <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a> task, or on the <code>java { }</code> extension for all compile tasks, using properties with the same names.</p>
</div>
</div>
<div class="sect5">
<h6 id="targeting_java_6_and_java_7"><a class="anchor" href="#targeting_java_6_and_java_7"></a><a class="link" href="#targeting_java_6_and_java_7">Targeting Java 6 and Java 7</a></h6>
<div class="paragraph">
<p>Gradle itself can only run on a JVM with Java version 8 or higher.
However, Gradle still supports compiling, testing, generating Javadocs and executing applications for Java 6 and Java 7.
Java 5 and below are not supported.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If using Java 10+, leveraging the <code>release</code> flag might be an easier solution, see above.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use Java 6 or Java 7, the following tasks need to be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JavaCompile</code> task to fork and use the correct Java home</p>
</li>
<li>
<p><code>Javadoc</code> task to use the correct <code>javadoc</code> executable</p>
</li>
<li>
<p><code>Test</code> and the <code>JavaExec</code> task to use the correct <code>java</code> executable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the usage of Java toolchains, this can be done as follows:</p>
</div>
<div id="ex-configuring-java-7-build" class="exampleblock">
<div class="title">Example 65. <a href="#ex-configuring-java-7-build">Configuring Java 7 build</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(7)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(7)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The only requirement is that Java 7 is installed and has to be either in <a href="#sec:auto_detection">a location Gradle can detect automatically</a> or <a href="#sec:custom_loc">explicitly configured</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:custom_java_source_sets"><a class="anchor" href="#sec:custom_java_source_sets"></a><a class="link" href="#sec:custom_java_source_sets">Compiling independent sources separately</a></h5>
<div class="paragraph">
<p>Most projects have at least two independent sets of sources: the production code and the test code.
Gradle already makes this scenario part of its Java convention, but what if you have other sets of sources?
One of the most common scenarios is when you have separate integration tests of some form or other.
In that case, a custom source set may be just what you need.</p>
</div>
<div class="paragraph">
<p>You can see a complete example for setting up integration tests in the <a href="#sec:configuring_java_integration_tests">Java testing chapter</a>. You can set up other source sets that fulfil different roles in the same way. The question then becomes: when should you define a custom source set?</p>
</div>
<div class="paragraph">
<p>To answer that question, consider whether the sources:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Need to be compiled with a unique classpath</p>
</li>
<li>
<p>Generate classes that are handled differently from the <code>main</code> and <code>test</code> ones</p>
</li>
<li>
<p>Form a natural part of the project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If your answer to both 3 and either one of the others is yes, then a custom source set is probably the right approach. For example, integration tests are typically part of the project because they test the code in <code>main</code>. In addition, they often have either their own dependencies independent of the <code>test</code> source set or they need to be run with a custom <code>Test</code> task.</p>
</div>
<div class="paragraph">
<p>Other common scenarios are less clear cut and may have better solutions. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Separate API and implementation JARs it may make sense to have these as separate projects, particularly if you already have a multi-project build</p>
</li>
<li>
<p>Generated sources if the resulting sources should be compiled with the production code, add their path(s) to the <code>main</code> source set and make sure that the <code>compileJava</code> task depends on the task that generates the sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re unsure whether to create a custom source set or not, then go ahead and do so. It should be straightforward and if it&#8217;s not, then it&#8217;s probably not the right tool for the job.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_compiling_errors"><a class="anchor" href="#sec:java_compiling_errors"></a><a class="link" href="#sec:java_compiling_errors">Debugging compiling errors</a></h5>
<div class="paragraph">
<p>Gradle provides detailed reporting for compilation failures.</p>
</div>
<div class="paragraph">
<p>If a compilation task fails, the summary of errors is displayed in the following locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task&#8217;s output, providing immediate context for the error.</p>
</li>
<li>
<p>The "What went wrong" summary at the bottom of the build output, consolidated with all other failures for easy reference.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">* What went wrong:
Execution failed for task ':project1:compileJava'.
&gt; Compilation failed; see the compiler output below.
Java compilation warning
  sample-project/src/main/java/Problem1.java:6: warning: [cast] redundant cast to String
          var warning = (String)"warning";
                        ^
Java compilation error
  sample-project/src/main/java/Problem2.java:6: error: incompatible types: int cannot be converted to String
          String a = 1;
                     ^</code></pre>
</div>
</div>
<div class="paragraph">
<p>This reporting feature works with the <code>continue</code> flag.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_resources"><a class="anchor" href="#sec:java_resources"></a><a class="link" href="#sec:java_resources">Managing resources</a></h4>
<div class="paragraph">
<p>Many Java projects make use of resources beyond source files, such as images, configuration files and localization data.
Sometimes these files simply need to be packaged unchanged and sometimes they need to be processed as template files or in some other way.
Either way, the Java Library Plugin adds a specific <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Copy.html">Copy</a> task for each source set that handles the processing of its associated resources.</p>
</div>
<div class="paragraph">
<p>The task&#8217;s name follows the convention of <code>process<em>SourceSet</em>Resources</code> or <code>processResources</code> for the <code>main</code> source set and it will automatically copy any files in <em>src/[sourceSet]/resources</em> to a directory that will be included in the production JAR. This target directory will also be included in the runtime classpath of the tests.</p>
</div>
<div class="paragraph">
<p>Since <code>processResources</code> is an instance of the <code>ProcessResources</code> task, you can perform any of the processing described in the <a href="#sec:copying_files">Working With Files</a> chapter.</p>
</div>
<div class="sect4">
<h5 id="sec:properties_files"><a class="anchor" href="#sec:properties_files"></a><a class="link" href="#sec:properties_files">Java properties files and reproducible builds</a></h5>
<div class="paragraph">
<p>You can easily create Java properties files via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.WriteProperties.html">WriteProperties</a> task, which fixes a well-known problem with <code>Properties.store()</code> that can reduce the usefulness of <a href="incremental_build.html#incremental_build">incremental builds</a>.</p>
</div>
<div class="paragraph">
<p>The standard Java API for writing properties files produces a unique file every time, even when the same properties and values are used, because it includes a timestamp in the comments. Gradle&#8217;s <code>WriteProperties</code> task generates exactly the same output byte-for-byte if none of the properties have changed. This is achieved by a few tweaks to how a properties file is generated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>no timestamp comment is added to the output</p>
</li>
<li>
<p>the line separator is system independent, but can be configured explicitly (it defaults to <code>'\n'</code>)</p>
</li>
<li>
<p>the properties are sorted alphabetically</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sometimes it can be desirable to recreate archives in a byte for byte way on different machines. You want to be sure that building an artifact from source code produces the same result, byte for byte, no matter when and where it is built. This is necessary for projects like reproducible-builds.org.</p>
</div>
<div class="paragraph">
<p>These tweaks not only lead to better incremental build integration, but they also help with <a href="https://reproducible-builds.org">reproducible builds</a>. In essence, reproducible builds guarantee that you will see the same results from a build execution  including test results and production binaries no matter when or on what system you run it.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:running_java_tests"><a class="anchor" href="#sec:running_java_tests"></a><a class="link" href="#sec:running_java_tests">Running tests</a></h4>
<div class="paragraph">
<p>Alongside providing automatic compilation of unit tests in <em>src/test/java</em>, the Java Library Plugin has native support for running tests that use JUnit 3, 4 &amp; 5 (JUnit 5 support <a href="https://docs.gradle.org/4.6/release-notes.html#junit-5-support">came in Gradle 4.6</a>) and TestNG.
You get:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An automatic <code>test</code> task of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a>, using the <code>test</code> source set</p>
</li>
<li>
<p>An HTML test report that includes the results from <em>all</em> <code>Test</code> tasks that run</p>
</li>
<li>
<p>Easy filtering of which tests to run</p>
</li>
<li>
<p>Fine-grained control over how the tests are run</p>
</li>
<li>
<p>The opportunity to create your own test execution and test reporting tasks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You do <em>not</em> get a <code>Test</code> task for every source set you declare, since not every source set represents tests! That&#8217;s why you typically need to <a href="#sec:custom_java_source_sets">create your own <code>Test</code> tasks</a> for things like integration and acceptance tests if they can&#8217;t be included with the <code>test</code> source set.</p>
</div>
<div class="paragraph">
<p>As there is a lot to cover when it comes to testing, the topic has its <a href="#java_testing">own chapter</a> in which we look at:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How tests are run</p>
</li>
<li>
<p>How to run a subset of tests via filtering</p>
</li>
<li>
<p>How Gradle discovers tests</p>
</li>
<li>
<p>How to configure test reporting and add your own reporting tasks</p>
</li>
<li>
<p>How to make use of specific JUnit and TestNG features</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also learn more about configuring tests in the DSL reference for <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_packaging"><a class="anchor" href="#sec:java_packaging"></a><a class="link" href="#sec:java_packaging">Packaging and publishing</a></h4>
<div class="paragraph">
<p>How you package and potentially publish your Java project depends on what type of project it is.
Libraries, applications, web applications and enterprise applications all have differing requirements.
In this section, we will focus on the bare bones provided by the Java Library Plugin.</p>
</div>
<div class="paragraph">
<p>By default, the Java Library Plugin provides the <code>jar</code> task that packages all the compiled production classes and resources into a single JAR.
This JAR is also automatically built by the <code>assemble</code> task.
Furthermore, the plugin can be configured to provide the <code>javadocJar</code> and <code>sourcesJar</code> tasks to package Javadoc and source code if so desired.
If a publishing plugin is used, these tasks will automatically run during publishing or can be called directly.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    withJavadocJar()
    withSourcesJar()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    withJavadocJar()
    withSourcesJar()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you want to create an 'uber' (AKA 'fat') JAR, then you can use a task definition like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    java
}

version = "1.0.0"

repositories {
    mavenCentral()
}

dependencies {
    implementation("commons-io:commons-io:2.6")
}

tasks.register&lt;Jar&gt;("uberJar") {
    archiveClassifier = "uber"

    from(sourceSets.main.get().output)

    dependsOn(configurations.runtimeClasspath)
    from({
        configurations.runtimeClasspath.get().filter { it.name.endsWith("jar") }.map { zipTree(it) }
    })
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

version = '1.0.0'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'commons-io:commons-io:2.6'
}

tasks.register('uberJar', Jar) {
    archiveClassifier = 'uber'

    from sourceSets.main.output

    dependsOn configurations.runtimeClasspath
    from {
        configurations.runtimeClasspath.findAll { it.name.endsWith('jar') }.collect { zipTree(it) }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a> for more details on the configuration options available to you.
And note that you need to use <code>archiveClassifier</code> rather than <code>archiveAppendix</code> here for correct publication of the JAR.</p>
</div>
<div class="paragraph">
<p>You can use one of the publishing plugins to publish the JARs created by a Java project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#publishing_maven">Maven Publish Plugin</a></p>
</li>
<li>
<p><a href="#publishing_ivy">Ivy Publish Plugin</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:jar_manifest"><a class="anchor" href="#sec:jar_manifest"></a><a class="link" href="#sec:jar_manifest">Modifying the JAR manifest</a></h5>
<div class="paragraph">
<p>Each instance of the <code>Jar</code>, <code>War</code> and <code>Ear</code> tasks has a <code>manifest</code> property that allows you to customize the <em>MANIFEST.MF</em> file that goes into the corresponding archive. The following example demonstrates how to set attributes in the JAR&#8217;s manifest:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.jar {
    manifest {
        attributes(
            "Implementation-Title" to "Gradle",
            "Implementation-Version" to archiveVersion
        )
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">jar {
    manifest {
        attributes("Implementation-Title": "Gradle",
                   "Implementation-Version": archiveVersion)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/java/archives/Manifest.html">Manifest</a> for the configuration options it provides.</p>
</div>
<div class="paragraph">
<p>You can also create standalone instances of <code>Manifest</code>. One reason for doing so is to share manifest information between JARs. The following example demonstrates how to share common attributes between JARs:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val sharedManifest = java.manifest {
    attributes (
        "Implementation-Title" to "Gradle",
        "Implementation-Version" to version
    )
}

tasks.register&lt;Jar&gt;("fooJar") {
    manifest = java.manifest {
        from(sharedManifest)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def sharedManifest = java.manifest {
    attributes("Implementation-Title": "Gradle",
               "Implementation-Version": version)
}
tasks.register('fooJar', Jar) {
    manifest = java.manifest {
        from sharedManifest
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Another option available to you is to merge manifests into a single <code>Manifest</code> object. Those source manifests can take the form of a text for or another <code>Manifest</code> object. In the following example, the source manifests are all text files except for <code>sharedManifest</code>, which is the <code>Manifest</code> object from the previous example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Jar&gt;("barJar") {
    manifest {
        attributes("key1" to "value1")
        from(sharedManifest, "src/config/basemanifest.txt")
        from(listOf("src/config/javabasemanifest.txt", "src/config/libbasemanifest.txt")) {
            eachEntry(Action&lt;ManifestMergeDetails&gt; {
                if (baseValue != mergeValue) {
                    value = baseValue
                }
                if (key == "foo") {
                    exclude()
                }
            })
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('barJar', Jar) {
    manifest {
        attributes key1: 'value1'
        from sharedManifest, 'src/config/basemanifest.txt'
        from(['src/config/javabasemanifest.txt', 'src/config/libbasemanifest.txt']) {
            eachEntry { details -&gt;
                if (details.baseValue != details.mergeValue) {
                    details.value = baseValue
                }
                if (details.key == 'foo') {
                    details.exclude()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Manifests are merged in the order they are declared in the <code>from</code> statement. If the base manifest and the merged manifest both define values for the same key, the merged manifest wins by default. You can fully customize the merge behavior by adding <code>eachEntry</code> actions in which you have access to a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/java/archives/ManifestMergeDetails.html">ManifestMergeDetails</a> instance for each entry of the resulting manifest. Note that the merge is done lazily, either when generating the JAR or when <code>Manifest.writeTo()</code> or <code>Manifest.getEffectiveManifest()</code> are called.</p>
</div>
<div class="paragraph">
<p>Speaking of <code>writeTo()</code>, you can use that to easily write a manifest to disk at any time, like so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.jar { manifest.writeTo(layout.buildDirectory.file("mymanifest.mf")) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('jar') { manifest.writeTo(layout.buildDirectory.file('mymanifest.mf')) }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:generating_javadocs"><a class="anchor" href="#sec:generating_javadocs"></a><a class="link" href="#sec:generating_javadocs">Generating API documentation</a></h4>
<div class="paragraph">
<p>The Java Library Plugin provides a <code>javadoc</code> task of type <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a>, that will generate standard Javadocs for all your production code, i.e. whatever source is in the <code>main</code> source set.
The task supports the core Javadoc and standard doclet options described in the <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javadoc.html#options">Javadoc reference documentation</a>.
See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/external/javadoc/CoreJavadocOptions.html">CoreJavadocOptions</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/external/javadoc/StandardJavadocDocletOptions.html">StandardJavadocDocletOptions</a> for a complete list of those options.</p>
</div>
<div class="paragraph">
<p>As an example of what you can do, imagine you want to use Asciidoc syntax in your Javadoc comments. To do this, you need to add Asciidoclet to Javadoc&#8217;s doclet path. Here&#8217;s an example that does just that:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val asciidoclet by configurations.creating

dependencies {
    asciidoclet("org.asciidoctor:asciidoclet:1.+")
}

tasks.register("configureJavadoc") {
    doLast {
        tasks.javadoc {
            options.doclet = "org.asciidoctor.Asciidoclet"
            options.docletpath = asciidoclet.files.toList()
        }
    }
}

tasks.javadoc {
    dependsOn("configureJavadoc")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations {
    asciidoclet
}

dependencies {
    asciidoclet 'org.asciidoctor:asciidoclet:1.+'
}

tasks.register('configureJavadoc') {
    doLast {
        javadoc {
            options.doclet = 'org.asciidoctor.Asciidoclet'
            options.docletpath = configurations.asciidoclet.files.toList()
        }
    }
}

javadoc {
    dependsOn configureJavadoc
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You don&#8217;t have to create a configuration for this, but it&#8217;s an elegant way to handle dependencies that are required for a unique purpose.</p>
</div>
<div class="paragraph">
<p>You might also want to create your own Javadoc tasks, for example to generate API docs for the tests:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Javadoc&gt;("testJavadoc") {
    source = sourceSets.test.get().allJava
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('testJavadoc', Javadoc) {
    source = sourceSets.test.allJava
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>These are just two non-trivial but common customizations that you might come across.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:cleaning_java_build"><a class="anchor" href="#sec:cleaning_java_build"></a><a class="link" href="#sec:cleaning_java_build">Cleaning the build</a></h4>
<div class="paragraph">
<p>The Java Library Plugin adds a <code>clean</code> task to your project by virtue of applying the <a href="base_plugin.html#base_plugin">Base Plugin</a>.
This task simply deletes everything in the <code>layout.buildDirectory</code> directory, hence why you should always put files generated by the build in there.
The task is an instance of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Delete.html">Delete</a> and you can change what directory it deletes by setting its <code>dir</code> property.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_jvm_components"><a class="anchor" href="#sec:building_jvm_components"></a><a class="link" href="#sec:building_jvm_components">Building JVM components</a></h4>
<div class="paragraph">
<p>All of the specific JVM plugins are built on top of the <a href="java_plugin.html#java_plugin">Java Plugin</a>.
The examples above only illustrated concepts provided by this base plugin and shared with all JVM plugins.</p>
</div>
<div class="paragraph">
<p>Read on to understand which plugins fits which project type, as it is recommended to pick a specific plugin instead of applying the Java Plugin directly.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_libraries"><a class="anchor" href="#sec:building_java_libraries"></a><a class="link" href="#sec:building_java_libraries">Building Java libraries</a></h4>
<div class="paragraph">
<p>The unique aspect of library projects is that they are used (or "consumed") by other Java projects.
That means the dependency metadata published with the JAR file  usually in the form of a Maven POM  is crucial.
In particular, consumers of your library should be able to distinguish between two different types of dependencies: those that are only required to compile your library and those that are also required to compile the consumer.</p>
</div>
<div class="paragraph">
<p>Gradle manages this distinction via the <a href="#java_library_plugin">Java Library Plugin</a>, which introduces an <em>api</em> configuration in addition to the <em>implementation</em> one covered in this chapter.
If the types from a dependency appear in public fields or methods of your library&#8217;s public classes, then that dependency is exposed via your library&#8217;s public API and should therefore be added to the <em>api</em> configuration.
Otherwise, the dependency is an internal implementation detail and should be added to <em>implementation</em>.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re unsure of the difference between an API and implementation dependency, the <a href="#sec:java_library_recognizing_dependencies">Java Library Plugin chapter</a> has a detailed explanation. In addition, you can explore a basic, practical <a href="../samples/sample_building_java_libraries.html">sample of building a Java library</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_applications"><a class="anchor" href="#sec:building_java_applications"></a><a class="link" href="#sec:building_java_applications">Building Java applications</a></h4>
<div class="paragraph">
<p>Java applications packaged as a JAR aren&#8217;t set up for easy launching from the command line or a desktop environment.
The <a href="#application_plugin">Application Plugin</a> solves the command line aspect by creating a distribution that includes the production JAR, its dependencies and launch scripts Unix-like and Windows systems.</p>
</div>
<div class="paragraph">
<p>See the plugin&#8217;s chapter for more details, but here&#8217;s a quick summary of what you get:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assemble</code> creates ZIP and TAR distributions of the application containing everything needed to run it</p>
</li>
<li>
<p>A <code>run</code> task that starts the application from the build (for easy testing)</p>
</li>
<li>
<p>Shell and Windows Batch scripts to start the application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see a basic example of building a Java application in the corresponding <a href="../samples/sample_building_java_applications.html">sample</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_webapps"><a class="anchor" href="#sec:building_java_webapps"></a><a class="link" href="#sec:building_java_webapps">Building Java web applications</a></h4>
<div class="paragraph">
<p>Java web applications can be packaged and deployed in a number of ways depending on the technology you use. For example, you might use <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> with a fat JAR or a <a href="https://www.reactivemanifesto.org/">Reactive</a>-based system running on <a href="https://netty.io/">Netty</a>. Whatever technology you use, Gradle and its large community of plugins will satisfy your needs. Core Gradle, though, only directly supports traditional Servlet-based web applications deployed as WAR files.</p>
</div>
<div class="paragraph">
<p>That support comes via the <a href="war_plugin.html#war_plugin">War Plugin</a>, which automatically applies the Java Plugin and adds an extra packaging step that does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copies static resources from <em>src/main/webapp</em> into the root of the WAR</p>
</li>
<li>
<p>Copies the compiled production classes into a <em>WEB-INF/classes</em> subdirectory of the WAR</p>
</li>
<li>
<p>Copies the library dependencies into a <em>WEB-INF/lib</em> subdirectory of the WAR</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is done by the <code>war</code> task, which effectively replaces the <code>jar</code> task  although that task remains and is attached to the <code>assemble</code> lifecycle task. See the plugin&#8217;s chapter for more details and configuration options.</p>
</div>
<div class="paragraph">
<p>There is no core support for running your web application directly from the build, but we do recommend that you try the <a href="https://plugins.gradle.org/plugin/org.gretty">Gretty</a> community plugin, which provides an embedded Servlet container.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_enterprise_apps"><a class="anchor" href="#sec:building_java_enterprise_apps"></a><a class="link" href="#sec:building_java_enterprise_apps">Building Java EE applications</a></h4>
<div class="paragraph">
<p>Java enterprise systems have changed a lot over the years, but if you&#8217;re still deploying to JEE application servers, you can make use of the <a href="ear_plugin.html#ear_plugin">Ear Plugin</a>. This adds conventions and a task for building EAR files. The plugin&#8217;s chapter has more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_platform"><a class="anchor" href="#sec:building_java_platform"></a><a class="link" href="#sec:building_java_platform">Building Java Platforms</a></h4>
<div class="paragraph">
<p>A Java platform represents a set of dependency declarations and constraints that form a cohesive unit to be applied on consuming projects.
The platform has no source and no artifact of its own.
It maps in the Maven world to a <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Dependency_Management">BOM</a>.</p>
</div>
<div class="paragraph">
<p>The support comes via the <a href="#java_platform_plugin">Java Platform plugin</a>, which sets up the different configurations and publication components.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This plugin is the exception as it does not apply the Java Plugin.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:feature_preview"><a class="anchor" href="#sec:feature_preview"></a><a class="link" href="#sec:feature_preview">Enabling Java preview features</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Using a Java preview feature is very likely to make your code incompatible with that compiled without a feature preview.
As a consequence, we strongly recommend you not to publish libraries compiled with preview features and restrict the use of feature previews to toy projects.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To enable Java <a href="https://openjdk.java.net/jeps/12">preview features</a> for compilation, test execution and runtime, you can use the following DSL snippet:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;JavaCompile&gt;().configureEach {
    options.compilerArgs.add("--enable-preview")
}

tasks.withType&lt;Test&gt;().configureEach {
    jvmArgs("--enable-preview")
}

tasks.withType&lt;JavaExec&gt;().configureEach {
    jvmArgs("--enable-preview")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(JavaCompile).configureEach {
    options.compilerArgs += "--enable-preview"
}

tasks.withType(Test).configureEach {
    jvmArgs += "--enable-preview"
}

tasks.withType(JavaExec).configureEach {
    jvmArgs += "--enable-preview"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_jvm_lang"><a class="anchor" href="#sec:building_jvm_lang"></a><a class="link" href="#sec:building_jvm_lang">Building other JVM language projects</a></h4>
<div class="paragraph">
<p>If you want to leverage the multi language aspect of the JVM, most of what was described here will still apply.</p>
</div>
<div class="paragraph">
<p>Gradle itself provides <a href="#groovy_plugin">Groovy</a> and <a href="#scala_plugin">Scala</a> plugins.
The plugins automatically apply support for compiling Java code and can be further enhanced by combining them with the <code>java-library</code> plugin.</p>
</div>
<div class="sect4">
<h5 id="sub:compile_deps_jvm_lang"><a class="anchor" href="#sub:compile_deps_jvm_lang"></a><a class="link" href="#sub:compile_deps_jvm_lang">Compilation dependency between languages</a></h5>
<div class="paragraph">
<p>These plugins create a dependency between Groovy/Scala compilation and Java compilation (of source code in the <code>java</code> folder of a source set).
You can change this default behavior by adjusting the classpath of the involved compile tasks as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;AbstractCompile&gt;("compileGroovy") {
    // Groovy only needs the declared dependencies
    // (and not longer the output of compileJava)
    classpath = sourceSets.main.get().compileClasspath
}
tasks.named&lt;AbstractCompile&gt;("compileJava") {
    // Java also depends on the result of Groovy compilation
    // (which automatically makes it depend of compileGroovy)
    classpath += files(sourceSets.main.get().groovy.classesDirectory)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('compileGroovy') {
    // Groovy only needs the declared dependencies
    // (and not longer the output of compileJava)
    classpath = sourceSets.main.compileClasspath
}
tasks.named('compileJava') {
    // Java also depends on the result of Groovy compilation
    // (which automatically makes it depend of compileGroovy)
    classpath += files(sourceSets.main.groovy.classesDirectory)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By setting the <code>compileGroovy</code> classpath to be only <code>sourceSets.main.compileClasspath</code>, we effectively remove the previous dependency on <code>compileJava</code> that was declared by having the classpath also take into consideration <code>sourceSets.main.java.classesDirectory</code></p>
</li>
<li>
<p>By adding <code>sourceSets.main.groovy.classesDirectory</code> to the <code>compileJava</code> <code>classpath</code>, we effectively declare a dependency on the <code>compileGroovy</code> task</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All of this is possible through the use of <a href="#lazy_configuration">directory properties</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="extra_language_support"><a class="anchor" href="#extra_language_support"></a><a class="link" href="#extra_language_support">Extra language support</a></h5>
<div class="paragraph">
<p>Beyond core Gradle, there are other <a href="https://plugins.gradle.org/search?term=jvm">great plugins</a> for more JVM languages!</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_testing"><a class="anchor" href="#java_testing"></a><a class="link" href="#java_testing">Testing in Java &amp; JVM projects</a></h3>
<div class="paragraph">
<p>Testing on the JVM is a rich subject matter. There are many different testing libraries and frameworks, as well as many different types of test. All need to be part of the build, whether they are executed frequently or infrequently. This chapter is dedicated to explaining how Gradle handles differing requirements between and within builds, with significant coverage of how it integrates with the two most common testing frameworks: <a href="https://junit.org/">JUnit</a> and <a href="https://testng.org/">TestNG</a>.</p>
</div>
<div class="paragraph">
<p>It explains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ways to control how the tests are run (<a href="#sec:test_execution">Test execution</a>)</p>
</li>
<li>
<p>How to select specific tests to run (<a href="#test_filtering">Test filtering</a>)</p>
</li>
<li>
<p>What test reports are generated and how to influence the process (<a href="#test_reporting">Test reporting</a>)</p>
</li>
<li>
<p>How Gradle finds tests to run (<a href="#sec:test_detection">Test detection</a>)</p>
</li>
<li>
<p>How to make use of the major frameworks' mechanisms for grouping tests together (<a href="#test_grouping">Test grouping</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But first, let&#8217;s look at the basics of JVM testing in Gradle.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A new configuration DSL for modeling test execution phases is available via the incubating <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:java_testing_basics"><a class="anchor" href="#sec:java_testing_basics"></a><a class="link" href="#sec:java_testing_basics">The basics</a></h4>
<div class="paragraph">
<p>All JVM testing revolves around a single task type: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a>. This runs a collection of test cases using any supported test library  JUnit, JUnit Platform or TestNG and collates the results. You can then turn those results into a report via an instance of the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.TestReport.html">TestReport</a> task type.</p>
</div>
<div class="paragraph">
<p>In order to operate, the <code>Test</code> task type requires just two pieces of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where to find the compiled test classes (property: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:testClassesDirs">Test.getTestClassesDirs()</a>)</p>
</li>
<li>
<p>The execution classpath, which should include the classes under test as well as the test library that you&#8217;re using (property: <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:classpath">Test.getClasspath()</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you&#8217;re using a JVM language plugin  such as the <a href="java_plugin.html#java_plugin">Java Plugin</a> you will automatically get the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A dedicated <code>test</code> source set for unit tests</p>
</li>
<li>
<p>A <code>test</code> task of type <code>Test</code> that runs those unit tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JVM language plugins use the source set to configure the task with the appropriate execution classpath and the directory containing the compiled test classes. In addition, they attach the <code>test</code> task to the <code>check</code> <a href="#sec:lifecycle_tasks">lifecycle task</a>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also worth bearing in mind that the <code>test</code> source set automatically creates <a href="java_plugin.html#java_source_set_configurations">corresponding dependency configurations</a>  of which the most useful are <code>testImplementation</code> and <code>testRuntimeOnly</code>  that the plugins tie into the <code>test</code> task&#8217;s classpath.</p>
</div>
<div class="paragraph">
<p>All you need to do in most cases is configure the appropriate compilation and runtime dependencies and add any necessary configuration to the <code>test</code> task. The following example shows a simple setup that uses JUnit Platform and changes the maximum heap size for the tests' JVM to 1 gigabyte:</p>
</div>
<div id="ex-a-basic-configuration-for-the-test-task" class="exampleblock">
<div class="title">Example 66. <a href="#ex-a-basic-configuration-for-the-test-task">A basic configuration for the 'test' task</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}

tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()

    maxHeapSize = "1G"

    testLogging {
        events("passed")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter:5.7.1'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

tasks.named('test', Test) {
    useJUnitPlatform()

    maxHeapSize = '1G'

    testLogging {
        events "passed"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a> task has many generic configuration options as well as several framework-specific ones that you can find described in <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/junit/JUnitOptions.html">JUnitOptions</a>, <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/junitplatform/JUnitPlatformOptions.html">JUnitPlatformOptions</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html">TestNGOptions</a>. We cover a significant number of them in the rest of the chapter.</p>
</div>
<div class="paragraph">
<p>If you want to set up your own <code>Test</code> task with its own set of test classes, then the easiest approach is to create your own source set and <code>Test</code> task instance, as shown in <a href="#sec:configuring_java_integration_tests">Configuring integration tests</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:test_execution"><a class="anchor" href="#sec:test_execution"></a><a class="link" href="#sec:test_execution">Test execution</a></h4>
<div class="paragraph">
<p>Gradle executes tests in a separate ('forked') JVM, isolated from the main build process. This prevents classpath pollution and excessive memory consumption for the build process. It also allows you to run the tests with different JVM arguments than the build is using.</p>
</div>
<div class="paragraph">
<p>You can control how the test process is launched via several properties on the <code>Test</code> task, including the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>maxParallelForks</code>  default: 1</dt>
<dd>
<p>You can run your tests in parallel by setting this property to a value greater than 1. This may make your test suites complete faster, particularly if you run them on a multi-core CPU. When using parallel test execution, make sure your tests are properly isolated from one another. Tests that interact with the filesystem are particularly prone to conflict, causing intermittent test failures.</p>
<div class="paragraph">
<p>Your tests can distinguish between parallel test processes by using the value of the <code>org.gradle.test.worker</code> property, which is unique for each process. You can use this for anything you want, but it&#8217;s particularly useful for filenames and other resource identifiers to prevent the kind of conflict we just mentioned.</p>
</div>
</dd>
<dt class="hdlist1"><code>forkEvery</code>  default: 0 (no maximum)</dt>
<dd>
<p>This property specifies the maximum number of test classes that Gradle should run on a test process before its disposed of and a fresh one created. This is mainly used as a way to manage leaky tests or frameworks that have static state that can&#8217;t be cleared or reset between tests.</p>
<div class="paragraph">
<p><strong>Warning: a low value (other than 0) can severely hurt the performance of the tests</strong></p>
</div>
</dd>
<dt class="hdlist1"><code>ignoreFailures</code>  default: false</dt>
<dd>
<p>If this property is <code>true</code>, Gradle will continue with the project&#8217;s build once the tests have completed, even if some of them have failed. Note that, by default, the <code>Test</code> task always executes every test that it detects, irrespective of this setting.</p>
</dd>
<dt class="hdlist1"><code>failFast</code>  (since Gradle 4.6) default: false</dt>
<dd>
<p>Set this to <code>true</code> if you want the build to fail and finish as soon as one of your tests fails. This can save a lot of time when you have a long-running test suite and is particularly useful when running the build on continuous integration servers. When a build fails before all tests have run, the test reports only include the results of the tests that have completed, successfully or not.</p>
<div class="paragraph">
<p>You can also enable this behavior by using the <code>--fail-fast</code> command line option, or disable it respectively with <code>--no-fail-fast</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>testLogging</code> default: <em>not set</em></dt>
<dd>
<p>This property represents a set of options that control which test events are logged and at what level. You can also configure other logging behavior via this property. See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLoggingContainer.html">TestLoggingContainer</a> for more detail.</p>
</dd>
<dt class="hdlist1"><code>dryRun</code>  default: false</dt>
<dd>
<p>If this property is <code>true</code>, Gradle will simulate the execution of the tests without actually running them. This will still generate reports, allowing for inspection of what tests were selected. This can be used to verify that your test filtering configuration is correct without actually running the tests.</p>
<div class="paragraph">
<p>You can also enable this behavior by using the <code>--test-dry-run</code> command-line option, or disable it respectively with <code>--no-test-dry-run</code>.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a> for details on all the available configuration options.</p>
</div>
</div>
<div class="sect3">
<h4 id="test_filtering"><a class="anchor" href="#test_filtering"></a><a class="link" href="#test_filtering">Test filtering</a></h4>
<div class="paragraph">
<p>It&#8217;s a common requirement to run subsets of a test suite, such as when you&#8217;re fixing a bug or developing a new test case. Gradle provides two mechanisms to do this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Filtering (the preferred option)</p>
</li>
<li>
<p>Test inclusion/exclusion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Filtering supersedes the inclusion/exclusion mechanism, but you may still come across the latter in the wild.</p>
</div>
<div class="paragraph">
<p>With Gradle&#8217;s test filtering you can select tests to run based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A fully-qualified class name or fully qualified method name, e.g. <code>org.gradle.SomeTest</code>, <code>org.gradle.SomeTest.someMethod</code></p>
</li>
<li>
<p>A simple class name or method name if the pattern starts with an upper-case letter, e.g. <code>SomeTest</code>, <code>SomeTest.someMethod</code> (since Gradle 4.7)</p>
</li>
<li>
<p>'*' wildcard matching</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can enable filtering either in the build script or via the <code>--tests</code> command-line option. Here&#8217;s an example of some filters that are applied every time the build runs:</p>
</div>
<div id="ex-filtering-tests-in-the-build-script" class="exampleblock">
<div class="title">Example 67. <a href="#ex-filtering-tests-in-the-build-script">Filtering tests in the build script</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    filter {
        //include specific method in any of the tests
        includeTestsMatching("*UiCheck")

        //include all tests from package
        includeTestsMatching("org.gradle.internal.*")

        //include all integration tests
        includeTestsMatching("*IntegTest")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    filter {
        //include specific method in any of the tests
        includeTestsMatching "*UiCheck"

        //include all tests from package
        includeTestsMatching "org.gradle.internal.*"

        //include all integration tests
        includeTestsMatching "*IntegTest"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more details and examples of declaring filters in the build script, please see the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/TestFilter.html">TestFilter</a> reference.</p>
</div>
<div class="paragraph">
<p>The command-line option is especially useful to execute a single test method. When you use <code>--tests</code>, be aware that the inclusions declared in the build script are still honored. It is also possible to supply multiple <code>--tests</code> options, all of whose patterns will take effect. The following sections have several examples of using the command-line option.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Not all test frameworks play well with filtering. Some advanced, synthetic tests may not be fully compatible.
However, the vast majority of tests and use cases work perfectly well with Gradle&#8217;s filtering mechanism.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following two sections look at the specific cases of simple class/method names and fully-qualified names.</p>
</div>
<div class="sect4">
<h5 id="simple_name_pattern"><a class="anchor" href="#simple_name_pattern"></a><a class="link" href="#simple_name_pattern">Simple name pattern</a></h5>
<div class="paragraph">
<p>Since 4.7, Gradle has treated a pattern starting with an uppercase letter as a simple class name, or a class name + method name. For example, the following command lines run either all or exactly one of the tests in the <code>SomeTestClass</code> test case, regardless of what  package it&#8217;s in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"># Executes all tests in SomeTestClass
gradle test --tests SomeTestClass

# Executes a single specified test in SomeTestClass
gradle test --tests SomeTestClass.someSpecificMethod

gradle test --tests SomeTestClass.*someMethod*</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="full_qualified_name_pattern"><a class="anchor" href="#full_qualified_name_pattern"></a><a class="link" href="#full_qualified_name_pattern">Fully-qualified name pattern</a></h5>
<div class="paragraph">
<p>Prior to 4.7 or if the pattern doesn&#8217;t start with an uppercase letter, Gradle treats the pattern as fully-qualified. So if you want to use the test class name irrespective of its package, you would use <code>--tests *.SomeTestClass</code>. Here are some more examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"># specific class
gradle test --tests org.gradle.SomeTestClass

# specific class and method
gradle test --tests org.gradle.SomeTestClass.someSpecificMethod

# method name containing spaces
gradle test --tests "org.gradle.SomeTestClass.some method containing spaces"

# all classes at specific package (recursively)
gradle test --tests 'all.in.specific.package*'

# specific method at specific package (recursively)
gradle test --tests 'all.in.specific.package*.someSpecificMethod'

gradle test --tests '*IntegTest'

gradle test --tests '*IntegTest*ui*'

gradle test --tests '*ParameterizedTest.foo*'

# the second iteration of a parameterized test
gradle test --tests '*ParameterizedTest.*[2]'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the wildcard '*' has no special understanding of the '.' package separator. It&#8217;s purely text based. So <code>--tests *.SomeTestClass</code> will match any package, regardless of its 'depth'.</p>
</div>
<div class="paragraph">
<p>You can also combine filters defined at the command line with <a href="#sec:continuous_build">continuous build</a> to re-execute a subset of tests immediately after every change to a production or test source file. The following executes all tests in the 'com.mypackage.foo' package or subpackages whenever a change triggers the tests to run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">gradle test --continuous --tests "com.mypackage.foo.*"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="test_reporting"><a class="anchor" href="#test_reporting"></a><a class="link" href="#test_reporting">Test reporting</a></h4>
<div class="paragraph">
<p>The <code>Test</code> task generates the following results by default:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An HTML test report</p>
</li>
<li>
<p>XML test results in a format compatible with the Ant JUnit report task one that is supported by many other tools, such as CI servers</p>
</li>
<li>
<p>An efficient binary format of the results used by the <code>Test</code> task to generate the other formats</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, you&#8217;ll work with the standard HTML report, which automatically includes the results from <em>all</em> your <code>Test</code> tasks, even the ones you explicitly add to the build yourself. For example, if you add a <code>Test</code> task for integration tests, the report will include the results of both the unit tests and the integration tests if both tasks are run.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To aggregate test results across multiple subprojects, see the <a href="test_report_aggregation_plugin.html#test_report_aggregation_plugin">Test Report Aggregation Plugin</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unlike with many of the testing configuration options, there are several project-level convention properties that affect the test reports. For example, you can change the destination of the test results and reports like so:</p>
</div>
<div id="ex-changing-the-default-test-report-and-results-directories" class="exampleblock">
<div class="title">Example 68. <a href="#ex-changing-the-default-test-report-and-results-directories">Changing the default test report and results directories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">reporting.baseDirectory = file("my-reports")
java.testResultsDir = layout.buildDirectory.dir("my-test-results")

tasks.register("showDirs") {
    val settingsDir = project.layout.settingsDirectory.asFile
    val reportsDir = project.reporting.baseDirectory
    val testResultsDir = project.java.testResultsDir

    doLast {
        logger.quiet(settingsDir.toPath().relativize(reportsDir.get().asFile.toPath()).toString())
        logger.quiet(settingsDir.toPath().relativize(testResultsDir.get().asFile.toPath()).toString())
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">reporting.baseDirectory = file("my-reports")
java.testResultsDir = layout.buildDirectory.dir("my-test-results")

tasks.register('showDirs') {
    def settingsDir = project.layout.settingsDirectory.asFile
    def reportsDir = project.reporting.baseDirectory
    def testResultsDir = project.java.testResultsDir

    doLast {
        logger.quiet(settingsDir.toPath().relativize(reportsDir.get().asFile.toPath()).toString())
        logger.quiet(settingsDir.toPath().relativize(testResultsDir.get().asFile.toPath()).toString())
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q showDirs</code></strong></div>
<div class="content">
<pre>&gt; gradle -q showDirs
my-reports
build/my-test-results</pre>
</div>
</div>
<div class="paragraph">
<p>Follow the link to the convention properties for more details.</p>
</div>
<div class="paragraph">
<p>There is also a standalone <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.TestReport.html">TestReport</a> task type that you can use to generate a custom HTML test report. All it requires are a value for <code>destinationDir</code> and the test results you want included in the report. Here is a sample which generates a combined report for the unit tests from all subprojects:</p>
</div>
<div id="ex-creating-a-unit-test-report-for-subprojects" class="exampleblock">
<div class="title">Example 69. <a href="#ex-creating-a-unit-test-report-for-subprojects">Creating a unit test report for subprojects</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/myproject.java-conventions.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java")
}

// Disable the test report for the individual test task
tasks.named&lt;Test&gt;("test") {
    reports.html.required = false
}

// Share the test report data to be aggregated for the whole project
configurations.create("binaryTestResultsElements") {
    isCanBeResolved = false
    isCanBeConsumed = true
    attributes {
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.DOCUMENTATION))
        attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named("test-report-data"))
    }
    outgoing.artifact(tasks.test.map { task -&gt; task.getBinaryResultsDirectory().get() })
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val testReportData by configurations.creating {
    isCanBeConsumed = false
    attributes {
        attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.DOCUMENTATION))
        attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named("test-report-data"))
    }
}

dependencies {
    testReportData(project(":core"))
    testReportData(project(":util"))
}

tasks.register&lt;TestReport&gt;("testReport") {
    destinationDirectory = reporting.baseDirectory.dir("allTests")
    // Use test results from testReportData configuration
    testResults.from(testReportData)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/myproject.java-conventions.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

// Disable the test report for the individual test task
test {
    reports.html.required = false
}

// Share the test report data to be aggregated for the whole project
configurations {
    binaryTestResultsElements {
        canBeResolved = false
        canBeConsumed = true
        attributes {
            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.DOCUMENTATION))
            attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named(DocsType, 'test-report-data'))
        }
        outgoing.artifact(test.binaryResultsDirectory)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">// A resolvable configuration to collect test reports data
configurations {
    testReportData {
        canBeConsumed = false
        attributes {
            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.DOCUMENTATION))
            attribute(DocsType.DOCS_TYPE_ATTRIBUTE, objects.named(DocsType, 'test-report-data'))
        }
    }
}

dependencies {
    testReportData project(':core')
    testReportData project(':util')
}

tasks.register('testReport', TestReport) {
    destinationDirectory = reporting.baseDirectory.dir('allTests')
    // Use test results from testReportData configuration
    testResults.from(configurations.testReportData)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, we use a convention plugin <code>myproject.java-conventions</code> to expose the test results from a project to Gradle&#8217;s <a href="variant_aware_resolution.html#sec:understanding-variant-selection">variant aware dependency management engine</a>.</p>
</div>
<div class="paragraph">
<p>The plugin declares a consumable <code>binaryTestResultsElements</code> configuration that represents the binary test results of the <code>test</code> task.
In the aggregation project&#8217;s build file, we declare the <code>testReportData</code> configuration and depend on all of the projects that we want to aggregate the results from. Gradle will automatically select the binary test result variant from each of the subprojects instead of the project&#8217;s jar file.
Lastly, we add a <code>testReport</code> task that aggregates the test results from the <code>testResultsDirs</code> property, which contains all of the binary test results resolved from the <code>testReportData</code> configuration.</p>
</div>
<div class="paragraph">
<p>You should note that the <code>TestReport</code> type combines the results from multiple test tasks and needs to aggregate the results of individual test classes. This means that if a given test class is executed by multiple test tasks, then the test report will include executions of that class, but it can be hard to distinguish individual executions of that class and their output.</p>
</div>
<div class="sect4">
<h5 id="communicating_test_results_to_CI_servers_and_other_tools_via_xml_files"><a class="anchor" href="#communicating_test_results_to_CI_servers_and_other_tools_via_xml_files"></a><a class="link" href="#communicating_test_results_to_CI_servers_and_other_tools_via_xml_files">Communicating test results to CI servers and other tools via XML files</a></h5>
<div class="paragraph">
<p>The Test tasks creates XML files describing the test results, in the "JUnit XML" pseudo standard.
This standard is used by the JUnit 4, JUnit Jupiter, and TestNG test frameworks, and is configured using the same DSL block for each of these.
It is common for CI servers and other tooling to observe test results via these XML files.</p>
</div>
<div class="paragraph">
<p>By default, the files are written to <code>layout.buildDirectory.dir("test-results/$testTaskName")</code> with a file per test class.
The location can be changed for all test tasks of a project, or individually per test task.</p>
</div>
<div id="ex-changing-junit-xml-results-location-for-all-test-tasks" class="exampleblock">
<div class="title">Example 70. <a href="#ex-changing-junit-xml-results-location-for-all-test-tasks">Changing JUnit XML results location for all test tasks</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java.testResultsDir = layout.buildDirectory.dir("junit-xml")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java.testResultsDir = layout.buildDirectory.dir("junit-xml")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With the above configuration, the XML files will be written to <code>layout.buildDirectory.dir("junit-xml/$testTaskName")</code>.</p>
</div>
<div id="ex-changing-junit-xml-results-location-for-a-particular-test-task" class="exampleblock">
<div class="title">Example 71. <a href="#ex-changing-junit-xml-results-location-for-a-particular-test-task">Changing JUnit XML results location for a particular test task</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    reports {
        junitXml.outputLocation = layout.buildDirectory.dir("test-junit-xml")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    reports {
        junitXml.outputLocation = layout.buildDirectory.dir("test-junit-xml")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With the above configuration, the XML files for the <code>test</code> task will be written to <code>layout.buildDirectory.dir("test-results/test-junit-xml")</code>.
The location of the XML files for other test tasks will be unchanged.</p>
</div>
<div class="sect5">
<h6 id="junit_xml_configuration"><a class="anchor" href="#junit_xml_configuration"></a><a class="link" href="#junit_xml_configuration">Configuration options</a></h6>
<div class="paragraph">
<p>The content of the XML files can also be configured to convey the results differently, by configuring the
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/JUnitXmlReport.html">JUnitXmlReport</a> options.</p>
</div>
<div id="ex-configuring-how-the-results-are-conveyed" class="exampleblock">
<div class="title">Example 72. <a href="#ex-configuring-how-the-results-are-conveyed">Configuring how the results are conveyed</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    reports {
        junitXml.apply {
            includeSystemOutLog = false // defaults to true
            includeSystemErrLog = false // defaults to true
            isOutputPerTestCase = true // defaults to false
            mergeReruns = true // defaults to false
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    reports {
        junitXml {
            includeSystemOutLog = false // defaults to true
            includeSystemErrLog = false // defaults to true
            outputPerTestCase = true // defaults to false
            mergeReruns = true // defaults to false
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="junit_xml_configuration_output_filtering"><a class="anchor" href="#junit_xml_configuration_output_filtering"></a><a class="link" href="#junit_xml_configuration_output_filtering">includeSystemOutLog &amp; includeSystemErrLog</a></h7>
<div class="paragraph">
<p>The <code>includeSystemOutLog</code> option allows configuring whether or not test output written to standard out is exported to the XML report file.
The <code>includeSystemErrLog</code> option allows configuring whether or not test error output written to standard error is exported to the XML report file.</p>
</div>
<div class="paragraph">
<p>These options affect both test-suite level output (such as <code>@BeforeClass</code>/<code>@BeforeAll</code> output) and test class and method-specific output (<code>@Before</code>/<code>@BeforeEach</code> and <code>@Test</code>).
If either option is disabled, the element that normally contains that content will be excluded from the XML report file.</p>
</div>
<div class="paragraph">
<p>The default for each option is <code>true</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="outputpertestcase"><a class="anchor" href="#outputpertestcase"></a><a class="link" href="#outputpertestcase">outputPerTestCase</a></h7>
<div class="paragraph">
<p>The <code>outputPerTestCase</code> option, when enabled, associates any output logging generated during a test case to that test case in the results.
When disabled (the default) output is associated with the test class as whole and not the individual test cases (e.g. test methods) that produced the logging output.
Most modern tools that observe JUnit XML files support the "output per test case" format.</p>
</div>
<div class="paragraph">
<p>If you are using the XML files to communicate test results, it is recommended to enable this option as it provides more useful reporting.</p>
</div>
</div>
<div class="sect6">
<h7 id="mergereruns"><a class="anchor" href="#mergereruns"></a><a class="link" href="#mergereruns">mergeReruns</a></h7>
<div class="paragraph">
<p>When <code>mergeReruns</code> is enabled, if a test fails but is then retried and succeeds, its failures will be recorded as <code>&lt;flakyFailure&gt;</code> instead of <code>&lt;failure&gt;</code>, within one <code>&lt;testcase&gt;</code>.
This is effectively the reporting produced by the <a href="https://maven.apache.org/components/surefire/maven-surefire-plugin/examples/rerun-failing-tests.html">surefire plugin of Apache Maven</a> when enabling reruns.
If your CI server understands this format, it will indicate that the test was flaky.
If it does not, it will indicate that the test succeeded as it will ignore the <code>&lt;flakyFailure&gt;</code> information.
If the test does not succeed (i.e. it fails for every retry), it will be indicated as having failed whether your tool understands this format or not.</p>
</div>
<div class="paragraph">
<p>When <code>mergeReruns</code> is disabled (the default), each execution of a test will be listed as a separate test case.</p>
</div>
<div class="paragraph">
<p>If you are using <a href="https://scans.gradle.com">Build Scan</a> or <a href="https://gradle.com/gradle-enterprise-solution-overview/failure-analytics/">Develocity</a>,
flaky tests will be detected regardless of this setting.</p>
</div>
<div class="paragraph">
<p>Enabling this option is especially useful when using a CI tool that uses the XML test results to determine build failure instead of relying on Gradle&#8217;s determination of whether the build failed or not,
and you wish to not consider the build failed if all failed tests passed when retried.
This is the case for the Jenkins CI server and its <a href="https://plugins.jenkins.io/junit/">JUnit plugin</a>.
With <code>mergeReruns</code> enabled, tests that pass-on-retry will no longer cause this Jenkins plugin to consider the build to have failed.
However, failed test executions will be omitted from the Jenkins test result visualizations as it does not consider <code>&lt;flakyFailure&gt;</code> information.
The separate <a href="https://plugins.jenkins.io/flaky-test-handler">Flaky Test Handler Jenkins plugin</a> can be used in addition to the JUnit Jenkins plugin to have such "flaky failures" also be visualized.</p>
</div>
<div class="paragraph">
<p>Tests are grouped and merged based on their reported name.
When using any kind of test parameterization that affects the reported test name,
or any other kind of mechanism that produces a potentially dynamic test name,
care should be taken to ensure that the test name is stable and does not unnecessarily change.</p>
</div>
<div class="paragraph">
<p>Enabling the <code>mergeReruns</code> option does not add any retry/rerun functionality to test execution.
Rerunning can be enabled by the test execution framework (e.g. JUnit&#8217;s <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-repeated-tests">@RepeatedTest</a>),
or via the separate <a href="https://github.com/gradle/test-retry-gradle-plugin">Test Retry Gradle plugin</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:test_detection"><a class="anchor" href="#sec:test_detection"></a><a class="link" href="#sec:test_detection">Test detection</a></h4>
<div class="paragraph">
<p>By default, Gradle will run all tests that it detects, which it does by inspecting the compiled test classes. This detection uses different criteria depending on the test framework used.</p>
</div>
<div class="paragraph">
<p>For <em>JUnit</em>, Gradle scans for both JUnit 3 and 4 test classes. A class is considered to be a JUnit test if it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ultimately inherits from <code>TestCase</code> or <code>GroovyTestCase</code></p>
</li>
<li>
<p>Is annotated with <code>@RunWith</code></p>
</li>
<li>
<p>Contains a method annotated with <code>@Test</code> or a super class does</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <em>TestNG</em>, Gradle scans for methods annotated with <code>@Test</code>.</p>
</div>
<div class="paragraph">
<p>Note that abstract classes are not executed. In addition, be aware that Gradle scans up the inheritance tree into jar files on the test classpath. So if those JARs contain test classes, they will also be run.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want to use test class detection, you can disable it by setting the <code>scanForTestClasses</code> property on <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html">Test</a> to <code>false</code>. When you do that, the test task uses only the <code>includes</code> and <code>excludes</code> properties to find test classes.</p>
</div>
<div class="paragraph">
<p>If <code>scanForTestClasses</code> is false and no include or exclude patterns are specified, Gradle defaults to running any class that matches the patterns <code>**/*Tests.class</code> and <code>**/*Test.class</code>, excluding those that match <code>**/Abstract*.class</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
With <a href="http://junit.org/junit5/docs/current/user-guide">JUnit Platform</a>, only <code>includes</code> and <code>excludes</code> are used to filter test classes  <code>scanForTestClasses</code> has no effect.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:test_logging"><a class="anchor" href="#sec:test_logging"></a><a class="link" href="#sec:test_logging">Test logging</a></h4>
<div class="paragraph">
<p>Gradle allows fine-tuned control over events that are logged to the console.
Logging is configurable on a per-log-level basis and by default, the following events are logged:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the log level is</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events that are logged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ERROR</code>, <code>QUIET</code> or <code>WARNING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html#FAILED">Test failures</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception format is <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestExceptionFormat.html#SHORT">SHORT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INFO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html#FAILED">Test failures</a>, <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html#SKIPPED">skipped tests</a>, <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html#STANDARD_OUT">test standard output</a> and <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html#STANDARD_ERROR">test standard error</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stacktraces are truncated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEBUG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogEvent.html">All events</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full stacktraces are logged.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Test logging can be modified on a per-log-level basis by adjusting the appropriate <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLogging.html">TestLogging</a> instances in the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/AbstractTestTask.html#getTestLogging--">testLogging</a> property of the test task.
For example, to adjust the <code>INFO</code> level test logging configuration, modify the
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/logging/TestLoggingContainer.html#getInfo--">TestLoggingContainer.getInfo()</a> property.</p>
</div>
</div>
<div class="sect3">
<h4 id="test_grouping"><a class="anchor" href="#test_grouping"></a><a class="link" href="#test_grouping">Test grouping</a></h4>
<div class="paragraph">
<p>JUnit, JUnit Platform and TestNG allow sophisticated groupings of test methods.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This section applies to grouping individual test classes or methods within a collection of tests that serve the same testing purpose (unit tests, integration tests, acceptance tests, etc.).
For dividing test classes based upon their purpose, see the incubating <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit 4.8 introduced the concept of categories for grouping JUnit 4 tests classes and methods.<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup> <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:useJUnit(org.gradle.api.Action)">Test.useJUnit(org.gradle.api.Action)</a> allows you to specify the JUnit categories you want to include and exclude. For example, the following configuration includes tests in <code>CategoryA</code> and excludes those in <code>CategoryB</code> for the <code>test</code> task:</p>
</div>
<div id="ex-junit-categories" class="exampleblock">
<div class="title">Example 73. <a href="#ex-junit-categories">JUnit Categories</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    useJUnit {
        includeCategories("org.gradle.junit.CategoryA")
        excludeCategories("org.gradle.junit.CategoryB")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    useJUnit {
        includeCategories 'org.gradle.junit.CategoryA'
        excludeCategories 'org.gradle.junit.CategoryB'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="http://junit.org/junit5/docs/current/user-guide">JUnit Platform</a> introduced <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-tagging-and-filtering">tagging</a> to replace categories. You can specify the included/excluded tags via <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform-org.gradle.api.Action-">Test.useJUnitPlatform(org.gradle.api.Action)</a>, as follows:</p>
</div>
<div id="ex-junit-platform-tags" class="exampleblock">
<div class="title">Example 74. <a href="#ex-junit-platform-tags">JUnit Platform Tags</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    useJUnitPlatform {
        includeTags("fast")
        excludeTags("slow")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    useJUnitPlatform {
        includeTags 'fast'
        excludeTags 'slow'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The TestNG framework uses the concept of test groups for a similar effect.<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup> You can configure which test groups to include or exclude during the test execution via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:useTestNG(org.gradle.api.Action)">Test.useTestNG(org.gradle.api.Action)</a> setting, as seen here:</p>
</div>
<div id="ex-grouping-testng-tests" class="exampleblock">
<div class="title">Example 75. <a href="#ex-grouping-testng-tests">Grouping TestNG tests</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;Test&gt;("test") {
    useTestNG {
        val options = this as TestNGOptions
        options.excludeGroups("integrationTests")
        options.includeGroups("unitTests")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    useTestNG {
        excludeGroups 'integrationTests'
        includeGroups 'unitTests'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using_junit5"><a class="anchor" href="#using_junit5"></a><a class="link" href="#using_junit5">Using JUnit 5</a></h4>
<div class="paragraph">
<p><a href="http://junit.org/junit5">JUnit 5</a> is the latest version of the well-known JUnit test framework.
Unlike its predecessor, JUnit 5 is modularized and composed of several modules:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</pre>
</div>
</div>
<div class="paragraph">
<p>The JUnit Platform serves as a foundation for launching testing frameworks on the JVM. JUnit Jupiter is the combination of the new <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests">programming model</a>
 and <a href="http://junit.org/junit5/docs/current/user-guide/#extensions">extension model</a> for writing tests and extensions in JUnit 5. JUnit Vintage provides a <code>TestEngine</code> for running JUnit 3 and JUnit 4 based tests on the platform.</p>
</div>
<div class="paragraph">
<p>The following code enables JUnit Platform support in <code>build.gradle</code>:</p>
</div>
<div id="ex-enabling-junit-platform-to-run-your-tests" class="exampleblock">
<div class="title">Example 76. <a href="#ex-enabling-junit-platform-to-run-your-tests">Enabling JUnit Platform to run your tests</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.named&lt;Test&gt;("test") {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('test', Test) {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform--">Test.useJUnitPlatform()</a> for more details.</p>
</div>
<div class="sect4">
<h5 id="compiling_and_executing_junit_jupiter_tests"><a class="anchor" href="#compiling_and_executing_junit_jupiter_tests"></a><a class="link" href="#compiling_and_executing_junit_jupiter_tests">Compiling and executing JUnit Jupiter tests</a></h5>
<div class="paragraph">
<p>To enable JUnit Jupiter support in Gradle, all you need to do is add the following dependency:</p>
</div>
<div id="ex-junit-jupiter-dependencies" class="exampleblock">
<div class="title">Example 77. <a href="#ex-junit-jupiter-dependencies">JUnit Jupiter dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter:5.7.1'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can then put your test cases into <em>src/test/java</em> as normal and execute them with <code>gradle test</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="executing_legacy_tests_with_junit_vintage"><a class="anchor" href="#executing_legacy_tests_with_junit_vintage"></a><a class="link" href="#executing_legacy_tests_with_junit_vintage">Executing legacy tests with JUnit Vintage</a></h5>
<div class="paragraph">
<p>If you want to run JUnit 3/4 tests on JUnit Platform, or even mix them with Jupiter tests, you should add extra JUnit Vintage Engine dependencies:</p>
</div>
<div id="ex-junit-vintage-dependencies" class="exampleblock">
<div class="title">Example 78. <a href="#ex-junit-vintage-dependencies">JUnit Vintage dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    testCompileOnly("junit:junit:4.13")
    testRuntimeOnly("org.junit.vintage:junit-vintage-engine")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter:5.7.1'
    testCompileOnly 'junit:junit:4.13'
    testRuntimeOnly 'org.junit.vintage:junit-vintage-engine'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this way, you can use <code>gradle test</code> to test JUnit 3/4 tests on JUnit Platform, without the need to rewrite them.</p>
</div>
</div>
<div class="sect4">
<h5 id="filtering_test_engine"><a class="anchor" href="#filtering_test_engine"></a><a class="link" href="#filtering_test_engine">Filtering test engine</a></h5>
<div class="paragraph">
<p>JUnit Platform allows you to use different test engines. JUnit currently provides two <code>TestEngine</code> implementations out of the box:
<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.engine/module-summary.html">junit-jupiter-engine</a> and <a href="https://junit.org/junit5/docs/current/api/org.junit.vintage.engine/module-summary.html">junit-vintage-engine</a>.
You can also write and plug in your own <code>TestEngine</code> implementation as documented <a href="https://junit.org/junit5/docs/current/user-guide/#launcher-api-engines-custom">here</a>.</p>
</div>
<div class="paragraph">
<p>By default, all test engines on the test runtime classpath will be used.
To control specific test engine implementations explicitly, you can add the following setting to your build script:</p>
</div>
<div id="ex-filter-specific-engines" class="exampleblock">
<div class="title">Example 79. <a href="#ex-filter-specific-engines">Filter specific engines</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;Test&gt;().configureEach {
    useJUnitPlatform {
        includeEngines("junit-vintage")
        // excludeEngines("junit-jupiter")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(Test).configureEach {
    useJUnitPlatform {
        includeEngines 'junit-vintage'
        // excludeEngines 'junit-jupiter'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="test_execution_order"><a class="anchor" href="#test_execution_order"></a><a class="link" href="#test_execution_order">Test execution order in TestNG</a></h4>
<div class="paragraph">
<p>TestNG allows explicit control of the execution order of tests when you use a <em>testng.xml</em> file. Without such a file  or an equivalent one configured by <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html#getSuiteXmlBuilder--">TestNGOptions.getSuiteXmlBuilder()</a>  you can&#8217;t specify the test execution order. However, what you <em>can</em> do is control whether all aspects of a test  including its associated <code>@BeforeXXX</code> and <code>@AfterXXX</code> methods, such as those annotated with <code>@Before/AfterClass</code> and <code>@Before/AfterMethod</code>are executed before the next test starts. You do this by setting the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html#getPreserveOrder--">TestNGOptions.getPreserveOrder()</a> property to <code>true</code>. If you set it to <code>false</code>, you may encounter scenarios in which the execution order is something like: <code>TestA.doBeforeClass()</code> &#8594; <code>TestB.doBeforeClass()</code> &#8594; <code>TestA</code> tests.</p>
</div>
<div class="paragraph">
<p>While preserving the order of tests is the default behavior when directly working with <em>testng.xml</em> files, the <a href="https://jitpack.io/com/github/cbeust/testng/master/javadoc/org/testng/TestNG.html">TestNG API</a> that is used by Gradle&#8217;s TestNG integration executes tests in unpredictable order by default.<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup> The ability to preserve test execution order was introduced with TestNG version 5.14.5. Setting the <code>preserveOrder</code> property to <code>true</code> for an older TestNG version will cause the build to fail.</p>
</div>
<div id="ex-preserving-order-of-testng-tests" class="exampleblock">
<div class="title">Example 80. <a href="#ex-preserving-order-of-testng-tests">Preserving order of TestNG tests</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    useTestNG {
        preserveOrder = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    useTestNG {
        preserveOrder = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>groupByInstance</code> property controls whether tests should be grouped by instance rather than by class. The <a href="http://testng.org/doc/documentation-main.html#dependencies-with-annotations">TestNG documentation</a> explains the difference in more detail, but essentially, if you have a test method <code>A()</code> that depends on <code>B()</code>, grouping by instance ensures that each A-B pairing, e.g. <code>B(1)</code>-<code>A(1)</code>, is executed before the next pairing. With group by class, all <code>B()</code> methods are run and then all <code>A()</code> ones.</p>
</div>
<div class="paragraph">
<p>Note that you typically only have more than one instance of a test if you&#8217;re using a data provider to parameterize it. Also, grouping tests by instances was introduced with TestNG version 6.1. Setting the <code>groupByInstances</code> property to <code>true</code> for an older TestNG version will cause the build to fail.</p>
</div>
<div id="ex-grouping-testng-tests-by-instances" class="exampleblock">
<div class="title">Example 81. <a href="#ex-grouping-testng-tests-by-instances">Grouping TestNG tests by instances</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    useTestNG {
        groupByInstances = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">test {
    useTestNG {
        groupByInstances = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="testNgParameterizedReporting"><a class="anchor" href="#testNgParameterizedReporting"></a><a class="link" href="#testNgParameterizedReporting">TestNG parameterized methods and reporting</a></h5>
<div class="paragraph">
<p>TestNG supports <a href="http://testng.org/doc/documentation-main.html#parameters">parameterizing test methods</a>, allowing a particular test method to be executed multiple times with different inputs. Gradle includes the parameter values in its reporting of the test method execution.</p>
</div>
<div class="paragraph">
<p>Given a parameterized test method named <code>aTestMethod</code> that takes two parameters, it will be reported with the name <code>aTestMethod(toStringValueOfParam1, toStringValueOfParam2)</code>. This makes it easy to identify the parameter values for a particular iteration.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_java_integration_tests"><a class="anchor" href="#sec:configuring_java_integration_tests"></a><a class="link" href="#sec:configuring_java_integration_tests">Configuring integration tests</a></h4>
<div class="paragraph">
<p>A common requirement for projects is to incorporate integration tests in one form or another.
Their aim is to verify that the various parts of the project are working together properly.
This often means that they require special execution setup and dependencies compared to unit tests.</p>
</div>
<div class="paragraph">
<p>The simplest way to add integration tests to your build is by leveraging the incubating <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin.
If an incubating solution is not something for you, here are the steps you need to take in your build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new <a href="#sec:java_source_sets">source set</a> for them</p>
</li>
<li>
<p>Add the dependencies you need to the appropriate configurations for that source set</p>
</li>
<li>
<p>Configure the compilation and runtime classpaths for that source set</p>
</li>
<li>
<p>Create a task to run the integration tests</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You may also need to perform some additional configuration depending on what form the integration tests take. We will discuss those as we go.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a practical example that implements the first three steps in a build script, centered around a new source set <code>intTest</code>:</p>
</div>
<div id="ex-setting-up-working-integration-tests" class="exampleblock">
<div class="title">Example 82. <a href="#ex-setting-up-working-integration-tests">Setting up working integration tests</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    create("intTest") {
        compileClasspath += sourceSets.main.get().output
        runtimeClasspath += sourceSets.main.get().output
    }
}

val intTestImplementation by configurations.getting {
    extendsFrom(configurations.implementation.get())
}
val intTestRuntimeOnly by configurations.getting

configurations["intTestRuntimeOnly"].extendsFrom(configurations.runtimeOnly.get())

dependencies {
    intTestImplementation("org.junit.jupiter:junit-jupiter:5.7.1")
    intTestRuntimeOnly("org.junit.platform:junit-platform-launcher")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sourceSets {
    intTest {
        compileClasspath += sourceSets.main.output
        runtimeClasspath += sourceSets.main.output
    }
}

configurations {
    intTestImplementation.extendsFrom implementation
    intTestRuntimeOnly.extendsFrom runtimeOnly
}

dependencies {
    intTestImplementation 'org.junit.jupiter:junit-jupiter:5.7.1'
    intTestRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will set up a new source set called <code>intTest</code> that automatically creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>intTestImplementation</code>, <code>intTestCompileOnly</code>, <code>intTestRuntimeOnly</code> configurations (and <a href="java_plugin.html#java_source_set_configurations">a few others</a> that are less commonly needed)</p>
</li>
<li>
<p>A <code>compileIntTestJava</code> task that will compile all the source files under <em>src/intTest/java</em></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are working with the IntelliJ IDE, you may wish to flag the directories in these additional source sets as containing test source rather than production source as explained in the <a href="idea_plugin.html#sec:idea_identify_additional_source_sets">Idea Plugin</a> documentation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example also does the following, not all of which you may need for your specific integration tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds the production classes from the <code>main</code> source set to the compilation and runtime classpaths of the integration tests  <code>sourceSets.main.output</code> is a <a href="#sec:file_collections">file collection</a> of all the directories containing compiled production classes and resources</p>
</li>
<li>
<p>Makes the <code>intTestImplementation</code> configuration extend from <code>implementation</code>, which means that all the declared dependencies of the production code also become dependencies of the integration tests</p>
</li>
<li>
<p>Does the same for the <code>intTestRuntimeOnly</code> configuration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, you want your integration tests to have access to the classes under test, which is why we ensure that those are included on the compilation and runtime classpaths in this example. But some types of test interact with the production code in a different way. For example, you may have tests that run your application as an executable and verify the output. In the case of web applications, the tests may interact with your application via HTTP. Since the tests don&#8217;t need direct access to the classes under test in such cases, you don&#8217;t need to add the production classes to the test classpath.</p>
</div>
<div class="paragraph">
<p>Another common step is to attach all the unit test dependencies to the integration tests as well  via <code>intTestImplementation.extendsFrom testImplementation</code>  but that only makes sense if the integration tests require <em>all</em> or nearly all the same dependencies that the unit tests have.</p>
</div>
<div class="paragraph">
<p>There are a couple of other facets of the example you should take note of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>+=</code> allows you to append paths and collections of paths to <code>compileClasspath</code> and <code>runtimeClasspath</code> instead of overwriting them</p>
</li>
<li>
<p>If you want to use the convention-based configurations, such as <code>intTestImplementation</code>, you <em>must</em> declare the dependencies <em>after</em> the new source set</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creating and configuring a source set automatically sets up the compilation stage, but it does nothing with respect to running the integration tests. So the last piece of the puzzle is a custom test task that uses the information from the new source set to configure its runtime classpath and the test classes:</p>
</div>
<div id="ex-defining-a-working-integration-test-task" class="exampleblock">
<div class="title">Example 83. <a href="#ex-defining-a-working-integration-test-task">Defining a working integration test task</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val integrationTest = task&lt;Test&gt;("integrationTest") {
    description = "Runs integration tests."
    group = "verification"

    testClassesDirs = sourceSets["intTest"].output.classesDirs
    classpath = sourceSets["intTest"].runtimeClasspath
    shouldRunAfter("test")

    useJUnitPlatform()

    testLogging {
        events("passed")
    }
}

tasks.check { dependsOn(integrationTest) }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('integrationTest', Test) {
    description = 'Runs integration tests.'
    group = 'verification'

    testClassesDirs = sourceSets.intTest.output.classesDirs
    classpath = sourceSets.intTest.runtimeClasspath
    shouldRunAfter test

    useJUnitPlatform()

    testLogging {
        events "passed"
    }
}

check.dependsOn integrationTest</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Again, we&#8217;re accessing a source set to get the relevant information, i.e. where the compiled test classes are the <code>testClassesDirs</code> property and what needs to be on the classpath when running them <code>classpath</code>.</p>
</div>
<div class="paragraph">
<p>Users commonly want to run integration tests after the unit tests, because they are often slower to run and you want the build to fail early on the unit tests rather than later on the integration tests. That&#8217;s why the above example adds a <code>shouldRunAfter()</code> declaration. This is preferred over <code>mustRunAfter()</code> so that Gradle has more flexibility in executing the build in parallel.</p>
</div>
<div class="paragraph">
<p>For information on how to determine code coverage for tests in additional source sets, see the <a href="jacoco_plugin.html#jacoco_plugin">JaCoCo Plugin</a> and the <a href="jacoco_report_aggregation_plugin.html#jacoco_report_aggregation_plugin">JaCoCo Report Aggregation Plugin</a> chapters.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_testing_troubleshooting"><a class="anchor" href="#sec:java_testing_troubleshooting"></a><a class="link" href="#sec:java_testing_troubleshooting">Troubleshooting common problems</a></h4>
<div class="sect4">
<h5 id="test_process_starts_but_test_dependencies_are_missing"><a class="anchor" href="#test_process_starts_but_test_dependencies_are_missing"></a><a class="link" href="#test_process_starts_but_test_dependencies_are_missing">Test process starts but test dependencies are missing</a></h5>
<div class="paragraph">
<p>Once the test process starts, it may fail to find its required dependencies if they are missing from the test runtime classpath.</p>
</div>
<div class="paragraph">
<p>Test dependencies need to be declared on the appropriate configuration.
The <a href="jvm_test_suite_plugin.html#jvm_test_suite_plugin">JVM Test Suite</a> plugin automatically configures all necessary dependencies, but if you are manually creating a <code>Test</code> task or using the built-in <code>test</code> task, you need to ensure that all required dependencies are declared on the appropriate configuration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For JUnit Jupiter-based tests, you need to declare dependencies on the JUnit Jupiter, JUnit Platform and JUnit Platform launcher libraries.</p>
</li>
<li>
<p>For JUnit4-based tests, you need to declare a dependency on a single JUnit 4.x library.</p>
</li>
<li>
<p>For TestNG-based tests, you need to declare a dependency on a single TestNG library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Prior to Gradle 9.0.0, Gradle <a href="upgrading_version_8.html#test_framework_implementation_dependencies">leaked internal dependencies</a> into the test&#8217;s runtime classpath which may have masked missing dependencies.</p>
</div>
</div>
<div class="sect4">
<h5 id="tests_are_not_detected_or_executed"><a class="anchor" href="#tests_are_not_detected_or_executed"></a><a class="link" href="#tests_are_not_detected_or_executed">Tests are not detected or executed</a></h5>
<div class="paragraph">
<p>If no tests are detected, Gradle will skip the <code>Test</code> task entirely.</p>
</div>
<div class="paragraph">
<p>This can occur for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No test sources exist. This is expected behavior for empty test suites.</p>
</li>
<li>
<p>Test sources exist but are not compiled. This may happen if:</p>
<div class="ulist">
<ul>
<li>
<p>The source files are located in the wrong directory.</p>
</li>
<li>
<p>The source set is not configured correctly.</p>
</li>
</ul>
</div>
</li>
<li>
<p>No test classes are configured on the <code>Test</code> task. By default, only the built-in <code>Test</code> task is automatically configured to use the test source set.
If you&#8217;re using a custom <code>Test</code> task, you must manually configure both <code>testClassesDirs</code> and <code>classpath</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Prior to Gradle 9.0.0, all <code>Test</code> tasks were <a href="upgrading_version_8.html#test_task_default_classpath">implicitly configured</a> to use the <code>test</code> source set.</p>
</div>
</div>
<div class="sect4">
<h5 id="test_process_fails_to_start_or_stay_running"><a class="anchor" href="#test_process_fails_to_start_or_stay_running"></a><a class="link" href="#test_process_fails_to_start_or_stay_running">Test process fails to start or stay running</a></h5>
<div class="paragraph">
<p>The test process may fail to start if configured incorrectly.
For instance, if the Java executable does not exist or an invalid JVM argument is provided, the test process will fail to start.</p>
</div>
<div class="paragraph">
<p>Similarly, if a test requires changes to the environment that are not compatible with Gradle&#8217;s test worker process, the test process may fail to start.
For example, tests that rely on modifying the <a href="https://docs.oracle.com/javase/8/docs/api//java/lang/SecurityManager.html"><code>SecurityManager</code></a> may interfere with Gradle&#8217;s internal messaging communication between the build and test worker.</p>
</div>
</div>
<div class="sect4">
<h5 id="test_process_fails_with_unusual_exit_code"><a class="anchor" href="#test_process_fails_with_unusual_exit_code"></a><a class="link" href="#test_process_fails_with_unusual_exit_code">Test process fails with unusual exit code</a></h5>
<div class="paragraph">
<p>The test process can exit with an unusual exit code (non-zero).</p>
</div>
<div class="paragraph">
<p>This can be caused by a variety of issues, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A test calls <code>System.exit()</code> directly.</p>
</li>
<li>
<p>Too many processes are running which causes the OS to kill the test process.</p>
</li>
<li>
<p>The test process runs out of memory.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_testing_modular"><a class="anchor" href="#sec:java_testing_modular"></a><a class="link" href="#sec:java_testing_modular">Testing Java Modules</a></h4>
<div class="paragraph">
<p>If you are <a href="#java_library_plugin">developing Java Modules</a>, everything described in this chapter still applies and any of the supported test frameworks can be used.
However, there are some things to consider depending on whether you need module information to be available, and module boundaries to be enforced, during test execution.
In this context, the terms <em>whitebox testing</em> (module boundaries are deactivated or relaxed) and <em>blackbox testing</em> (module boundaries are in place) are often used.
Whitebox testing is used/needed for unit testing and blackbox testing fits functional or integration test requirements.</p>
</div>
<div class="paragraph">
<p>Sample: <a href="../samples/sample_java_modules_multi_project_with_integration_tests.html">Java Modules multi-project with integration tests</a></p>
</div>
<div class="sect4">
<h5 id="whitebox_unit_test_execution_on_the_classpath"><a class="anchor" href="#whitebox_unit_test_execution_on_the_classpath"></a><a class="link" href="#whitebox_unit_test_execution_on_the_classpath">Whitebox unit test execution on the classpath</a></h5>
<div class="paragraph">
<p>The simplest setup to write unit tests for functions or classes in modules is to <em>not</em> use module specifics during test execution.
For this, you just need to write tests the same way you would write them for normal libraries.
If you don&#8217;t have a <code>module-info.java</code> file in your test source set (<code>src/test/java</code>) this source set will be considered as traditional Java library during compilation and test runtime.
This means, all dependencies, including Jars with module information, are put on the classpath.
The advantage is that all internal classes of your (or other) modules are then accessible directly in tests.
This may be a totally valid setup for unit testing, where we do not care about the larger module structure, but only about testing single functions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using Eclipse: By default, Eclipse also runs unit tests as modules using module patching (see <a href="#sec:java_testing_modular_patching">below</a>).
In an imported Gradle project, unit testing a module with the Eclipse test runner might fail.
You then need to manually adjust the classpath/module path in the test run configuration or delegate test execution to Gradle.</p>
</div>
<div class="paragraph">
<p>This only concerns the test execution.
Unit test compilation and development works fine in Eclipse.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="blackbox_integration_testing"><a class="anchor" href="#blackbox_integration_testing"></a><a class="link" href="#blackbox_integration_testing">Blackbox integration testing</a></h5>
<div class="paragraph">
<p>For integration tests, you have the option to define the test set itself as additional module.
You do this similar to how you turn your main sources into a module:
by adding a <code>module-info.java</code> file to the corresponding source set (e.g. <code>integrationTests/java/module-info.java</code>).</p>
</div>
<div class="paragraph">
<p>You can find a full example that includes blackbox integration tests <a href="../samples/sample_java_modules_multi_project_with_integration_tests.html">here</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Eclipse, compiling multiple modules in one project is <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=520667">currently not support</a>.
Therefore the integration test (blackbox) setup described here only works in Eclipse if the tests are moved to a separate subproject.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_testing_modular_patching"><a class="anchor" href="#sec:java_testing_modular_patching"></a><a class="link" href="#sec:java_testing_modular_patching">Whitebox test execution with module patching</a></h5>
<div class="paragraph">
<p>Another approach for whitebox testing is to stay in the module world by <em>patching</em> the tests into the module under test.
This way, module boundaries stay in place, but the tests themselves become part of the module under test and can then access the module&#8217;s internals.</p>
</div>
<div class="paragraph">
<p>For which uses cases this is relevant and how this is best done is a topic of discussion.
There is no general best approach at the moment.
Thus, there is no special support for this in Gradle right now.</p>
</div>
<div class="paragraph">
<p>You can however, setup module patching for tests like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a <code>module-info.java</code> to your test source set that is a copy of the main <code>module-info.java</code> with additional dependencies needed for testing (e.g. <code>requires org.junit.jupiter.api</code>).</p>
</li>
<li>
<p>Configure both the <code>testCompileJava</code> and <code>test</code> tasks with arguments to patch the main classes with the test classes as shown below.</p>
</li>
</ul>
</div>
<div id="ex-patch-module-for-testing-using-command-line-arguments" class="exampleblock">
<div class="title">Example 84. <a href="#ex-patch-module-for-testing-using-command-line-arguments">Patch module for testing using command line arguments</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val moduleName = "org.gradle.sample"
val patchArgs = listOf("--patch-module", "$moduleName=${tasks.compileJava.get().destinationDirectory.asFile.get().path}")
tasks.compileTestJava {
    options.compilerArgs.addAll(patchArgs)
}
tasks.test {
    jvmArgs(patchArgs)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def moduleName = "org.gradle.sample"
def patchArgs = ["--patch-module", "$moduleName=${tasks.compileJava.destinationDirectory.asFile.get().path}"]
tasks.named('compileTestJava') {
    options.compilerArgs += patchArgs
}
tasks.named('test') {
    jvmArgs += patchArgs
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If custom arguments are used for patching, these are not picked up by Eclipse and IDEA.
You will most likely see invalid compilation errors in the IDE.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping_java_tests"><a class="anchor" href="#sec:skipping_java_tests"></a><a class="link" href="#sec:skipping_java_tests">Skipping the tests</a></h4>
<div class="paragraph">
<p>If you want to skip the tests when running a build, you have a few options. You can either do it via <a href="#sec:excluding_tasks_from_the_command_line">command line arguments</a> or <a href="#sec:skipping_tasks">in the build script</a>. To do it on the command line, you can use the <code>-x</code> or <code>--exclude-task</code> option like so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gradle build -x test</pre>
</div>
</div>
<div class="paragraph">
<p>This excludes the <code>test</code> task and any other task that it <em>exclusively</em> depends on, i.e. no other task depends on the same task. Those tasks will not be marked "SKIPPED" by Gradle, but will simply not appear in the list of tasks executed.</p>
</div>
<div class="paragraph">
<p>Skipping a test via the build script can be done a few ways. One common approach is to make test execution conditional via the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Task.html#org.gradle.api.Task:onlyIf(java.lang.String,org.gradle.api.specs.Spec)">Task.onlyIf(String, org.gradle.api.specs.Spec)</a> method. The following sample skips the <code>test</code> task if the project has a property called <code>mySkipTests</code>:</p>
</div>
<div id="ex-skipping-the-unit-tests-based-on-a-project-property" class="exampleblock">
<div class="title">Example 85. <a href="#ex-skipping-the-unit-tests-based-on-a-project-property">Skipping the unit tests based on a project property</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.test {
    val skipTestsProvider = providers.gradleProperty("mySkipTests")
    onlyIf("mySkipTests property is not set") {
        !skipTestsProvider.isPresent()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def skipTestsProvider = providers.gradleProperty('mySkipTests')
test.onlyIf("mySkipTests property is not set") {
    !skipTestsProvider.present
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, Gradle will mark the skipped tests as "SKIPPED" rather than exclude them from the build.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:forcing_java_tests_to_run"><a class="anchor" href="#sec:forcing_java_tests_to_run"></a><a class="link" href="#sec:forcing_java_tests_to_run">Forcing tests to run</a></h4>
<div class="paragraph">
<p>In well-defined builds, you can rely on Gradle to only run tests if the tests themselves or the production code change. However, you may encounter situations where the tests rely on a third-party service or something else that might change but can&#8217;t be modeled in the build.</p>
</div>
<div class="paragraph">
<p>You can always use the <code>--rerun</code> <a href="#sec:builtin_task_options">built-in task option</a> to force a task to rerun.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gradle test --rerun</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if <a href="#sec:build_cache_enable">build caching</a> is not enabled, you can also force tests to run by cleaning the output of the relevant <code>Test</code> task  say <code>test</code>  and running the tests again, like so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gradle cleanTest test</pre>
</div>
</div>
<div class="paragraph">
<p><code>cleanTest</code> is based on a task rule provided by the <a href="base_plugin.html#sec:base_tasks">Base Plugin</a>. You can use it for <em>any</em> task.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:debugging_java_tests"><a class="anchor" href="#sec:debugging_java_tests"></a><a class="link" href="#sec:debugging_java_tests">Debugging when running tests</a></h4>
<div class="paragraph">
<p>On the few occasions that you want to debug your code while the tests are running, it can be helpful if you can attach a debugger at that point. You can either set the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:debug">Test.getDebug()</a> property to <code>true</code> or use the <code>--debug-jvm</code> command line option, or use <code>--no-debug-jvm</code> to set it to false.</p>
</div>
<div class="paragraph">
<p>When debugging for tests is enabled, Gradle will start the test process suspended and listening on port 5005.</p>
</div>
<div class="paragraph">
<p>You can also enable debugging in the DSL, where you can also configure other properties:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>test {
    debugOptions {
        enabled = true
        host = 'localhost'
        port = 4455
        server = true
        suspend = true
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>With this configuration the test JVM will behave just like when passing the <code>--debug-jvm</code> argument but it will listen on port 4455.</p>
</div>
<div class="paragraph">
<p>To debug the test process remotely via network,  the <code>host</code> needs to be set to the machine&#8217;s IP address or <code>"*"</code> (listen on all interfaces).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_test_fixtures"><a class="anchor" href="#sec:java_test_fixtures"></a><a class="link" href="#sec:java_test_fixtures">Using test fixtures</a></h4>
<div class="sect4">
<h5 id="producing_and_using_test_fixtures_within_a_single_project"><a class="anchor" href="#producing_and_using_test_fixtures_within_a_single_project"></a><a class="link" href="#producing_and_using_test_fixtures_within_a_single_project">Producing and using test fixtures within a single project</a></h5>
<div class="paragraph">
<p>Test fixtures are commonly used to setup the code under test, or provide utilities aimed at facilitating the tests of a component.
Java projects can enable test fixtures support by applying the <code>java-test-fixtures</code> plugin, in addition to the <code>java</code> or <code>java-library</code> plugins:</p>
</div>
<div id="ex-applying-the-java-test-fixtures-plugin" class="exampleblock">
<div class="title">Example 86. <a href="#ex-applying-the-java-test-fixtures-plugin">Applying the Java test fixtures plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    // A Java Library
    `java-library`
    // which produces test fixtures
    `java-test-fixtures`
    // and is published
    `maven-publish`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    // A Java Library
    id 'java-library'
    // which produces test fixtures
    id 'java-test-fixtures'
    // and is published
    id 'maven-publish'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will automatically create a <code>testFixtures</code> source set, in which you can write your test fixtures.
Test fixtures are configured so that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they can see the <em>main</em> source set classes</p>
</li>
<li>
<p><em>test</em> sources can see the <em>test fixtures</em> classes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example for this main class:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/acme/Person.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Person {
    private final String firstName;
    private final String lastName;

    public Person(String firstName, String lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }

    // ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>A test fixture can be written in <code>src/testFixtures/java</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/testFixtures/java/com/acme/Simpsons.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Simpsons {
    private static final Person HOMER = new Person("Homer", "Simpson");
    private static final Person MARGE = new Person("Marjorie", "Simpson");
    private static final Person BART = new Person("Bartholomew", "Simpson");
    private static final Person LISA = new Person("Elisabeth Marie", "Simpson");
    private static final Person MAGGIE = new Person("Margaret Eve", "Simpson");
    private static final List&lt;Person&gt; FAMILY = new ArrayList&lt;Person&gt;() {{
        add(HOMER);
        add(MARGE);
        add(BART);
        add(LISA);
        add(MAGGIE);
    }};

    public static Person homer() { return HOMER; }

    public static Person marge() { return MARGE; }

    public static Person bart() { return BART; }

    public static Person lisa() { return LISA; }

    public static Person maggie() { return MAGGIE; }

    // ...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="declaring_dependencies_of_test_fixtures"><a class="anchor" href="#declaring_dependencies_of_test_fixtures"></a><a class="link" href="#declaring_dependencies_of_test_fixtures">Declaring dependencies of test fixtures</a></h5>
<div class="paragraph">
<p>Similarly to the <a href="java_library_plugin.html">Java Library Plugin</a>, test fixtures expose an API and an implementation configuration:</p>
</div>
<div id="ex-declaring-test-fixture-dependencies" class="exampleblock">
<div class="title">Example 87. <a href="#ex-declaring-test-fixture-dependencies">Declaring test fixture dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("junit:junit:4.13")

    // API dependencies are visible to consumers when building
    testFixturesApi("org.apache.commons:commons-lang3:3.9")

    // Implementation dependencies are not leaked to consumers when building
    testFixturesImplementation("org.apache.commons:commons-text:1.6")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">lib/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation 'junit:junit:4.13'

    // API dependencies are visible to consumers when building
    testFixturesApi 'org.apache.commons:commons-lang3:3.9'

    // Implementation dependencies are not leaked to consumers when building
    testFixturesImplementation 'org.apache.commons:commons-text:1.6'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s worth noticing that if a dependency is an <em>implementation</em> dependency of test fixtures, then <em>when compiling tests that depend on those test fixtures</em>, the implementation dependencies will <em>not leak</em> into the compile classpath.
This results in improved separation of concerns and better compile avoidance.</p>
</div>
</div>
<div class="sect4">
<h5 id="consuming_test_fixtures_of_another_project"><a class="anchor" href="#consuming_test_fixtures_of_another_project"></a><a class="link" href="#consuming_test_fixtures_of_another_project">Consuming test fixtures of another project</a></h5>
<div class="paragraph">
<p>Test fixtures are not limited to a single project.
It is often the case that a dependent project tests also needs the test fixtures of the dependency.
This can be achieved very easily using the <code>testFixtures</code> keyword:</p>
</div>
<div id="ex-adding-a-dependency-on-test-fixtures-of-another-project" class="exampleblock">
<div class="title">Example 88. <a href="#ex-adding-a-dependency-on-test-fixtures-of-another-project">Adding a dependency on test fixtures of another project</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(project(":lib"))

    testImplementation("junit:junit:4.13")
    testImplementation(testFixtures(project(":lib")))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation(project(":lib"))

    testImplementation 'junit:junit:4.13'
    testImplementation(testFixtures(project(":lib")))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="publishing_test_fixtures"><a class="anchor" href="#publishing_test_fixtures"></a><a class="link" href="#publishing_test_fixtures">Publishing test fixtures</a></h5>
<div class="paragraph">
<p>One of the advantages of using the <code>java-test-fixtures</code> plugin is that test fixtures are published.
By convention, test fixtures will be published with an artifact having the <code>test-fixtures</code> classifier.
For both Maven and Ivy, an artifact with that classifier is simply published alongside the regular artifacts.
However, if you use the <code>maven-publish</code> or <code>ivy-publish</code> plugin, test fixtures are published as additional variants in <a href="https://github.com/gradle/gradle/blob/master/platforms/documentation/docs/src/docs/design/gradle-module-metadata-1.0-specification.md">Gradle Module Metadata</a> and you can directly depend on test fixtures of external libraries in another Gradle project:</p>
</div>
<div id="ex-adding-a-dependency-on-test-fixtures-of-an-external-library" class="exampleblock">
<div class="title">Example 89. <a href="#ex-adding-a-dependency-on-test-fixtures-of-an-external-library">Adding a dependency on test fixtures of an external library</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // Adds a dependency on the test fixtures of Gson, however this
    // project doesn't publish such a thing
    functionalTest(testFixtures("com.google.code.gson:gson:2.13.1"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // Adds a dependency on the test fixtures of Gson, however this
    // project doesn't publish such a thing
    functionalTest testFixtures("com.google.code.gson:gson:2.13.1")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s worth noting that if the external project is <em>not</em> publishing Gradle Module Metadata, then resolution will fail with an error indicating that such a variant cannot be found:</p>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dependencyInsight --configuration functionalTestClasspath --dependency gson</code></strong></div>
<div class="content">
<pre>&gt; gradle dependencyInsight --configuration functionalTestClasspath --dependency gson

&gt; Task :dependencyInsight
com.google.code.gson:gson:2.13.1 FAILED
   Failures:
      - Could not resolve com.google.code.gson:gson:2.13.1.
          - Unable to find a variant with the requested capability: feature 'test-fixtures':
               - Variant 'compile' provides 'com.google.code.gson:gson:2.13.1'
               - Variant 'enforced-platform-compile' provides 'com.google.code.gson:gson-derived-enforced-platform:2.13.1'
               - Variant 'enforced-platform-runtime' provides 'com.google.code.gson:gson-derived-enforced-platform:2.13.1'
               - Variant 'javadoc' provides 'com.google.code.gson:gson:2.13.1'
               - Variant 'platform-compile' provides 'com.google.code.gson:gson-derived-platform:2.13.1'
               - Variant 'platform-runtime' provides 'com.google.code.gson:gson-derived-platform:2.13.1'
               - Variant 'runtime' provides 'com.google.code.gson:gson:2.13.1'
               - Variant 'sources' provides 'com.google.code.gson:gson:2.13.1'

com.google.code.gson:gson:2.13.1 FAILED
\--- functionalTestClasspath

A web-based, searchable dependency report is available by adding the --scan option.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The error message mentions the missing <code>com.google.code.gson:gson-test-fixtures</code> capability, which is indeed not defined for this library.
That&#8217;s because by convention, for projects that use the <code>java-test-fixtures</code> plugin, Gradle automatically creates test fixtures variants with a capability whose name is the name of the main component, with the appendix <code>-test-fixtures</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you publish your library and use test fixtures, but do not want to publish the fixtures, you can deactivate publishing of the <em>test fixtures variants</em> as shown below.
</td>
</tr>
</table>
</div>
<div id="ex-disable-publishing-of-test-fixtures-variants" class="exampleblock">
<div class="title">Example 90. <a href="#ex-disable-publishing-of-test-fixtures-variants">Disable publishing of test fixtures variants</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val javaComponent = components["java"] as AdhocComponentWithVariants
javaComponent.withVariantsFromConfiguration(configurations["testFixturesApiElements"]) { skip() }
javaComponent.withVariantsFromConfiguration(configurations["testFixturesRuntimeElements"]) { skip() }</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">components.java.withVariantsFromConfiguration(configurations.testFixturesApiElements) { skip() }
components.java.withVariantsFromConfiguration(configurations.testFixturesRuntimeElements) { skip() }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_management_for_java_projects"><a class="anchor" href="#dependency_management_for_java_projects"></a><a class="link" href="#dependency_management_for_java_projects">Managing Dependencies of JVM Projects</a></h3>
<div class="paragraph">
<p>This chapter explains how to apply basic dependency management concepts to JVM-based projects.
For a detailed introduction to dependency management, see <a href="getting_started_dep_man.html#dependency-management-in-gradle">dependency management in Gradle</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:setting_up_a_standard_build_script_java_tutorial"><a class="anchor" href="#sec:setting_up_a_standard_build_script_java_tutorial"></a><a class="link" href="#sec:setting_up_a_standard_build_script_java_tutorial">Dissecting a typical build script</a></h4>
<div class="paragraph">
<p>Let&#8217;s have a look at a very simple build script for a JVM-based project.
It applies the <a href="#java_library_plugin">Java Library plugin</a> which automatically introduces a standard project layout, provides tasks for performing typical work and adequate support for dependency management.</p>
</div>
<div id="ex-dependency-declarations-for-a-jvm-based-project" class="exampleblock">
<div class="title">Example 91. <a href="#ex-dependency-declarations-for-a-jvm-based-project">Dependency declarations for a JVM-based project</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.hibernate:hibernate-core:3.6.7.Final")
    testImplementation("junit:junit:4.+")
    api("com.google.guava:guava:23.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.hibernate:hibernate-core:3.6.7.Final'
    testImplementation 'junit:junit:4.+'
    api 'com.google.guava:guava:23.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:dependencies(groovy.lang.Closure)">Project.dependencies{}</a> code block declares that Hibernate core 3.6.7.Final is required to compile the project&#8217;s production source code. It also states that junit &gt;= 4.0 is required to compile the project&#8217;s tests. All dependencies are supposed to be looked up in the Maven Central repository as defined by <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:repositories(groovy.lang.Closure)">Project.repositories{}</a>. The following sections explain each aspect in more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:module_dependencies_java_tutorial"><a class="anchor" href="#sec:module_dependencies_java_tutorial"></a><a class="link" href="#sec:module_dependencies_java_tutorial">Declaring module dependencies</a></h4>
<div class="paragraph">
<p>There are various <a href="declaring_dependencies.html#sub:dependency-types">types of dependencies</a> that you can declare.
One such type is a <em>module dependency</em>.
A <a href="#sec:module-dependencies">module dependency</a> represents a dependency on a module with a specific version built outside the current build.
Modules are usually stored in a repository, such as Maven Central, a corporate Maven or Ivy repository, or a directory in the local file system.</p>
</div>
<div class="paragraph">
<p>To define an module dependency, you add it to a <a href="#sec:configurations_java_tutorial">dependency configuration</a>:</p>
</div>
<div id="ex-definition-of-a-module-dependency" class="exampleblock">
<div class="title">Example 92. <a href="#ex-definition-of-a-module-dependency">Definition of a module dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("org.hibernate:hibernate-core:3.6.7.Final")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'org.hibernate:hibernate-core:3.6.7.Final'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To find out more about defining dependencies, have a look at <a href="declaring_dependencies.html#one-declaring-dependencies">Declaring Dependencies</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:configurations_java_tutorial"><a class="anchor" href="#sec:configurations_java_tutorial"></a><a class="link" href="#sec:configurations_java_tutorial">Using dependency configurations</a></h4>
<div class="paragraph">
<p>A <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a> is a named set of dependencies and artifacts. There are three main purposes for a <em>configuration</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Declaring dependencies</dt>
<dd>
<p>A plugin uses configurations to make it easy for build authors to declare what other subprojects or external artifacts are needed for various purposes during the execution of tasks defined by the plugin. For example a plugin may need the Spring web framework dependency to compile the source code.</p>
</dd>
<dt class="hdlist1">Resolving dependencies</dt>
<dd>
<p>A plugin uses configurations to find (and possibly download) inputs to the tasks it defines. For example Gradle needs to download Spring web framework JAR files from Maven Central.</p>
</dd>
<dt class="hdlist1">Exposing artifacts for consumption</dt>
<dd>
<p>A plugin uses configurations to define what <em>artifacts</em> it generates for other projects to consume. For example the project would like to publish its compiled source code packaged in the JAR file to an in-house Artifactory repository.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>With those three purposes in mind, let&#8217;s take a look at a few of the <a href="#sec:java_library_configurations_graph">standard configurations defined by the Java Library Plugin</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">implementation</dt>
<dd>
<p>The dependencies required to compile the production source of the project which <em>are not</em> part of the API exposed by the project. For example the project uses Hibernate for its internal persistence layer implementation.</p>
</dd>
<dt class="hdlist1">api</dt>
<dd>
<p>The dependencies required to compile the production source of the project which <em>are</em> part of the API exposed by the project. For example the project uses Guava and exposes public interfaces with Guava classes in their method signatures.</p>
</dd>
<dt class="hdlist1">testImplementation</dt>
<dd>
<p>The dependencies required to compile and run the test source of the project. For example the project decided to write test code with the test framework JUnit.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Various plugins add further standard configurations.
You can also define your own custom configurations in your build via <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:configurations(groovy.lang.Closure)">Project.configurations{}</a>.
See <a href="dependency_configurations.html#sub:what-are-dependency-configurations">What are dependency configurations</a> for the details of defining and customizing dependency configurations.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:repositories_java_tutorial"><a class="anchor" href="#sec:repositories_java_tutorial"></a><a class="link" href="#sec:repositories_java_tutorial">Declaring common Java repositories</a></h4>
<div class="paragraph">
<p>How does Gradle know where to find the files for external dependencies? Gradle looks for them in a <em>repository</em>.
A repository is a collection of modules, organized by <code>group</code>, <code>name</code> and <code>version</code>.
Gradle understands different <a href="#repository-types">repository types</a>, such as Maven and Ivy, and supports various ways of accessing the repository via HTTP or other protocols.</p>
</div>
<div class="paragraph">
<p>By default, Gradle does not define any repositories. You need to define at least one with the help of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#org.gradle.api.Project:repositories(groovy.lang.Closure)">Project.repositories{}</a> before you can use module dependencies. One option is use the Maven Central repository:</p>
</div>
<div id="ex-usage-of-maven-central-repository" class="exampleblock">
<div class="title">Example 93. <a href="#ex-usage-of-maven-central-repository">Usage of Maven central repository</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also have repositories on the local file system. This works for both Maven and Ivy repositories.</p>
</div>
<div id="ex-usage-of-a-local-ivy-directory" class="exampleblock">
<div class="title">Example 94. <a href="#ex-usage-of-a-local-ivy-directory">Usage of a local Ivy directory</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    ivy {
        // URL can refer to a local directory
        url = uri("../local-repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    ivy {
        // URL can refer to a local directory
        url = file("../local-repo")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A project can have multiple repositories. Gradle will look for a dependency in each repository in the order they are specified, stopping at the first repository that contains the requested module.</p>
</div>
<div class="paragraph">
<p>To find out more about defining repositories, have a look at <a href="declaring_repositories.html#three-declaring-repositories">Declaring Repositories</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_artifacts_java_tutorial"><a class="anchor" href="#sec:publishing_artifacts_java_tutorial"></a><a class="link" href="#sec:publishing_artifacts_java_tutorial">Publishing artifacts</a></h4>
<div class="paragraph">
<p>To learn more about publishing artifacts, have a look at <a href="#publishing_components">publishing plugins</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="java_toolchains"><a class="anchor" href="#java_toolchains"></a><a class="link" href="#java_toolchains">JAVA TOOLCHAINS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="toolchains"><a class="anchor" href="#toolchains"></a><a class="link" href="#toolchains">Toolchains for JVM projects</a></h3>
<div class="paragraph">
<p>Working on multiple projects can require interacting with multiple versions of the Java language.
Even within a single project different parts of the codebase may be fixed to a particular language level due to backward compatibility requirements.
This means different versions of the same tools (a toolchain) must be installed and managed on each machine that builds the project.</p>
</div>
<div class="paragraph">
<p>A <strong>Java toolchain</strong> is a set of tools to build and run Java projects, which is usually provided by the environment via local JRE or JDK installations.
Compile tasks may use <code>javac</code> as their compiler, test and exec tasks may use the <code>java</code> command while <code>javadoc</code> will be used to generate documentation.</p>
</div>
<div class="paragraph">
<p>By default, Gradle uses the same Java toolchain for running Gradle itself and building JVM projects.
However, this may only sometimes be desirable.
Building projects with different Java versions on different developer machines and CI servers may lead to unexpected issues.
Additionally, you may want to build a project using a Java version that is not supported for running Gradle.</p>
</div>
<div class="paragraph">
<p>In order to improve reproducibility of the builds and make build requirements clearer, Gradle allows configuring toolchains on both project and task levels.
You can also control the JVM used to run Gradle itself using the <a href="#sec:daemon_jvm_criteria">Daemon JVM criteria</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:consuming"><a class="anchor" href="#sec:consuming"></a><a class="link" href="#sec:consuming">Toolchains for projects</a></h4>
<div class="paragraph">
<p>Gradle provides multiple ways to configure the Java version used for compiling and running your project.</p>
</div>
<div class="paragraph">
<p>The five primary mechanisms are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong><a href="#sec:java-toolchains">Java toolchains</a></strong></p>
</li>
<li>
<p><strong><a href="#sec:release-flag-toolchain">The <code>--release</code> flag</a></strong></p>
</li>
<li>
<p><strong><a href="#sec:source-target-toolchain">Source and Target compatibility</a></strong></p>
</li>
<li>
<p><strong><a href="#sec:java-home-toolchain">Environment variables (<code>JAVA_HOME</code>)</a></strong></p>
</li>
<li>
<p><strong><a href="#sec:ide-settings-toolchain">IDE settings</a></strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These settings are <strong>not mutually exclusive</strong>, and advanced users may need to combine them in specific scenarios.</p>
</div>
<div class="sect4">
<h5 id="sec:java-toolchains"><a class="anchor" href="#sec:java-toolchains"></a><a class="link" href="#sec:java-toolchains">1. Java toolchains</a></h5>
<div class="paragraph">
<p>To configure a toolchain for your project, declare the desired Java language version in the <code>java</code> extension block:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>java</code> block is flexible and supports additional configuration options.
You can learn more in <a href="#sec:using-java-toolchains">Using Java toolchains</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:release-flag-toolchain"><a class="anchor" href="#sec:release-flag-toolchain"></a><a class="link" href="#sec:release-flag-toolchain">2. The <code>--release</code> flag</a></h5>
<div class="paragraph">
<p>For strict cross-compilation, the <code>--release</code> flag is recommended instead of <code>sourceCompatibility</code> and <code>targetCompatibility</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;JavaCompile&gt;().configureEach {
    options.release = 8
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(JavaCompile).configureEach {
    options.release = 8
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This flag prevents accidental use of newer APIs that are not available in the specified version.
However, it does not control which JDK is usedonly how the compiler treats source code.</p>
</div>
<div class="paragraph">
<p>This method can be combined with toolchains <strong>if you need both a specific JDK and strict cross-compilation</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:source-target-toolchain"><a class="anchor" href="#sec:source-target-toolchain"></a><a class="link" href="#sec:source-target-toolchain">3. Source and Target compatibility</a></h5>
<div class="paragraph">
<p>Setting <code>sourceCompatibility</code> and <code>targetCompatibility</code> tells the Java compiler to produce bytecode compatible with a specific Java version but does <strong>not</strong> enforce which JDK Gradle itself runs with:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This does <strong>not</strong> guarantee the correct JDK is used and may cause issues when APIs have been backported to older Java versions.</p>
</div>
<div class="paragraph">
<p>You should only use this method in cases where you need backward compatibility <strong>but cannot use toolchains</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:java-home-toolchain"><a class="anchor" href="#sec:java-home-toolchain"></a><a class="link" href="#sec:java-home-toolchain">4. Environment variables (<code>JAVA_HOME</code>)</a></h5>
<div class="paragraph">
<p>You can influence which JDK Gradle uses by setting the <code>JAVA_HOME</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export JAVA_HOME=/path/to/java17</code></pre>
</div>
</div>
<div class="paragraph">
<p>This sets a default JDK for all Java-based tools on your system, including Gradle and Maven.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This does not override Gradles toolchain support or other project-specific configurations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This approach is useful for legacy projects that do not use toolchains and expect a specific JDK to be active in the environment.</p>
</div>
<div class="paragraph">
<p>However, since <code>JAVA_HOME</code> applies globally, it cannot be used to specify different JDK versions for different projects.
It is more reliable to use <a href="#sec:java-toolchains">toolchains</a>, which allow setting the Java version at the project level.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:ide-settings-toolchain"><a class="anchor" href="#sec:ide-settings-toolchain"></a><a class="link" href="#sec:ide-settings-toolchain">5. IDE settings</a></h5>
<div class="paragraph">
<p>Most modern IDEs allow you to configure the JVM used to run Gradle when working with a project.
This setting affects how Gradle itself is executed inside the IDE, but not how your code is compiledunless the build does not explicitly specify a toolchain.</p>
</div>
<div class="paragraph">
<p>If your build does not define a Java toolchain, Gradle may fall back to using the Java version defined by the IDE settings. This can lead to unintended and non-reproducible behavior, especially if different team members use different IDE configurations.</p>
</div>
<div class="paragraph">
<p>You should change the IDE&#8217;s Gradle JVM setting to align with the JVM used on the command line (<code>JAVA_HOME</code> or the systems default Java installation) ensuring consistent behavior across environments (e.g., when running tests or tasks from the IDE vs the terminal).</p>
</div>
<div class="paragraph">
<p>You should also change the IDE&#8217;s Gradle JVM setting if the IDE emits a warning/error when the JVM is not set or does not match with <code>JAVA_HOME</code>.</p>
</div>
<div class="sect5">
<h6 id="intellij_idea"><a class="anchor" href="#intellij_idea"></a><a class="link" href="#intellij_idea">IntelliJ IDEA</a></h6>
<div class="paragraph">
<p>To configure the Gradle JVM:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <strong>Settings (Preferences)</strong> &gt; <strong>Build, Execution, Deployment</strong> &gt; <strong>Gradle</strong>.</p>
</li>
<li>
<p>Set <strong>Gradle JVM</strong> to the desired JDK.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="eclipse"><a class="anchor" href="#eclipse"></a><a class="link" href="#eclipse">Eclipse</a></h6>
<div class="paragraph">
<p>To configure the Gradle JVM:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <strong>Preferences</strong> &gt; <strong>Gradle</strong> &gt; <strong>Gradle JDK</strong>.</p>
</li>
<li>
<p>Select the appropriate JDK.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some IDEs also allow you to configure the <a href="#gradle_daemon">Gradle Daemon</a> JVM in the same settings screen.
Be careful not to confuse it with the toolchain or project JVM<strong>make sure you&#8217;re selecting the correct one.</strong>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="combining_toolchains"><a class="anchor" href="#combining_toolchains"></a><a class="link" href="#combining_toolchains">Combining toolchains</a></h5>
<div class="paragraph">
<p>In some cases, you may want to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a <strong>specific JDK version</strong> for compilation (<code>toolchains</code>).</p>
</li>
<li>
<p>Ensure that the compiled bytecode is <strong>compatible with an older Java version</strong> (<code>--release</code> or <code>targetCompatibility</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, to compile with Java 17 but produce Java 11 bytecode:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

tasks.withType&lt;JavaCompile&gt;().configureEach {
    options.release = 11
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

tasks.withType(JavaCompile).configureEach {
    options.release = 11
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="comparison_table_for_setting_project_toolchains"><a class="anchor" href="#comparison_table_for_setting_project_toolchains"></a><a class="link" href="#comparison_table_for_setting_project_toolchains">Comparison table for setting project toolchains</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Ensures Correct JDK?</th>
<th class="tableblock halign-left valign-top">Auto Downloads JDK?</th>
<th class="tableblock halign-left valign-top">Prevents Accidental API Use?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java toolchains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--release</code> flag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source &amp; Target compatibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variables (<code>JAVA_HOME</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> Yes (but only globally)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDE settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> Yes (inside the IDE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Recommendation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>For most users:</strong> Use Java toolchains (<code>toolchain.languageVersion</code>).</p>
</li>
<li>
<p><strong>For strict compatibility enforcement:</strong> Use the <code>--release</code> flag.</p>
</li>
<li>
<p><strong>For advanced cases:</strong> Combine toolchains and <code>--release</code>.</p>
</li>
<li>
<p><strong>Avoid</strong> <code>sourceCompatibility</code> and <code>targetCompatibility</code> unless necessary.</p>
</li>
<li>
<p><strong>Use <code>JAVA_HOME</code></strong> only if you need a default system-wide JDK version.</p>
</li>
<li>
<p><strong>Use IDE settings</strong> if you want Gradle to match your IDE&#8217;s JDK version.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="toolchains_for_tasks"><a class="anchor" href="#toolchains_for_tasks"></a><a class="link" href="#toolchains_for_tasks">Toolchains for tasks</a></h4>
<div class="paragraph">
<p>In case you want to tweak which toolchain is used for a specific task, you can specify the exact tool a task is using.
For example, the <code>Test</code> task exposes a <code>JavaLauncher</code> property that defines which java executable to use for launching the tests.</p>
</div>
<div class="paragraph">
<p>In the example below, we configure all java compilation tasks to use Java 8.
Additionally, we introduce a new <code>Test</code> task that will run our unit tests using a JDK 17.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">list/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;JavaCompile&gt;().configureEach {
    javaCompiler = javaToolchains.compilerFor {
        languageVersion = JavaLanguageVersion.of(8)
    }
}

tasks.register&lt;Test&gt;("testsOn17") {
    javaLauncher = javaToolchains.launcherFor {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">list/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(JavaCompile).configureEach {
    javaCompiler = javaToolchains.compilerFor {
        languageVersion = JavaLanguageVersion.of(8)
    }
}

tasks.register('testsOn17', Test) {
    javaLauncher = javaToolchains.launcherFor {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In addition, in the <code>application</code> subproject, we add another Java execution task to run our application with JDK 17.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">application/build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;JavaExec&gt;("runOn17") {
    javaLauncher = javaToolchains.launcherFor {
        languageVersion = JavaLanguageVersion.of(17)
    }

    classpath = sourceSets["main"].runtimeClasspath
    mainClass = application.mainClass
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">application/build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('runOn17', JavaExec) {
    javaLauncher = javaToolchains.launcherFor {
        languageVersion = JavaLanguageVersion.of(17)
    }

    classpath = sourceSets.main.runtimeClasspath
    mainClass = application.mainClass
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Depending on the task, a JRE might be enough while for other tasks (e.g. compilation), a JDK is required.
By default, Gradle prefers installed JDKs over JREs if they can satisfy the requirements.</p>
</div>
<div class="paragraph">
<p>Toolchains tool providers can be obtained from the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JavaToolchainService.html"><code>javaToolchains</code></a> extension.</p>
</div>
<div class="paragraph">
<p>Three tools are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>JavaCompiler</code> which is the tool used by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.JavaCompile.html#org.gradle.api.tasks.compile.JavaCompile:javaCompiler">JavaCompile</a> task</p>
</li>
<li>
<p>A <code>JavaLauncher</code> which is the tool used by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.JavaExec.html#org.gradle.api.tasks.JavaExec:javaLauncher">JavaExec</a> or <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:javaLauncher">Test</a> tasks</p>
</li>
<li>
<p>A <code>JavadocTool</code> which is the tool used by the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.javadoc.Javadoc.html#org.gradle.api.tasks.javadoc.Javadoc:javadocTool">Javadoc</a> task</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="integration_with_tasks_relying_on_a_java_executable_or_java_home"><a class="anchor" href="#integration_with_tasks_relying_on_a_java_executable_or_java_home"></a><a class="link" href="#integration_with_tasks_relying_on_a_java_executable_or_java_home">Integration with tasks relying on a Java executable or Java home</a></h5>
<div class="paragraph">
<p>Any task that can be configured with a path to a Java executable, or a Java home location, can benefit from toolchains.</p>
</div>
<div class="paragraph">
<p>While you will not be able to wire a toolchain tool directly, they all have the metadata that gives access to their full path or to the path of the Java installation they belong to.</p>
</div>
<div class="paragraph">
<p>For example, you can configure the <code>java</code> executable for a task as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val launcher = javaToolchains.launcherFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.sampleTask {
    javaExecutable = launcher.map { it.executablePath }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def launcher = javaToolchains.launcherFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.named('sampleTask') {
    javaExecutable = launcher.map { it.executablePath }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As another example, you can configure the <em>Java Home</em> for a task as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val launcher = javaToolchains.launcherFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.anotherSampleTask {
    javaHome = launcher.map { it.metadata.installationPath }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def launcher = javaToolchains.launcherFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.named('anotherSampleTask') {
    javaHome = launcher.map { it.metadata.installationPath }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you require a path to a specific tool such as Java compiler, you can obtain it as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val compiler = javaToolchains.compilerFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.yetAnotherSampleTask {
    javaCompilerExecutable = compiler.map { it.executablePath }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">def compiler = javaToolchains.compilerFor {
    languageVersion = JavaLanguageVersion.of(11)
}

tasks.named('yetAnotherSampleTask') {
    javaCompilerExecutable = compiler.map { it.executablePath }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The examples above use tasks with <code>RegularFileProperty</code> and <code>DirectoryProperty</code> properties which allow lazy configuration.
Doing respectively <code>launcher.get().executablePath</code>, <code>launcher.get().metadata.installationPath</code> or <code>compiler.get().executablePath</code> instead will give you the full path for the given toolchain but note that this may realize (and provision) a toolchain eagerly.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using-java-toolchains"><a class="anchor" href="#sec:using-java-toolchains"></a><a class="link" href="#sec:using-java-toolchains">Using Java toolchains</a></h4>
<div class="paragraph">
<p>Using Java toolchains allows Gradle to automatically download and manage the required JDK version for your build. It ensures that the correct Java version is used for both compilation and execution.</p>
</div>
<div class="paragraph">
<p>You can define what toolchain to use for a project by stating the Java language version in the <code>java</code> extension block:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Executing the build (e.g. using <code>gradle check</code>) will now handle several things for you and others running your build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Gradle configures all compile, test and javadoc tasks to use the defined toolchain.</p>
</li>
<li>
<p>Gradle detects <a href="#sec:auto_detection">locally installed toolchains</a>.</p>
</li>
<li>
<p>Gradle chooses a toolchain matching the requirements (any Java 17 toolchain for the example above).</p>
</li>
<li>
<p>If no matching toolchain is found, Gradle can automatically download a matching one based on the configured <a href="#sub:download_repositories">toolchain download repositories</a>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Toolchain support is available in the Java plugins and for the tasks they define.</p>
</div>
<div class="paragraph">
<p>For the Groovy plugin, compilation is supported but not yet Groovydoc generation.
For the Scala plugin, compilation and Scaladoc generation are supported.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec:vendors"><a class="anchor" href="#sec:vendors"></a><a class="link" href="#sec:vendors">Selecting toolchains by vendor</a></h5>
<div class="paragraph">
<p>In case your build has specific requirements from the used JRE/JDK, you may want to define the vendor for the toolchain as well.
<a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JvmVendorSpec.html"><code>JvmVendorSpec</code></a> has a list of well-known JVM vendors recognized by Gradle.
The advantage is that Gradle can handle any inconsistencies across JDK versions in how exactly the JVM encodes the vendor information.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.ADOPTIUM
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.ADOPTIUM
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the vendor you want to target is not a known vendor, you can still restrict the toolchain to those matching the <code>java.vendor</code> system property of the available toolchains.</p>
</div>
<div class="paragraph">
<p>The following snippet uses filtering to include a subset of available toolchains.
This example only includes toolchains whose <code>java.vendor</code> property contains the given match string.
The matching is done in a case-insensitive manner.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.matching("customString")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.matching("customString")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:native_graalvm_image"><a class="anchor" href="#sec:native_graalvm_image"></a><a class="link" href="#sec:native_graalvm_image">Selecting toolchains that support GraalVM native image</a></h5>
<div class="paragraph">
<p>If your project needs a toolchain with <a href="https://www.graalvm.org/latest/reference-manual/native-image/">GraalVM Native Image capability</a>, you can configure the spec to request it:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
        nativeImageCapable = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
        nativeImageCapable = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Leaving that value unconfigured or set to <code>false</code> will not restrict the toolchain selection based on the Native Image capability.
That means that a Native Image capable JDK can be selected if it matches the other criteria.</p>
</div>
</div>
<div class="sect4">
<h5 id="selecting_toolchains_by_virtual_machine_implementation"><a class="anchor" href="#selecting_toolchains_by_virtual_machine_implementation"></a><a class="link" href="#selecting_toolchains_by_virtual_machine_implementation">Selecting toolchains by virtual machine implementation</a></h5>
<div class="paragraph">
<p>If your project requires a specific implementation, you can filter based on the implementation as well.
Currently available implementations to choose from are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>VENDOR_SPECIFIC</code></dt>
<dd>
<p>Acts as a placeholder and matches any implementation from any vendor (e.g. hotspot, zulu, &#8230;&#8203;)</p>
</dd>
<dt class="hdlist1"><code>J9</code></dt>
<dd>
<p>Matches only virtual machine implementations using the OpenJ9/IBM J9 runtime engine.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For example, to use an <a href="https://www.eclipse.org/openj9/">IBM</a> JVM, distributed via <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a>,
you can specify the filter as shown in the example below.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.IBM
        implementation = JvmImplementation.J9
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
        vendor = JvmVendorSpec.IBM
        implementation = JvmImplementation.J9
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Java major version, the vendor (if specified) and implementation (if specified) will be tracked as an input for compilation and test execution.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:configuring_toolchain_specifications"><a class="anchor" href="#sec:configuring_toolchain_specifications"></a><a class="link" href="#sec:configuring_toolchain_specifications">Configuring toolchain specifications</a></h5>
<div class="paragraph">
<p>Gradle allows configuring multiple properties that affect the selection of a toolchain, such as language version or vendor.
Even though these properties can be configured independently, the configuration must follow certain rules in order to form a <em>valid</em> specification.</p>
</div>
<div class="paragraph">
<p>A <code>JavaToolchainSpec</code> is considered <em>valid</em> in two cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>when no properties have been set, i.e. the specification is <em>empty</em>;</p>
</li>
<li>
<p>when <code>languageVersion</code> has been set, optionally followed by setting any other property.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In other words, if a vendor or an implementation are specified, they must be accompanied by the language version.
Gradle distinguishes between toolchain specifications that configure the language version and the ones that do not.
A specification without a language version, in most cases, would be treated as a one that selects the toolchain of the current build.</p>
</div>
<div class="paragraph">
<p>Usage of <em>invalid</em> instances of <code>JavaToolchainSpec</code> results in a build error since Gradle 8.0.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:auto_detection"><a class="anchor" href="#sec:auto_detection"></a><a class="link" href="#sec:auto_detection">Auto-detection of installed toolchains</a></h4>
<div class="paragraph">
<p>By default, Gradle automatically detects local JRE/JDK installations so no further configuration is required by the user.
The following is a list of common package managers, tools, and locations that are supported by the JVM auto-detection.</p>
</div>
<div class="paragraph">
<p>JVM auto-detection knows how to work with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operation-system specific locations: Linux, macOS, Windows</p>
</li>
<li>
<p>Conventional Environment Variable: <code>JAVA_HOME</code></p>
</li>
<li>
<p>Package Managers: <a href="https://asdf-vm.com/#/">Asdf-vm</a>, <a href="https://github.com/shyiko/jabba">Jabba</a>, <a href="https://sdkman.io/">SDKMAN!</a></p>
</li>
<li>
<p><a href="https://maven.apache.org/guides/mini/guide-using-toolchains.html">Maven Toolchain</a> specifications</p>
</li>
<li>
<p><a href="https://www.jetbrains.com/help/idea/sdk.html#jdk-from-ide">IntelliJ IDEA</a> installations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Among the set of all detected JRE/JDK installations, one will be picked according to the <a href="#sec:precedence">Toolchain Precedence Rules</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Whether you are using toolchain auto-detection or you are configuring <a href="#sec:custom_loc">Custom toolchain locations</a>, installations that are non-existing or without a <code>bin/java</code> executable will be ignored with a warning, but they won&#8217;t generate an error.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sub:disable_auto_detect"><a class="anchor" href="#sub:disable_auto_detect"></a><a class="link" href="#sub:disable_auto_detect">How to disable auto-detection</a></h5>
<div class="paragraph">
<p>In order to disable auto-detection, you can use the <code>org.gradle.java.installations.auto-detect</code> Gradle property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either start gradle using <code>-Porg.gradle.java.installations.auto-detect=false</code></p>
</li>
<li>
<p>Or put <code>org.gradle.java.installations.auto-detect=false</code> into your <code>gradle.properties</code> file.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:provisioning"><a class="anchor" href="#sec:provisioning"></a><a class="link" href="#sec:provisioning">Auto-provisioning</a></h4>
<div class="paragraph">
<p>If Gradle can&#8217;t find a locally available toolchain that matches the requirements of the build, it can automatically download one (as long as a toolchain download repository has been configured; for detail, see <a href="#sub:download_repositories">relevant section</a>).
Gradle installs the downloaded JDKs in the <a href="#dir:gradle_user_home">Gradle User Home</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Gradle only downloads JDK versions for GA releases.
There is no support for downloading early access versions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once installed in the <a href="#dir:gradle_user_home">Gradle User Home</a>, a provisioned JDK becomes one of the JDKs visible to <a href="#sec:auto_detection">auto-detection</a> and can be used by any subsequent builds, just like any other JDK installed on the system.</p>
</div>
<div class="paragraph">
<p>Since auto-provisioning only kicks in when auto-detection fails to find a matching JDK, auto-provisioning can only download new JDKs and is in no way involved in updating any of the already installed ones.
None of the auto-provisioned JDKs will ever be revisited and automatically updated by auto-provisioning, even if there is a newer minor version available for them.</p>
</div>
<div class="sect4">
<h5 id="sub:download_repositories"><a class="anchor" href="#sub:download_repositories"></a><a class="link" href="#sub:download_repositories">Toolchain Download Repositories</a></h5>
<div class="paragraph">
<p>Toolchain download repository definitions are added to a build by applying specific settings plugins.
For details on writing such plugins, consult the <a href="#toolchain_plugins">Toolchain Resolver Plugins</a> page.</p>
</div>
<div class="paragraph">
<p>One example of a toolchain resolver plugin is the <a href="https://github.com/gradle/foojay-toolchains">Foojay Toolchains Plugin</a>, based on the <a href="https://github.com/foojayio/discoapi">foojay Disco API</a>.
It even has a convention variant, which automatically takes care of all the needed configuration, just by being applied:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.gradle.toolchains.foojay-resolver-convention").version("1.0.0")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.gradle.toolchains.foojay-resolver-convention' version '1.0.0'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For advanced or highly specific configurations, a custom toolchain resolver plugin should be used.</p>
</div>
<div class="paragraph">
<p>In general, when applying toolchain resolver plugins, the toolchain download resolvers provided by them also need to be configured.
Let&#8217;s illustrate with an example.
Consider two toolchain resolver plugins applied by the build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One is the Foojay plugin mentioned above, which downloads toolchains via the <code>FoojayToolchainResolver</code> it provides.</p>
</li>
<li>
<p>The other contains a <strong>FICTITIOUS</strong> resolver named <code>MadeUpResolver</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example uses these toolchain resolvers in a build via the <code>toolchainManagement</code> block in the settings file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">toolchainManagement {
    jvm { // <b class="conum">(1)</b>
        javaRepositories {
            repository("foojay") { // <b class="conum">(2)</b>
                resolverClass = org.gradle.toolchains.foojay.FoojayToolchainResolver::class.java
            }
            repository("made_up") { // <b class="conum">(3)</b>
                resolverClass = MadeUpResolver::class.java
                credentials {
                    username = "user"
                    password = "password"
                }
                authentication {
                    create&lt;DigestAuthentication&gt;("digest")
                } // <b class="conum">(4)</b>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">toolchainManagement {
    jvm { // <b class="conum">(1)</b>
        javaRepositories {
            repository('foojay') { // <b class="conum">(2)</b>
                resolverClass = org.gradle.toolchains.foojay.FoojayToolchainResolver
            }
            repository('made_up') { // <b class="conum">(3)</b>
                resolverClass = MadeUpResolver
                credentials {
                    username = "user"
                    password = "password"
                }
                authentication {
                    digest(BasicAuthentication)
                } // <b class="conum">(4)</b>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>In the <code>toolchainManagement</code> block, the <code>jvm</code> block contains configuration for Java toolchains.</p>
</li>
<li>
<p>The <code>javaRepositories</code> block defines named Java toolchain repository configurations.
Use the <code>resolverClass</code> property to link these configurations to plugins.</p>
</li>
<li>
<p>Toolchain declaration order matters.
Gradle downloads from the first repository that provides a match, starting with the first repository in the list.</p>
</li>
<li>
<p>You can configure toolchain repositories with the same set of <a href="#sec:authentication-schemes">authentication and authorization options</a> used for dependency management.</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>jvm</code> block in <code>toolchainManagement</code> only resolves after applying a toolchain resolver plugin.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sub:viewing_toolchains"><a class="anchor" href="#sub:viewing_toolchains"></a><a class="link" href="#sub:viewing_toolchains">Viewing and debugging toolchains</a></h5>
<div class="paragraph">
<p>Gradle can display the list of all detected toolchains including their metadata.</p>
</div>
<div class="paragraph">
<p>For example, to show all toolchains of a project, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">gradle -q javaToolchains</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q javaToolchains</code></strong></div>
<div class="content">
<pre>&gt; gradle -q javaToolchains

 + Options
     | Auto-detection:     Enabled
     | Auto-download:      Enabled

 + AdoptOpenJDK 1.8.0_242
     | Location:           /Users/username/myJavaInstalls/8.0.242.hs-adpt/jre
     | Language Version:   8
     | Vendor:             AdoptOpenJDK
     | Architecture:       x86_64
     | Is JDK:             false
     | Detected by:        Gradle property 'org.gradle.java.installations.paths'

 + Microsoft JDK 16.0.2+7
     | Location:           /Users/username/.sdkman/candidates/java/16.0.2.7.1-ms
     | Language Version:   16
     | Vendor:             Microsoft
     | Architecture:       aarch64
     | Is JDK:             true
     | Detected by:        SDKMAN!

 + OpenJDK 15-ea
     | Location:           /Users/user/customJdks/15.ea.21-open
     | Language Version:   15
     | Vendor:             AdoptOpenJDK
     | Architecture:       x86_64
     | Is JDK:             true
     | Detected by:        environment variable 'JDK16'

 + Oracle JDK 1.7.0_80
     | Location:           /Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home/jre
     | Language Version:   7
     | Vendor:             Oracle
     | Architecture:       x86_64
     | Is JDK:             false
     | Detected by:        MacOS java_home</pre>
</div>
</div>
<div class="paragraph">
<p>This can help to debug which toolchains are available to the build, how they are detected and what kind of metadata Gradle knows about those toolchains.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:disable_auto_provision"><a class="anchor" href="#sub:disable_auto_provision"></a><a class="link" href="#sub:disable_auto_provision">Disabling auto provisioning</a></h5>
<div class="paragraph">
<p>In order to disable auto-provisioning, you can use the <code>org.gradle.java.installations.auto-download</code> Gradle property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either start gradle using <code>-Porg.gradle.java.installations.auto-download=false</code></p>
</li>
<li>
<p>Or put <code>org.gradle.java.installations.auto-download=false</code> into a <code>gradle.properties</code> file.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>After disabling the auto provisioning, ensure that the specified JRE/JDK version in the build file is already installed locally.
Then, stop the Gradle daemon so that it can be reinitialized for the next build.
You can use the <code>./gradlew --stop</code> command to stop the daemon process.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sub:removing_auto_provisioned_toolchain"><a class="anchor" href="#sub:removing_auto_provisioned_toolchain"></a><a class="link" href="#sub:removing_auto_provisioned_toolchain">Removing an auto-provisioned toolchain</a></h5>
<div class="paragraph">
<p>When removing an auto-provisioned toolchain is necessary, remove the relevant toolchain located in the <code>/jdks</code> directory within the <a href="#dir:gradle_user_home">Gradle User Home</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="#gradle_daemon">Gradle Daemon</a> caches information about your project, including configuration details such as toolchain paths or versions. Changes to a project&#8217;s toolchain configuration might only occur once the Gradle Daemon is restarted. It is recommended to  <a href="#sec:stopping_an_existing_daemon">stop the Gradle Daemon</a> to ensure that Gradle updates the configuration for subsequent builds.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_loc"><a class="anchor" href="#sec:custom_loc"></a><a class="link" href="#sec:custom_loc">Custom toolchain locations</a></h4>
<div class="paragraph">
<p>If auto-detecting local toolchains is not sufficient or disabled, there are additional ways you can let Gradle know about installed toolchains.</p>
</div>
<div class="paragraph">
<p>If your setup already provides environment variables pointing to installed JVMs, you can also let Gradle know about which environment variables to take into account.
Assuming the environment variables <code>JDK8</code> and <code>JRE17</code> point to valid java installations, the following instructs Gradle to resolve those environment variables and consider those installations when looking for a matching toolchain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.java.installations.fromEnv=JDK8,JRE17</pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you can provide a comma-separated list of paths to specific installations using the <code>org.gradle.java.installations.paths</code> property.
For example, using the following in your <code>gradle.properties</code> will let Gradle know which directories to look at when detecting toolchains.
Gradle will treat these directories as possible installations but will not descend into any nested directories.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.gradle.java.installations.paths=/custom/path/jdk1.8,/shared/jre11</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle does not prioritize custom toolchains over <a href="#sec:auto_detection">auto-detected</a> toolchains.
If you enable auto-detection in your build, custom toolchains extend the set of toolchain locations.
Gradle picks a toolchain according to the <a href="#sec:precedence">precedence rules</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:precedence"><a class="anchor" href="#sec:precedence"></a><a class="link" href="#sec:precedence">Toolchain installations precedence</a></h4>
<div class="paragraph">
<p>Gradle will sort all the JDK/JRE installations matching the toolchain specification of the build and will pick the first one.
Sorting is done based on the following rules:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the installation currently running Gradle is preferred over any other</p>
</li>
<li>
<p>JDK installations are preferred over JRE ones</p>
</li>
<li>
<p>certain vendors take precedence over others; their ordering (from the highest priority to lowest):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ADOPTIUM</p>
</li>
<li>
<p>ADOPTOPENJDK</p>
</li>
<li>
<p>AMAZON</p>
</li>
<li>
<p>APPLE</p>
</li>
<li>
<p>AZUL</p>
</li>
<li>
<p>BELLSOFT</p>
</li>
<li>
<p>GRAAL_VM</p>
</li>
<li>
<p>HEWLETT_PACKARD</p>
</li>
<li>
<p>IBM</p>
</li>
<li>
<p>JETBRAINS</p>
</li>
<li>
<p>MICROSOFT</p>
</li>
<li>
<p>ORACLE</p>
</li>
<li>
<p>SAP</p>
</li>
<li>
<p>TENCENT</p>
</li>
<li>
<p>everything else</p>
</li>
</ol>
</div>
</li>
<li>
<p>higher major versions take precedence over lower ones</p>
</li>
<li>
<p>higher minor versions take precedence over lower ones</p>
</li>
<li>
<p>installation paths take precedence according to their lexicographic ordering (last resort criteria for deterministically deciding
between installations of the same type, from the same vendor and with the same version)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All these rules are applied as multilevel sorting criteria, <strong>in the order shown</strong>.
Let&#8217;s illustrate with an example.
A toolchain specification requests Java version 17.
Gradle detects the following matching installations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Oracle JRE v17.0.1</p>
</li>
<li>
<p>Oracle JDK v17.0.0</p>
</li>
<li>
<p>Microsoft JDK 17.0.0</p>
</li>
<li>
<p>Microsoft JRE 17.0.1</p>
</li>
<li>
<p>Microsoft JDK 17.0.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assume that Gradle runs on a major Java version other than 17.
Otherwise, that installation would have priority.</p>
</div>
<div class="paragraph">
<p>When we apply the above rules to sort this set we will end up with following ordering:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Microsoft JDK 17.0.1</p>
</li>
<li>
<p>Microsoft JDK 17.0.0</p>
</li>
<li>
<p>Oracle JDK v17.0.0</p>
</li>
<li>
<p>Microsoft JRE v17.0.1</p>
</li>
<li>
<p>Oracle JRE v17.0.1</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle prefers JDKs over JREs, so the JREs come last.
Gradle prefers the Microsoft vendor over Oracle, so the Microsoft installations come first.
Gradle prefers higher version numbers, so JDK 17.0.1 comes before JDK 17.0.0.</p>
</div>
<div class="paragraph">
<p>So Gradle picks the first match in this order: Microsoft JDK 17.0.1.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:plugins_toolchains"><a class="anchor" href="#sec:plugins_toolchains"></a><a class="link" href="#sec:plugins_toolchains">Toolchains for plugin authors</a></h4>
<div class="paragraph">
<p>When creating a plugin or a task that uses toolchains, it is essential to provide sensible defaults and allow users to override them.</p>
</div>
<div class="paragraph">
<p>For JVM projects, it is usually safe to assume that the <code>java</code> plugin has been applied to the project.
The <code>java</code> plugin is automatically applied for the core Groovy and Scala plugins, as well as for the Kotlin plugin.
In such a case, using the toolchain defined via the <code>java</code> extension as a default value for the tool property is appropriate.
This way, the users will need to configure the toolchain only once on the project level.</p>
</div>
<div class="paragraph">
<p>The example below showcases how to use the default toolchain as convention while allowing users to individually configure the toolchain per task.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">abstract class CustomTaskUsingToolchains : DefaultTask() {

    @get:Nested
    abstract val launcher: Property&lt;JavaLauncher&gt; // <b class="conum">(1)</b>

    init {
        val toolchain = project.extensions.getByType&lt;JavaPluginExtension&gt;().toolchain // <b class="conum">(2)</b>
        val defaultLauncher = javaToolchainService.launcherFor(toolchain) // <b class="conum">(3)</b>
        launcher.convention(defaultLauncher) // <b class="conum">(4)</b>
    }

    @TaskAction
    fun showConfiguredToolchain() {
        println(launcher.get().executablePath)
        println(launcher.get().metadata.installationPath)
    }

    @get:Inject
    protected abstract val javaToolchainService: JavaToolchainService
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">abstract class CustomTaskUsingToolchains extends DefaultTask {

    @Nested
    abstract Property&lt;JavaLauncher&gt; getLauncher() // <b class="conum">(1)</b>

    CustomTaskUsingToolchains() {
        def toolchain = project.extensions.getByType(JavaPluginExtension.class).toolchain // <b class="conum">(2)</b>
        Provider&lt;JavaLauncher&gt; defaultLauncher = getJavaToolchainService().launcherFor(toolchain) // <b class="conum">(3)</b>
        launcher.convention(defaultLauncher) // <b class="conum">(4)</b>
    }

    @TaskAction
    def showConfiguredToolchain() {
        println launcher.get().executablePath
        println launcher.get().metadata.installationPath
    }

    @Inject
    protected abstract JavaToolchainService getJavaToolchainService()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We declare a <code>JavaLauncher</code> property on the task.
The property must be marked as a <a href="incremental_build.html#sec:task_input_nested_inputs"><code>@Nested</code> input</a> to make sure the task is responsive to toolchain changes.</p>
</li>
<li>
<p>We obtain the toolchain spec from the <code>java</code> extension to use it as a default.</p>
</li>
<li>
<p>Using the <code>JavaToolchainService</code> we get a provider of the <code>JavaLauncher</code> that matches the toolchain.</p>
</li>
<li>
<p>Finally, we wire the launcher provider as a convention for our property.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In a project where the <code>java</code> plugin was applied, we can use the task as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    java
}

java {
    toolchain { // <b class="conum">(1)</b>
        languageVersion = JavaLanguageVersion.of(8)
    }
}

tasks.register&lt;CustomTaskUsingToolchains&gt;("showDefaultToolchain") // <b class="conum">(2)</b>

tasks.register&lt;CustomTaskUsingToolchains&gt;("showCustomToolchain") {
    launcher = javaToolchains.launcherFor { // <b class="conum">(3)</b>
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java'
}

java {
    toolchain { // <b class="conum">(1)</b>
        languageVersion = JavaLanguageVersion.of(8)
    }
}

tasks.register('showDefaultToolchain', CustomTaskUsingToolchains) // <b class="conum">(2)</b>

tasks.register('showCustomToolchain', CustomTaskUsingToolchains) {
    launcher = javaToolchains.launcherFor { // <b class="conum">(3)</b>
        languageVersion = JavaLanguageVersion.of(17)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The toolchain defined on the <code>java</code> extension is used by default to resolve the launcher.</p>
</li>
<li>
<p>The custom task without additional configuration will use the default Java 8 toolchain.</p>
</li>
<li>
<p>The other task overrides the value of the launcher by selecting a different toolchain using <code>javaToolchains</code> service.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When a task needs access to toolchains without the <code>java</code> plugin being applied the toolchain service can be used directly.
If an <a href="#sec:configuring_toolchain_specifications">unconfigured</a> toolchain spec is provided to the service, it will always return a tool provider for the toolchain that is running Gradle.
This can be achieved by passing an empty lambda when requesting a tool: <code>javaToolchainService.launcherFor({})</code>.</p>
</div>
<div class="paragraph">
<p>You can find more details on defining custom tasks in the <a href="#more_about_tasks">Authoring tasks</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:limitations"><a class="anchor" href="#sec:limitations"></a><a class="link" href="#sec:limitations">Toolchains limitations</a></h4>
<div class="paragraph">
<p>Gradle may detect toolchains incorrectly when it&#8217;s running in a JVM compiled against <code>musl</code>, an <a href="https://musl.libc.org/">alternative implementation</a> of the C standard library.
JVMs compiled against <code>musl</code> can sometimes override the <code>LD_LIBRARY_PATH</code> environment variable to control dynamic library resolution.
This can influence forked java processes launched by Gradle, resulting in unexpected behavior.</p>
</div>
<div class="paragraph">
<p>As a consequence, using multiple java toolchains is discouraged in environments with the <code>musl</code> library.
This is the case in most Alpine distributions  consider using another distribution, like Ubuntu, instead.
If you are using a single toolchain, the JVM running Gradle, to build and run your application, you can safely ignore this limitation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="toolchain_plugins"><a class="anchor" href="#toolchain_plugins"></a><a class="link" href="#toolchain_plugins">Toolchain Resolver Plugins</a></h3>
<div class="paragraph">
<p>In Gradle version 7.6 and above, Gradle provides a way to define Java toolchain auto-provisioning logic in plugins.
This page explains how to author a toolchain resolver plugin.
For details on how toolchain auto-provisioning interacts with these plugins, see <a href="#sub:download_repositories">Toolchains</a>.</p>
</div>
<div class="sect3">
<h4 id="provide_a_download_uri"><a class="anchor" href="#provide_a_download_uri"></a><a class="link" href="#provide_a_download_uri">Provide a download URI</a></h4>
<div class="paragraph">
<p>Toolchain resolver plugins provide logic to map a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JavaToolchainRequest.html">toolchain request</a> to a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JavaToolchainDownload.html">download response</a>.
At the moment the download response only contains a download URL, but may be extended in the future.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
For the download URL only secure protocols like <code>https</code> are accepted.
This is required to make sure no one can tamper with the download in flight.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The plugins provide the mapping logic via an implementation of <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JavaToolchainResolver.html">JavaToolchainResolver</a>:</p>
</div>
<div class="listingblock">
<div class="title">JavaToolchainResolverImplementation.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class JavaToolchainResolverImplementation
        implements JavaToolchainResolver { // <b class="conum">(1)</b>

    public Optional&lt;JavaToolchainDownload&gt; resolve(JavaToolchainRequest request) { // <b class="conum">(2)</b>
        return Optional.empty(); // custom mapping logic goes here instead
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This class is <code>abstract</code> because <code>JavaToolchainResolver</code> is a <a href="#build_services">build service</a>. Gradle provides dynamic implementations for certain abstract methods at runtime.</p>
</li>
<li>
<p>The mapping method returns a download response wrapped in an <code>Optional</code>. If the resolver implementation can&#8217;t provide a matching toolchain, the enclosing <code>Optional</code> contains an empty value.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="register_the_resolver_in_a_plugin"><a class="anchor" href="#register_the_resolver_in_a_plugin"></a><a class="link" href="#register_the_resolver_in_a_plugin">Register the resolver in a plugin</a></h4>
<div class="paragraph">
<p>Use a settings plugin (<code>Plugin&lt;Settings&gt;</code>) to register the <code>JavaToolchainResolver</code> implementation:</p>
</div>
<div class="listingblock">
<div class="title">JavaToolchainResolverPlugin.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class JavaToolchainResolverPlugin implements Plugin&lt;Settings&gt; { // <b class="conum">(1)</b>
    @Inject
    protected abstract JavaToolchainResolverRegistry getToolchainResolverRegistry(); // <b class="conum">(2)</b>

    public void apply(Settings settings) {
        settings.getPluginManager().apply("jvm-toolchain-management"); // <b class="conum">(3)</b>

        JavaToolchainResolverRegistry registry = getToolchainResolverRegistry();
        registry.register(JavaToolchainResolverImplementation.class);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The plugin uses <a href="#property_injection">property injection</a>, so it must be <code>abstract</code> and a settings plugin.</p>
</li>
<li>
<p>To register the resolver implementation, use property injection to access the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/jvm/toolchain/JavaToolchainResolverRegistry.html">JavaToolchainResolverRegistry</a> Gradle service.</p>
</li>
<li>
<p>Resolver plugins must apply the <code>jvm-toolchain-management</code> base plugin. This dynamically adds the <code>jvm</code> block to <code>toolchainManagement</code>, which makes registered toolchain repositories usable from the build.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jvm_plugins"><a class="anchor" href="#jvm_plugins"></a><a class="link" href="#jvm_plugins">JVM PLUGINS</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="java_library_plugin"><a class="anchor" href="#java_library_plugin"></a><a class="link" href="#java_library_plugin">The Java Library Plugin</a></h3>
<div class="paragraph">
<p>The Java Library plugin expands the capabilities of the <a href="java_plugin.html#java_plugin">Java Plugin (<code>java</code>)</a> by providing specific knowledge about Java libraries.
In particular, a Java library exposes an API to consumers (i.e., other projects using the Java or the Java Library plugin).
All the source sets, tasks and configurations exposed by the Java plugin are implicitly available when using this plugin.</p>
</div>
<div class="sect3">
<h4 id="sec:java_library_usage"><a class="anchor" href="#sec:java_library_usage"></a><a class="link" href="#sec:java_library_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java Library plugin, include the following in your build script:</p>
</div>
<div id="ex-using-the-java-library-plugin" class="exampleblock">
<div class="title">Example 95. <a href="#ex-using-the-java-library-plugin">Using the Java Library plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-library`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-library'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_separation"><a class="anchor" href="#sec:java_library_separation"></a><a class="link" href="#sec:java_library_separation">API and implementation separation</a></h4>
<div class="paragraph">
<p>The key difference between the standard Java plugin and the Java Library plugin is that the latter introduces the concept of an <em>API</em> exposed to consumers. A library is a Java component meant to be consumed by other components. It&#8217;s a very common use case in multi-project builds, but also as soon as you have external dependencies.</p>
</div>
<div class="paragraph">
<p>The plugin exposes two <a href="dependency_configurations.html#sub:what-are-dependency-configurations">configurations</a> that can be used to declare dependencies: <code>api</code> and <code>implementation</code>.
The <code>api</code> configuration should be used to declare dependencies which are exported by the library API, whereas the <code>implementation</code> configuration should be used to declare dependencies which are internal to the component.</p>
</div>
<div id="ex-declaring-api-and-implementation-dependencies" class="exampleblock">
<div class="title">Example 96. <a href="#ex-declaring-api-and-implementation-dependencies">Declaring API and implementation dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    api("org.apache.httpcomponents:httpclient:4.5.7")
    implementation("org.apache.commons:commons-lang3:3.5")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    api 'org.apache.httpcomponents:httpclient:4.5.7'
    implementation 'org.apache.commons:commons-lang3:3.5'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Dependencies appearing in the <code>api</code> configurations will be transitively exposed to consumers of the library, and as such will appear on the compile classpath of consumers. Dependencies found in the <code>implementation</code> configuration will, on the other hand, not be exposed to consumers, and therefore not leak into the consumers' compile classpath. This comes with several benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dependencies do not leak into the compile classpath of consumers anymore, so you will never accidentally depend on a transitive dependency</p>
</li>
<li>
<p>faster compilation thanks to reduced classpath size</p>
</li>
<li>
<p>less recompilations when implementation dependencies change: consumers would not need to be recompiled</p>
</li>
<li>
<p>cleaner publishing: when used in conjunction with the new <code>maven-publish</code> plugin, Java libraries produce POM files that distinguish exactly between what is required to compile against the library and what is required to use the library at runtime (in other words, don&#8217;t mix what is needed to compile the library itself and what is needed to compile against the library).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>compile</code> and <code>runtime</code> configurations have been removed with Gradle 7.0.
Please refer to the <a href="upgrading_version_6.html#sec:configuration_removal">upgrade guide</a> how to migrate to <code>implementation</code> and <code>api</code> configurations`.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If your build consumes a published module with POM metadata, the Java and Java Library plugins both honor api and implementation separation through the scopes used in the POM.
Meaning that the compile classpath only includes Maven <code>compile</code> scoped dependencies, while the runtime classpath adds the Maven <code>runtime</code> scoped dependencies as well.</p>
</div>
<div class="paragraph">
<p>This often does not have an effect on modules published with Maven, where the POM that defines the project is directly published as metadata.
There, the compile scope includes both dependencies that were required to compile the project (i.e. implementation dependencies) and dependencies required to compile against the published library (i.e. API dependencies).
For most published libraries, this means that all dependencies belong to the compile scope.
If you encounter such an issue with an existing library, you can consider a <a href="#component-metadata-rules">component metadata rule</a> to fix the incorrect metadata in your build.
However, as mentioned above, if the library is published with Gradle, the produced POM file only puts <code>api</code> dependencies into the compile scope and the remaining <code>implementation</code> dependencies into the runtime scope.</p>
</div>
<div class="paragraph">
<p>If your build consumes modules with Ivy metadata, you might be able to activate api and implementation separation as described <a href="#sec:ivy-mapping-to-variants">here</a> if all modules follow a certain structure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Separating compile and runtime scope of modules is active by default in Gradle 5.0+.
In Gradle 4.6+, you need to activate it by adding <code>enableFeaturePreview('IMPROVED_POM_SUPPORT')</code> in <em>settings.gradle</em>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_recognizing_dependencies"><a class="anchor" href="#sec:java_library_recognizing_dependencies"></a><a class="link" href="#sec:java_library_recognizing_dependencies">Recognizing API and implementation dependencies</a></h4>
<div class="paragraph">
<p>This section will help you identify API and Implementation dependencies in your code using simple rules of thumb. The first of these is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prefer the <code>implementation</code> configuration over <code>api</code> when possible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This keeps the dependencies off of the consumer&#8217;s compilation classpath. In addition, the consumers will immediately fail to compile if any implementation types accidentally leak into the public API.</p>
</div>
<div class="paragraph">
<p>So when should you use the <code>api</code> configuration? An API dependency is one that contains at least one type that is exposed in the library binary interface, often referred to as its ABI (Application Binary Interface). This includes, but is not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>types used in super classes or interfaces</p>
</li>
<li>
<p>types used in public method parameters, including generic parameter types (where <em>public</em> is something that is visible to compilers. I.e. , <em>public</em>, <em>protected</em> and <em>package private</em> members in the Java world)</p>
</li>
<li>
<p>types used in public fields</p>
</li>
<li>
<p>public annotation types</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By contrast, any type that is used in the following list is irrelevant to the ABI, and therefore should be declared as an <code>implementation</code> dependency:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>types exclusively used in method bodies</p>
</li>
<li>
<p>types exclusively used in private members</p>
</li>
<li>
<p>types exclusively found in internal classes (future versions of Gradle will let you declare which packages belong to the public API)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following class makes use of a couple of third-party libraries, one of which is exposed in the class&#8217;s public API and the other is only used internally. The import statements don&#8217;t help us determine which is which, so we have to look at the fields, constructors and methods instead:</p>
</div>
<div class="sect4">
<h5 id="example_making_the_difference_between_api_and_implementation"><a class="anchor" href="#example_making_the_difference_between_api_and_implementation"></a><a class="link" href="#example_making_the_difference_between_api_and_implementation">Example: Making the difference between API and implementation</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/main/java/org/gradle/HttpClientWrapper.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// The following types can appear anywhere in the code
// but say nothing about API or implementation usage
import org.apache.commons.lang3.exception.ExceptionUtils;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.UnsupportedEncodingException;

public class HttpClientWrapper {

    private final HttpClient client; // private member: implementation details

    // HttpClient is used as a parameter of a public method
    // so "leaks" into the public API of this component
    public HttpClientWrapper(HttpClient client) {
        this.client = client;
    }

    // public methods belongs to your API
    public byte[] doRawGet(String url) {
        HttpGet request = new HttpGet(url);
        try {
            HttpEntity entity = doGet(request);
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            entity.writeTo(baos);
            return baos.toByteArray();
        } catch (Exception e) {
            ExceptionUtils.rethrow(e); // this dependency is internal only
        } finally {
            request.releaseConnection();
        }
        return null;
    }

    // HttpGet and HttpEntity are used in a private method, so they don't belong to the API
    private HttpEntity doGet(HttpGet get) throws Exception {
        HttpResponse response = client.execute(get);
        if (response.getStatusLine().getStatusCode() != HttpStatus.SC_OK) {
            System.err.println("Method failed: " + response.getStatusLine());
        }
        return response.getEntity();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>public</em> constructor of <code>HttpClientWrapper</code> uses <code>HttpClient</code> as a parameter, so it is exposed to consumers and therefore belongs to the API. Note that <code>HttpGet</code> and <code>HttpEntity</code> are used in the signature of a <em>private</em> method, and so they don&#8217;t count towards making HttpClient an API dependency.</p>
</div>
<div class="paragraph">
<p>On the other hand, the <code>ExceptionUtils</code> type, coming from the <code>commons-lang</code> library, is only used in a method body (not in its signature), so it&#8217;s an implementation dependency.</p>
</div>
<div class="paragraph">
<p>Therefore, we can deduce that <code>httpclient</code> is an API dependency, whereas <code>commons-lang</code> is an implementation dependency. This conclusion translates into the following declaration in the build script:</p>
</div>
<div id="ex-declaring-api-and-implementation-dependencies" class="exampleblock">
<div class="title">Example 97. <a href="#ex-declaring-api-and-implementation-dependencies">Declaring API and implementation dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    api("org.apache.httpcomponents:httpclient:4.5.7")
    implementation("org.apache.commons:commons-lang3:3.5")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    api 'org.apache.httpcomponents:httpclient:4.5.7'
    implementation 'org.apache.commons:commons-lang3:3.5'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_configurations_graph"><a class="anchor" href="#sec:java_library_configurations_graph"></a><a class="link" href="#sec:java_library_configurations_graph">The Java Library plugin configurations</a></h4>
<div class="paragraph">
<p>The following graph describes how configurations are setup when the Java Library plugin is in use.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-library-ignore-deprecated-main.png" alt="java library ignore deprecated main">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The configurations in <em>green</em> are the ones a user should use to declare dependencies</p>
</li>
<li>
<p>The configurations in <em>pink</em> are the ones used when a component compiles, or runs against the library</p>
</li>
<li>
<p>The configurations in <em>blue</em> are internal to the component, for its own use</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And the next graph describes the test configurations setup:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-library-ignore-deprecated-test.png" alt="java library ignore deprecated test">
</div>
</div>
<div class="paragraph">
<p>The role of each configuration is described in the following tables:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 8. Java Library plugin - configurations used to declare dependencies</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotationProcessor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring annotation processors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration is used to declare annotation processors, ensuring they are available during the compile phase for code generation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring API dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are transitively exported to consumers, for compile time and runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring implementation dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are purely internal and not meant to be exposed to consumers (they are still exposed to consumers at runtime).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring compile only dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are required at compile time, but not at runtime. This typically includes dependencies which are shaded when found at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileOnlyApi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring compile only API dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are required at compile time by your module and consumers, but not at runtime. This typically includes dependencies which are shaded when found at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>runtimeOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring runtime dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are only required at runtime, and not at compile time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testImplementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are used to compile tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testCompileOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring test compile only dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are only required at test compile time, but should not leak into the runtime. This typically includes dependencies which are shaded when found at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testRuntimeOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring test runtime dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you declare dependencies which are only required at test runtime, and not at test compile time.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 9. Java Library plugin  configurations used by consumers</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apiElements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling against this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration is meant to be used by consumers, to retrieve all the elements necessary to compile against this library.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>runtimeElements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration is meant to be used by consumers, to retrieve all the elements necessary to run against this library.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 10. Java Library plugin - configurations used by the library itself</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compileClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the compile classpath of this library, and is therefore used when invoking the java compiler to compile it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtimeClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the runtime classpath of this library</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">testCompileClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling the tests of this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the test compile classpath of this library.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">testRuntimeClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing tests of this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the test runtime classpath of this library</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:java_library_modular"><a class="anchor" href="#sec:java_library_modular"></a><a class="link" href="#sec:java_library_modular">Building Modules for the Java Module System</a></h4>
<div class="paragraph">
<p>Since Java 9, Java itself offers a <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html">module system</a> that allows for strict encapsulation during compile and runtime.
You can turn a Java library into a <em>Java Module</em> by creating a <code>module-info.java</code> file in the <code>main/java</code> source folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">src
 main
     java
         module-info.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the module info file, you declare a <em>module name</em>, which packages of your module you want to <em>export</em> and which other modules you <em>require</em>.</p>
</div>
<div class="listingblock">
<div class="title">module-info.java file</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">module org.gradle.sample {
    requires com.google.gson;          // real module
    requires org.apache.commons.lang3; // automatic module
    // commons-cli-1.4.jar is not a module and cannot be required
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To tell the Java compiler that a Jar is a module, as opposed to a traditional Java library, Gradle needs to place it on the so called <em>module path</em>.
It is an alternative to the <em>classpath</em>, which is the traditional way to tell the compiler about compiled dependencies.
Gradle will automatically put a Jar of your dependencies on the module path, instead of the classpath, if these three things are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.modularity.inferModulePath</code> is <strong>not</strong> turned off</p>
</li>
<li>
<p>We are actually building a module (as opposed to a traditional library) which we expressed by adding the <code>module-info.java</code> file.
(Another option is to add the <code>Automatic-Module-Name</code> Jar manifest attribute as <a href="#sec:java_library_modular_auto">described further down</a>.)</p>
</li>
<li>
<p>The Jar our module depends on is itself a module, which Gradles decides based on the presence of a <code>module-info.class</code>&#8201;&#8212;&#8201;the compiled version of the module descriptor&#8201;&#8212;&#8201;in the Jar.
(Or, alternatively, the presence of an <code>Automatic-Module-Name</code> attribute the Jar manifest)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following, some more details about defining Java modules and how that interacts with Gradle&#8217;s dependency management are described.
You can also look at a <a href="../samples/sample_java_modules_multi_project.html">ready made example</a> to try out the Java Module support directly.</p>
</div>
<div class="sect4">
<h5 id="declaring_module_dependencies"><a class="anchor" href="#declaring_module_dependencies"></a><a class="link" href="#declaring_module_dependencies">Declaring module dependencies</a></h5>
<div class="paragraph">
<p>There is a direct relationship to the dependencies you declare in the build file and the module dependencies you declare in the <code>module-info.java</code> file.
Ideally the declarations should be in sync as seen in the following table.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 11. Mapping between Java module directives and Gradle configurations to declare dependencies</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Java Module Directive</th>
<th class="tableblock halign-left valign-top">Gradle Configuration</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring implementation dependencies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requires transitive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring API dependencies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requires static</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring compile only dependencies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requires static transitive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileOnlyApi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring compile only API dependencies</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Gradle currently does not automatically check if the dependency declarations are in sync.
This may be added in future versions.</p>
</div>
<div class="paragraph">
<p>For more details on declaring module dependencies, please refer to <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html">documentation on the Java Module System</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="declaring_package_visibility_and_services"><a class="anchor" href="#declaring_package_visibility_and_services"></a><a class="link" href="#declaring_package_visibility_and_services">Declaring package visibility and services</a></h5>
<div class="paragraph">
<p>The Java module system supports additional more fine granular encapsulation concepts than Gradle itself currently does.
For example, you explicitly need to declare which packages are part of your API and which are only visible inside your module.
Some of these capabilities might be added to Gradle itself in future versions.
For now, please refer to <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html">documentation on the Java Module System</a> to learn how to use these features in Java Modules.</p>
</div>
</div>
<div class="sect4">
<h5 id="declaring_module_versions"><a class="anchor" href="#declaring_module_versions"></a><a class="link" href="#declaring_module_versions">Declaring module versions</a></h5>
<div class="paragraph">
<p>Java Modules also have a version that is encoded as part of the module identity in the <code>module-info.class</code> file.
This version can be inspected when a module is running.</p>
</div>
<div id="ex-declare-the-module-version-in-the-build-script-or-directly-as-compile-task-option" class="exampleblock">
<div class="title">Example 98. <a href="#ex-declare-the-module-version-in-the-build-script-or-directly-as-compile-task-option">Declare the module version in the build script or directly as compile task option</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">version = "1.2"

tasks.compileJava {
    // use the project's version or define one directly
    options.javaModuleVersion = provider { version as String }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">version = '1.2'

tasks.named('compileJava') {
    // use the project's version or define one directly
    options.javaModuleVersion = provider { version }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_libraries_that_are_not_modules"><a class="anchor" href="#using_libraries_that_are_not_modules"></a><a class="link" href="#using_libraries_that_are_not_modules">Using libraries that are not modules</a></h5>
<div class="paragraph">
<p>You probably want to use external libraries, like OSS libraries from Maven Central, in your modular Java project.
Some libraries, in their newer versions, are already full modules with a module descriptor.
For example, <code>com.google.code.gson:gson:2.8.9</code> that has the module name <code>com.google.gson</code>.</p>
</div>
<div class="paragraph">
<p>Others, like <code>org.apache.commons:commons-lang3:3.10</code>, may not offer a full module descriptor but will at least contain an <code>Automatic-Module-Name</code> entry in their manifest file to define the module&#8217;s name (<code>org.apache.commons.lang3</code> in the example).
Such modules, that only have a name as module description, are called <em>automatic module</em> that export <strong>all</strong> their packages and can read <strong>all</strong> modules on the module path.</p>
</div>
<div class="paragraph">
<p>A third case are traditional libraries that provide no module information at all&#8201;&#8212;&#8201;for example <code>commons-cli:commons-cli:1.4</code>.
Gradle puts such libraries on the classpath instead of the module path.
The classpath is then treated as one module (the so called <em>unnamed</em> module) by Java.</p>
</div>
<div id="ex-dependencies-to-modules-and-libraries-declared-in-build-file" class="exampleblock">
<div class="title">Example 99. <a href="#ex-dependencies-to-modules-and-libraries-declared-in-build-file">Dependencies to modules and libraries declared in build file</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation("com.google.code.gson:gson:2.13.1")      // real module
    implementation("org.apache.commons:commons-lang3:3.10") // automatic module
    implementation("commons-cli:commons-cli:1.4")           // plain library
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation 'com.google.code.gson:gson:2.13.1'      // real module
    implementation 'org.apache.commons:commons-lang3:3.10' // automatic module
    implementation 'commons-cli:commons-cli:1.4'           // plain library
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Module dependencies declared in module-info.java file</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">module org.gradle.sample.lib {
    requires com.google.gson;          // real module
    requires org.apache.commons.lang3; // automatic module
    // commons-cli-1.4.jar is not a module and cannot be required
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>While a real module cannot directly depend on the unnamed module (only by adding command line flags), automatic modules can also see the unnamed module.
Thus, if you cannot avoid to rely on a library without module information, you can wrap that library in an automatic module as part of your project.
How you do that is described in the next section.</p>
</div>
<div class="paragraph">
<p>Another way to deal with non-modules is to enrich existing Jars with module descriptors yourself using <a href="#sec:abm-artifact-transforms">artifact transforms</a>.
<a href="../samples/sample_java_modules_with_transform.html">This sample</a> contains a small <em>buildSrc</em> plugin registering such a transform which you may use and adjust to your needs.
This can be interesting if you want to build a fully <a href="#sec:application_modular">modular application</a> and want the java runtime to treat everything as a real module.</p>
</div>
</div>
<div class="sect4">
<h5 id="disabling_java_module_support"><a class="anchor" href="#disabling_java_module_support"></a><a class="link" href="#disabling_java_module_support">Disabling Java Module support</a></h5>
<div class="paragraph">
<p>In rare cases, you might want to disable the built-in Java Module support and define the module path by other means.
To achieve this, you can disable the functionality to automatically put any Jar on the module path.
Then Gradle puts Jars with module information on the classpath, even if you have a <code>module-info.java</code> in your source set.
This corresponds to the behaviour of Gradle versions &lt;7.0.</p>
</div>
<div class="paragraph">
<p>To make this work, you need to set <code>modularity.inferModulePath = false</code> on the Java extension (for all tasks) or on individual tasks.</p>
</div>
<div id="ex-disable-gradles-module-path-inference" class="exampleblock">
<div class="title">Example 100. <a href="#ex-disable-gradles-module-path-inference">Disable Gradle&#8217;s module path inference</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    modularity.inferModulePath = false
}

tasks.compileJava {
    modularity.inferModulePath = false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    modularity.inferModulePath = false
}

tasks.named('compileJava') {
    modularity.inferModulePath = false
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_library_modular_auto"><a class="anchor" href="#sec:java_library_modular_auto"></a><a class="link" href="#sec:java_library_modular_auto">Building an automatic module</a></h5>
<div class="paragraph">
<p>If you can, you should always write complete <code>module-info.java</code> descriptors for your modules.
Still, there are a few cases where you might consider to (initally) only provide a <em>module name</em> for an automatic module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You are working on a library that is <strong>not</strong> a module but you want to make it usable as such in the next release.
Adding an <code>Automatic-Module-Name</code> is a good first step (most popular OSS libraries on Maven central have done it by now).</p>
</li>
<li>
<p>As discussed in the previous section, an automatic module can be used as an adapter between your real modules and a traditional library on the classpath.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To turn a normal Java project into an <em>automatic module</em>, just add the manifest entry with the module name:</p>
</div>
<div id="ex-declare-an-automatic-module-name-as-jar-manifest-attribute" class="exampleblock">
<div class="title">Example 101. <a href="#ex-declare-an-automatic-module-name-as-jar-manifest-attribute">Declare an automatic module name as Jar manifest attribute</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.jar {
    manifest {
        attributes("Automatic-Module-Name" to "org.gradle.sample")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('jar') {
    manifest {
        attributes('Automatic-Module-Name': 'org.gradle.sample')
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
===
You can define an automatic module as part of a multi-project that otherwise defines real modules (e.g. as an adapter to another library).
While this works fine in the Gradle build, such automatic module projects are not correctly recognized by IDEA/Eclipse at the moment.
You can work around it by manually adding the Jar built for the automatic module to the dependencies of the project that does not find it in the IDE&#8217;s UI.
===
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_classes_usage"><a class="anchor" href="#sec:java_library_classes_usage"></a><a class="link" href="#sec:java_library_classes_usage">Using classes instead of jar for compilation</a></h4>
<div class="paragraph">
<p>A feature of the <code>java-library</code> plugin is that projects which consume the library only require the classes folder for compilation, instead of the full JAR.
This enables lighter inter-project dependencies as resources processing (<code>processResources</code> task) and archive construction (<code>jar</code> task) are no longer executed when only Java code compilation is performed during development.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The usage or not of the classes output instead of the JAR is a <em>consumer</em> decision.
For example, Groovy consumers will request classes <em>and</em> processed resources as these may be needed for executing AST transformation as part of the compilation process.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sub:java_library_known_issues_memory"><a class="anchor" href="#sub:java_library_known_issues_memory"></a><a class="link" href="#sub:java_library_known_issues_memory">Increased memory usage for consumers</a></h5>
<div class="paragraph">
<p>An indirect consequence is that up-to-date checking will require more memory, because Gradle will snapshot individual class files instead of a single jar.
This may lead to increased memory consumption for large projects, with the benefit of having the <code>compileJava</code> task up-to-date in more cases (e.g. changing resources no longer changes the input for <code>compileJava</code> tasks of upstream projects)</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:java_library_known_issues_windows_performance"><a class="anchor" href="#sub:java_library_known_issues_windows_performance"></a><a class="link" href="#sub:java_library_known_issues_windows_performance">Significant build performance drop on Windows for huge multi-projects</a></h5>
<div class="paragraph">
<p>Another side effect of the snapshotting of individual class files, only affecting Windows systems, is that the performance can significantly drop when processing a very large amount of class files on the compile classpath.
This only concerns very large multi-projects where a lot of classes are present on the classpath by using many <code>api</code> dependencies.
To mitigate this, you can set the <code>org.gradle.java.compile-classpath-packaging</code> system property to <code>true</code> to change the behavior of the Java Library plugin to use jars instead of class folders for everything on the compile classpath.
Note, since this has other performance impacts and potentially side effects, by triggering all jar tasks at compile time, it is only recommended to activate this if you suffer from the described performance issue on Windows.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:library_distribution"><a class="anchor" href="#sec:library_distribution"></a><a class="link" href="#sec:library_distribution">Distributing a library</a></h4>
<div class="paragraph">
<p>Aside from <a href="#publishing_components">publishing</a> a library to a component repository, you may sometimes need to package a library and its dependencies in a distribution deliverable.
The <a href="java_library_distribution_plugin.html#java_library_distribution_plugin">Java Library Distribution Plugin</a> is there to help you do just that.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="application_plugin"><a class="anchor" href="#application_plugin"></a><a class="link" href="#application_plugin">The Application Plugin</a></h3>
<div class="paragraph">
<p>The Application plugin facilitates creating an executable JVM application. It makes it easy to start the application locally during development, and to package the application as a TAR and/or ZIP including operating system specific start scripts.</p>
</div>
<div class="paragraph">
<p>Applying the Application plugin also implicitly applies the <a href="java_plugin.html#java_plugin">Java plugin</a>. The <code>main</code> source set is effectively the "application".</p>
</div>
<div class="paragraph">
<p>Applying the Application plugin also implicitly applies the <a href="distribution_plugin.html#distribution_plugin">Distribution plugin</a>. A <code>main</code> distribution is created that packages up the application, including code dependencies and generated start scripts.</p>
</div>
<div class="sect3">
<h4 id="sec:application_usage"><a class="anchor" href="#sec:application_usage"></a><a class="link" href="#sec:application_usage">Building JVM applications</a></h4>
<div class="paragraph">
<p>To use the application plugin, include the following in your build script:</p>
</div>
<div id="ex-using-the-application-plugin" class="exampleblock">
<div class="title">Example 102. <a href="#ex-using-the-application-plugin">Using the application plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    application
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'application'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The only mandatory configuration for the plugin is the specification of the main class (i.e. entry point) of the application.</p>
</div>
<div id="ex-configure-the-application-main-class" class="exampleblock">
<div class="title">Example 103. <a href="#ex-configure-the-application-main-class">Configure the application main class</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application {
    mainClass = "org.gradle.sample.Main"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application {
    mainClass = 'org.gradle.sample.Main'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can run the application by executing the <code>run</code> task (type: <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/JavaExec.html">JavaExec</a>). This will compile the main source set, and launch a new JVM with its classes (along with all runtime dependencies) as the classpath and using the specified main class. You can launch the application in debug mode with <code>gradle run --debug-jvm</code> (see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/JavaExec.html#setDebug-boolean-">JavaExec.setDebug(boolean)</a>).</p>
</div>
<div class="paragraph">
<p>Since Gradle 4.9, the command line arguments can be passed with <code>--args</code>. For example, if you want to launch the application with command line arguments <code>foo --bar</code>, you can use <code>gradle run --args="foo --bar"</code> (see <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/JavaExec.html#setArgsString-java.lang.String-">JavaExec.setArgsString(java.lang.String)</a>.</p>
</div>
<div class="paragraph">
<p>If your application requires a specific set of JVM settings or system properties, you can configure the <code>applicationDefaultJvmArgs</code> property. These JVM arguments are applied to the <code>run</code> task and also considered in the generated start scripts of your distribution.</p>
</div>
<div id="ex-configure-default-jvm-settings" class="exampleblock">
<div class="title">Example 104. <a href="#ex-configure-default-jvm-settings">Configure default JVM settings</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application {
    applicationDefaultJvmArgs = listOf("-Dgreeting.language=en")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application {
    applicationDefaultJvmArgs = ['-Dgreeting.language=en']
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If your application&#8217;s start scripts should be in a different directory than <code>bin</code>, you can configure the <code>executableDir</code> property.</p>
</div>
<div id="ex-configure-custom-directory-for-start-scripts" class="exampleblock">
<div class="title">Example 105. <a href="#ex-configure-custom-directory-for-start-scripts">Configure custom directory for start scripts</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application {
    executableDir = "custom_bin_dir"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application {
    executableDir = 'custom_bin_dir'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_modular"><a class="anchor" href="#sec:application_modular"></a><a class="link" href="#sec:application_modular">Building applications using the Java Module System</a></h4>
<div class="paragraph">
<p>Gradle supports the building of <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html">Java Modules</a> as described in the <a href="#sec:java_library_modular">corresponding section of the Java Library plugin documentation</a>.
Java modules can also be runnable and you can use the application plugin to run and package such a modular application.
For this, you need to do two things in addition to what you do for a non-modular application.</p>
</div>
<div class="paragraph">
<p>First, you need to add a <code>module-info.java</code> file to describe your application module.
Please refer to the <a href="#sec:java_library_modular">Java Library plugin documentation</a> for more details on this topic.</p>
</div>
<div class="paragraph">
<p>Second, you need to tell Gradle the name of the module you want to run in addition to the main class name like this:</p>
</div>
<div id="ex-configure-the-modular-applications-main-module" class="exampleblock">
<div class="title">Example 106. <a href="#ex-configure-the-modular-applications-main-module">Configure the modular application&#8217;s main module</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application {
    mainModule = "org.gradle.sample.app" // name defined in module-info.java
    mainClass = "org.gradle.sample.Main"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application {
    mainModule = 'org.gradle.sample.app' // name defined in module-info.java
    mainClass = 'org.gradle.sample.Main'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s all.
If you run your application, by executing the <code>run</code> task or through a <a href="#sec:the_distribution">generated start script</a>, it will run as module and respect module boundaries at runtime.
For example, reflective access to an internal package from another module can fail.</p>
</div>
<div class="paragraph">
<p>The configured <em>main class</em> is also baked into the <code>module-info.class</code> file of your application Jar.
If you run the modular application directly using the <code>java</code> command, it is then sufficient to provide the module name.</p>
</div>
<div class="paragraph">
<p>You can also look at a <a href="../samples/sample_java_modules_multi_project.html">ready made example</a> that includes a modular application as part of a multi-project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:the_distribution"><a class="anchor" href="#sec:the_distribution"></a><a class="link" href="#sec:the_distribution">Building a distribution</a></h4>
<div class="paragraph">
<p>A distribution of the application can be created, by way of the <a href="distribution_plugin.html#distribution_plugin">Distribution plugin</a> (which is automatically applied). A <code>main</code> distribution is created with the following content:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 12. Distribution content</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(root dir)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/dist</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All runtime dependencies and main source set class files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start scripts (generated by <code>startScripts</code> task).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Static files to be added to the distribution can be simply added to <code>src/dist</code>. More advanced customization can be done by configuring the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/CopySpec.html">CopySpec</a> exposed by the main distribution.</p>
</div>
<div id="ex-include-output-from-other-tasks-in-the-application-distribution" class="exampleblock">
<div class="title">Example 107. <a href="#ex-include-output-from-other-tasks-in-the-application-distribution">Include output from other tasks in the application distribution</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val createDocs by tasks.registering {
    val docs = layout.buildDirectory.dir("docs")
    outputs.dir(docs)
    doLast {
        docs.get().asFile.mkdirs()
        docs.get().file("readme.txt").asFile.writeText("Read me!")
    }
}

distributions {
    main {
        contents {
            from(createDocs) {
                into("docs")
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.register('createDocs') {
    def docs = layout.buildDirectory.dir('docs')
    outputs.dir docs
    doLast {
        docs.get().asFile.mkdirs()
        docs.get().file('readme.txt').asFile.write('Read me!')
    }
}

distributions {
    main {
        contents {
            from(createDocs) {
                into 'docs'
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By specifying that the distribution should include the task&#8217;s output files (see <a href="incremental_build.html#sec:task_inputs_outputs">incremental builds</a>), Gradle knows that the task that produces the files must be invoked before the distribution can be assembled and will take care of this for you.</p>
</div>
<div class="paragraph">
<p>You can run <code>gradle installDist</code> to create an image of the application in <code>build/install/<em>projectName</em></code>. You can run <code>gradle distZip</code> to create a ZIP containing the distribution, <code>gradle distTar</code> to create an application TAR or <code>gradle assemble</code> to build both.</p>
</div>
<div class="sect4">
<h5 id="sec:customizing_start_script_generation"><a class="anchor" href="#sec:customizing_start_script_generation"></a><a class="link" href="#sec:customizing_start_script_generation">Customizing start script generation</a></h5>
<div class="paragraph">
<p>The application plugin can generate Unix (suitable for Linux, macOS etc.) and Windows start scripts out of the box.
The start scripts launch a JVM with the specified settings defined as part of the original build and runtime environment (e.g. <code>JAVA_OPTS</code> env var).
The default script templates are based on the same scripts used to launch Gradle itself, that ship as part of a Gradle distribution.</p>
</div>
<div class="paragraph">
<p>The start scripts are completely customizable.
Please refer to the documentation of <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.jvm.application.tasks.CreateStartScripts.html">CreateStartScripts</a> for more details and customization examples.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_tasks"><a class="anchor" href="#sec:application_tasks"></a><a class="link" href="#sec:application_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Application plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>run</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.JavaExec.html">JavaExec</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Starts the application.</p>
</div>
</dd>
<dt class="hdlist1"><code>startScripts</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.jvm.application.tasks.CreateStartScripts.html">CreateStartScripts</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code></p>
<div class="paragraph">
<p>Creates OS specific scripts to run the project as a JVM application.</p>
</div>
</dd>
<dt class="hdlist1"><code>installDist</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.Sync.html">Sync</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Installs the application into a specified directory.</p>
</div>
</dd>
<dt class="hdlist1"><code>distZip</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Creates a full distribution ZIP archive including runtime libraries and OS specific scripts.</p>
</div>
</dd>
<dt class="hdlist1"><code>distTar</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Creates a full distribution TAR archive including runtime libraries and OS specific scripts.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_extension"><a class="anchor" href="#sec:application_extension"></a><a class="link" href="#sec:application_extension">Application extension</a></h4>
<div class="paragraph">
<p>The Application Plugin adds an extension to the project, which you can use to configure its behavior. See the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.plugins.JavaApplication.html">JavaApplication</a> DSL documentation for more information on the properties available on the extension.</p>
</div>
<div class="paragraph">
<p>You can configure the extension via the <code>application {}</code> block shown earlier, for example using the following in your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application {
    executableDir = "custom_bin_dir"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application {
    executableDir = 'custom_bin_dir'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_licensing"><a class="anchor" href="#sec:application_licensing"></a><a class="link" href="#sec:application_licensing">License of start scripts</a></h4>
<div class="paragraph">
<p>The start scripts generated for the application are licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 Software License</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_convention_properties"><a class="anchor" href="#sec:application_convention_properties"></a><a class="link" href="#sec:application_convention_properties">Convention properties (deprecated)</a></h4>
<div class="paragraph">
<p>This plugin also adds some convention properties to the project, which you can use to configure its behavior. These are <strong>deprecated</strong> and superseded by the extension described above. See the <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.Project.html#N14FED">Project</a> DSL documentation for information on them.</p>
</div>
<div class="paragraph">
<p>Unlike the extension properties, these properties appear as top-level project properties in the build script. For example, to change the application name you can just add the following to your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">application.applicationName = "my-app"</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">application.applicationName = 'my-app'</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_platform_plugin"><a class="anchor" href="#java_platform_plugin"></a><a class="link" href="#java_platform_plugin">The Java Platform Plugin</a></h3>
<div class="paragraph">
<p>The Java Platform plugin brings the ability to declare platforms for the Java ecosystem.
A platform can be used for different purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a description of modules which are published together (and for example, share the same version)</p>
</li>
<li>
<p>a set of recommended versions for heterogeneous libraries. A typical example includes the <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/using-boot-build-systems.html#using-boot-dependency-management">Spring Boot BOM</a></p>
</li>
<li>
<p><a href="#sec:java_platform_consumption">sharing a set of dependency versions</a> between subprojects</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A platform is a special kind of software component which doesn&#8217;t contain any sources:
it is only used to reference other libraries, so that they play well together during dependency resolution.</p>
</div>
<div class="paragraph">
<p>Platforms can be published as <a href="https://github.com/gradle/gradle/blob/master/platforms/documentation/docs/src/docs/design/gradle-module-metadata-latest-specification.md">Gradle Module Metadata</a> and <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Dependency_Management">Maven BOMs</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>java-platform</code> plugin cannot be used in combination with the <code>java</code> or <code>java-library</code> plugins in a given project.
Conceptually a project is either a platform, with no binaries, <em>or</em> produces binaries.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:java_platform_usage"><a class="anchor" href="#sec:java_platform_usage"></a><a class="link" href="#sec:java_platform_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java Platform plugin, include the following in your build script:</p>
</div>
<div id="ex-using-the-java-platform-plugin" class="exampleblock">
<div class="title">Example 108. <a href="#ex-using-the-java-platform-plugin">Using the Java Platform plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    `java-platform`
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'java-platform'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_platform_separation"><a class="anchor" href="#sec:java_platform_separation"></a><a class="link" href="#sec:java_platform_separation">API and runtime separation</a></h4>
<div class="paragraph">
<p>A major difference between a Maven BOM and a Java platform is that in Gradle dependencies and <a href="glossary.html#sub:terminology_dependency_constraint">constraints</a> are declared and scoped to a configuration and the ones extending it.
While many users will only care about declaring constraints for <em>compile time</em> dependencies, thus inherited by runtime and tests ones, it allows declaring dependencies or constraints that only apply to runtime or test.</p>
</div>
<div class="paragraph">
<p>For this purpose, the plugin exposes two <a href="dependency_configurations.html#sub:what-are-dependency-configurations">configurations</a> that can be used to declare dependencies: <code>api</code> and <code>runtime</code>.
The <code>api</code> configuration should be used to declare constraints and dependencies which should be used when compiling against the platform, whereas the <code>runtime</code> configuration should be used to declare constraints or dependencies which are visible at runtime.</p>
</div>
<div id="ex-declaring-api-and-runtime-constraints" class="exampleblock">
<div class="title">Example 109. <a href="#ex-declaring-api-and-runtime-constraints">Declaring API and runtime constraints</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    constraints {
        api("commons-httpclient:commons-httpclient:3.1")
        runtime("org.postgresql:postgresql:42.2.5")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    constraints {
        api 'commons-httpclient:commons-httpclient:3.1'
        runtime 'org.postgresql:postgresql:42.2.5'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that this example makes use of <em>constraints</em> and not dependencies.
In general, this is what you would like to do: constraints will only apply if such a component is added to the dependency graph, either directly or transitively.
This means that all constraints listed in a platform would not add a dependency unless another component brings it in: they can be seen as <em>recommendations</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For example, if a platform declares a constraint on <code>org:foo:1.1</code>, and that nothing else brings in a dependency on <code>foo</code>, <code>foo</code> will <em>not</em> appear in the graph.
However, if <code>foo</code> appears, then usual conflict resolution would kick in.
If a dependency brings in <code>org:foo:1.0</code>, then we would select <code>org:foo:1.1</code> to satisfy the platform constraint.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, in order to avoid the common mistake of adding a dependency in a platform instead of a constraint, Gradle will fail if you try to do so.
If, for some reason, you also want to add <em>dependencies</em> in addition to constraints, you need to enable it explicitly:</p>
</div>
<div id="ex-allowing-declaration-of-dependencies" class="exampleblock">
<div class="title">Example 110. <a href="#ex-allowing-declaration-of-dependencies">Allowing declaration of dependencies</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">javaPlatform {
    allowDependencies()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">javaPlatform {
    allowDependencies()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_platform_project_constraints"><a class="anchor" href="#sec:java_platform_project_constraints"></a><a class="link" href="#sec:java_platform_project_constraints">Local project constraints</a></h4>
<div class="paragraph">
<p>If you have a multi-project build and want to publish a platform that links to subprojects, you can do it by declaring constraints on the subprojects which belong to the platform, as in the example below:</p>
</div>
<div id="ex-declaring-constraints-on-subprojects" class="exampleblock">
<div class="title">Example 111. <a href="#ex-declaring-constraints-on-subprojects">Declaring constraints on subprojects</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    constraints {
        api(project(":core"))
        api(project(":lib"))
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    constraints {
        api project(":core")
        api project(":lib")
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The project notation will become a classical <code>group:name:version</code> notation in the published metadata.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_platform_bom_import"><a class="anchor" href="#sec:java_platform_bom_import"></a><a class="link" href="#sec:java_platform_bom_import">Sourcing constraints from another platform</a></h4>
<div class="paragraph">
<p>Sometimes the platform you define is an extension of another existing platform.</p>
</div>
<div class="paragraph">
<p>In order to have your platform include the constraints from that third party platform, it needs to be imported as a <code>platform</code> <em>dependency</em>:</p>
</div>
<div id="ex-importing-a-platform" class="exampleblock">
<div class="title">Example 112. <a href="#ex-importing-a-platform">Importing a platform</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">javaPlatform {
    allowDependencies()
}

dependencies {
    api(platform("com.fasterxml.jackson:jackson-bom:2.9.8"))
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">javaPlatform {
    allowDependencies()
}

dependencies {
    api platform('com.fasterxml.jackson:jackson-bom:2.9.8')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_platform_publishing"><a class="anchor" href="#sec:java_platform_publishing"></a><a class="link" href="#sec:java_platform_publishing">Publishing platforms</a></h4>
<div class="paragraph">
<p>Publishing Java platforms is done by applying the <code>maven-publish</code> plugin and configuring a Maven publication that uses the <code>javaPlatform</code> component:</p>
</div>
<div id="ex-publishing-as-a-bom" class="exampleblock">
<div class="title">Example 113. <a href="#ex-publishing-as-a-bom">Publishing as a BOM</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("myPlatform") {
            from(components["javaPlatform"])
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">publishing {
    publications {
        myPlatform(MavenPublication) {
            from components.javaPlatform
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will generate a BOM file for the platform, with a <code>&lt;dependencyManagement&gt;</code> block where its <code>&lt;dependencies&gt;</code> correspond to the constraints defined in the platform module.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_platform_consumption"><a class="anchor" href="#sec:java_platform_consumption"></a><a class="link" href="#sec:java_platform_consumption">Consuming platforms</a></h4>
<div class="paragraph">
<p>Because a Java Platform is a special kind of component, a dependency on a Java platform has to be declared using the <code>platform</code> or <code>enforcedPlatform</code> keyword, as explained in the <a href="#sec:bom-import">managing transitive dependencies</a> section.
For example, if you want to share dependency versions between subprojects, you can define a platform module which would declare all versions:</p>
</div>
<div id="ex-recommend-versions-in-a-platform-module" class="exampleblock">
<div class="title">Example 114. <a href="#ex-recommend-versions-in-a-platform-module">Recommend versions in a platform module</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api("commons-httpclient:commons-httpclient:3.1")
        api("org.apache.commons:commons-lang3:3.8.1")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    constraints {
        // Platform declares some versions of libraries used in subprojects
        api 'commons-httpclient:commons-httpclient:3.1'
        api 'org.apache.commons:commons-lang3:3.8.1'
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And then have subprojects depend on the platform to get recommendations:</p>
</div>
<div id="ex-get-recommendations-from-a-platform" class="exampleblock">
<div class="title">Example 115. <a href="#ex-get-recommendations-from-a-platform">Get recommendations from a platform</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    // get recommended versions from the platform project
    api(platform(project(":platform")))
    // no version required
    api("commons-httpclient:commons-httpclient")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    // get recommended versions from the platform project
    api platform(project(':platform'))
    // no version required
    api 'commons-httpclient:commons-httpclient'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="groovy_plugin"><a class="anchor" href="#groovy_plugin"></a><a class="link" href="#groovy_plugin">The Groovy Plugin</a></h3>
<div class="paragraph">
<p>The Groovy plugin extends the <a href="java_plugin.html#java_plugin">Java plugin</a> to add support for <a href="https://groovy-lang.org/">Groovy</a> projects.
It can deal with Groovy code, mixed Groovy and Java code, and even pure Java code (although we don&#8217;t necessarily recommend to use it for the latter).
The plugin supports <em>joint compilation</em>, which allows you to freely mix and match Groovy and Java code, with dependencies in both directions.
For example, a Groovy class can extend a Java class that in turn extends a Groovy class.
This makes it possible to use the best language for the job, and to rewrite any class in the other language if needed.</p>
</div>
<div class="paragraph">
<p>Note that if you want to benefit from the <a href="#sec:java_library_separation">API / implementation separation</a>, you can also apply the <code>java-library</code> plugin to your Groovy project.</p>
</div>
<div class="sect3">
<h4 id="sec:groovy_usage"><a class="anchor" href="#sec:groovy_usage"></a><a class="link" href="#sec:groovy_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Groovy plugin, include the following in your build script:</p>
</div>
<div id="ex-using-the-groovy-plugin" class="exampleblock">
<div class="title">Example 116. <a href="#ex-using-the-groovy-plugin">Using the Groovy plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    groovy
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'groovy'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_tasks"><a class="anchor" href="#sec:groovy_tasks"></a><a class="link" href="#sec:groovy_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds the following tasks to the project.
Information about altering the dependencies to Java compile tasks are found <a href="#sec:building_jvm_lang">here</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compileGroovy</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileJava</code></p>
<div class="paragraph">
<p>Compiles production Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileTestGroovy</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileTestJava</code></p>
<div class="paragraph">
<p>Compiles test Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compile<em>SourceSet</em>Groovy</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile<em>SourceSet</em>Java</code></p>
<div class="paragraph">
<p>Compiles the given source set&#8217;s Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>groovydoc</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.javadoc.Groovydoc.html">Groovydoc</a></dt>
<dd>
<div class="paragraph">
<p>Generates API documentation for the production Groovy source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Groovy plugin adds the following dependencies to tasks added by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 13. Groovy plugin - additional task dependencies</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileGroovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testClasses</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileTestGroovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>Classes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile<em>SourceSet</em>Groovy</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="img/groovyPluginTasks.png" alt="groovyPluginTasks">
</div>
<div class="title">Figure 20. Groovy plugin - tasks</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_project_layout"><a class="anchor" href="#sec:groovy_project_layout"></a><a class="link" href="#sec:groovy_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The Groovy plugin assumes the project layout shown in <a href="#groovylayout">Groovy Layout</a>. All the Groovy source directories can contain Groovy <em>and</em> Java code. The Java source directories may only contain Java source code.<sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup> None of these directories need to exist or have anything in them; the Groovy plugin will simply compile whatever it finds.</p>
</div>
<div id="groovylayout" class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/java</code></dt>
<dd>
<p>Production Java source.</p>
</dd>
<dt class="hdlist1"><code>src/main/resources</code></dt>
<dd>
<p>Production resources, such as XML and properties files.</p>
</dd>
<dt class="hdlist1"><code>src/main/groovy</code></dt>
<dd>
<p>Production Groovy source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/test/java</code></dt>
<dd>
<p>Test Java source.</p>
</dd>
<dt class="hdlist1"><code>src/test/resources</code></dt>
<dd>
<p>Test resources.</p>
</dd>
<dt class="hdlist1"><code>src/test/groovy</code></dt>
<dd>
<p>Test Groovy source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/java</code></dt>
<dd>
<p>Java source for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/resources</code></dt>
<dd>
<p>Resources for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/groovy</code></dt>
<dd>
<p>Groovy source files for the given source set. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:changing_groovy_project_layout"><a class="anchor" href="#sec:changing_groovy_project_layout"></a><a class="link" href="#sec:changing_groovy_project_layout">Changing the project layout</a></h5>
<div class="paragraph">
<p>Just like the Java plugin, the Groovy plugin allows you to configure custom locations for Groovy production and test source files.</p>
</div>
<div id="ex-custom-groovy-source-layout" class="exampleblock">
<div class="title">Example 117. <a href="#ex-custom-groovy-source-layout">Custom Groovy source layout</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    main {
        groovy {
            setSrcDirs(listOf("src/groovy"))
        }
    }

    test {
        groovy {
            setSrcDirs(listOf("test/groovy"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sourceSets {
    main {
        groovy {
            srcDirs = ['src/groovy']
        }
    }

    test {
        groovy {
            srcDirs = ['test/groovy']
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_dependency_management"><a class="anchor" href="#sec:groovy_dependency_management"></a><a class="link" href="#sec:groovy_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>Because Gradle&#8217;s build language is based on Groovy, Gradle already ships with a Groovy library. Nevertheless, Groovy projects need to explicitly declare a Groovy dependency. This dependency will then be used on compile and runtime class paths. It will also be used to get hold of the Groovy compiler and Groovydoc tool, respectively.</p>
</div>
<div class="paragraph">
<p>If Groovy is used for production code, the Groovy dependency should be added to the <code>implementation</code> configuration:</p>
</div>
<div id="ex-configuration-of-groovy-dependency" class="exampleblock">
<div class="title">Example 118. <a href="#ex-configuration-of-groovy-dependency">Configuration of Groovy dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.codehaus.groovy:groovy-all:2.4.15")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.codehaus.groovy:groovy-all:2.4.15'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If Groovy is only used for test code, the Groovy dependency should be added to the <code>testImplementation</code> configuration:</p>
</div>
<div id="ex-configuration-of-groovy-test-dependency" class="exampleblock">
<div class="title">Example 119. <a href="#ex-configuration-of-groovy-test-dependency">Configuration of Groovy test dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.codehaus.groovy:groovy-all:2.4.15")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation 'org.codehaus.groovy:groovy-all:2.4.15'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To use the Groovy library that ships with Gradle, declare a <code>localGroovy()</code> dependency. Note that different Gradle versions ship with different Groovy versions; as such, using <code>localGroovy()</code> is less safe then declaring a regular Groovy dependency.</p>
</div>
<div id="ex-configuration-of-bundled-groovy-dependency" class="exampleblock">
<div class="title">Example 120. <a href="#ex-configuration-of-bundled-groovy-dependency">Configuration of bundled Groovy dependency</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    implementation(localGroovy())
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation localGroovy()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:automatic_configuration_of_groovyclasspath"><a class="anchor" href="#sec:automatic_configuration_of_groovyclasspath"></a><a class="link" href="#sec:automatic_configuration_of_groovyclasspath">Automatic configuration of groovyClasspath</a></h4>
<div class="paragraph">
<p>The <code>GroovyCompile</code> and <code>Groovydoc</code> tasks consume Groovy code in two ways: on their <code>classpath</code>, and on their <code>groovyClasspath</code>. The former is used to locate classes referenced by the source code, and will typically contain the Groovy library along with other libraries. The latter is used to load and execute the Groovy compiler and Groovydoc tool, respectively, and should only contain the Groovy library and its dependencies.</p>
</div>
<div class="paragraph">
<p>Unless a task&#8217;s <code>groovyClasspath</code> is configured explicitly, the Groovy (base) plugin will try to infer it from the task&#8217;s <code>classpath</code>. This is done as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a <code>groovy-all(-indy)</code> Jar is found on <code>classpath</code>, that jar will be added to <code>groovyClasspath</code>.</p>
</li>
<li>
<p>If a <code>groovy(-indy)</code> jar is found on <code>classpath</code>, and the project has at least one repository declared, a corresponding <code>groovy(-indy)</code> repository dependency will be added to <code>groovyClasspath</code>.</p>
</li>
<li>
<p>Otherwise, execution of the task will fail with a message saying that <code>groovyClasspath</code> could not be inferred.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the &#8220;-indy&#8221; variation of each jar refers to the version with <code>invokedynamic</code> support.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_convention_properties"><a class="anchor" href="#sec:groovy_convention_properties"></a><a class="link" href="#sec:groovy_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Groovy plugin does not add any convention properties to the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_source_set_properties"><a class="anchor" href="#sec:groovy_source_set_properties"></a><a class="link" href="#sec:groovy_source_set_properties">Source set properties</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds the following extensions to each source set in the project. You can use these properties in your build script as though they were properties of the source set object.</p>
</div>
<div class="sect4">
<h5 id="groovy_plugin_source_set_properties"><a class="anchor" href="#groovy_plugin_source_set_properties"></a><a class="link" href="#groovy_plugin_source_set_properties">Groovy Plugin  source set properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>groovy</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.GroovySourceDirectorySet.html">GroovySourceDirectorySet</a> (read-only)</dt>
<dd>
<p><em>Default value</em>: Not null</p>
<div class="paragraph">
<p>The Groovy source files of this source set. Contains all <code>.groovy</code> and <code>.java</code> files found in the Groovy source directories, and excludes all other types of files.</p>
</div>
</dd>
<dt class="hdlist1"><code>groovy.srcDirs</code>  <code>Set&lt;File&gt;</code></dt>
<dd>
<p><em>Default value</em>: <code>[<em>projectDir</em>/src/<em>name</em>/groovy]</code></p>
<div class="paragraph">
<p>The source directories containing the Groovy source files of this source set. May also contain Java source files for joint compilation. Can set using anything described in <a href="#sec:specifying_multiple_files">Specifying Multiple Files</a>.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Groovy plugin also modifies some source set properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="groovy_plugin_modified_source_set_properties"><a class="anchor" href="#groovy_plugin_modified_source_set_properties"></a><a class="link" href="#groovy_plugin_modified_source_set_properties">Groovy Plugin - modified source set properties</a></h5>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Change</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allJava</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all <code>.java</code> files found in the Groovy source directories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all source files found in the Groovy source directories.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovyCompile"><a class="anchor" href="#sec:groovyCompile"></a><a class="link" href="#sec:groovyCompile">GroovyCompile</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds a <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a> task for each source set in the project.
The task type shares much with the <code>JavaCompile</code> task by extending <code>AbstractCompile</code> (see <a href="#sec:compile">the relevant Java Plugin section</a>).
The <code>GroovyCompile</code> task supports most configuration options of the official Groovy compiler.
The task can also leverage the <a href="#toolchains">Java toolchain support</a>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 14. Groovy plugin - GroovyCompile properties</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classpath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.compileClasspath</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileTree.html">FileTree</a>.
Can set using anything described in <a href="#sec:specifying_multiple_files">Specifying Multiple Files</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.groovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationDirectory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>File</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.groovy.destinationDirectory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovyClasspath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovy</code> configuration if non-empty; Groovy library found on <code>classpath</code> otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javaLauncher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Property&lt;JavaLauncher&gt;</code>, see the <a href="#toolchains">toolchain documentation</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None but will be configured if a toolchain is defined on the <code>java</code> extension.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="sec:groovy_compilation_avoidance"><a class="anchor" href="#sec:groovy_compilation_avoidance"></a><a class="link" href="#sec:groovy_compilation_avoidance">Compilation avoidance</a></h5>
<div class="paragraph">
<p><em>Caveat: Groovy compilation avoidance is an incubating feature since Gradle 5.6. There are known inaccuracies so please enable it at your own risk.</em></p>
</div>
<div class="paragraph">
<p>To enable the incubating support for Groovy compilation avoidance, add a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/initialization/Settings.html#enableFeaturePreview-java.lang.String-"><code>enableFeaturePreview</code></a> to your settings file:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">enableFeaturePreview("GROOVY_COMPILATION_AVOIDANCE")</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">enableFeaturePreview('GROOVY_COMPILATION_AVOIDANCE')</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If a dependent project has changed in an <a href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a>-compatible way (only its private API has changed), then Groovy compilation tasks will be up-to-date.
This means that if project <code>A</code> depends on project <code>B</code> and a class in <code>B</code> is changed in an ABI-compatible way (typically, changing only the body of a method), then Gradle won&#8217;t recompile <code>A</code>.</p>
</div>
<div class="paragraph">
<p>See <a href="java_plugin.html#sec:java_compile_avoidance">Java compile avoidance</a> for a detailed list of the types of changes that do not affect the ABI and are ignored.</p>
</div>
<div class="paragraph">
<p>However, similar to Java&#8217;s annotation processing, there are various ways to <a href="https://melix.github.io/blog/2011/05/12/customizing_groovy_compilation_process.html">customize the Groovy compilation process</a>, for which implementation details matter.
Some well-known examples are <a href="https://groovy-lang.org/metaprogramming.html#_code_generation_transformations">Groovy AST transformations</a>.
In these cases, these dependencies must be declared separately in a classpath called <code>astTransformationClasspath</code>:</p>
</div>
<div id="ex-declaring-ast-transformations" class="exampleblock">
<div class="title">Example 121. <a href="#ex-declaring-ast-transformations">Declaring AST transformations</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val astTransformation by configurations.creating
dependencies {
    astTransformation(project(":ast-transformation"))
}
tasks.withType&lt;GroovyCompile&gt;().configureEach {
    astTransformationClasspath.from(astTransformation)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">configurations { astTransformation }
dependencies {
    astTransformation(project(":ast-transformation"))
}
tasks.withType(GroovyCompile).configureEach {
    astTransformationClasspath.from(configurations.astTransformation)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:incremental_groovy_compilation"><a class="anchor" href="#sec:incremental_groovy_compilation"></a><a class="link" href="#sec:incremental_groovy_compilation">Incremental Groovy compilation</a></h4>
<div class="paragraph">
<p>Since 5.6, Gradle introduces an experimental incremental Groovy compiler. To enable incremental compilation for Groovy, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enable <a href="#sec:groovy_compilation_avoidance">Groovy compilation avoidance</a>.</p>
</li>
<li>
<p>Explicitly enable incremental Groovy compilation in the build script:</p>
</li>
</ul>
</div>
<div id="ex-enable-incremental-groovy-compilation" class="exampleblock">
<div class="title">Example 122. <a href="#ex-enable-incremental-groovy-compilation">Enable incremental Groovy compilation</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/kotlin/myproject.groovy-conventions.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;GroovyCompile&gt;().configureEach {
    options.isIncremental = true
    options.incrementalAfterFailure = true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/src/main/groovy/myproject.groovy-conventions.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(GroovyCompile).configureEach {
    options.incremental = true
    options.incrementalAfterFailure = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This gives you the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Incremental builds are much faster.</p>
</li>
<li>
<p>If only a small set of Groovy source files are changed, only the affected source files will be recompiled.
Classes that don&#8217;t need to be recompiled remain unchanged in the output directory.
For example, if you only change a few Groovy test classes, you don&#8217;t need to recompile all Groovy test source files  only the changed ones need to be recompiled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To understand how incremental compilation works, see <a href="java_plugin.html#sec:incremental_compile">Incremental Java compilation</a> for a detailed overview.
Note that there&#8217;re several differences from Java incremental compilation:</p>
</div>
<div class="paragraph">
<p>The Groovy compiler doesn&#8217;t keep <code>@Retention</code> in generated annotation class bytecode (<a href="https://issues.apache.org/jira/browse/GROOVY-9185">GROOVY-9185</a>), thus all annotations are <code>RUNTIME</code>.
This means that changes to source-retention annotations won&#8217;t trigger a full recompilation.</p>
</div>
<div class="sect4">
<h5 id="sec:incremental_groovy_compilation_known_issues"><a class="anchor" href="#sec:incremental_groovy_compilation_known_issues"></a><a class="link" href="#sec:incremental_groovy_compilation_known_issues">Known issues</a></h5>
<div class="paragraph">
<p>Also see <a href="java_plugin.html#sec:incremental_compilation_known_issues">Known issues for incremental Java compilation</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to resources won&#8217;t trigger a recompilation, this might result in some incorrectness  for example <a href="https://mrhaki.blogspot.com/2013/01/groovy-goodness-adding-extra-methods.html">Extension Modules</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_cross_compilation"><a class="anchor" href="#sec:groovy_cross_compilation"></a><a class="link" href="#sec:groovy_cross_compilation">Compiling and testing for Java 6 or Java 7</a></h4>
<div class="paragraph">
<p>With <a href="#toolchains">toolchain support</a> added to <code>GroovyCompile</code>, it is possible to compile Groovy code using a different Java version than the one running Gradle.
If you also have Java source files, this will also configure <code>JavaCompile</code> to use the right Java compiler is used, as can be seen in the <a href="#sec:java_cross_compilation">Java plugin</a> documentation.</p>
</div>
<div class="sect4">
<h5 id="example_configure_java_7_build_for_groovy"><a class="anchor" href="#example_configure_java_7_build_for_groovy"></a><a class="link" href="#example_configure_java_7_build_for_groovy">Example: Configure Java 7 build for Groovy</a></h5>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(7)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(7)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scala_plugin"><a class="anchor" href="#scala_plugin"></a><a class="link" href="#scala_plugin">The Scala Plugin</a></h3>
<div class="paragraph">
<p>The Scala plugin extends the <a href="java_plugin.html#java_plugin">Java plugin</a> to add support for <a href="https://www.scala-lang.org/">Scala</a> projects.
The plugin also supports <em>joint compilation</em>, which allows you to freely mix and match Scala and Java code with dependencies in both directions.
For example, a Scala class can extend a Java class that in turn extends a Scala class.
This makes it possible to use the best language for the job, and to rewrite any class in the other language if needed.</p>
</div>
<div class="paragraph">
<p>Note that if you want to benefit from the <a href="#sec:java_library_separation">API / implementation separation</a>, you can also apply the <code>java-library</code> plugin to your Scala project.</p>
</div>
<div class="sect3">
<h4 id="sec:scala_usage"><a class="anchor" href="#sec:scala_usage"></a><a class="link" href="#sec:scala_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Scala plugin, include the following in your build script:</p>
</div>
<div id="ex-using-the-scala-plugin" class="exampleblock">
<div class="title">Example 123. <a href="#ex-using-the-scala-plugin">Using the Scala plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("scala")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id("scala")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_tasks"><a class="anchor" href="#sec:scala_tasks"></a><a class="link" href="#sec:scala_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Scala plugin adds the following tasks to the project.
Information about altering the dependencies to Java compile tasks are found <a href="#sec:building_jvm_lang">here</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compileScala</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileJava</code></p>
<div class="paragraph">
<p>Compiles production Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileTestScala</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileTestJava</code></p>
<div class="paragraph">
<p>Compiles test Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compile<em>SourceSet</em>Scala</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile<em>SourceSet</em>Java</code></p>
<div class="paragraph">
<p>Compiles the given source set&#8217;s Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>scaladoc</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.tasks.scala.ScalaDoc.html">ScalaDoc</a></dt>
<dd>
<div class="paragraph">
<p>Generates API documentation for the production Scala source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>ScalaCompile</code> and <code>ScalaDoc</code> tasks support <a href="#toolchains">Java toolchains</a> out of the box.</p>
</div>
<div class="paragraph">
<p>The Scala plugin adds the following dependencies to tasks added by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Scala plugin - additional task dependencies</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>classes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileScala</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>testClasses</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileTestScala</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><em>sourceSet</em>Classes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compile<em>SourceSet</em>Scala</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="img/scalaPluginTasks.png" alt="scalaPluginTasks">
</div>
<div class="title">Figure 21. Scala plugin - tasks</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_project_layout"><a class="anchor" href="#sec:scala_project_layout"></a><a class="link" href="#sec:scala_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The Scala plugin assumes the project layout shown below. All the Scala source directories can contain Scala <em>and</em> Java code. The Java source directories may only contain Java source code. None of these directories need to exist or have anything in them; the Scala plugin will simply compile whatever it finds.</p>
</div>
<div id="scalalayout" class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/java</code></dt>
<dd>
<p>Production Java source.</p>
</dd>
<dt class="hdlist1"><code>src/main/resources</code></dt>
<dd>
<p>Production resources, such as XML and properties files.</p>
</dd>
<dt class="hdlist1"><code>src/main/scala</code></dt>
<dd>
<p>Production Scala source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/test/java</code></dt>
<dd>
<p>Test Java source.</p>
</dd>
<dt class="hdlist1"><code>src/test/resources</code></dt>
<dd>
<p>Test resources.</p>
</dd>
<dt class="hdlist1"><code>src/test/scala</code></dt>
<dd>
<p>Test Scala source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/java</code></dt>
<dd>
<p>Java source for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/resources</code></dt>
<dd>
<p>Resources for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/scala</code></dt>
<dd>
<p>Scala source files for the given source set. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:changing_scala_project_layout"><a class="anchor" href="#sec:changing_scala_project_layout"></a><a class="link" href="#sec:changing_scala_project_layout">Changing the project layout</a></h5>
<div class="paragraph">
<p>Just like the Java plugin, the Scala plugin allows you to configure custom locations for Scala production and test source files.</p>
</div>
<div id="ex-custom-scala-source-layout" class="exampleblock">
<div class="title">Example 124. <a href="#ex-custom-scala-source-layout">Custom Scala source layout</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    main {
        scala {
            setSrcDirs(listOf("src/scala"))
        }
    }
    test {
        scala {
            setSrcDirs(listOf("test/scala"))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sourceSets {
    main {
        scala {
            srcDirs = ['src/scala']
        }
    }
    test {
        scala {
            srcDirs = ['test/scala']
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_version"><a class="anchor" href="#sec:scala_version"></a><a class="link" href="#sec:scala_version">Scala version</a></h4>
<div class="paragraph">
<p>The Scala version can be declared directly on the <code>scala</code> extension.
Dependencies are automatically added to the <code>scalaToolchain</code> configuration based on the declared Scala version.
The <code>scalaToolchainRuntimeClasspath</code> configuration resolves the dependencies declared on the <code>scalaToolchain</code> configuration and contains files required to run the Scala compiler.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Direct dependencies on the Scala SDK do not need to be declared when the <code>scalaVersion</code> property is set.
</td>
</tr>
</table>
</div>
<div id="ex-declaring-a-scala-2-version" class="exampleblock">
<div class="title">Example 125. <a href="#ex-declaring-a-scala-2-version">Declaring a Scala 2 version</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

scala {
    scalaVersion = "2.13.12"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

scala {
    scalaVersion = "2.13.12"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Configuring Gradle to use Scala 3 is no different from Scala 2.</p>
</div>
<div id="ex-declaring-a-scala-3-version" class="exampleblock">
<div class="title">Example 126. <a href="#ex-declaring-a-scala-3-version">Declaring a Scala 3 version</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

scala {
    scalaVersion = "3.6.3"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

scala {
    scalaVersion = "3.6.3"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>scalaVersion</code> property is incubating.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="declaring_scala_dependencies"><a class="anchor" href="#declaring_scala_dependencies"></a><a class="link" href="#declaring_scala_dependencies">Declaring Scala dependencies</a></h5>
<div class="paragraph">
<p>When not using the <code>scalaVersion</code> property, the Scala SDK dependency must be declared manually on the <code>implementation</code> configuration.
This pattern is not preferred, as it relies on <a href="#sec:configure_scala_classpath">inferring the Scala classpath</a> from the production runtime classpath.
Omitting the Scala version from the <code>scala</code> extension will be deprecated in a future Gradle version.</p>
</div>
<div class="paragraph">
<p>Scala 2 projects need to declare a <code>scala-library</code> dependency.</p>
</div>
<div id="ex-declaring-a-scala-dependency-for-production-code" class="exampleblock">
<div class="title">Example 127. <a href="#ex-declaring-a-scala-dependency-for-production-code">Declaring a Scala dependency for production code</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.scala-lang:scala-library:2.13.12")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.scala-lang:scala-library:2.13.12")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Scala 3 projects need to declare a <code>scala3-library_3</code> dependency instead:</p>
</div>
<div id="ex-declaring-a-scala-3-dependency-for-production-code" class="exampleblock">
<div class="title">Example 128. <a href="#ex-declaring-a-scala-3-dependency-for-production-code">Declaring a Scala 3 dependency for production code</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.scala-lang:scala3-library_3:3.6.3")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation("org.scala-lang:scala3-library_3:3.6.3")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If Scala is only used for test code, the <code>scala-library</code> dependency should be added to the <code>testImplementation</code> configuration:</p>
</div>
<div id="ex-declaring-a-scala-dependency-for-test-code" class="exampleblock">
<div class="title">Example 129. <a href="#ex-declaring-a-scala-dependency-for-test-code">Declaring a Scala dependency for test code</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    testImplementation("org.scala-lang:scala-library:2.13.12")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    testImplementation("org.scala-lang:scala-library:2.13.12")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configure_scala_classpath"><a class="anchor" href="#sec:configure_scala_classpath"></a><a class="link" href="#sec:configure_scala_classpath">Automatic configuration of scalaClasspath</a></h4>
<div class="paragraph">
<p>The <code>ScalaCompile</code> and <code>ScalaDoc</code> tasks consume Scala code in two ways: on their <code>classpath</code>, and on their <code>scalaClasspath</code>.
The former is used to locate classes referenced by the source code, and will typically contain <code>scala-library</code> along with other libraries.
The latter is used to load and execute the Scala compiler and Scaladoc tool, respectively, and should only contain the <code>scala-compiler</code> library and its dependencies.</p>
</div>
<div class="paragraph">
<p>If the <code>scala</code> extension&#8217;s <code>scalaVersion</code> property is not set and the task&#8217;s <code>scalaClasspath</code> is not configured explicitly, the Scala (base) plugin will try to infer the classpath from the task&#8217;s <code>classpath</code>. This is done as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a <code>scala-library</code> jar is found on <code>classpath</code>, and the project has at least one repository declared, a corresponding <code>scala-compiler</code> repository dependency will be added to <code>scalaClasspath</code>.</p>
</li>
<li>
<p>Otherwise, execution of the task will fail with a message saying that <code>scalaClasspath</code> could not be inferred.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:configure_zinc_compiler"><a class="anchor" href="#sec:configure_zinc_compiler"></a><a class="link" href="#sec:configure_zinc_compiler">Configuring the Zinc compiler</a></h4>
<div class="paragraph">
<p>The Scala plugin uses a configuration named <code>zinc</code> to resolve the <a href="https://github.com/sbt/zinc">Zinc compiler</a> and its dependencies.
Gradle will provide a default version of Zinc, but if you need to use a particular Zinc version, you can change it.
Gradle supports version 1.6.0 of Zinc and above.</p>
</div>
<div id="ex-declaring-a-version-of-the-zinc-compiler-to-use" class="exampleblock">
<div class="title">Example 130. <a href="#ex-declaring-a-version-of-the-zinc-compiler-to-use">Declaring a version of the Zinc compiler to use</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">scala {
    scalaVersion = "2.13.12"
    zincVersion = "1.10.4"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">scala {
    scalaVersion = "2.13.12"
    zincVersion = "1.10.4"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The Zinc compiler itself needs a compatible version of <code>scala-library</code> that may be different from the version required by your application.
Gradle takes care of specifying a compatible version of <code>scala-library</code> for you.</p>
</div>
<div class="paragraph">
<p>You can diagnose problems with the version of the Zinc compiler selected by running <a href="#sec:debugging-build-scans">dependencyInsight</a> for the <code>zinc</code> configuration.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 16. Zinc compatibility table</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Gradle version</th>
<th class="tableblock halign-left valign-top">Supported Zinc versions</th>
<th class="tableblock halign-left valign-top">Zinc coordinates</th>
<th class="tableblock halign-left valign-top">Required Scala version</th>
<th class="tableblock halign-left valign-top">Supported Scala compilation version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5 and newer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/sbt/zinc">SBT Zinc</a>. Versions 1.6.0 and above.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.scala-sbt:zinc_2.13</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.13.x</code> is required for <em>running</em> Zinc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.10.x</code> through <code>3.x</code> can be compiled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.0 to 7.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/sbt/zinc">SBT Zinc</a>. Versions 1.2.0 and above.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.scala-sbt:zinc_2.12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.12.x</code> is required for <em>running</em> Zinc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.10.x</code> through <code>2.13.x</code> can be compiled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.x through 5.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/typesafehub/zinc"><strong>Deprecated</strong> Typesafe Zinc compiler.</a> Versions 0.3.0 and above, except for 0.3.2 through 0.3.5.2.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.typesafe.zinc:zinc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.10.x</code> is required for <em>running</em> Zinc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scala <code>2.9.x</code> through <code>2.12.x</code> can be compiled.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:scala_compiler_plugins"><a class="anchor" href="#sec:scala_compiler_plugins"></a><a class="link" href="#sec:scala_compiler_plugins">Adding plugins to the Scala compiler</a></h4>
<div class="paragraph">
<p>The Scala plugin adds a configuration named <code>scalaCompilerPlugins</code> which is used to declare and resolve optional compiler plugins.</p>
</div>
<div id="ex-adding-a-dependency-on-a-scala-compiler-plugin" class="exampleblock">
<div class="title">Example 131. <a href="#ex-adding-a-dependency-on-a-scala-compiler-plugin">Adding a dependency on a Scala compiler plugin</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">dependencies {
    scalaCompilerPlugins("org.typelevel:kind-projector_2.13.12:0.13.2")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    scalaCompilerPlugins("org.typelevel:kind-projector_2.13.12:0.13.2")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_convention_properties"><a class="anchor" href="#sec:scala_convention_properties"></a><a class="link" href="#sec:scala_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Scala plugin does not add any convention properties to the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_source_set_properties"><a class="anchor" href="#sec:scala_source_set_properties"></a><a class="link" href="#sec:scala_source_set_properties">Source set properties</a></h4>
<div class="paragraph">
<p>The Scala plugin adds the following extensions to each source set in the project. You can use these  in your build script as though they were properties of the source set object.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>scala</code>  <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a> (read-only)</dt>
<dd>
<p>The Scala source files of this source set. Contains all <code>.scala</code> and <code>.java</code> files found in the Scala source directories, and excludes all other types of files. <em>Default value:</em> non-null.</p>
</dd>
<dt class="hdlist1"><code>scala.srcDirs</code>  <code>Set&lt;File&gt;</code></dt>
<dd>
<p>The source directories containing the Scala source files of this source set. May also contain Java source files for joint compilation.
Can set using anything described in <a href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a>.
<em>Default value:</em> <code>[<em>projectDir</em>/src/<em>name</em>/scala]</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Scala plugin also modifies some source set properties:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 17. Scala plugin - source set properties</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Change</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allJava</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all <code>.java</code> files found in the Scala source directories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all source files found in the Scala source directories.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:scala_target"><a class="anchor" href="#sec:scala_target"></a><a class="link" href="#sec:scala_target">Target bytecode level and Java APIs version</a></h4>
<div class="paragraph">
<p>When running the Scala compile task, Gradle will always add a parameter to configure the Java target for the Scala compiler that is derived from the Gradle configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When using toolchains, the <code>-release</code> option, or <code>target</code> for older Scala versions, is selected, with a version matching the Java language level of the toolchain configured.</p>
</li>
<li>
<p>When not using toolchains, Gradle will always pass a <code>target</code> flag&#8201;&#8212;&#8201;with exact value dependent on the Scala version&#8201;&#8212;&#8201;to compile to Java 8 bytecode.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This means that using toolchains with a recent Java version and an old Scala version can result in failures because Scala only supported Java 8 bytecode for some time.
The solution is then to either use the right Java version in the toolchain or explicitly downgrade the target when needed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following table explains the values computed by Gradle:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 18. Scala target parameter based on project configuration</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scala version</th>
<th class="tableblock halign-left valign-top">Toolchain in use</th>
<th class="tableblock halign-left valign-top">Parameter value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">version &lt; <code>2.13.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-target:jvm-1.&lt;java_version&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-target:jvm-1.8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>2.13.1</code> &lt;= version &lt; <code>2.13.9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-target:&lt;java_version&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-target:8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>2.13.9</code> &lt;= version &lt; <code>3.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-release:&lt;java_version&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-target:8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><code>3.0</code> &lt;= version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-release:&lt;java_version&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-Xtarget:8</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Setting any of these flags explicitly, or using flags containing <code>java-output-version</code>, on <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.language.scala.tasks.BaseScalaCompileOptions.html#org.gradle.language.scala.tasks.BaseScalaCompileOptions:additionalParameters"><code>ScalaCompile.scalaCompileOptions.additionalParameters</code></a> disables that logic in favor of the explicit flag.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_compiling_in_external_process"><a class="anchor" href="#sec:scala_compiling_in_external_process"></a><a class="link" href="#sec:scala_compiling_in_external_process">Compiling in external process</a></h4>
<div class="paragraph">
<p>Scala compilation takes place in an external process.</p>
</div>
<div class="paragraph">
<p>Memory settings for the external process default to the defaults of the JVM. To adjust memory settings, configure the <code>scalaCompileOptions.forkOptions</code> property as needed:</p>
</div>
<div id="ex-adjusting-memory-settings" class="exampleblock">
<div class="title">Example 132. <a href="#ex-adjusting-memory-settings">Adjusting memory settings</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;ScalaCompile&gt;().configureEach {
    scalaCompileOptions.forkOptions.apply {
        memoryMaximumSize = "1g"
        jvmArgs = listOf("-XX:MaxMetaspaceSize=512m")
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(ScalaCompile) {
    scalaCompileOptions.forkOptions.with {
        memoryMaximumSize = '1g'
        jvmArgs = ['-XX:MaxMetaspaceSize=512m']
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_incremental_compilation"><a class="anchor" href="#sec:scala_incremental_compilation"></a><a class="link" href="#sec:scala_incremental_compilation">Incremental compilation</a></h4>
<div class="paragraph">
<p>By compiling only classes whose source code has changed since the previous compilation, and classes affected by these changes, incremental compilation can significantly reduce Scala compilation time. It is particularly effective when frequently compiling small code increments, as is often done at development time.</p>
</div>
<div class="paragraph">
<p>The Scala plugin defaults to incremental compilation by integrating with <a href="https://github.com/typesafehub/zinc">Zinc</a>, a standalone version of <a href="https://github.com/harrah/xsbt">sbt</a>'s incremental Scala compiler. If you want to disable the incremental compilation, set <code>force = true</code> in your build file:</p>
</div>
<div id="ex-forcing-all-code-to-be-compiled" class="exampleblock">
<div class="title">Example 133. <a href="#ex-forcing-all-code-to-be-compiled">Forcing all code to be compiled</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.withType&lt;ScalaCompile&gt;().configureEach {
    scalaCompileOptions.apply {
        isForce = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(ScalaCompile) {
    scalaCompileOptions.with {
        force = true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><em>Note:</em> This will only cause all classes to be recompiled if at least one input source file has changed. If there are no changes to the source files, the <code>compileScala</code> task will still be considered <code>UP-TO-DATE</code> as usual.</p>
</div>
<div class="paragraph">
<p>The Zinc-based Scala Compiler supports joint compilation of Java and Scala code. By default, all Java and Scala code under <code>src/main/scala</code> will participate in joint compilation. Even Java code will be compiled incrementally.</p>
</div>
<div class="paragraph">
<p>Incremental compilation requires dependency analysis of the source code. The results of this analysis are stored in the file designated by <code>scalaCompileOptions.incrementalOptions.analysisFile</code> (which has a sensible default). In a multi-project build, analysis files are passed on to downstream <code>ScalaCompile</code> tasks to enable incremental compilation across project boundaries. For <code>ScalaCompile</code> tasks added by the Scala plugin, no configuration is necessary to make this work. For other <code>ScalaCompile</code> tasks that you might add, the property <code>scalaCompileOptions.incrementalOptions.publishedCode</code> needs to be configured to point to the classes folder or Jar archive by which the code is passed on to compile class paths of downstream <code>ScalaCompile</code> tasks. Note that if <code>publishedCode</code> is not set correctly, downstream tasks may not recompile code affected by upstream changes, leading to incorrect compilation results.</p>
</div>
<div class="paragraph">
<p>Note that Zinc&#8217;s Nailgun based daemon mode is not supported. Instead, we plan to enhance Gradle&#8217;s own compiler daemon to stay alive across Gradle invocations, reusing the same Scala compiler. This is expected to yield another significant speedup for Scala compilation.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:eclipse_integration"><a class="anchor" href="#sec:eclipse_integration"></a><a class="link" href="#sec:eclipse_integration">Eclipse Integration</a></h4>
<div class="paragraph">
<p>When the Eclipse plugin encounters a Scala project, it adds additional configuration to make the project work with Scala IDE out of the box. Specifically, the plugin adds a Scala nature and dependency container.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:intellij_idea_integration"><a class="anchor" href="#sec:intellij_idea_integration"></a><a class="link" href="#sec:intellij_idea_integration">IntelliJ IDEA Integration</a></h4>
<div class="paragraph">
<p>When the IDEA plugin encounters a Scala project, it adds additional configuration to make the project work with IDEA out of the box. Specifically, the plugin adds a Scala SDK (IntelliJ IDEA 14+) and a Scala compiler library that matches the Scala version on the project&#8217;s class path. The Scala plugin is backwards compatible with earlier versions of IntelliJ IDEA and it is possible to add a Scala facet instead of the default Scala SDK by configuring <code>targetVersion</code> on <a href="https://docs.gradle.org/9.1.0/dsl/org.gradle.plugins.ide.idea.model.IdeaModel.html">IdeaModel</a>.</p>
</div>
<div id="ex-explicitly-specify-a-target-intellij-idea-version" class="exampleblock">
<div class="title">Example 134. <a href="#ex-explicitly-specify-a-target-intellij-idea-version">Explicitly specify a target IntelliJ IDEA version</a></div>
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">idea {
    targetVersion = "13"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">idea {
    targetVersion = '13'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="part:integration"><a class="anchor" href="#part:integration"></a><a class="link" href="#part:integration">INTEGRATION</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="third_party_integration"><a class="anchor" href="#third_party_integration"></a><a class="link" href="#third_party_integration">Gradle &amp; Third-party Tools</a></h3>
<div class="paragraph">
<p>Gradle can be integrated with many different third-party tools such as IDEs and continuous integration platforms.
Here we look at some of the more common ones as well as how to integrate your own tool with Gradle.</p>
</div>
<div class="sect3">
<h4 id="ides"><a class="anchor" href="#ides"></a><a class="link" href="#ides">IDEs</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Android Studio</dt>
<dd>
<p>As a variant of IntelliJ IDEA, <a href="https://developer.android.com/studio/">Android Studio</a> has built-in support for importing and building Gradle projects.
You can also use the <a href="idea_plugin.html#idea_plugin">IDEA Plugin for Gradle</a> to fine-tune the import process if that&#8217;s necessary.</p>
<div class="paragraph">
<p>This IDE also has an <a href="https://developer.android.com/studio/intro/">extensive user guide</a> to help you get the most out of the IDE and Gradle.</p>
</div>
</dd>
<dt class="hdlist1">Eclipse</dt>
<dd>
<p>If you want to work on a project within Eclipse that has a Gradle build, you should use the <a href="https://projects.eclipse.org/projects/tools.buildship">Eclipse Buildship plugin</a>.
This will allow you to import and run Gradle builds.
If you need to fine tune the import process so that the project loads correctly, you can use the <a href="eclipse_plugin.html#eclipse_plugin">Eclipse Plugins for Gradle</a>.
See <a href="https://discuss.gradle.org/t/buildship-1-0-18-is-now-available/19012">the associated release announcement</a> for details on what fine tuning you can do.</p>
</dd>
<dt class="hdlist1">IntelliJ IDEA</dt>
<dd>
<p>IDEA has built-in support for importing Gradle projects.
If you need to fine tune the import process so that the project loads correctly, you can use the <a href="idea_plugin.html#idea_plugin">IDEA Plugin for Gradle</a>.</p>
</dd>
<dt class="hdlist1">NetBeans</dt>
<dd>
<p>Built-in support for Gradle in <a href="https://netbeans.apache.org/">Apache NetBeans</a></p>
</dd>
<dt class="hdlist1">Visual Studio</dt>
<dd>
<p>For developing C++ projects, Gradle comes with a <a href="visual_studio_plugin.html#visual_studio_plugin">Visual Studio plugin</a>.</p>
</dd>
<dt class="hdlist1">Xcode</dt>
<dd>
<p>For developing C++ projects, Gradle comes with a <a href="xcode_plugin.html#xcode_plugin">Xcode plugin</a>.</p>
</dd>
<dt class="hdlist1">CLion</dt>
<dd>
<p>JetBrains supports building <a href="https://blog.jetbrains.com/clion/2018/05/clion-starts-2018-2-eap-sanitizers-gradle-db-performance/">C++ projects with Gradle</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="continuous_integration_2"><a class="anchor" href="#continuous_integration_2"></a><a class="link" href="#continuous_integration_2">Continuous integration</a></h4>
<div class="paragraph">
<p>We have <a href="https://cookbook.gradle.org/ci/">dedicated guides</a> showing you how to integrate a Gradle project with several CI platforms.</p>
</div>
</div>
<div class="sect3">
<h4 id="how_to_integrate_with_gradle"><a class="anchor" href="#how_to_integrate_with_gradle"></a><a class="link" href="#how_to_integrate_with_gradle">How to integrate with Gradle</a></h4>
<div class="paragraph">
<p>There are two main ways to integrate a tool with Gradle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Gradle build uses the tool</p>
</li>
<li>
<p>The tool executes the Gradle build</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The former case is typically <a href="#custom_plugins">implemented as a Gradle plugin</a>.
The latter can be accomplished by embedding Gradle through the <a href="#tooling_api">Tooling API</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="test_integration"><a class="anchor" href="#test_integration"></a><a class="link" href="#test_integration">Test integration</a></h4>
<div class="paragraph">
<p>If your platform uses an external testing suite, and you want to integrate with the <a href="#test_reporting">HTML Test Report</a>, you can use the <a href="#test_reporting_api">Test Reporting API</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tooling_api"><a class="anchor" href="#tooling_api"></a><a class="link" href="#tooling_api">Tooling API</a></h3>
<div class="sect3">
<h4 id="embedding"><a class="anchor" href="#embedding"></a><a class="link" href="#embedding">Embedding Gradle using the Tooling API</a></h4>
<div class="sect4">
<h5 id="sec:embedding_introduction"><a class="anchor" href="#sec:embedding_introduction"></a><a class="link" href="#sec:embedding_introduction">Introduction to the Tooling API</a></h5>
<div class="paragraph">
<p>Gradle provides a programmatic API called the Tooling API, which you can use for embedding Gradle into your own software. This API allows you to execute and monitor builds and to query Gradle about the details of a build. The main audience for this API is IDE, CI server, other UI authors; however, the API is open for anyone who needs to embed Gradle in their application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#test_kit">Gradle TestKit</a> uses the Tooling API for functional testing of your Gradle plugins.</p>
</li>
<li>
<p><a href="http://projects.eclipse.org/projects/tools.buildship">Eclipse Buildship</a> uses the Tooling API for importing your Gradle project and running tasks.</p>
</li>
<li>
<p><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> uses the Tooling API for importing your Gradle project and running tasks.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:embedding_features"><a class="anchor" href="#sec:embedding_features"></a><a class="link" href="#sec:embedding_features">Tooling API Features</a></h5>
<div class="paragraph">
<p>A fundamental characteristic of the Tooling API is that it operates in a version independent way.
This means that you can use the same API to work with builds that use different versions of Gradle, including versions that are newer or older than the version of the Tooling API that you are using.
The Tooling API is Gradle wrapper aware and, by default, uses the same Gradle version as that used by the wrapper-powered build.</p>
</div>
<div class="paragraph">
<p>Some features that the Tooling API provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query the details of a build, including the project hierarchy and the project dependencies, external dependencies (including source and Javadoc jars), source directories and tasks of each project.</p>
</li>
<li>
<p>Execute a build and listen to stdout and stderr logging and progress messages (e.g. the messages shown in the 'status bar' when you run on the command line).</p>
</li>
<li>
<p>Execute a specific test class or test method.</p>
</li>
<li>
<p>Receive interesting events as a build executes, such as project configuration, task execution or test execution.</p>
</li>
<li>
<p>Cancel a build that is running.</p>
</li>
<li>
<p>Combine multiple separate Gradle builds into a single composite build.</p>
</li>
<li>
<p>The Tooling API can download and install the appropriate Gradle version, similar to the wrapper.</p>
</li>
<li>
<p>The implementation is lightweight, with only a small number of dependencies.
It is also a well-behaved library, and makes no assumptions about your classloader structure or logging configuration.
This makes the API easy to embed in your application.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:embedding_daemon"><a class="anchor" href="#sec:embedding_daemon"></a><a class="link" href="#sec:embedding_daemon">Tooling API and the Gradle Build Daemon</a></h5>
<div class="paragraph">
<p>The Tooling API always uses the Gradle daemon.
This means that subsequent calls to the Tooling API, be it model building requests or task executing requests will be executed in the same long-living process.
<a href="#gradle_daemon">Gradle Daemon</a> contains more details about the daemon, specifically information on situations when new daemons are forked.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:embedding_quickstart"><a class="anchor" href="#sec:embedding_quickstart"></a><a class="link" href="#sec:embedding_quickstart">Quickstart</a></h5>
<div class="paragraph">
<p>As the Tooling API is an interface for developers, the Javadoc is the main documentation for it.</p>
</div>
<div class="paragraph">
<p>To use the Tooling API, add the following repository and dependency declarations to your build script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">repositories {
    maven { url = uri("https://repo.gradle.org/gradle/libs-releases") }
}

dependencies {
    implementation("org.gradle:gradle-tooling-api:$toolingApiVersion")
    // The tooling API need an SLF4J implementation available at runtime, replace this with any other implementation
    runtimeOnly("org.slf4j:slf4j-simple:2.0.17")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">repositories {
    maven { url = 'https://repo.gradle.org/gradle/libs-releases' }
}

dependencies {
    implementation "org.gradle:gradle-tooling-api:$toolingApiVersion"
    // The tooling API need an SLF4J implementation available at runtime, replace this with any other implementation
    runtimeOnly 'org.slf4j:slf4j-simple:2.0.17'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The main entry point to the Tooling API is the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/GradleConnector.html">GradleConnector</a>.
You can navigate from there to find code samples and explore the available Tooling API models.
You can use <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/GradleConnector.html#connect--">GradleConnector.connect()</a> to create a <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/tooling/ProjectConnection.html">ProjectConnection</a>.
A <code>ProjectConnection</code> connects to a single Gradle project.
Using the connection you can execute tasks, tests and retrieve models relative to this project.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:embedding_compatibility"><a class="anchor" href="#sec:embedding_compatibility"></a><a class="link" href="#sec:embedding_compatibility">Compatibility of Java and Gradle versions</a></h5>
<div class="paragraph">
<p>The following components should be considered when implementing Gradle integration: the Tooling API version, The JVM running the Tooling API client (i.e. the IDE process), the JVM running the Gradle daemon, and the Gradle version.</p>
</div>
<div class="paragraph">
<p>The Tooling API itself is a Java library published as part of the Gradle release.
Each Gradle release has a corresponding Tooling API version with the same version number.</p>
</div>
<div class="paragraph">
<p>The Tooling API classes are loaded into the client&#8217;s JVM, so they should have a matching version.
The current version of the Tooling API library is compiled with Java 8 compatibility.</p>
</div>
<div class="paragraph">
<p>The JVM running the Tooling API client and the one running the daemon can be different.
At the same time, classes that are sent to the build via custom build actions need to be targeted to the lowest supported Java version.
The JVM versions supported by Gradle is version-specific.
The upper bound is defined in the <a href="#compatibility">compatibility matrix</a>.
The rule for the lower bound is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle 4.x requires a minimum version of Java 7.</p>
</li>
<li>
<p>Gradle 5 and above require a minimum version of Java 8.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Tooling API version is guaranteed to support running builds with all Gradle versions for the last five major releases.
For example, the Tooling API 9.0.0 release is compatible with Gradle versions &gt;= 4.0.
Besides, the Tooling API is guaranteed to be compatible with future Gradle releases for the current and the next major.
This means, for example, that the 8.1 version of the Tooling API will be able to run Gradle 9.x builds and <em>might</em> break with Gradle 10.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="test_reporting_api"><a class="anchor" href="#test_reporting_api"></a><a class="link" href="#test_reporting_api">Test Event Reporting API</a></h3>
<div class="paragraph">
<p>The Test Event Reporting API allows you to capture test execution events programmatically and produce results similar to Gradle&#8217;s built-in <code>Test</code> task.
It&#8217;s particularly useful to integrate non-JVM test results into Gradle&#8217;s testing infrastructure and publish them in Gradle&#8217;s HTML test reports.</p>
</div>
<div class="paragraph">
<p>The API is primarily targeted at plugin developers and platform providers, with the <a href="https://docs.gradle.org/9.1.0/javadoc/org/gradle/api/tasks/testing/TestEventReporter.html">Javadoc</a> serving as the main reference.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The Test Event Reporting API is incubating.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at a quick example that defines a custom Gradle task, <code>CustomTest</code>, which demonstrates how to capture and report test events:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="exampleblock testable-sample multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/com/example/CustomTest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import org.gradle.api.DefaultTask;
import org.gradle.api.file.ProjectLayout;
import org.gradle.api.tasks.TaskAction;
import org.gradle.api.tasks.testing.GroupTestEventReporter;
import org.gradle.api.tasks.testing.TestEventReporter;
import org.gradle.api.tasks.testing.TestEventReporterFactory;
import org.junit.platform.launcher.Launcher;
import org.junit.platform.launcher.LauncherDiscoveryRequest;
import org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder;
import org.junit.platform.launcher.core.LauncherFactory;
import org.junit.platform.launcher.listeners.SummaryGeneratingListener;
import org.junit.platform.launcher.listeners.TestExecutionSummary;

import javax.inject.Inject;
import java.time.Instant;
import java.util.ArrayList;
import java.util.List;

import static org.junit.platform.engine.discovery.DiscoverySelectors.selectClass;

/**
 * A custom task that demonstrates the {@code TestEventReporter} API.
 */
public abstract class CustomTest extends DefaultTask {

    @Inject
    public abstract ProjectLayout getLayout();

    @Inject
    protected abstract TestEventReporterFactory getTestEventReporterFactory();


    @TaskAction
    void runTests() {
        try (GroupTestEventReporter root = getTestEventReporterFactory().createTestEventReporter( // <b class="conum">(1)</b>
            "root",
            getLayout().getBuildDirectory().dir("test-results/custom-test").get(),
            getLayout().getBuildDirectory().dir("reports/tests/custom-test").get()
        )) {
            root.started(Instant.now());

            List&lt;String&gt; failedTests = new ArrayList&lt;&gt;();

            try (GroupTestEventReporter junittest = root.reportTestGroup("CustomJUnitTestSuite")) { // <b class="conum">(2)</b>
                junittest.started(Instant.now());

                LauncherDiscoveryRequest request = LauncherDiscoveryRequestBuilder.request()
                    .selectors(
                        selectClass(MyTest1.class)
                    )
                    .build();

                Launcher launcher = LauncherFactory.create();
                TestExecutionSummary summary = executeTests(launcher, request);

                summary.getFailures().forEach(result -&gt; {
                    try (TestEventReporter test = junittest.reportTest(result.getTestIdentifier().getDisplayName(),
                        result.getTestIdentifier().getLegacyReportingName())) { // <b class="conum">(3)</b>
                        test.started(Instant.now());
                        String testName = String.valueOf(result.getTestIdentifier().getParentIdObject());
                        failedTests.add(testName);  // <b class="conum">(4)</b>
                        test.metadata(Instant.now(),"Parent class:", String.valueOf(result.getTestIdentifier().getParentId().get()));
                        test.failed(Instant.now(), String.valueOf(result.getException()));
                    }
                });

                String failedTestsList = String.join(", ", failedTests);
                junittest.metadata(Instant.now(), "Tests that failed:", failedTestsList);

                if (summary.getTestsFailedCount() &gt; 0) {
                    junittest.failed(Instant.now());
                } else {
                    junittest.succeeded(Instant.now());
                }
            }

            if (!failedTests.isEmpty()) {
                root.failed(Instant.now());
            } else {
                root.succeeded(Instant.now());
            }
        }
    }

    private TestExecutionSummary executeTests(Launcher launcher, LauncherDiscoveryRequest request) {
        // Use SummaryGeneratingListener to collect test execution data
        SummaryGeneratingListener listener = new SummaryGeneratingListener();
        launcher.registerTestExecutionListeners(listener);

        // Execute the tests
        launcher.execute(request);

        // Return the summary generated by the listener
        return listener.getSummary();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>GroupTestEventReporter</code> is initialized to act as the root event reporter.</p>
<div class="paragraph">
<p>It creates directories for test results and reports under the project&#8217;s build directory:
This establishes the reporting hierarchy.</p>
</div>
<div class="paragraph">
<p><strong>Nesting is supported</strong>.</p>
</div>
</li>
<li>
<p>The task uses JUnit Platform to dynamically discover and execute tests, <strong>this would be replaced with your custom test system/platform</strong>.</p>
<div class="paragraph">
<p>It selects the class <code>MyTest1</code> for testing.</p>
</div>
<div class="paragraph">
<p>JUnits <code>Launcher</code> is used to execute the tests and collect a summary of the results.</p>
</div>
</li>
<li>
<p>The <code>TestEventReporter</code> is used to record detailed events for each test.</p>
<div class="paragraph">
<p>For each failure, the test is reported with metadata and marked as failed.</p>
</div>
</li>
<li>
<p>Each test group (<code>junittest</code>) and the root (<code>root</code>) are finalized with success or failure based on the test results.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>By using the Test Event Reporting API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Integration</strong>: Custom tests (even those outside JVM frameworks) can generate events compatible with Gradle&#8217;s test reporting infrastructure.</p>
</li>
<li>
<p><strong>Rich Metadata</strong>: Developers can attach additional context (e.g., error messages or parent class details) to test events.</p>
</li>
<li>
<p><strong>Consistency</strong>: Results integrate seamlessly with Gradles HTML reports, making it easier to debug and understand test outcomes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a downloadable example, refer to the <a href="../samples/sample_custom_test_task.html">Custom Test Task Sample</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license_information"><a class="anchor" href="#license_information"></a><a class="link" href="#license_information">LICENSE INFORMATION</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="license"><a class="anchor" href="#license"></a><a class="link" href="#license">License Information</a></h3>
<div class="sect3">
<h4 id="sec:gradle_documentation"><a class="anchor" href="#sec:gradle_documentation"></a><a class="link" href="#sec:gradle_documentation">Gradle Documentation</a></h4>
<div class="paragraph">
<p> 2025 Gradle, Inc. Gradle, Develocity, Build Scan, and the Gradlephant logo are registered trademarks of Gradle, Inc. On this resource, "Gradle" typically means "Gradle Build Tool" and does not reference Gradle, Inc. and/or its subsidiaries.</p>
</div>
<div class="paragraph">
<p>Gradle&#8217;s Build Tool source code is open-source and licensed under the <a href="https://github.com/gradle/gradle/blob/master/LICENSE">Apache License 2.0</a>.</p>
</div>
<div id="licences" class="paragraph">
<p>Gradle&#8217;s User Manual and DSL Reference Manual are licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="licenses:build_scan_plugin"><a class="anchor" href="#licenses:build_scan_plugin"></a><a class="link" href="#licenses:build_scan_plugin">Develocity Plugin (formerly Gradle Build Scan Plugin)</a></h4>
<div class="paragraph">
<p>Use of the <a href="https://scans.gradle.com/plugin/">Develocity plugin</a> is subject to <a href="https://gradle.com/legal/terms-of-service/">Gradle&#8217;s Terms of Service</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Not compatible with the configuration cache.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. You might be wondering why there is neither an import for the <code>StopExecutionException</code> nor do we access it via its fully qualified name. The reason is that Gradle adds a set of default imports to your script (see <a href="#script-default-imports">Default imports</a>).
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="#sec:build_script_plugins"><strong>Script plugins</strong></a> are hard to maintain. Do not use script plugins <code>apply from:</code>, they are not recommended.
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. It is recommended to use a statically-typed language like <strong>Java</strong> or <strong>Kotlin</strong> for implementing plugins to reduce the likelihood of binary incompatibilities. If using Groovy, consider using <strong>statically compiled Groovy</strong>.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. In Groovy you can execute Strings.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. The <code>CommandLineArgumentProvider</code> in this example is implemented as a <a href="#managed_types">managed type</a>.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. The JUnit wiki contains a detailed description on how to work with JUnit categories: <a href="https://github.com/junit-team/junit/wiki/Categories" class="bare">https://github.com/junit-team/junit/wiki/Categories</a>.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. The TestNG documentation contains more details about test groups: <a href="https://testng.org/#_test_groups" class="bare">https://testng.org/#_test_groups</a>.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. The TestNG documentation contains more details about test ordering when working with <code>testng.xml</code> files: <a href="http://testng.org/doc/documentation-main.html#testng-xml" class="bare">http://testng.org/doc/documentation-main.html#testng-xml</a>.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. Gradle uses the same conventions as introduced by Russel Winder&#8217;s <a href="https://github.com/Gant/Gant">Gant tool</a>.
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/groovy.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/kotlin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/toml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/gradle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/properties.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/text.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</div>
<!-- end div class="chapter" -->

<footer class="site-layout__footer site-footer" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
    <nav class="site-footer__navigation" itemtype="https://schema.org/SiteNavigationElement">
        <section class="site-footer__links">
            <div class="site-footer__link-group">
                <header><strong>Docs</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="/release-notes.html" itemprop="url">Release Notes</a></li>
                    <li itemprop="name"><a href="/dsl/" itemprop="url">Groovy DSL</a></li>
                    <li itemprop="name"><a href="/kotlin-dsl/" itemprop="url">Kotlin DSL</a></li>
                    <li itemprop="name"><a href="/javadoc/" itemprop="url">Javadoc</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>News</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://blog.gradle.org/" itemprop="url">Blog</a></li>
                    <li itemprop="name"><a href="https://newsletter.gradle.org/" itemprop="url">Newsletter</a></li>
                    <li itemprop="name"><a href="https://twitter.com/gradle" itemprop="url">Twitter</a></li>
                    <li itemprop="name"><a href="https://status.gradle.com/" itemprop="url">Status</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Products</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://gradle.com/develocity/" itemprop="url">Develocity</a></li>
                    <li itemprop="name"><a href="https://gradle.com/develocity/product/build-scan/" itemprop="url">Build Scan</a></li>
                    <li itemprop="name"><a href="https://gradle.com/build-cache/" itemprop="url">Build Cache</a></li>
                    <li itemprop="name"><a href="https://gradle.org/services/" itemprop="url">Services</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Get Help</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://discuss.gradle.org/c/help-discuss" itemprop="url">Forums</a></li>
                    <li itemprop="name"><a href="https://github.com/gradle/" itemprop="url">GitHub</a></li>
                    <li itemprop="name"><a href="https://gradle.org/training/" itemprop="url">Events</a></li>
                    <li itemprop="name"><a href="https://dpeuniversity.gradle.com/" itemprop="url">DPE University</a></li>
                </ul>
            </div>
        </section>
        <section class="site-footer__subscribe-newsletter" id="newsletter-form-container">
            <header class="newsletter-form__header"><h5>Stay <code>UP-TO-DATE</code> on new features and news:</h5></header>
            <p class="disclaimer">By entering your email, you agree to our <a href="https://gradle.com/legal/terms-of-service/">Terms</a> and <a href="https://gradle.com/legal/privacy/">Privacy Policy</a>.</p>
            <div class="newsletter-form__container">
                <form id="newsletter-form" class="newsletter-form" action="https://go.gradle.com/l/68052/2018-09-07/bk6wml" method="post">
                    <input id="email" class="email" name="email" type="email" placeholder="name@email.com" pattern="[^@\s]+@[^@\s]+\.[^@\s]+" maxlength="255" required=""/>
                    <button id="submit" class="submit" type="submit">Subscribe</button>
                </form>
            </div>
        </section>
    </nav>
</footer>

</div>
<!-- end div class="content" -->


</main>

<div class="site-footer-secondary">
    <div class="site-footer-secondary__contents">
        <div class="site-footer__copy">
             2025 Gradle, Inc. Gradle, Develocity, Build Scan, and the Gradlephant logo are registered trademarks of Gradle, Inc.
        </div>
        <div class="site-footer__logo"><a href="https://gradle.com">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 90 66.06">
                <title>Gradle</title>
                <path class="cls-1"
                      d="M85.11,4.18a14.27,14.27,0,0,0-19.83-.34,1.38,1.38,0,0,0,0,2L67,7.6a1.36,1.36,0,0,0,1.78.12A8.18,8.18,0,0,1,79.5,20.06C68.17,31.38,53.05-.36,18.73,16a4.65,4.65,0,0,0-2,6.54l5.89,10.17a4.64,4.64,0,0,0,6.3,1.73l.14-.08-.11.08L31.53,33a60.29,60.29,0,0,0,8.22-6.13,1.44,1.44,0,0,1,1.87-.06h0a1.34,1.34,0,0,1,.06,2A61.61,61.61,0,0,1,33,35.34l-.09,0-2.61,1.46a7.34,7.34,0,0,1-3.61.94,7.45,7.45,0,0,1-6.47-3.71l-5.57-9.61C4,32-2.54,46.56,1,65a1.36,1.36,0,0,0,1.33,1.11H8.61A1.36,1.36,0,0,0,10,64.87a9.29,9.29,0,0,1,18.42,0,1.35,1.35,0,0,0,1.34,1.19H35.9a1.36,1.36,0,0,0,1.34-1.19,9.29,9.29,0,0,1,18.42,0A1.36,1.36,0,0,0,57,66.06H63.1a1.36,1.36,0,0,0,1.36-1.34c.14-8.6,2.46-18.48,9.07-23.43C96.43,24.16,90.41,9.48,85.11,4.18ZM61.76,30.05l-4.37-2.19h0a2.74,2.74,0,1,1,4.37,2.2Z"/>
            </svg>
        </a></div>
        <div class="site-footer-secondary__links">
            <a href="https://gradle.com/legal/privacy/">Privacy</a> |
            <a href="https://gradle.com/legal/terms-of-service/">Terms of Service</a>
        </div>
    </div>
</div>

</div>
<!-- end div class="layout" -->

<script type="text/javascript">
    // Polyfill Element.matches()
    if (!Element.prototype.matches) {
        Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
    }
    // Polyfill Element.closest()
    if (!Element.prototype.closest) {
        Element.prototype.closest = function (s) {
            var el = this;
            if (!document.documentElement.contains(el)) return null;
            do {
                if (typeof el.matches === "function" && el.matches(s)) return el;
                el = el.parentElement || el.parentNode;
            } while (el !== null);
            return null;
        };
    }

    function getCurrentChapterFileName(givenUrl) {
        var currentChapterFileName = givenUrl.substr(givenUrl.lastIndexOf("/") + 1);
        if (currentChapterFileName === "index.html" || currentChapterFileName === "") {
            currentChapterFileName = givenUrl.substr(0, givenUrl.lastIndexOf("/"));
            currentChapterFileName = currentChapterFileName.substr(currentChapterFileName.lastIndexOf("/") + 1) + "/index.html";
        }
        return currentChapterFileName;
    }

    // The media query indicating that a device is a desktop.
    // The `min-width: 64rem` definition should be aligned to
    // the one of `css/manual.css`.
    const desktopMediaQuery = window.matchMedia("screen and (min-width: 64rem)");

    [].forEach.call(document.querySelectorAll(".docs-navigation a[href$='/" + getCurrentChapterFileName(window.location.pathname) + "']"), function (link) {
        // Add "active" to all links same as current URL
        link.classList.add("active");

        // Expand all parent navigation
        var parentListEl = link.closest("li");
        while (parentListEl !== null) {
            var dropDownEl = parentListEl.querySelector(".nav-dropdown");
            if (dropDownEl !== null) {
                dropDownEl.classList.add("expanded");
            }
            parentListEl = parentListEl.parentNode.closest("li");
        }

        // Only scroll if the device is a desktop.
        //
        // Mobile's `docs-navigation` is always at bottom of `content`,
        // so we should not slide down to where `docs-navigation` lays.
        if (desktopMediaQuery.matches) {
            // Scroll to center of the page
            link.scrollIntoView({behavior: 'auto', block: 'center', inline: 'center'})
        }
    });

    // Expand/contract multi-level side navigation
    [].forEach.call(document.querySelectorAll(".docs-navigation .nav-dropdown"), function registerSideNavActions(collapsibleElement) {
        collapsibleElement.addEventListener("click", function toggleExpandedSideNav(evt) {
            evt.preventDefault();
            evt.target.classList.toggle("expanded");
            evt.target.setAttribute("aria-expanded", evt.target.classList.contains("expanded").toString());
            return false;
        }, false);
    });

    // Fix a weird issue making the initial screen always at the bottom.
    document.querySelector(".content").scrollIntoView(true);
</script>

</body><script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js'></script><script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script>
<script type='text/javascript'>/* Custom JS on top of external clipboard.js */
window.onload = function() {
    var pre = document.getElementsByTagName('pre');

    for (var i = 0; i < pre.length; i++) {
        var b = document.createElement('button');
        b.className = 'clipboard';
        b.textContent = ' ';
        if (pre[i].childNodes.length === 1 && pre[i].childNodes[0].nodeType === 3) {
            var div = document.createElement('div');
            div.textContent = pre[i].textContent;
            pre[i].textContent = '';
            pre[i].appendChild(div);
        }
        pre[i].appendChild(b);
    }

    var clipboard = new ClipboardJS('.clipboard', {
       target: function(b) {
            var p = b.parentNode;
            if (p.className.includes("highlight")) {
                var elems = p.getElementsByTagName("code");
                if (elems.length > 0)
                    return elems[0];
            }
            return p.childNodes[0];
        }
    });

    clipboard.on('success', function(e) {
        e.clearSelection();
        e.trigger.classList.add('clipboard_success');
        setTimeout(function() {
            e.trigger.classList.remove('clipboard_success');
        }, 1300);
    });

    clipboard.on('error', function(e) {
        console.error('Action:', e.action, e);
        console.error('Trigger:', e.trigger);
    });
};
</script></html>